Working... ---------------------------------------- 100% 0:00:04
Run started:2024-02-10 20:16:10.403614

Test results:
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\setup.py:77:15
76	
77	        xslt = lxml.etree.parse(self.xslt).getroot()
78	        transform = lxml.etree.XSLT(xslt)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\setup.py:106:18
105	            self.announce("Transforming %s to %s" % (filename, outfile))
106	            xml = lxml.etree.parse(filename).getroot()
107	            xhtml = str(transform(xml, **params))

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\setup.py:119:4
118	try:
119	    import lxml.etree
120	    cmdclass['build_dtddoc'] = BuildDTDDoc

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\lib\Bcfg2Py3k.py:39:4
38	try:
39	    import cPickle
40	except ImportError:

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\lib\Bcfg2Py3k.py:41:4
40	except ImportError:
41	    import pickle as cPickle
42	

--------------------------------------------------
>> Issue: [B411:blacklist] Using xmlrpclib to parse untrusted XML data is known to be vulnerable to XML attacks. Use defusedxml.xmlrpc.monkey_patch() function to monkey-patch xmlrpclib and mitigate XML vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b411-import-xmlrpclib
   Location: .\src\lib\Bcfg2Py3k.py:50:4
49	try:
50	    import xmlrpclib, SimpleXMLRPCServer
51	except ImportError:

--------------------------------------------------
>> Issue: [B411:blacklist] Using xmlrpc.client to parse untrusted XML data is known to be vulnerable to XML attacks. Use defusedxml.xmlrpc.monkey_patch() function to monkey-patch xmlrpclib and mitigate XML vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b411-import-xmlrpclib
   Location: .\src\lib\Bcfg2Py3k.py:52:4
51	except ImportError:
52	    import xmlrpc.client as xmlrpclib
53	    import xmlrpc.server as SimpleXMLRPCServer

--------------------------------------------------
>> Issue: [B411:blacklist] Using xmlrpc.server to parse untrusted XML data is known to be vulnerable to XML attacks. Use defusedxml.xmlrpc.monkey_patch() function to monkey-patch xmlrpclib and mitigate XML vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b411-import-xmlrpclib
   Location: .\src\lib\Bcfg2Py3k.py:53:4
52	    import xmlrpc.client as xmlrpclib
53	    import xmlrpc.server as SimpleXMLRPCServer
54	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Client\Tools\Blast.py:25:8
24	            noaskfile.write(Bcfg2.Client.Tools.SYSV.noask)
25	        except:
26	            pass
27	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Client\Tools\YUM24.py:28:0
27	        YAD = False
28	except:
29	    pass
30	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Client\Tools\__init__.py:9:0
8	import sys
9	from subprocess import Popen, PIPE
10	import time

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Client\Tools\__init__.py:36:12
35	        """Run a command in a pipe dealing with stdout buffer overloads."""
36	        p = Popen(command, shell=True, bufsize=16384,
37	                  stdin=PIPE, stdout=PIPE, close_fds=True)
38	        output = p.communicate()[0]

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\src\lib\Client\Tools\rpmtools.py:278:22
277	                                            % (re.escape(filename))
278	                plf = os.popen(cmd, 'rb')
279	                prelink = True

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\src\lib\Client\Tools\rpmtools.py:284:18
283	                                        % (re.escape(filename))
284	            plf = os.popen(cmd, 'rb')
285	            prelink = True

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\lib\Client\Tools\rpmtools.py:291:17
290	    else:
291	        chksum = hashlib.md5()
292	    while 1:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\src\lib\Client\Tools\rpmtools.py:328:22
327	                                            % (re.escape(filename))
328	                plf = os.popen(cmd, 'rb')
329	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\src\lib\Client\Tools\rpmtools.py:341:18
340	                                        % (re.escape(filename))
341	            plf = os.popen(cmd, 'rb')
342	

--------------------------------------------------
>> Issue: [B410:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Client\XML.py:7:4
6	try:
7	    from lxml.etree import Element, SubElement, XML, tostring
8	    from lxml.etree import XMLSyntaxError as ParseError

--------------------------------------------------
>> Issue: [B410:blacklist] Using XMLSyntaxError to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XMLSyntaxError with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Client\XML.py:8:4
7	    from lxml.etree import Element, SubElement, XML, tostring
8	    from lxml.etree import XMLSyntaxError as ParseError
9	    driver = 'lxml'

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\src\lib\Client\XML.py:14:8
13	    try:
14	        import xml.etree.ElementTree
15	        Element = xml.etree.ElementTree.Element

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Options.py:119:12
118	                return
119	            except:
120	                pass
121	        # Default value not cooked

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\SSLServer.py:161:8
160	            request.unwrap()
161	        except:
162	            pass
163	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\SSLServer.py:165:8
164	            request.close()
165	        except:
166	            pass
167	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\lib\SSLServer.py:213:23
212	            username = auth_content
213	            password = ""
214	        cert = self.request.getpeercert()

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Admin\Client.py:1:0
1	import lxml.etree
2	import Bcfg2.Server.Admin
3	from Bcfg2.Server.Plugins.Metadata import MetadataConsistencyError

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Admin\Client.py:58:19
57	        elif args[0] in ['list', 'ls']:
58	            tree = lxml.etree.parse(self.metadata.data + "/clients.xml")
59	            tree.xinclude()

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Admin\Compare.py:1:0
1	import lxml.etree
2	import os
3	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Admin\Compare.py:78:18
77	        try:
78	            new = lxml.etree.parse(path1).getroot()
79	        except IOError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Admin\Compare.py:84:18
83	        try:
84	            old = lxml.etree.parse(path2).getroot()
85	        except IOError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Admin\Group.py:1:0
1	import lxml.etree
2	import Bcfg2.Server.Admin
3	from Bcfg2.Server.Plugins.Metadata import MetadataConsistencyError

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Admin\Group.py:58:19
57	        elif args[0] in ['list', 'ls']:
58	            tree = lxml.etree.parse(self.metadata.data + "/groups.xml")
59	            for node in tree.findall("//Group"):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Admin\Init.py:8:0
7	import sys
8	import subprocess
9	import Bcfg2.Server.Admin

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\lib\Server\Admin\Init.py:120:32
119	    for i in range(length):
120	        newpasswd = newpasswd + random.choice(chars)
121	    return newpasswd

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Admin\Init.py:132:4
131	                                                                keypath))
132	    subprocess.call((kcstr), shell=True)
133	    ccstr = ("openssl req -batch -new  -subj '/C=%s/ST=%s/L=%s/CN=%s' -key %s "

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Admin\Init.py:141:4
140	                                                                     certpath))
141	    subprocess.call((ccstr), shell=True)
142	    os.chmod(keypath, stat.S_IRUSR | stat.S_IWUSR)  # 0600

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Admin\Minestruct.py:2:0
1	import getopt
2	import lxml.etree
3	import sys

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\lib\Server\Admin\Reports.py:7:0
6	import logging
7	import pickle
8	import platform

--------------------------------------------------
>> Issue: [B410:blacklist] Using XML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Admin\Reports.py:11:0
10	import traceback
11	from lxml.etree import XML, XMLSyntaxError
12	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Admin\Reports.py:280:8
279	                       location=platform.node())
280	        except:
281	            pass
282	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Admin\Viz.py:2:0
1	import getopt
2	from subprocess import Popen, PIPE
3	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Admin\Viz.py:88:22
87	        try:
88	            dotpipe = Popen(cmd, stdin=PIPE, stdout=PIPE, close_fds=True)
89	        except OSError:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Admin\Viz.py:97:22
96	                cmd.extend(["-o", pipes.quote(output)])
97	            dotpipe = Popen(cmd, shell=True,
98	                            stdin=PIPE, stdout=PIPE, close_fds=True)
99	        try:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Admin\__init__.py:22:0
21	import logging
22	import lxml.etree
23	import sys

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Admin\__init__.py:66:16
65	    def load_stats(self, client):
66	        stats = lxml.etree.parse("%s/etc/statistics.xml" % self.setup['repo'])
67	        hostent = stats.xpath('//Node[@name="%s"]' % client)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\FileMonitor.py:80:8
79	                count += 1
80	        except:
81	            pass
82	        if lock:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Hostbase\hostbase\views.py:513:8
512	                                       context_instance = RequestContext(request))
513	        except:
514	            pass
515	        if not validate(request, True):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Hostbase\hostbase\views.py:683:8
682	                                       context_instance = RequestContext(request))
683	        except:
684	            pass
685	        if not validate(request, True):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '*%=fv=yh9zur&gvt4&*d#84o(cy^-*$ox-v1e9%32pzf2*qu#s'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\lib\Server\Hostbase\settings.py:91:13
90	# Make this unique, and don't share it with anybody.
91	SECRET_KEY = '*%=fv=yh9zur&gvt4&*d#84o(cy^-*$ox-v1e9%32pzf2*qu#s'
92	# List of callables that know how to import templates from various sources.

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:9:15
8	    os.environ['bcfg_db_user'] = 'baz'
9	    os.environ['bcfg_db_password'] = 'pass'
10	    os.environ['bcfg_db_host'] = 'biff'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:22:15
21	    os.environ['bcfg_db_user'] = 'baz'
22	    os.environ['bcfg_db_password'] = 'pass'
23	    os.environ['bcfg_db_host'] = 'biff'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:29:4
28	    s.CFG_TYPE = 'environ'
29	    assert s.DATABASE_ENGINE == 'mysql'
30	    assert s.DATABASE_PASSWORD == 'pass'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:30:4
29	    assert s.DATABASE_ENGINE == 'mysql'
30	    assert s.DATABASE_PASSWORD == 'pass'
31	    assert s.DATABASE_NAME == 'bar'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:30:34
29	    assert s.DATABASE_ENGINE == 'mysql'
30	    assert s.DATABASE_PASSWORD == 'pass'
31	    assert s.DATABASE_NAME == 'bar'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:31:4
30	    assert s.DATABASE_PASSWORD == 'pass'
31	    assert s.DATABASE_NAME == 'bar'
32	    assert s.DATABASE_USER == 'baz'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:32:4
31	    assert s.DATABASE_NAME == 'bar'
32	    assert s.DATABASE_USER == 'baz'
33	    assert s.DATABASE_HOST == 'biff'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:33:4
32	    assert s.DATABASE_USER == 'baz'
33	    assert s.DATABASE_HOST == 'biff'
34	    assert s.DATABASE_PORT == '3306'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:34:4
33	    assert s.DATABASE_HOST == 'biff'
34	    assert s.DATABASE_PORT == '3306'
35	    assert s.TIME_ZONE == 'CHI'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_environ_settings.py:35:4
34	    assert s.DATABASE_PORT == '3306'
35	    assert s.TIME_ZONE == 'CHI'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\lib\Server\Hostbase\test\test_ldapauth.py:10:4
9	
10	    assert l.department == 'foo'

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\Bundles.py:1:0
1	import lxml.etree
2	import Bcfg2.Server.Lint
3	                        

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Bundles.py:43:20
42	            # genshi template
43	            xdata = lxml.etree.parse(bundle.template.filepath).getroot()
44	            

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Bundles.py:55:16
54	        which are not supported  """
55	        xdata = lxml.etree.parse(bundle.name)
56	        groups = [self.RenderXML(g)

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\Comments.py:2:0
1	import os.path
2	import lxml.etree
3	import Bcfg2.Server.Lint

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Comments.py:61:28
60	                except (lxml.etree.XMLSyntaxError, AttributeError):
61	                    xdata = lxml.etree.parse(bundle.template.filepath).getroot()
62	                    rtype = "sgenshi"

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Comments.py:179:24
178	            if path in self.files:
179	                xdata = lxml.etree.parse(path)
180	                for el in xdata.findall('./{http://www.w3.org/2001/XInclude}include'):

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\Duplicates.py:2:0
1	import os.path
2	import lxml.etree
3	import Bcfg2.Server.Lint

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Duplicates.py:74:24
73	            if path in self.files:
74	                xdata = lxml.etree.parse(path)
75	                for el in xdata.findall('./{http://www.w3.org/2001/XInclude}include'):

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\Pkgmgr.py:2:0
1	import glob
2	import lxml.etree
3	import Bcfg2.Server.Lint

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Pkgmgr.py:12:24
11	            if self.HandlesFile(pfile):
12	                xdata = lxml.etree.parse(pfile).getroot()
13	                # get priority, type, group

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\RequiredAttrs.py:2:0
1	import os.path
2	import lxml.etree
3	import Bcfg2.Server.Lint

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\RequiredAttrs.py:84:28
83	                except (lxml.etree.XMLSyntaxError, AttributeError):
84	                    xdata = lxml.etree.parse(bundle.template.filepath).getroot()
85	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\Validate.py:3:0
2	import glob
3	import lxml.etree
4	import os

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Lint\Validate.py:5:0
4	import os
5	from subprocess import Popen, PIPE, STDOUT
6	import sys

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Validate.py:50:50
49	                try:
50	                    schema = lxml.etree.XMLSchema(lxml.etree.parse(schemafile))
51	                except IOError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Validate.py:82:46
81	            try:
82	                schema = lxml.etree.XMLSchema(lxml.etree.parse(schemafile))
83	            except:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Validate.py:89:23
88	        try:
89	            datafile = lxml.etree.parse(filename)
90	        except SyntaxError:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Lint\Validate.py:91:19
90	        except SyntaxError:
91	            lint = Popen(["xmllint", filename], stdout=PIPE, stderr=STDOUT)
92	            self.LintError("xml-failed-to-parse",

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Lint\Validate.py:91:19
90	        except SyntaxError:
91	            lint = Popen(["xmllint", filename], stdout=PIPE, stderr=STDOUT)
92	            self.LintError("xml-failed-to-parse",

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Lint\Validate.py:107:19
106	            cmd.extend(["--noout", "--schema", schemafile, filename])
107	            lint = Popen(cmd, stdout=PIPE, stderr=STDOUT)
108	            output = lint.communicate()[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Validate.py:179:16
178	        """ follow xincludes in the given file """
179	        xdata = lxml.etree.parse(xfile)
180	        included = set([ent.get('href') for ent in

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Lint\Validate.py:193:28
192	                rv.append(path)
193	                groupdata = lxml.etree.parse(path)
194	                [included.add(el.get('href'))

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Lint\__init__.py:19:0
18	import textwrap
19	import lxml.etree
20	import Bcfg2.Logger

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Lint\__init__.py:42:8
41	            os.close(fd)
42	        except:
43	            pass
44	    if not cr:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugin.py:6:0
5	import logging
6	import lxml.etree
7	import os

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\lib\Server\Plugin.py:8:0
7	import os
8	import pickle
9	import posixpath

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\src\lib\Server\Plugin.py:249:27
248	            savefile = open(self.pending_file, 'r')
249	            pending_data = pickle.load(savefile)
250	            savefile.close()

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\lib\Server\Plugin.py:712:33
711	            if data.tag in list(psrc.keys()):
712	                self.predicate = eval(psrc[data.tag] %
713	                                      {'name': data.get('name')},
714	                                      {'predicate': predicate})
715	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Plugins\Account.py:74:8
73	                           if host == metadata.hostname.split('.')[0]]
74	        except:
75	            pass
76	        rdata = self.repository.entries

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Plugins\Account.py:94:8
93	                           if host == metadata.hostname.split('.')[0]]
94	        except:
95	            pass
96	        entry.text = self.repository.entries['static.sudoers'].data

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\BB.py:1:0
1	import lxml.etree
2	import Bcfg2.Server
3	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Base.py:5:0
4	import copy
5	import lxml.etree
6	import sys

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Bundler.py:5:0
4	import copy
5	import lxml.etree
6	import os

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Bundler.py:56:17
55	    def template_dispatch(self, name):
56	        bundle = lxml.etree.parse(name,
57	                                  parser=Bcfg2.Server.XMLParser)
58	        nsmap = bundle.getroot().nsmap

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Cfg.py:6:0
5	import logging
6	import lxml
7	import operator

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\Cfg.py:14:0
13	import tempfile
14	from subprocess import Popen, PIPE
15	from Bcfg2.Bcfg2Py3k import u_str

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Cfg.py:69:16
68	        cmd = ["patch", "-u", "-f", basefile.name]
69	        patch = Popen(cmd, stdin=PIPE, stdout=PIPE, stderr=PIPE)
70	        stderr = patch.communicate(input=delta.data)[1]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\Cvs.py:2:0
1	import os
2	from subprocess import Popen, PIPE
3	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Plugins\Cvs.py:37:19
36	        try:
37	            data = Popen("env LC_ALL=C cvs log",
38	                        shell=True,
39	                        cwd=self.datastore,
40	                        stdout=PIPE).stdout.readlines()
41	            revision = data[3].strip('\n')

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Cvs.py:38:19
37	            data = Popen("env LC_ALL=C cvs log",
38	                        shell=True,
39	                        cwd=self.datastore,
40	                        stdout=PIPE).stdout.readlines()
41	            revision = data[3].strip('\n')
42	        except IndexError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\DBStats.py:4:0
3	import logging
4	import lxml.etree
5	import platform

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\Darcs.py:2:0
1	import os
2	from subprocess import Popen, PIPE
3	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Plugins\Darcs.py:38:19
37	        try:
38	            data = Popen("env LC_ALL=C darcs changes",
39	                        shell=True,
40	                        cwd=self.datastore,
41	                        stdout=PIPE).stdout.readlines()
42	            revision = data[0].strip('\n')

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Darcs.py:39:19
38	            data = Popen("env LC_ALL=C darcs changes",
39	                        shell=True,
40	                        cwd=self.datastore,
41	                        stdout=PIPE).stdout.readlines()
42	            revision = data[0].strip('\n')
43	        except:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Decisions.py:2:0
1	import logging
2	import lxml.etree
3	import sys

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Deps.py:4:0
3	
4	import lxml.etree
5	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\lib\Server\Plugins\Deps.py:22:33
21	            if data.tag in list(self.raw.keys()):
22	                self.predicate = eval(self.raw[data.tag] %
23	                                      {'name': data.get('name')},
24	                                      {'predicate': predicate})
25	            else:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Editor.py:3:0
2	import re
3	import lxml.etree
4	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Plugins\Editor.py:52:8
51	            f.close()
52	        except:
53	            pass
54	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\FileProbes.py:12:0
11	import binascii
12	import lxml.etree
13	import Bcfg2.Options

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\Fossil.py:2:0
1	import os
2	from subprocess import Popen, PIPE
3	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Plugins\Fossil.py:40:19
39	        try:
40	            data = Popen("env LC_ALL=C fossil info",
41	                        shell=True,
42	                        cwd=self.datastore,
43	                        stdout=PIPE).stdout.readlines()
44	            revline = [line.split(': ')[1].strip() for line in data if \

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Fossil.py:41:19
40	            data = Popen("env LC_ALL=C fossil info",
41	                        shell=True,
42	                        cwd=self.datastore,
43	                        stdout=PIPE).stdout.readlines()
44	            revline = [line.split(': ')[1].strip() for line in data if \
45	                       line.split(': ')[0].strip() == 'checkout'][-1]

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\GroupPatterns.py:3:0
2	import logging
3	import lxml.etree
4	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B410:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Hostbase.py:9:0
8	os.environ['DJANGO_SETTINGS_MODULE'] = 'Bcfg2.Server.Hostbase.settings'
9	from lxml.etree import Element, SubElement
10	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:117:27
116	                serial = int(todaydate) * 100
117	            cursor.execute("""UPDATE hostbase_zone SET serial = \'%s\' WHERE id = \'%s\'""" % (str(serial), zone[0]))
118	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:128:27
127	            externalzonefile = StringIO()
128	            cursor.execute("""SELECT n.name FROM hostbase_zone_nameservers z
129	            INNER JOIN hostbase_nameserver n ON z.nameserver_id = n.id
130	            WHERE z.zone_id = \'%s\'""" % zone[0])
131	            nameservers = cursor.fetchall()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:132:27
131	            nameservers = cursor.fetchall()
132	            cursor.execute("""SELECT i.ip_addr FROM hostbase_zone_addresses z
133	            INNER JOIN hostbase_zoneaddress i ON z.zoneaddress_id = i.id
134	            WHERE z.zone_id = \'%s\'""" % zone[0])
135	            addresses = cursor.fetchall()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:136:27
135	            addresses = cursor.fetchall()
136	            cursor.execute("""SELECT m.priority, m.mx FROM hostbase_zone_mxs z
137	            INNER JOIN hostbase_mx m ON z.mx_id = m.id
138	            WHERE z.zone_id = \'%s\'""" % zone[0])
139	            mxs = cursor.fetchall()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:149:26
148	
149	            querystring = """SELECT h.hostname, p.ip_addr,
150	            n.name, c.cname, m.priority, m.mx, n.dns_view
151	            FROM (((((hostbase_host h INNER JOIN hostbase_interface i ON h.id = i.host_id)
152	            INNER JOIN hostbase_ip p ON i.id = p.interface_id)
153	            INNER JOIN hostbase_name n ON p.id = n.ip_id)
154	            INNER JOIN hostbase_name_mxs x ON n.id = x.name_id)
155	            INNER JOIN hostbase_mx m ON m.id = x.mx_id)
156	            LEFT JOIN hostbase_cname c ON n.id = c.name_id
157	            WHERE n.name LIKE '%%%%%s'
158	            AND h.status = 'active'
159	            ORDER BY h.hostname, n.name, p.ip_addr
160	            """ % zone[1]
161	            cursor.execute(querystring)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:215:20
214	
215	                    except:
216	                        pass
217	                prevhost = host

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:234:27
233	        for reversezone in reversezones:
234	            cursor.execute("""SELECT n.name FROM hostbase_zone_nameservers z
235	            INNER JOIN hostbase_nameserver n ON z.nameserver_id = n.id
236	            WHERE z.zone_id = \'%s\'""" % reversezone[0])
237	            reverse_nameservers = cursor.fetchall()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:255:27
254	        for filename in reversenames:
255	            cursor.execute("""
256	            SELECT DISTINCT h.hostname, p.ip_addr, n.dns_view FROM ((hostbase_host h
257	            INNER JOIN hostbase_interface i ON h.id = i.host_id)
258	            INNER JOIN hostbase_ip p ON i.id = p.interface_id)
259	            INNER JOIN hostbase_name n ON n.ip_id = p.id
260	            WHERE p.ip_addr LIKE '%s%%%%' AND h.status = 'active' ORDER BY p.ip_addr
261	            """ % filename[1])
262	            reversehosts = cursor.fetchall()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Plugins\Hostbase.py:404:26
403	        for three_octet in three_octets_data:
404	            querystring = """SELECT h.hostname, h.primary_user,
405	            p.ip_addr, n.name, c.cname
406	            FROM (((hostbase_host h INNER JOIN hostbase_interface i ON h.id = i.host_id)
407	            INNER JOIN hostbase_ip p ON i.id = p.interface_id)
408	            INNER JOIN hostbase_name n ON p.id = n.ip_id)
409	            LEFT JOIN hostbase_cname c ON n.id = c.name_id
410	            WHERE p.ip_addr LIKE \'%s.%%%%\' AND h.status = 'active'""" % three_octet[0]
411	            cursor.execute(querystring)

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Metadata.py:9:0
8	import fcntl
9	import lxml.etree
10	import os

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Metadata.py:76:20
75	        try:
76	            xdata = lxml.etree.parse(os.path.join(self.basedir, self.basefile),
77	                                     parser=Bcfg2.Server.XMLParser)
78	        except lxml.etree.XMLSyntaxError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Metadata.py:149:28
148	                try:
149	                    xdata = lxml.etree.parse(os.path.join(self.basedir,
150	                                                          included),
151	                                             parser=Bcfg2.Server.XMLParser)
152	                    cli = xdata.xpath(xpath)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Metadata.py:289:22
288	        '''return groups xml tree'''
289	        groups_tree = lxml.etree.parse(self.data + "/groups.xml",
290	                                       parser=Bcfg2.Server.XMLParser)
291	        root = groups_tree.getroot()

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Metadata.py:348:15
347	        """Add bundle to groups.xml."""
348	        tree = lxml.etree.parse(self.data + "/groups.xml",
349	                                parser=Bcfg2.Server.XMLParser)
350	        root = tree.getroot()

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Metadata.py:372:15
371	        """Remove a bundle."""
372	        tree = lxml.etree.parse(self.data + "/groups.xml",
373	                                parser=Bcfg2.Server.XMLParser)
374	        root = tree.getroot()

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Metadata.py:824:22
823	        
824	        groups_tree = lxml.etree.parse(self.data + "/groups.xml",
825	                                       parser=Bcfg2.Server.XMLParser)
826	        try:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\NagiosGen.py:9:0
8	import logging
9	import lxml.etree
10	import Bcfg2.Server

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\NagiosGen.py:93:22
92	                        "nagiosgen-convert.py.")
93	            parents = lxml.etree.parse(pfile,
94	                                       parser=Bcfg2.Server.XMLParser)
95	            for el in parents.xpath("//Depend[@name='%s']" % metadata.hostname):

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Ohai.py:1:0
1	import lxml.etree
2	import os
3	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Packages\PackagesSources.py:3:0
2	import sys
3	import lxml.etree
4	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:9:0
8	import threading
9	import lxml.etree
10	from UserDict import DictMixin

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:11:0
10	from UserDict import DictMixin
11	from subprocess import Popen, PIPE, STDOUT
12	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:119:8
118	            return self.config.get("yum", "helper")
119	        except:
120	            pass
121	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:125:16
124	            try:
125	                Popen(['bcfg2-yum-helper'],
126	                      stdin=PIPE, stdout=PIPE, stderr=PIPE).wait()
127	                self._helper = 'bcfg2-yum-helper'

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:125:16
124	            try:
125	                Popen(['bcfg2-yum-helper'],
126	                      stdin=PIPE, stdout=PIPE, stderr=PIPE).wait()
127	                self._helper = 'bcfg2-yum-helper'

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:427:21
426	        try:
427	            helper = Popen(cmd, stdin=PIPE, stdout=PIPE, stderr=PIPE)
428	        except OSError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:610:20
609	            farch = self.file_to_arch[fname]
610	            fdata = lxml.etree.parse(fname).getroot()
611	            self.parse_primary(fdata, farch)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Packages\Yum.py:614:20
613	            farch = self.file_to_arch[fname]
614	            fdata = lxml.etree.parse(fname).getroot()
615	            self.parse_filelist(fdata, farch)

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Packages\__init__.py:7:0
6	import shutil
7	import lxml.etree
8	import Bcfg2.Logger

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Pkgmgr.py:7:0
6	import Bcfg2.Server.Plugin
7	import lxml
8	try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Plugins\Pkgmgr.py:76:16
75	                    child.set(attr, data.get(attr))
76	                except:
77	                    # don't fail on things like comments and other immutable elements
78	                    pass
79	        Bcfg2.Server.Plugin.INode.__init__(self, data, pdict, parent)

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Probes.py:2:0
1	import time
2	import lxml.etree
3	import operator

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\src\lib\Server\Plugins\Probes.py:118:33
117	                try:
118	                    self._yaml = yaml.load(self.data)
119	                except yaml.YAMLError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\Probes.py:227:19
226	        try:
227	            data = lxml.etree.parse(os.path.join(self.data, 'probed.xml'),
228	                                    parser=Bcfg2.Server.XMLParser).getroot()
229	        except:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Properties.py:6:0
5	import logging
6	import lxml.etree
7	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\SGenshi.py:6:0
5	import genshi.template
6	import lxml.etree
7	import logging

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\SSHbase.py:11:0
10	import tempfile
11	from subprocess import Popen, PIPE
12	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\lib\Server\Plugins\SSHbase.py:163:20
162	                        newips.add(self.get_ipcache_entry(name)[0])
163	                    except:
164	                        continue
165	                names[cmeta.hostname].update(newnames)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\lib\Server\Plugins\SSHbase.py:173:24
172	                            names[cmeta.hostname].update(self.get_namecache_entry(ip))
173	                        except:
174	                            continue
175	                names[cmeta.hostname] = sorted(names[cmeta.hostname])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Plugins\SSHbase.py:279:25
278	            except socket.gaierror:
279	                ipaddr = Popen(["getent", "hosts", client],
280	                               stdout=PIPE).stdout.read().strip().split()
281	                if ipaddr:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSHbase.py:279:25
278	            except socket.gaierror:
279	                ipaddr = Popen(["getent", "hosts", client],
280	                               stdout=PIPE).stdout.read().strip().split()
281	                if ipaddr:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSHbase.py:382:15
381	               "-t", keytype, "-C", "root@%s" % client]
382	        proc = Popen(cmd, stdout=PIPE, stdin=PIPE)
383	        proc.communicate()

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\SSLCA.py:3:0
2	import Bcfg2.Options
3	import lxml.etree
4	import posixpath

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\SSLCA.py:8:0
7	import os
8	from subprocess import Popen, PIPE, STDOUT
9	# Compatibility import

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\SSLCA.py:50:41
49	                if event.filename.endswith('key.xml'):
50	                    key_spec = dict(list(lxml.etree.parse(epath,
51	                                                          parser=Bcfg2.Server.XMLParser).find('Key').items()))
52	                    self.key_specs[ident] = {

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\lib\Server\Plugins\SSLCA.py:58:42
57	                elif event.filename.endswith('cert.xml'):
58	                    cert_spec = dict(list(lxml.etree.parse(epath,
59	                                                           parser=Bcfg2.Server.XMLParser).find('Cert').items()))
60	                    ca = cert_spec.get('ca', 'default')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:135:14
134	            cmd = ["openssl", "dsaparam", "-noout", "-genkey", bits]
135	        key = Popen(cmd, stdout=PIPE).stdout.read()
136	        return key

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:187:14
186	        cert = self.data + filename
187	        res = Popen(["openssl", "verify", "-CAfile", chaincert, cert],
188	                    stdout=PIPE, stderr=STDOUT).stdout.read()
189	        if res == cert + ": OK\n":

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:187:14
186	        cert = self.data + filename
187	        res = Popen(["openssl", "verify", "-CAfile", chaincert, cert],
188	                    stdout=PIPE, stderr=STDOUT).stdout.read()
189	        if res == cert + ": OK\n":

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:201:19
200	               pipes.quote(cert))
201	        cert_md5 = Popen(cmd, shell=True, stdout=PIPE, stderr=STDOUT).stdout.read()
202	        cmd = ("openssl rsa -noout -modulus -in %s | openssl md5" %

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:204:18
203	               pipes.quote(key))
204	        key_md5 = Popen(cmd, shell=True, stdout=PIPE, stderr=STDOUT).stdout.read()
205	        if cert_md5 == key_md5:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:223:15
222	            cmd.extend(["-passin", "pass:%s" % passphrase])
223	        cert = Popen(cmd, stdout=PIPE).stdout.read()
224	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\SSLCA.py:281:14
280	               "-days", days, "-key", key, "-text", "-out", req]
281	        res = Popen(cmd, stdout=PIPE).stdout.read()
282	        return req

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\lib\Server\Plugins\Snapshots.py:89:12
88	                (metadata, data) = self.work_queue.get(block=True, timeout=5)
89	            except:
90	                continue
91	            self.statistics_from_old_stats(metadata, data)

--------------------------------------------------
>> Issue: [B410:blacklist] Using XML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Statistics.py:8:0
7	import logging
8	from lxml.etree import XML, SubElement, Element, XMLSyntaxError
9	import lxml.etree

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Plugins\Statistics.py:9:0
8	from lxml.etree import XML, SubElement, Element, XMLSyntaxError
9	import lxml.etree
10	import os

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\lib\Server\Plugins\Svn.py:3:0
2	import pipes
3	from subprocess import Popen, PIPE
4	import Bcfg2.Server.Plugin

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\src\lib\Server\Plugins\Svn.py:39:19
38	            data = Popen(("env LC_ALL=C svn info %s" %
39	                         pipes.quote(self.datastore)), shell=True,
40	                         stdout=PIPE).communicate()[0].split('\n')
41	            return [line.split(': ')[1] for line in data \
42	                    if line[:9] == 'Revision:'][-1]

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\src\lib\Server\Plugins\Trigger.py:12:12
11	        if not dpid:
12	            os.system(" ".join([prog] + args))
13	        os._exit(0)

--------------------------------------------------
>> Issue: [B410:blacklist] Using XML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\Reports\importscript.py:27:0
26	from Bcfg2.Server.Reports.reports.models import *
27	from lxml.etree import XML, XMLSyntaxError
28	from getopt import getopt, GetoptError

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Reports\reports\models.py:132:14
131	
132	        sql = 'select reports_interaction.id, x.client_id from (select client_id, MAX(timestamp) ' + \
133	                    'as timer from reports_interaction'
134	        if maxdate:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Reports\reports\models.py:142:24
141	        if active_only:
142	            sql = sql + " and x.client_id in (select id from reports_client where %s)" % \
143	                cfilter
144	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Reports\reports\templatetags\bcfg2_tags.py:258:8
257	                               context['MEDIA_URL'].strip('/'))
258	        except:
259	            pass
260	        return "%s/%s" % (base, self.filter_value)

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\src\lib\Server\Reports\reports\templatetags\syntax_coloring.py:43:19
42	            output += highlight(value, lexer, HtmlFormatter())
43	            return mark_safe(output)
44	        except:

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\src\lib\Server\Reports\reports\templatetags\syntax_coloring.py:43:19
42	            output += highlight(value, lexer, HtmlFormatter())
43	            return mark_safe(output)
44	        except:

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\src\lib\Server\Reports\reports\templatetags\syntax_coloring.py:47:15
46	    else:
47	        return mark_safe(u_str('<div class="note-box">Tip: Install pygments for highlighting</div><pre>%s</pre>') % value)
48	syntaxhilight.needs_autoescape = True

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\src\lib\Server\Reports\reports\templatetags\syntax_coloring.py:47:15
46	    else:
47	        return mark_safe(u_str('<div class="note-box">Tip: Install pygments for highlighting</div><pre>%s</pre>') % value)
48	syntaxhilight.needs_autoescape = True

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Reports\reports\views.py:66:12
65	                pass
66	            except:
67	                pass
68	                # FIXME - Handle this

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'eb5+y%oy-qx*2+62vv=gtnnxg1yig_odu0se5$h0hh#pc*lmo7'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\lib\Server\Reports\settings.py:96:13
95	# Make this unique, and don't share it with anybody.
96	SECRET_KEY = 'eb5+y%oy-qx*2+62vv=gtnnxg1yig_odu0se5$h0hh#pc*lmo7'
97	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\lib\Server\Reports\updatefix.py:76:31
75	        try:
76	            cursor.executemany("update reports_interaction set " + count_field[type] + "=%s where id = %s", updates)
77	        except Exception:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\lib\Server\Reports\updatefix.py:151:4
150	        connection.close()
151	    except:
152	        # ignore any errors from missing/invalid dbs
153	        pass
154	    # Do the syncdb according to the django version

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\lib\Server\__init__.py:4:0
3	
4	import lxml.etree
5	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\testsuite\TestFrame.py:1:0
1	import lxml.etree
2	
3	import Bcfg2.Client.Frame

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:35:8
34	        frame = Bcfg2.Client.Frame.Frame(config, setup, times, [], False)
35	        assert frame.tools == []
36	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:41:8
40	        frame2 = Bcfg2.Client.Frame.Frame(c1, setup, times, ['POSIX'], False)
41	        assert len(frame2.tools) == 1
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:47:8
46	        frame3 = Bcfg2.Client.Frame.Frame(c2, setup, times, ['foo'], False)
47	        assert len(frame3.tools) == 0
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:53:8
52	        frame = Bcfg2.Client.Frame.Frame(c2, setup, times, [DriverInitFail], False)
53	        assert len(frame.tools) == 0
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:62:8
61	                                         [DriverInventoryFail], False)
62	        assert len(frame.tools) == 1
63	        frame.Inventory()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:64:8
63	        frame.Inventory()
64	        assert len([x for x in list(frame.states.values()) if x]) == 0
65	        frame.Decide()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:66:8
65	        frame.Decide()
66	        assert len(frame.whitelist)
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:75:8
74	                                         [DriverInventoryFail], False)
75	        assert len(frame.tools) == 1
76	        frame.Inventory()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:77:8
76	        frame.Inventory()
77	        assert len([x for x in list(frame.states.values()) if x]) == 0
78	        frame.Decide()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:79:8
78	        frame.Decide()
79	        assert len(frame.whitelist) == 0
80	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:88:8
87	                                         [DriverInventoryFail], True)
88	        assert len(frame.tools) == 1
89	        frame.Inventory()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:90:8
89	        frame.Inventory()
90	        assert len([x for x in list(frame.states.values()) if x]) == 0
91	        frame.Decide()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:92:8
91	        frame.Decide()
92	        assert len(frame.whitelist) == 0
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestFrame.py:104:8
103	        stats = frame.GenerateStats()
104	        assert len(stats.findall('.//Bad')[0].getchildren()) != 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:12:12
11	            p = Bcfg2.Options.Option('foo', False, cmd='--F')
12	            assert False
13	        except Bcfg2.Options.OptionFailure:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:20:8
19	        o.parse([], ['-F', 'test'])
20	        assert o.value == 'test'
21	        o.parse([('-F', 'test2')], [])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:22:8
21	        o.parse([('-F', 'test2')], [])
22	        assert o.value == 'test2'
23	        os.environ['TEST2'] = 'test3'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:25:8
24	        o.parse([], [])
25	        assert o.value == 'test3'
26	        del os.environ['TEST2']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:29:8
28	        print(o.value)
29	        assert o.value == 'foobat'
30	        o.cf = ('communication', 'pwd')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:33:8
32	        print(o.value)
33	        assert o.value == 'test4'
34	        o.cf = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:36:8
35	        o.parse([], [])
36	        assert o.value == 'test4'
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:42:8
41	        o1.parse([], [])
42	        assert o1.value == 'test4'
43	        o2 = Bcfg2.Options.Option('foo', False, cmd='-F')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:45:8
44	        o2.parse([('-F', '')], [])
45	        assert o2.value == True
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:56:8
55	        res = os.buildGetopt()
56	        assert 'H:' in res and 'G' in res and len(res) == 3
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:66:8
65	        print(res)
66	        assert 'H=' in res and len(res) == 1
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:76:12
75	            os.parse(['-G', '-H'])
76	            assert False
77	        except SystemExit:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:82:12
81	            os2.parse(['-h'])
82	            assert False
83	        except SystemExit:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:87:8
86	        os3.parse(['-G'])
87	        assert os3['foo'] == True
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:97:8
96	        os1 = Bcfg2.Options.OptionParser(opts)
97	        assert Bcfg2.Options.Option.cfpath == '/etc/bcfg2.conf'
98	        sys.argv = ['foo', '-C', '/usr/local/etc/bcfg2.conf']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:100:8
99	        os2 = Bcfg2.Options.OptionParser(opts)
100	        assert Bcfg2.Options.Option.cfpath == '/usr/local/etc/bcfg2.conf'
101	        sys.argv = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestOptions.py:103:8
102	        os3 = Bcfg2.Options.OptionParser(opts)
103	        assert Bcfg2.Options.Option.cfpath == '/etc/bcfg2.conf'

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\testsuite\TestPlugin.py:2:0
1	import gamin
2	import lxml.etree
3	import os

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\testsuite\TestPlugin.py:36:23
35	    def __init__(self):
36	        self.dirname = '/tmp/estest-%d' % os.getpid()
37	        os.path.isdir(self.dirname) or os.mkdir(self.dirname)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:49:8
48	        es.handle_event(e)
49	        assert len(es.entries) == 1
50	        assert list(es.entries.values())[0].handled == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:50:8
49	        assert len(es.entries) == 1
50	        assert list(es.entries.values())[0].handled == 2
51	        e.action = 'changed'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:53:8
52	        es.handle_event(e)
53	        assert list(es.entries.values())[0].handled == 3
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:63:8
62	        # test 'info' handling
63	        assert es.metadata['group'] == 'root'
64	        self.mk_info(dirname)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:68:8
67	        es.handle_event(e)
68	        assert es.metadata['group'] == 'sys'
69	        e.action = 'deleted'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:71:8
70	        es.handle_event(e)
71	        assert es.metadata['group'] == 'root'
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:74:8
73	        # test 'info.xml' handling
74	        assert es.infoxml == None
75	        self.mk_info_xml(dirname)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:79:8
78	        es.handle_event(e)
79	        assert es.infoxml
80	        e.action = 'deleted'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:82:8
81	        es.handle_event(e)
82	        assert es.infoxml == None
83	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:90:8
89	        print(list(self.es.entries.values())[0])
90	        assert list(self.es.entries.values())[0].built == 1
91	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:97:8
96	        self.es.handle_event(self.e)
97	        assert len(self.es.entries) == 1
98	        ent = lxml.etree.Element('foo')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\testsuite\TestPlugin.py:108:8
107	        self.es.handle_event(self.e)
108	        assert len(self.es.entries) == 0
109	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tools\batchadd.py:98:8
97	            handle_error(info[host][1])
98	        except:
99	            # do something here
100	            pass
101	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tools\batchadd.py:108:8
107	            handle_error(info[mac_addr][1])
108	        except:
109	            # do something here
110	            pass
111	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\create-debian-pkglist-gp.py:10:0
9	import sys
10	import subprocess
11	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tools\create-rpm-pkglist.py:32:0
31	
32	from lxml import etree
33	from optparse import OptionParser

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\create-rpm-pkglist.py:110:15
109	    if options.show == True:
110	        tree = etree.parse(filename)
111	        for node in tree.findall("//Package"):

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\create-rpm-pkglist.py:117:15
116	    if options.pkgversion == True:
117	        tree = etree.parse(filename)
118	        for node in tree.findall("//Package"):

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tools\hostbase.py:74:14
73	    """Provides pre-filled template to copy a host record"""
74	    fd = open('/tmp/hostbase.%s.tmp' % host.id, 'w')
75	    fd.write(hostinfo)

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\tools\hostbase.py:77:4
76	    fd.close()
77	    os.system('vi + /tmp/hostbase.%s.tmp' % host.id)
78	    os.system('batchadd.py /tmp/hostbase.%s.tmp' % host.id)

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\tools\hostbase.py:78:4
77	    os.system('vi + /tmp/hostbase.%s.tmp' % host.id)
78	    os.system('batchadd.py /tmp/hostbase.%s.tmp' % host.id)
79	    os.system('rm /tmp/hostbase.%s.tmp' % host.id)

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\tools\hostbase.py:79:4
78	    os.system('batchadd.py /tmp/hostbase.%s.tmp' % host.id)
79	    os.system('rm /tmp/hostbase.%s.tmp' % host.id)

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\tools\hostbasepush.py:16:0
15	print("running bcfg...")
16	os.system('bcfg2 -q -d -v')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\hostbasepush.py:16:0
15	print("running bcfg...")
16	os.system('bcfg2 -q -d -v')

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\tools\hostinfo.py:30:4
29	        hostnames += each[0] + " "
30	    system("fping -r 1" + hostnames)
31	    sys.exit()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\tools\hostinfo.py:118:16
117	        fields = "h.hostname, h.whatami, h.location, h.primary_user"
118	        query = """SELECT DISTINCT %s FROM (((((hostbase_host h
119	        INNER JOIN hostbase_interface i ON h.id = i.host_id)
120	        INNER JOIN hostbase_ip p ON i.id = p.interface_id)
121	        INNER JOIN hostbase_name n ON p.id = n.ip_id)
122	        INNER JOIN hostbase_name_mxs x ON x.name_id = n.id)
123	        INNER JOIN hostbase_mx m ON m.id = x.mx_id)
124	        LEFT JOIN hostbase_cname c ON n.id = c.name_id
125	        WHERE %s ORDER BY h.hostname
126	        """ % (fields, queryoptions)
127	        cursor.execute(query)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\tools\hostinfo.py:144:16
143	            sys.exit()
144	        query = """SELECT DISTINCT %s FROM (((((hostbase_host h
145	        INNER JOIN hostbase_interface i ON h.id = i.host_id)
146	        INNER JOIN hostbase_ip p ON i.id = p.interface_id)
147	        INNER JOIN hostbase_name n ON p.id = n.ip_id)
148	        INNER JOIN hostbase_name_mxs x ON x.name_id = n.id)
149	        INNER JOIN hostbase_mx m ON m.id = x.mx_id)
150	        LEFT JOIN hostbase_cname c ON n.id = c.name_id
151	        WHERE %s ORDER BY h.hostname
152	        """ % (fields, queryoptions)
153	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tools\nagiosgen-convert.py:5:0
4	import sys
5	import lxml.etree
6	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\nagiosgen-convert.py:30:16
29	
30	    oldconfig = lxml.etree.parse(oldconfigfile)
31	    for host in oldconfig.getroot().getchildren():

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\nagiosgen-convert.py:49:24
48	    if os.path.exists(parentsfile):
49	        parentsconfig = lxml.etree.parse(parentsfile)
50	        for el in parentsconfig.xpath("//Depend"):

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tools\packages-convert.py:5:0
4	import sys
5	import lxml.etree
6	from Bcfg2.Bcfg2Py3k import ConfigParser

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\packages-convert.py:54:16
53	
54	    oldconfig = lxml.etree.parse(oldconfigfile).getroot()
55	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\packages-convert.py:68:20
67	        oldfile = oldsources.pop()
68	        oldsource = lxml.etree.parse(oldfile).getroot()
69	

--------------------------------------------------
>> Issue: [B410:blacklist] Using parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace parse with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tools\pkgmgr_gen.py:22:0
21	import sys
22	from lxml.etree import parse
23	import xml.sax

--------------------------------------------------
>> Issue: [B406:blacklist] Using xml.sax to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.sax with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\tools\pkgmgr_gen.py:23:0
22	from lxml.etree import parse
23	import xml.sax
24	from xml.sax.handler import ContentHandler

--------------------------------------------------
>> Issue: [B406:blacklist] Using ContentHandler to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ContentHandler with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\tools\pkgmgr_gen.py:24:0
23	import xml.sax
24	from xml.sax.handler import ContentHandler
25	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\pkgmgr_gen.py:272:19
271	        try:
272	            tree = parse(file)
273	        except IOError:

--------------------------------------------------
>> Issue: [B317:blacklist] Using xml.sax.make_parser to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.sax.make_parser with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-sax
   Location: .\tools\pkgmgr_gen.py:301:17
300	
301	        parser = xml.sax.make_parser()
302	        parser.setContentHandler(PrimaryParser(packages))

--------------------------------------------------
>> Issue: [B410:blacklist] Using parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace parse with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tools\pkgmgr_update.py:28:4
27	try:
28	    from lxml.etree import parse, tostring
29	except:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tools\posixunified.py:4:0
3	from copy import deepcopy
4	import lxml.etree
5	import os

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\tools\posixunified.py:36:24
35	                    continue
36	                xdata = lxml.etree.parse(os.path.join(root, filename))
37	                # replace ConfigFile elements

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\rpmlisting.py:5:0
4	import sys
5	import subprocess
6	import getopt

--------------------------------------------------

Code scanned:
	Total lines of code: 25342
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 178
		Medium: 64
		High: 20
	Total issues (by confidence):
		Undefined: 0
		Low: 6
		Medium: 15
		High: 241
Files skipped (8):
	.\src\lib\Client\Tools\YUMng.py (syntax error while parsing AST from file)
	.\src\lib\Server\Admin\Bundle.py (syntax error while parsing AST from file)
	.\src\lib\Server\Core.py (syntax error while parsing AST from file)
	.\src\lib\Server\Lint\Genshi.py (syntax error while parsing AST from file)
	.\src\lib\Server\Plugins\Svn2.py (syntax error while parsing AST from file)
	.\tools\bcfg2-profile-templates.py (syntax error while parsing AST from file)
	.\tools\bcfg2_svnlog.py (syntax error while parsing AST from file)
	.\tools\export.py (syntax error while parsing AST from file)
