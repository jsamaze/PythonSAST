Working... ---------------------------------------- 100% 0:00:01
Run started:2024-02-10 20:39:34.266943

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup.py:11:0
10	import os
11	import subprocess
12	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup.py:32:15
31	        try:
32	          rc = subprocess.call(['msgfmt', '-o', mo, po])
33	          if rc != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:32:15
31	        try:
32	          rc = subprocess.call(['msgfmt', '-o', mo, po])
33	          if rc != 0:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\sos\archive.py:30:0
29	# required for compression callout (FIXME: move to policy?)
30	from subprocess import Popen, PIPE
31	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\sos\archive.py:402:20
401	                command = shlex.split("%s %s" % (cmd, self.name()))
402	                p = Popen(command,
403	                          stdout=PIPE,
404	                          stderr=PIPE,
405	                          bufsize=-1,
406	                          close_fds=True)
407	                stdout, stderr = p.communicate()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sos\archive.py:426:12
425	            import zlib
426	            assert zlib
427	            self.compression = zipfile.ZIP_DEFLATED

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sos\plugins\abrt.py:35:38
34	        result = self.call_ext_prog('sqlite3 '
35	                                    + '/var/spool/abrt/abrt-db \'select UUID '
36	                                    'from abrt_v4\'')
37	        try:
38	            for uuid in result['output'].split():

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\gluster.py:28:20
27	
28	    statedump_dir = '/tmp/glusterfs-statedumps'
29	    packages = ["glusterfs", "glusterfs-core"]

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\plugins\gluster.py:49:8
48	            os.mkdir(name_dir)
49	        except:
50	            pass
51	        fp = open('/tmp/glusterdump.options', 'w')

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\gluster.py:51:18
50	            pass
51	        fp = open('/tmp/glusterdump.options', 'w')
52	        data = 'path=' + name_dir + '\n'

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\gluster.py:76:22
75	            os.rmdir(self.statedump_dir)
76	            os.unlink('/tmp/glusterdump.options')
77	        except:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\plugins\gluster.py:77:8
76	            os.unlink('/tmp/glusterdump.options')
77	        except:
78	            pass
79	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\gluster.py:103:31
102	            self.wait_for_statedump(self.statedump_dir)
103	            self.add_copy_spec('/tmp/glusterdump.options')
104	            self.add_copy_spec(self.statedump_dir)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '(password )\s*(\S*)\s*(\S*)'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\sos\plugins\grub2.py:44:21
43	        # causing the passwd_exp to match pbkdf2 passwords and mangle them.
44	        passwd_exp = r"(password )\s*(\S*)\s*(\S*)"
45	        passwd_pbkdf2_exp = r"(password_pbkdf2)\s*(\S*)\s*(\S*)"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '(password_pbkdf2)\s*(\S*)\s*(\S*)'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\sos\plugins\grub2.py:45:28
44	        passwd_exp = r"(password )\s*(\S*)\s*(\S*)"
45	        passwd_pbkdf2_exp = r"(password_pbkdf2)\s*(\S*)\s*(\S*)"
46	        passwd_sub = r"\1 \2 ********"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '\1 \2 ********'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\sos\plugins\grub2.py:46:21
45	        passwd_pbkdf2_exp = r"(password_pbkdf2)\s*(\S*)\s*(\S*)"
46	        passwd_sub = r"\1 \2 ********"
47	        passwd_pbkdf2_sub = r"\1 \2 grub.pbkdf2.********"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '\1 \2 grub.pbkdf2.********'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\sos\plugins\grub2.py:47:28
46	        passwd_sub = r"\1 \2 ********"
47	        passwd_pbkdf2_sub = r"\1 \2 grub.pbkdf2.********"
48	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\plugins\nfsserver.py:40:8
39	                return True
40	        except:
41	            pass
42	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\ovirt.py:103:12
102	            "/var/lib/ovirt-engine/external_truststore",
103	            "/var/tmp/ovirt-engine/config",
104	            "/var/lib/ovirt-engine/jboss_runtime/config",
105	            "/var/lib/ovirt-engine-reports/jboss_runtime/config"
106	        ])
107	
108	    def postproc(self):
109	        """
110	        Obfuscate sensitive keys.
111	        """
112	        self.do_file_sub(
113	            "/etc/ovirt-engine/engine-config/engine-config.properties",
114	            r"Password.type=(.*)",
115	            r"Password.type=********"
116	        )
117	        self.do_file_sub(
118	            "/etc/rhevm/rhevm-config/rhevm-config.properties",
119	            r"Password.type=(.*)",
120	            r"Password.type=********"
121	        )
122	
123	        engine_files = (

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\ovirt.py:132:16
131	            self.do_file_sub(
132	                "/var/tmp/ovirt-engine/config/%s" % filename,
133	                r"<password>(.*)</password>",

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\plugins\pcp.py:64:12
63	                env_vars[key] = value
64	            except:
65	                pass
66	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ' (password visible in process listings)'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\sos\plugins\postgresql.py:37:25
36	
37	    password_warn_text = " (password visible in process listings)"
38	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\satellite.py:56:12
55	            "/opt/notification/var/*.log*",
56	            "/var/tmp/ack_handler.log*",
57	            "/var/tmp/enqueue.log*"
58	        ])
59	
60	        # monitoring scout logs
61	        self.add_copy_spec([

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\satellite.py:57:12
56	            "/var/tmp/ack_handler.log*",
57	            "/var/tmp/enqueue.log*"
58	        ])
59	
60	        # monitoring scout logs
61	        self.add_copy_spec([
62	            "/home/nocpulse/var/*.log*",

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\satellite.py:64:12
63	            "/home/nocpulse/var/commands/*.log*",
64	            "/var/tmp/ack_handler.log*",
65	            "/var/tmp/enqueue.log*",
66	            "/var/log/nocpulse/*.log*",
67	            "/var/log/notification/*.log*",
68	            "/var/log/nocpulse/TSDBLocalQueue/TSDBLocalQueue.log"
69	        ])
70	
71	        self.add_copy_spec("/root/ssl-build")
72	        self.add_cmd_output("rhn-schema-version",
73	                            root_symlink="database-schema-version")

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\plugins\satellite.py:65:12
64	            "/var/tmp/ack_handler.log*",
65	            "/var/tmp/enqueue.log*",
66	            "/var/log/nocpulse/*.log*",
67	            "/var/log/notification/*.log*",
68	            "/var/log/nocpulse/TSDBLocalQueue/TSDBLocalQueue.log"
69	        ])
70	
71	        self.add_copy_spec("/root/ssl-build")
72	        self.add_cmd_output("rhn-schema-version",
73	                            root_symlink="database-schema-version")
74	        self.add_cmd_output("rhn-charsets",

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\policies\redhat.py:30:0
29	    from rhn import rpclib
30	except:
31	    # might fail if non-RHEL
32	    pass
33	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\sos\policies\redhat.py:39:15
38	    vendor_url = "http://www.redhat.com/"
39	    _tmp_dir = "/var/tmp"
40	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\sos\policies\redhat.py:66:8
65	    def runlevel_by_service(self, name):
66	        from subprocess import Popen, PIPE
67	        ret = []

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\sos\policies\redhat.py:69:12
68	        p = Popen("LC_ALL=C /sbin/chkconfig --list %s" % name,
69	                  shell=True,
70	                  stdout=PIPE,
71	                  stderr=PIPE,
72	                  bufsize=-1,
73	                  close_fds=True)
74	        out, err = p.communicate()
75	        if err:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\policies\redhat.py:80:12
79	                (runlevel, onoff) = tabs.split(":", 1)
80	            except:
81	                pass
82	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\policies\redhat.py:144:8
143	                return 7
144	        except:
145	            pass
146	        return False

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\sosreport.py:92:12
91	                f.close()
92	            except Exception:
93	                pass
94	            try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\sosreport.py:96:12
95	                os.unlink(fname)
96	            except Exception:
97	                pass
98	        self.files = []

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\sosreport.py:129:12
128	                lvalue = value.split(",")
129	            except:
130	                pass
131	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\sosreport.py:625:8
624	            signal.signal(signal.SIGTERM, self.get_exit_handler())
625	        except Exception:
626	            pass  # not available in java, but we don't care
627	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\sosreport.py:938:24
937	                            val = int(val)
938	                        except:
939	                            pass
940	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sos\sosreport.py:1186:16
1185	                                             os.stat(oneFile["srcpath"]))
1186	                except:
1187	                    pass
1188	        try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\sos\utilities.py:20:0
19	import inspect
20	from subprocess import Popen, PIPE, STDOUT
21	import zipfile

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\sos\utilities.py:146:12
145	    try:
146	        p = Popen(args, shell=False, stdout=PIPE, stderr=STDOUT,
147	                  bufsize=-1, env=cmd_env, close_fds=True,
148	                  preexec_fn=_child_chdir)
149	    except OSError as e:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\plugin_tests.py:262:36
261	        fn2 = create_file(2)
262	        self.mp.add_copy_spec_limit("/tmp/tmp*", 1)
263	        self.assertEquals(len(self.mp.copy_strings), 1)

--------------------------------------------------

Code scanned:
	Total lines of code: 8634
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 27
		Medium: 13
		High: 1
	Total issues (by confidence):
		Undefined: 0
		Low: 1
		Medium: 17
		High: 23
Files skipped (1):
	.\tests\test_exe.py (syntax error while parsing AST from file)
