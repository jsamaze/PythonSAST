Run started:2024-02-10 20:39:44.529899

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\attic\_version.py:17:0
16	
17	import subprocess
18	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\attic\_version.py:23:12
22	        # remember shell=False, so use git.cmd on windows, not just git
23	        p = subprocess.Popen(args, stdout=subprocess.PIPE, cwd=cwd)
24	    except EnvironmentError:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\attic\archive.py:590:12
589	                archive = msgpack.unpackb(data)
590	            except:
591	                continue
592	            if isinstance(archive, dict) and b'items' in archive and b'cmdline' in archive:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\archive.py:621:16
620	            except KeyError:
621	                assert cdata is not None
622	                self.chunks[id_] = 1, size, csize

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\key.py:244:8
243	        d = msgpack.unpackb(data)
244	        assert d[b'version'] == 1
245	        assert d[b'algorithm'] == b'sha256'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\key.py:245:8
244	        assert d[b'version'] == 1
245	        assert d[b'algorithm'] == b'sha256'
246	        key = pbkdf2_sha256(passphrase.encode('utf-8'), d[b'salt'], d[b'iterations'], 32)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\attic\remote.py:7:0
6	import shutil
7	from subprocess import Popen, PIPE
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\attic\remote.py:110:17
109	            args += ['attic', 'serve']
110	        self.p = Popen(args, bufsize=0, stdin=PIPE, stdout=PIPE)
111	        self.stdin_fd = self.p.stdin.fileno()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\remote.py:283:8
282	        data = self.data_fd.read(size)
283	        assert len(data) == size
284	        return data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:194:16
193	                            self.io.write_delete(key)
194	                assert segments[segment] == 0
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:198:12
197	        for segment in sorted(self.compact):
198	            assert self.segments.pop(segment) == 0
199	            self.io.delete_segment(segment)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:249:8
248	
249	        assert not self._active_txn
250	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:384:4
383	    header_fmt = struct.Struct('<IIB')
384	    assert header_fmt.size == 9
385	    put_header_fmt = struct.Struct('<IIB32s')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:386:4
385	    put_header_fmt = struct.Struct('<IIB32s')
386	    assert put_header_fmt.size == 41
387	    header_no_crc_fmt = struct.Struct('<IB')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:388:4
387	    header_no_crc_fmt = struct.Struct('<IB')
388	    assert header_no_crc_fmt.size == 5
389	    crc_fmt = struct.Struct('<I')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\repository.py:390:4
389	    crc_fmt = struct.Struct('<I')
390	    assert crc_fmt.size == 4
391	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\attic\testsuite\archiver.py:4:0
3	import stat
4	import subprocess
5	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\attic\testsuite\archiver.py:79:25
78	            try:
79	                output = subprocess.check_output((sys.executable, '-m', 'attic.archiver') + args)
80	                ret = 0

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o7755 on file (input/file1).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\attic\testsuite\archiver.py:132:8
131	        # File mode
132	        os.chmod('input/file1', 0o7755)
133	        os.chmod('input/dir2', 0o555)

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o555 on file (input/dir2).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\attic\testsuite\archiver.py:133:8
132	        os.chmod('input/file1', 0o7755)
133	        os.chmod('input/dir2', 0o555)
134	        # Block device

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\attic\testsuite\archiver.py:167:8
166	        # end the same way as info_output
167	        assert info_output2.endswith(info_output)
168	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\attic\testsuite\archiver.py:274:8
273	        self.create_src_archive('test')
274	        os.system('chmod -R ugo-w ' + self.repository_path)
275	        try:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\attic\testsuite\archiver.py:279:12
278	            # Restore permissions so shutil.rmtree is able to delete it
279	            os.system('chmod -R u+w ' + self.repository_path)
280	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\attic\testsuite\archiver.py:324:16
323	            if sys.platform.startswith('linux'):
324	                os.system('fusermount -u ' + mountpoint)
325	            else:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\attic\testsuite\archiver.py:326:16
325	            else:
326	                os.system('umount ' + mountpoint)
327	            os.rmdir(mountpoint)

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\attic\testsuite\archiver.py:344:16
343	            if sys.platform.startswith('linux'):
344	                os.system('fusermount -u ' + mountpoint)
345	            else:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\attic\testsuite\archiver.py:346:16
345	            else:
346	                os.system('umount ' + mountpoint)
347	            os.rmdir(mountpoint)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'passphrase'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\attic\testsuite\archiver.py:369:19
368	        self.create_test_files()
369	        os.environ['ATTIC_PASSPHRASE'] = 'passphrase'
370	        self.attic('init', '--encryption=' + method, self.repository_location)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\attic\testsuite\helpers.py:202:26
201	        self.assert_equal(list(d.items()), [('bar', 2), ('baz', 4), ('boo', 3), ('foo', 1)])
202	        self.assert_equal(hashlib.md5(msgpack.packb(d)).hexdigest(), 'fc78df42cd60691b3ac3dd2a2b39903f')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\attic\testsuite\key.py:54:19
53	    def test_keyfile(self):
54	        os.environ['ATTIC_PASSPHRASE'] = 'test'
55	        key = KeyfileKey.create(self.MockRepository(), self.MockArgs())

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'passphrase'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\attic\testsuite\key.py:75:19
74	            fd.write(self.keyfile2_key_file)
75	        os.environ['ATTIC_PASSPHRASE'] = 'passphrase'
76	        key = KeyfileKey.detect(self.MockRepository(), self.keyfile2_cdata)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\attic\testsuite\key.py:80:19
79	    def test_passphrase(self):
80	        os.environ['ATTIC_PASSPHRASE'] = 'test'
81	        key = PassphraseKey.create(self.MockRepository(), None)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\versioneer.py:295:0
294	
295	import subprocess
296	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\versioneer.py:301:12
300	        # remember shell=False, so use git.cmd on windows, not just git
301	        p = subprocess.Popen(args, stdout=subprocess.PIPE, cwd=cwd)
302	    except EnvironmentError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\versioneer.py:559:4
558	def get_versions(default=DEFAULT, verbose=False):
559	    assert versionfile_source is not None, "please set versioneer.versionfile_source"
560	    assert tag_prefix is not None, "please set versioneer.tag_prefix"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\versioneer.py:560:4
559	    assert versionfile_source is not None, "please set versioneer.versionfile_source"
560	    assert tag_prefix is not None, "please set versioneer.tag_prefix"
561	    assert parentdir_prefix is not None, "please set versioneer.parentdir_prefix"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\versioneer.py:561:4
560	    assert tag_prefix is not None, "please set versioneer.tag_prefix"
561	    assert parentdir_prefix is not None, "please set versioneer.parentdir_prefix"
562	    return get_best_versions(versionfile_source, tag_prefix, parentdir_prefix,

--------------------------------------------------

Code scanned:
	Total lines of code: 5574
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 28
		Medium: 2
		High: 7
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 4
		High: 33
Files skipped (0):
