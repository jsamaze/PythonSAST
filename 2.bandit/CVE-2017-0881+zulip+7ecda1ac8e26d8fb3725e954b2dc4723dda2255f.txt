Working... ---------------------------------------- 100% 0:00:08
Run started:2024-02-10 20:57:37.187157

Test results:
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:137:27
136	    if analytics_table in (UserCount, StreamCount):
137	        realmcount_query = """
138	            INSERT INTO analytics_realmcount
139	                (realm_id, value, property, subgroup, end_time)
140	            SELECT
141	                zerver_realm.id, COALESCE(sum(%(analytics_table)s.value), 0), '%(property)s',
142	                %(analytics_table)s.subgroup, %%(end_time)s
143	            FROM zerver_realm
144	            JOIN %(analytics_table)s
145	            ON
146	            (
147	                %(analytics_table)s.realm_id = zerver_realm.id AND
148	                %(analytics_table)s.property = '%(property)s' AND
149	                %(analytics_table)s.end_time = %%(end_time)s
150	            )
151	            GROUP BY zerver_realm.id, %(analytics_table)s.subgroup
152	        """ % {'analytics_table': analytics_table._meta.db_table,
153	               'property': stat.property}
154	        start = time.time()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:160:30
159	    # Aggregate into InstallationCount
160	    installationcount_query = """
161	        INSERT INTO analytics_installationcount
162	            (value, property, subgroup, end_time)
163	        SELECT
164	            sum(value), '%(property)s', analytics_realmcount.subgroup, %%(end_time)s
165	        FROM analytics_realmcount
166	        WHERE
167	        (
168	            property = '%(property)s' AND
169	            end_time = %%(end_time)s
170	        ) GROUP BY analytics_realmcount.subgroup
171	    """ % {'property': stat.property}
172	    start = time.time()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:45:29
44	        for i in range(days):
45	            holidays.extend([random() < holiday_rate] * 24)
46	    elif frequency == CountStat.DAY:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:50:20
49	                      [24*non_business_hours_base] * 2
50	        holidays = [random() < holiday_rate for i in range(days)]
51	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:152:22
151	        # type: (datetime) -> CountStat
152	        dummy_query = """INSERT INTO analytics_realmcount (realm_id, property, end_time, value)
153	                                VALUES (1, 'test stat', '%(end_time)s', 22)""" % {'end_time': current_time}
154	        count_stat = CountStat('test stat', ZerverCountQuery(Recipient, UserCount, dummy_query),

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\analytics\views.py:338:8
337	            row['hours_per_user'] = '%.1f' % (hours / row['active_user_count'],)
338	        except Exception:
339	            pass
340	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\views.py:533:16
532	
533	        query = '''
534	            select
535	                realm.string_id,
536	                up.id user_id,
537	                client.name,
538	                sum(count) as hits,
539	                max(last_visit) as last_time
540	            from zerver_useractivity ua
541	            join zerver_client client on client.id = ua.client_id
542	            join zerver_userprofile up on up.id = ua.user_profile_id
543	            join zerver_realm realm on realm.id = up.realm_id
544	            where
545	                client.name like '%s'
546	            group by string_id, up.id, client.name
547	            having max(last_visit) > now() - interval '2 week'
548	            order by string_id, up.id, client.name
549	        ''' % (mobile_type,)
550	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\api\integrations\asana\zulip_asana_config.py:46:14
45	# It is required and needs to be writeable.
46	RESUME_FILE = "/var/tmp/zulip_asana.state"
47	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'p455w0rd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\api\integrations\basecamp\zulip_basecamp_config.py:27:20
26	BASECAMP_USERNAME = "foo@example.com"
27	BASECAMP_PASSWORD = "p455w0rd"
28	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\api\integrations\basecamp\zulip_basecamp_config.py:51:14
50	# It is required and needs to be writeable.
51	RESUME_FILE = "/var/tmp/zulip_basecamp.state"

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\api\integrations\codebase\zulip_codebase_config.py:60:14
59	# It is required and needs to be writeable.
60	RESUME_FILE = "/var/tmp/zulip_codebase.state"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\perforce\git_p4.py:25:0
24	import marshal
25	import subprocess
26	import tempfile

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\perforce\git_p4.py:34:4
33	try:
34	    from subprocess import CalledProcessError
35	except ImportError:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:104:8
103	    expand = isinstance(c, six.string_types)
104	    p = subprocess.Popen(c, stdin=subprocess.PIPE, shell=expand)
105	    pipe = p.stdin

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:122:8
121	    expand = isinstance(c, six.string_types)
122	    p = subprocess.Popen(c, stdout=subprocess.PIPE, shell=expand)
123	    pipe = p.stdout

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:139:8
138	    expand = isinstance(c, six.string_types)
139	    p = subprocess.Popen(c, stdout=subprocess.PIPE, shell=expand)
140	    pipe = p.stdout

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:156:8
155	    real_cmd = p4_build_cmd(["help", cmd])
156	    p = subprocess.Popen(real_cmd, stdout=subprocess.PIPE,
157	                         stderr=subprocess.PIPE)
158	    p.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:170:8
169	    cmd = p4_build_cmd(["move", "-k", "@from", "@to"])
170	    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
171	    (out, err) = p.communicate()

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:184:14
183	        sys.stderr.write("executing %s\n" % str(cmd))
184	    retcode = subprocess.call(cmd, shell=expand)
185	    if retcode:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:192:14
191	    expand = isinstance(real_cmd, six.string_types)
192	    retcode = subprocess.call(real_cmd, shell=expand)
193	    if retcode:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:461:9
460	    p4 = subprocess.Popen(cmd,
461	                          shell=expand,
462	                          stdin=stdin_file,
463	                          stdout=subprocess.PIPE)
464	
465	    result = []

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b302-marshal
   Location: .\api\integrations\perforce\git_p4.py:468:20
467	        while True:
468	            entry = marshal.load(p4.stdout)
469	            if cb is not None:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\perforce\git_p4.py:580:11
579	def gitBranchExists(branch):
580	    proc = subprocess.Popen(["git", "rev-parse", branch],
581	                            stderr=subprocess.PIPE, stdout=subprocess.PIPE);
582	    return proc.wait() == 0;

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:580:11
579	def gitBranchExists(branch):
580	    proc = subprocess.Popen(["git", "rev-parse", branch],
581	                            stderr=subprocess.PIPE, stdout=subprocess.PIPE);
582	    return proc.wait() == 0;

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:647:8
646	    cmd = [ "git", "rev-parse", "--symbolic", "--verify", branch ]
647	    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
648	    out, _ = p.communicate()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\integrations\perforce\git_p4.py:732:4
731	def p4ChangesForPaths(depotPaths, changeRange):
732	    assert depotPaths
733	    cmd = ['changes']

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\api\integrations\perforce\git_p4.py:1305:11
1304	
1305	        if os.system(tryPatchCmd) != 0:
1306	            fixed_rcs_keywords = False

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\api\integrations\perforce\git_p4.py:1342:19
1341	                print("Retrying the patch with RCS keywords cleaned up")
1342	                if os.system(tryPatchCmd) == 0:
1343	                    patch_succeeded = True

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\perforce\git_p4.py:2924:29
2923	
2924	        self.importProcess = subprocess.Popen(["git", "fast-import"],
2925	                                              stdin=subprocess.PIPE,
2926	                                              stdout=subprocess.PIPE,
2927	                                              stderr=subprocess.PIPE);
2928	        self.gitOutput = self.importProcess.stdout

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:2924:29
2923	
2924	        self.importProcess = subprocess.Popen(["git", "fast-import"],
2925	                                              stdin=subprocess.PIPE,
2926	                                              stdout=subprocess.PIPE,
2927	                                              stderr=subprocess.PIPE);
2928	        self.gitOutput = self.importProcess.stdout

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\api\integrations\perforce\git_p4.py:3049:11
3048	    def rebase(self):
3049	        if os.system("git update-index --refresh") != 0:
3050	            die("Some files in your working directory are modified and different than what is in your index. You can use git update-index <filename> to bring the index up-to-date or stash away all your changes with git stash.");

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\perforce\git_p4.py:3049:11
3048	    def rebase(self):
3049	        if os.system("git update-index --refresh") != 0:
3050	            die("Some files in your working directory are modified and different than what is in your index. You can use git update-index <filename> to bring the index up-to-date or stash away all your changes with git stash.");

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:3133:18
3132	            init_cmd.append("--bare")
3133	        retcode = subprocess.call(init_cmd)
3134	        if retcode:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\setup.py:84:8
83	        import requests
84	        assert(LooseVersion(requests.__version__) >= LooseVersion('0.12.1'))
85	    except (ImportError, AssertionError):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\zulip\__init__.py:49:0
48	# Older versions don't provide the 'json' attribute on responses.
49	assert(LooseVersion(requests.__version__) >= LooseVersion('0.12.1'))
50	# In newer versions, the 'json' attribute is a function, not a property

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\zulip\__init__.py:94:30
93	        delay_scale = int(2 ** (self.number_of_retries / 2.0 - 1)) + 1
94	        delay = delay_scale + random.randint(1, delay_scale)
95	        message = "Sleeping for %ss [max %s] before retrying." % (delay, delay_scale * 2)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bots\jabber_mirror.py:26:0
25	import sys
26	import subprocess
27	import os

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\jabber_mirror.py:48:14
47	    try:
48	        ret = subprocess.call(args)
49	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bots\zephyr_mirror.py:27:0
26	import sys
27	import subprocess
28	import os

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror.py:55:4
54	if options.sync_subscriptions:
55	    subprocess.call(args)
56	    sys.exit(0)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror.py:61:8
60	    if options.on_startup_command is not None:
61	        subprocess.call([options.on_startup_command])
62	    from zerver.lib.parallel import run_parallel

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror.py:68:8
67	        # type: (str) -> int
68	        subprocess.call(args + ["--shard=%s" % (shard,)])
69	        return 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror.py:79:8
78	    try:
79	        subprocess.call(args)
80	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bots\zephyr_mirror_backend.py:36:0
35	import time
36	import subprocess
37	import optparse

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\bots\zephyr_mirror_backend.py:217:20
216	        if (options.shard is not None and
217	                not hashlib.sha1(zephyr_class).hexdigest().startswith(options.shard)):
218	            # This stream is being handled by a different zephyr_mirror job.

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\bots\zephyr_mirror_backend.py:251:16
250	            try:
251	                os.execvp(os.path.join(options.root_path, "user_root", "zephyr_mirror_backend.py"), sys.argv)
252	            except Exception:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bots\zephyr_mirror_backend.py:338:8
337	    # decrypt the message!
338	    p = subprocess.Popen(["gpg",
339	                          "--decrypt",
340	                          "--no-options",
341	                          "--no-default-keyring",
342	                          "--keyring=/dev/null",
343	                          "--secret-keyring=/dev/null",
344	                          "--batch",
345	                          "--quiet",
346	                          "--no-use-agent",
347	                          "--passphrase-file",
348	                          keypath],
349	                         stdin=subprocess.PIPE,
350	                         stdout=subprocess.PIPE,
351	                         stderr=subprocess.PIPE)
352	    decrypted, _ = p.communicate(input=body)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror_backend.py:338:8
337	    # decrypt the message!
338	    p = subprocess.Popen(["gpg",
339	                          "--decrypt",
340	                          "--no-options",
341	                          "--no-default-keyring",
342	                          "--keyring=/dev/null",
343	                          "--secret-keyring=/dev/null",
344	                          "--batch",
345	                          "--quiet",
346	                          "--no-use-agent",
347	                          "--passphrase-file",
348	                          keypath],
349	                         stdin=subprocess.PIPE,
350	                         stdout=subprocess.PIPE,
351	                         stderr=subprocess.PIPE)
352	    decrypted, _ = p.communicate(input=body)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror_backend.py:576:8
575	    # type: (list, str) -> Tuple[int, str]
576	    p = subprocess.Popen(zwrite_args, stdin=subprocess.PIPE,
577	                         stdout=subprocess.PIPE, stderr=subprocess.PIPE)
578	    stdout, stderr = p.communicate(input=content.encode("utf-8"))

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bots\zephyr_mirror_backend.py:606:8
605	    # encrypt the message!
606	    p = subprocess.Popen(["gpg",
607	                          "--symmetric",
608	                          "--no-options",
609	                          "--no-default-keyring",
610	                          "--keyring=/dev/null",
611	                          "--secret-keyring=/dev/null",
612	                          "--batch",
613	                          "--quiet",
614	                          "--no-use-agent",
615	                          "--armor",
616	                          "--cipher-algo", "AES",
617	                          "--passphrase-file",
618	                          keypath],
619	                         stdin=subprocess.PIPE,
620	                         stdout=subprocess.PIPE,
621	                         stderr=subprocess.PIPE)
622	    encrypted, _ = p.communicate(input=content)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror_backend.py:606:8
605	    # encrypt the message!
606	    p = subprocess.Popen(["gpg",
607	                          "--symmetric",
608	                          "--no-options",
609	                          "--no-default-keyring",
610	                          "--keyring=/dev/null",
611	                          "--secret-keyring=/dev/null",
612	                          "--batch",
613	                          "--quiet",
614	                          "--no-use-agent",
615	                          "--armor",
616	                          "--cipher-algo", "AES",
617	                          "--passphrase-file",
618	                          keypath],
619	                         stdin=subprocess.PIPE,
620	                         stdout=subprocess.PIPE,
621	                         stderr=subprocess.PIPE)
622	    encrypted, _ = p.communicate(input=content)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bots\zephyr_mirror_backend.py:1138:15
1137	            pgrep_query = "%s.*--user=%s" % (pgrep_query, options.user)
1138	        proc = subprocess.Popen(['pgrep', '-U', os.environ["USER"], "-f", pgrep_query],
1139	                                stdout=subprocess.PIPE,
1140	                                stderr=subprocess.PIPE)
1141	        out, _err_unused = proc.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bots\zephyr_mirror_backend.py:1138:15
1137	            pgrep_query = "%s.*--user=%s" % (pgrep_query, options.user)
1138	        proc = subprocess.Popen(['pgrep', '-U', os.environ["USER"], "-f", pgrep_query],
1139	                                stdout=subprocess.PIPE,
1140	                                stderr=subprocess.PIPE)
1141	        out, _err_unused = proc.communicate()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\bots\zephyr_mirror_backend.py:1163:31
1162	    if options.session_path is None:
1163	        options.session_path = "/var/tmp/%s" % (options.user,)
1164	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\commute_bot\commute_bot.py:216:12
215	                return
216	        r = requests.get('https://maps.googleapis.com/maps/api/' +
217	                         'distancematrix/json', params=params)
218	        result = validate_requests(r)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\commute_bot\commute_bot.py:245:4
244	                                'dog_foo=cat-foo'])
245	    assert result == dict(departure_time='2016,12,20,23,59,00',
246	                          dog_foo='cat-foo')
247	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\commute_bot\commute_bot.py:250:4
249	    result = handler.calculate_seconds('2016,12,20,23,59,00')
250	    assert result == str(1482278340)
251	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\commute_bot\commute_bot.py:255:4
254	    result = handler.get_api_key()
255	    assert result == 'abcdefghijksm'
256	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\define_bot\define_bot.py:53:29
52	                # Use OwlBot API to fetch definition.
53	                api_result = requests.get(DefineHandler.DEFINITION_API_URL.format(to_define_lower))
54	                # Convert API result from string to JSON format.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\encrypt_bot\encrypt_bot.py:55:4
54	if __name__ == '__main__':
55	    assert encrypt('ABCDabcd1234') == 'NOPQnopq1234'
56	    assert encrypt('NOPQnopq1234') == 'ABCDabcd1234'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\encrypt_bot\encrypt_bot.py:56:4
55	    assert encrypt('ABCDabcd1234') == 'NOPQnopq1234'
56	    assert encrypt('NOPQnopq1234') == 'ABCDabcd1234'

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\foursquare\foursquare.py:111:19
110	
111	        response = requests.get('https://api.foursquare.com/v2/venues/search?',
112	                                params=params)
113	        print(response.url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\foursquare\foursquare.py:139:4
138	    result = get_api_key()
139	    assert result == 'abcdefghijksm'
140	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\giphy\giphy.py:84:15
83	    try:
84	        data = requests.get(GIPHY_TRANSLATE_API, params=query)
85	    except requests.exceptions.ConnectionError as e:  # Usually triggered by bad connection.

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\contrib_bots\bots\tictactoe-bot\tictactoe-bot.py:135:27
134	            else:
135	                location = random.choice(corner_locations)
136	                row = location[0]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\contrib_bots\bots\tictactoe-bot\tictactoe-bot.py:183:27
182	            if blank_list == []:
183	                location = random.choice(blank_locations)
184	            else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\contrib_bots\bots\tictactoe-bot\tictactoe-bot.py:185:27
184	            else:
185	                location = random.choice(blank_list)
186	            row = location[0]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\contrib_bots\bots\tictactoe-bot\tictactoe-bot.py:192:23
191	        else:
192	            location = random.choice(blank_locations)
193	            row = location[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\virtual_fs\virtual_fs.py:19:8
18	    def handle_message(self, message, client, state_handler):
19	        assert self.triage_message(message, client)
20	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\contrib_bots\bots\virtual_fs\virtual_fs.py:75:4
74	    fs['user_paths'][user] = '/'
75	    assert is_directory(fs, '/')
76	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\wikipedia\wikipedia.py:54:19
53	        try:
54	            data = requests.get(query_wiki_link)
55	        except requests.exceptions.RequestException:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\xkcd\xkcd.py:102:21
101	        elif mode == XkcdBotCommand.RANDOM:  # Fetch a random comic strip.
102	            latest = requests.get(LATEST_XKCD_URL)
103	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\contrib_bots\bots\xkcd\xkcd.py:108:24
107	            latest_id = latest.json()['num']
108	            random_id = randint(1, latest_id)
109	            url = XKCD_TEMPLATE_URL % (str(random_id))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib_bots\bots\xkcd\xkcd.py:116:18
115	
116	        fetched = requests.get(url)
117	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\manage.py:5:0
4	import logging
5	import subprocess
6	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\manage.py:21:4
20	    logger = logging.getLogger("zulip.management")
21	    subprocess.check_call([os.path.join(BASE_DIR, "scripts", "lib", "log-management-command"),
22	                           " ".join(sys.argv)])
23	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\pgroonga\migrations\0001_enable.py:18:30
17	        operations = [
18	            migrations.RunSQL("""
19	ALTER ROLE %(USER)s SET search_path TO %(SCHEMA)s,public,pgroonga,pg_catalog;
20	
21	SET search_path = %(SCHEMA)s,public,pgroonga,pg_catalog;
22	
23	ALTER TABLE zerver_message ADD COLUMN search_pgroonga text;
24	
25	UPDATE zerver_message SET search_pgroonga = subject || ' ' || rendered_content;
26	
27	-- TODO: We want to use CREATE INDEX CONCURRENTLY but it can't be used in
28	-- transaction. Django uses transaction implicitly.
29	-- Django 1.10 may solve the problem.
30	CREATE INDEX zerver_message_search_pgroonga ON zerver_message
31	  USING pgroonga(search_pgroonga pgroonga.text_full_text_search_ops);
32	""" % database_setting,
33	                              """

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\puppet\zulip\files\postgresql\pg_backup_and_purge.py:7:0
6	import glob
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\puppet\zulip\files\postgresql\pg_backup_and_purge.py:25:8
24	
25	    p = subprocess.Popen(args, stdin=subprocess.PIPE, stdout=subprocess.PIPE,
26	                         stderr=subprocess.PIPE)
27	    stdout, stderr = p.communicate()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\hash_reqs.py:49:11
48	    deps_str = "\n".join(deps) + "\n"
49	    return hashlib.sha1(deps_str.encode('utf-8')).hexdigest()
50	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\node_cache.py:21:14
20	    # type: (Optional[List[str]], Optional[IO], Optional[IO], Optional[bool]) -> None
21	    sha1sum = hashlib.sha1()
22	    sha1sum.update(subprocess_text_output(['cat', 'package.json']).encode('utf8'))

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_path_on_import.py:18:4
17	    # this file will exist in production
18	    exec(open(activate_this).read(), {}, dict(__file__=activate_this))
19	sys.path.append(BASE_DIR)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\setup_venv.py:6:0
5	from os.path import dirname, abspath
6	import subprocess
7	from scripts.lib.zulip_tools import run

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:207:13
206	    path = os.path.join(ZULIP_PATH, 'scripts', 'lib', 'hash_reqs.py')
207	    output = subprocess.check_output([path, requirements_file], universal_newlines=True)
208	    sha1sum = output.split()[0]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_venv.py:224:4
223	    activate_this = os.path.join(cached_venv_path, "bin", "activate_this.py")
224	    exec(open(activate_this).read(), {}, dict(__file__=activate_this))
225	    return cached_venv_path

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_venv.py:245:4
244	    activate_this = os.path.join(venv_path, "bin", "activate_this.py")
245	    exec(open(activate_this).read(), {}, dict(__file__=activate_this))
246	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\zulip_tools.py:8:0
7	import shutil
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:30:11
29	    # type: (Sequence[str]) -> str
30	    return subprocess.check_output(args, universal_newlines=True).strip()
31	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:98:8
97	    try:
98	        subprocess.check_call(args, **kwargs)
99	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:17:4
16	    result = client.add_subscriptions(request)
17	    assert result['result'] == 'success'
18	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'temp'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tools\lib\api_tests.py:22:14
21	
22	    request = dict(
23	        email='newbie@zulip.com',
24	        full_name='New User',
25	        short_name='Newbie',
26	        password='temp',
27	    )
28	    result = client.create_user(request)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:29:4
28	    result = client.create_user(request)
29	    assert result['result'] == 'success'
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:35:4
34	    result = client.get_members()
35	    assert result['result'] == 'success'
36	    members = [m for m in result['members'] if m['email'] == 'newbie@zulip.com']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:37:4
36	    members = [m for m in result['members'] if m['email'] == 'newbie@zulip.com']
37	    assert len(members) == 1
38	    iago = members[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:40:4
39	
40	    assert not iago['is_admin']
41	    assert iago['full_name'] == 'New User'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:41:4
40	    assert not iago['is_admin']
41	    assert iago['full_name'] == 'New User'
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:47:4
46	    result = client.get_profile()
47	    assert result['is_admin']
48	    assert result['email'] == 'iago@zulip.com'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:48:4
47	    assert result['is_admin']
48	    assert result['email'] == 'iago@zulip.com'
49	    assert result['full_name'] == 'Iago'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:49:4
48	    assert result['email'] == 'iago@zulip.com'
49	    assert result['full_name'] == 'Iago'
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:56:4
55	    result = client.get_stream_id(stream_name)
56	    assert int(result['stream_id'])
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:62:4
61	    result = client.get_streams()
62	    assert result['result'] == 'success'
63	    streams = [s for s in result['streams'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:64:4
63	    streams = [s for s in result['streams'] if s['name'] == 'new stream']
64	    assert streams[0]['description'] == 'New stream for testing'
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:70:4
69	    result = client.get_subscribers(stream='new stream')
70	    assert result['subscribers'] == ['iago@zulip.com']
71	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:76:4
75	    result = client.get_user_agent()
76	    assert result.startswith('ZulipPython/')
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:82:4
81	    result = client.list_subscriptions()
82	    assert result['result'] == 'success'
83	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:84:4
83	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']
84	    assert streams[0]['description'] == 'New stream for testing'
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:90:4
89	    result = client.remove_subscriptions(['new stream'])
90	    assert result['result'] == 'success'
91	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:94:4
93	    result = client.list_subscriptions()
94	    assert result['result'] == 'success'
95	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:96:4
95	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']
96	    assert len(streams) == 0
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:103:4
102	    result = client.render_message(request)
103	    assert result['result'] == 'success'
104	    assert result['rendered'] == '<p><strong>foo</strong></p>'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:104:4
103	    assert result['result'] == 'success'
104	    assert result['rendered'] == '<p><strong>foo</strong></p>'
105	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:116:4
115	    result = client.send_message(request)
116	    assert result['result'] == 'success'
117	    message_id = result['id']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:125:4
124	    )
125	    assert result['result'] == 'success'
126	    assert result['raw_content'] == 'hello'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:126:4
125	    assert result['result'] == 'success'
126	    assert result['raw_content'] == 'hello'
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:133:4
132	
133	    assert int(message_id)
134	    request = dict(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:139:4
138	    result = client.update_message(request)
139	    assert result['result'] == 'success'
140	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:147:4
146	    )
147	    assert result['result'] == 'success'
148	    assert result['raw_content'] == 'new content'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:148:4
147	    assert result['result'] == 'success'
148	    assert result['raw_content'] == 'new content'
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:96:4
95	    # type: (List[Token], str, str) -> Union[CssNestedSection, CssSection]
96	    assert not ws(tokens[0].s)
97	    assert tokens[-1].s == '}' # caller should strip trailing fluff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:97:4
96	    assert not ws(tokens[0].s)
97	    assert tokens[-1].s == '}' # caller should strip trailing fluff
98	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:127:4
126	    start, pre_fluff = get_whitespace_and_comments(tokens, 0)
127	    assert pre_fluff == ''
128	    i = start

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:175:4
174	
175	    assert last_i is not None
176	    start, post_fluff = get_whitespace_and_comments(tokens, last_i)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:187:4
186	    # type: (List[Token]) -> CssDeclarationBlock
187	    assert tokens[0].s == '{' # caller should strip leading fluff
188	    assert tokens[-1].s == '}' # caller should strip trailing fluff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:188:4
187	    assert tokens[0].s == '{' # caller should strip leading fluff
188	    assert tokens[-1].s == '}' # caller should strip trailing fluff
189	    tokens = tokens[1:-1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:371:8
370	        self.post_fluff = post_fluff
371	        assert pre_fluff.strip() == ''
372	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\provision.py:8:0
7	import platform
8	import subprocess
9	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\provision.py:97:0
96	# know the codename.
97	subprocess.check_call(["sudo", "apt-get", "install", "-y", "lsb-release"])
98	vendor = subprocess_text_output(["lsb_release", "-is"])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\provision.py:97:0
96	# know the codename.
97	subprocess.check_call(["sudo", "apt-get", "install", "-y", "lsb-release"])
98	vendor = subprocess_text_output(["lsb_release", "-is"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:124:4
123	    # type: (Optional[str], Optional[str], bool) -> None
124	    assert fn or text
125	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_server.py:4:0
3	import os
4	import subprocess
5	import sys

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\lib\test_server.py:50:15
49	        # We could get a 501 error if the reverse proxy is up but the Django app isn't.
50	        return requests.get('http://127.0.0.1:9981/accounts/home').status_code == 200
51	    except:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:72:8
71	            generate_fixtures_command.append('--force')
72	        subprocess.check_call(generate_fixtures_command)
73	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:78:13
77	        run_dev_server_command.append('--force')
78	    server = subprocess.Popen(run_dev_server_command,
79	                              stdout=log, stderr=log)
80	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lister.py:8:0
7	import sys
8	import subprocess
9	import re

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lister.py:67:22
66	    # everything is UTF-8.
67	    repository_root = subprocess.check_output(['git', 'rev-parse', '--show-toplevel']).strip().decode('utf-8')
68	    exclude_abspaths = [os.path.join(repository_root, fpath).rstrip('/') for fpath in exclude]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lister.py:67:22
66	    # everything is UTF-8.
67	    repository_root = subprocess.check_output(['git', 'rev-parse', '--show-toplevel']).strip().decode('utf-8')
68	    exclude_abspaths = [os.path.join(repository_root, fpath).rstrip('/') for fpath in exclude]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lister.py:74:36
73	
74	    files_gen = (x.strip() for x in subprocess.check_output(cmdline, universal_newlines=True).split('\n'))
75	    # throw away empty lines and non-files (like symlinks)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\run-dev.py:8:0
7	import signal
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:116:0
115	# Clean up stale .pyc files etc.
116	subprocess.check_call('./tools/clean-repo')
117	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\run-dev.py:121:4
120	    print("Handlebars binary missing due to rebase past .gitignore fixup; fixing...")
121	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
122	    subprocess.check_call(["npm", "install"])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:121:4
120	    print("Handlebars binary missing due to rebase past .gitignore fixup; fixing...")
121	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
122	    subprocess.check_call(["npm", "install"])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\run-dev.py:122:4
121	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
122	    subprocess.check_call(["npm", "install"])
123	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:122:4
121	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
122	    subprocess.check_call(["npm", "install"])
123	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:126:4
125	    print("Clearing memcached ...")
126	    subprocess.check_call('./scripts/setup/flush-memcached')
127	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:147:4
146	    # for the Casper tests.
147	    subprocess.check_call('./tools/webpack')
148	else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:151:4
150	for cmd in cmds:
151	    subprocess.Popen(cmd)
152	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\setup\emoji\emoji_setup_utils.py:222:12
221	        for name in names:
222	            assert (emoji_map[name] == codepoint)
223	        codepoint_to_names[codepoint] = names

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\test-help-documentation.py:6:0
5	import sys
6	import subprocess
7	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\test-help-documentation.py:32:0
31	
32	subprocess.check_call(['mkdir', '-p', 'var/help-documentation'])
33	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\test-help-documentation.py:32:0
31	
32	subprocess.check_call(['mkdir', '-p', 'var/help-documentation'])
33	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\test-help-documentation.py:38:10
37	with test_server_running(options.force, external_host, log_file=LOG_FILE, dots=True, use_db=False):
38	    ret = subprocess.call(('scrapy', 'crawl_with_status', 'help_documentation_crawler'),
39	                          cwd='tools/documentation_crawler')
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:393:16
392	            else:
393	                assert isinstance(profile, Deployment)
394	                request._email = "deployment:" + role

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:777:8
776	        # personals to yourself or to someone else, respectively.
777	        assert((len(recipients) == 1) or (len(recipients) == 2))
778	    elif (recipient.type == Recipient.STREAM or recipient.type == Recipient.HUDDLE):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:838:8
837	    for message in messages:
838	        assert message['message'].rendered_content is None
839	        rendered_content = render_incoming_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1046:12
1045	        except ValidationError as e:
1046	            assert isinstance(e.messages[0], six.string_types)
1047	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1326:12
1325	        except ValidationError as e:
1326	            assert isinstance(e.messages[0], six.string_types)
1327	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1345:4
1344	    # We render messages later in the process.
1345	    assert message.rendered_content is None
1346	

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.cElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\__init__.py:20:0
19	from six.moves import urllib
20	import xml.etree.cElementTree as etree
21	from xml.etree.cElementTree import Element, SubElement

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\__init__.py:21:0
20	import xml.etree.cElementTree as etree
21	from xml.etree.cElementTree import Element, SubElement
22	

--------------------------------------------------
>> Issue: [B313:blacklist] Using xml.etree.cElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-celementtree
   Location: .\zerver\lib\bugdown\__init__.py:272:14
271	    try:
272	        doc = etree.fromstring(''.join(head))
273	    except etree.ParseError:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\lib\bugdown\__init__.py:1059:8
1058	            del md.inlinePatterns['linebreak2']
1059	        except Exception:
1060	            pass
1061	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\cache.py:15:0
14	from zerver.lib.utils import statsd, statsd_key, make_safe_digest
15	import subprocess
16	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\cache.py:76:4
75	    # directory `var` should exist in production
76	    subprocess.check_call(["mkdir", "-p", os.path.join(settings.DEPLOY_ROOT, "var")])
77	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\cache.py:76:4
75	    # directory `var` should exist in production
76	    subprocess.check_call(["mkdir", "-p", os.path.join(settings.DEPLOY_ROOT, "var")])
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:214:12
213	            content = part.get_payload(decode=True)
214	            assert isinstance(content, binary_type)
215	            if charsets[idx]:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\export.py:16:0
15	import shutil
16	import subprocess
17	import tempfile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:102:0
101	]
102	assert set(NON_EXPORTED_TABLES).issubset(set(ALL_ZERVER_TABLES))
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:108:0
107	]
108	assert set(IMPLICIT_TABLES).issubset(set(ALL_ZERVER_TABLES))
109	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:113:0
112	]
113	assert set(ATTACHMENT_TABLES).issubset(set(ALL_ZERVER_TABLES))
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:211:8
210	
211	        assert table or custom_tables
212	        self.table = table

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:565:16
564	            if row['id'] in exportable_user_ids:
565	                assert not row['is_mirror_dummy']
566	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:781:8
780	        message_ids = set(m['id'] for m in message_chunk)
781	        assert len(message_ids.intersection(all_message_ids)) == 0
782	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:930:8
929	        mkdir_p(os.path.dirname(output_path))
930	        subprocess.check_call(["cp", "-a", local_path, output_path])
931	        stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:930:8
929	        mkdir_p(os.path.dirname(output_path))
930	        subprocess.check_call(["cp", "-a", local_path, output_path])
931	        stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:974:12
973	            mkdir_p(str(os.path.dirname(output_path)))
974	            subprocess.check_call(["cp", "-a", str(local_path), str(output_path)])
975	            stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:974:12
973	            mkdir_p(str(os.path.dirname(output_path)))
974	            subprocess.check_call(["cp", "-a", str(local_path), str(output_path)])
975	            stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1030:8
1029	    if not settings.TEST_SUITE:
1030	        assert threads >= 1
1031	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1032:4
1031	
1032	    assert os.path.exists("./manage.py")
1033	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\export.py:1084:23
1083	    is_done = not in_progress
1084	    in_progress_link = '/tmp/zulip-export-in-progress'
1085	    done_link = '/tmp/zulip-export-most-recent'

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\export.py:1085:16
1084	    in_progress_link = '/tmp/zulip-export-in-progress'
1085	    done_link = '/tmp/zulip-export-most-recent'
1086	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1090:8
1089	    else:
1090	        subprocess.check_call(['rm', '-f', in_progress_link])
1091	        new_target = done_link

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1090:8
1089	    else:
1090	        subprocess.check_call(['rm', '-f', in_progress_link])
1091	        new_target = done_link

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1093:4
1092	
1093	    subprocess.check_call(["ln", "-nsf", source, new_target])
1094	    if is_done:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1093:4
1092	
1093	    subprocess.check_call(["ln", "-nsf", source, new_target])
1094	    if is_done:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1104:8
1103	        # type: (str) -> int
1104	        subprocess.call(["./manage.py", 'export_usermessage_batch', '--path',
1105	                         str(output_dir), '--thread', shard])
1106	        return 0

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1328:12
1327	        if not os.path.exists(os.path.dirname(file_path)):
1328	            subprocess.check_call(["mkdir", "-p", os.path.dirname(file_path)])
1329	        shutil.copy(orig_file_path, file_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1328:12
1327	        if not os.path.exists(os.path.dirname(file_path)):
1328	            subprocess.check_call(["mkdir", "-p", os.path.dirname(file_path)])
1329	        shutil.copy(orig_file_path, file_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\i18n.py:47:4
46	    seconds = list(range(firsts_end, lang_len))
47	    assert len(firsts) + len(seconds) == lang_len
48	    for row in zip_longest(firsts, seconds):

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\logging_util.py:36:56
35	                    tb = force_bytes(str(record))
36	                key = self.__class__.__name__.upper() + hashlib.sha1(tb).hexdigest()
37	                duplicate = cache.get(key) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:161:12
160	        elif recipient_type in (Recipient.HUDDLE, Recipient.PERSONAL):
161	            assert not isinstance(display_recipient, Text)
162	            display_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:255:4
254	    '''
255	    assert Message.need_to_render_content(message.rendered_content,
256	                                          message.rendered_content_version,
257	                                          bugdown.version)
258	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:28:11
27	        validate(col)
28	    stmt = '''
29	        UPDATE %s
30	        SET (%s) = (%s)
31	        WHERE id >= %%s AND id < %%s
32	    ''' % (table, ', '.join(cols), ', '.join(['%s'] * len(cols)))
33	    print(stmt)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:34:34
33	    print(stmt)
34	    (min_id, max_id) = db.execute("SELECT MIN(id), MAX(id) FROM %s" % (table,))[0]
35	    if min_id is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:50:0
49	# `APNS_SANDBOX` should be a bool
50	assert isinstance(settings.APNS_SANDBOX, bool)
51	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:87:4
86	    code = error_response['status']
87	    assert isinstance(code, int)
88	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\test_fixtures.py:26:27
25	        with connection.cursor() as cursor:
26	            cursor.execute("SELECT 1 from pg_database WHERE datname='{}';".format(database_name))
27	            return_value = bool(cursor.fetchone())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\test_fixtures.py:84:30
83	    with open(target_hash_file) as f:
84	        target_hash_content = hashlib.sha1(f.read().encode('utf8')).hexdigest()
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:350:8
349	
350	        assert len(pattern_cnt) > 100
351	        untested_patterns = set([p for p in pattern_cnt if pattern_cnt[p] == 0])

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_runner.py:16:0
15	import os
16	import subprocess
17	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_runner.py:112:16
111	                print("Import test command: `%s`" % (' '.join(command),))
112	                subprocess.check_call(command)
113	            except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timestamp.py:51:4
50	    # type: (datetime.datetime) -> str
51	    assert is_timezone_aware(datetime_object)
52	    date_string = datetime_object.strftime('%Y-%m-%d %H:%M:%S%z')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:161:4
160	    uploaded_file_name = user_file.name
161	    assert isinstance(uploaded_file_name, str)
162	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\upload.py:319:19
318	            str(user_profile.realm_id),
319	            format(random.randint(0, 255), 'x'),
320	            random_name(18),

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\lib\url_preview\preview.py:50:15
49	    data = data or {}
50	    response = requests.get(url)
51	    if response.ok:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:153:4
152	
153	    assert db_chunk_size >= 2
154	    assert chunk_size >= 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:154:4
153	    assert db_chunk_size >= 2
154	    assert chunk_size >= 2
155	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:157:8
156	    if id_collector is not None:
157	        assert(len(id_collector) == 0)
158	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:183:8
182	        tup_ids = set([tup[0] for tup in tup_chunk])
183	        assert len(tup_ids) == len(tup_chunk)
184	        assert len(tup_ids.intersection(id_collector)) == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:184:8
183	        assert len(tup_ids) == len(tup_chunk)
184	        assert len(tup_ids.intersection(id_collector)) == 0
185	        id_collector.update(tup_ids)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\management\commands\deliver_email.py:86:22
85	
86	        with lockfile("/tmp/zulip_email_deliver.lockfile"):
87	            while True:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export.py:12:0
11	import shutil
12	import subprocess
13	import tempfile

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\management\commands\export.py:121:49
120	        if output_dir is None:
121	            output_dir = tempfile.mkdtemp(prefix="/tmp/zulip-export-")
122	        if os.path.exists(output_dir):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export.py:137:8
136	        os.chdir(os.path.dirname(output_dir))
137	        subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
138	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export.py:137:8
136	        os.chdir(os.path.dirname(output_dir))
137	        subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
138	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export_single_user.py:12:0
11	import shutil
12	import subprocess
13	import tempfile

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\management\commands\export_single_user.py:47:49
46	        if output_dir is None:
47	            output_dir = tempfile.mkdtemp(prefix="/tmp/zulip-export-")
48	        if os.path.exists(output_dir):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export_single_user.py:55:8
54	        tarball_path = output_dir.rstrip('/') + '.tar.gz'
55	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
56	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export_single_user.py:55:8
54	        tarball_path = output_dir.rstrip('/') + '.tar.gz'
55	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
56	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\zerver\management\commands\export_usermessage_batch.py:44:12
43	                shutil.move(partial_path, locked_path)
44	            except Exception:
45	                # Already claimed by another process
46	                continue
47	            logging.info("Thread %s processing %s" % (options['thread'], output_path))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\management\commands\gravatar_to_user_avatar.py:35:24
34	        gravatar_url = "https://secure.gravatar.com/avatar/%s?d=identicon" % (gravatar_hash(old_email),)
35	        gravatar_data = requests.get(gravatar_url).content
36	        gravatar_file = SimpleUploadedFile('gravatar.jpg', gravatar_data, 'image/jpeg')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\import.py:17:0
16	import os
17	import subprocess
18	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\import.py:58:8
57	        call_command('flush', verbosity=0, interactive=False)
58	        subprocess.check_call([os.path.join(settings.DEPLOY_ROOT, "scripts/setup/flush-memcached")])
59	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:105:4
104	    # type: (MutableMapping[str, Any], Text, str, str, Text, Text, int, Optional[AnyStr], Optional[Iterable[AnyStr]]) -> None
105	    assert error_content is None or error_content_iter is None
106	    if error_content is not None:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\middleware.py:214:23
213	        log_data["prof"].disable()
214	        profile_path = "/tmp/profile.data.%s.%s" % (path.split("/")[-1], int(time_delta * 1000),)
215	        log_data["prof"].dump_stats(profile_path)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:832:15
831	        where_clause = "UPPER(zerver_stream.name::text) IN (%s)" % (upper_list,)
832	        return get_active_streams(realm.id).select_related("realm").extra(
833	            where=[where_clause],
834	            params=stream_names)
835	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\templatetags\app_filters.py:82:11
81	    html = md_engine.convert(markdown_string)
82	    return mark_safe(html)

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\templatetags\app_filters.py:82:11
81	    html = md_engine.convert(markdown_string)
82	    return mark_safe(html)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:129:19
128	        user_profile = get_user_profile_by_email(email)
129	        password = "testpassword"
130	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:135:39
134	        self.verify_backend(EmailAuthBackend(),
135	                            bad_kwargs=dict(password=''),
136	                            good_kwargs=dict(password=password))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:157:43
156	            self.verify_backend(EmailAuthBackend(),
157	                                bad_kwargs=dict(password="wrong"),
158	                                good_kwargs=dict(password=password))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:164:19
163	        user_profile = get_user_profile_by_email(email)
164	        password = "testpassword"
165	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:222:19
221	        email = "hamlet@zulip.com"
222	        password = "test_password"
223	        user_profile = get_user_profile_by_email(email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:858:34
857	        result = self.client_post("/api/v1/fetch_api_key",
858	                                  dict(username=self.email,
859	                                       password="wrong"))
860	        self.assert_json_error(result, "Your username or password is incorrect.", 403)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:884:13
883	        }
884	        with self.settings(
885	                LDAP_APPEND_DOMAIN='zulip.com',
886	                AUTH_LDAP_BIND_PASSWORD='',
887	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
888	            result = self.client_post("/api/v1/fetch_api_key",

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testing'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:889:38
888	            result = self.client_post("/api/v1/fetch_api_key",
889	                                      dict(username=self.email,
890	                                           password="testing"))
891	        self.assert_json_success(result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1251:13
1250	        }
1251	        with self.settings(
1252	                LDAP_APPEND_DOMAIN='zulip.com',
1253	                AUTH_LDAP_BIND_PASSWORD='',
1254	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1255	            user_profile = self.backend.authenticate('hamlet@zulip.com', 'testing')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1266:13
1265	        }
1266	        with self.settings(
1267	                LDAP_APPEND_DOMAIN='zulip.com',
1268	                AUTH_LDAP_BIND_PASSWORD='',
1269	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1270	                user = self.backend.authenticate('hamlet@zulip.com', 'wrong')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1281:13
1280	        }
1281	        with self.settings(
1282	                LDAP_APPEND_DOMAIN='zulip.com',
1283	                AUTH_LDAP_BIND_PASSWORD='',
1284	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1285	                user = self.backend.authenticate('nonexistent@zulip.com', 'testing')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1373:13
1372	        }
1373	        with self.settings(
1374	                REALMS_HAVE_SUBDOMAINS=True,
1375	                LDAP_APPEND_DOMAIN='zulip.com',
1376	                AUTH_LDAP_BIND_PASSWORD='',
1377	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1378	            user_profile = self.backend.authenticate('hamlet@zulip.com', 'testing',

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1390:13
1389	        }
1390	        with self.settings(
1391	                REALMS_HAVE_SUBDOMAINS=True,
1392	                LDAP_APPEND_DOMAIN='zulip.com',
1393	                AUTH_LDAP_BIND_PASSWORD='',
1394	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1395	            user_profile = self.backend.authenticate('hamlet@zulip.com', 'testing',

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1407:13
1406	        }
1407	        with self.settings(
1408	                REALMS_HAVE_SUBDOMAINS=True,
1409	                LDAP_APPEND_DOMAIN='zulip.com',
1410	                AUTH_LDAP_BIND_PASSWORD='',
1411	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1412	            user_profile = self.backend.authenticate('hamlet@zulip.com', 'testing',

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1424:13
1423	        }
1424	        with self.settings(
1425	                REALMS_HAVE_SUBDOMAINS=True,
1426	                LDAP_APPEND_DOMAIN='zulip.com',
1427	                AUTH_LDAP_BIND_PASSWORD='',
1428	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1429	            user_profile = self.backend.authenticate('hamlet@zulip.com', 'testing',

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1442:13
1441	        }
1442	        with self.settings(
1443	                REALMS_HAVE_SUBDOMAINS=True,
1444	                LDAP_APPEND_DOMAIN='acme.com',
1445	                AUTH_LDAP_BIND_PASSWORD='',
1446	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=acme,dc=com'):
1447	            user_profile = self.backend.authenticate('nonexisting@acme.com', 'testing',

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:524:24
523	        email = "hamlet@zulip.com"
524	        test_password = "abcd1234"
525	        user_profile = get_user_profile_by_email(email)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:657:24
656	        user_profile = get_user_profile_by_email(email)
657	        test_password = "abcd1234"
658	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:781:17
780	        # type: () -> None
781	        secret = 'random'
782	        req = self.Request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:795:17
794	        # type: () -> None
795	        secret = 'random'
796	        req = self.Request(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'broken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:801:13
800	
801	        with self.settings(SHARED_SECRET='broken'):
802	            self.assertFalse(authenticate_notify(req))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:807:17
806	        # type: () -> None
807	        secret = 'random'
808	        req = self.Request(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:857:8
856	        user_email = 'webhook-bot@zulip.com'
857	        self._login(user_email, password="test")  # we set a password because user is a bot
858	        self.assert_json_error_contains(self._do_test(user_email), "Webhook bots can only access webhooks")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:863:8
862	        user_email = 'hamlet@zulip.com'
863	        self._login(user_email, password="test")
864	        # Get user_profile after _login so that we have the latest data.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_export.py:78:12
77	            # at first
78	            assert len(list(query)) > 0
79	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:475:8
474	        message = most_recent_message(user_profile)
475	        assert(UserMessage.objects.get(user_profile=user_profile, message=message).flags.mentioned.is_set)
476	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_messages.py:916:19
915	        user = get_user_profile_by_email(email)
916	        password = "test_password"
917	        user.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_messages.py:1632:14
1631	        parent = get_user_profile_by_email('othello@zulip.com')
1632	        bot = do_create_user(
1633	            email='othello-bot@zulip.com',
1634	            password='',
1635	            realm=parent.realm,
1636	            full_name='',
1637	            short_name='',
1638	            active=True,
1639	            bot_type=UserProfile.DEFAULT_BOT,
1640	            bot_owner=parent
1641	        )
1642	        bot.last_reminder = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:469:12
468	            # type: (Union[Text, List[Dict[str, Any]]]) -> Text
469	            assert isinstance(dr, list)
470	            return ','.join(sorted(set([r['email'] for r in dr] + [me])))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'new_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:207:8
206	        # log back in with new password
207	        self.login(email, password='new_password')
208	        user_profile = get_user_profile_by_email('hamlet@zulip.com')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:244:8
243	        # type: () -> None
244	        self.login("hamlet@zulip.com", password="wrongpassword", fails=True)
245	        self.assertIsNone(get_session_dict_user(self.client.session))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hmb'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:309:19
308	        email = "test@zulip.com"
309	        password = u"hmb"
310	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:744:19
743	        # type: () -> None
744	        password = "test"
745	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:784:19
783	        # type: () -> None
784	        password = "test"
785	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:830:19
829	        # type: () -> None
830	        password = "test"
831	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:870:19
869	        email = "newguy@zulip.com"
870	        password = "newpassword"
871	        realm = get_realm('zulip')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:897:19
896	        # type: () -> None
897	        password = "test"
898	        email = "user1@acme.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:943:19
942	        # type: () -> None
943	        password = "test"
944	        email = "user1@acme.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testing'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1013:19
1012	        # type: () -> None
1013	        password = "testing"
1014	        email = "newuser@zulip.com"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:1050:13
1049	
1050	        with self.settings(
1051	                POPULATE_PROFILE_VIA_LDAP=True,
1052	                LDAP_APPEND_DOMAIN='zulip.com',
1053	                AUTH_LDAP_BIND_PASSWORD='',
1054	                AUTH_LDAP_USER_ATTR_MAP=ldap_user_attr_map,
1055	                AUTHENTICATION_BACKENDS=('zproject.backends.ZulipLDAPAuthBackend',),
1056	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1057	            result = self.client_get(confirmation_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1096:19
1095	        # type: (Any) -> None
1096	        password = "test"
1097	        email = "sipbtest@mit.edu"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_subs.py:1140:41
1139	        for stream in existing_stream_names:
1140	            random_stream = stream + str(random.randint(0, 9))
1141	            if random_stream not in all_stream_names:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1457:8
1456	        self.assertEqual(len(recipients), 1)
1457	        assert isinstance(recipients, Sequence)
1458	        assert isinstance(recipients[0], Mapping)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1458:8
1457	        assert isinstance(recipients, Sequence)
1458	        assert isinstance(recipients[0], Mapping)
1459	        # The 2 assert statements above are required to make the mypy check pass.

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_templates.py:146:18
145	
146	        context = dict(
147	            article="templates/zerver/help/index.md",
148	            shallow_tested=True,
149	            user_profile=user_profile,
150	            user=user_profile,
151	            product_name='testing',
152	            form=DummyForm(
153	                full_name=get_form_value('John Doe'),
154	                terms=get_form_value(True),
155	                email=get_form_value(email),
156	                emails=get_form_value(email),
157	            ),
158	            current_url=lambda: 'www.zulip.com',
159	            hubot_lozenges_dict={},
160	            integrations_dict={},
161	            referrer=dict(
162	                full_name='John Doe',
163	                realm=dict(name='zulip.com'),
164	            ),
165	            uid='uid',
166	            token='token',
167	            message_count=0,
168	            messages=[dict(header='Header')],
169	            new_streams=dict(html=''),
170	            data=dict(title='Title'),
171	        )
172	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:318:12
317	            content = ujson.loads(result.content)
318	            assert sanitize_name(expected) in content['uri']
319	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\zerver\tests\test_upload.py:572:36
571	
572	        self.assertEqual(b"zulip!", urllib.request.urlopen(redirect_url).read().strip()) # type: ignore # six.moves.urllib.request.urlopen is not defined in typeshed
573	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\tests.py:54:0
53	import filecmp
54	import subprocess
55	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:470:49
469	
470	        result = self.client_post("/json/users", dict(
471	            email='romeo@not-zulip.com',
472	            password='xxxx',
473	        ))
474	        self.assert_json_error(result, "Missing 'full_name' argument")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:476:49
475	
476	        result = self.client_post("/json/users", dict(
477	            email='romeo@not-zulip.com',
478	            password='xxxx',
479	            full_name='Romeo Montague',
480	        ))
481	        self.assert_json_error(result, "Missing 'short_name' argument")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:483:49
482	
483	        result = self.client_post("/json/users", dict(
484	            email='broken',
485	            password='xxxx',
486	            full_name='Romeo Montague',
487	            short_name='Romeo',
488	        ))
489	        self.assert_json_error(result, "Bad name or username")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:491:49
490	
491	        result = self.client_post("/json/users", dict(
492	            email='romeo@not-zulip.com',
493	            password='xxxx',
494	            full_name='Romeo Montague',
495	            short_name='Romeo',
496	        ))
497	        self.assert_json_error(result,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:503:23
502	        # HAPPY PATH STARTS HERE
503	        valid_params = dict(
504	            email='romeo@zulip.net',
505	            password='xxxx',
506	            full_name='Romeo Montague',
507	            short_name='Romeo',
508	        )
509	        result = self.client_post("/json/users", valid_params)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:1575:12
1574	            "/json/settings/change",
1575	            dict(
1576	                full_name='Foo Bar',
1577	                old_password=initial_password('hamlet@zulip.com'),
1578	                new_password='foobar1',
1579	                confirm_password='foobar1',
1580	            ))
1581	        self.assert_json_success(json_result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'mismatched_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:1653:12
1652	            "/json/settings/change",
1653	            dict(
1654	                new_password="mismatched_password",
1655	                confirm_password="not_the_same",
1656	            ))
1657	        self.assert_json_error(result,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:1668:12
1667	            "/json/settings/change",
1668	            dict(
1669	                old_password='bad_password',
1670	                new_password="ignored",
1671	                confirm_password="ignored",
1672	            ))
1673	        self.assert_json_error(result, "Wrong password!")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\tests.py:1684:34
1683	        result = self.client_post("/json/settings/change",
1684	                                  dict(old_password='ignored',))
1685	        self.assert_json_error(result, "No new data supplied")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\tests.py:2140:12
2139	                                         '../../tools/update-authors-json')
2140	            subprocess.check_call([update_script, '--use-fixture'])
2141	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tornado\event_queue.py:188:65
187	        ioloop = tornado.ioloop.IOLoop.instance()
188	        heartbeat_time = time.time() + HEARTBEAT_MIN_FREQ_SECS + random.randint(0, 10)
189	        if self.client_type_name != 'API: heartbeat test':

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tornado\event_queue.py:475:59
474	    try:
475	        os.rename(settings.JSON_PERSISTENT_QUEUE_FILENAME, "/var/tmp/event_queues.json.last")
476	    except OSError:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\tornado\websocket_client.py:86:19
85	        url = urljoin(self.parsed_host_url.geturl(), '/json/events?dont_block=true')
86	        response = requests.get(url, headers={'Cookie': cookies_header}, verify=self.validate_ssl)
87	        return response.json()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\views\auth.py:230:11
229	
230	    resp = requests.post(
231	        'https://www.googleapis.com/oauth2/v3/token',
232	        data={
233	            'code': request.GET.get('code'),
234	            'client_id': settings.GOOGLE_OAUTH2_CLIENT_ID,
235	            'client_secret': settings.GOOGLE_OAUTH2_CLIENT_SECRET,
236	            'redirect_uri': ''.join((
237	                settings.EXTERNAL_URI_SCHEME,
238	                settings.EXTERNAL_HOST,
239	                reverse('zerver.views.auth.finish_google_oauth2'),
240	            )),
241	            'grant_type': 'authorization_code',
242	        },
243	    )
244	    if resp.status_code == 400:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\views\auth.py:252:11
251	
252	    resp = requests.get(
253	        'https://www.googleapis.com/plus/v1/people/me',
254	        params={'access_token': access_token}
255	    )
256	    if resp.status_code == 400:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:123:12
122	            narrow_stream = get_stream(request.GET.get("stream"), user_profile.realm)
123	            assert(narrow_stream is not None)
124	            assert(narrow_stream.is_public())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:124:12
123	            assert(narrow_stream is not None)
124	            assert(narrow_stream.is_public())
125	            narrow = [["stream", narrow_stream.name]]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:17:20
16	    # type: (HttpRequest, UserProfile, str, int, Optional[str]) -> HttpResponse
17	    if token_str == '' or len(token_str) > 4096:
18	        return json_error(_('Empty or invalid length token'))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:48:20
47	    # type: (HttpRequest, UserProfile, str, int) -> HttpResponse
48	    if token_str == '' or len(token_str) > 4096:
49	        return json_error(_('Empty or invalid length token'))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\report.py:18:0
17	
18	import subprocess
19	import os

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\report.py:92:18
91	    try:
92	        version = subprocess.check_output(["git", "log", "HEAD^..HEAD", "--oneline"], universal_newlines=True)
93	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\report.py:92:18
91	    try:
92	        version = subprocess.check_output(["git", "log", "HEAD^..HEAD", "--oneline"], universal_newlines=True)
93	    except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:64:8
63	        # caller, but it makes sense to verify anyway.
64	        assert stream_name == stream_name.strip()
65	        if len(stream_name) > Stream.MAX_NAME_LENGTH:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:62:23
61	
62	    if new_password != "" or confirm_password != "":
63	        if new_password != confirm_password:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:62:49
61	
62	    if new_password != "" or confirm_password != "":
63	        if new_password != confirm_password:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:129:4
128	    # hacks to prevent us from having to jump through decode/encode hoops.
129	    assert '?' in url
130	    url += '&' + request.META['QUERY_STRING']

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\users.py:258:18
257	
258	    bot_profile = do_create_user(email=email, password='',
259	                                 realm=user_profile.realm, full_name=full_name,
260	                                 short_name=short_name, active=True,
261	                                 bot_type=UserProfile.DEFAULT_BOT,
262	                                 bot_owner=user_profile,
263	                                 avatar_source=avatar_source,
264	                                 default_sending_stream=default_sending_stream,
265	                                 default_events_register_stream=default_events_register_stream,
266	                                 default_all_public_streams=default_all_public_streams)
267	    json_result = dict(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\zephyr.py:16:0
15	import logging
16	import subprocess
17	import ujson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:37:8
36	            user = "ctl"
37	        assert(user == user_profile.email.split("@")[0])
38	        ccache = make_ccache(parsed_cred)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\zephyr.py:44:8
43	    try:
44	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--",
45	                               "/home/zulip/zulip/bots/process_ccache",
46	                               force_str(user),
47	                               force_str(user_profile.api_key),
48	                               force_str(base64.b64encode(ccache))])
49	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\zephyr.py:44:8
43	    try:
44	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--",
45	                               "/home/zulip/zulip/bots/process_ccache",
46	                               force_str(user),
47	                               force_str(user_profile.api_key),
48	                               force_str(base64.b64encode(ccache))])
49	    except Exception:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\webhooks\beanstalk\view.py:37:8
36	                request.META['HTTP_AUTHORIZATION'] = "Basic " + encoded_credentials
37	        except Exception:
38	            pass
39	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:194:56
193	        for i in range(options["num_huddles"]):
194	            get_huddle(random.sample(user_profiles_ids, random.randint(3, 4)))
195	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:330:13
329	    texts = open("zilencer/management/commands/test_messages.txt", "r").readlines()
330	    offset = random.randint(0, len(texts))
331	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:348:17
347	        message.sending_client = get_client('populate_db')
348	        length = random.randint(1, 5)
349	        lines = (t.strip() for t in texts[offset: offset + length])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:354:18
353	
354	        randkey = random.randint(1, random_max)
355	        if (num_messages > 0 and

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:356:16
355	        if (num_messages > 0 and
356	                random.randint(1, random_max) * 100. / random_max < options["stickyness"]):
357	            # Use an old recipient

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:369:52
368	            message_type = Recipient.HUDDLE
369	            message.recipient = get_recipient_by_id(random.choice(recipient_huddles))
370	        elif (randkey <= random_max * (options["percent_huddles"] + options["percent_personals"]) / 100.):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:372:29
371	            message_type = Recipient.PERSONAL
372	            personals_pair = random.choice(personals_pairs)
373	            random.shuffle(personals_pair)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:376:52
375	            message_type = Recipient.STREAM
376	            message.recipient = get_recipient_by_id(random.choice(recipient_streams))
377	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:379:24
378	        if message_type == Recipient.HUDDLE:
379	            sender_id = random.choice(huddle_members[message.recipient.id])
380	            message.sender = get_user_profile_by_id(sender_id)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:389:29
388	            # Pick a random subscriber to the stream
389	            message.sender = random.choice(Subscription.objects.filter(
390	                recipient=message.recipient)).user_profile
391	            message.subject = stream.name + Text(random.randint(1, 3))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:391:49
390	                recipient=message.recipient)).user_profile
391	            message.subject = stream.name + Text(random.randint(1, 3))
392	            saved_data['subject'] = message.subject

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zilencer\management\commands\profile_request.py:47:20
46	    prof.disable()
47	    prof.dump_stats("/tmp/profile.data")
48	    request_logger.process_response(request, ret)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zilencer\views.py:40:15
39	    # type: () -> int
40	    num_file = '/var/tmp/.feedback-bot-ticket-number'
41	    try:

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\zproject\jinja2\__init__.py:25:10
24	    # type: (**Any) -> Environment
25	    env = Environment(**options)
26	    env.globals.update({

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\settings.py:921:25
920	
921	ZULIP_WORKER_TEST_FILE = '/tmp/zulip-worker-test-file'
922	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\test_settings.py:64:16
63	# Don't use the real message log for tests
64	EVENT_LOG_DIR = '/tmp/zulip-test-event-log'
65	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_settings.py:110:16
109	S3_KEY = 'test-key'
110	S3_SECRET_KEY = 'test-secret-key'
111	S3_AUTH_UPLOADS_BUCKET = 'test-authed-bucket'

--------------------------------------------------

Code scanned:
	Total lines of code: 57289
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 265
		Medium: 45
		High: 14
	Total issues (by confidence):
		Undefined: 0
		Low: 19
		Medium: 75
		High: 230
Files skipped (1):
	.\zerver\lib\notifications.py (syntax error while parsing AST from file)
