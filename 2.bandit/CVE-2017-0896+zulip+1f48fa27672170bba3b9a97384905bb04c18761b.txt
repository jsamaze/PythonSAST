Working... ---------------------------------------- 100% 0:00:11
Run started:2024-02-10 20:58:00.564618

Test results:
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:146:8
145	        timer = time.time()
146	        assert(stat.data_collector.pull_function is not None)
147	        rows_added = stat.data_collector.pull_function(stat.property, start_time, end_time)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:171:27
170	    if output_table in (UserCount, StreamCount):
171	        realmcount_query = """
172	            INSERT INTO analytics_realmcount
173	                (realm_id, value, property, subgroup, end_time)
174	            SELECT
175	                zerver_realm.id, COALESCE(sum(%(output_table)s.value), 0), '%(property)s',
176	                %(output_table)s.subgroup, %%(end_time)s
177	            FROM zerver_realm
178	            JOIN %(output_table)s
179	            ON
180	                zerver_realm.id = %(output_table)s.realm_id
181	            WHERE
182	                %(output_table)s.property = '%(property)s' AND
183	                %(output_table)s.end_time = %%(end_time)s
184	            GROUP BY zerver_realm.id, %(output_table)s.subgroup
185	        """ % {'output_table': output_table._meta.db_table,
186	               'property': stat.property}
187	        start = time.time()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:193:30
192	    # Aggregate into InstallationCount
193	    installationcount_query = """
194	        INSERT INTO analytics_installationcount
195	            (value, property, subgroup, end_time)
196	        SELECT
197	            sum(value), '%(property)s', analytics_realmcount.subgroup, %%(end_time)s
198	        FROM analytics_realmcount
199	        WHERE
200	            property = '%(property)s' AND
201	            end_time = %%(end_time)s
202	        GROUP BY analytics_realmcount.subgroup
203	    """ % {'property': stat.property}
204	    start = time.time()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:46:29
45	        for i in range(days):
46	            holidays.extend([random() < holiday_rate] * 24)
47	    elif frequency == CountStat.DAY:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:51:20
50	                      [24*non_business_hours_base] * 2
51	        holidays = [random() < holiday_rate for i in range(days)]
52	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:161:16
160	        # type: (str) -> CountStat
161	        query = """INSERT INTO analytics_realmcount (realm_id, value, property, end_time)
162	                   VALUES (%s, 1, '%s', %%%%(time_end)s)""" % (self.default_realm.id, property)
163	        return CountStat(property, sql_data_collector(RealmCount, query, None), CountStat.HOUR)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:256:16
255	        stat2 = self.make_dummy_count_stat('stat2')
256	        query = """INSERT INTO analytics_realmcount (realm_id, value, property, end_time)
257	                   VALUES (%s, 1, '%s', %%%%(time_end)s)""" % (self.default_realm.id, 'stat3')
258	        stat3 = DependentCountStat('stat3', sql_data_collector(RealmCount, query, None), CountStat.HOUR,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:289:16
288	        # test daily dependent stat with hourly dependencies
289	        query = """INSERT INTO analytics_realmcount (realm_id, value, property, end_time)
290	                   VALUES (%s, 1, '%s', %%%%(time_end)s)""" % (self.default_realm.id, 'stat4')
291	        stat4 = DependentCountStat('stat4', sql_data_collector(RealmCount, query, None), CountStat.DAY,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\analytics\views.py:413:8
412	            row['hours_per_user'] = '%.1f' % (hours / row['active_user_count'],)
413	        except Exception:
414	            pass
415	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\views.py:608:16
607	
608	        query = '''
609	            select
610	                realm.string_id,
611	                up.id user_id,
612	                client.name,
613	                sum(count) as hits,
614	                max(last_visit) as last_time
615	            from zerver_useractivity ua
616	            join zerver_client client on client.id = ua.client_id
617	            join zerver_userprofile up on up.id = ua.user_profile_id
618	            join zerver_realm realm on realm.id = up.realm_id
619	            where
620	                client.name like '%s'
621	            group by string_id, up.id, client.name
622	            having max(last_visit) > now() - interval '2 week'
623	            order by string_id, up.id, client.name
624	        ''' % (mobile_type,)
625	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\commute\commute.py:194:12
193	                return
194	        r = requests.get('https://maps.googleapis.com/maps/api/' +
195	                         'distancematrix/json', params=params)
196	        result = validate_requests(r)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\bots\commute\commute.py:223:4
222	                                'dog_foo=cat-foo'])
223	    assert result == dict(departure_time='2016,12,20,23,59,00',
224	                          dog_foo='cat-foo')
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\bots\commute\commute.py:228:4
227	    result = handler.calculate_seconds('2016,12,20,23,59,00')
228	    assert result == str(1482278340)
229	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\bots\commute\commute.py:233:4
232	    result = handler.get_api_key()
233	    assert result == 'abcdefghijksm'
234	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\define\define.py:47:29
46	                # Use OwlBot API to fetch definition.
47	                api_result = requests.get(self.DEFINITION_API_URL.format(to_define_lower))
48	                # Convert API result from string to JSON format.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\bots\encrypt\encrypt.py:44:4
43	if __name__ == '__main__':
44	    assert encrypt('ABCDabcd1234') == 'NOPQnopq1234'
45	    assert encrypt('NOPQnopq1234') == 'ABCDabcd1234'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\bots\encrypt\encrypt.py:45:4
44	    assert encrypt('ABCDabcd1234') == 'NOPQnopq1234'
45	    assert encrypt('NOPQnopq1234') == 'ABCDabcd1234'

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\foursquare\foursquare.py:91:19
90	
91	        response = requests.get('https://api.foursquare.com/v2/venues/search?',
92	                                params=params)
93	        print(response.url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\bots\foursquare\foursquare.py:119:4
118	    result = get_api_key()
119	    assert result == 'abcdefghijksm'
120	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\giphy\giphy.py:59:15
58	    try:
59	        data = requests.get(GIPHY_TRANSLATE_API, params=query)
60	    except requests.exceptions.ConnectionError as e:  # Usually triggered by bad connection.

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\api\bots\googlesearch\googlesearch.py:28:12
27	            urls = search(search_keywords, stop=20)
28	            urlopen('http://216.58.192.142', timeout=1)
29	        except http.client.RemoteDisconnected as er:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\api\bots\googlesearch\googlesearch.py:85:8
84	    try:
85	        urlopen('http://216.58.192.142', timeout=1)
86	        print('Success')

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\bots\tictactoe\tictactoe.py:135:27
134	            else:
135	                location = random.choice(corner_locations)
136	                row = location[0]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\bots\tictactoe\tictactoe.py:183:27
182	            if blank_list == []:
183	                location = random.choice(blank_locations)
184	            else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\bots\tictactoe\tictactoe.py:185:27
184	            else:
185	                location = random.choice(blank_list)
186	            row = location[0]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\bots\tictactoe\tictactoe.py:192:23
191	        else:
192	            location = random.choice(blank_locations)
193	            row = location[0]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\weather\weather.py:41:16
40	            url = 'http://api.openweathermap.org/data/2.5/weather?q=' + message['content'] + '&APPID='
41	            r = requests.get(url + get_weather_api_key_from_config(self.directory, self.config_name))
42	            if "city not found" in r.text:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\wikipedia\wikipedia.py:41:19
40	        try:
41	            data = requests.get(query_wiki_link)
42	        except requests.exceptions.RequestException:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\xkcd\xkcd.py:86:21
85	        elif mode == XkcdBotCommand.RANDOM:  # Fetch a random comic strip.
86	            latest = requests.get(LATEST_XKCD_URL)
87	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\bots\xkcd\xkcd.py:92:24
91	            latest_id = latest.json()['num']
92	            random_id = randint(1, latest_id)
93	            url = XKCD_TEMPLATE_URL % (str(random_id))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\xkcd\xkcd.py:100:18
99	
100	        fetched = requests.get(url)
101	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\yoda\yoda.py:61:15
60	
61	    response = requests.get("https://yoda.p.mashape.com/yoda?sentence=" + sentence,
62	                            headers={
63	                                "X-Mashape-Key": api_key,
64	                                "Accept": "text/plain"
65	                            }
66	                            )
67	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\api\bots\youtube\youtube.py:22:16
21	            url = "https://www.youtube.com/results?search_query=" + text_to_search
22	            r = requests.get(url)
23	            soup = BeautifulSoup(r.text, 'lxml')

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\api\integrations\codebase\zulip_codebase_config.py:60:14
59	# It is required and needs to be writeable.
60	RESUME_FILE = "/var/tmp/zulip_codebase.state"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\jabber\jabber_mirror.py:26:0
25	import sys
26	import subprocess
27	import os

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\jabber\jabber_mirror.py:48:14
47	    try:
48	        ret = subprocess.call(args)
49	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\perforce\git_p4.py:25:0
24	import marshal
25	import subprocess
26	import tempfile

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\perforce\git_p4.py:34:4
33	try:
34	    from subprocess import CalledProcessError
35	except ImportError:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:104:8
103	    expand = isinstance(c, six.string_types)
104	    p = subprocess.Popen(c, stdin=subprocess.PIPE, shell=expand)
105	    pipe = p.stdin

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:122:8
121	    expand = isinstance(c, six.string_types)
122	    p = subprocess.Popen(c, stdout=subprocess.PIPE, shell=expand)
123	    pipe = p.stdout

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:139:8
138	    expand = isinstance(c, six.string_types)
139	    p = subprocess.Popen(c, stdout=subprocess.PIPE, shell=expand)
140	    pipe = p.stdout

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:156:8
155	    real_cmd = p4_build_cmd(["help", cmd])
156	    p = subprocess.Popen(real_cmd, stdout=subprocess.PIPE,
157	                         stderr=subprocess.PIPE)
158	    p.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:170:8
169	    cmd = p4_build_cmd(["move", "-k", "@from", "@to"])
170	    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
171	    (out, err) = p.communicate()

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:184:14
183	        sys.stderr.write("executing %s\n" % str(cmd))
184	    retcode = subprocess.call(cmd, shell=expand)
185	    if retcode:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:192:14
191	    expand = isinstance(real_cmd, six.string_types)
192	    retcode = subprocess.call(real_cmd, shell=expand)
193	    if retcode:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:461:9
460	    p4 = subprocess.Popen(cmd,
461	                          shell=expand,
462	                          stdin=stdin_file,
463	                          stdout=subprocess.PIPE)
464	
465	    result = []

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b302-marshal
   Location: .\api\integrations\perforce\git_p4.py:468:20
467	        while True:
468	            entry = marshal.load(p4.stdout)
469	            if cb is not None:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\perforce\git_p4.py:580:11
579	def gitBranchExists(branch):
580	    proc = subprocess.Popen(["git", "rev-parse", branch],
581	                            stderr=subprocess.PIPE, stdout=subprocess.PIPE);
582	    return proc.wait() == 0;

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:580:11
579	def gitBranchExists(branch):
580	    proc = subprocess.Popen(["git", "rev-parse", branch],
581	                            stderr=subprocess.PIPE, stdout=subprocess.PIPE);
582	    return proc.wait() == 0;

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:647:8
646	    cmd = [ "git", "rev-parse", "--symbolic", "--verify", branch ]
647	    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
648	    out, _ = p.communicate()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\integrations\perforce\git_p4.py:732:4
731	def p4ChangesForPaths(depotPaths, changeRange):
732	    assert depotPaths
733	    cmd = ['changes']

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\api\integrations\perforce\git_p4.py:1305:11
1304	
1305	        if os.system(tryPatchCmd) != 0:
1306	            fixed_rcs_keywords = False

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\api\integrations\perforce\git_p4.py:1342:19
1341	                print("Retrying the patch with RCS keywords cleaned up")
1342	                if os.system(tryPatchCmd) == 0:
1343	                    patch_succeeded = True

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\perforce\git_p4.py:2924:29
2923	
2924	        self.importProcess = subprocess.Popen(["git", "fast-import"],
2925	                                              stdin=subprocess.PIPE,
2926	                                              stdout=subprocess.PIPE,
2927	                                              stderr=subprocess.PIPE);
2928	        self.gitOutput = self.importProcess.stdout

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:2924:29
2923	
2924	        self.importProcess = subprocess.Popen(["git", "fast-import"],
2925	                                              stdin=subprocess.PIPE,
2926	                                              stdout=subprocess.PIPE,
2927	                                              stderr=subprocess.PIPE);
2928	        self.gitOutput = self.importProcess.stdout

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\api\integrations\perforce\git_p4.py:3049:11
3048	    def rebase(self):
3049	        if os.system("git update-index --refresh") != 0:
3050	            die("Some files in your working directory are modified and different than what is in your index. You can use git update-index <filename> to bring the index up-to-date or stash away all your changes with git stash.");

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\perforce\git_p4.py:3049:11
3048	    def rebase(self):
3049	        if os.system("git update-index --refresh") != 0:
3050	            die("Some files in your working directory are modified and different than what is in your index. You can use git update-index <filename> to bring the index up-to-date or stash away all your changes with git stash.");

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\perforce\git_p4.py:3133:18
3132	            init_cmd.append("--bare")
3133	        retcode = subprocess.call(init_cmd)
3134	        if retcode:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\integrations\slack\zulip_slack.py:83:19
82	    # type: (int) -> str
83	    return ''.join(random.choice(string.ascii_letters + string.digits) for _ in range(size))
84	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'slack_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\api\integrations\slack\zulip_slack_config.py:27:14
26	# Change these values to your Slack credentials.
27	SLACK_TOKEN = 'slack_token'
28	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\zephyr\zephyr_mirror.py:27:0
26	import sys
27	import subprocess
28	import os

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror.py:56:4
55	if options.sync_subscriptions:
56	    subprocess.call(args)
57	    sys.exit(0)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror.py:62:8
61	    if options.on_startup_command is not None:
62	        subprocess.call([options.on_startup_command])
63	    from zerver.lib.parallel import run_parallel

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror.py:69:8
68	        # type: (str) -> int
69	        subprocess.call(args + ["--shard=%s" % (shard,)])
70	        return 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror.py:80:8
79	    try:
80	        subprocess.call(args)
81	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:36:0
35	import time
36	import subprocess
37	import optparse

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:218:20
217	        if (options.shard is not None and
218	                not hashlib.sha1(zephyr_class).hexdigest().startswith(options.shard)):
219	            # This stream is being handled by a different zephyr_mirror job.

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:252:16
251	            try:
252	                os.execvp(os.path.join(options.root_path, "user_root", "zephyr_mirror_backend.py"), sys.argv)
253	            except Exception:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:348:8
347	    # decrypt the message!
348	    p = subprocess.Popen(["gpg",
349	                          "--decrypt",
350	                          "--no-options",
351	                          "--no-default-keyring",
352	                          "--keyring=/dev/null",
353	                          "--secret-keyring=/dev/null",
354	                          "--batch",
355	                          "--quiet",
356	                          "--no-use-agent",
357	                          "--passphrase-file",
358	                          keypath],
359	                         stdin=subprocess.PIPE,
360	                         stdout=subprocess.PIPE,
361	                         stderr=subprocess.PIPE)
362	    decrypted, _ = p.communicate(input=body)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:348:8
347	    # decrypt the message!
348	    p = subprocess.Popen(["gpg",
349	                          "--decrypt",
350	                          "--no-options",
351	                          "--no-default-keyring",
352	                          "--keyring=/dev/null",
353	                          "--secret-keyring=/dev/null",
354	                          "--batch",
355	                          "--quiet",
356	                          "--no-use-agent",
357	                          "--passphrase-file",
358	                          keypath],
359	                         stdin=subprocess.PIPE,
360	                         stdout=subprocess.PIPE,
361	                         stderr=subprocess.PIPE)
362	    decrypted, _ = p.communicate(input=body)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:586:8
585	    # type: (List, str) -> Tuple[int, str]
586	    p = subprocess.Popen(zwrite_args, stdin=subprocess.PIPE,
587	                         stdout=subprocess.PIPE, stderr=subprocess.PIPE)
588	    stdout, stderr = p.communicate(input=content.encode("utf-8"))

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:616:8
615	    # encrypt the message!
616	    p = subprocess.Popen(["gpg",
617	                          "--symmetric",
618	                          "--no-options",
619	                          "--no-default-keyring",
620	                          "--keyring=/dev/null",
621	                          "--secret-keyring=/dev/null",
622	                          "--batch",
623	                          "--quiet",
624	                          "--no-use-agent",
625	                          "--armor",
626	                          "--cipher-algo", "AES",
627	                          "--passphrase-file",
628	                          keypath],
629	                         stdin=subprocess.PIPE,
630	                         stdout=subprocess.PIPE,
631	                         stderr=subprocess.PIPE)
632	    encrypted, _ = p.communicate(input=content)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:616:8
615	    # encrypt the message!
616	    p = subprocess.Popen(["gpg",
617	                          "--symmetric",
618	                          "--no-options",
619	                          "--no-default-keyring",
620	                          "--keyring=/dev/null",
621	                          "--secret-keyring=/dev/null",
622	                          "--batch",
623	                          "--quiet",
624	                          "--no-use-agent",
625	                          "--armor",
626	                          "--cipher-algo", "AES",
627	                          "--passphrase-file",
628	                          keypath],
629	                         stdin=subprocess.PIPE,
630	                         stdout=subprocess.PIPE,
631	                         stderr=subprocess.PIPE)
632	    encrypted, _ = p.communicate(input=content)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:1148:15
1147	            pgrep_query = "%s.*--user=%s" % (pgrep_query, options.user)
1148	        proc = subprocess.Popen(['pgrep', '-U', os.environ["USER"], "-f", pgrep_query],
1149	                                stdout=subprocess.PIPE,
1150	                                stderr=subprocess.PIPE)
1151	        out, _err_unused = proc.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:1148:15
1147	            pgrep_query = "%s.*--user=%s" % (pgrep_query, options.user)
1148	        proc = subprocess.Popen(['pgrep', '-U', os.environ["USER"], "-f", pgrep_query],
1149	                                stdout=subprocess.PIPE,
1150	                                stderr=subprocess.PIPE)
1151	        out, _err_unused = proc.communicate()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\api\integrations\zephyr\zephyr_mirror_backend.py:1173:31
1172	    if options.session_path is None:
1173	        options.session_path = "/var/tmp/%s" % (options.user,)
1174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\setup.py:89:8
88	        import requests
89	        assert(LooseVersion(requests.__version__) >= LooseVersion('0.12.1'))
90	    except (ImportError, AssertionError):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\api\zulip\__init__.py:49:0
48	# Older versions don't provide the 'json' attribute on responses.
49	assert(LooseVersion(requests.__version__) >= LooseVersion('0.12.1'))
50	# In newer versions, the 'json' attribute is a function, not a property

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\api\zulip\__init__.py:94:30
93	        delay_scale = int(2 ** (self.number_of_retries / 2.0 - 1)) + 1
94	        delay = delay_scale + random.randint(1, delay_scale)
95	        message = "Sleeping for %ss [max %s] before retrying." % (delay, delay_scale * 2)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\manage.py:5:0
4	import logging
5	import subprocess
6	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\manage.py:21:4
20	    logger = logging.getLogger("zulip.management")
21	    subprocess.check_call([os.path.join(BASE_DIR, "scripts", "lib", "log-management-command"),
22	                           " ".join(sys.argv)])
23	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\pgroonga\migrations\0001_enable.py:18:30
17	        operations = [
18	            migrations.RunSQL("""
19	ALTER ROLE %(USER)s SET search_path TO %(SCHEMA)s,public,pgroonga,pg_catalog;
20	
21	SET search_path = %(SCHEMA)s,public,pgroonga,pg_catalog;
22	
23	ALTER TABLE zerver_message ADD COLUMN search_pgroonga text;
24	
25	UPDATE zerver_message SET search_pgroonga = subject || ' ' || rendered_content;
26	
27	-- TODO: We want to use CREATE INDEX CONCURRENTLY but it can't be used in
28	-- transaction. Django uses transaction implicitly.
29	-- Django 1.10 may solve the problem.
30	CREATE INDEX zerver_message_search_pgroonga ON zerver_message
31	  USING pgroonga(search_pgroonga pgroonga.text_full_text_search_ops);
32	""" % database_setting,
33	                              """

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\puppet\zulip\files\postgresql\pg_backup_and_purge.py:7:0
6	import glob
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\puppet\zulip\files\postgresql\pg_backup_and_purge.py:25:8
24	
25	    p = subprocess.Popen(args, stdin=subprocess.PIPE, stdout=subprocess.PIPE,
26	                         stderr=subprocess.PIPE)
27	    stdout, stderr = p.communicate()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\hash_reqs.py:49:11
48	    deps_str = "\n".join(deps) + "\n"
49	    return hashlib.sha1(deps_str.encode('utf-8')).hexdigest()
50	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\node_cache.py:21:14
20	    # type: (Optional[List[str]], Optional[IO], Optional[IO], Optional[bool]) -> None
21	    sha1sum = hashlib.sha1()
22	    sha1sum.update(subprocess_text_output(['cat', 'package.json']).encode('utf8'))

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_path_on_import.py:18:4
17	    # this file will exist in production
18	    exec(open(activate_this).read(), {}, dict(__file__=activate_this))
19	sys.path.append(BASE_DIR)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\setup_venv.py:6:0
5	from os.path import dirname, abspath
6	import subprocess
7	from scripts.lib.zulip_tools import run

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:207:13
206	    path = os.path.join(ZULIP_PATH, 'scripts', 'lib', 'hash_reqs.py')
207	    output = subprocess.check_output([path, requirements_file], universal_newlines=True)
208	    sha1sum = output.split()[0]

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_venv.py:224:4
223	    activate_this = os.path.join(cached_venv_path, "bin", "activate_this.py")
224	    exec(open(activate_this).read(), {}, dict(__file__=activate_this))
225	    return cached_venv_path

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_venv.py:245:4
244	    activate_this = os.path.join(venv_path, "bin", "activate_this.py")
245	    exec(open(activate_this).read(), {}, dict(__file__=activate_this))
246	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\zulip_tools.py:8:0
7	import shutil
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:30:11
29	    # type: (Sequence[str]) -> str
30	    return subprocess.check_output(args, universal_newlines=True).strip()
31	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:98:8
97	    try:
98	        subprocess.check_call(args, **kwargs)
99	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:17:4
16	    result = client.add_subscriptions(request)
17	    assert result['result'] == 'success'
18	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'temp'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tools\lib\api_tests.py:22:14
21	
22	    request = dict(
23	        email='newbie@zulip.com',
24	        full_name='New User',
25	        short_name='Newbie',
26	        password='temp',
27	    )
28	    result = client.create_user(request)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:29:4
28	    result = client.create_user(request)
29	    assert result['result'] == 'success'
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:35:4
34	    result = client.get_members()
35	    assert result['result'] == 'success'
36	    members = [m for m in result['members'] if m['email'] == 'newbie@zulip.com']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:37:4
36	    members = [m for m in result['members'] if m['email'] == 'newbie@zulip.com']
37	    assert len(members) == 1
38	    iago = members[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:40:4
39	
40	    assert not iago['is_admin']
41	    assert iago['full_name'] == 'New User'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:41:4
40	    assert not iago['is_admin']
41	    assert iago['full_name'] == 'New User'
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:47:4
46	    result = client.get_profile()
47	    assert result['is_admin']
48	    assert result['email'] == 'iago@zulip.com'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:48:4
47	    assert result['is_admin']
48	    assert result['email'] == 'iago@zulip.com'
49	    assert result['full_name'] == 'Iago'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:49:4
48	    assert result['email'] == 'iago@zulip.com'
49	    assert result['full_name'] == 'Iago'
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:56:4
55	    result = client.get_stream_id(stream_name)
56	    assert int(result['stream_id'])
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:62:4
61	    result = client.get_streams()
62	    assert result['result'] == 'success'
63	    streams = [s for s in result['streams'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:64:4
63	    streams = [s for s in result['streams'] if s['name'] == 'new stream']
64	    assert streams[0]['description'] == 'New stream for testing'
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:70:4
69	    result = client.get_subscribers(stream='new stream')
70	    assert result['subscribers'] == ['iago@zulip.com']
71	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:76:4
75	    result = client.get_user_agent()
76	    assert result.startswith('ZulipPython/')
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:82:4
81	    result = client.list_subscriptions()
82	    assert result['result'] == 'success'
83	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:84:4
83	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']
84	    assert streams[0]['description'] == 'New stream for testing'
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:90:4
89	    result = client.remove_subscriptions(['new stream'])
90	    assert result['result'] == 'success'
91	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:94:4
93	    result = client.list_subscriptions()
94	    assert result['result'] == 'success'
95	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:96:4
95	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']
96	    assert len(streams) == 0
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:103:4
102	    result = client.render_message(request)
103	    assert result['result'] == 'success'
104	    assert result['rendered'] == '<p><strong>foo</strong></p>'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:104:4
103	    assert result['result'] == 'success'
104	    assert result['rendered'] == '<p><strong>foo</strong></p>'
105	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:116:4
115	    result = client.send_message(request)
116	    assert result['result'] == 'success'
117	    message_id = result['id']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:125:4
124	    )
125	    assert result['result'] == 'success'
126	    assert result['raw_content'] == 'hello'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:126:4
125	    assert result['result'] == 'success'
126	    assert result['raw_content'] == 'hello'
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:133:4
132	
133	    assert int(message_id)
134	    request = dict(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:139:4
138	    result = client.update_message(request)
139	    assert result['result'] == 'success'
140	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:147:4
146	    )
147	    assert result['result'] == 'success'
148	    assert result['raw_content'] == 'new content'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\api_tests.py:148:4
147	    assert result['result'] == 'success'
148	    assert result['raw_content'] == 'new content'
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:107:4
106	    # type: (List[Token], int, int, str, str) -> Union[CssNestedSection, CssSection]
107	    assert not ws(tokens[start].s)
108	    assert tokens[end-1].s == '}'  # caller should strip trailing fluff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:108:4
107	    assert not ws(tokens[start].s)
108	    assert tokens[end-1].s == '}'  # caller should strip trailing fluff
109	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:137:4
136	    start, pre_fluff = get_whitespace_and_comments(tokens, start, end)
137	    assert pre_fluff == ''
138	    i = start

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:184:4
183	
184	    assert last_i is not None
185	    start, post_fluff = get_whitespace_and_comments(tokens, last_i, end)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:196:4
195	    # type: (List[Token], int, int) -> CssDeclarationBlock
196	    assert tokens[start].s == '{'  # caller should strip leading fluff
197	    assert tokens[end-1].s == '}'  # caller should strip trailing fluff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:197:4
196	    assert tokens[start].s == '{'  # caller should strip leading fluff
197	    assert tokens[end-1].s == '}'  # caller should strip trailing fluff
198	    i = start + 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\css_parser.py:483:8
482	        self.post_fluff = post_fluff
483	        assert pre_fluff.strip() == ''
484	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\pretty_print.py:12:0
11	from six.moves import range
12	import subprocess
13	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'html_start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tools\lib\pretty_print.py:27:11
26	    # easier.
27	    info = dict(
28	        block=False,
29	        depth=-1,
30	        line=-1,
31	        token_kind='html_start',
32	        tag='html',
33	        extra_indent=0) # type: Dict[str, Any]
34	    stack.append(info)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:167:16
166	                pretty_line = pretty_line[-1 * offset:]
167	                assert line.strip() == pretty_line.strip()
168	        formatted_lines.append(pretty_line)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tools\lib\pretty_print.py:180:25
179	    if not html.split('\n') == phtml.split('\n'):
180	        temp_file = open('/var/tmp/pretty_html.txt', 'w')
181	        temp_file.write(phtml)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\pretty_print.py:184:8
183	        print('Invalid Indentation detected in file: %s\nDiff for the file against expected indented file:' % (fn))
184	        subprocess.call(['diff', fn, '/var/tmp/pretty_html.txt'], stderr=subprocess.STDOUT)
185	        return 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\pretty_print.py:184:8
183	        print('Invalid Indentation detected in file: %s\nDiff for the file against expected indented file:' % (fn))
184	        subprocess.call(['diff', fn, '/var/tmp/pretty_html.txt'], stderr=subprocess.STDOUT)
185	        return 0

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tools\lib\pretty_print.py:184:37
183	        print('Invalid Indentation detected in file: %s\nDiff for the file against expected indented file:' % (fn))
184	        subprocess.call(['diff', fn, '/var/tmp/pretty_html.txt'], stderr=subprocess.STDOUT)
185	        return 0

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\provision.py:8:0
7	import platform
8	import subprocess
9	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\provision.py:97:0
96	# know the codename.
97	subprocess.check_call(["sudo", "apt-get", "install", "-y", "lsb-release"])
98	vendor = subprocess_text_output(["lsb_release", "-is"])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\provision.py:97:0
96	# know the codename.
97	subprocess.check_call(["sudo", "apt-get", "install", "-y", "lsb-release"])
98	vendor = subprocess_text_output(["lsb_release", "-is"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:180:4
179	    # type: (Optional[str], Optional[str], bool) -> None
180	    assert fn or text
181	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_server.py:4:0
3	import os
4	import subprocess
5	import sys

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\lib\test_server.py:48:15
47	        # We could get a 501 error if the reverse proxy is up but the Django app isn't.
48	        return requests.get('http://127.0.0.1:9981/accounts/home').status_code == 200
49	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:71:8
70	            generate_fixtures_command.append('--force')
71	        subprocess.check_call(generate_fixtures_command)
72	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:77:13
76	        run_dev_server_command.append('--force')
77	    server = subprocess.Popen(run_dev_server_command,
78	                              stdout=log, stderr=log)
79	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lister.py:8:0
7	import sys
8	import subprocess
9	import re

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lister.py:68:22
67	    # everything is UTF-8.
68	    repository_root = subprocess.check_output(['git', 'rev-parse', '--show-toplevel']).strip().decode('utf-8')
69	    exclude_abspaths = [os.path.join(repository_root, fpath).rstrip('/') for fpath in exclude]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lister.py:68:22
67	    # everything is UTF-8.
68	    repository_root = subprocess.check_output(['git', 'rev-parse', '--show-toplevel']).strip().decode('utf-8')
69	    exclude_abspaths = [os.path.join(repository_root, fpath).rstrip('/') for fpath in exclude]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lister.py:75:36
74	
75	    files_gen = (x.strip() for x in subprocess.check_output(cmdline, universal_newlines=True).split('\n'))
76	    # throw away empty lines and non-files (like symlinks)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\run-dev.py:9:0
8	import signal
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:140:0
139	# Clean up stale .pyc files etc.
140	subprocess.check_call('./tools/clean-repo')
141	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\run-dev.py:145:4
144	    print("Handlebars binary missing due to rebase past .gitignore fixup; fixing...")
145	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
146	    subprocess.check_call(["npm", "install"])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:145:4
144	    print("Handlebars binary missing due to rebase past .gitignore fixup; fixing...")
145	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
146	    subprocess.check_call(["npm", "install"])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\run-dev.py:146:4
145	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
146	    subprocess.check_call(["npm", "install"])
147	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:146:4
145	    subprocess.check_call(["rm", "-rf", "node_modules/handlebars"])
146	    subprocess.check_call(["npm", "install"])
147	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:150:4
149	    print("Clearing memcached ...")
150	    subprocess.check_call('./scripts/setup/flush-memcached')
151	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:187:4
186	    # for the Casper tests.
187	    subprocess.check_call('./tools/webpack')
188	else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:191:4
190	for cmd in cmds:
191	    subprocess.Popen(cmd)
192	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\setup\emoji\emoji_setup_utils.py:225:12
224	        for name in names:
225	            assert (emoji_map[name] == codepoint)
226	        codepoint_to_names[codepoint] = names

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\test-help-documentation.py:7:0
6	import sys
7	import subprocess
8	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\test-help-documentation.py:29:0
28	
29	subprocess.check_call(['mkdir', '-p', 'var/help-documentation'])
30	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\test-help-documentation.py:29:0
28	
29	subprocess.check_call(['mkdir', '-p', 'var/help-documentation'])
30	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\test-help-documentation.py:35:10
34	with test_server_running(options.force, external_host, log_file=LOG_FILE, dots=True, use_db=False):
35	    ret = subprocess.call(('scrapy', 'crawl_with_status', 'help_documentation_crawler'),
36	                          cwd='tools/documentation_crawler')
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:459:16
458	            if is_remote_server(role):
459	                assert isinstance(profile, RemoteZulipServer)  # type: ignore # https://github.com/python/mypy/issues/2957
460	                request._email = "zulip-server:" + role

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:464:16
463	            else:
464	                assert isinstance(profile, UserProfile)  # type: ignore # https://github.com/python/mypy/issues/2957
465	                request._email = profile.email

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:450:4
449	    property_type = Realm.property_types[name]
450	    assert isinstance(value, property_type), (
451	        'Cannot update %s: %s is not an instance of %s' % (
452	            name, value, property_type,))
453	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:704:8
703	        # personals to yourself or to someone else, respectively.
704	        assert((len(recipients) == 1) or (len(recipients) == 2))
705	    elif (recipient.type == Recipient.STREAM or recipient.type == Recipient.HUDDLE):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:760:8
759	    for message in messages:
760	        assert message['message'].rendered_content is None
761	        rendered_content = render_incoming_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:886:12
885	                message['stream'] = Stream.objects.select_related("realm").get(id=message['message'].recipient.type_id)
886	            assert message['stream'] is not None  # assert needed because stubs for django are missing
887	            if message['stream'].is_public():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1014:12
1013	        except ValidationError as e:
1014	            assert isinstance(e.messages[0], six.string_types)
1015	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1105:8
1104	    if not_forged_mirror_message:
1105	        assert forwarder_user_profile is not None
1106	        if forwarder_user_profile.id not in recipient_profile_ids:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1318:12
1317	        except ValidationError as e:
1318	            assert isinstance(e.messages[0], six.string_types)
1319	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1337:4
1336	    # We render messages later in the process.
1337	    assert message.rendered_content is None
1338	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2260:4
2259	    notification_setting_type = UserProfile.notification_setting_types[name]
2260	    assert isinstance(value, notification_setting_type), (
2261	        'Cannot update %s: %s is not an instance of %s' % (
2262	            name, value, notification_setting_type,))
2263	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2302:4
2301	    property_type = UserProfile.property_types[setting_name]
2302	    assert isinstance(setting_value, property_type)
2303	    setattr(user_profile, setting_name, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2801:4
2800	    message.last_edit_time = timezone_now()
2801	    assert message.last_edit_time is not None  # assert needed because stubs for django are missing
2802	    event['edit_timestamp'] = datetime_to_timestamp(message.last_edit_time)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\bugdown\__init__.py:2:0
1	from __future__ import absolute_import
2	import subprocess
3	# Zulip's main markdown implementation.  See docs/markdown.md for

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.cElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\__init__.py:22:0
21	from six.moves import urllib
22	import xml.etree.cElementTree as etree
23	from xml.etree.cElementTree import Element, SubElement

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\__init__.py:23:0
22	import xml.etree.cElementTree as etree
23	from xml.etree.cElementTree import Element, SubElement
24	

--------------------------------------------------
>> Issue: [B313:blacklist] Using xml.etree.cElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-celementtree
   Location: .\zerver\lib\bugdown\__init__.py:306:14
305	    try:
306	        doc = etree.fromstring(''.join(head))
307	    except etree.ParseError:

--------------------------------------------------
>> Issue: [B313:blacklist] Using xml.etree.cElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-celementtree
   Location: .\zerver\lib\bugdown\__init__.py:806:19
805	        if rendered is not None:
806	            return etree.fromstring(rendered.encode('utf-8'))
807	        else: # Something went wrong while rendering

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\lib\bugdown\__init__.py:1178:8
1177	            del md.inlinePatterns['linebreak2']
1178	        except Exception:
1179	            pass
1180	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bugdown\__init__.py:1492:8
1491	    if message is not None:
1492	        assert message_realm is not None # ensured above if message is not None
1493	        realm_users = get_active_user_dicts_in_realm(message_realm)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\bugdown\fenced_code.py:80:0
79	import re
80	import subprocess
81	import markdown

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\cache.py:15:0
14	from zerver.lib.utils import statsd, statsd_key, make_safe_digest
15	import subprocess
16	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\cache.py:76:4
75	    # directory `var` should exist in production
76	    subprocess.check_call(["mkdir", "-p", os.path.join(settings.DEPLOY_ROOT, "var")])
77	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\cache.py:76:4
75	    # directory `var` should exist in production
76	    subprocess.check_call(["mkdir", "-p", os.path.join(settings.DEPLOY_ROOT, "var")])
77	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\cache.py:112:17
111	    # Memcached keys should have a length of less than 256.
112	    KEY_PREFIX = hashlib.sha1(KEY_PREFIX.encode('utf-8')).hexdigest()
113	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:215:12
214	            content = part.get_payload(decode=True)
215	            assert isinstance(content, binary_type)
216	            if charsets[idx]:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\export.py:18:0
17	import shutil
18	import subprocess
19	import tempfile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:105:0
104	]
105	assert set(NON_EXPORTED_TABLES).issubset(set(ALL_ZERVER_TABLES))
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:111:0
110	]
111	assert set(IMPLICIT_TABLES).issubset(set(ALL_ZERVER_TABLES))
112	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:116:0
115	]
116	assert set(ATTACHMENT_TABLES).issubset(set(ALL_ZERVER_TABLES))
117	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:214:8
213	
214	        assert table or custom_tables
215	        self.table = table

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:317:8
316	            logging.info('Deleted temporary %s' % (t,))
317	        assert table is not None
318	        response[table] = data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:321:8
320	    elif config.use_all:
321	        assert model is not None
322	        query = model.objects.all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:331:8
330	        model = config.model
331	        assert parent is not None
332	        assert parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:332:8
331	        assert parent is not None
332	        assert parent.table is not None
333	        assert config.parent_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:333:8
332	        assert parent.table is not None
333	        assert config.parent_key is not None
334	        parent_ids = [r['id'] for r in response[parent.table]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:338:8
337	            filter_parms.update(config.filter_args)
338	        assert model is not None
339	        query = model.objects.filter(**filter_parms)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:347:8
346	        model = config.model
347	        assert model is not None
348	        # This will be a tuple of the form ('zerver_article', 'blog').

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:362:8
361	    if rows is not None:
362	        assert table is not None  # Hint for mypy
363	        response[table] = make_raw(rows, exclude=config.exclude)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:584:16
583	            if row['id'] in exportable_user_ids:
584	                assert not row['is_mirror_dummy']
585	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:644:4
643	    realm = context['realm']
644	    assert config.parent is not None
645	    assert config.parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:645:4
644	    assert config.parent is not None
645	    assert config.parent.table is not None
646	    user_profile_ids = set(r['id'] for r in response[config.parent.table])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:802:8
801	        message_ids = set(m['id'] for m in message_chunk)
802	        assert len(message_ids.intersection(all_message_ids)) == 0
803	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:951:8
950	        mkdir_p(os.path.dirname(output_path))
951	        subprocess.check_call(["cp", "-a", local_path, output_path])
952	        stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:951:8
950	        mkdir_p(os.path.dirname(output_path))
951	        subprocess.check_call(["cp", "-a", local_path, output_path])
952	        stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:995:12
994	            mkdir_p(str(os.path.dirname(output_path)))
995	            subprocess.check_call(["cp", "-a", str(local_path), str(output_path)])
996	            stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:995:12
994	            mkdir_p(str(os.path.dirname(output_path)))
995	            subprocess.check_call(["cp", "-a", str(local_path), str(output_path)])
996	            stat = os.stat(local_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1051:8
1050	    if not settings.TEST_SUITE:
1051	        assert threads >= 1
1052	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1053:4
1052	
1053	    assert os.path.exists("./manage.py")
1054	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\export.py:1105:23
1104	    is_done = not in_progress
1105	    in_progress_link = '/tmp/zulip-export-in-progress'
1106	    done_link = '/tmp/zulip-export-most-recent'

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\export.py:1106:16
1105	    in_progress_link = '/tmp/zulip-export-in-progress'
1106	    done_link = '/tmp/zulip-export-most-recent'
1107	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1111:8
1110	    else:
1111	        subprocess.check_call(['rm', '-f', in_progress_link])
1112	        new_target = done_link

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1111:8
1110	    else:
1111	        subprocess.check_call(['rm', '-f', in_progress_link])
1112	        new_target = done_link

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1114:4
1113	
1114	    subprocess.check_call(["ln", "-nsf", source, new_target])
1115	    if is_done:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1114:4
1113	
1114	    subprocess.check_call(["ln", "-nsf", source, new_target])
1115	    if is_done:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1125:8
1124	        # type: (str) -> int
1125	        subprocess.call(["./manage.py", 'export_usermessage_batch', '--path',
1126	                         str(output_dir), '--thread', shard])
1127	        return 0

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1346:12
1345	        if not os.path.exists(os.path.dirname(file_path)):
1346	            subprocess.check_call(["mkdir", "-p", os.path.dirname(file_path)])
1347	        shutil.copy(orig_file_path, file_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1346:12
1345	        if not os.path.exists(os.path.dirname(file_path)):
1346	            subprocess.check_call(["mkdir", "-p", os.path.dirname(file_path)])
1347	        shutil.copy(orig_file_path, file_path)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\feedback.py:30:15
29	    # type: () -> int
30	    num_file = '/var/tmp/.feedback-bot-ticket-number'
31	    try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\i18n.py:47:4
46	    seconds = list(range(firsts_end, lang_len))
47	    assert len(firsts) + len(seconds) == lang_len
48	    for row in zip_longest(firsts, seconds):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\lib\integrations.py:71:19
70	            template = loader.get_template(self.doc)
71	            return mark_safe(template.render(doc_context))
72	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\lib\integrations.py:71:19
70	            template = loader.get_template(self.doc)
71	            return mark_safe(template.render(doc_context))
72	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\logging_util.py:40:56
39	                    tb = force_bytes(str(record))
40	                key = self.__class__.__name__.upper() + hashlib.sha1(tb).hexdigest()
41	                duplicate = cache.get(key) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:167:12
166	        elif recipient_type in (Recipient.HUDDLE, Recipient.PERSONAL):
167	            assert not isinstance(display_recipient, Text)
168	            display_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:204:12
203	            obj['last_edit_timestamp'] = datetime_to_timestamp(last_edit_time)
204	            assert edit_history is not None
205	            obj['edit_history'] = ujson.loads(edit_history)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:222:16
221	
222	                assert message is not None  # Hint for mypy.
223	                # It's unfortunate that we need to have side effects on the message

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:28:11
27	        validate(col)
28	    stmt = '''
29	        UPDATE %s
30	        SET (%s) = (%s)
31	        WHERE id >= %%s AND id < %%s
32	    ''' % (table, ', '.join(cols), ', '.join(['%s'] * len(cols)))
33	    print(stmt)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:34:34
33	    print(stmt)
34	    (min_id, max_id) = db.execute("SELECT MIN(id), MAX(id) FROM %s" % (table,))[0]
35	    if min_id is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:21:4
20	    the bitwise xor of the two hex strings."""
21	    assert len(bytes_a) == len(bytes_b)
22	    return ''.join(["%x" % (int(x, 16) ^ int(y, 16))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:37:4
36	    # type: (UserProfile, str) -> str
37	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
38	    hex_encoded_api_key = ascii_to_hex(force_str(user_profile.api_key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:39:4
38	    hex_encoded_api_key = ascii_to_hex(force_str(user_profile.api_key))
39	    assert len(hex_encoded_api_key) == UserProfile.API_KEY_LENGTH * 2
40	    return xor_hex_strings(hex_encoded_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:44:4
43	    # type: (str, str) -> str
44	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
45	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:45:4
44	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
45	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2
46	    hex_encoded_api_key = xor_hex_strings(otp_encrypted_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:52:8
51	    try:
52	        assert len(otp) == UserProfile.API_KEY_LENGTH * 2
53	        [int(c, 16) for c in otp]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\notifications.py:30:0
29	import re
30	import subprocess
31	import ujson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notifications.py:135:8
134	
135	        assert message.rendered_content is not None
136	        html = message.rendered_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notifications.py:156:12
155	        elif message.recipient.type == Recipient.HUDDLE:
156	            assert not isinstance(disp_recipient, Text)
157	            other_recipients = [r['full_name'] for r in disp_recipient

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notifications.py:164:12
163	        else:
164	            assert isinstance(disp_recipient, Text)
165	            header = u"%s > %s" % (disp_recipient, message.topic_name())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notifications.py:282:8
281	        # Make sure that this is a list of strings, not a string.
282	        assert not isinstance(display_recipient, Text)
283	        other_recipients = [r['full_name'] for r in display_recipient

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\notifications.py:427:16
426	            # A body width of 0 means do not try to wrap the text for us.
427	            p = subprocess.Popen(
428	                [command, "--body-width=0"], stdout=subprocess.PIPE,
429	                stdin=subprocess.PIPE, stderr=subprocess.STDOUT)
430	            break

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:64:0
63	# `APNS_SANDBOX` should be a bool
64	assert isinstance(settings.APNS_SANDBOX, bool)
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:105:4
104	    code = error_response['status']
105	    assert isinstance(code, int)
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:125:8
124	        # caller, but it makes sense to verify anyway.
125	        assert stream_name == stream_name.strip()
126	        check_stream_name(stream_name)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\test_fixtures.py:26:27
25	        with connection.cursor() as cursor:
26	            cursor.execute("SELECT 1 from pg_database WHERE datname='{}';".format(database_name))
27	            return_value = bool(cursor.fetchone())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\test_fixtures.py:84:30
83	    with open(target_hash_file) as f:
84	        target_hash_content = hashlib.sha1(f.read().encode('utf8')).hexdigest()
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:388:8
387	
388	        assert len(pattern_cnt) > 100
389	        untested_patterns = set([p for p in pattern_cnt if pattern_cnt[p] == 0])

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_runner.py:33:0
32	import os
33	import subprocess
34	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_runner.py:141:16
140	                result.addInfo(test, msg)
141	                subprocess.check_call(command)
142	            except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\test_runner.py:439:27
438	        template_rendered.connect(self.on_template_rendered)
439	        self.database_id = random.randint(1, 10000)
440	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\tex.py:5:0
4	import os
5	import subprocess
6	from django.conf import settings

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\tex.py:32:12
31	        command.extend(['--', '--display-mode'])
32	    katex = subprocess.Popen(command,
33	                             stdin=subprocess.PIPE,
34	                             stdout=subprocess.PIPE,
35	                             stderr=subprocess.PIPE)
36	    stdout = katex.communicate(input=force_bytes(tex))[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\tex.py:39:8
38	        # stdout contains a newline at the end
39	        assert stdout is not None
40	        return stdout.decode('utf-8').strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:95:4
94	        six.reraise(thread.exc_info[0], thread.exc_info[1], thread.exc_info[2])
95	    assert thread.result is not None # assured if above did not reraise
96	    return thread.result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:223:4
222	    uploaded_file_name = user_file.name
223	    assert isinstance(uploaded_file_name, str)
224	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\upload.py:456:19
455	            str(user_profile.realm_id),
456	            format(random.randint(0, 255), 'x'),
457	            random_name(18),

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\lib\url_preview\preview.py:50:15
49	    data = data or {}
50	    response = requests.get(url)
51	    if response.ok:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:153:4
152	
153	    assert db_chunk_size >= 2
154	    assert chunk_size >= 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:154:4
153	    assert db_chunk_size >= 2
154	    assert chunk_size >= 2
155	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:157:8
156	    if id_collector is not None:
157	        assert(len(id_collector) == 0)
158	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:166:12
165	        while True:
166	            assert db_chunk_size is not None  # Hint for mypy, but also workaround for mypy bug #3442.
167	            rows = list(q.filter(id__gt=min_id)[0:db_chunk_size])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:184:8
183	        tup_ids = set([tup[0] for tup in tup_chunk])
184	        assert len(tup_ids) == len(tup_chunk)
185	        assert len(tup_ids.intersection(id_collector)) == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:185:8
184	        assert len(tup_ids) == len(tup_chunk)
185	        assert len(tup_ids.intersection(id_collector)) == 0
186	        id_collector.update(tup_ids)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\management\commands\convert_bot_to_outgoing_webhook.py:69:8
68	
69	        Service.objects.create(name=service_name,
70	                               user_profile=bot_profile,
71	                               base_url=base_url,
72	                               token='',
73	                               interface=1)
74	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\management\commands\deliver_email.py:59:22
58	
59	        with lockfile("/tmp/zulip_email_deliver.lockfile"):
60	            while True:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export.py:12:0
11	import shutil
12	import subprocess
13	import tempfile

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\management\commands\export.py:121:49
120	        if output_dir is None:
121	            output_dir = tempfile.mkdtemp(prefix="/tmp/zulip-export-")
122	        if os.path.exists(output_dir):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export.py:137:8
136	        os.chdir(os.path.dirname(output_dir))
137	        subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
138	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export.py:137:8
136	        os.chdir(os.path.dirname(output_dir))
137	        subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
138	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export_single_user.py:12:0
11	import shutil
12	import subprocess
13	import tempfile

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\management\commands\export_single_user.py:47:49
46	        if output_dir is None:
47	            output_dir = tempfile.mkdtemp(prefix="/tmp/zulip-export-")
48	        if os.path.exists(output_dir):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export_single_user.py:55:8
54	        tarball_path = output_dir.rstrip('/') + '.tar.gz'
55	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
56	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export_single_user.py:55:8
54	        tarball_path = output_dir.rstrip('/') + '.tar.gz'
55	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
56	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\zerver\management\commands\export_usermessage_batch.py:44:12
43	                shutil.move(partial_path, locked_path)
44	            except Exception:
45	                # Already claimed by another process
46	                continue
47	            logging.info("Thread %s processing %s" % (options['thread'], output_path))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\management\commands\gravatar_to_user_avatar.py:35:24
34	        gravatar_url = "https://secure.gravatar.com/avatar/%s?d=identicon" % (gravatar_hash(old_email),)
35	        gravatar_data = requests.get(gravatar_url).content
36	        gravatar_file = SimpleUploadedFile('gravatar.jpg', gravatar_data, 'image/jpeg')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\import.py:16:0
15	import os
16	import subprocess
17	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\import.py:57:8
56	        call_command('flush', verbosity=0, interactive=False)
57	        subprocess.check_call([os.path.join(settings.DEPLOY_ROOT, "scripts/setup/flush-memcached")])
58	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:105:4
104	    # type: (MutableMapping[str, Any], Text, str, str, Text, Text, int, Optional[AnyStr], Optional[Iterable[AnyStr]]) -> None
105	    assert error_content is None or error_content_iter is None
106	    if error_content is not None:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\middleware.py:214:23
213	        log_data["prof"].disable()
214	        profile_path = "/tmp/profile.data.%s.%s" % (path.split("/")[-1], int(time_delta * 1000),)
215	        log_data["prof"].dump_stats(profile_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:219:8
218	    if 400 <= status_code < 500 and status_code not in [401, 404, 405]:
219	        assert error_content_iter is not None
220	        error_content_list = list(error_content_iter)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\migrations\0077_add_file_name_field_to_realm_emoji.py:72:23
71	        try:
72	            response = requests.get(image_url, stream=True)
73	        except ConnectionError:

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:993:15
992	        where_clause = "UPPER(zerver_stream.name::text) IN (%s)" % (upper_list,)
993	        return get_active_streams(realm.id).select_related("realm").extra(
994	            where=[where_clause],
995	            params=stream_names)
996	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\templatetags\app_filters.py:96:11
95	    html_template = jinja.from_string(html)
96	    return mark_safe(html_template.render(context))

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\templatetags\app_filters.py:96:11
95	    html_template = jinja.from_string(html)
96	    return mark_safe(html_template.render(context))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_audit_log.py:38:19
37	        user = self.example_user('hamlet')
38	        password = 'test1'
39	        do_change_password(user, password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:146:19
145	        user_profile = self.example_user('hamlet')
146	        password = "testpassword"
147	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:152:39
151	        self.verify_backend(EmailAuthBackend(),
152	                            bad_kwargs=dict(username=username,
153	                                            password=''),
154	                            good_kwargs=dict(username=username,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:190:43
189	            self.verify_backend(EmailAuthBackend(),
190	                                bad_kwargs=dict(password="wrong",
191	                                                username=username),
192	                                good_kwargs=dict(password=password,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:198:19
197	        user_profile = self.example_user('hamlet')
198	        password = "testpassword"
199	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:277:19
276	        email = user_profile.email
277	        password = "test_password"
278	        self.setup_subdomain(user_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:454:12
453	            result = self.backend.do_auth(response=response)
454	            assert(result is not None)
455	            self.assertNotIn('subdomain=1', result.url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:465:16
464	                result = self.backend.do_auth(response=response)
465	                assert(result is not None)
466	                self.assertIn('subdomain=1', result.url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:476:16
475	                result = self.backend.do_auth(response=response)
476	                assert(result is not None)
477	                self.assertEqual('http://zulip.testserver/accounts/login/subdomain/', result.url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:990:12
989	            self.client_get(result.url)
990	            assert Confirmation.objects.all().count() == 1
991	            confirmation = Confirmation.objects.all().first()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1037:8
1036	        self.client_get(result.url)
1037	        assert Confirmation.objects.all().count() == 1
1038	        confirmation = Confirmation.objects.all().first()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1184:34
1183	        result = self.client_post("/api/v1/fetch_api_key",
1184	                                  dict(username=self.email,
1185	                                       password="wrong"))
1186	        self.assert_json_error(result, "Your username or password is incorrect.", 403)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1198:38
1197	            result = self.client_post("/api/v1/fetch_api_key",
1198	                                      dict(username="google-oauth2-token",
1199	                                           password="token"))
1200	        self.assert_json_success(result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1206:34
1205	        result = self.client_post("/api/v1/fetch_api_key",
1206	                                  dict(username="google-oauth2-token",
1207	                                       password="token"))
1208	        self.assert_json_error(result, "Your username or password is incorrect.", 403)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1220:38
1219	            result = self.client_post("/api/v1/fetch_api_key",
1220	                                      dict(username="google-oauth2-token",
1221	                                           password="token"))
1222	        self.assert_json_error(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1249:13
1248	        }
1249	        with self.settings(
1250	                LDAP_APPEND_DOMAIN='zulip.com',
1251	                AUTH_LDAP_BIND_PASSWORD='',
1252	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1253	            result = self.client_post("/api/v1/fetch_api_key",

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testing'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1254:38
1253	            result = self.client_post("/api/v1/fetch_api_key",
1254	                                      dict(username=self.email,
1255	                                           password="testing"))
1256	        self.assert_json_success(result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1758:13
1757	        }
1758	        with self.settings(
1759	                LDAP_APPEND_DOMAIN='zulip.com',
1760	                AUTH_LDAP_BIND_PASSWORD='',
1761	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1762	            user_profile = self.backend.authenticate(self.example_email("hamlet"), 'testing')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1764:12
1763	
1764	            assert(user_profile is not None)
1765	            self.assertEqual(user_profile.email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1775:13
1774	        }
1775	        with self.settings(
1776	                LDAP_APPEND_DOMAIN='zulip.com',
1777	                AUTH_LDAP_BIND_PASSWORD='',
1778	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1779	                user = self.backend.authenticate(self.example_email("hamlet"), 'wrong')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1790:13
1789	        }
1790	        with self.settings(
1791	                LDAP_APPEND_DOMAIN='zulip.com',
1792	                AUTH_LDAP_BIND_PASSWORD='',
1793	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1794	                user = self.backend.authenticate('nonexistent@zulip.com', 'testing')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1896:13
1895	        }
1896	        with self.settings(
1897	                REALMS_HAVE_SUBDOMAINS=True,
1898	                LDAP_APPEND_DOMAIN='zulip.com',
1899	                AUTH_LDAP_BIND_PASSWORD='',
1900	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1901	            user_profile = self.backend.authenticate(self.example_email("hamlet"), 'testing',

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1913:13
1912	        }
1913	        with self.settings(
1914	                REALMS_HAVE_SUBDOMAINS=True,
1915	                LDAP_APPEND_DOMAIN='zulip.com',
1916	                AUTH_LDAP_BIND_PASSWORD='',
1917	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1918	            user_profile = self.backend.authenticate(self.example_email("hamlet"), 'testing',

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1930:13
1929	        }
1930	        with self.settings(
1931	                REALMS_HAVE_SUBDOMAINS=True,
1932	                LDAP_APPEND_DOMAIN='zulip.com',
1933	                AUTH_LDAP_BIND_PASSWORD='',
1934	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1935	            user_profile = self.backend.authenticate(self.example_email("hamlet"), 'testing',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1937:12
1936	                                                     realm_subdomain=None)
1937	            assert(user_profile is not None)
1938	            self.assertEqual(user_profile.email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1948:13
1947	        }
1948	        with self.settings(
1949	                REALMS_HAVE_SUBDOMAINS=True,
1950	                LDAP_APPEND_DOMAIN='zulip.com',
1951	                AUTH_LDAP_BIND_PASSWORD='',
1952	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1953	            user_profile = self.backend.authenticate(self.example_email("hamlet"), 'testing',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1955:12
1954	                                                     realm_subdomain='zulip')
1955	            assert(user_profile is not None)
1956	            self.assertEqual(user_profile.email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1967:13
1966	        }
1967	        with self.settings(
1968	                REALMS_HAVE_SUBDOMAINS=True,
1969	                LDAP_APPEND_DOMAIN='acme.com',
1970	                AUTH_LDAP_BIND_PASSWORD='',
1971	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=acme,dc=com'):
1972	            user_profile = self.backend.authenticate('nonexisting@acme.com', 'testing',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1974:12
1973	                                                     realm_subdomain='zulip')
1974	            assert(user_profile is not None)
1975	            self.assertEqual(user_profile.email, 'nonexisting@acme.com')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:594:24
593	        email = user_profile.email
594	        test_password = "abcd1234"
595	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:726:24
725	        email = user_profile.email
726	        test_password = "abcd1234"
727	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:851:17
850	        # type: () -> None
851	        secret = 'random'
852	        req = self.Request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:876:17
875	        # type: () -> None
876	        secret = 'random'
877	        req = self.Request(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'broken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:882:13
881	
882	        with self.settings(SHARED_SECRET='broken'):
883	            self.assertFalse(authenticate_notify(req))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:888:17
887	        # type: () -> None
888	        secret = 'random'
889	        req = self.Request(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:960:8
959	        user_realm = get_realm('zulip')
960	        self._login(user_email, user_realm, password="test")  # we set a password because user is a bot
961	        self.assert_json_error_contains(self._do_test(user_email), "Webhook bots can only access webhooks")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:967:8
966	        user_realm = get_realm('zulip')
967	        self._login(user_email, user_realm, password="test")
968	        # Get user_profile after _login so that we have the latest data.

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_docs.py:5:0
4	import os
5	import subprocess
6	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_docs.py:140:12
139	                                         '../../tools/update-authors-json')  # nocoverage
140	            subprocess.check_call([update_script, '--use-fixture'])  # nocoverage
141	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_email_mirror.py:4:0
3	
4	import subprocess
5	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:389:8
388	        os.close(write_pipe)
389	        subprocess.check_call(
390	            [script, '-r', force_str(stream_to_address), '-s', settings.SHARED_SECRET, '-t'],
391	            stdin=read_pipe)
392	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:410:12
409	        try:
410	            subprocess.check_output([script, '-s', settings.SHARED_SECRET, '-t'],
411	                                    stdin=read_pipe)
412	        except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_export.py:79:12
78	            # at first
79	            assert len(list(query)) > 0
80	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:515:8
514	        message = most_recent_message(user_profile)
515	        assert(UserMessage.objects.get(user_profile=user_profile, message=message).flags.mentioned.is_set)
516	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_messages.py:1003:19
1002	        user = get_system_bot(settings.EMAIL_GATEWAY_BOT)
1003	        password = "test_password"
1004	        user.set_password(password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:1615:8
1614	
1615	        assert(mirror_sender is not None)
1616	        self.assertTrue(valid_input)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_messages.py:1925:14
1924	        parent = self.example_user('othello')
1925	        bot = do_create_user(
1926	            email='othello-bot@zulip.com',
1927	            password='',
1928	            realm=parent.realm,
1929	            full_name='',
1930	            short_name='',
1931	            active=True,
1932	            bot_type=UserProfile.DEFAULT_BOT,
1933	            bot_owner=parent
1934	        )
1935	        bot.last_reminder = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:1967:8
1966	        # stream doesn't exist
1967	        assert(sender.last_reminder is not None)
1968	        sender.last_reminder = sender.last_reminder - datetime.timedelta(hours=1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:458:8
457	                break
458	        assert(message_to_assert is not None)
459	        self.assertEqual(len(message_to_assert['reactions']), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:488:12
487	            # type: (Union[Text, List[Dict[str, Any]]]) -> Text
488	            assert isinstance(dr, list)
489	            return ','.join(sorted(set([r['email'] for r in dr] + [me])))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:94:16
93	        user_id = 10
94	        token = "111222"
95	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:109:16
108	        # type: () -> None
109	        token = "111222"
110	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:125:16
124	        # type: () -> None
125	        token = "111222"
126	        user_id = 11

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cccc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:492:20
491	        cache_value = self.get_cache_value()
492	        cache_value['token'] = 'cccc'
493	        self.redis_client.hmset(apn.get_apns_key(100), cache_value)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cccc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:502:20
501	        cache_value = self.get_cache_value()
502	        cache_value['token'] = 'cccc'
503	        self.redis_client.hmset(apn.get_apns_key(100), cache_value)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'dddd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:514:20
513	        cache_value = self.get_cache_value()
514	        cache_value['token'] = 'dddd'
515	        self.redis_client.hmset(apn.get_apns_key(100), cache_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_domains.py:138:16
137	            else:
138	                assert(realm is not None)
139	                self.assertEqual(realm.string_id, realm_string_id)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:26:27
25	        self.user_profile = self.example_user("othello")
26	        self.bot_profile = do_create_user(email="foo-bot@zulip.com",
27	                                          password="test",
28	                                          realm=get_realm_by_email_domain("zulip.com"),
29	                                          full_name="FooBot",
30	                                          short_name="foo-bot",
31	                                          bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
32	                                          bot_owner=self.user_profile)
33	        self.second_bot_profile = do_create_user(email="bar-bot@zulip.com",

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:33:34
32	                                          bot_owner=self.user_profile)
33	        self.second_bot_profile = do_create_user(email="bar-bot@zulip.com",
34	                                                 password="test",
35	                                                 realm=get_realm_by_email_domain("zulip.com"),
36	                                                 full_name="BarBot",
37	                                                 short_name="bar-bot",
38	                                                 bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
39	                                                 bot_owner=self.user_profile)
40	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:70:12
69	            "/json/settings/change",
70	            dict(
71	                full_name='Foo Bar',
72	                old_password=initial_password(self.example_email("hamlet")),
73	                new_password='foobar1',
74	                confirm_password='foobar1',
75	            ))
76	        self.assert_json_success(json_result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'mismatched_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:167:12
166	            "/json/settings/change",
167	            dict(
168	                new_password="mismatched_password",
169	                confirm_password="not_the_same",
170	            ))
171	        self.assert_json_error(result,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:182:12
181	            "/json/settings/change",
182	            dict(
183	                old_password='bad_password',
184	                new_password="ignored",
185	                confirm_password="ignored",
186	            ))
187	        self.assert_json_error(result, "Wrong password!")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:198:34
197	        result = self.client_post("/json/settings/change",
198	                                  dict(old_password='ignored',))
199	        self.assert_json_error(result, "No new data supplied")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'new_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:151:8
150	        # log back in with new password
151	        self.login(email, password='new_password')
152	        user_profile = self.example_user('hamlet')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:245:8
244	        # type: () -> None
245	        self.login(self.example_email("hamlet"), password="wrongpassword", fails=True)
246	        self.assertIsNone(get_session_dict_user(self.client.session))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hmb'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:317:19
316	        email = self.nonreg_email('test')
317	        password = u"hmb"
318	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:860:19
859	        # type: () -> None
860	        password = "test"
861	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:938:19
937	        # type: () -> None
938	        password = "test"
939	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:984:19
983	        # type: () -> None
984	        password = "test"
985	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1024:19
1023	        email = self.nonreg_email('newguy')
1024	        password = "newpassword"
1025	        timezone = "US/Mountain"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1067:19
1066	        email = "newguy@zulip.com"
1067	        password = "newpassword"
1068	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1128:19
1127	        email = "newguy@zulip.com"
1128	        password = "newpassword"
1129	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1160:19
1159	        email = "newguy@zulip.com"
1160	        password = "newpassword"
1161	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1193:19
1192	        email = "newuser@zulip.com"
1193	        password = "newpassword"
1194	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1228:19
1227	        # type: () -> None
1228	        password = "test"
1229	        email = "user1@acme.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1274:19
1273	        # type: () -> None
1274	        password = "test"
1275	        email = "user1@acme.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testing'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1377:19
1376	        # type: () -> None
1377	        password = "testing"
1378	        email = "newuser@zulip.com"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:1414:13
1413	
1414	        with self.settings(
1415	                POPULATE_PROFILE_VIA_LDAP=True,
1416	                LDAP_APPEND_DOMAIN='zulip.com',
1417	                AUTH_LDAP_BIND_PASSWORD='',
1418	                AUTH_LDAP_USER_ATTR_MAP=ldap_user_attr_map,
1419	                AUTHENTICATION_BACKENDS=('zproject.backends.ZulipLDAPAuthBackend',),
1420	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
1421	            result = self.client_get(confirmation_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1519:19
1518	        # type: (Any) -> None
1519	        password = "test"
1520	        subdomain = "sipb"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:831:8
830	
831	        assert(found_sub is not None)
832	        self.assertEqual(found_sub['color'], new_color)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_subs.py:1268:41
1267	        for stream in existing_stream_names:
1268	            random_stream = stream + str(random.randint(0, 9))
1269	            if random_stream not in all_stream_names:

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_templates.py:173:18
172	
173	        context = dict(
174	            article="zerver/help/index.md",
175	            shallow_tested=True,
176	            user_profile=user_profile,
177	            user=user_profile,
178	            form=DummyForm(
179	                full_name=get_form_value('John Doe'),
180	                terms=get_form_value(True),
181	                email=get_form_value(email),
182	                emails=get_form_value(email),
183	            ),
184	            current_url=lambda: 'www.zulip.com',
185	            hubot_lozenges_dict={},
186	            integrations_dict={},
187	            referrer=dict(
188	                full_name='John Doe',
189	                realm=dict(name='zulip.com'),
190	            ),
191	            uid='uid',
192	            token='token',
193	            message_count=0,
194	            messages=[dict(header='Header')],
195	            new_streams=dict(html=''),
196	            data=dict(title='Title'),
197	            device_info={"device_browser": "Chrome",
198	                         "device_os": "Windows",
199	                         "device_ip": "127.0.0.1",
200	                         "login_time": "9:33am NewYork, NewYork",
201	                         },
202	            zulip_support="zulip-admin@example.com",
203	        )
204	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:428:12
427	            content = ujson.loads(result.content)
428	            assert sanitize_name(expected) in content['uri']
429	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\zerver\tests\test_upload.py:1047:36
1046	
1047	        self.assertEqual(b"zulip!", urllib.request.urlopen(redirect_url).read().strip()) # type: ignore # six.moves.urllib.request.urlopen is not defined in typeshed
1048	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:197:49
196	
197	        result = self.client_post("/json/users", dict(
198	            email='romeo@not-zulip.com',
199	            password='xxxx',
200	        ))
201	        self.assert_json_error(result, "Missing 'full_name' argument")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:203:49
202	
203	        result = self.client_post("/json/users", dict(
204	            email='romeo@not-zulip.com',
205	            password='xxxx',
206	            full_name='Romeo Montague',
207	        ))
208	        self.assert_json_error(result, "Missing 'short_name' argument")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:210:49
209	
210	        result = self.client_post("/json/users", dict(
211	            email='broken',
212	            password='xxxx',
213	            full_name='Romeo Montague',
214	            short_name='Romeo',
215	        ))
216	        self.assert_json_error(result, "Bad name or username")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:218:49
217	
218	        result = self.client_post("/json/users", dict(
219	            email='romeo@not-zulip.com',
220	            password='xxxx',
221	            full_name='Romeo Montague',
222	            short_name='Romeo',
223	        ))
224	        self.assert_json_error(result,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:230:23
229	        # HAPPY PATH STARTS HERE
230	        valid_params = dict(
231	            email='romeo@zulip.net',
232	            password='xxxx',
233	            full_name='Romeo Montague',
234	            short_name='Romeo',
235	        )
236	        result = self.client_post("/json/users", valid_params)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tornado\event_queue.py:191:65
190	        ioloop = tornado.ioloop.IOLoop.instance()
191	        heartbeat_time = time.time() + HEARTBEAT_MIN_FREQ_SECS + random.randint(0, 10)
192	        if self.client_type_name != 'API: heartbeat test':

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tornado\event_queue.py:478:59
477	    try:
478	        os.rename(settings.JSON_PERSISTENT_QUEUE_FILENAME, "/var/tmp/event_queues.json.last")
479	    except OSError:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\tornado\websocket_client.py:86:19
85	        url = urljoin(self.parsed_host_url.geturl(), '/json/events?dont_block=true')
86	        response = requests.get(url, headers={'Cookie': cookies_header}, verify=self.validate_ssl)
87	        return response.json()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\views\auth.py:292:11
291	
292	    resp = requests.post(
293	        'https://www.googleapis.com/oauth2/v3/token',
294	        data={
295	            'code': request.GET.get('code'),
296	            'client_id': settings.GOOGLE_OAUTH2_CLIENT_ID,
297	            'client_secret': settings.GOOGLE_OAUTH2_CLIENT_SECRET,
298	            'redirect_uri': ''.join((
299	                settings.EXTERNAL_URI_SCHEME,
300	                settings.EXTERNAL_HOST,
301	                reverse('zerver.views.auth.finish_google_oauth2'),
302	            )),
303	            'grant_type': 'authorization_code',
304	        },
305	    )
306	    if resp.status_code == 400:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\views\auth.py:314:11
313	
314	    resp = requests.get(
315	        'https://www.googleapis.com/plus/v1/people/me',
316	        params={'access_token': access_token}
317	    )
318	    if resp.status_code == 400:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:177:12
176	            # stream name, this will always match
177	            assert(m is not None)
178	            base_stream_name = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:198:12
197	            # Since the regex has a `.*` in it, this will always match
198	            assert(m is not None)
199	            base_topic = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:945:4
944	    prev_topic = message.subject
945	    assert(datetime_to_timestamp(message.last_edit_time) == message_history[0]['timestamp'])
946	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:21:20
20	    # type: (str) -> None
21	    if token_str == '' or len(token_str) > 4096:
22	        raise JsonableError(_('Empty or invalid length token'))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_icon.py:57:4
56	    # hacks to prevent us from having to jump through decode/encode hoops.
57	    assert '?' in url
58	    url += '&' + request.META['QUERY_STRING']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:199:8
198	            set_default_streams(realm, stream_info)
199	        assert(realm is not None)
200	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\report.py:18:0
17	
18	import subprocess
19	import os

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\report.py:98:18
97	    try:
98	        version = subprocess.check_output(["git", "log", "HEAD^..HEAD", "--oneline"],
99	                                          universal_newlines=True)  # type: Optional[Text]
100	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\report.py:98:18
97	    try:
98	        version = subprocess.check_output(["git", "log", "HEAD^..HEAD", "--oneline"],
99	                                          universal_newlines=True)  # type: Optional[Text]
100	    except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:45:8
44	        confirmed = True
45	        assert isinstance(obj, EmailChangeStatus)
46	        new_email = obj.new_email

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:103:23
102	
103	    if new_password != "" or confirm_password != "":
104	        if new_password != confirm_password:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:103:49
102	
103	    if new_password != "" or confirm_password != "":
104	        if new_password != confirm_password:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:142:4
141	    # hacks to prevent us from having to jump through decode/encode hoops.
142	    assert '?' in url
143	    url += '&' + request.META['QUERY_STRING']

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\users.py:269:18
268	
269	    bot_profile = do_create_user(email=email, password='',
270	                                 realm=user_profile.realm, full_name=full_name,
271	                                 short_name=short_name, active=True,
272	                                 bot_type=UserProfile.DEFAULT_BOT,
273	                                 bot_owner=user_profile,
274	                                 avatar_source=avatar_source,
275	                                 default_sending_stream=default_sending_stream,
276	                                 default_events_register_stream=default_events_register_stream,
277	                                 default_all_public_streams=default_all_public_streams)
278	    if len(request.FILES) == 1:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\zephyr.py:16:0
15	import logging
16	import subprocess
17	import ujson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:42:8
41	            user = kerberos_alter_egos[user]
42	        assert(user == user_profile.email.split("@")[0])
43	        ccache = make_ccache(parsed_cred)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\zephyr.py:49:8
48	    try:
49	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--",
50	                               "/home/zulip/zulip/api/integrations/zephyr/process_ccache",
51	                               force_str(user),
52	                               force_str(user_profile.api_key),
53	                               force_str(base64.b64encode(ccache))])
54	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\zephyr.py:49:8
48	    try:
49	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--",
50	                               "/home/zulip/zulip/api/integrations/zephyr/process_ccache",
51	                               force_str(user),
52	                               force_str(user_profile.api_key),
53	                               force_str(base64.b64encode(ccache))])
54	    except Exception:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\webhooks\beanstalk\view.py:37:8
36	                request.META['HTTP_AUTHORIZATION'] = "Basic " + encoded_credentials
37	        except Exception:
38	            pass
39	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:92:4
91	    # type: (Dict[str, Any]) -> str
92	    assert(payload['repository'] is not None)
93	    return BITBUCKET_SUBJECT_TEMPLATE.format(repository_name=get_repository_name(payload['repository']))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\mark_all_messages_unread.py:16:8
15	        # type: (*Any, **Any) -> None
16	        assert settings.DEVELOPMENT
17	        UserMessage.objects.all().update(flags=F('flags').bitand(~UserMessage.flags.read))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:207:56
206	        for i in range(options["num_huddles"]):
207	            get_huddle(random.sample(user_profiles_ids, random.randint(3, 4)))
208	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zilencer\management\commands\populate_db.py:266:12
265	            # TODO: Clean up this initial bot creation code
266	            Service.objects.create(
267	                name="test",
268	                user_profile=get_user_profile_by_email("outgoing-webhook@zulip.com"),
269	                base_url="http://127.0.0.1:5002/bots/followup",
270	                token="abcd1234",
271	                interface=1)
272	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:358:13
357	    texts = open("zilencer/management/commands/test_messages.txt", "r").readlines()
358	    offset = random.randint(0, len(texts))
359	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:376:17
375	        message.sending_client = get_client('populate_db')
376	        length = random.randint(1, 5)
377	        lines = (t.strip() for t in texts[offset: offset + length])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:382:18
381	
382	        randkey = random.randint(1, random_max)
383	        if (num_messages > 0 and

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:384:16
383	        if (num_messages > 0 and
384	                random.randint(1, random_max) * 100. / random_max < options["stickyness"]):
385	            # Use an old recipient

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:397:52
396	            message_type = Recipient.HUDDLE
397	            message.recipient = get_recipient_by_id(random.choice(recipient_huddles))
398	        elif (randkey <= random_max * (options["percent_huddles"] + options["percent_personals"]) / 100.):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:400:29
399	            message_type = Recipient.PERSONAL
400	            personals_pair = random.choice(personals_pairs)
401	            random.shuffle(personals_pair)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:404:52
403	            message_type = Recipient.STREAM
404	            message.recipient = get_recipient_by_id(random.choice(recipient_streams))
405	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:407:24
406	        if message_type == Recipient.HUDDLE:
407	            sender_id = random.choice(huddle_members[message.recipient.id])
408	            message.sender = get_user_profile_by_id(sender_id)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:417:29
416	            # Pick a random subscriber to the stream
417	            message.sender = random.choice(Subscription.objects.filter(
418	                recipient=message.recipient)).user_profile
419	            message.subject = stream.name + Text(random.randint(1, 3))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:419:49
418	                recipient=message.recipient)).user_profile
419	            message.subject = stream.name + Text(random.randint(1, 3))
420	            saved_data['subject'] = message.subject

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zilencer\management\commands\profile_request.py:47:20
46	    prof.disable()
47	    prof.dump_stats("/tmp/profile.data")
48	    request_logger.process_response(request, ret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zilencer\views.py:28:16
27	    validate_entity(entity)
28	    if token == '' or len(token) > 4096:
29	        raise JsonableError(_("Empty or invalid length token"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:262:8
261	        # type: (Optional[Text], Optional[Text], bool, Optional[Dict[str, Any]]) -> Optional[UserProfile]
262	        assert username is not None
263	        if use_dummy_backend:

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\zproject\jinja2\__init__.py:19:10
18	    # type: (**Any) -> Environment
19	    env = Environment(**options)
20	    env.globals.update({

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\settings.py:1061:25
1060	
1061	ZULIP_WORKER_TEST_FILE = '/tmp/zulip-worker-test-file'
1062	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\test_settings.py:62:16
61	# Don't use the real message log for tests
62	EVENT_LOG_DIR = '/tmp/zulip-test-event-log'
63	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_settings.py:124:16
123	S3_KEY = 'test-key'
124	S3_SECRET_KEY = 'test-secret-key'
125	S3_AUTH_UPLOADS_BUCKET = 'test-authed-bucket'

--------------------------------------------------

Code scanned:
	Total lines of code: 70852
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 349
		Medium: 56
		High: 15
	Total issues (by confidence):
		Undefined: 0
		Low: 25
		Medium: 94
		High: 301
Files skipped (0):
