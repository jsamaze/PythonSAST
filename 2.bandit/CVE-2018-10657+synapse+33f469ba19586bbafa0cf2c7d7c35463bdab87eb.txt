Working... ---------------------------------------- 100% 0:00:06
Run started:2024-02-10 21:11:54.720141

Test results:
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\scripts-dev\convert_server_keys.py:72:13
71	def main():
72	    config = yaml.load(open(sys.argv[1]))
73	    valid_until = int(time.time() / (3600 * 24)) * 1000 * 3600 * 24

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\convert_server_keys.py:79:4
78	    database = config["database"]
79	    assert database["name"] == "psycopg2", "Can only convert for postgresql"
80	    args = database["args"]

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\scripts-dev\tail-synapse.py:35:26
34	        server + "/_synapse/replication",
35	        verify=False,
36	        params=streams
37	    ).content)
38	
39	
40	def main():

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\tail-synapse.py:33:26
32	def replicate(server, streams):
33	    return parse_response(requests.get(
34	        server + "/_synapse/replication",
35	        verify=False,
36	        params=streams
37	    ).content)
38	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\setup.py:77:4
76	    code = read_file(path_segments)
77	    exec(code, result)
78	    return result

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\constants.py:46:15
45	class LoginType(object):
46	    PASSWORD = u"m.login.password"
47	    EMAIL_IDENTITY = u"m.login.email.identity"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'org.matrix.login.shared_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\constants.py:54:20
53	    APPLICATION_SERVICE = u"m.login.application_service"
54	    SHARED_SECRET = u"org.matrix.login.shared_secret"
55	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_MISSING_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:38:20
37	    NOT_FOUND = "M_NOT_FOUND"
38	    MISSING_TOKEN = "M_MISSING_TOKEN"
39	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_UNKNOWN_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:39:20
38	    MISSING_TOKEN = "M_MISSING_TOKEN"
39	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"
40	    GUEST_ACCESS_FORBIDDEN = "M_GUEST_ACCESS_FORBIDDEN"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\app\_base.py:175:18
174	    """
175	    if address == '0.0.0.0' and '::' in bind_addresses:
176	        logger.warn('Failed to listen on 0.0.0.0, continuing because listening on [::]')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\appservice.py:90:20
89	                    listener["port"],
90	                    manhole(
91	                        username="matrix",
92	                        password="rabbithole",
93	                        globals={"hs": self},
94	                    )
95	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\appservice.py:129:4
128	
129	    assert config.worker_app == "synapse.app.appservice"
130	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\client_reader.py:114:20
113	                    listener["port"],
114	                    manhole(
115	                        username="matrix",
116	                        password="rabbithole",
117	                        globals={"hs": self},
118	                    )
119	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\client_reader.py:139:4
138	
139	    assert config.worker_app == "synapse.app.client_reader"
140	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\event_creator.py:130:20
129	                    listener["port"],
130	                    manhole(
131	                        username="matrix",
132	                        password="rabbithole",
133	                        globals={"hs": self},
134	                    )
135	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\event_creator.py:154:4
153	
154	    assert config.worker_app == "synapse.app.event_creator"
155	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\event_creator.py:156:4
155	
156	    assert config.worker_replication_http_port is not None
157	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\federation_reader.py:103:20
102	                    listener["port"],
103	                    manhole(
104	                        username="matrix",
105	                        password="rabbithole",
106	                        globals={"hs": self},
107	                    )
108	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\federation_reader.py:127:4
126	
127	    assert config.worker_app == "synapse.app.federation_reader"
128	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\frontend_proxy.py:168:20
167	                    listener["port"],
168	                    manhole(
169	                        username="matrix",
170	                        password="rabbithole",
171	                        globals={"hs": self},
172	                    )
173	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\frontend_proxy.py:192:4
191	
192	    assert config.worker_app == "synapse.app.frontend_proxy"
193	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\frontend_proxy.py:194:4
193	
194	    assert config.worker_main_http_uri is not None
195	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\homeserver.py:239:20
238	                    listener["port"],
239	                    manhole(
240	                        username="matrix",
241	                        password="rabbithole",
242	                        globals={"hs": self},
243	                    )
244	                )

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\synapse\app\homeserver.py:391:35
390	                ident = current_thread().ident
391	                profile.dump_stats("/tmp/%s.%s.%i.pstat" % (
392	                    hs.hostname, func.__name__, ident
393	                ))
394	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\media_repository.py:110:20
109	                    listener["port"],
110	                    manhole(
111	                        username="matrix",
112	                        password="rabbithole",
113	                        globals={"hs": self},
114	                    )
115	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\media_repository.py:134:4
133	
134	    assert config.worker_app == "synapse.app.media_repository"
135	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\pusher.py:120:20
119	                    listener["port"],
120	                    manhole(
121	                        username="matrix",
122	                        password="rabbithole",
123	                        globals={"hs": self},
124	                    )
125	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\pusher.py:186:4
185	
186	    assert config.worker_app == "synapse.app.pusher"
187	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\synchrotron.py:297:20
296	                    listener["port"],
297	                    manhole(
298	                        username="matrix",
299	                        password="rabbithole",
300	                        globals={"hs": self},
301	                    )
302	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\synchrotron.py:403:4
402	
403	    assert config.worker_app == "synapse.app.synchrotron"
404	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\app\synctl.py:23:0
22	import signal
23	import subprocess
24	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\app\synctl.py:65:8
64	    try:
65	        subprocess.check_call(args)
66	        write("started synapse.app.homeserver(%r)" %

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\app\synctl.py:84:8
83	    try:
84	        subprocess.check_call(args)
85	        write("started %s(%r)" % (app, worker_configfile), colour=GREEN)

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\synapse\app\synctl.py:165:17
164	    with open(configfile) as stream:
165	        config = yaml.load(stream)
166	

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\synapse\app\synctl.py:204:28
203	        with open(worker_configfile) as stream:
204	            worker_config = yaml.load(stream)
205	        worker_app = worker_config["worker_app"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\synctl.py:215:12
214	            daemonize = worker_config.get("daemonize") or config.get("daemonize")
215	            assert daemonize, "Main process must have daemonize set to true"
216	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\synctl.py:221:16
220	                    continue
221	                assert not key.startswith("worker_"), \
222	                    "Main process cannot use worker_* config"
223	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\synctl.py:226:12
225	            worker_daemonize = worker_config["worker_daemonize"]
226	            assert worker_daemonize, "In config %r: expected '%s' to be True" % (
227	                worker_configfile, "worker_daemonize")
228	            worker_cache_factor = worker_config.get("synctl_cache_factor")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\user_dir.py:142:20
141	                    listener["port"],
142	                    manhole(
143	                        username="matrix",
144	                        password="rabbithole",
145	                        globals={"hs": self},
146	                    )
147	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\user_dir.py:179:4
178	
179	    assert config.worker_app == "synapse.app.user_dir"
180	

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\synapse\config\_base.py:148:19
147	        with open(file_path) as file_stream:
148	            return yaml.load(file_stream)
149	

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\synapse\config\_base.py:174:17
173	
174	        config = yaml.load(default_config)
175	

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\synapse\config\appservice.py:60:30
59	                appservice = _load_appservice(
60	                    hostname, yaml.load(f), config_file
61	                )

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\synapse\config\logger.py:187:42
186	            with open(log_config, 'r') as f:
187	                logging.config.dictConfig(yaml.load(f))
188	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\config\repository.py:149:16
148	            try:
149	                import lxml
150	                lxml  # To stop unused lint.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\server.py:336:8
335	    try:
336	        assert len(thresholds) == 3
337	        return (

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\config\tls.py:19:0
18	from OpenSSL import crypto
19	import subprocess
20	import os

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\config\tls.py:170:16
169	            if GENERATE_DH_PARAMS:
170	                subprocess.check_call([
171	                    "openssl", "dhparam",
172	                    "-outform", "PEM",
173	                    "-out", tls_dh_params_path,
174	                    "2048"
175	                ])
176	            else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\config\tls.py:170:16
169	            if GENERATE_DH_PARAMS:
170	                subprocess.check_call([
171	                    "openssl", "dhparam",
172	                    "-outform", "PEM",
173	                    "-out", tls_dh_params_path,
174	                    "2048"
175	                ])
176	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\events\spamcheck.py:25:8
24	            module, config = hs.config.spam_checker
25	        except Exception:
26	            pass
27	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\send_queue.py:187:12
186	        if key:
187	            assert isinstance(key, tuple)
188	            self.keyed_edu[(destination, key)] = edu

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\groups\attestations.py:110:27
109	        validity_period = DEFAULT_ATTESTATION_LENGTH_MS
110	        validity_period *= random.uniform(*DEFAULT_ATTESTATION_JITTER)
111	        valid_until_ms = int(self.clock.time_msec() + validity_period)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\events.py:74:26
73	                # thundering herds on restart.
74	                timeout = random.randint(int(timeout * 0.9), int(timeout * 1.1))
75	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:61:16
60	
61	                assert batch_group is not None
62	                assert batch_group_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:62:16
61	                assert batch_group is not None
62	                assert batch_group_key is not None
63	                assert batch_token is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:63:16
62	                assert batch_group_key is not None
63	                assert batch_token is not None
64	            except Exception:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\endpoint.py:236:24
235	        total_weight = sum(weight for index, weight in weight_indexes)
236	        target_weight = random.randint(0, total_weight)
237	        for index, weight in weight_indexes:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\push\pusher.py:30:0
29	    from synapse.push.mailer import Mailer, load_jinja2_templates
30	except Exception:
31	    pass
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\membership.py:157:4
156	    """
157	    assert change in ("joined", "left")
158	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'batch'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\replication\tcp\commands.py:104:29
103	            stream_name,
104	            None if token == "batch" else int(token),
105	            simplejson.loads(row_json)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'NOW'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\replication\tcp\commands.py:181:20
180	        if token in ("NOW", "now"):
181	            token = "NOW"
182	        else:

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\synapse\rest\client\v1\login.py:35:0
34	
35	import xml.etree.ElementTree as ET
36	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\rest\client\v1\login.py:90:17
89	    CAS_TYPE = "m.login.cas"
90	    TOKEN_TYPE = "m.login.token"
91	    JWT_TYPE = "m.login.jwt"

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\synapse\rest\client\v1\login.py:487:19
486	        try:
487	            root = ET.fromstring(cas_response_body)
488	            if not root.tag.endswith("serviceResponse"):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:28:0
27	        )
28	except Exception:
29	    # any other exception is fine
30	    pass
31	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:43:0
42	        )
43	except Exception:
44	    # any other exception is fine
45	    pass

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\media_storage.py:122:12
121	                os.remove(fname)
122	            except Exception:
123	                pass
124	            six.reraise(t, v, tb)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\_base.py:104:12
103	                )
104	            except Exception:
105	                # Don't let logging failures stop SQL from working
106	                pass
107	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:541:14
540	        # First try to update.
541	        sql = "UPDATE %s SET %s WHERE %s" % (
542	            table,
543	            ", ".join("%s = ?" % (k,) for k in values),
544	            " AND ".join("%s = ?" % (k,) for k in keyvalues)
545	        )
546	        sqlargs = values.values() + keyvalues.values()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:559:14
558	
559	        sql = "INSERT INTO %s (%s) VALUES (%s)" % (
560	            table,
561	            ", ".join(k for k in allvalues),
562	            ", ".join("?" for _ in allvalues)
563	        )
564	        txn.execute(sql, allvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:625:12
624	        sql = (
625	            "SELECT %(retcol)s FROM %(table)s"
626	        ) % {
627	            "retcol": retcol,
628	            "table": table,
629	        }
630	
631	        if keyvalues:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:692:18
691	        if keyvalues:
692	            sql = "SELECT %s FROM %s WHERE %s" % (
693	                ", ".join(retcols),
694	                table,
695	                " AND ".join("%s = ?" % (k, ) for k in keyvalues)
696	            )
697	            txn.execute(sql, keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:699:18
698	        else:
699	            sql = "SELECT %s FROM %s" % (
700	                ", ".join(retcols),
701	                table
702	            )
703	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:761:14
760	
761	        sql = "SELECT %s FROM %s" % (", ".join(retcols), table)
762	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:797:21
796	
797	        update_sql = "UPDATE %s SET %s %s" % (
798	            table,
799	            ", ".join("%s = ?" % (k,) for k in updatevalues),
800	            where,
801	        )
802	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:847:21
846	                               allow_none=False):
847	        select_sql = "SELECT %s FROM %s WHERE %s" % (
848	            ", ".join(retcols),
849	            table,
850	            " AND ".join("%s = ?" % (k,) for k in keyvalues)
851	        )
852	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:886:14
885	        """
886	        sql = "DELETE FROM %s WHERE %s" % (
887	            table,
888	            " AND ".join("%s = ?" % (k, ) for k in keyvalues)
889	        )
890	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:904:14
903	    def _simple_delete_txn(txn, table, keyvalues):
904	        sql = "DELETE FROM %s WHERE %s" % (
905	            table,
906	            " AND ".join("%s = ?" % (k, ) for k in keyvalues)
907	        )
908	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:932:14
931	
932	        sql = "DELETE FROM %s" % table
933	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:958:12
957	        sql = (
958	            "SELECT %(entity)s, MAX(%(stream)s) FROM %(table)s"
959	            " WHERE %(stream)s > ? - %(limit)s"
960	            " GROUP BY %(entity)s"
961	        ) % {
962	            "table": table,
963	            "entity": entity_column,
964	            "stream": stream_column,
965	            "limit": limit,
966	        }
967	
968	        sql = self.database_engine.convert_param_style(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:1090:18
1089	        if keyvalues:
1090	            sql = "SELECT %s FROM %s WHERE %s ORDER BY %s" % (
1091	                ", ".join(retcols),
1092	                table,
1093	                " AND ".join("%s = ?" % (k,) for k in keyvalues),
1094	                " ? ASC LIMIT ? OFFSET ?"
1095	            )
1096	            txn.execute(sql, keyvalues.values() + pagevalues)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:1098:18
1097	        else:
1098	            sql = "SELECT %s FROM %s ORDER BY %s" % (
1099	                ", ".join(retcols),
1100	                table,
1101	                " ? ASC LIMIT ? OFFSET ?"
1102	            )
1103	            txn.execute(sql, pagevalues)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\_base.py:1191:18
1190	        if term:
1191	            sql = "SELECT %s FROM %s WHERE %s LIKE ?" % (
1192	                ", ".join(retcols),
1193	                table,
1194	                col
1195	            )
1196	            termvalues = ["%%" + term + "%%"]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\client_ips.py:173:12
172	        inner_select = (
173	            "SELECT MAX(last_seen) mls, user_id, device_id FROM user_ips "
174	            "WHERE %(where)s "
175	            "GROUP BY user_id, device_id"
176	        ) % {
177	            "where": " OR ".join(where_clauses),
178	        }
179	
180	        sql = (

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\client_ips.py:181:12
180	        sql = (
181	            "SELECT %(retcols)s FROM user_ips "
182	            "JOIN (%(inner_select)s) ips ON"
183	            "    user_ips.last_seen = ips.mls AND"
184	            "    user_ips.user_id = ips.user_id AND"
185	            "    (user_ips.device_id = ips.device_id OR"
186	            "         (user_ips.device_id IS NULL AND ips.device_id IS NULL)"
187	            "    )"
188	        ) % {
189	            "retcols": ",".join("user_ips." + c for c in retcols),
190	            "inner_select": inner_select,
191	        }
192	
193	        txn.execute(sql, bindings)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\deviceinbox.py:190:20
189	                sql = (
190	                    "SELECT device_id FROM devices"
191	                    " WHERE user_id = ? AND device_id IN ("
192	                    + ",".join("?" * len(devices))
193	                    + ")"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\end_to_end_keys.py:105:12
104	        sql = (
105	            "SELECT user_id, device_id, "
106	            "    d.display_name AS device_display_name, "
107	            "    k.key_json"
108	            " FROM devices d"
109	            "    %s JOIN e2e_device_keys_json k USING (user_id, device_id)"
110	            " WHERE %s"
111	        ) % (
112	            "LEFT" if include_all_devices else "INNER",
113	            " OR ".join("(" + q + ")" for q in query_clauses)
114	        )
115	
116	        txn.execute(sql, query_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\events_worker.py:345:16
344	            sql = (
345	                "SELECT "
346	                " e.event_id as event_id, "
347	                " e.internal_metadata,"
348	                " e.json,"
349	                " r.redacts as redacts,"
350	                " rej.event_id as rejects "
351	                " FROM event_json as e"
352	                " LEFT JOIN rejections as rej USING (event_id)"
353	                " LEFT JOIN redactions as r ON e.event_id = r.redacts"
354	                " WHERE e.event_id IN (%s)"
355	            ) % (",".join(["?"] * len(evs)),)
356	
357	            txn.execute(sql, evs)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\push_rule.py:206:8
205	        # See bulk_get_push_rules_for_room for how we work around this.
206	        assert state_group is not None
207	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\receipts.py:222:20
221	                sql = (
222	                    "SELECT * FROM receipts_linearized WHERE"
223	                    " room_id IN (%s) AND stream_id > ? AND stream_id <= ?"
224	                ) % (
225	                    ",".join(["?"] * len(room_ids))
226	                )
227	                args = list(room_ids)
228	                args.extend([from_key, to_key])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\receipts.py:233:20
232	                sql = (
233	                    "SELECT * FROM receipts_linearized WHERE"
234	                    " room_id IN (%s) AND stream_id <= ?"
235	                ) % (
236	                    ",".join(["?"] * len(room_ids))
237	                )
238	
239	                args = list(room_ids)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\registration.py:318:16
317	            txn.execute(
318	                "SELECT token, id, device_id FROM access_tokens WHERE %s" % where_clause,
319	                values

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\registration.py:329:16
328	            txn.execute(
329	                "DELETE FROM access_tokens WHERE %s" % where_clause,
330	                values

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\room.py:421:16
420	            sql = (
421	                "INSERT INTO %(key)s"
422	                " (event_id, room_id, %(key)s)"
423	                " VALUES (?, ?, ?)" % {"key": key}
424	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\delta\20\pushers.py:64:56
63	        row[11] = bytes(row[11]).decode("utf-8")
64	        cur.execute(database_engine.convert_param_style("""
65	            INSERT into pushers2 (
66	            id, user_name, access_token, profile_tag, kind,
67	            app_id, app_display_name, device_display_name,
68	            pushkey, ts, lang, data, last_token, last_success,
69	            failing_since
70	            ) values (%s)""" % (','.join(['?' for _ in range(len(row))]))),
71	            row

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\schema\delta\30\as_users.py:25:4
24	        cur.execute("ALTER TABLE users ADD COLUMN appservice_id TEXT")
25	    except Exception:
26	        # Maybe we already added the column? Hope so...
27	        pass
28	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\delta\30\as_users.py:65:20
64	                database_engine.convert_param_style(
65	                    "UPDATE users SET appservice_id = ? WHERE name IN (%s)" % (
66	                        ",".join("?" for _ in chunk),
67	                    )
68	                ),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\delta\31\pushers.py:63:56
62	        row[12] = token_to_stream_ordering(row[12])
63	        cur.execute(database_engine.convert_param_style("""
64	            INSERT into pushers2 (
65	            id, user_name, access_token, profile_tag, kind,
66	            app_id, app_display_name, device_display_name,
67	            pushkey, ts, lang, data, last_stream_ordering, last_success,
68	            failing_since
69	            ) values (%s)""" % (','.join(['?' for _ in range(len(row))]))),
70	            row

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\search.py:78:16
77	            sql = (
78	                "SELECT stream_ordering, event_id, room_id, type, json, "
79	                " origin_server_ts FROM events"
80	                " JOIN event_json USING (room_id, event_id)"
81	                " WHERE ? <= stream_ordering AND stream_ordering < ?"
82	                " AND (%s)"
83	                " ORDER BY stream_ordering DESC"
84	                " LIMIT ?"
85	            ) % (" OR ".join("type = '%s'" % (t,) for t in TYPES),)
86	
87	            txn.execute(sql, (target_min_stream_id, max_stream_id, batch_size))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\search.py:110:20
109	                        content = event_json["content"]
110	                    except Exception:
111	                        continue
112	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\state.py:297:24
296	                    txn.execute(
297	                        "SELECT type, state_key, event_id FROM state_groups_state"
298	                        " WHERE state_group = ? %s" % (where_clause,),
299	                        args

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'stream'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\stream.py:57:16
56	
57	_STREAM_TOKEN = "stream"
58	_TOPOLOGICAL_TOKEN = "topological"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'topological'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\stream.py:58:21
57	_STREAM_TOKEN = "stream"
58	_TOPOLOGICAL_TOKEN = "topological"
59	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\stream.py:250:20
249	                sql = (
250	                    "SELECT event_id, stream_ordering FROM events WHERE"
251	                    " room_id = ?"
252	                    " AND not outlier"
253	                    " AND stream_ordering > ? AND stream_ordering <= ?"
254	                    " ORDER BY stream_ordering %s LIMIT ?"
255	                ) % (order,)
256	                txn.execute(sql, (room_id, from_id, to_id, limit))
257	            else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\stream.py:259:20
258	                sql = (
259	                    "SELECT event_id, stream_ordering FROM events WHERE"
260	                    " room_id = ?"
261	                    " AND not outlier"
262	                    " AND stream_ordering <= ?"
263	                    " ORDER BY topological_ordering %s, stream_ordering %s LIMIT ?"
264	                ) % (order, order,)
265	                txn.execute(sql, (room_id, to_id, limit))
266	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\stream.py:633:16
632	            query_before = (
633	                "SELECT topological_ordering, stream_ordering, event_id FROM events"
634	                " WHERE room_id = ? AND %s"
635	                " ORDER BY topological_ordering DESC, stream_ordering DESC LIMIT ?"
636	            ) % (upper_bound(token, self.database_engine, inclusive=False),)
637	
638	            before_args = (room_id, before_limit)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\stream.py:641:16
640	            query_after = (
641	                "SELECT topological_ordering, stream_ordering, event_id FROM events"
642	                " WHERE room_id = ? AND %s"
643	                " ORDER BY topological_ordering ASC, stream_ordering ASC LIMIT ?"
644	            ) % (lower_bound(token, self.database_engine, inclusive=False),)
645	
646	            after_args = (room_id, after_limit)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\stream.py:785:12
784	        sql = (
785	            "SELECT * FROM events"
786	            " WHERE outlier = ? AND room_id = ? AND %(bounds)s"
787	            " ORDER BY topological_ordering %(order)s,"
788	            " stream_ordering %(order)s %(limit)s"
789	        ) % {
790	            "bounds": bounds,
791	            "order": order,
792	            "limit": limit_str
793	        }
794	
795	        def f(txn):

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\user_directory.py:669:18
668	            # search: (domain, _, display name, localpart)
669	            sql = """
670	                SELECT d.user_id AS user_id, display_name, avatar_url
671	                FROM user_directory_search
672	                INNER JOIN user_directory AS d USING (user_id)
673	                %s
674	                WHERE
675	                    %s
676	                    AND vector @@ to_tsquery('english', ?)
677	                ORDER BY
678	                    (CASE WHEN s.user_id IS NOT NULL THEN 4.0 ELSE 1.0 END)
679	                    * (CASE WHEN display_name IS NOT NULL THEN 1.2 ELSE 1.0 END)
680	                    * (CASE WHEN avatar_url IS NOT NULL THEN 1.2 ELSE 1.0 END)
681	                    * (
682	                        3 * ts_rank_cd(
683	                            '{0.1, 0.1, 0.9, 1.0}',
684	                            vector,
685	                            to_tsquery('english', ?),
686	                            8
687	                        )
688	                        + ts_rank_cd(
689	                            '{0.1, 0.1, 0.9, 1.0}',
690	                            vector,
691	                            to_tsquery('english', ?),
692	                            8
693	                        )
694	                    )
695	                    DESC,
696	                    display_name IS NULL,
697	                    avatar_url IS NULL
698	                LIMIT ?
699	            """ % (join_clause, where_clause)
700	            args = join_args + (full_query, exact_query, prefix_query, limit + 1,)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\user_directory.py:704:18
703	
704	            sql = """
705	                SELECT d.user_id AS user_id, display_name, avatar_url
706	                FROM user_directory_search
707	                INNER JOIN user_directory AS d USING (user_id)
708	                %s
709	                WHERE
710	                    %s
711	                    AND value MATCH ?
712	                ORDER BY
713	                    rank(matchinfo(user_directory_search)) DESC,
714	                    display_name IS NULL,
715	                    avatar_url IS NULL
716	                LIMIT ?
717	            """ % (join_clause, where_clause)
718	            args = join_args + (search_query, limit + 1)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:46:20
45	    if step == 1:
46	        cur.execute("SELECT MAX(%s) FROM %s" % (column, table,))
47	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:48:20
47	    else:
48	        cur.execute("SELECT MIN(%s) FROM %s" % (column, table,))
49	    val, = cur.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:81:8
80	    def __init__(self, db_conn, table, column, extra_tables=[], step=1):
81	        assert step != 0
82	        self._lock = threading.Lock()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:341:8
340	                return cls(topological=int(parts[0]), stream=int(parts[1]))
341	        except Exception:
342	            pass
343	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:350:8
349	                return cls(topological=None, stream=int(string[1:]))
350	        except Exception:
351	            pass
352	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\__init__.py:100:12
99	                ret_deferred.errback(e)
100	            except Exception:
101	                pass
102	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\__init__.py:105:12
104	                given_deferred.cancel()
105	            except Exception:
106	                pass
107	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\__init__.py:113:12
112	                self.cancel_call_later(timer)
113	            except Exception:
114	                pass
115	            return res

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\__init__.py:122:12
121	                ret_deferred.callback(res)
122	            except Exception:
123	                pass
124	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\__init__.py:130:12
129	                ret_deferred.errback(res)
130	            except Exception:
131	                pass
132	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async.py:76:16
75	                    self._observers.pop().callback(r)
76	                except Exception:
77	                    pass
78	            return r

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async.py:86:16
85	                    self._observers.pop().errback(f)
86	                except Exception:
87	                    pass
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:49:8
48	        """
49	        assert type(stream_pos) is int or type(stream_pos) is long
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:71:8
70	        """
71	        assert type(stream_pos) is int
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:91:8
90	        """
91	        assert type(stream_pos) is int
92	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:107:8
106	        """
107	        assert type(stream_pos) is int
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:121:8
120	        """
121	        assert type(stream_pos) is int
122	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\retryutils.py:185:43
184	                self.retry_interval *= self.multiplier_retry_interval
185	                self.retry_interval *= int(random.uniform(0.8, 1.4))
186	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\stringutils.py:25:19
24	def random_string(length):
25	    return ''.join(random.choice(string.ascii_letters) for _ in xrange(length))
26	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\stringutils.py:30:8
29	    return ''.join(
30	        random.choice(_string_with_symbols) for _ in xrange(length)
31	    )

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\util\versionstring.py:17:0
16	
17	import subprocess
18	import os

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:29:25
28	        try:
29	            git_branch = subprocess.check_output(
30	                ['git', 'rev-parse', '--abbrev-ref', 'HEAD'],
31	                stderr=null,
32	                cwd=cwd,
33	            ).strip()
34	            git_branch = "b=" + git_branch

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:29:25
28	        try:
29	            git_branch = subprocess.check_output(
30	                ['git', 'rev-parse', '--abbrev-ref', 'HEAD'],
31	                stderr=null,
32	                cwd=cwd,
33	            ).strip()
34	            git_branch = "b=" + git_branch

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:39:22
38	        try:
39	            git_tag = subprocess.check_output(
40	                ['git', 'describe', '--exact-match'],
41	                stderr=null,
42	                cwd=cwd,
43	            ).strip()
44	            git_tag = "t=" + git_tag

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:39:22
38	        try:
39	            git_tag = subprocess.check_output(
40	                ['git', 'describe', '--exact-match'],
41	                stderr=null,
42	                cwd=cwd,
43	            ).strip()
44	            git_tag = "t=" + git_tag

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:49:25
48	        try:
49	            git_commit = subprocess.check_output(
50	                ['git', 'rev-parse', '--short', 'HEAD'],
51	                stderr=null,
52	                cwd=cwd,
53	            ).strip()
54	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:49:25
48	        try:
49	            git_commit = subprocess.check_output(
50	                ['git', 'rev-parse', '--short', 'HEAD'],
51	                stderr=null,
52	                cwd=cwd,
53	            ).strip()
54	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:59:23
58	            dirty_string = "-this_is_a_dirty_checkout"
59	            is_dirty = subprocess.check_output(
60	                ['git', 'describe', '--dirty=' + dirty_string],
61	                stderr=null,
62	                cwd=cwd,
63	            ).strip().endswith(dirty_string)
64	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:59:23
58	            dirty_string = "-this_is_a_dirty_checkout"
59	            is_dirty = subprocess.check_output(
60	                ['git', 'describe', '--dirty=' + dirty_string],
61	                stderr=null,
62	                cwd=cwd,
63	            ).strip().endswith(dirty_string)
64	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '_test_token_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\api\test_auth.py:46:26
45	        self.test_user = "@foo:bar"
46	        self.test_token = "_test_token_"
47	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:89:22
88	    def test_get_user_by_req_appservice_valid_token(self):
89	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
90	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:110:22
109	    def test_get_user_by_req_appservice_missing_token(self):
110	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
111	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:122:22
121	        masquerading_user_id = "@doppelganger:matrix.org"
122	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
123	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:136:22
135	        masquerading_user_id = "@doppelganger:matrix.org"
136	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
137	        app_service.is_interested_in_user = Mock(return_value=False)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\appservice\test_appservice.py:35:23
34	    def setUp(self):
35	        self.service = ApplicationService(
36	            id="unique_identifier",
37	            url="some_url",
38	            token="some_token",
39	            hostname="matrix.org",  # only used by get_groups_for_user
40	            namespaces={
41	                ApplicationService.NS_USERS: [],
42	                ApplicationService.NS_ROOMS: [],
43	                ApplicationService.NS_ALIASES: []
44	            }
45	        )
46	        self.event = Mock(

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\tests\config\test_load.py:45:18
44	                  "r") as f:
45	            raw = yaml.load(f)
46	        self.assertIn("macaroon_secret_key", raw)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:150:24
149	        service.is_interested = Mock(return_value=is_interested)
150	        service.token = "mock_service_token"
151	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:157:24
156	        service.is_interested_in_alias = Mock(return_value=is_interested_in_alias)
157	        service.token = "mock_service_token"
158	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'jkv;g498752-43gj['eamb!-5'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\handlers\test_register.py:67:14
66	        frank = UserID.from_string("@frank:test")
67	        yield store.register(
68	            user_id=frank.to_string(),
69	            token="jkv;g498752-43gj['eamb!-5",
70	            password_hash=None)
71	        local_part = "frank"

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\tests\replication\slave\storage\_base.py:47:15
46	        # XXX: mktemp is unsafe and should never be used. but we're just a test.
47	        path = tempfile.mktemp(prefix="base_slaved_store_test_case_socket")
48	        listener = reactor.listenUNIX(path, server_factory)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'my token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_register.py:56:16
55	        user_id = "@someone:interesting"
56	        token = "my token"
57	        self.request.args = {

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 't1-0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1032:16
1031	    def test_topo_token_is_accepted(self):
1032	        token = "t1-0_0_0_0_0_0_0_0_0"
1033	        (code, response) = yield self.mock_resource.trigger_get(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1044:16
1043	    def test_stream_token_is_accepted_for_fwd_pagianation(self):
1044	        token = "s0_0_0_0_0_0_0_0_0"
1045	        (code, response) = yield self.mock_resource.trigger_get(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kermits_access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:61:16
60	        user_id = "@kermit:muppet"
61	        token = "kermits_access_token"
62	        self.request.args = {

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kermits_access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:119:16
118	        user_id = "@kermit:muppet"
119	        token = "kermits_access_token"
120	        device_id = "frogfone"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\storage\test_appservice.py:48:24
47	
48	        self.as_token = "token1"
49	        self.as_url = "some_url"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\storage\test_appservice.py:68:12
67	                os.remove(f)
68	            except Exception:
69	                pass
70	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'something'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:156:18
155	    def _add_service(self, url, as_token, id):
156	        as_yaml = dict(url=url, as_token=as_token, hs_token="something",
157	                       id=id, sender_localpart="a_sender", namespaces={})
158	        # use the token as the filename

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:489:13
488	    def test_duplicate_as_tokens(self):
489	        f1 = self._write_config(as_token="as_token", suffix="1")
490	        f2 = self._write_config(as_token="as_token", suffix="2")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:490:13
489	        f1 = self._write_config(as_token="as_token", suffix="1")
490	        f2 = self._write_config(as_token="as_token", suffix="2")
491	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'not even a little secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\utils.py:51:37
50	        config.enable_registration = True
51	        config.macaroon_secret_key = "not even a little secret"
52	        config.expire_access_token = False

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:138:43
137	    # beforehand and pass it in to the HS's constructor (chicken / egg)
138	    hs.get_auth_handler().hash = lambda p: hashlib.md5(p).hexdigest()
139	    hs.get_auth_handler().validate_hash = lambda p, h: hashlib.md5(p).hexdigest() == h

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:139:55
138	    hs.get_auth_handler().hash = lambda p: hashlib.md5(p).hexdigest()
139	    hs.get_auth_handler().validate_hash = lambda p, h: hashlib.md5(p).hexdigest() == h
140	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\utils.py:230:8
229	            path = mock_request.path
230	        except Exception:
231	            pass
232	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\utils.py:273:8
272	    def verify(self, message, sig):
273	        assert sig == b"\x9a\x87$"
274	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\utils.py:384:12
383	                d.errback(failure)
384	            except Exception:
385	                pass
386	

--------------------------------------------------

Code scanned:
	Total lines of code: 71718
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 110
		Medium: 53
		High: 3
	Total issues (by confidence):
		Undefined: 0
		Low: 35
		Medium: 45
		High: 86
Files skipped (57):
	.\contrib\cmdclient\console.py (syntax error while parsing AST from file)
	.\contrib\cmdclient\http.py (syntax error while parsing AST from file)
	.\contrib\graph\graph.py (syntax error while parsing AST from file)
	.\contrib\graph\graph3.py (syntax error while parsing AST from file)
	.\contrib\jitsimeetbridge\jitsimeetbridge.py (syntax error while parsing AST from file)
	.\contrib\scripts\kick_users.py (syntax error while parsing AST from file)
	.\scripts-dev\check_auth.py (syntax error while parsing AST from file)
	.\scripts-dev\check_event_hash.py (syntax error while parsing AST from file)
	.\scripts-dev\check_signature.py (syntax error while parsing AST from file)
	.\scripts-dev\definitions.py (syntax error while parsing AST from file)
	.\scripts-dev\dump_macaroon.py (syntax error while parsing AST from file)
	.\scripts-dev\hash_history.py (syntax error while parsing AST from file)
	.\synapse\app\federation_sender.py (syntax error while parsing AST from file)
	.\synapse\federation\federation_server.py (syntax error while parsing AST from file)
	.\synapse\federation\transaction_queue.py (syntax error while parsing AST from file)
	.\synapse\handlers\auth.py (syntax error while parsing AST from file)
	.\synapse\handlers\device.py (syntax error while parsing AST from file)
	.\synapse\handlers\federation.py (syntax error while parsing AST from file)
	.\synapse\handlers\identity.py (syntax error while parsing AST from file)
	.\synapse\handlers\initial_sync.py (syntax error while parsing AST from file)
	.\synapse\handlers\message.py (syntax error while parsing AST from file)
	.\synapse\handlers\presence.py (syntax error while parsing AST from file)
	.\synapse\handlers\read_marker.py (syntax error while parsing AST from file)
	.\synapse\handlers\register.py (syntax error while parsing AST from file)
	.\synapse\handlers\room_list.py (syntax error while parsing AST from file)
	.\synapse\handlers\room_member.py (syntax error while parsing AST from file)
	.\synapse\handlers\sync.py (syntax error while parsing AST from file)
	.\synapse\handlers\user_directory.py (syntax error while parsing AST from file)
	.\synapse\http\matrixfederationclient.py (syntax error while parsing AST from file)
	.\synapse\notifier.py (syntax error while parsing AST from file)
	.\synapse\push\bulk_push_rule_evaluator.py (syntax error while parsing AST from file)
	.\synapse\push\mailer.py (syntax error while parsing AST from file)
	.\synapse\push\pusherpool.py (syntax error while parsing AST from file)
	.\synapse\replication\http\send_event.py (syntax error while parsing AST from file)
	.\synapse\rest\client\transactions.py (syntax error while parsing AST from file)
	.\synapse\rest\client\v1\register.py (syntax error while parsing AST from file)
	.\synapse\rest\client\v2_alpha\account.py (syntax error while parsing AST from file)
	.\synapse\rest\client\v2_alpha\register.py (syntax error while parsing AST from file)
	.\synapse\rest\media\v1\media_repository.py (syntax error while parsing AST from file)
	.\synapse\rest\media\v1\preview_url_resource.py (syntax error while parsing AST from file)
	.\synapse\state.py (syntax error while parsing AST from file)
	.\synapse\storage\background_updates.py (syntax error while parsing AST from file)
	.\synapse\storage\event_push_actions.py (syntax error while parsing AST from file)
	.\synapse\storage\events.py (syntax error while parsing AST from file)
	.\synapse\storage\roommember.py (syntax error while parsing AST from file)
	.\synapse\util\caches\descriptors.py (syntax error while parsing AST from file)
	.\synapse\util\caches\response_cache.py (syntax error while parsing AST from file)
	.\synapse\util\caches\snapshot_cache.py (syntax error while parsing AST from file)
	.\synapse\util\ratelimitutils.py (syntax error while parsing AST from file)
	.\tests\crypto\test_keyring.py (syntax error while parsing AST from file)
	.\tests\storage\test__base.py (syntax error while parsing AST from file)
	.\tests\test_distributor.py (syntax error while parsing AST from file)
	.\tests\util\caches\test_descriptors.py (syntax error while parsing AST from file)
	.\tests\util\test_limiter.py (syntax error while parsing AST from file)
	.\tests\util\test_linearizer.py (syntax error while parsing AST from file)
	.\tests\util\test_logcontext.py (syntax error while parsing AST from file)
	.\tests\util\test_rwlock.py (syntax error while parsing AST from file)
