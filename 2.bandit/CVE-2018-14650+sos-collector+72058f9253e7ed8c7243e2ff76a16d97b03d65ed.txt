Run started:2024-02-10 21:12:18.158984

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\soscollector\clusters\__init__.py:17:0
16	import logging
17	import subprocess
18	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\soscollector\clusters\ovirt.py:44:23
43	        self.dbcmd = '/usr/share/ovirt-engine/dbscripts/engine-psql.sh -c \"'
44	        self.dbcmd += ("select host_name from vds_static where cluster_id in "
45	                       "(select cluster_id from cluster where name like \'%s\'"
46	                       " and storage_pool_id in (select id from storage_pool "
47	                       "where name like \'%s\'))\"" % (cluster, datacenter))
48	        self.log_debug('Query command for ovirt DB set to: %s' % self.dbcmd)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\soscollector\configuration.py:42:26
41	        self['tmp_dir'] = None
42	        self['out_dir'] = '/var/tmp/'
43	        self['nodes'] = None

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\soscollector\configuration.py:69:13
68	        self['become_root'] = False
69	        self['root_password'] = ''
70	        self['threads'] = 4

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\soscollector\sos_collector.py:27:0
26	import shutil
27	import subprocess
28	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\soscollector\sos_collector.py:108:8
107	            self.close_all_connections()
108	        except Exception:
109	            pass
110	        sys.exit(error)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\soscollector\sos_collector.py:173:63
172	        '''Creates a temp directory to transfer sosreports to'''
173	        tmpdir = tempfile.mkdtemp(prefix='sos-collector-', dir='/var/tmp')
174	        self.config['tmp_dir'] = tmpdir

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\soscollector\sos_collector.py:240:23
239	
240	        rand = ''.join(random.choice(string.lowercase) for x in range(5))
241	        return '%s-%s-%s' % (nstr, dt, rand)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\soscollector\sos_collector.py:526:8
525	                client.close_ssh_session()
526	        except Exception:
527	            pass
528	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\soscollector\sosnode.py:23:0
22	import socket
23	import subprocess
24	import six

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\soscollector\sosnode.py:29:0
28	from distutils.version import LooseVersion
29	from subprocess import Popen, PIPE
30	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\soscollector\sosnode.py:203:20
202	                        res.append(line.split()[0])
203	                    except Exception:
204	                        pass
205	                else:

--------------------------------------------------
>> Issue: [B601:paramiko_calls] Possible shell injection via Paramiko call, check inputs are properly sanitized.
   Severity: Medium   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b601_paramiko_calls.html
   Location: .\soscollector\sosnode.py:238:30
237	            now = time.time()
238	            sin, sout, serr = self.client.exec_command(cmd, timeout=timeout,
239	                                                       get_pty=get_pty)
240	            while time.time() < now + timeout:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\soscollector\sosnode.py:257:19
256	        else:
257	            proc = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE)
258	            stdout, stderr = proc.communicate()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\soscollector\sosnode.py:282:8
281	                self.retrieved = self.retrieve_sosreport()
282	        except Exception:
283	            pass
284	        self.cleanup()

--------------------------------------------------
>> Issue: [B507:ssh_no_host_key_verification] Paramiko call with policy set to automatically trust the unknown host key.
   Severity: High   Confidence: Medium
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b507_ssh_no_host_key_verification.html
   Location: .\soscollector\sosnode.py:291:12
290	            self.client = paramiko.SSHClient()
291	            self.client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
292	            self.client.load_system_host_keys()

--------------------------------------------------
>> Issue: [B601:paramiko_calls] Possible shell injection via Paramiko call, check inputs are properly sanitized.
   Severity: Medium   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b601_paramiko_calls.html
   Location: .\soscollector\sosnode.py:629:30
628	        if cleanup:
629	            sin, sout, serr = self.client.exec_command(cleanup, timeout=15)
630	

--------------------------------------------------

Code scanned:
	Total lines of code: 1675
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 10
		Medium: 5
		High: 2
	Total issues (by confidence):
		Undefined: 0
		Low: 1
		Medium: 6
		High: 10
Files skipped (0):
