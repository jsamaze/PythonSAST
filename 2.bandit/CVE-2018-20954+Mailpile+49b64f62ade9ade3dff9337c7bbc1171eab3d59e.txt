Working... ---------------------------------------- 100% 0:00:02
Run started:2024-02-10 21:17:22.672002

Test results:
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'this probably does not really overwrite :-( '
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\mailpile\auth.py:43:21
42	        sps = SecurePassphraseStorage(passphrase)
43	        passphrase = 'this probably does not really overwrite :-( '
44	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\mailpile\crypto\tor.py:3:0
2	import socket
3	import subprocess
4	import threading

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\mailpile\crypto\tor.py:30:0
29	# Version check for STEM >= 1.4
30	assert(int(stem.__version__[0]) > 1 or
31	       (int(stem.__version__[0]) == 1 and int(stem.__version__[2]) >= 4))
32	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\mailpile\crypto\tor.py:142:8
141	            self.tor_process.wait()
142	        except:
143	            pass
144	        finally:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\mailpile\crypto\tor.py:152:21
151	        try:
152	            hasher = subprocess.Popen(
153	                [self.tor_binary, '--hush', '--hash-password',
154	                str(self.control_password)],
155	                stdout=subprocess.PIPE, bufsize=1)
156	            hasher.wait()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\mailpile\crypto\tor.py:214:20
213	                        t.tor_controller.remove_ephemeral_hidden_service(onion)
214	                    except:
215	                        pass
216	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\mailpile\crypto\tor.py:221:12
220	                    self.tor_process.wait()
221	            except:
222	                pass
223	            Tor._instance = None

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\mail_source\__init__.py:269:20
268	        event_plan = dict((mp[0], mp) for mp in self.event.data['plan'])
269	        if plan and random.randint(0, 10) == 1:
270	            random_plan = [m._key for m in random.sample(plan, 1)]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\mail_source\__init__.py:388:25
387	    def _jitter(self, seconds):
388	        return seconds + random.randint(0, self.jitter)
389	

--------------------------------------------------
>> Issue: [B504:ssl_with_no_version] ssl.wrap_socket call with no SSL/TLS protocol version specified, the default SSLv23 could be insecure, possible security issue.
   Severity: Low   Confidence: Medium
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b504_ssl_with_no_version.html
   Location: .\mailpile\mail_source\imap_starttls.py:30:20
29	            raise self.error('no STARTTLS')
30	        self.sock = ssl.wrap_socket(self.sock, keyfile, certfile)
31	        self.file = self.sock.makefile('rb')

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\mailpile\mailboxes\__init__.py:45:8
44	            raise
45	        except:
46	            pass
47	    return False

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\mailpile\mailboxes\__init__.py:56:8
55	            raise
56	        except:
57	            pass
58	    raise ValueError('Not a mailbox: %s' % fn)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\mailutils\generator.py:431:12
430	    # boundary doesn't appear in the text.
431	    token = random.randrange(sys.maxint)
432	    boundary = ('=' * 15) + (_fmt % token) + '=='

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\mailpile\plugins\contacts.py:858:63
857	            elif protocol == 'local':
858	                route.password = route.username = route.host = ''
859	                route.name = _("Local mail")

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\plugins\smtp_server.py:71:29
70	    def _challenge(self):
71	        return '-'.join([str(random.randint(0, 0xfffffff)),
72	                         str(random.randint(0, 0xfffffff)),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\plugins\smtp_server.py:72:29
71	        return '-'.join([str(random.randint(0, 0xfffffff)),
72	                         str(random.randint(0, 0xfffffff)),
73	                         str(random.randint(0, 0xfffffff))])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\plugins\smtp_server.py:73:29
72	                         str(random.randint(0, 0xfffffff)),
73	                         str(random.randint(0, 0xfffffff))])
74	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\mailpile\plugins\vcard_carddav.py:7:0
6	import getopt
7	from lxml import etree
8	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\mailpile\plugins\vcard_carddav.py:107:13
106	        stat, msg, hdr, resbody = self.request(self.url, "PROPFIND", {}, {})
107	        tr = etree.fromstring(resbody)
108	        urls = [x.text for x in tr.xpath("/d:multistatus/d:response/d:href",

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\plugins\vcard_gravatar.py:53:33
52	            # be checked at roughly the same time.
53	            return time.time() + random.randrange(-14400, 3600)
54	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\plugins\vcard_libravatar.py:52:33
51	            # same time.
52	            return time.time() + random.randrange(-14400, 3600)
53	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\postinglist.py:409:28
408	                    if (os.path.getsize(fn_path) > max_size and
409	                            random.randint(0, 50) == 1):
410	                        break

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\postinglist.py:602:24
601	                keyn = int(len(keys) * ratio)
602	                start = random.randint(0, len(keys))
603	                # This lets the selection wrap around to the beginning,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\smtp_client.py:146:30
145	    # should get sent.
146	    routes.sort(key=lambda k: random.randint(0, 10))
147	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\tests\__init__.py:56:27
55	    mailpile.util.TESTING = True
56	    config.sys.http_port = random.randint(33500, 34000)
57	#   config.sys.debug = 'log'

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mailpile\www\jinjaextensions.py:719:24
718	    def _random(self, sequence):
719	        return sequence[random.randint(0, len(sequence)-1)]
720	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\scripts\build-desktop.py:9:0
8	import os
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\packages\scripts\build-desktop.py:27:18
26	    def communicate(self):
27	        process = subprocess.Popen(
28	            self.command,
29	            env=self.env,
30	            stdout=subprocess.PIPE,
31	            stderr=subprocess.PIPE)
32	        stdout, stderr = process.communicate()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\scripts\kite-runner.py:11:0
10	import sys
11	import subprocess
12	import threading

--------------------------------------------------
>> Issue: [B411:blacklist] Using xmlrpc.server to parse untrusted XML data is known to be vulnerable to XML attacks. Use defusedxml.xmlrpc.monkey_patch() function to monkey-patch xmlrpclib and mitigate XML vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b411-import-xmlrpclib
   Location: .\packages\scripts\kite-runner.py:18:4
17	except ImportError:
18	    import xmlrpc.server as SimpleXMLRPCServer  # Python 3.x
19	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\packages\scripts\kite-runner.py:76:31
75	                    print('Launching: %s' % command)
76	                    self.kid = subprocess.Popen(
77	                        [c for c in command.split() if c],
78	                        stdout=subprocess.PIPE,
79	                        stderr=subprocess.PIPE,
80	                        bufsize=0)
81	                    OutputEater(self.kid.stdout, self._handle_logline).start()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\packages\scripts\kite-runner.py:161:22
160	            elif self.script_running is None:
161	                kid = subprocess.Popen(
162	                    [self.server.shell_binary, '-c', self.scripts[name]],
163	                    stdout=subprocess.PIPE,
164	                    stderr=subprocess.PIPE,
165	                    bufsize=0)
166	                sdata = [kid, name, time.time(), [], [], 0, 0]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\packages\scripts\kite-runner.py:207:31
206	        self.pagekite_kite = ''
207	        self.pagekite_secret = ''
208	        self.pagekite_args = None

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\windows-wix\bin\with-mailpile-env.py:12:0
11	import sys
12	import subprocess
13	import argparse

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\packages\windows-wix\bin\with-mailpile-env.py:100:8
99	    try:
100	        subprocess.check_call( invoke, shell = True, **redirects )
101	    finally:

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\packages\windows-wix\package.py:17:0
16	
17	import xml.etree.ElementTree as ET
18	from xml.dom import minidom

--------------------------------------------------
>> Issue: [B408:blacklist] Using minidom to parse untrusted XML data is known to be vulnerable to XML attacks. Replace minidom with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b408-import-xml-minidom
   Location: .\packages\windows-wix\package.py:18:0
17	import xml.etree.ElementTree as ET
18	from xml.dom import minidom
19	import os

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\windows-wix\package.py:35:0
34	import argparse
35	import subprocess
36	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\packages\windows-wix\package.py:431:27
430	        #    attempt = use + '_' + hashlib.sha1( name ).hexdigest()
431	        return use + '_' + hashlib.sha1( name.encode() ).hexdigest()
432	

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\packages\windows-wix\package.py:521:19
520	        dense = ET.tostring( self.root, encoding='utf-8' )
521	        reparsed = minidom.parseString( dense )
522	        pretty = reparsed.toprettyxml( indent = ' ' * indent, encoding = 'utf-8' ) 

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\windows-wix\package.py:564:4
563	
564	    import subprocess
565	    import shlex

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\packages\windows-wix\package.py:568:4
567	    logger.info( "build step '{}'".format( cmd ) )
568	    subprocess.check_call( cmd )
569	    cmd = shlex.split( args.light.format( "mailpile.wixobj" ).replace( '\\', '\\\\' ) )

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\packages\windows-wix\package.py:571:4
570	    logger.info( "build step '{}'".format( cmd ) )
571	    subprocess.check_call( cmd )
572	    '''candle mailpile.wxs'''

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\windows-wix\provide\build.py:1:0
1	import subprocess
2	import os.path
3	import tempfile

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\packages\windows-wix\provide\build.py:246:16
245	                    value = json.loads(value)
246	                except:
247	                    pass
248	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\packages\windows-wix\provide\cache.py:49:25
48	            try:
49	                source = urllib2.urlopen(url, context=context)
50	            except urllib2.URLError as e:

--------------------------------------------------
>> Issue: [B323:blacklist] By default, Python will create a secure, verified ssl context for use in such classes as HTTPSConnection. However, it still allows using an insecure context via the _create_unverified_context that  reverts to the previous behavior that does not validate certificates or perform hostname checks.
   Severity: Medium   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b323-unverified-context
   Location: .\packages\windows-wix\provide\cache.py:54:30
53	                        "Cannot verify ssl cert for '{}', delegating authenticity to digest...".format(url))
54	                    context = ssl._create_unverified_context()
55	                    source = urllib2.urlopen(url, context=context)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\packages\windows-wix\provide\cache.py:55:29
54	                    context = ssl._create_unverified_context()
55	                    source = urllib2.urlopen(url, context=context)
56	                else:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\packages\windows-wix\provide\cache.py:65:15
64	    def sha1_handle(cls, handle, **kwargs):
65	        algo = hashlib.sha1()
66	        cls.chunk_stream(handle.read, algo.update, **kwargs)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\windows-wix\provide\scripts\extract_msi.py:11:0
10	
11	import subprocess
12	import logging

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\packages\windows-wix\provide\scripts\extract_msi.py:44:12
43	            si.dwFlags |= subprocess.STARTF_USESHOWWINDOW
44	            subprocess.check_call(args, startupinfo=si)
45	            sub_dirs = os.listdir(temp_dir)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\packages\windows-wix\provide\scripts\python27.py:3:0
2	import glob
3	import subprocess
4	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\packages\windows-wix\provide\scripts\sign_tree.py:64:16
63	                build.log().debug("Scanning '{}' for signable files...".format(path))
64	                assert(os.path.exists(path))
65	                for root, dirs, files in os.walk(path):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\scripts\mailpile-decrypt.py:36:0
35	    outpath = sys.argv[-1]
36	except:
37	    pass
38	if ((not infiles or not outpath) or

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\shared-data\contrib\hacks\hacks.py:215:8
214	        method = method.upper()
215	        assert(method in ('GET', 'POST'))
216	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '***************************'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\shared-data\contrib\sms\twilio_sms.py:4:8
3	account = "AC######################"
4	token = "***************************"
5	client = TwilioRestClient(account, token)

--------------------------------------------------

Code scanned:
	Total lines of code: 43276
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 47
		Medium: 5
		High: 4
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 5
		High: 51
Files skipped (71):
	.\mailpile\app.py (syntax error while parsing AST from file)
	.\mailpile\commands.py (syntax error while parsing AST from file)
	.\mailpile\config\base.py (syntax error while parsing AST from file)
	.\mailpile\config\defaults.py (syntax error while parsing AST from file)
	.\mailpile\config\manager.py (syntax error while parsing AST from file)
	.\mailpile\config\paths.py (syntax error while parsing AST from file)
	.\mailpile\config\validators.py (syntax error while parsing AST from file)
	.\mailpile\conn_brokers.py (syntax error while parsing AST from file)
	.\mailpile\crypto\aes_utils.py (syntax error while parsing AST from file)
	.\mailpile\crypto\gpgi.py (syntax error while parsing AST from file)
	.\mailpile\crypto\mime.py (syntax error while parsing AST from file)
	.\mailpile\crypto\records.py (syntax error while parsing AST from file)
	.\mailpile\crypto\state.py (syntax error while parsing AST from file)
	.\mailpile\crypto\streamer.py (syntax error while parsing AST from file)
	.\mailpile\eventlog.py (syntax error while parsing AST from file)
	.\mailpile\httpd.py (syntax error while parsing AST from file)
	.\mailpile\index\base.py (syntax error while parsing AST from file)
	.\mailpile\index\mailboxes.py (syntax error while parsing AST from file)
	.\mailpile\index\msginfo.py (syntax error while parsing AST from file)
	.\mailpile\index\search.py (syntax error while parsing AST from file)
	.\mailpile\mail_source\imap.py (syntax error while parsing AST from file)
	.\mailpile\mailboxes\macmail.py (syntax error while parsing AST from file)
	.\mailpile\mailboxes\mbox.py (syntax error while parsing AST from file)
	.\mailpile\mailboxes\pop3.py (syntax error while parsing AST from file)
	.\mailpile\mailboxes\wervd.py (syntax error while parsing AST from file)
	.\mailpile\mailutils\addresses.py (syntax error while parsing AST from file)
	.\mailpile\mailutils\emails.py (syntax error while parsing AST from file)
	.\mailpile\mailutils\header.py (syntax error while parsing AST from file)
	.\mailpile\mailutils\headerprint.py (syntax error while parsing AST from file)
	.\mailpile\mailutils\html.py (syntax error while parsing AST from file)
	.\mailpile\mailutils\safe.py (syntax error while parsing AST from file)
	.\mailpile\packing.py (syntax error while parsing AST from file)
	.\mailpile\platforms.py (syntax error while parsing AST from file)
	.\mailpile\plugins\__init__.py (syntax error while parsing AST from file)
	.\mailpile\plugins\backups.py (syntax error while parsing AST from file)
	.\mailpile\plugins\compose.py (syntax error while parsing AST from file)
	.\mailpile\plugins\core.py (syntax error while parsing AST from file)
	.\mailpile\plugins\crypto_gnupg.py (syntax error while parsing AST from file)
	.\mailpile\plugins\cryptostate.py (syntax error while parsing AST from file)
	.\mailpile\plugins\html_magic.py (syntax error while parsing AST from file)
	.\mailpile\plugins\keylookup\nicknym.py (syntax error while parsing AST from file)
	.\mailpile\plugins\oauth.py (syntax error while parsing AST from file)
	.\mailpile\plugins\plugins.py (syntax error while parsing AST from file)
	.\mailpile\plugins\search.py (syntax error while parsing AST from file)
	.\mailpile\plugins\setup_magic.py (syntax error while parsing AST from file)
	.\mailpile\plugins\vcard_mork.py (syntax error while parsing AST from file)
	.\mailpile\plugins\webterminal.py (syntax error while parsing AST from file)
	.\mailpile\safe_popen.py (syntax error while parsing AST from file)
	.\mailpile\search.py (syntax error while parsing AST from file)
	.\mailpile\security.py (syntax error while parsing AST from file)
	.\mailpile\tests\data\pgp-data\buildexamples.py (syntax error while parsing AST from file)
	.\mailpile\tests\test_crypto_policy.py (syntax error while parsing AST from file)
	.\mailpile\tests\test_keylookup.py (syntax error while parsing AST from file)
	.\mailpile\tests\test_mail_generator.py (exception while scanning file)
	.\mailpile\tests\test_search.py (syntax error while parsing AST from file)
	.\mailpile\ui.py (syntax error while parsing AST from file)
	.\mailpile\urlmap.py (syntax error while parsing AST from file)
	.\mailpile\util.py (syntax error while parsing AST from file)
	.\mailpile\vcard.py (syntax error while parsing AST from file)
	.\mailpile\workers.py (syntax error while parsing AST from file)
	.\scripts\colorprints.py (syntax error while parsing AST from file)
	.\scripts\create-debian-changelog.py (syntax error while parsing AST from file)
	.\scripts\email-parsing-test.py (syntax error while parsing AST from file)
	.\scripts\mailpile-test.py (syntax error while parsing AST from file)
	.\scripts\mbox-minimal.py (syntax error while parsing AST from file)
	.\scripts\mk-credits.py (syntax error while parsing AST from file)
	.\scripts\unsent-mail-finder.py (syntax error while parsing AST from file)
	.\scripts\version.py (syntax error while parsing AST from file)
	.\setup.py (syntax error while parsing AST from file)
	.\shared-data\mailpile-gui\mailpile-gui.py (syntax error while parsing AST from file)
	.\shared-data\multipile\mailpile-admin.py (syntax error while parsing AST from file)
