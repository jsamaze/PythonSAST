Run started:2024-02-10 21:18:08.957502

Test results:
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\postgraas_server\backends\postgres_cluster\postgres_cluster_driver.py:22:24
21	        with con.cursor() as cur:
22	            cur.execute("SELECT 1 FROM pg_database WHERE datname='{}';".format(db_name))
23	            db_exists = cur.fetchone() is not None

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\postgraas_server\backends\postgres_cluster\postgres_cluster_driver.py:24:24
23	            db_exists = cur.fetchone() is not None
24	            cur.execute("SELECT 1 FROM pg_roles WHERE rolname='{}';".format(db_user))
25	            user = cur.fetchone()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\postgraas_server\management_resources.py:150:19
149	
150	        db_entry = DBInstance(
151	            postgraas_instance_name=args['postgraas_instance_name'],
152	            db_name=args['db_name'],
153	            username=db_credentials['db_username'],
154	            password="",
155	            hostname=db_credentials['host'],
156	            port=db_credentials['port']
157	        )
158	        if current_app.postgraas_backend.exists(db_entry):

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\postgraas_server\prometheus_app.py:107:21
106	        app.register_blueprint(blueprint)
107	        app.run(host='0.0.0.0', port=port, threaded=True)
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:119:8
118	        exists = pgcd.check_db_or_user_exists(db_credentials['db_name'], db_credentials['db_username'], backend_config)
119	        assert exists is False
120	        pgcd.create_postgres_db(db_credentials, backend_config)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:122:8
121	        exists = pgcd.check_db_or_user_exists(db_credentials['db_name'], db_credentials['db_username'], backend_config)
122	        assert exists is True
123	        response = self.app_client.post('/api/v2/postgraas_instances',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:128:8
127	        print(response.get_data(as_text=True))
128	        assert ("database or user already exists" in json.loads(response.get_data(as_text=True))['description']) is True
129	        delete_test_database_and_user(db_credentials['db_name'], db_credentials['db_username'], backend_config)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:134:8
133	        print(response.get_data(as_text=True))
134	        assert ("test_delete_db_and_users" in json.loads(response.get_data(as_text=True))['db_name']) is True
135	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:149:8
148	        exists = pgcd.check_db_or_user_exists(db_credentials['db_name'], db_credentials['db_username'], backend_config)
149	        assert exists is False
150	        print(db_credentials)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:153:8
152	        exists = pgcd.check_db_or_user_exists(db_credentials['db_name'], db_credentials['db_username'], backend_config)
153	        assert exists is True
154	        response = self.app_client.post('/api/v2/postgraas_instances',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:158:8
157	        delete_test_database_and_user(db_credentials['db_name'], db_credentials['db_username'], backend_config)
158	        assert ("database or user already exists" in json.loads(response.get_data(as_text=True))['description']) is True
159	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:180:8
179	        exists = pgcd.check_db_or_user_exists(db_credentials['db_name'], db_credentials['db_username'], backend_config)
180	        assert exists is False
181	        print(db_credentials)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:184:8
183	        exists = pgcd.check_db_or_user_exists(db_credentials['db_name'], db_credentials['db_username'], backend_config)
184	        assert exists is True
185	        with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:194:8
193	                                      backend_config)
194	        assert ("database or user already exists" in json.loads(response.get_data(as_text=True))['description']) is True
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\backends\postgres_cluster\test_postgres_cluster_driver.py:211:8
210	        delete_test_database_and_user(db_credentials['db_name'], db_credentials['db_username'], backend_config)
211	        assert ('syntax error at or near "-"' in json.loads(response.get_data(as_text=True))['msg']) is True

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\test_integration\test_backend_behaviour.py:112:4
111	        yield
112	    except Exception:
113	        pass
114	    if request.param == 'docker':

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\test_integration\test_backend_behaviour.py:132:19
131	        }
132	        db_entry = DBInstance(
133	            postgraas_instance_name=db_credentials['db_name'],
134	            db_name=db_credentials['db_name'],
135	            username=db_credentials['db_username'],
136	            password="",
137	            hostname=db_credentials['host'],
138	            port=db_credentials['port']
139	        )
140	        db_entry.container_id = self.this_app.postgraas_backend.create(db_entry, db_credentials)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_backend_behaviour.py:142:8
141	        self.this_app.postgraas_backend.delete(db_entry)
142	        assert True
143	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\test_integration\test_backend_behaviour.py:152:19
151	        }
152	        db_entry = DBInstance(
153	            postgraas_instance_name=db_credentials['db_name'],
154	            db_name=db_credentials['db_name'],
155	            username=db_credentials['db_username'],
156	            password="",
157	            hostname=db_credentials['host'],
158	            port=db_credentials['port']
159	        )
160	        db_entry.container_id = self.this_app.postgraas_backend.create(db_entry, db_credentials)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_backend_behaviour.py:164:12
163	        if self.backend == "pg_cluster":
164	            assert excinfo.value.message == 'db or user already exists'
165	        elif self.backend == "docker":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_backend_behaviour.py:166:12
165	        elif self.backend == "docker":
166	            assert excinfo.value.message == 'Container exists already'
167	        self.this_app.postgraas_backend.delete(db_entry)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_backend_behaviour.py:168:8
167	        self.this_app.postgraas_backend.delete(db_entry)
168	        assert True
169	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\test_integration\test_backend_behaviour.py:178:19
177	        }
178	        db_entry = DBInstance(
179	            postgraas_instance_name=db_credentials['db_name'],
180	            db_name=db_credentials['db_name'],
181	            username=db_credentials['db_username'],
182	            password="",
183	            hostname=db_credentials['host'],
184	            port=db_credentials['port']
185	        )
186	        if self.backend == "pg_cluster":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_backend_behaviour.py:190:12
189	                self.this_app.postgraas_backend.delete(db_entry)
190	            assert 'syntax error at or near "-"' in excinfo.value.message
191	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\test_integration\test_backend_behaviour.py:200:19
199	        }
200	        db_entry = DBInstance(
201	            postgraas_instance_name=db_credentials['db_name'],
202	            db_name=db_credentials['db_name'],
203	            username=db_credentials['db_username'],
204	            password="",
205	            hostname=db_credentials['host'],
206	            port=db_credentials['port'],
207	            container_id="4n8nz48az49prdmdmprmr4doesnotexit"
208	
209	        )
210	        with pytest.raises(PostgraasApiException) as excinfo:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_backend_behaviour.py:212:8
211	            db_entry.container_id = self.this_app.postgraas_backend.delete(db_entry)
212	        assert 'does not exist' in excinfo.value.message

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\test_integration\test_create_db.py:1:0
1	from subprocess import check_call
2	
3	import os

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\test_integration\test_create_db.py:18:4
17	    # * move the created .coverage files to ../.. so they are merged with the others
18	    check_call("rm -f .coverage.*", shell=True, cwd=this_dir)
19	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\tests\test_integration\test_create_db.py:18:4
17	    # * move the created .coverage files to ../.. so they are merged with the others
18	    check_call("rm -f .coverage.*", shell=True, cwd=this_dir)
19	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\tests\test_integration\test_create_db.py:22:8
21	        command = "coverage run --branch --source ../.. -p {}".format(script)
22	        check_call(command, cwd=this_dir, shell=True)
23	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\test_integration\test_create_db.py:25:4
24	    yield run
25	    check_call("mv .coverage.* ../..", shell=True, cwd=this_dir)
26	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\tests\test_integration\test_create_db.py:25:4
24	    yield run
25	    check_call("mv .coverage.* ../..", shell=True, cwd=this_dir)
26	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\test_integration\test_postgras_api.py:99:8
98	            delete_test_database_and_user(db_name, username, dict(config.items('backend')))
99	        except Exception:
100	            pass
101	    db.drop_all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:162:8
161	        created_db = json.loads(result.get_data(as_text=True))
162	        assert created_db["db_name"] == 'test_create_postgres_instance'
163	        self.delete_instance_by_name(db_credentials, self.app_client)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:183:8
182	        created_db = json.loads(result.get_data(as_text=True))
183	        assert 'let create fail' in created_db[
184	            "msg"
185	        ], 'unexpected error message for docker create failure'
186	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:201:8
200	        wait_success = wait_for_postgres_listening(created_db['container_id'])
201	        assert wait_success is True, 'postgres did not come up within 10s (or unexpected docker image log output)'
202	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:215:8
214	            res = json.loads(res.get_data(as_text=True))
215	        assert res['status'] == 'success'
216	        assert 'deleted postgraas instance, but container was not found' in res['msg']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:216:8
215	        assert res['status'] == 'success'
216	        assert 'deleted postgraas instance, but container was not found' in res['msg']
217	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:233:8
232	        pid.delete_postgres_instance(id0)
233	        assert pid.check_container_exists(id0) is False, "container exists after it was deleted"
234	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:253:8
252	            )
253	        assert result == 'fy8rfsufusgsufbvluluivhhvsbr'
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:271:12
270	            wait_success = wait_for_postgres_listening(created_db['container_id'])
271	            assert wait_success is True, 'postgres did not come up within 10s (or unexpected docker image log output)'
272	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:282:8
281	
282	        assert deleted_db["status"] == 'failed'
283	        assert 'password authentication failed' in deleted_db[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:283:8
282	        assert deleted_db["status"] == 'failed'
283	        assert 'password authentication failed' in deleted_db[
284	            'msg'
285	        ], 'unexpected message for wrong password'
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:300:16
299	                deleted_db = json.loads(delete_result.get_data(as_text=True))
300	                assert deleted_db["status"] == 'failed'
301	                assert 'let remove fail' in deleted_db[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:301:16
300	                assert deleted_db["status"] == 'failed'
301	                assert 'let remove fail' in deleted_db[
302	                    'msg'
303	                ], 'unexpected error message on docker rm failure'
304	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:313:8
312	        deleted_db = json.loads(delete_result.get_data(as_text=True))
313	        assert deleted_db["status"] == 'success'
314	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:325:8
324	        res = json.loads(res.get_data(as_text=True))
325	        assert res['status'] == 'failed'
326	        assert "123456789" in res['msg'], 'unexpected error message'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:326:8
325	        assert res['status'] == 'failed'
326	        assert "123456789" in res['msg'], 'unexpected error message'
327	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:343:8
342	        )
343	        assert second.get_data(as_text=True) == json.dumps(
344	            {
345	                "msg": "postgraas_instance_name already exists tests_postgraas_my_postgraas_twice"
346	            }
347	        ) + "\n"
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:368:8
367	        )
368	        assert actual.status_code == 200
369	        actual_data = json.loads(actual.get_data(as_text=True))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_integration\test_postgras_api.py:381:8
380	        }
381	        assert actual_data == expected
382	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\backends\postgres_cluster\test_postgres_cluster_driver.py:7:4
6	    stripped_username = pgcd.get_normalized_username(username_with_host)
7	    assert stripped_username == "testuser1234"
8	    username_without_host = 'testuser1234'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\backends\postgres_cluster\test_postgres_cluster_driver.py:10:4
9	    stripped_username = pgcd.get_normalized_username(username_with_host)
10	    assert stripped_username == "testuser1234"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_backends_plugin.py:12:4
11	    backend_config = get_backend(config)
12	    assert isinstance(backend_config, DockerBackend)
13	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_backends_plugin.py:21:4
20	    backend_config = get_backend(config)
21	    assert isinstance(backend_config, PGClusterBackend)
22	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_backends_plugin.py:27:4
26	    backend_config = get_backend(config)
27	    assert isinstance(backend_config, DockerBackend)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:23:8
22	        expected = os.path.join(os.getcwd(), 'application.cfg')
23	        assert actual == expected
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:29:8
28	        expected = 'postgraas'
29	        assert actual['metadb']['db_name'] == expected
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:45:8
44	
45	        assert username == expected
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:60:8
59	
60	        assert username == expected
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:70:8
69	        config_undecrypted = cf.get_config(test_config)
70	        assert config_undecrypted['metadb']["db_password"] == expected_secret.dumps()
71	        config_decrypted = cf.get_config(test_config, secrets_file=secret_file)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:72:8
71	        config_decrypted = cf.get_config(test_config, secrets_file=secret_file)
72	        assert config_decrypted['metadb']["db_password"].decrypt() == "correct_db_password"
73	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'v3rys3cur3'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\test_unit\test_configuration.py:88:17
87	
88	        config = secure_config.secrets.load_secret_dict(password="v3rys3cur3", config_dict=config_dict)
89	        metadb_string = cf.get_meta_db_config_path(config)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:91:8
90	        print(metadb_string)
91	        assert metadb_string == "postgresql://postgraas_user@thisserver:correct_db_password@thisserver.host:5432/postgres"
92	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'v3rys3cur3'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\test_unit\test_configuration.py:101:17
100	            }
101	        config = secure_config.secrets.load_secret_dict(password="v3rys3cur3", config_dict=config_dict)
102	        password_string = cf.get_password(config)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:104:8
103	        print(password_string)
104	        assert password_string == "correct_db_password"
105	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'correct_db_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_unit\test_configuration.py:104:34
103	        print(password_string)
104	        assert password_string == "correct_db_password"
105	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_unit\test_configuration.py:114:8
113	        print(password_string)
114	        assert password_string == "v3rys3cur3"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'v3rys3cur3'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_unit\test_configuration.py:114:34
113	        print(password_string)
114	        assert password_string == "v3rys3cur3"

--------------------------------------------------

Code scanned:
	Total lines of code: 1654
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 65
		Medium: 3
		High: 1
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 12
		High: 57
Files skipped (0):
