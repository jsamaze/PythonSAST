Working... ---------------------------------------- 100% 0:00:54
Run started:2024-02-10 21:19:59.732352

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\icons\icns\make_iconsets.py:9:0
8	
9	import os, shutil, subprocess, sys
10	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\icons\icns\make_iconsets.py:31:16
30	            if src.endswith('.svg'):
31	                subprocess.check_call(['rsvg-convert', src, '-w', str(sz), '-h', str(sz), '-o', iname])
32	            else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\icons\icns\make_iconsets.py:31:16
30	            if src.endswith('.svg'):
31	                subprocess.check_call(['rsvg-convert', src, '-w', str(sz), '-h', str(sz), '-o', iname])
32	            else:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\icons\icns\make_iconsets.py:37:20
36	                else:
37	                    subprocess.check_call(['convert', src, '-resize', '{0}x{0}'.format(sz), iname])
38	            if sz > 16:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\icons\icns\make_iconsets.py:37:20
36	                else:
37	                    subprocess.check_call(['convert', src, '-resize', '{0}x{0}'.format(sz), iname])
38	            if sz > 16:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\icons\icns\make_iconsets.py:44:20
43	                if os.path.exists(name):
44	                    subprocess.check_call(['optipng', '-o7', '-strip', 'all', name])
45	    finally:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\icons\icns\make_iconsets.py:44:20
43	                if os.path.exists(name):
44	                    subprocess.check_call(['optipng', '-o7', '-strip', 'all', name])
45	    finally:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\icons\make_ico_files.py:9:0
8	
9	import os, shutil, subprocess, sys
10	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\icons\make_ico_files.py:26:12
25	            iname = os.path.join('ico_temp', '{0}x{0}.png'.format(sz))
26	            subprocess.check_call(['rsvg-convert', src, '-w', str(sz), '-h', str(sz), '-o', iname])
27	            subprocess.check_call(['optipng', '-o7', '-strip', 'all', iname])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\icons\make_ico_files.py:26:12
25	            iname = os.path.join('ico_temp', '{0}x{0}.png'.format(sz))
26	            subprocess.check_call(['rsvg-convert', src, '-w', str(sz), '-h', str(sz), '-o', iname])
27	            subprocess.check_call(['optipng', '-o7', '-strip', 'all', iname])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\icons\make_ico_files.py:27:12
26	            subprocess.check_call(['rsvg-convert', src, '-w', str(sz), '-h', str(sz), '-o', iname])
27	            subprocess.check_call(['optipng', '-o7', '-strip', 'all', iname])
28	            if sz >= 128:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\icons\make_ico_files.py:27:12
26	            subprocess.check_call(['rsvg-convert', src, '-w', str(sz), '-h', str(sz), '-o', iname])
27	            subprocess.check_call(['optipng', '-o7', '-strip', 'all', iname])
28	            if sz >= 128:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\icons\make_ico_files.py:33:8
32	            names.append(iname)
33	        subprocess.check_call(['icotool', '-c', '--output=' + name+'.ico'] + names)
34	    finally:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\imgsrc\generate.py:7:0
6	                        print_function)
7	import os, glob, subprocess, argparse
8	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\generate.py:47:4
46	        cmd += ['--width', size, '--height', size]
47	    subprocess.check_call(cmd + ['-o', dest, src])
48	    subprocess.check_call(['optipng', '-o7', '-quiet', '-strip', 'all', dest])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\imgsrc\generate.py:48:4
47	    subprocess.check_call(cmd + ['-o', dest, src])
48	    subprocess.check_call(['optipng', '-o7', '-quiet', '-strip', 'all', dest])
49	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\generate.py:48:4
47	    subprocess.check_call(cmd + ['-o', dest, src])
48	    subprocess.check_call(['optipng', '-o7', '-quiet', '-strip', 'all', dest])
49	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\imgsrc\render-logo.py:7:0
6	                        print_function)
7	import os, subprocess, sys, shutil
8	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\render-logo.py:21:4
20	        cmd.insert(2, background), cmd.insert(2, '-b')
21	    subprocess.check_call(cmd)
22	    subprocess.check_call(['optipng', '-o7', '-strip', 'all', outpath])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\imgsrc\render-logo.py:22:4
21	    subprocess.check_call(cmd)
22	    subprocess.check_call(['optipng', '-o7', '-strip', 'all', outpath])
23	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\render-logo.py:22:4
21	    subprocess.check_call(cmd)
22	    subprocess.check_call(['optipng', '-o7', '-strip', 'all', outpath])
23	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\render-logo.py:34:0
33	
34	subprocess.check_call([sys.executable, j(icons, 'make_ico_files.py'), 'only-logo'])
35	shutil.copy2(j(icons, 'library.ico'), j(srv, 'common', 'favicon.ico'))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\render-logo.py:38:0
37	shutil.copy2(j(icons, 'library.ico'), j(srv, 'open-books/drmfree/static/img', 'favicon.ico'))
38	subprocess.check_call([sys.executable, j(icons, 'icns', 'make_iconsets.py'), 'only-logo'])
39	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\imgsrc\render-logo.py:41:0
40	os.chdir(srv)
41	subprocess.check_call(['git', 'commit', '-am', 'Update calibre favicons'])
42	for s in 'main code open-books dl1'.split():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\render-logo.py:41:0
40	os.chdir(srv)
41	subprocess.check_call(['git', 'commit', '-am', 'Update calibre favicons'])
42	for s in 'main code open-books dl1'.split():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\imgsrc\render-logo.py:43:4
42	for s in 'main code open-books dl1'.split():
43	    subprocess.check_call(['./publish', s, 'update'])

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\imgsrc\srv\generate.py:9:0
8	
9	from lxml import etree
10	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\imgsrc\srv\generate.py:26:10
25	    base = os.path.dirname(os.path.abspath(__file__))
26	    ans = etree.fromstring('<svg xmlns="%s" xmlns:xlink="%s"/>' % (SVG_NS, XLINK_NS))
27	    for f in os.listdir(base):

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\imgsrc\srv\generate.py:32:14
31	            raw = ff.read()
32	        svg = etree.fromstring(raw)
33	        symbol = ans.makeelement('{%s}symbol' % SVG_NS)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\manual\build.py:9:0
8	
9	import sys, os, subprocess, shutil
10	import tempfile

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\manual\build.py:38:4
37	    print(' '.join(ans))
38	    subprocess.check_call(ans)
39	    return destdir

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\manual\build.py:52:12
51	    def run_cmd(cmd):
52	        p = subprocess.Popen(cmd, stdout=open(os.devnull, 'wb'), stdin=subprocess.PIPE)
53	        p.stdin.close()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\manual\build.py:78:4
77	    print (' '.join(cmd))
78	    subprocess.check_call(cmd)
79	    os.remove(j(base, 'generated.pot'))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\manual\qthelp.py:5:0
4	import cgi
5	import subprocess
6	from os import path

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\manual\qthelp.py:136:8
135	        qhcp = os.path.abspath(os.path.join(outdir, outname+'.qhcp'))
136	        subprocess.check_call(['qcollectiongenerator', qhcp])
137	        qhc = qhcp[:-5]+'.qhc'

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\manual\qthelp.py:136:8
135	        qhcp = os.path.abspath(os.path.join(outdir, outname+'.qhcp'))
136	        subprocess.check_call(['qcollectiongenerator', qhcp])
137	        qhc = qhcp[:-5]+'.qhc'

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\check.py:9:0
8	
9	import sys, os, json, subprocess, errno, hashlib
10	from setup import Command, build_cache_dir, edit_file

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\setup\check.py:72:40
71	        except KeyError:
72	            self.fhash_cache[f] = ans = hashlib.sha1(self.read_file(f)).hexdigest()
73	            return ans

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\check.py:89:16
88	        if ext in {'.py', '.recipe'}:
89	            p = subprocess.Popen(['flake8-python2', '--filename', '*.py,*.recipe', f])
90	            return p.wait() != 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\check.py:89:16
88	        if ext in {'.py', '.recipe'}:
89	            p = subprocess.Popen(['flake8-python2', '--filename', '*.py,*.recipe', f])
90	            return p.wait() != 0

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\check.py:92:16
91	        elif ext == '.pyj':
92	            p = subprocess.Popen(['rapydscript', 'lint', f])
93	            return p.wait() != 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\check.py:92:16
91	        elif ext == '.pyj':
92	            p = subprocess.Popen(['rapydscript', 'lint', f])
93	            return p.wait() != 0

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\file-hosting-bw.py:9:0
8	
9	import os, subprocess, socket
10	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\file-hosting-bw.py:19:8
18	    for name in 'hours days months top10 summary'.split():
19	        subprocess.check_call(['vnstati', '--' + name, '-o', name + '.png'])
20	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\file-hosting-bw.py:19:8
18	    for name in 'hours days months top10 summary'.split():
19	        subprocess.check_call(['vnstati', '--' + name, '-o', name + '.png'])
20	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\git_post_checkout_hook.py:9:0
8	
9	import os, subprocess, sys
10	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\git_post_checkout_hook.py:13:11
12	def get_branch_name(rev):
13	    return subprocess.check_output(['git', 'name-rev', '--name-only', rev]).decode('utf-8').strip()
14	base = os.path.dirname(os.path.dirname(os.path.realpath(__file__)))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\git_post_checkout_hook.py:13:11
12	def get_branch_name(rev):
13	    return subprocess.check_output(['git', 'name-rev', '--name-only', rev]).decode('utf-8').strip()
14	base = os.path.dirname(os.path.dirname(os.path.realpath(__file__)))

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\git_post_checkout_hook.py:20:4
19	
20	    subprocess.check_call(['python', 'setup.py', 'gui', '--summary'])
21	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\git_post_checkout_hook.py:20:4
19	
20	    subprocess.check_call(['python', 'setup.py', 'gui', '--summary'])
21	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\git_post_rewrite_hook.py:9:0
8	
9	import subprocess, os, sys
10	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\git_post_rewrite_hook.py:17:4
16	if action == 'rebase':
17	    subprocess.check_call(['python', 'setup.py', 'gui'])
18	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\git_post_rewrite_hook.py:17:4
16	if action == 'rebase':
17	    subprocess.check_call(['python', 'setup.py', 'gui'])
18	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\setup\git_pre_commit_hook.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\hosting.py:13:0
12	from argparse import ArgumentParser, FileType
13	from subprocess import check_call
14	from collections import OrderedDict

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\hosting.py:96:20
95	                try:
96	                    check_call(['rsync', '-h', '-z', '--progress', '-e', 'ssh -x', x,
97	                    '%s,%s@frs.sourceforge.net:%s'%(self.username, self.project,
98	                        self.rdir+'/')])
99	                except KeyboardInterrupt:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\hosting.py:96:20
95	                try:
96	                    check_call(['rsync', '-h', '-z', '--progress', '-e', 'ssh -x', x,
97	                    '%s,%s@frs.sourceforge.net:%s'%(self.username, self.project,
98	                        self.rdir+'/')])
99	                except KeyboardInterrupt:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\install.py:9:0
8	
9	import sys, os, textwrap, subprocess, shutil, tempfile, atexit, glob
10	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\setup\install.py:133:92
132	        # during the build process are in /tmp
133	        os.environ['CALIBRE_CONFIG_DIRECTORY'] = os.environ.get('CALIBRE_CONFIG_DIRECTORY', '/tmp/calibre-install-config')
134	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\setup\install.py:283:8
282	        os.mkdir(tdir)
283	        subprocess.check_call('git archive HEAD | tar -x -C ' + tdir, shell=True)
284	        for x in open('.gitignore').readlines():

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\install.py:319:8
318	        dest = self.DEST.rpartition('.')[0]
319	        subprocess.check_call(['tar', '-cf', self.a(dest), 'calibre-%s' % __version__], cwd=self.d(tdir))
320	        self.info('\tCompressing tarfile...')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\install.py:319:8
318	        dest = self.DEST.rpartition('.')[0]
319	        subprocess.check_call(['tar', '-cf', self.a(dest), 'calibre-%s' % __version__], cwd=self.d(tdir))
320	        self.info('\tCompressing tarfile...')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\install.py:323:8
322	            os.remove(self.a(self.DEST))
323	        subprocess.check_call(['xz', '-9', self.a(dest)])
324	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\install.py:323:8
322	            os.remove(self.a(self.DEST))
323	        subprocess.check_call(['xz', '-9', self.a(dest)])
324	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\install.py:349:12
348	                shutil.rmtree(tdir)
349	            subprocess.check_call(['git', 'clone', '--depth=1', self.TRANSLATIONS_REPO, 'translations'], cwd=self.d(self.SRC))
350	        else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\install.py:349:12
348	                shutil.rmtree(tdir)
349	            subprocess.check_call(['git', 'clone', '--depth=1', self.TRANSLATIONS_REPO, 'translations'], cwd=self.d(self.SRC))
350	        else:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\install.py:352:16
351	            if os.path.exists(tdir):
352	                subprocess.check_call(['git', 'pull'], cwd=tdir)
353	            else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\install.py:352:16
351	            if os.path.exists(tdir):
352	                subprocess.check_call(['git', 'pull'], cwd=tdir)
353	            else:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\install.py:354:16
353	            else:
354	                subprocess.check_call(['git', 'clone', self.TRANSLATIONS_REPO, 'translations'], cwd=self.d(self.SRC))
355	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\install.py:354:16
353	            else:
354	                subprocess.check_call(['git', 'clone', self.TRANSLATIONS_REPO, 'translations'], cwd=self.d(self.SRC))
355	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\installers.py:6:0
5	from __future__ import (unicode_literals, division, absolute_import, print_function)
6	import os, sys, subprocess
7	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\installers.py:29:10
28	    env['CALIBRE_SRC_DIR'] = base
29	    ret = subprocess.Popen(cmd, env=env, cwd=build_calibre).wait()
30	    if ret != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\installers.py:49:8
48	        cmd = [sys.executable, os.path.join(build_calibre, which), 'shutdown']
49	        subprocess.Popen(cmd, env=env, cwd=build_calibre).wait()
50	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\linux-installer.py:10:0
9	
10	import sys, os, shutil, subprocess, re, platform, signal, tempfile, hashlib, errno
11	import ssl, socket, stat

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\setup\linux-installer.py:594:16
593	                        break
594	                except Exception:
595	                    # Invalid proxy, ignore
596	                    pass
597	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\linux-installer.py:626:12
625	    with open('/dev/null', 'w') as null:
626	        p = subprocess.Popen(
627	            list(map(encode_for_subprocess, ['tar', 'xJof', '-', '-C', destdir])),
628	            stdout=null, stdin=subprocess.PIPE, close_fds=True, preexec_fn=lambda:
629	            signal.signal(signal.SIGPIPE, signal.SIG_DFL))
630	        p.stdin.write(raw)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\linux-installer.py:687:8
686	            pi.extend(['--sharedir', share_dir])
687	        subprocess.call(pi)
688	        prints('Run "calibre" to start calibre')

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\setup\multitail.py:17:28
16	def debug(*args):
17	    print (*args, file=open('/tmp/log', 'a'))
18	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\setup\multitail.py:182:45
181	                num += 1
182	                print (((' %dabc\r' % num) * random.randint(9, 100)), file=random.choice(files))
183	                [f.flush() for f in files]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\setup\multitail.py:182:75
181	                num += 1
182	                print (((' %dabc\r' % num) * random.randint(9, 100)), file=random.choice(files))
183	                [f.flush() for f in files]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\parallel_build.py:9:0
8	
9	import subprocess
10	from multiprocessing.dummy import Pool

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\parallel_build.py:51:12
50	    try:
51	        p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
52	    except Exception as err:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\plugins_mirror.py:21:0
20	import stat
21	import subprocess
22	import sys

--------------------------------------------------
>> Issue: [B406:blacklist] Using escape to parse untrusted XML data is known to be vulnerable to XML attacks. Replace escape with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\setup\plugins_mirror.py:36:0
35	from multiprocessing.pool import ThreadPool
36	from xml.sax.saxutils import escape, quoteattr
37	# }}}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\setup\plugins_mirror.py:69:23
68	                raise
69	            time.sleep(random.randint(10, 45))
70	    info = res.info()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\setup\plugins_mirror.py:238:12
237	                val = convert_node({x}, node.value, import_data=import_data)
238	            except Exception:
239	                pass
240	            else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\plugins_mirror.py:564:8
563	        os.rename(olog, log)
564	        subprocess.check_call(['/usr/sbin/nginx', '-s', 'reopen'])
565	        atexit.register(os.remove, log)

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\setup\plugins_mirror.py:653:4
652	    old_entries = []
653	    from lxml import html
654	    root = html.fromstring(raw)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\setup\plugins_mirror.py:731:4
730	        'minimum_calibre_version':(0, 7, 53)}
731	    assert parse_metadata(raw, None, None) == vals
732	    buf = io.BytesIO()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\setup\plugins_mirror.py:737:4
736	        zf.writestr('__init__.py', b'from xxx import yyy\nfrom very.lovely import HelloWorld')
737	    assert get_plugin_info(buf.getvalue()) == vals
738	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\publish.py:9:0
8	
9	import os, shutil, subprocess, glob, tempfile, json, time, filecmp, atexit, sys
10	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:57:16
56	            r, w = pipe()
57	            p = subprocess.Popen([sys.executable, 'setup.py', x],
58	                                 stdout=w,
59	                                 stderr=subprocess.STDOUT,
60	                                 cwd=self.d(self.SRC),
61	                                 preexec_fn=kill_child_on_parent_death)
62	            p.log, p.start_time, p.bname = r, time.time(), x

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\publish.py:135:8
134	    def run(self, opts):
135	        subprocess.check_call('rm -rf build/* dist/*', shell=True)
136	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\setup\publish.py:135:8
134	    def run(self, opts):
135	        subprocess.check_call('rm -rf build/* dist/*', shell=True)
136	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:153:12
152	        if 'PUBLISH_BUILD_DONE' not in os.environ:
153	            subprocess.check_call([sys.executable, 'setup.py', 'build'])
154	            os.environ['PUBLISH_BUILD_DONE'] = '1'

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\setup\publish.py:155:12
154	            os.environ['PUBLISH_BUILD_DONE'] = '1'
155	            os.execl(os.path.abspath('setup.py'), './setup.py', 'publish')
156	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:168:8
167	        dist = self.a(self.j(self.d(self.SRC), 'dist'))
168	        subprocess.check_call((
169	            'rsync --partial -rh --progress --delete-after %s/ download.calibre-ebook.com:/srv/download/betas/'
170	            % dist
171	        ).split())
172	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:219:8
218	        self.info('Building manual for %d languages' % len(jobs))
219	        subprocess.check_call(jobs[0][0])
220	        if not parallel_build(jobs[1:], self.info):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:311:8
310	        self.info('\tCreating man pages in {} for {} languages...'.format(dest, len(jobs)))
311	        subprocess.check_call(jobs[0][0])
312	        if not parallel_build(jobs[1:], self.info, verbose=False):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:346:8
345	        self.info('Tagging release')
346	        subprocess.check_call(
347	            'git tag -s v{0} -m "version-{0}"'.format(__version__).split()
348	        )
349	        subprocess.check_call('git push origin v{0}'.format(__version__).split())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\publish.py:349:8
348	        )
349	        subprocess.check_call('git push origin v{0}'.format(__version__).split())

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\unix-ci.py:9:0
8	import shlex
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\unix-ci.py:58:10
57	    print(' '.join(args))
58	    ret = subprocess.Popen(args).wait()
59	    if ret != 0:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\unix-ci.py:73:18
72	        with NamedTemporaryFile() as f:
73	            ret = subprocess.Popen(['curl', '-fSL', url], stdout=f).wait()
74	            if ret == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\unix-ci.py:73:18
72	        with NamedTemporaryFile() as f:
73	            ret = subprocess.Popen(['curl', '-fSL', url], stdout=f).wait()
74	            if ret == 0:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\vcvars.py:10:0
9	
10	import os, sys, subprocess
11	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\vcvars.py:30:12
29	    result = {}
30	    popen = subprocess.Popen(cmd, stdout=subprocess.PIPE,
31	                             stderr=subprocess.PIPE)
32	    try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup\win-ci.py:9:0
8	import os
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\win-ci.py:97:16
96	        result = {}
97	        popen = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
98	        try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup\win-ci.py:167:19
166	            printf('Downloading', url)
167	            return subprocess.check_output(['curl.exe', '-fSL', url])
168	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\win-ci.py:167:19
166	            printf('Downloading', url)
167	            return subprocess.check_output(['curl.exe', '-fSL', url])
168	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b202_tarfile_unsafe_members.html
   Location: .\setup\win-ci.py:181:8
180	    with tarfile.open(fileobj=io.BytesIO(tarball)) as tf:
181	        tf.extractall()
182	    printf('Download complete')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\win-ci.py:211:8
210	    printf(*cmd)
211	    p = subprocess.Popen(cmd, env=vcenv())
212	    raise SystemExit(p.wait())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup\win-ci.py:219:8
218	    printf(*cmd)
219	    p = subprocess.Popen(cmd)
220	    raise SystemExit(p.wait())

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\__init__.py:405:11
404	        ua_list = filter(lambda x: 'Trident/' not in x and 'Edge/' not in x, ua_list)
405	    return random.choice(ua_list) if choose is None else ua_list[choose]
406	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\__init__.py:483:8
482	            os.chdir(self.cwd)
483	        except:
484	            # The previous CWD no longer exists
485	            pass
486	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\customize\conversion.py:236:8
235	                log('on', stream.name)
236	        except:
237	            # In case stdout is broken
238	            pass
239	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\__init__.py:55:8
54	            return (match.group(1).strip(), idx)
55	        except:
56	            pass
57	    return (val, None)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\cache.py:869:16
868	                    os.makedirs(d)
869	                except:
870	                    pass
871	                ret = os.path.join(d, fname)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\db\cache.py:1120:19
1119	        if self.dirtied_cache:
1120	            return random.choice(tuple(self.dirtied_cache.iterkeys()))
1121	        return None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\cache.py:1140:12
1139	                    mi.cover = 'cover.jpg'
1140	            except:
1141	                # This almost certainly means that the book has been deleted while
1142	                # the backup operation sat in the queue.
1143	                pass
1144	        return mi, sequence

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\cache.py:1212:12
1211	                    self._clear_dirtied(book_id, sequence)
1212	            except:
1213	                pass
1214	            if callback is not None:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\db\cache.py:1446:16
1445	                    path = self._field_for('path', book_id).replace('/', os.sep)
1446	                except:
1447	                    continue
1448	                for fmt in fmts:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\db\cache.py:1451:20
1450	                        name = self.fields['formats'].format_fname(book_id, fmt)
1451	                    except:
1452	                        continue
1453	                    if name and path:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\db\cache.py:2146:12
2145	                path = self._field_for('path', book_id).replace('/', os.sep)
2146	            except:
2147	                continue
2148	            for fmt in fmts:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\db\cache.py:2153:16
2152	                    name = self.fields['formats'].format_fname(book_id, fmt)
2153	                except:
2154	                    continue
2155	                if name and path:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\categories.py:113:4
112	            dbcache.set_pref('user_categories', new_cats)
113	    except:
114	        pass
115	    return new_cats

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\lazy.py:89:12
88	                self._values[f] = db.format_metadata(self._id, f)
89	            except:
90	                pass
91	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\db\locking.py:95:12
94	                return self._acquire_exclusive(blocking)
95	            assert not (self.is_shared and self.is_exclusive)
96	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\db\locking.py:147:24
146	                    else:
147	                        assert not self._shared_queue
148	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\db\locking.py:169:16
168	                waiter.wait()
169	                assert not self.is_exclusive
170	            finally:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\db\locking.py:181:12
180	        if self._exclusive_owner is me:
181	            assert self.is_exclusive
182	            self.is_exclusive += 1

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\schema_upgrades.py:247:28
246	        def create_tag_browser_view(table_name, column_name):
247	            self.db.execute('''
248	                DROP VIEW IF EXISTS tag_browser_{tn};
249	                CREATE VIEW tag_browser_{tn} AS SELECT
250	                    id,
251	                    name,
252	                    (SELECT COUNT(id) FROM books_{tn}_link WHERE {cn}={tn}.id) count
253	                FROM {tn};
254	                '''.format(tn=table_name, cn=column_name))
255	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\schema_upgrades.py:284:22
283	        def create_tag_browser_view(table_name, column_name, view_column_name):
284	            script = ('''
285	                DROP VIEW IF EXISTS tag_browser_{tn};
286	                CREATE VIEW tag_browser_{tn} AS SELECT
287	                    id,
288	                    {vcn},
289	                    (SELECT COUNT(id) FROM books_{tn}_link WHERE {cn}={tn}.id) count
290	                FROM {tn};
291	                DROP VIEW IF EXISTS tag_browser_filtered_{tn};
292	                CREATE VIEW tag_browser_filtered_{tn} AS SELECT
293	                    id,
294	                    {vcn},
295	                    (SELECT COUNT(books_{tn}_link.id) FROM books_{tn}_link WHERE
296	                        {cn}={tn}.id AND books_list_filter(book)) count
297	                FROM {tn};
298	                '''.format(tn=table_name, cn=column_name, vcn=view_column_name))
299	            self.db.execute(script)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\schema_upgrades.py:313:22
312	                                        view_column_name, sort_column_name):
313	            script = ('''
314	                DROP VIEW IF EXISTS tag_browser_{tn};
315	                CREATE VIEW tag_browser_{tn} AS SELECT
316	                    id,
317	                    {vcn},
318	                    (SELECT COUNT(id) FROM books_{tn}_link WHERE {cn}={tn}.id) count,
319	                    (SELECT AVG(ratings.rating)
320	                     FROM books_{tn}_link AS tl, books_ratings_link AS bl, ratings
321	                     WHERE tl.{cn}={tn}.id AND bl.book=tl.book AND
322	                     ratings.id = bl.rating AND ratings.rating <> 0) avg_rating,
323	                     {scn} AS sort
324	                FROM {tn};
325	                DROP VIEW IF EXISTS tag_browser_filtered_{tn};
326	                CREATE VIEW tag_browser_filtered_{tn} AS SELECT
327	                    id,
328	                    {vcn},
329	                    (SELECT COUNT(books_{tn}_link.id) FROM books_{tn}_link WHERE
330	                        {cn}={tn}.id AND books_list_filter(book)) count,
331	                    (SELECT AVG(ratings.rating)
332	                     FROM books_{tn}_link AS tl, books_ratings_link AS bl, ratings
333	                     WHERE tl.{cn}={tn}.id AND bl.book=tl.book AND
334	                     ratings.id = bl.rating AND ratings.rating <> 0 AND
335	                     books_list_filter(bl.book)) avg_rating,
336	                     {scn} AS sort
337	                FROM {tn};
338	
339	                '''.format(tn=table_name, cn=column_name,
340	                           vcn=view_column_name, scn=sort_column_name))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\schema_upgrades.py:344:21
343	        def create_cust_tag_browser_view(table_name, link_table_name):
344	            script = '''
345	                DROP VIEW IF EXISTS tag_browser_{table};
346	                CREATE VIEW tag_browser_{table} AS SELECT
347	                    id,
348	                    value,
349	                    (SELECT COUNT(id) FROM {lt} WHERE value={table}.id) count,
350	                    (SELECT AVG(r.rating)
351	                     FROM {lt},
352	                          books_ratings_link AS bl,
353	                          ratings AS r
354	                     WHERE {lt}.value={table}.id AND bl.book={lt}.book AND
355	                           r.id = bl.rating AND r.rating <> 0) avg_rating,
356	                     value AS sort
357	                FROM {table};
358	
359	                DROP VIEW IF EXISTS tag_browser_filtered_{table};
360	                CREATE VIEW tag_browser_filtered_{table} AS SELECT
361	                    id,
362	                    value,
363	                    (SELECT COUNT({lt}.id) FROM {lt} WHERE value={table}.id AND
364	                    books_list_filter(book)) count,
365	                    (SELECT AVG(r.rating)
366	                     FROM {lt},
367	                          books_ratings_link AS bl,
368	                          ratings AS r
369	                     WHERE {lt}.value={table}.id AND bl.book={lt}.book AND
370	                           r.id = bl.rating AND r.rating <> 0 AND
371	                           books_list_filter(bl.book)) avg_rating,
372	                     value AS sort
373	                FROM {table};
374	                '''.format(lt=link_table_name, table=table_name)
375	            self.db.execute(script)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\schema_upgrades.py:488:17
487	        '''
488	        script = '''
489	        DROP TABLE IF EXISTS library_id;
490	        CREATE TABLE library_id ( id   INTEGER PRIMARY KEY,
491	                                  uuid TEXT NOT NULL,
492	                                  UNIQUE(uuid)
493	        );
494	
495	        DROP TABLE IF EXISTS identifiers;
496	        CREATE TABLE identifiers  ( id     INTEGER PRIMARY KEY,
497	                                    book   INTEGER NOT NULL,
498	                                    type   TEXT NOT NULL DEFAULT "isbn" COLLATE NOCASE,
499	                                    val    TEXT NOT NULL COLLATE NOCASE,
500	                                    UNIQUE(book, type)
501	        );
502	
503	        DROP TABLE IF EXISTS languages;
504	        CREATE TABLE languages    ( id        INTEGER PRIMARY KEY,
505	                                    lang_code TEXT NOT NULL COLLATE NOCASE,
506	                                    UNIQUE(lang_code)
507	        );
508	
509	        DROP TABLE IF EXISTS books_languages_link;
510	        CREATE TABLE books_languages_link ( id INTEGER PRIMARY KEY,
511	                                            book INTEGER NOT NULL,
512	                                            lang_code INTEGER NOT NULL,
513	                                            item_order INTEGER NOT NULL DEFAULT 0,
514	                                            UNIQUE(book, lang_code)
515	        );
516	
517	        DROP TRIGGER IF EXISTS fkc_delete_on_languages;
518	        CREATE TRIGGER fkc_delete_on_languages
519	        BEFORE DELETE ON languages
520	        BEGIN
521	            SELECT CASE
522	                WHEN (SELECT COUNT(id) FROM books_languages_link WHERE lang_code=OLD.id) > 0
523	                THEN RAISE(ABORT, 'Foreign key violation: language is still referenced')
524	            END;
525	        END;
526	
527	        DROP TRIGGER IF EXISTS fkc_delete_on_languages_link;
528	        CREATE TRIGGER fkc_delete_on_languages_link
529	        BEFORE INSERT ON books_languages_link
530	        BEGIN
531	          SELECT CASE
532	              WHEN (SELECT id from books WHERE id=NEW.book) IS NULL
533	              THEN RAISE(ABORT, 'Foreign key violation: book not in books')
534	              WHEN (SELECT id from languages WHERE id=NEW.lang_code) IS NULL
535	              THEN RAISE(ABORT, 'Foreign key violation: lang_code not in languages')
536	          END;
537	        END;
538	
539	        DROP TRIGGER IF EXISTS fkc_update_books_languages_link_a;
540	        CREATE TRIGGER fkc_update_books_languages_link_a
541	        BEFORE UPDATE OF book ON books_languages_link
542	        BEGIN
543	            SELECT CASE
544	                WHEN (SELECT id from books WHERE id=NEW.book) IS NULL
545	                THEN RAISE(ABORT, 'Foreign key violation: book not in books')
546	            END;
547	        END;
548	        DROP TRIGGER IF EXISTS fkc_update_books_languages_link_b;
549	        CREATE TRIGGER fkc_update_books_languages_link_b
550	        BEFORE UPDATE OF lang_code ON books_languages_link
551	        BEGIN
552	            SELECT CASE
553	                WHEN (SELECT id from languages WHERE id=NEW.lang_code) IS NULL
554	                THEN RAISE(ABORT, 'Foreign key violation: lang_code not in languages')
555	            END;
556	        END;
557	
558	        DROP INDEX IF EXISTS books_languages_link_aidx;
559	        CREATE INDEX books_languages_link_aidx ON books_languages_link (lang_code);
560	        DROP INDEX IF EXISTS books_languages_link_bidx;
561	        CREATE INDEX books_languages_link_bidx ON books_languages_link (book);
562	        DROP INDEX IF EXISTS languages_idx;
563	        CREATE INDEX languages_idx ON languages (lang_code COLLATE NOCASE);
564	
565	        DROP TRIGGER IF EXISTS books_delete_trg;
566	        CREATE TRIGGER books_delete_trg
567	            AFTER DELETE ON books
568	            BEGIN
569	                DELETE FROM books_authors_link WHERE book=OLD.id;
570	                DELETE FROM books_publishers_link WHERE book=OLD.id;
571	                DELETE FROM books_ratings_link WHERE book=OLD.id;
572	                DELETE FROM books_series_link WHERE book=OLD.id;
573	                DELETE FROM books_tags_link WHERE book=OLD.id;
574	                DELETE FROM books_languages_link WHERE book=OLD.id;
575	                DELETE FROM data WHERE book=OLD.id;
576	                DELETE FROM comments WHERE book=OLD.id;
577	                DELETE FROM conversion_options WHERE book=OLD.id;
578	                DELETE FROM books_plugin_data WHERE book=OLD.id;
579	                DELETE FROM identifiers WHERE book=OLD.id;
580	        END;
581	
582	        INSERT INTO identifiers (book, val) SELECT id,isbn FROM books WHERE isbn;
583	
584	        ALTER TABLE books ADD COLUMN last_modified TIMESTAMP NOT NULL DEFAULT "%s";
585	
586	        '''%isoformat(DEFAULT_DATE, sep=' ')
587	        # Sqlite does not support non constant default values in alter

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\search.py:560:20
559	                            break
560	                    except:
561	                        pass
562	                return matches

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\tables.py:30:4
29	            return UNDEFINED_DATE
30	    except:
31	        pass
32	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:106:27
105	        idcol = 'id' if self.metadata['table'] == 'books' else 'book'
106	        query = db.execute('SELECT {0}, {1} FROM {2}'.format(idcol,
107	            self.metadata['column'], self.metadata['table']))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:114:35
113	                # failures to decode utf-8
114	                query = db.execute('SELECT {0}, cast({1} as blob) FROM {2}'.format(idcol,
115	                    self.metadata['column'], self.metadata['table']))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:208:27
207	    def read_id_maps(self, db):
208	        query = db.execute('SELECT id, {0} FROM {1}'.format(
209	            self.metadata['column'], self.metadata['table']))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:220:16
219	        for book, item_id in db.execute(
220	                'SELECT book, {0} FROM {1}'.format(
221	                    self.metadata['link_column'], self.link_table)):

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:233:27
232	                    self.book_col_map.pop(book_id, None)
233	            db.executemany('DELETE FROM {0} WHERE {1}=?'.format(
234	                self.link_table, self.metadata['link_column']), tuple((x,) for x in extra_item_ids))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:250:31
249	                        self.book_col_map[book_id] = main_id
250	                db.executemany('UPDATE {0} SET {1}=? WHERE {1}=?'.format(
251	                    self.link_table, self.metadata['link_column']),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:253:31
252	                    tuple((main_id, x) for x in v))
253	                db.executemany('DELETE FROM {0} WHERE id=?'.format(self.metadata['table']),
254	                    tuple((x,) for x in v))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:273:16
272	            db.executemany(
273	                'DELETE FROM {0} WHERE id=?'.format(self.metadata['table']),
274	                [(x,) for x in clean])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:299:28
298	                        db.executemany(
299	                            'DELETE FROM {0} WHERE book=?'.format(self.link_table), tuple((x,) for x in books_to_delete))
300	                        affected_books |= books_to_delete

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:317:23
316	        item_ids = tuple((x,) for x in item_ids)
317	        db.executemany('DELETE FROM {0} WHERE {1}=?'.format(self.link_table, self.metadata['link_column']), item_ids)
318	        db.executemany('DELETE FROM {0} WHERE id=?'.format(self.metadata['table']), item_ids)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:318:23
317	        db.executemany('DELETE FROM {0} WHERE {1}=?'.format(self.link_table, self.metadata['link_column']), item_ids)
318	        db.executemany('DELETE FROM {0} WHERE id=?'.format(self.metadata['table']), item_ids)
319	        return affected_books

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:330:23
329	            self.id_map[item_id] = new_name
330	            db.execute('UPDATE {0} SET {1}=? WHERE id=?'.format(table, col), (new_name, item_id))
331	        else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:342:23
341	            # handle that in this context.
342	            db.execute('UPDATE {0} SET {1}=? WHERE {1}=?; DELETE FROM {2} WHERE id=?'.format(
343	                self.link_table, lcol, table), (existing_item, item_id, item_id))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:356:27
355	            self.id_map = {item_id:rating for item_id, rating in self.id_map.iteritems() if rating != 0}
356	            db.executemany('DELETE FROM {0} WHERE {1}=?'.format(self.link_table, self.metadata['link_column']),
357	                                tuple((x,) for x in bad_ids))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:358:23
357	                                tuple((x,) for x in bad_ids))
358	            db.execute('DELETE FROM {0} WHERE {1}=0'.format(
359	                self.metadata['table'], self.metadata['column']))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:392:27
391	                    self.book_col_map[book_id] = tuple(iid for iid in self.book_col_map.pop(book_id, ()) if iid not in extra_item_ids)
392	            db.executemany('DELETE FROM {0} WHERE {1}=?'.format(
393	                self.link_table, self.metadata['link_column']), tuple((x,) for x in extra_item_ids))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:412:16
411	            db.executemany(
412	                'DELETE FROM {0} WHERE id=?'.format(self.metadata['table']),
413	                [(x,) for x in clean])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:439:27
438	            # still in the library.
439	            db.executemany('DELETE FROM {0} WHERE {1}=? and {2}=?'.format(
440	                    self.link_table, 'book', self.metadata['link_column']),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:456:23
455	        item_ids = tuple((x,) for x in item_ids)
456	        db.executemany('DELETE FROM {0} WHERE {1}=?'.format(self.link_table, self.metadata['link_column']), item_ids)
457	        db.executemany('DELETE FROM {0} WHERE id=?'.format(self.metadata['table']), item_ids)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:457:23
456	        db.executemany('DELETE FROM {0} WHERE {1}=?'.format(self.link_table, self.metadata['link_column']), item_ids)
457	        db.executemany('DELETE FROM {0} WHERE id=?'.format(self.metadata['table']), item_ids)
458	        return affected_books

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:469:23
468	            self.id_map[item_id] = new_name
469	            db.execute('UPDATE {0} SET {1}=? WHERE id=?'.format(table, col), (new_name, item_id))
470	        else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:481:27
480	            self.col_book_map[existing_item].update(books)
481	            db.executemany('DELETE FROM {0} WHERE book=? AND {1}=?'.format(self.link_table, lcol), [
482	                (book_id, existing_item) for book_id in books])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:483:23
482	                (book_id, existing_item) for book_id in books])
483	            db.execute('UPDATE {0} SET {1}=? WHERE {1}=?; DELETE FROM {2} WHERE id=?'.format(
484	                self.link_table, lcol, table), (existing_item, item_id, item_id))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:513:32
512	                            db.executemany(
513	                                'UPDATE {0} SET {1}=? WHERE {1}=? AND book=?'.format(
514	                                self.link_table, self.metadata['link_column']),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:518:39
517	                            # duplicates
518	                            db.execute('DELETE FROM {0} WHERE book=?'.format(self.link_table), (book_id,))
519	                            db.executemany(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:520:32
519	                            db.executemany(
520	                                'INSERT INTO {0} (book,{1}) VALUES (?,?)'.format(self.link_table, self.metadata['link_column']),
521	                                tuple((book_id, x) for x in vals))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tables.py:522:31
521	                                tuple((book_id, x) for x in vals))
522	                db.executemany('DELETE FROM {0} WHERE id=?'.format(self.metadata['table']),
523	                    tuple((x,) for x in v))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\db\tests\locking.py:159:25
158	            for _ in xrange(1000):
159	                shared = random.choice([True,False])
160	                lock.acquire(shared=shared)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\db\tests\locking.py:162:27
161	                lock.acquire(shared=shared)
162	                time.sleep(random.random() * 0.0001)
163	                lock.release()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\db\tests\locking.py:164:27
163	                lock.release()
164	                time.sleep(random.random() * 0.0001)
165	                lock.acquire(shared=shared)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\db\tests\locking.py:166:27
165	                lock.acquire(shared=shared)
166	                time.sleep(random.random() * 0.0001)
167	                lock.release()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\tests\reading.py:596:20
595	                        x.pop('rec_index', None)
596	                    except:
597	                        pass
598	                    return x

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tests\writing.py:682:21
681	        conn.execute('DELETE FROM books_publishers_link')
682	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (1, %d)' % lid)
683	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (2, %d)' % uid)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tests\writing.py:683:21
682	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (1, %d)' % lid)
683	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (2, %d)' % uid)
684	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (3, %d)' % uid)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\tests\writing.py:684:21
683	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (2, %d)' % uid)
684	        conn.execute('INSERT INTO books_publishers_link (book,publisher) VALUES (3, %d)' % uid)
685	        cache.reload_from_db()

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\db\utils.py:9:0
8	
9	import os, errno, cPickle, sys, re
10	from locale import localeconv

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\db\write.py:52:8
51	            return (match.group(1).strip(), idx)
52	        except:
53	            pass
54	    return (val, None)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:197:12
196	        db.executemany(
197	            'UPDATE books SET %s=? WHERE id=?'%field.metadata['column'], sequence)
198	        field.table.book_col_map.update(book_id_val_map)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:219:23
218	    if deleted:
219	        db.executemany('DELETE FROM %s WHERE book=?'%field.metadata['table'],
220	                        deleted)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:243:23
242	    if sequence:
243	        db.executemany('UPDATE %s SET %s=? WHERE book=? AND value=?'%(
244	                field.metadata['table'], field.metadata['column']), sequence)
245	    return {s[1] for s in sequence}

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:270:23
269	        else:
270	            db.execute('INSERT INTO %s(%s) VALUES (?)'%(
271	                m['table'], m['column']), (val,))
272	        item_id = rid_map[kval] = db.last_insert_rowid()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:290:8
289	    db.executemany(
290	        'UPDATE %s SET %s=? WHERE id=?'%(m['table'], m['column']), vals)
291	    for item_id, val in case_changes.iteritems():

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:346:23
345	    if deleted:
346	        db.executemany('DELETE FROM %s WHERE book=?'%table.link_table,
347	                            ((k,) for k in deleted))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:362:23
361	    if remove:
362	        db.executemany('DELETE FROM %s WHERE id=?'%m['table'],
363	            ((item_id,) for item_id in remove))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:445:23
444	    if deleted:
445	        db.executemany('DELETE FROM %s WHERE book=?'%table.link_table,
446	                            ((k,) for k in deleted))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:452:23
451	        )
452	        db.executemany('DELETE FROM %s WHERE book=?'%table.link_table,
453	                            ((k,) for k in updated))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\db\write.py:465:23
464	    if remove:
465	        db.executemany('DELETE FROM %s WHERE id=?'%m['table'],
466	            ((item_id,) for item_id in remove))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\devices\__init__.py:54:8
53	            d.open(det, None)
54	        except:
55	            continue
56	        else:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\calibre\devices\__init__.py:182:26
181	                if ioreg_to_tmp:
182	                    lopen('/tmp/ioreg.txt', 'wb').write(ioreg)
183	                    out('Dont forget to send the contents of /tmp/ioreg.txt')

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\__init__.py:197:16
196	                    d.shutdown()
197	                except:
198	                    pass
199	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\hanvon\driver.py:146:12
145	                    os.remove(cpath)
146	            except:
147	                pass
148	        self.report_progress(1.0, _('Removing books from device...'))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\devices\mtp\unix\upstream\update.py:10:0
9	
10	import os, shutil, subprocess
11	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\calibre\devices\mtp\unix\upstream\update.py:14:9
13	
14	os.chdir('/tmp')
15	if os.path.exists('libmtp'):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\devices\mtp\unix\upstream\update.py:17:0
16	    shutil.rmtree('libmtp')
17	subprocess.check_call(['git', 'clone', 'git://git.code.sf.net/p/libmtp/code',
18	                       'libmtp'])
19	for x in ('src/music-players.h', 'src/device-flags.h'):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\unix\upstream\update.py:17:0
16	    shutil.rmtree('libmtp')
17	subprocess.check_call(['git', 'clone', 'git://git.code.sf.net/p/libmtp/code',
18	                       'libmtp'])
19	for x in ('src/music-players.h', 'src/device-flags.h'):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\devices\mtp\windows\remote.py:10:0
9	
10	import subprocess, sys, os, pprint, signal, time, glob, io
11	pprint, io

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:15:13
14	def build(mod='wpd'):
15	    master = subprocess.Popen('ssh -MN getafix'.split())
16	    master2 = subprocess.Popen('ssh -MN win64'.split())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:16:14
15	    master = subprocess.Popen('ssh -MN getafix'.split())
16	    master2 = subprocess.Popen('ssh -MN win64'.split())
17	    try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:20:18
19	            time.sleep(0.05)
20	        builder = subprocess.Popen('ssh win64 ~/build-wpd'.split())
21	        if builder.wait() != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:25:17
24	            time.sleep(0.05)
25	        syncer = subprocess.Popen('ssh getafix ~/update-calibre'.split())
26	        if syncer.wait() != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:28:8
27	            raise Exception('Failed to rsync to getafix')
28	        subprocess.check_call(
29	            ('scp win64:build/calibre/src/calibre/plugins/%s.pyd /tmp'%mod).split())
30	        subprocess.check_call(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:30:8
29	            ('scp win64:build/calibre/src/calibre/plugins/%s.pyd /tmp'%mod).split())
30	        subprocess.check_call(
31	            ('scp /tmp/%s.pyd getafix:calibre-src/src/calibre/devices/mtp/windows'%mod).split())
32	        p = subprocess.Popen(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:32:12
31	            ('scp /tmp/%s.pyd getafix:calibre-src/src/calibre/devices/mtp/windows'%mod).split())
32	        p = subprocess.Popen(
33	            'ssh getafix calibre-debug -e calibre-src/src/calibre/devices/mtp/windows/remote.py'.split())
34	        p.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:48:8
47	        env[b'CALIBRE_DEVELOP_FROM'] = bytes(d(d(d(d(d(fp))))))
48	        subprocess.call(['calibre-debug', '-e', fp], env=env)
49	        return

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\devices\mtp\windows\remote.py:48:8
47	        env[b'CALIBRE_DEVELOP_FROM'] = bytes(d(d(d(d(d(fp))))))
48	        subprocess.call(['calibre-debug', '-e', fp], env=env)
49	        return

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\devices\prs505\sony_cache.py:93:8
92	    def __init__(self, paths, ext_paths, prefixes, use_author_sort):
93	        from lxml import etree
94	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\devices\prs505\sony_cache.py:117:36
116	
117	            self.roots[source_id] = etree.fromstring(xml_to_unicode(
118	                        raw, strip_encoding_pats=True, assume_utf8=True,
119	                        verbose=DEBUG)[0],
120	                        parser=parser)
121	            if self.roots[source_id] is None:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:132:16
131	                        fsync(f)
132	                except:
133	                    pass
134	            if os.access(path, os.W_OK):

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\devices\prs505\sony_cache.py:137:52
136	                    with lopen(path, 'rb') as f:
137	                        self.ext_roots[source_id] = etree.fromstring(
138	                                xml_to_unicode(f.read(),
139	                                    strip_encoding_pats=True, assume_utf8=True,
140	                                    verbose=DEBUG)[0], parser=parser)
141	                        self.ext_paths[source_id] = path

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:142:16
141	                        self.ext_paths[source_id] = path
142	                except:
143	                    pass
144	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:384:28
383	                                raw = b64decode(img.text.strip())
384	                            except:
385	                                continue
386	                            book.thumbnail = raw

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:490:8
489	            record.set('publicationDate', pubdate)
490	        except:
491	            pass
492	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:637:12
636	                record.set(k, clean(v))
637	            except:
638	                # v is not suitable for XML, ignore
639	                pass
640	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\devices\prs505\sony_cache.py:721:8
720	    def write(self):
721	        from lxml import etree
722	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:738:12
737	                    xml_declaration=True)
738	            except:
739	                continue
740	            raw = raw.replace("<?xml version='1.0' encoding='UTF-8'?>",

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\devices\prs505\sony_cache.py:775:12
774	                    ans = num
775	            except:
776	                continue
777	        return ans

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:70:8
69	            the_socket.shutdown(socket.SHUT_RDWR)
70	        except:
71	            # the shutdown can fail if the socket isn't fully connected. Ignore it
72	            pass
73	        the_socket.close()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:119:28
118	                                content_server_port = str(server_config().port)
119	                            except Exception:
120	                                pass
121	                            message = str(self.driver.ZEROCONF_CLIENT_STRING + b' (on ' +

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:127:24
126	                            self.driver.broadcast_socket.sendto(message, remote)
127	                        except:
128	                            pass
129	                    else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:452:8
451	                return (mdata.uuid + ext)
452	        except:
453	            pass
454	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:779:8
778	                os.remove(old_cache_file_name)
779	        except:
780	            pass
781	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:788:8
787	                os.remove(old_cache_file_name)
788	        except:
789	            pass
790	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:895:8
894	            the_socket.shutdown(socket.SHUT_RDWR)
895	        except:
896	            # the shutdown can fail if the socket isn't fully connected. Ignore it
897	            pass
898	        the_socket.close()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:904:12
903	                self._close_socket(self.device_socket)
904	            except:
905	                pass
906	            self.device_socket = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:963:16
962	                    # This will usually toss an exception if the socket is gone.
963	                except:
964	                    pass
965	            if (self.settings().extra_customization[self.OPT_AUTODISCONNECT] and

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:993:16
992	                    raise
993	                except:
994	                    pass
995	            except Queue.Empty:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:1029:25
1028	                challenge = isoformat(now())
1029	                hasher = hashlib.new('sha1')
1030	                hasher.update(password.encode('UTF-8'))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:1126:12
1125	                             'lastestKnownAppVersion': self.CURRENT_CC_VERSION})
1126	            except:
1127	                pass
1128	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:1180:20
1179	                                 'currentLibraryUUID': library_uuid})
1180	                    except:
1181	                        pass
1182	                    self._close_device_socket()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\smart_device_app\driver.py:1189:12
1188	                self.connection_attempts[peer] = 0
1189	            except:
1190	                pass
1191	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\devices\smart_device_app\driver.py:1920:56
1919	                    port = self._attach_to_port(self.listen_socket,
1920	                                    9090 if i == 1 else random.randint(8192, 32000))
1921	                    if port != 0:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\devices\usbms\driver.py:402:12
401	                os.removedirs(os.path.dirname(path))
402	            except:
403	                pass
404	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\__init__.py:85:4
84	def extract_cover_from_embedded_svg(html, base, log):
85	    from lxml import etree
86	    from calibre.ebooks.oeb.base import XPath, SVG, XLINK

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\__init__.py:87:11
86	    from calibre.ebooks.oeb.base import XPath, SVG, XLINK
87	    root = etree.fromstring(html)
88	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\__init__.py:134:8
133	                   os.path.dirname(path_to_html), log)
134	        except:
135	            pass
136	    if data is None:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\__init__.py:139:8
138	            data = extract_calibre_cover(raw, os.path.dirname(path_to_html), log)
139	        except:
140	            pass
141	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\__init__.py:239:4
238	        return float(value) * 72.0 / dpi
239	    except:
240	        pass
241	    result = value

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\chm\metadata.py:83:4
82	        return u'Published %s, %s pages.' % (date, pages)
83	    except:
84	        pass
85	    return None

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\chm\metadata.py:110:12
109	                r[0] = img['src']
110	            except:
111	                # Probably invalid width, height aattributes, ignore
112	                continue
113	        l = r.keys()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\chm\reader.py:132:16
131	                        html_files.add(lpath)
132	                except:
133	                    pass
134	            except:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\chm\reader.py:211:16
210	                        t[0].extract()
211	                except:
212	                    pass
213	            if (t[-1].nextSibling is None or t[-1].nextSibling.nextSibling is None):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\chm\reader.py:218:16
217	                        t[-1].extract()
218	                except:
219	                    pass
220	        # for some very odd reason each page's content appears to be in a table

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\chm\reader.py:258:8
257	                            soup.body.insert(tableIdx, tdContents.pop())
258	        except:
259	            pass
260	        # do not prettify, it would reformat the <pre> tags!

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\comic\input.py:137:12
136	                        self.opts.comic_image_size.split('x')])
137	            except:
138	                pass  # Ignore
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\conversion\cli.py:123:4
122	def recipe_test(option, opt_str, value, parser):
123	    assert value is None
124	    value = []

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\calibre\ebooks\conversion\config.py:87:16
86	        try:
87	            d = eval(raw)
88	        except (SyntaxError, TypeError):

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\chm_input.py:108:8
107	    def _create_html_root(self, hhcpath, log, encoding):
108	        from lxml import html
109	        from urllib import unquote as _unquote

--------------------------------------------------
>> Issue: [B410:blacklist] Using HTML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace HTML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\chm_input.py:160:16
159	            if toc.count() > 1:
160	                from lxml.html.builder import HTML, BODY, DIV, A
161	                path0 = toc[0].href

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\docx_output.py:75:8
74	    def convert_metadata(self, oeb):
75	        from lxml import etree
76	        from calibre.ebooks.oeb.base import OPF, OPF2_NS

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:41:8
40	    def process_encryption(self, encfile, opf, log):
41	        from lxml import etree
42	        import uuid, hashlib

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:46:23
45	            idpf_key = re.sub(u'[\u0020\u0009\u000d\u000a]', u'', idpf_key)
46	            idpf_key = hashlib.sha1(idpf_key.encode('utf-8')).digest()
47	        key = None

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:64:19
63	        try:
64	            root = etree.parse(encfile)
65	            for em in root.xpath('descendant::*[contains(name(), "EncryptionMethod")]'):

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:152:8
151	        removed = None
152	        from lxml import etree
153	        guide_cover, guide_elem = None, None

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:231:8
230	    def find_opf(self):
231	        from lxml import etree
232	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:239:23
238	            with open('META-INF/container.xml') as f:
239	                root = etree.fromstring(f.read())
240	                for r in root.xpath('//*[local-name()="rootfile"]'):

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:350:8
349	    def convert_epub3_nav(self, nav_path, opf, log):
350	        from lxml import etree
351	        from calibre.ebooks.chardet import xml_to_unicode

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\epub_input.py:360:14
359	        root = parse(raw, log=log)
360	        ncx = etree.fromstring('<ncx xmlns="http://www.daisy.org/z3986/2005/ncx/" version="2005-1" xml:lang="eng"><navMap/></ncx>')
361	        navmap = ncx[0]

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\epub_output.py:328:8
327	    def condense_ncx(self, ncx_path):
328	        from lxml import etree
329	        if not self.opts.pretty_print:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\epub_output.py:330:19
329	        if not self.opts.pretty_print:
330	            tree = etree.parse(ncx_path)
331	            for tag in tree.getroot().iter(tag=etree.Element):

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\fb2_input.py:39:8
38	                accelerators):
39	        from lxml import etree
40	        from calibre.ebooks.metadata.fb2 import ensure_namespace

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\fb2_input.py:51:18
50	        try:
51	            doc = etree.fromstring(raw)
52	        except etree.XMLSyntaxError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\fb2_input.py:54:22
53	            try:
54	                doc = etree.fromstring(raw, parser=RECOVER_PARSER)
55	                if doc is None:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\fb2_input.py:58:22
57	            except:
58	                doc = etree.fromstring(raw.replace('& ', '&amp;'),
59	                        parser=RECOVER_PARSER)
60	        if doc is None:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\fb2_input.py:95:19
94	
95	        styledoc = etree.fromstring(ss)
96	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\html_output.py:47:8
46	        '''
47	        from lxml import etree
48	        from urllib import unquote

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\html_output.py:72:8
71	    def generate_html_toc(self, oeb_book, ref_url, output_dir):
72	        from lxml import etree
73	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\html_output.py:79:8
78	    def convert(self, oeb_book, output_path, input_plugin, opts, log):
79	        from lxml import etree
80	        from calibre.utils import zipfile

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\htmlz_output.py:49:8
48	    def convert(self, oeb_book, output_path, input_plugin, opts, log):
49	        from lxml import etree
50	        from calibre.ebooks.oeb.base import OEB_IMAGES, SVG_MIME

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\lit_input.py:45:20
44	                    from calibre.ebooks.chardet import xml_to_unicode
45	                    from lxml import etree
46	                    import copy

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\lit_input.py:57:27
56	                        html = smarten_punctuation(html, self.log)
57	                    root = etree.fromstring(html)
58	                    body = XPath('//h:body')(root)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\lrf_input.py:22:8
21	                accelerators):
22	        from lxml import etree
23	        from calibre.ebooks.lrf.input import (MediaType, Styles, TextBlock,

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\lrf_input.py:35:18
34	        try:
35	            doc = etree.fromstring(xml, parser=parser)
36	        except:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\lrf_input.py:40:18
39	                    recover=True)
40	            doc = etree.fromstring(xml, parser=parser)
41	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\lrf_input.py:62:19
61	        self.log('Converting XML to HTML...')
62	        styledoc = etree.fromstring(P('templates/lrf.xsl', data=True))
63	        media_type = MediaType()

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\mobi_input.py:24:8
23	        from calibre.ebooks.mobi.reader.mobi6 import MobiReader
24	        from lxml import html
25	        parse_cache = {}

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\oeb_output.py:24:8
23	        from urllib import unquote
24	        from lxml import etree
25	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\pdf_output.py:162:12
161	            from calibre.ebooks.oeb.base import OPF, OPF2_NS
162	            from lxml import etree
163	            from io import BytesIO

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\conversion\plugins\pdf_output.py:207:20
206	                        src = s.getProperty('src').propertyValue[0].uri
207	                    except:
208	                        continue
209	                    path = item.abshref(src)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\conversion\plugins\pdf_output.py:219:24
218	                            nraw = remove_embed_restriction(raw)
219	                        except:
220	                            continue
221	                        if nraw != raw:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\calibre\ebooks\conversion\plugins\pdf_output.py:280:45
279	            cProfile.runctx('writer.dump(items, out_stream, PDFMetadata(self.metadata))',
280	                        globals(), locals(), '/tmp/profile')
281	        else:
282	            writer.dump(items, out_stream, PDFMetadata(self.metadata))

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\rtf_input.py:246:8
245	                accelerators):
246	        from lxml import etree
247	        from calibre.ebooks.metadata.meta import get_metadata

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\rtf_input.py:270:14
269	        parser = etree.XMLParser(recover=True, no_network=True)
270	        doc = etree.fromstring(xml, parser=parser)
271	        border_styles = self.convert_borders(doc)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\rtf_input.py:281:19
280	        inline_class = InlineClass(self.log)
281	        styledoc = etree.fromstring(P('templates/rtf.xsl', data=True))
282	        extensions = {('calibre', 'inline-class') : inline_class}

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\snb_input.py:33:8
32	        import uuid
33	        from lxml import etree
34	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\snb_input.py:53:19
52	        if meta is not None:
53	            meta = etree.fromstring(meta)
54	            l = {'title'    : './/head/name',

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\snb_input.py:88:22
87	            if toc is not None:
88	                toc = etree.fromstring(toc)
89	                i = 1

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\conversion\plugins\snb_input.py:97:27
96	                        continue
97	                    snbc = etree.fromstring(data)
98	                    outputFile = open(os.path.join(tdir, fname), 'wb')

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\snb_output.py:50:8
49	    def convert(self, oeb_book, output_path, input_plugin, opts, log):
50	        from lxml import etree
51	        from calibre.ebooks.snb.snbfile import SNBFile

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\calibre\ebooks\conversion\plugins\snb_output.py:270:18
269	    reader = OEBReader
270	    reader()(oeb, '/tmp/bbb/processed/')
271	    SNBOutput(None).convert(oeb, '/tmp/test.snb', None, None, default_log)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\calibre\ebooks\conversion\plugins\snb_output.py:271:33
270	    reader()(oeb, '/tmp/bbb/processed/')
271	    SNBOutput(None).convert(oeb, '/tmp/test.snb', None, None, default_log)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\conversion\plugins\txt_output.py:122:8
121	        from calibre.utils.zipfile import ZipFile
122	        from lxml import etree
123	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\conversion\plumber.py:997:8
996	            sys.stderr.flush()
997	        except:
998	            pass
999	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\djvu\djvu.py:116:8
115	        buf = self.instream.read(4)
116	        assert(buf == b'AT&T')
117	        buf = self.instream.read()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\docx\char_styles.py:133:8
132	            ans = float(val)/2.0
133	        except Exception:
134	            pass
135	    setattr(dest, 'position', ans)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\container.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\docx\container.py:26:11
25	def fromstring(raw, parser=RECOVER_PARSER):
26	    return etree.fromstring(raw, parser=parser)
27	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\dump.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\docx\dump.py:23:27
22	                if raw:
23	                    root = etree.fromstring(raw)
24	                    stream.seek(0)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\docx\fonts.py:49:4
48	        return sorted(find_fonts_matching(fonts, style, stretch), key=weight_key)[0]
49	    except Exception:
50	        pass
51	

--------------------------------------------------
>> Issue: [B410:blacklist] Using IMG to parse untrusted XML data is known to be vulnerable to XML attacks. Replace IMG with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\images.py:11:0
10	
11	from lxml.html.builder import IMG, HR
12	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\index.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B410:blacklist] Using XPath to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XPath with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\names.py:11:0
10	
11	from lxml.etree import XPath as X
12	

--------------------------------------------------
>> Issue: [B410:blacklist] Using OL to parse untrusted XML data is known to be vulnerable to XML attacks. Replace OL with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\numbering.py:13:0
12	
13	from lxml.html.builder import OL, UL, SPAN
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using TABLE to parse untrusted XML data is known to be vulnerable to XML attacks. Replace TABLE with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\tables.py:9:0
8	
9	from lxml.html.builder import TABLE, TR, TD
10	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\to_html.py:12:0
11	
12	from lxml import html
13	from lxml.html.builder import (

--------------------------------------------------
>> Issue: [B410:blacklist] Using HTML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace HTML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\to_html.py:13:0
12	from lxml import html
13	from lxml.html.builder import (
14	    HTML, HEAD, TITLE, BODY, LINK, META, P, SPAN, BR, DIV, SUP, A, DT, DL, DD, H1)
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\toc.py:12:0
11	
12	from lxml.etree import tostring
13	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\writer\container.py:11:0
10	
11	from lxml import etree
12	from lxml.builder import ElementMaker

--------------------------------------------------
>> Issue: [B410:blacklist] Using ElementMaker to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementMaker with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\writer\container.py:12:0
11	from lxml import etree
12	from lxml.builder import ElementMaker
13	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\writer\images.py:15:0
14	
15	from lxml import etree
16	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\docx\writer\images.py:29:4
28	        return float(x)
29	    except Exception:
30	        pass
31	    return 0

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\docx\writer\lists.py:103:12
102	                self.start = int(items[0].get('value'))
103	            except Exception:
104	                pass
105	        if list_type in {'disc', 'circle', 'square'}:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\docx\writer\styles.py:12:0
11	
12	from lxml import etree
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\docx\writer\tables.py:62:8
61	            return float(x.rstrip('%'))
62	        except Exception:
63	            pass
64	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\docx\writer\tables.py:77:12
76	                return ('dxa', int(float(tag_style['width']) * 20))
77	            except Exception:
78	                pass
79	    return ('auto', 0)

--------------------------------------------------
>> Issue: [B410:blacklist] Using XPath to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XPath with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\epub\pages.py:15:0
14	from calibre.ebooks.oeb.base import OEBBook
15	from lxml.etree import XPath
16	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\epub\periodical.py:89:4
88	        short_title = u':'.join(pt.split(':')[2:])
89	    except:
90	        pass
91	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\fb2\fb2ml.py:15:0
14	
15	from lxml import etree
16	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\fb2\fb2ml.py:67:82
66	        if self.opts.pretty_print:
67	            return u'<?xml version="1.0" encoding="UTF-8"?>\n%s' % etree.tostring(etree.fromstring(output), encoding=unicode, pretty_print=True)
68	        else:

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\html\__init__.py:16:4
15	    '''
16	    from lxml.etree import tostring as _tostring
17	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\htmlz\oeb2html.py:17:0
16	from functools import partial
17	from lxml import html
18	from urlparse import urldefrag

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\htmlz\oeb2html.py:102:20
101	                            continue
102	                    except:
103	                        continue
104	                    for attr in attribs:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\lrf\html\table.py:93:8
92	            self.rowspan = int(tag['rowspan']) if tag.has_key('rowspan') else 1  # noqa
93	        except:
94	            pass
95	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\lrf\input.py:12:0
11	
12	from lxml import etree
13	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\markdown\__version__.py:13:4
12	    " Returns a PEP 386-compliant version number from version_info. "
13	    assert len(version_info) == 5
14	    assert version_info[3] in ('alpha', 'beta', 'rc', 'final')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\markdown\__version__.py:14:4
13	    assert len(version_info) == 5
14	    assert version_info[3] in ('alpha', 'beta', 'rc', 'final')
15	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\markdown\serializers.py:199:4
198	                format="html"):
199	    assert root is not None
200	    data = []

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.cElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\src\calibre\ebooks\markdown\util.py:68:4
67	    # Is the C implementation of ElementTree available?
68	    import xml.etree.cElementTree as etree
69	    from xml.etree.ElementTree import Comment

--------------------------------------------------
>> Issue: [B405:blacklist] Using Comment to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Comment with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\src\calibre\ebooks\markdown\util.py:69:4
68	    import xml.etree.cElementTree as etree
69	    from xml.etree.ElementTree import Comment
70	    # Serializers (including ours) test with non-c Comment

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\src\calibre\ebooks\markdown\util.py:76:4
75	    # Use the Python implementation of ElementTree?
76	    import xml.etree.ElementTree as etree
77	    if etree.VERSION < "1.1":

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\__init__.py:347:4
346	            return isbn
347	    except:
348	        pass
349	    return None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\__init__.py:361:4
360	            return isbn
361	    except:
362	        pass
363	    return None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\__init__.py:390:4
389	            return issn
390	    except Exception:
391	        pass
392	    return None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\archive.py:36:4
35	        stream.seek(pos)
36	    except:
37	        pass
38	    return ans

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\archive.py:146:8
145	            mi.pubdate = dt
146	        except:
147	            pass
148	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\book\base.py:156:12
155	                return self.get_extra(field[:-6])
156	            except:
157	                pass
158	        raise AttributeError(

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\book\base.py:669:16
668	                    res = fmt.format(res)
669	                except:
670	                    pass
671	            return (name, unicode(res), orig_res, cmeta)

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\ebooks\metadata\book\render.py:9:0
8	
9	import os, cPickle
10	from functools import partial

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\book\render.py:39:8
38	            m = mi.metadata_for_field(k)
39	        except:
40	            continue
41	        if (

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\book\render.py:98:8
97	            metadata = mi.metadata_for_field(field)
98	        except:
99	            continue
100	        if not metadata:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\docx.py:12:0
11	
12	from lxml import etree
13	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\docx.py:31:12
30	                fmt, width, height = identify(bytes(raw))
31	            except Exception:
32	                continue
33	            if width < 0 or height < 0:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\docx.py:65:9
64	        ap_raw = None
65	    cp = etree.fromstring(dp_raw)
66	    update_doc_props(cp, mi, c.namespace)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\docx.py:69:13
68	    if ap_raw is not None:
69	        ap = etree.fromstring(ap_raw)
70	        comp = ap.makeelement('{%s}Company' % c.namespace.namespaces['ep'])

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\ereader.py:56:12
55	                mi.isbn = re.sub(r'[^a-zA-Z0-9 \._=\+\-!\?,\'\"]', '', mdata[4])
56	            except:
57	                pass
58	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\extz.py:43:20
42	                        mi.cover_data = (os.path.splitext(cover_href)[1], zf.read(cover_href))
43	                    except Exception:
44	                        pass
45	    except Exception:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\extz.py:68:8
67	            new_cdata = open(mi.cover, 'rb').read()
68	        except:
69	            pass
70	    if new_cdata:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\extz.py:88:4
87	            os.remove(replacements[cpath].name)
88	    except:
89	        pass
90	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\fb2.py:13:0
12	
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:107:4
106	        _parse_cover(root, mi, ctx)
107	    except:
108	        pass
109	    try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:111:4
110	        _parse_comments(root, mi, ctx)
111	    except:
112	        pass
113	    try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:115:4
114	        _parse_tags(root, mi, ctx)
115	    except:
116	        pass
117	    try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:119:4
118	        _parse_series(root, mi, ctx)
119	    except:
120	        pass
121	    try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:123:4
122	        _parse_isbn(root, mi, ctx)
123	    except:
124	        pass
125	    try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:127:4
126	        _parse_publisher(root, mi, ctx)
127	    except:
128	        pass
129	    try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:131:4
130	        _parse_pubdate(root, mi, ctx)
131	    except:
132	        pass
133	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:136:4
135	        _parse_language(root, mi, ctx)
136	    except:
137	        pass
138	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:202:8
201	            _parse_cover_data(root, imgid, mi, ctx)
202	        except:
203	            pass
204	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\fb2.py:252:12
251	                mi.series_index = float('.'.join(elms_sequence[0].get('number', None).split()[:2]))
252	            except Exception:
253	                pass
254	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\fb2.py:301:11
300	    raw = xml_to_unicode(raw, strip_encoding_pats=True)[0]
301	    root = etree.fromstring(raw, parser=parser)
302	    return ensure_namespace(root)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\ebooks\metadata\fb2.py:360:19
359	def _rnd_name(size=8, chars=ascii_letters + digits):
360	    return ''.join(random.choice(chars) for x in range(size))
361	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\fb2.py:429:14
428	        raw = re.sub(r'''<(description|body)\s+xmlns=['"]['"]>''', r'<\1>', raw)
429	        doc = etree.fromstring(raw)
430	    return doc

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\html.py:147:8
146	            val = parse_date(get(field))
147	        except:
148	            pass
149	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\html.py:162:12
161	                series_index = float(match.group(1))
162	            except:
163	                pass
164	            series = series.replace(match.group(), '').strip()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\html.py:170:12
169	                series_index = float(series_index)
170	            except:
171	                pass
172	        if series_index is not None:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\html.py:186:8
185	                mi.rating = 0
186	        except:
187	            pass
188	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\kfx.py:328:8
327	            mi.pubdate = parse_only_date(get('issue_date'))
328	        except Exception:
329	            pass
330	    if has('publisher') and get('publisher') != 'Unknown':

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\lit.py:32:16
31	                                   ctype))
32	                except:
33	                    pass
34	                break

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\lrx.py:12:0
11	from zlib import decompress
12	from lxml import etree
13	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\lrx.py:67:15
66	            raise ValueError('LRX file has malformed metadata section')
67	        root = etree.fromstring(info)
68	        bi = root.find('BookInfo')

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\meta.py:61:12
60	                mi.smart_update(newmi)
61	            except:
62	                continue
63	            if getattr(mi, 'application_id', None) is not None:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\meta.py:190:8
189	                mi.pubdate = parse_only_date(pubdate)
190	        except:
191	            pass
192	        try:

--------------------------------------------------
>> Issue: [B406:blacklist] Using xml.sax.saxutils to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.sax.saxutils with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\src\calibre\ebooks\metadata\odt.py:25:0
24	import zipfile, re
25	import xml.sax.saxutils
26	from cStringIO import StringIO

--------------------------------------------------
>> Issue: [B317:blacklist] Using xml.sax.make_parser to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.sax.make_parser with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-sax
   Location: .\src\calibre\ebooks\metadata\odt.py:165:13
164	    odfs = odfmetaparser()
165	    parser = xml.sax.make_parser()
166	    parser.setFeature(xml.sax.handler.feature_namespaces, True)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\odt.py:219:8
218	            read_cover(stream, zin, mi, opfmeta, extract_cover)
219	        except:
220	            pass  # Do not let an error reading the cover prevent reading other data
221	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\odt.py:245:8
244	            fmt, width, height = identify(bytes(raw))
245	        except Exception:
246	            continue
247	        imgnum += 1

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\odt.py:268:16
267	                    fmt = identify(bytes(raw))[0]
268	                except Exception:
269	                    pass
270	                else:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\opf.py:8:0
7	
8	from lxml import etree
9	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\opf3.py:12:0
11	
12	from lxml import etree
13	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:541:12
540	                return parse_date(val)
541	            except Exception:
542	                continue
543	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:567:16
566	                    return parse_date(val, is_w3cdtf=scheme == sq)
567	                except Exception:
568	                    continue
569	    for meta in XPath('./opf:metadata/opf:meta[@name="calibre:timestamp"]')(root):

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:574:12
573	                return parse_date(val, is_w3cdtf=True)
574	            except Exception:
575	                continue
576	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:605:16
604	                    return parse_date(val, is_w3cdtf=scheme == sq)
605	                except Exception:
606	                    continue
607	# }}}

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:690:16
689	                    return float(val)
690	                except Exception:
691	                    continue
692	    for meta in XPath('./opf:metadata/opf:meta[@name="calibre:rating"]')(root):

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:697:12
696	                return float(val)
697	            except Exception:
698	                continue
699	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:729:16
728	                    series_index = float(props.get('group-position').strip())
729	                except Exception:
730	                    pass
731	                return normalize_whitespace(val), series_index

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:736:8
735	            break
736	        except:
737	            pass
738	    for s in XPath('./opf:metadata/opf:meta[@name="calibre:series"]/@content')(root):

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:774:20
773	                            return ans
774	                    except Exception:
775	                        continue
776	        if try2:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\opf3.py:784:20
783	                            return ans
784	                    except Exception:
785	                        continue
786	    return reader

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\opf3_test.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\opf3_test.py:41:15
40	    def get_opf(self, metadata='', manifest=''):
41	        return etree.fromstring(TEMPLATE.format(metadata=metadata, manifest=manifest))
42	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\opf3_test.py:524:15
523	        mi2 = OPF(BytesIO(raw.encode('utf-8'))).to_book_metadata()
524	        root = etree.fromstring(raw)
525	        root.set('version', '3.0')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\ebooks\metadata\pdf.py:6:0
5	
6	import os, subprocess, shutil, re
7	from functools import partial

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\metadata\pdf.py:38:14
37	    try:
38	        raw = subprocess.check_output([pdfinfo, '-enc', 'UTF-8', '-isodates', 'src.pdf'])
39	    except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\metadata\pdf.py:62:14
61	    try:
62	        raw = subprocess.check_output([pdfinfo, '-meta', 'src.pdf']).strip()
63	    except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\metadata\pdf.py:75:12
74	        try:
75	            subprocess.check_call([pdftoppm, '-singlefile', '-jpeg', '-cropbox',
76	                'src.pdf', 'cover'])
77	        except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\metadata\pdf.py:91:8
90	    try:
91	        subprocess.check_call([pdftoppm, '-cropbox', '-jpeg', '-f', unicode(first),
92	                               '-l', unicode(last), pdfpath,
93	                               os.path.join(outputdir, 'page-images')], **args)
94	    except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\rtf.py:73:8
72	            return codec
73	        except:
74	            pass
75	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\metadata\search_internet.py:43:0
42	DEFAULT_AUTHOR_SOURCE = 'goodreads'
43	assert DEFAULT_AUTHOR_SOURCE in AUTHOR_SEARCHES
44	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\snb.py:12:0
11	from calibre.ebooks.snb.snbfile import SNBFile
12	from lxml import etree
13	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\snb.py:30:19
29	        if meta is not None:
30	            meta = etree.fromstring(meta)
31	            mi.title = meta.find('.//head/name').text

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\amazon.py:47:4
46	    from calibre.ebooks.chardet import xml_to_unicode
47	    from lxml.html import tostring
48	    log('Getting details from:', url)

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\amazon.py:132:8
131	        self.domain = domain
132	        from lxml.html import tostring
133	        self.tostring = tostring

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\sources\amazon.py:703:16
702	                    return json.loads(m.group(1))[0]['mainUrl']
703	                except Exception:
704	                    continue
705	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\sources\amazon.py:747:20
746	                        return url
747	                    except Exception:
748	                        pass
749	

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\amazon.py:1143:8
1142	    def parse_results_page(self, root, domain):  # {{{
1143	        from lxml.html import tostring
1144	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\big_book_search.py:16:4
15	    from mechanize import Request
16	    from lxml import html
17	    escaped = [quote_plus(x.encode('utf-8')) for x in tokens if x and x.strip()]

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\douban.py:46:4
45	def to_metadata(browser, log, entry_, timeout):  # {{{
46	    from lxml import etree
47	    from calibre.ebooks.chardet import xml_to_unicode

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\sources\douban.py:89:15
88	        raw = get_details(browser, id_url, timeout)
89	        feed = etree.fromstring(xml_to_unicode(clean_ascii_chars(raw),
90	            strip_encoding_pats=True)[0])
91	        extra = entry(feed)[0]

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\douban.py:281:8
280	            result_queue, timeout):
281	        from lxml import etree
282	        for relevance, i in enumerate(entries):

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\douban.py:305:8
304	            identifiers={}, timeout=30):
305	        from lxml import etree
306	        from calibre.ebooks.chardet import xml_to_unicode

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\sources\douban.py:325:19
324	            parser = etree.XMLParser(recover=True, no_network=True)
325	            feed = etree.fromstring(xml_to_unicode(clean_ascii_chars(raw),
326	                strip_encoding_pats=True)[0], parser=parser)
327	            entries = entry(feed)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\edelweiss.py:39:4
38	def astext(node):
39	    from lxml import etree
40	    return etree.tostring(node, method='text', encoding=unicode,

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\edelweiss.py:154:8
153	    def render_comments(self, desc):
154	        from lxml import etree
155	        from calibre.library.comments import sanitize_comments_html

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\google.py:49:8
48	    if ans is None:
49	        from lxml import etree
50	        ans = xpath_cache[x] = etree.XPath(x, namespaces=NAMESPACES)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\google.py:61:4
60	def to_metadata(browser, log, entry_, timeout):  # {{{
61	    from lxml import etree
62	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\sources\google.py:104:15
103	        raw = get_details(browser, id_url, timeout)
104	        feed = etree.fromstring(
105	            xml_to_unicode(clean_ascii_chars(raw), strip_encoding_pats=True)[0]
106	        )
107	        extra = entry(feed)[0]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\ebooks\metadata\sources\google.py:283:23
282	                if cdata:
283	                    if hashlib.md5(cdata).hexdigest() in self.DUMMY_IMAGE_MD5:
284	                        log.warning('Google returned a dummy image, ignoring')

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\google.py:316:8
315	    ):
316	        from lxml import etree
317	        for relevance, i in enumerate(entries):

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\google.py:350:8
349	    ):
350	        from lxml import etree
351	        entry = XPath('//atom:entry')

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\sources\google.py:369:19
368	            parser = etree.XMLParser(recover=True, no_network=True)
369	            feed = etree.fromstring(
370	                xml_to_unicode(clean_ascii_chars(raw), strip_encoding_pats=True)[0],
371	                parser=parser
372	            )
373	            entries = entry(feed)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\metadata\sources\google_images.py:90:12
89	                data = json.loads(div.text)
90	            except Exception:
91	                continue
92	            if 'ou' in data:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\sources\identify.py:560:8
559	                add(plugin.get_book_url_name(id_type, id_val, url), id_type, id_val, url)
560	        except Exception:
561	            pass
562	    isbn = identifiers.get('isbn', None)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\sources\isbndb.py:58:12
57	                prefs['isbndb_key'] = key
58	            except:
59	                pass
60	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\isbndb.py:123:8
122	    def parse_feed(self, feed, seen, orig_title, orig_authors, identifiers):
123	        from lxml import etree
124	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\isbndb.py:199:8
198	            max_pages=10, timeout=30):
199	        from lxml import etree
200	        from calibre.ebooks.chardet import xml_to_unicode

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\sources\isbndb.py:215:19
214	            raw = br.open_novisit(url, timeout=timeout).read()
215	            feed = etree.fromstring(xml_to_unicode(clean_ascii_chars(raw),
216	                strip_encoding_pats=True)[0], parser=parser)
217	            total, found, results = self.parse_feed(

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\ozon.py:118:8
117	        from HTMLParser import HTMLParser
118	        from lxml import etree, html
119	        import json

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\sources\ozon.py:382:8
381	                ozon_rating = float(rating)
382	        except:
383	            pass
384	        return ozon_rating

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\ozon.py:442:8
441	    def get_book_details(self, log, metadata, timeout, cachedPage):  # {{{
442	        from lxml import etree, html
443	        from calibre.ebooks.chardet import xml_to_unicode

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\ebooks\metadata\sources\ozon.py:559:7
558	    # Use Kovid's affiliate id 30% of the time.
559	    if random.randint(1, 10) in (1, 2, 3):
560	        aff_id = 'kovidgoyal'

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\sources\search_engines.py:15:0
14	
15	from lxml import etree
16	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\sources\search_engines.py:105:4
104	            return closest['url'].replace('http:', 'https:')
105	    except Exception:
106	        pass
107	    from pprint import pformat

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\sources\worker.py:69:12
68	                    identifiers=identifiers)
69	            except:
70	                pass
71	            if results:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\utils.py:10:0
9	
10	from lxml import etree
11	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\utils.py:48:11
47	    raw = raw[raw.find('<'):]
48	    root = etree.fromstring(raw, PARSER)
49	    if root is None:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\xmp.py:13:0
12	
13	from lxml import etree
14	from lxml.builder import ElementMaker

--------------------------------------------------
>> Issue: [B410:blacklist] Using ElementMaker to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementMaker with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\metadata\xmp.py:14:0
13	from lxml import etree
14	from lxml.builder import ElementMaker
15	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\xmp.py:76:15
75	    if enc is None:
76	        return etree.fromstring(raw_bytes)
77	    raw = _xml_declaration.sub('', raw_bytes.decode(enc))  # lxml barfs if encoding declaration present in unicode string

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\metadata\xmp.py:78:11
77	    raw = _xml_declaration.sub('', raw_bytes.decode(enc))  # lxml barfs if encoding declaration present in unicode string
78	    return etree.fromstring(raw)
79	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\xmp.py:223:8
222	            return parse_date(raw)
223	        except Exception:
224	            pass
225	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\xmp.py:262:4
261	        pubdate = parse_date(first_sequence('//dc:date', root) or first_simple('//xmp:CreateDate', root), assume_utc=False)
262	    except:
263	        pass
264	    else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\xmp.py:296:12
295	                setattr(mi, x, json.loads(val))
296	            except:
297	                pass
298	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\xmp.py:357:8
356	            info_date = parse_date(info['ModDate'])
357	        except Exception:
358	            pass
359	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\metadata\zip.py:39:28
38	                                return nmi
39	                            except:
40	                                pass
41	                        mi.timestamp = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\debug\main.py:25:4
24	        shutil.rmtree(ddir)
25	    except:
26	        pass
27	    os.makedirs(ddir)

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\mobi\debug\mobi6.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\debug\mobi6.py:777:16
776	                    fmt = what(None, r.raw)
777	                except:
778	                    pass
779	            if fmt is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\mobi\huffcdic.py:32:12
31	            codelen, term, maxcode = v&0x1f, v&0x80, v>>8
32	            assert codelen != 0
33	            if codelen <= 8:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\mobi\huffcdic.py:34:16
33	            if codelen <= 8:
34	                assert term
35	            maxcode = ((maxcode + 1) << (32 - codelen)) - 1

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:77:16
76	                    title = self.decode(content)
77	                except:
78	                    pass
79	            elif idx == 524:  # Lang code

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:85:16
84	                        self.mi.language = lang
85	                except:
86	                    pass
87	            elif idx == 525:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:92:16
91	                        self.primary_writing_mode = pwm
92	                except Exception:
93	                    pass
94	            elif idx == 527:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:99:16
98	                        self.page_progression_direction = ppd
99	                except Exception:
100	                    pass
101	            # else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:141:12
140	                self.mi.pubdate = parse_date(content, as_utc=False)
141	            except:
142	                pass
143	        elif idx == 108:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:161:12
160	                        self.mi.application_id = self.mi.uuid = cid
161	            except:
162	                pass
163	        elif idx == 113:  # ASIN or other id

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\headers.py:304:8
303	                return u'joint'
304	        except:
305	            pass
306	        return None

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\mobi\reader\mobi8.py:16:0
15	
16	from lxml import etree
17	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\reader\mobi8.py:503:12
502	                os.remove('debug-raw.html')
503	            except:
504	                pass
505	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\mobi\tweak.py:38:12
37	                os.remove('debug-raw.html')
38	            except:
39	                pass
40	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\mobi\writer2\indexer.py:707:12
706	                klass = self.cncx[sec.klass]
707	            except:
708	                continue
709	            if offset in seen_sec_offsets:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\mobi\writer2\indexer.py:721:16
720	                    klass = self.cncx[art.klass]
721	                except:
722	                    continue
723	                if offset in seen_art_offsets:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\ebooks\mobi\writer2\main.py:241:14
240	        ))  # 0 - 15 (0x0 - 0xf)
241	        uid = random.randint(0, 0xffffffff)
242	        title = normalize(unicode(metadata.title[0])).encode('utf-8')

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\calibre\ebooks\mobi\writer8\header.py:44:22
43	            if val:
44	                val = eval(val, {'zeroes':zeroes, 'NULL':NULL, 'DYN':None,
45	                    'nulls':nulls, 'short':short, 'random':random})
46	            else:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:380:4
379	    # calibre and kindlegen and compare the output
380	    import os, subprocess
381	    os.chdir('/t')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:389:4
388	
389	    subprocess.check_call(['ebook-convert', src, '.epub', '--level1-toc', '//h:p', '--no-default-epub-cover', '--flow-size', '1000000'])
390	    subprocess.check_call(['ebook-convert', src, '.azw3', '--level1-toc', '//h:p', '--no-inline-toc', '--extract-to=x'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:389:4
388	
389	    subprocess.check_call(['ebook-convert', src, '.epub', '--level1-toc', '//h:p', '--no-default-epub-cover', '--flow-size', '1000000'])
390	    subprocess.check_call(['ebook-convert', src, '.azw3', '--level1-toc', '//h:p', '--no-inline-toc', '--extract-to=x'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:390:4
389	    subprocess.check_call(['ebook-convert', src, '.epub', '--level1-toc', '//h:p', '--no-default-epub-cover', '--flow-size', '1000000'])
390	    subprocess.check_call(['ebook-convert', src, '.azw3', '--level1-toc', '//h:p', '--no-inline-toc', '--extract-to=x'])
391	    subprocess.call(['kindlegen', 'index.epub'])  # kindlegen exit code is not 0 as we dont have a cover

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:390:4
389	    subprocess.check_call(['ebook-convert', src, '.epub', '--level1-toc', '//h:p', '--no-default-epub-cover', '--flow-size', '1000000'])
390	    subprocess.check_call(['ebook-convert', src, '.azw3', '--level1-toc', '//h:p', '--no-inline-toc', '--extract-to=x'])
391	    subprocess.call(['kindlegen', 'index.epub'])  # kindlegen exit code is not 0 as we dont have a cover

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:391:4
390	    subprocess.check_call(['ebook-convert', src, '.azw3', '--level1-toc', '//h:p', '--no-inline-toc', '--extract-to=x'])
391	    subprocess.call(['kindlegen', 'index.epub'])  # kindlegen exit code is not 0 as we dont have a cover
392	    subprocess.check_call(['calibre-debug', 'index.mobi'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:391:4
390	    subprocess.check_call(['ebook-convert', src, '.azw3', '--level1-toc', '//h:p', '--no-inline-toc', '--extract-to=x'])
391	    subprocess.call(['kindlegen', 'index.epub'])  # kindlegen exit code is not 0 as we dont have a cover
392	    subprocess.check_call(['calibre-debug', 'index.mobi'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:392:4
391	    subprocess.call(['kindlegen', 'index.epub'])  # kindlegen exit code is not 0 as we dont have a cover
392	    subprocess.check_call(['calibre-debug', 'index.mobi'])
393	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\mobi\writer8\index.py:392:4
391	    subprocess.call(['kindlegen', 'index.epub'])  # kindlegen exit code is not 0 as we dont have a cover
392	    subprocess.check_call(['calibre-debug', 'index.mobi'])
393	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\mobi\writer8\main.py:18:0
17	from cssutils.css import CSSRule
18	from lxml import etree
19	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\ebooks\mobi\writer8\mobi.py:290:19
289	            self.extra_data_flags |= 0b10
290	        self.uid = random.randint(0, 0xffffffff)
291	

--------------------------------------------------
>> Issue: [B406:blacklist] Using escape to parse untrusted XML data is known to be vulnerable to XML attacks. Replace escape with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\src\calibre\ebooks\mobi\writer8\skeleton.py:13:0
12	from functools import partial
13	from xml.sax.saxutils import escape
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\mobi\writer8\skeleton.py:15:0
14	
15	from lxml import etree
16	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\mobi\writer8\toc.py:10:0
9	
10	from lxml import etree
11	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\mobi\writer8\toc.py:92:15
91	
92	        root = etree.fromstring(TEMPLATE.format(xhtmlns=XHTML_NS,
93	            title=self.title, embed_css=embed_css,
94	            extra_css=(opts.extra_css or '')))
95	        parent = XPath('//h:ul')(root)[0]

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\odt\input.py:11:0
10	
11	from lxml import etree
12	from cssutils import CSSParser

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\odt\input.py:47:15
46	    def fix_markup(self, html, log):
47	        root = etree.fromstring(html)
48	        self.filter_css(root, log)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\odt\input.py:260:8
259	            self.filter_cover(mi, log)
260	        except:
261	            pass
262	        # parse the modified tree and generate xhtml

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\base.py:15:0
14	
15	from lxml import etree, html
16	from calibre.constants import filesystem_encoding, __version__

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\ebooks\oeb\base.py:135:4
134	    '''
135	    assert etree.iselement(root)
136	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\base.py:141:8
140	            tag = barename(el.tag).lower()
141	        except Exception:
142	            continue
143	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\base.py:268:12
267	                stext = parser.parseStyle(text, validate=False)
268	            except Exception:
269	                # Parsing errors are raised by cssutils
270	                continue
271	            replaceUrls(stext, link_repl_func)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\base.py:602:20
601	                        fname = fname.decode(filesystem_encoding)
602	                    except:
603	                        continue
604	                names.append(fname)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\base.py:938:19
937	                return None
938	            return etree.fromstring(data, parser=RECOVER_PARSER)
939	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\base.py:1825:12
1824	                os.remove(path)
1825	            except:
1826	                pass
1827	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\iterator\book.py:222:16
221	                    p = urlparse(urlunquote(link))
222	                except Exception:
223	                    continue
224	                if not p.scheme and not p.netloc:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\iterator\book.py:228:20
227	                        path = spine_paths[path]
228	                    except Exception:
229	                        continue
230	                    if not p.fragment or p.fragment in path.anchor_map:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\iterator\book.py:238:12
237	                os.remove(x)
238	            except:
239	                pass

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\iterator\bookmarks.py:33:16
32	                    spine = int(spine.strip())
33	                except:
34	                    continue
35	                bm = {'type':'legacy', 'title':title, 'spine':spine, 'pos':pos}

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\iterator\bookmarks.py:40:16
39	                    spine = int(spine)
40	                except:
41	                    continue
42	                # Unescape from serialization

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\iterator\bookmarks.py:47:16
46	                    pos = float(pos)
47	                except:
48	                    pass
49	                bm = {'type':'cfi', 'title':title, 'pos':pos, 'spine':spine}

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:12:0
11	
12	from lxml import etree, html
13	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:124:15
123	    try:
124	        data = etree.fromstring(data, parser=parser)
125	    except etree.XMLSyntaxError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:126:15
125	    except etree.XMLSyntaxError:
126	        data = etree.fromstring(data, parser=RECOVER_PARSER)
127	    return data

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:213:15
212	    try:
213	        data = etree.fromstring(data, parser=parser)
214	        check_for_html5(pre, data)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:220:19
219	        try:
220	            data = etree.fromstring(data, parser=parser)
221	            check_for_html5(pre, data)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:242:12
241	                    x.attrib[key] = val
242	            except:
243	                pass
244	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:249:16
248	        log.warn('File %r does not appear to be (X)HTML'%filename)
249	        nroot = etree.fromstring('<html></html>')
250	        has_body = False

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:258:20
257	            log.warn('File %r appears to be a HTML fragment'%filename)
258	            nroot = etree.fromstring('<html><body/></html>')
259	            parent = nroot[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:274:19
273	        try:
274	            data = etree.fromstring(data, parser=parser)
275	        except:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:279:23
278	            try:
279	                data = etree.fromstring(data, parser=parser)
280	            except etree.XMLSyntaxError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:290:27
289	                try:
290	                    data = etree.fromstring(data,
291	                            parser=RECOVER_PARSER)
292	                except etree.XMLSyntaxError:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\parse_utils.py:295:27
294	                    data = re.sub(r'<meta\s+[^>]+?>', '', data)
295	                    data = etree.fromstring(data, parser=RECOVER_PARSER)
296	    elif namespace(data.tag) != XHTML_NS:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\polish\check\fonts.py:109:12
108	                sheets.append((name, container.parsed(name), None))
109	            except Exception:
110	                pass  # Could not parse, ignore
111	        elif mt in OEB_DOCS:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\check\opf.py:9:0
8	
9	from lxml import etree
10	

--------------------------------------------------
>> Issue: [B410:blacklist] Using XMLParser to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XMLParser with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\check\parsing.py:11:0
10	
11	from lxml.etree import XMLParser, fromstring, XMLSyntaxError
12	import cssutils

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\polish\check\parsing.py:277:15
276	    try:
277	        root = fromstring(eraw, parser=parser)
278	    except UnicodeDecodeError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\container.py:23:0
22	from cssutils import getUrls, replaceUrls
23	from lxml import etree
24	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\polish\container.py:197:15
196	        data = unicodedata.normalize('NFC', data)
197	        return etree.fromstring(data, parser=RECOVER_PARSER)
198	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\polish\container.py:1083:12
1082	                dirnames.remove(vcsdir)
1083	            except Exception:
1084	                pass
1085	        is_root = os.path.abspath(os.path.normcase(dirpath)) == os.path.abspath(os.path.normcase(basedir))

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\polish\container.py:1156:20
1155	            raise InvalidEpub('No META-INF/container.xml in epub')
1156	        container = etree.fromstring(open(container_path, 'rb').read())
1157	        opf_files = container.xpath((

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\ebooks\oeb\polish\container.py:1270:23
1269	            idpf_key = re.sub(u'[\u0020\u0009\u000d\u000a]', u'', idpf_key)
1270	            idpf_key = hashlib.sha1(idpf_key.encode('utf-8')).digest()
1271	        key = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\polish\css.py:366:12
365	                tertiary = text_sort_key(rule.style.getPropertyValue('font-family'))
366	            except Exception:
367	                pass
368	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\polish\download.py:86:8
85	            self.progress_report(self.url, self.fobj.tell(), self.sz)
86	        except Exception:
87	            pass
88	        return ret

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\embed.py:13:0
12	
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\polish\embed.py:58:4
57	        return int(val)
58	    except Exception:
59	        pass
60	    try:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\opf.py:9:0
8	
9	from lxml import etree
10	

--------------------------------------------------
>> Issue: [B410:blacklist] Using XMLParser to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XMLParser with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\parsing.py:11:0
10	
11	from lxml.etree import XMLParser, fromstring, Element as LxmlElement
12	import html5_parser

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\polish\parsing.py:68:14
67	        parser = XMLParser(no_network=True)
68	        ans = fromstring(raw, parser=parser)
69	        if ans.tag != '{%s}html' % XHTML_NS:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\parsing.py:83:4
82	if __name__ == '__main__':
83	    from lxml import etree
84	    root = parse_html5('\n<html><head><title>a\n</title><p b=1 c=2 a=0>&nbsp;\n<b>b<svg ass="wipe" viewbox="0">', discard_namespaces=False)

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\stats.py:13:0
12	
13	from lxml.etree import tostring
14	import regex

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\ebooks\oeb\polish\tests\container.py:9:0
8	
9	import os, subprocess
10	from zipfile import ZipFile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ebooks\oeb\polish\tests\container.py:90:16
89	            if vim:
90	                subprocess.Popen(['vim', '-f', f]).wait()
91	            if epubcheck:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\oeb\polish\tests\container.py:90:16
89	            if vim:
90	                subprocess.Popen(['vim', '-f', f]).wait()
91	            if epubcheck:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ebooks\oeb\polish\tests\container.py:92:16
91	            if epubcheck:
92	                subprocess.Popen(['epubcheck', f]).wait()
93	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ebooks\oeb\polish\tests\container.py:92:16
91	            if epubcheck:
92	                subprocess.Popen(['epubcheck', f]).wait()
93	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\tests\parsing.py:11:0
10	
11	from lxml import etree
12	from html5lib.constants import cdataElements, rcdataElements

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\toc.py:17:0
16	
17	from lxml import etree
18	from lxml.builder import ElementMaker

--------------------------------------------------
>> Issue: [B410:blacklist] Using ElementMaker to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementMaker with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\polish\toc.py:18:0
17	from lxml import etree
18	from lxml.builder import ElementMaker
19	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\cover.py:11:0
10	
11	from lxml import etree
12	from calibre import guess_type

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\transforms\cover.py:157:29
156	                item = m.add(id, href, guess_type('t.xhtml')[0],
157	                        data=etree.fromstring(tp))
158	        else:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\embed_fonts.py:13:0
12	import cssutils
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\filenames.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\flatcss.py:13:0
12	
13	from lxml import etree
14	import cssutils

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\transforms\flatcss.py:572:12
571	                x = x.lower()
572	            except Exception:
573	                pass
574	            return x

--------------------------------------------------
>> Issue: [B406:blacklist] Using escape to parse untrusted XML data is known to be vulnerable to XML attacks. Replace escape with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\src\calibre\ebooks\oeb\transforms\jacket.py:10:0
9	import sys, os, re
10	from xml.sax.saxutils import escape
11	from string import Formatter

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\jacket.py:13:0
12	
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\transforms\jacket.py:277:12
276	                args[dkey+'_label'] = escape(display_name)
277	            except Exception:
278	                # if the val (custom column contents) is None, don't add to args
279	                pass
280	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\transforms\jacket.py:325:15
324	    try:
325	        root = etree.fromstring(generate_html(comments), parser=RECOVER_PARSER)
326	    except:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\transforms\jacket.py:328:19
327	        try:
328	            root = etree.fromstring(generate_html(escape(orig_comments)),
329	                parser=RECOVER_PARSER)
330	        except:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\oeb\transforms\jacket.py:331:19
330	        except:
331	            root = etree.fromstring(generate_html(''),
332	                parser=RECOVER_PARSER)
333	    if rescale_fonts:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\manglecase.py:9:0
8	
9	from lxml import etree
10	from calibre.ebooks.oeb.base import XHTML, XHTML_NS

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\metadata.py:169:8
168	        from calibre.ebooks.oeb.base import XPath, XLINK
169	        from lxml import etree
170	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\transforms\metadata.py:186:16
185	                    href = item.abshref(href)
186	                except Exception:
187	                    continue  # Invalid URL, ignore
188	                if href == cover_item.href:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\transforms\page_margin.py:88:16
87	                    ti = style['text-indent']
88	                except:
89	                    pass
90	                else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\oeb\transforms\rasterize.py:59:12
58	                os.remove(pt)
59	            except:
60	                pass
61	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\transforms\rescale.py:50:16
49	                    img = Image.open(BytesIO(raw))
50	                except Exception:
51	                    continue
52	                width, height = img.size

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\oeb\transforms\structure.py:11:0
10	
11	from lxml import etree
12	from urlparse import urlparse

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\oeb\transforms\trimmanifest.py:56:24
55	                            href = item.abshref(urlnormalize(href))
56	                        except:
57	                            continue
58	                        if href in oeb.manifest.hrefs:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\pdf\reflow.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\pdf\reflow.py:623:20
622	        parser = etree.XMLParser(recover=True)
623	        self.root = etree.fromstring(xml, parser=parser)
624	        idc = iter(xrange(sys.maxint))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\pdf\render\from_html.py:47:16
46	                    height = float(height.replace(',', '.'))
47	                except:
48	                    pass
49	                else:

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\pdf\render\toc.py:11:0
10	
11	from lxml.html import tostring
12	from lxml.html.builder import (HTML, HEAD, BODY, TABLE, TR, TD, H2, STYLE)

--------------------------------------------------
>> Issue: [B410:blacklist] Using HTML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace HTML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\pdf\render\toc.py:12:0
11	from lxml.html import tostring
12	from lxml.html.builder import (HTML, HEAD, BODY, TABLE, TR, TD, H2, STYLE)
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\pml\__init__.py:55:4
54	            return '\\a%i' % val
55	    except:
56	        pass
57	    val = ord(char)

--------------------------------------------------
>> Issue: [B410:blacklist] Using Cleaner to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Cleaner with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\readability\cleaners.py:3:0
2	import re
3	from lxml.html.clean import Cleaner
4	

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\readability\htmls.py:3:0
2	
3	from lxml.html import tostring
4	import lxml.html

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\readability\htmls.py:4:0
3	from lxml.html import tostring
4	import lxml.html
5	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-open_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\add_brackets.py:99:32
98	        """
99	        if self.__token_info == 'mi<mk<body-open_':
100	            self.__state = 'in_body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\add_brackets.py:119:34
118	            self.__write_obj.write(line)
119	        elif self.__token_info == 'ob<nu<open-brack':
120	            self.__found_brackets = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\add_brackets.py:143:36
142	            self.__write_obj.write(line)
143	            if self.__token_info == 'ob<nu<open-brack':
144	                self.__state = 'in_ignore'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\add_brackets.py:189:32
188	        self.__write_obj.write(line)
189	        if self.__token_info == 'cb<nu<clos-brack'\
190	            and self.__cb_count == self.__ignore_count:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\add_brackets.py:208:44
207	                    self.__token_info = line[:16]
208	                    if self.__token_info == 'ob<nu<open-brack':
209	                        self.__ob_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\add_brackets.py:210:44
209	                        self.__ob_count = line[-5:-1]
210	                    if self.__token_info == 'cb<nu<clos-brack':
211	                        self.__cb_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\check_brackets.py:48:40
47	                self.__token_info = line[:16]
48	                if self.__token_info == 'ob<nu<open-brack':
49	                    self.open_brack(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\check_brackets.py:50:40
49	                    self.open_brack(line)
50	                if self.__token_info == 'cb<nu<clos-brack':
51	                    if not self.close_brack(line):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-open_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:96:32
95	        """
96	        if self.__token_info == 'mi<mk<body-open_':
97	            self.__state = 'body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<ml<colon_____'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:198:29
197	            token_info = line[:16]
198	            if token_info == 'cw<ml<colon_____':
199	                found_sub = 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:220:29
219	            token_info = line[:16]
220	            if token_info == 'ob<nu<open-brack':
221	                bracket_count += 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:222:29
221	                bracket_count += 1
222	            if token_info == 'cb<nu<clos-brack':
223	                bracket_count -= 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:225:72
224	            if in_see:
225	                if bracket_count == end_bracket_count and token_info == 'cb<nu<clos-brack':
226	                    in_see = 0

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'tx<nu<__________'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:228:37
227	                else:
228	                    if token_info == 'tx<nu<__________':
229	                        see_string += line[17:]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<in<index-see_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:231:33
230	            else:
231	                if token_info == 'cw<in<index-see_':
232	                    end_bracket_count = bracket_count - 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:254:29
253	            token_info = line[:16]
254	            if token_info == 'ob<nu<open-brack':
255	                bracket_count += 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:256:29
255	                bracket_count += 1
256	            if token_info == 'cb<nu<clos-brack':
257	                bracket_count -= 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:259:72
258	            if in_bookmark:
259	                if bracket_count == end_bracket_count and token_info == 'cb<nu<clos-brack':
260	                    in_bookmark = 0

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'tx<nu<__________'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:263:37
262	                else:
263	                    if token_info == 'tx<nu<__________':
264	                        bookmark_string += line[17:]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<an<place_____'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:268:33
267	            else:
268	                if token_info == 'cw<an<place_____':
269	                    end_bracket_count = bracket_count - 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<in<index-bold'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:280:29
279	            token_info = line[:16]
280	            if token_info == 'cw<in<index-bold':
281	                bold = 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<in<index-ital'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:282:29
281	                bold = 1
282	            if token_info == 'cw<in<index-ital':
283	                italics = 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tc<toc-level_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:310:29
309	                main_entry += line[17:]
310	            if token_info == 'cw<tc<toc-level_':
311	                toc_level = line[20:]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tc<toc-sup-nu'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:312:29
311	                toc_level = line[20:]
312	            if token_info == 'cw<tc<toc-sup-nu':
313	                toc_suppress = 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:341:29
340	            token_info = line[:16]
341	            if token_info == 'ob<nu<open-brack':
342	                bracket_count += 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:343:29
342	                bracket_count += 1
343	            if token_info == 'cb<nu<clos-brack':
344	                bracket_count -= 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:346:72
345	            if in_bookmark:
346	                if bracket_count == end_bracket_count and token_info == 'cb<nu<clos-brack':
347	                    in_bookmark = 0

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'tx<nu<__________'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:350:37
349	                else:
350	                    if token_info == 'tx<nu<__________':
351	                        if book_type == 'start':

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<an<book-mk-st'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:358:33
357	            else:
358	                if token_info == 'cw<an<book-mk-st' or token_info =='cw<an<book-mk-en':
359	                    if token_info == 'cw<an<book-mk-st':

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<an<book-mk-en'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:358:68
357	            else:
358	                if token_info == 'cw<an<book-mk-st' or token_info =='cw<an<book-mk-en':
359	                    if token_info == 'cw<an<book-mk-st':

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<an<book-mk-st'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:359:37
358	                if token_info == 'cw<an<book-mk-st' or token_info =='cw<an<book-mk-en':
359	                    if token_info == 'cw<an<book-mk-st':
360	                        book_type = 'start'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<an<book-mk-en'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:361:37
360	                        book_type = 'start'
361	                    if token_info == 'cw<an<book-mk-en':
362	                        book_type = 'end'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:445:44
444	                    self.__token_info = line[:16]
445	                    if self.__token_info == 'ob<nu<open-brack':
446	                        self.__ob_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\fields_small.py:447:44
446	                        self.__ob_count = line[-5:-1]
447	                    if self.__token_info == 'cb<nu<clos-brack':
448	                        self.__cb_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<nt<type______'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:44:32
43	        """
44	        if self.__token_info == 'cw<nt<type______':
45	            self.__write_to_foot_obj.write(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<ci<footnot-mk'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:56:32
55	            self.__first_line_func(line)
56	        if self.__token_info == 'cw<ci<footnot-mk':
57	            num = str(self.__footnote_count)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<nt<footnote__'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:90:32
89	        """Handle all tokens that are not footnote tokens"""
90	        if self.__token_info == 'cw<nt<footnote__':
91	            self.__found_footnote(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<ci<footnot-mk'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:93:32
92	        self.__write_obj.write(line)
93	        if self.__token_info == 'cw<ci<footnot-mk':
94	            num = str(self.__footnote_count + 1)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:127:48
126	                        # keep track of opening and closing brackets
127	                        if self.__token_info == 'ob<nu<open-brack':
128	                            self.__ob_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:129:48
128	                            self.__ob_count = line[-5:-1]
129	                        if self.__token_info == 'cb<nu<clos-brack':
130	                            self.__cb_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<footnt-beg'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:169:32
168	        # mi<mk<footnt-end
169	        if self.__token_info == 'mi<mk<footnt-beg':
170	            self.__state = 'foot'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<footnt-end'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\footnote.py:178:32
177	        """
178	        if self.__token_info == 'mi<mk<footnt-end':
179	            self.__state = 'body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\header.py:129:48
128	                        # keep track of opening and closing brackets
129	                        if self.__token_info == 'ob<nu<open-brack':
130	                            self.__ob_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\header.py:131:48
130	                            self.__ob_count = line[-5:-1]
131	                        if self.__token_info == 'cb<nu<clos-brack':
132	                            self.__cb_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<header-beg'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\header.py:168:32
167	        # mi<mk<footnt-end
168	        if self.__token_info == 'mi<mk<header-beg':
169	            self.__state = 'head'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<header-end'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\header.py:177:32
176	        """
177	        if self.__token_info == 'mi<mk<header-end':
178	            self.__state = 'body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:154:32
153	            """
154	        if self.__token_info == 'mi<mk<sect-start':
155	            self.__section_num[0] += 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<tabl-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:157:32
156	            self.__section_num = self.__section_num[0:1]
157	        if self.__token_info == 'mi<mk<tabl-start':
158	            self.__state = 'in_table'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<list_start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:159:34
158	            self.__state = 'in_table'
159	        elif self.__token_info == 'mi<mk<list_start':
160	            self.__state = 'in_list'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<style-name'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:164:34
163	            self.__close_sections(0)
164	        elif self.__token_info == 'mi<mk<style-name':
165	            name = line[17:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:168:32
167	                self.__handle_heading(name)
168	        if self.__token_info == 'mi<mk<body-close':
169	            self.__state = 'after_body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<table-end_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:185:32
184	    def __in_table_func(self, line):
185	        if self.__token_info == 'mi<mk<table-end_':
186	            self.__state = 'default'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<list_close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:190:32
189	    def __in_list_func(self, line):
190	        if self.__token_info == 'mi<mk<list_close':
191	            self.__list_depth -= 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<list_start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\headings_to_sections.py:192:34
191	            self.__list_depth -= 1
192	        elif self.__token_info == 'mi<mk<list_start':
193	            self.__list_depth += 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<ls<list-text_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\list_numbers.py:72:32
71	            """
72	        if self.__token_info == 'cw<ls<list-text_':
73	            self.__state = 'list_text'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<pf<par-def___'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\list_numbers.py:142:32
141	            self.__write_obj.write('mi<mk<list-type_<%s\n' % self.__list_type)
142	        if self.__token_info != 'cw<pf<par-def___':
143	            self.__list_chunk = self.__list_chunk + line

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\list_numbers.py:156:32
155	            """
156	        if self.__token_info == 'ob<nu<open-brack':
157	            self.__state = 'after_ob'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\list_numbers.py:187:36
186	            self.__token_info = line[:16]
187	            if self.__token_info == 'ob<nu<open-brack':
188	                self.__ob_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\list_numbers.py:189:36
188	                self.__ob_count = line[-5:-1]
189	            if self.__token_info == 'cb<nu<clos-brack':
190	                self.__cb_count = line[-5:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<pard-end__'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\make_lists.py:121:32
120	        """
121	        if self.__token_info == 'mi<mk<pard-end__':
122	            self.__state = 'after_pard'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<tg<open-att__'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\make_lists.py:144:32
143	        """
144	        if self.__token_info == 'mi<tg<open-att__' and line[17:37] == 'paragraph-definition':
145	            is_heading = self.__is_a_heading()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<tg<open-att__'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\make_lists.py:394:32
393	            """
394	        if self.__token_info == 'mi<tg<open-att__' and line[17:37] == 'paragraph-definition':
395	            is_a_heading = self.__is_a_heading()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<left_inden'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\make_lists.py:420:32
419	    def __get_indent(self, line):
420	        if self.__token_info == 'mi<mk<left_inden':
421	            self.__left_indent = float(line[17:-1])

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<list-type_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\make_lists.py:424:32
423	    def __get_list_type(self, line):
424	        if self.__token_info == 'mi<mk<list-type_':  # <ordered
425	            self.__list_type = line[17:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<style-name'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\make_lists.py:430:32
429	    def __get_style_name(self, line):
430	        if self.__token_info == 'mi<mk<style-name':
431	            self.__style_name = line[17:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:76:32
75	    def __initiate_values(self):
76	        self.__previous_token = ''
77	        self.__state = 'before_body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<pf<par-def___'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:87:35
86	                self.__found_new += 1
87	        elif self.__token_info ==  'cw<pf<par-def___':
88	            self.__state = 'after_pard'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-open_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:91:32
90	    def __before_body_func(self, line):
91	        if self.__token_info == 'mi<mk<body-open_':
92	            self.__state = 'in_body'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:113:40
112	                self.__token_info = line[:16]
113	                if self.__token_info == 'mi<mk<body-close':
114	                    return False

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ob<nu<open-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:115:40
114	                    return False
115	                if self.__token_info == 'ob<nu<open-brack':
116	                    self.__ob_group += 1

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cb<nu<clos-brack'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:118:40
117	                    self.__ob_count = line[-5:-1]
118	                if self.__token_info == 'cb<nu<clos-brack':
119	                    self.__ob_group -= 1

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\rtf2xml\old_rtf.py:128:20
127	                        sys.stderr.write('No action for this state!\n')
128	                    except:
129	                        pass
130	                result = action(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-open_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\paragraphs.py:117:32
116	        """
117	        if self.__token_info == 'mi<mk<body-open_':
118	            self.__state = 'not_paragraph'

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\rtf2xml\paragraphs.py:254:24
253	                            sys.stderr.write(self.__state + '\n')
254	                        except:
255	                            pass
256	                    action(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<listabend_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\preamble_rest.py:105:32
104	    def __list_table_func(self, line):
105	        if self.__token_info == 'mi<mk<listabend_':
106	            self.__state = 'default'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<revtbl-end'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\preamble_rest.py:116:32
115	    def __revision_table_func(self, line):
116	        if self.__token_info == 'mi<mk<revtbl-end':
117	            self.__state = 'default'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<not-in-tbl'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:121:32
120	        # 'cell'               :	('tb', 'cell______', self.default_func),
121	        if self.__token_info == 'mi<mk<not-in-tbl' or\
122	            self.__token_info == 'mi<mk<sect-start' or\

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:122:33
121	        if self.__token_info == 'mi<mk<not-in-tbl' or\
122	            self.__token_info == 'mi<mk<sect-start' or\
123	            self.__token_info == 'mi<mk<sect-close' or\

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:123:33
122	            self.__token_info == 'mi<mk<sect-start' or\
123	            self.__token_info == 'mi<mk<sect-close' or\
124	            self.__token_info == 'mi<mk<body-close':

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:124:33
123	            self.__token_info == 'mi<mk<sect-close' or\
124	            self.__token_info == 'mi<mk<body-close':
125	            self.__close_table(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<pard-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:126:34
125	            self.__close_table(line)
126	        elif self.__token_info == 'mi<mk<pard-start':
127	            self.__start_row_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<row-def___'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:129:34
128	            self.__start_cell_func(line)
129	        elif self.__token_info == 'cw<tb<row-def___':
130	            self.__found_row_def_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<cell______'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:131:34
130	            self.__found_row_def_func(line)
131	        elif self.__token_info == 'cw<tb<cell______':
132	            self.__start_row_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<row_______'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:258:32
257	        """
258	        if self.__token_info == 'cw<tb<row_______':
259	            # write tags

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<not-in-tbl'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:267:34
266	            self.__write_obj.write(line)
267	        elif self.__token_info == 'mi<mk<not-in-tbl' and 'in_table' in self.__state:
268	            self.__end_row_def_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<pard-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:271:34
270	            self.__write_obj.write(line)
271	        elif self.__token_info == 'mi<mk<pard-start':
272	            self.__end_row_def_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<in-table__'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:278:34
277	            self.__write_obj.write(line)
278	        elif self.__token_info == 'mi<mk<in-table__':
279	            self.__end_row_def_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<cell-posit'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:319:34
318	        # cw<tb<cell-posit<nu<216.00
319	        elif self.__token_info == 'cw<tb<cell-posit':
320	            self.__found_cell_position(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<row-pos-le'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:322:34
321	        # cw<tb<row-pos-le<nu<-5.40
322	        elif self.__token_info == 'cw<tb<row-pos-le':
323	            position = line[20:-1]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<row-header'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:325:34
324	            self.__row_dict['left-row-position'] = position
325	        elif self.__token_info == 'cw<tb<row-header':
326	            self.__row_dict['header'] = 'true'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<not-in-tbl'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:425:32
424	        # mi<mk<sect-start
425	        if self.__token_info == 'mi<mk<not-in-tbl' or\
426	            self.__token_info == 'mi<mk<sect-start' or\

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:426:33
425	        if self.__token_info == 'mi<mk<not-in-tbl' or\
426	            self.__token_info == 'mi<mk<sect-start' or\
427	            self.__token_info == 'mi<mk<sect-close' or\

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:427:33
426	            self.__token_info == 'mi<mk<sect-start' or\
427	            self.__token_info == 'mi<mk<sect-close' or\
428	            self.__token_info == 'mi<mk<body-close':

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:428:33
427	            self.__token_info == 'mi<mk<sect-close' or\
428	            self.__token_info == 'mi<mk<body-close':
429	            self.__end_cell_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'cw<tb<cell______'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:433:35
432	            self.__write_obj.write(line)
433	        elif self.__token_info ==  'cw<tb<cell______':
434	            self.__end_cell_func(line)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<not-in-tbl'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:455:32
454	    def __in_row_func(self, line):
455	        if self.__token_info == 'mi<mk<not-in-tbl' or\
456	            self.__token_info == 'mi<mk<sect-start' or\

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:456:33
455	        if self.__token_info == 'mi<mk<not-in-tbl' or\
456	            self.__token_info == 'mi<mk<sect-start' or\
457	            self.__token_info == 'mi<mk<sect-close' or\

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<sect-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:457:33
456	            self.__token_info == 'mi<mk<sect-start' or\
457	            self.__token_info == 'mi<mk<sect-close' or\
458	            self.__token_info == 'mi<mk<body-close':

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mi<mk<body-close'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\ebooks\rtf2xml\table.py:458:33
457	            self.__token_info == 'mi<mk<sect-close' or\
458	            self.__token_info == 'mi<mk<body-close':
459	            self.__end_row_func(line)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\rtf\input.py:6:0
5	
6	from lxml import etree
7	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\snb\snbml.py:14:0
13	
14	from lxml import etree
15	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\snb\snbml.py:99:48
98	        output.append(u'%s%s\n\n' % (CALIBRE_SNB_BM_TAG, ""))
99	        output += self.dump_text(self.subitems, etree.fromstring(content), stylizer)[0]
100	        output = self.cleanup_text(u''.join(output))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\txt\processor.py:142:16
141	                    val = max(0, min(int(float(val)), 10))
142	                except Exception:
143	                    continue
144	            if mf.get('datatype') == 'datetime':

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\ebooks\txt\processor.py:147:16
146	                    val = parse_only_date(val, assume_utc=False)
147	                except Exception:
148	                    continue
149	            setattr(mi, k, val)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\ebooks\txt\txtml.py:13:0
12	
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\ebooks\txt\txtml.py:77:22
76	            content = self.remove_newlines(content)
77	            content = etree.fromstring(content)
78	            stylizer = Stylizer(content, item.href, self.oeb_book, self.opts, self.opts.output_profile)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\txt\txtml.py:240:8
239	                text.append('\n' * ems)
240	        except:
241	            pass
242	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ebooks\unihandecode\__init__.py:54:8
53	                        text = text.decode('utf-8', 'replace')
54	        except:  # python3, str is unicode
55	            pass
56	        # at first unicode normalize it. (see Unicode standards)

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\ebooks\unihandecode\pykakasi\jisyo.py:5:0
4	# Copyright 2011 Hiroshi Miura <miurahr@linux.com>
5	import cPickle, marshal
6	from zlib import decompress

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b302-marshal
   Location: .\src\calibre\ebooks\unihandecode\pykakasi\jisyo.py:44:49
43	            try:
44	                table = self.jisyo_table[key]  = marshal.loads(decompress(self.kanwadict[key]))
45	            except:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\__init__.py:193:20
192	                        prints(unicode(e))
193	                    except:
194	                        pass
195	                    shortcut_action.setShortcuts([QKeySequence(key,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\convert.py:274:16
273	                        os.remove(f.name)
274	                except:
275	                    pass
276	        self.gui.tags_view.recount()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\edit_metadata.py:184:8
183	            shutil.rmtree(tdir, ignore_errors=True)
184	        except:
185	            pass
186	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\edit_metadata.py:796:8
795	                os.remove(mi.cover)
796	        except:
797	            pass
798	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\gui2\actions\mark_books.py:78:12
77	                w.installEventFilter(self)
78	            except:
79	                continue
80	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\polish.py:522:8
521	            os.rmdir(parent)
522	        except:
523	            pass
524	        self.gui.tags_view.recount()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\gui2\actions\random.py:30:15
29	    def pick_random(self):
30	        pick = random.randint(0, self.gui.library_view.model().rowCount(None))
31	        self.gui.library_view.set_current_row(pick)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\unpack_book.py:261:12
260	                self.finder.Finder_windows[os.path.basename(self._exploded)].close()
261	            except:
262	                pass
263	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\unpack_book.py:267:12
266	                os.remove(f)
267	            except:
268	                pass
269	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\unpack_book.py:273:12
272	                shutil.rmtree(d)
273	            except:
274	                pass
275	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\actions\view.py:324:16
323	                    ids.append(m(r))
324	                except Exception:
325	                    pass
326	            if ids:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\add.py:384:12
383	                os.remove(cover_path)
384	            except Exception:
385	                pass
386	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\add.py:397:16
396	                    os.remove(cover_path)
397	                except Exception:
398	                    pass
399	            book_id = self.dbref().create_book_entry(mi, cover=cdata)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\gui2\auto_add.py:123:12
122	                open(f, 'rb').close()
123	            except:
124	                continue
125	            tdir = tempfile.mkdtemp(dir=self.tdir)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\auto_add.py:189:8
188	                self.dir_changed()
189	        except:
190	            pass
191	        self.watcher.addPath(self.worker.path)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\auto_add.py:304:12
303	                shutil.rmtree(tdir)
304	            except:
305	                pass
306	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\comments_editor.py:10:0
9	
10	from lxml import html
11	import sip

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\gui2\convert\__init__.py:68:8
67	        self._name = self.commit_name = self.COMMIT_NAME
68	        assert self._name is not None
69	        self._icon = QIcon(self.ICON)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\__init__.py:254:12
253	                self.set_help_signal.emit(msg)
254	            except:
255	                pass
256	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\bulk.py:116:8
115	            shutil.rmtree(self.plumber.archive_input_tdir, ignore_errors=True)
116	        except:
117	            pass
118	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\heuristics.py:70:8
69	            self.opt_unwrap_lines.stateChanged.disconnect()
70	        except:
71	            pass
72	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\regex_builder.py:97:12
96	                    self.match_locs.append((match.start(), match.end()))
97	            except:
98	                pass
99	        self.preview.setExtraSelections(selections)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\regex_builder.py:169:12
168	                os.remove(fpath)
169	            except:
170	                # Fails on windows if the input plugin for this format keeps the file open
171	                # Happens for LIT files
172	                pass
173	        return True

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\search_and_replace.py:177:12
176	                x.disconnect()
177	            except:
178	                pass
179	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\convert\single.py:9:0
8	
9	import cPickle, shutil
10	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\convert\single.py:261:8
260	            shutil.rmtree(self.plumber.archive_input_tdir, ignore_errors=True)
261	        except:
262	            pass
263	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\gui2\dbus_export\demo.py:117:18
116	        while num == s.SP_ComputerIcon:
117	            num = random.choice(range(20))
118	        self.systray.setIcon(self.style().standardIcon(num))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:73:8
72	            self.callback_on_done(self)
73	        except:
74	            pass
75	        if DEBUG:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:247:8
246	            self.connected_device.post_yank_cleanup()
247	        except:
248	            pass
249	        if self.connected_device in self.ejected_devices:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:433:12
432	                p.shutdown()
433	            except:
434	                pass
435	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:598:20
597	                            os.remove(mi.cover)
598	                    except:
599	                        pass
600	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:689:8
688	                return True
689	        except:
690	            pass
691	        return False

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:1036:8
1035	                return
1036	        except:
1037	            pass
1038	        if getattr(job, 'exception', None).__class__.__name__ == 'MTPInvalidSendPathError':

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:1046:8
1045	            prints(job.details, file=sys.stderr)
1046	        except:
1047	            pass
1048	        if not self.device_error_dialog.isVisible():

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:1302:12
1301	                                 preserve_aspect_ratio=False)
1302	            except:
1303	                pass
1304	            return

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:1310:8
1309	                    compression_quality=self.device_manager.device.THUMBNAIL_COMPRESSION_QUALITY)
1310	        except:
1311	            pass
1312	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:1451:20
1450	                        traceback.print_exc()
1451	                    except:
1452	                        pass
1453	                    total_size = self.location_manager.free[0]

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\device.py:1684:16
1683	                        os.remove(f)
1684	                except:
1685	                    pass
1686	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\add_empty_book.py:94:8
93	            c.setCurrentIndex(possible_formats.index(use_format))
94	        except Exception:
95	            pass
96	        self._layout.addWidget(c, 9, 0, 1, 1)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\book_info.py:162:12
161	                self.splitter.restoreState(saved_layout[1])
162	            except Exception:
163	                pass
164	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\confirm_delete_location.py:39:12
38	                b.clicked.disconnect()
39	            except:
40	                pass
41	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\custom_recipes.py:109:12
108	                urns.append(urn)
109	            except:
110	                pass
111	        self.beginResetModel()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\edit_authors_dialog.py:41:8
40	            self.restoreGeometry(QByteArray(geom))
41	        except:
42	            pass
43	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\match_books.py:63:8
62	            self.restoreGeometry(QByteArray(geom))
63	        except:
64	            pass
65	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\message_box.py:176:12
175	                        ).setFocus(Qt.OtherFocusReason)
176	            except:
177	                pass  # Buttons were changed
178	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\metadata_bulk.py:655:8
654	            self.s_r_dst_ident.setPlaceholderText(_('Enter an identifier type'))
655	        except:
656	            pass
657	        self.s_r_src_ident.addItems(ident_types)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\metadata_bulk.py:1336:12
1335	                attr.setText(item[key])
1336	            except:
1337	                pass
1338	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\dialogs\opml.py:16:0
15	
16	from lxml import etree
17	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\dialogs\opml.py:35:11
34	def import_opml(raw, preserve_groups=True):
35	    root = etree.fromstring(raw)
36	    groups = defaultdict(list)

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\dialogs\plugin_updater.py:11:0
10	import re, datetime, traceback
11	from lxml import html
12	from PyQt5.Qt import (Qt, QUrl, QFrame, QVBoxLayout, QLabel, QBrush, QTextEdit,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\quickview.py:157:8
156	                self.restoreGeometry(QByteArray(geom))
157	        except:
158	            pass
159	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\quickview.py:402:8
401	            self.refresh(self.view.model().index(self.db.row(mi.id), self.current_column))
402	        except:
403	            pass
404	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\scheduler.py:400:8
399	            self.download.disconnect()
400	        except:
401	            pass
402	        self.recipe_model = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\tag_editor.py:32:12
31	                self.setWindowTitle(_('Edit %s') % fm['name'])
32	            except Exception:
33	                pass
34	            key = db.field_metadata.key_to_label(key)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\tag_list_editor.py:122:8
121	                        gprefs.get('tag_list_editor_table_widths', None)
122	        except:
123	            pass
124	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dialogs\tag_list_editor.py:211:8
210	                self.resize(self.sizeHint()+QSize(150, 100))
211	        except:
212	            pass
213	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\dnd.py:142:8
141	            raw = raw.decode('utf-16')
142	        except:
143	            pass
144	    return raw

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\gui2\dnd.py:241:8
240	                p.loadFromData(f.read())
241	        except Exception:
242	            continue
243	        if not p.isNull():

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\ebook_download.py:92:12
91	                    os.remove(dfilename)
92	            except:
93	                pass
94	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\email.py:125:16
124	                    return log.debug(*args, **kwargs)
125	                except Exception:
126	                    pass
127	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\font_family_chooser.py:110:8
109	            self.do_paint(painter, option, index)
110	        except:
111	            pass
112	        painter.restore()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\jobs.py:637:8
636	                self.jobs_view.horizontalHeader().restoreState(QByteArray(state))
637	        except:
638	            pass
639	        idx = self.jobs_view.model().index(0, 0)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\jobs.py:650:8
649	            gprefs['jobs_dialog_geometry'] = geom
650	        except:
651	            pass
652	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\keyboard.py:231:8
230	            return self.createIndex(row, column, ip[row])
231	        except:
232	            pass
233	        return ROOT

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\gui2\keyboard.py:308:16
307	                    sc = self.data[c].children[p].data
308	                except:
309	                    continue
310	                if query in lower(sc['name']):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\main_window.py:140:12
139	                print_basic_debug_info(out=sio)
140	            except:
141	                pass
142	            traceback.print_exception(type, value, tb, file=sio)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\main_window.py:152:8
151	            pass
152	        except:
153	            pass
154	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:311:8
310	            self.title_edit.textChanged.disconnect()
311	        except:
312	            pass
313	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:315:8
314	            self.textChanged.disconnect()
315	        except:
316	            pass
317	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:319:8
318	            self.autogen_button.clicked.disconnect()
319	        except:
320	            pass
321	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:432:8
431	            self.manage_authors_signal.triggered.disconnect()
432	        except:
433	            pass
434	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:562:8
561	            self.authors_edit.editTextChanged.disconnect()
562	        except:
563	            pass
564	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:566:8
565	            self.textChanged.disconnect()
566	        except:
567	            pass
568	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:570:8
569	            self.autogen_button.clicked.disconnect()
570	        except:
571	            pass
572	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:574:8
573	            self.copy_a_to_as_action.triggered.disconnect()
574	        except:
575	            pass
576	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:578:8
577	            self.copy_as_to_a_action.triggered.disconnect()
578	        except:
579	            pass
580	        self.authors_edit = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:709:8
708	            self.series_edit.currentIndexChanged.disconnect()
709	        except:
710	            pass
711	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:713:8
712	            self.series_edit.editTextChanged.disconnect()
713	        except:
714	            pass
715	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:717:8
716	            self.series_edit.lineEdit().editingFinished.disconnect()
717	        except:
718	            pass
719	        self.db = self.series_edit = self.dialog = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:1024:12
1023	                os.remove(name)
1024	            except:
1025	                pass
1026	        self.temp_files = []

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\basic_widgets.py:1217:8
1216	            self.cover_changed.disconnect()
1217	        except:
1218	            pass
1219	        self.dialog = self._cdata = self.current_val = self.original_val = None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\bulk_download.py:201:12
200	                names = os.listdir(self.tdir)
201	            except:
202	                pass
203	            else:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\gui2\metadata\bulk_download.py:208:24
207	                            book_id = int(x.partition('.')[0])
208	                        except:
209	                            continue
210	                        if book_id not in self.seen and book_id in self.title_map:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\pdf_covers.py:86:8
85	            shutil.rmtree(self.tdir)
86	        except:
87	            pass
88	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\metadata\single.py:693:12
692	                signal.disconnect()
693	            except:
694	                pass  # Fails if view format was never connected
695	        disconnect(self.view_format)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\notify.py:119:12
118	                        self.systray.hide()
119	            except:
120	                pass
121	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\gui2\notify.py:140:12
139	            self.ok = os.access(self.exe, os.X_OK)
140	            import subprocess
141	            self.call = subprocess.Popen

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\notify.py:142:8
141	            self.call = subprocess.Popen
142	        except:
143	            pass
144	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\gui2\open_with.py:38:4
37	def run_program(entry, path, parent):
38	    import subprocess
39	    cmdline = entry_to_cmdline(entry, path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\gui2\open_with.py:43:22
42	        with sanitize_env_vars():
43	            process = subprocess.Popen(cmdline)
44	    except Exception as err:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\preferences\look_feel.py:249:12
248	                name = self.db.field_metadata[field]['name']
249	            except:
250	                pass
251	            if not name:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\preferences\main.py:343:12
342	                getattr(self.showing_widget, sig).disconnect(getattr(self, sig))
343	            except Exception:
344	                pass
345	        self.showing_widget = QWidget(self.scroll_area)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\preferences\metadata_sources.py:346:8
345	            self.pc.finished.diconnect()
346	        except:
347	            pass
348	        self.stack.setCurrentIndex(0)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\gui2\preferences\plugins.py:88:16
87	                    plugin = self._data[self.categories[c]][p]
88	                except:
89	                    continue
90	            if query in lower(plugin.name) or query in lower(plugin.author) or \

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\gui2\preferences\server.py:1024:51
1023	        protocol = 'https' if self.advanced_tab.has_ssl else 'http'
1024	        lo = self.advanced_tab.get('listen_on') or '0.0.0.0'
1025	        lo = {'0.0.0.0': '127.0.0.1', '::':'::1'}.get(lo)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\gui2\preferences\server.py:1025:14
1024	        lo = self.advanced_tab.get('listen_on') or '0.0.0.0'
1025	        lo = {'0.0.0.0': '127.0.0.1', '::':'::1'}.get(lo)
1026	        url = '{protocol}://{interface}:{port}{prefix}'.format(

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\preferences\toolbar.py:112:12
111	                return primary_sort_key(ac.action_spec[0])
112	            except Exception:
113	                pass
114	        all.sort(key=sk)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\search_box.py:158:8
157	            self.lineEdit().completer().popup().setVisible(False)
158	        except:
159	            pass
160	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\search_box.py:344:8
343	            self.line_edit.setPlaceholderText(help_text)
344	        except:
345	            # Using Qt < 4.7
346	            pass
347	        self.colorize = colorize

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\opensearch_store.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\opensearch_store.py:39:14
38	    with closing(br.open(url, timeout=timeout)) as f:
39	        doc = etree.fromstring(f.read())
40	        for data in doc.xpath('//*[local-name() = "entry"]'):

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_au_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_au_plugin.py:100:12
99	                author = author.split('by ', 1)[1].split(" (")[0]
100	            except:
101	                pass
102	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_ca_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_ca_plugin.py:100:12
99	                author = author.split('by ', 1)[1].split(" (")[0]
100	            except:
101	                pass
102	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_de_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_de_plugin.py:102:12
101	                author = author.split('by ', 1)[1].split(" (")[0]
102	            except:
103	                pass
104	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_es_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_es_plugin.py:102:12
101	                author = author.split('by ', 1)[1].split(" (")[0]
102	            except:
103	                pass
104	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_fr_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_fr_plugin.py:101:12
100	                author = author.split('by ', 1)[1].split(" (")[0]
101	            except:
102	                pass
103	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_in_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_in_plugin.py:100:12
99	                author = author.split('by ', 1)[1].split(" (")[0]
100	            except:
101	                pass
102	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_it_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_it_plugin.py:102:12
101	                author = author.split('by ', 1)[1].split(" (")[0]
102	            except:
103	                pass
104	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_plugin.py:136:12
135	                author = author.split('by ', 1)[1].split(" (")[0]
136	            except:
137	                pass
138	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\amazon_uk_plugin.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\amazon_uk_plugin.py:100:12
99	                author = author.split('by ', 1)[1].split(" (")[0]
100	            except:
101	                pass
102	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\baen_webscription_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\beam_ebooks_de_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\biblio_plugin.py:36:8
35	        from contextlib import closing
36	        from lxml import html
37	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\bn_plugin.py:14:0
13	
14	from lxml import html
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\bubok_portugal_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\bubok_publishing_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\ebook_nl_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\ebookpoint_plugin.py:15:0
14	
15	from lxml import html
16	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\ebooks_com_plugin.py:14:0
13	
14	from lxml import html
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\ebookshoppe_uk_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\eknigi_plugin.py:15:0
14	
15	from lxml import html
16	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\gui2\store\stores\eknigi_plugin.py:31:11
30	        # Use Kovid's affiliate id 30% of the time
31	        if random.randint(1, 10) in (1, 2, 3):
32	            aff_suffix = '&amigosid=23'

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\empik_plugin.py:15:0
14	
15	from lxml import html
16	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\google_books_plugin.py:13:0
12	
13	from lxml import html
14	from PyQt5.Qt import QUrl

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\gutenberg_plugin.py:16:0
15	
16	from lxml import etree
17	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\stores\gutenberg_plugin.py:43:14
42	                f.write(raw)
43	        doc = etree.fromstring(raw)
44	        for data in doc.xpath('//*[local-name() = "entry"]'):

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\stores\gutenberg_plugin.py:63:23
62	            with closing(br.open(id, timeout=timeout/4)) as nf:
63	                ndoc = etree.fromstring(nf.read())
64	                for link in ndoc.xpath('//*[local-name() = "link" and @rel = "http://opds-spec.org/acquisition"]'):

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\kobo_plugin.py:13:0
12	
13	from lxml import html, etree
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\legimi_plugin.py:15:0
14	
15	from lxml import html
16	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\libri_de_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\litres_plugin.py:15:0
14	from contextlib import closing
15	from lxml import etree
16	from PyQt5.Qt import QUrl

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\stores\litres_plugin.py:64:18
63	            parser = etree.XMLParser(recover=True, no_network=True)
64	            doc = etree.fromstring(raw, parser=parser)
65	            for data in doc.xpath('//*[local-name() = "fb2-book"]'):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\litres_plugin.py:114:8
113	            price = price.replace(',', ' ').replace('.', ',', 1)
114	        except:
115	            pass
116	    return price

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\gui2\store\stores\litres_plugin.py:134:7
133	    # Use Kovid's affiliate id 30% of the time.
134	    if random.randint(1, 10) in (1, 2, 3):
135	        aff_id = u'4084465'

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\manybooks_plugin.py:13:0
12	
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\stores\manybooks_plugin.py:49:14
48	        raw_data = raw_data.decode('utf-8', 'replace')
49	        doc = etree.fromstring(raw_data)
50	        for data in doc.xpath('//*[local-name() = "entry"]'):

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\stores\manybooks_plugin.py:74:23
73	            with closing(br.open(detail_href, timeout=timeout/4)) as df:
74	                ddoc = etree.fromstring(df.read())
75	                ddata = ddoc.xpath('//*[local-name() = "entry"][1]')

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\mills_boon_uk_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\mobileread\cache_update_thread.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\store\stores\mobileread\cache_update_thread.py:91:8
90	                    self.update_progress.emit(i)
91	        except:
92	            pass
93	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\nexto_plugin.py:14:0
13	
14	from lxml import html
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\open_books_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\publio_plugin.py:14:0
13	
14	from lxml import html
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\rw2010_plugin.py:14:0
13	
14	from lxml import html
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\smashwords_plugin.py:15:0
14	
15	from lxml import html
16	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\gui2\store\stores\smashwords_plugin.py:87:11
86	        # Use Kovid's affiliate id 30% of the time.
87	        if random.randint(1, 10) in (1, 2, 3):
88	            aff_id = '?ref=kovidgoyal'

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\swiatebookow_plugin.py:14:0
13	
14	from lxml import html
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\virtualo_plugin.py:15:0
14	
15	from lxml import html
16	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\weightless_books_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\whsmith_uk_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\woblink_plugin.py:13:0
12	
13	from lxml import html
14	from mechanize import Request

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\wolnelektury_plugin.py:13:0
12	
13	from lxml import html
14	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\store\stores\xinxii_plugin.py:13:0
12	
13	from lxml import etree
14	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\gui2\store\stores\xinxii_plugin.py:47:18
46	        with closing(br.open(url, timeout=timeout)) as f:
47	            doc = etree.fromstring(f.read())
48	            for data in doc.xpath('//*[local-name() = "entry"]'):

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\tag_browser\model.py:11:0
10	
11	import traceback, cPickle, copy, os
12	from collections import OrderedDict

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tag_browser\model.py:340:16
339	                    os.remove(path)
340	                except:
341	                    pass
342	            del d[key]

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\tag_browser\view.py:10:0
9	
10	import cPickle, os, re
11	from functools import partial

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tag_browser\view.py:288:8
287	                    config.set('match_tags_type', self.db.MATCH_TYPE[i])
288	        except:
289	            pass
290	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\tools.py:10:0
9	
10	import cPickle, os
11	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tools.py:359:8
358	            connected_device['save_template'] = device.save_template()
359	        except:
360	            pass
361	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\tweak_book\char_select.py:9:0
8	
9	import unicodedata, re, os, cPickle, textwrap
10	from bisect import bisect

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\completion\basic.py:117:12
116	                root = parse(raw, decoder=lambda x:x.decode('utf-8'))
117	            except Exception:
118	                pass
119	            else:

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\tweak_book\completion\worker.py:9:0
8	
9	import cPickle, os, sys
10	from threading import Thread, Event, RLock

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\completion\worker.py:146:12
145	                conn.close()
146	            except Exception:
147	                pass
148	        p = self.worker_process

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\diff\main.py:315:12
314	                getattr(self, x).disconnect()
315	            except:
316	                pass
317	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\diff\main.py:470:4
469	        d.revert_requested.disconnect()
470	    except:
471	        pass
472	    d.break_cycles()

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\tweak_book\editor\help.py:12:0
11	
12	from lxml import html
13	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\editor\insert_resource.py:111:12
110	                raw = current_container().raw_data(name, decode=False)
111	            except:
112	                pass
113	            else:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'url'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\gui2\tweak_book\editor\syntax\css.py:28:12
27	
28	URL_TOKEN = 'url'
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\gui2\tweak_book\editor\syntax\pygments_highlighter.py:57:28
56	                        else:
57	                            assert False, "wrong state def: %r" % new_state
58	                        statetokens = tokendefs[statestack[-1]]

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\editor\themes.py:201:4
200	        return QBrush(QColor(r, g, b))
201	    except Exception:
202	        pass
203	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'bold'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\gui2\tweak_book\editor\themes.py:221:28
220	            else:
221	                if token == 'bold':
222	                    bold = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'italic'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\gui2\tweak_book\editor\themes.py:223:30
222	                    bold = True
223	                elif token == 'italic':
224	                    italic = True

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\tweak_book\spell.py:9:0
8	
9	import cPickle, os, sys
10	from collections import defaultdict, OrderedDict

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\gui2\tweak_book\text_search.py:13:0
12	)
13	from lxml.etree import tostring
14	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\tweak_book\undo.py:26:8
25	            shutil.rmtree(container.root, ignore_errors=True)
26	        except:
27	            pass
28	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\viewer\bookmarkmanager.py:9:0
8	
9	import cPickle
10	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\viewer\bookmarkmanager.py:223:12
222	                        break
223	            except Exception:
224	                pass
225	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\viewer\main.py:403:12
402	                self.restoreState(state, self.STATE_VERSION)
403	            except:
404	                pass
405	        self.initialize_dock_state()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\gui2\viewer\main.py:1011:12
1010	                vh.remove(pathtoebook)
1011	            except:
1012	                pass
1013	            vh.insert(0, pathtoebook)

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\gui2\viewer\printing.py:9:0
8	
9	import os, subprocess, cPickle, sys
10	from threading import Thread

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\gui2\viewer\ui.py:195:4
194	    h.add(9)
195	    assert h == [0, 9]
196	# }}}

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\gui2\win_file_dialogs.py:7:0
6	                        print_function)
7	import sys, subprocess, struct, os
8	from threading import Thread

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\gui2\win_file_dialogs.py:184:19
183	    with sanitize_env_vars():
184	        h = Helper(subprocess.Popen(
185	            [HELPER], stdout=subprocess.PIPE, stdin=subprocess.PIPE, stderr=subprocess.PIPE),
186	               data, loop.dialog_closed.emit)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\gui2\win_file_dialogs.py:354:8
353	    server = PipeServer(pipename)
354	    p = subprocess.Popen([helper], stdout=subprocess.PIPE, stdin=subprocess.PIPE, stderr=subprocess.PIPE)
355	    stdout, stderr = p.communicate(data)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\library\add_to_library.py:68:19
67	        with open(path, 'rb') as f:
68	            return sha1(f.read()).digest()
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\library\add_to_library.py:108:4
107	        cancel_callback=lambda : False):
108	    assert not isinstance(folder, unicode)
109	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\caches.py:685:24
684	                                break
685	                        except:
686	                            pass
687	                    return matches

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\library\caches.py:813:20
812	                            continue
813	                    except:
814	                        # A conversion threw an exception. Because of the type,
815	                        # no further match is possible
816	                        continue
817	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\caches.py:927:12
926	                self._data[id_][marked_col] = val
927	            except:
928	                pass
929	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\caches.py:1054:12
1053	                self._data[id_][marked_col] = val
1054	            except:
1055	                pass
1056	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\library\catalogs\csv_xml.py:57:8
56	        from calibre.utils.logging import default_log as log
57	        from lxml import etree
58	        from calibre.ebooks.metadata import authors_to_string

--------------------------------------------------
>> Issue: [B410:blacklist] Using E to parse untrusted XML data is known to be vulnerable to XML attacks. Replace E with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\library\catalogs\csv_xml.py:169:12
168	        elif self.fmt == 'xml':
169	            from lxml.builder import E
170	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\library\coloring.py:217:12
216	                color, conditions = json.loads(binascii.unhexlify(raw).decode('utf-8'))
217	            except:
218	                continue
219	            r = Rule(fm)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\library\coloring.py:224:16
223	                    r.add_condition(*c)
224	                except:
225	                    continue
226	            if r.color and r.conditions:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:105:26
104	            if data['normalized']:
105	                trigger = 'DELETE FROM %s WHERE book=OLD.id;'%lt
106	            else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:107:26
106	            else:
107	                trigger = 'DELETE FROM %s WHERE book=OLD.id;'%table
108	            triggers.append(trigger)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:227:29
226	        idx = idx if index_is_id else self.id(idx)
227	        return self.conn.get('''SELECT extra FROM %s
228	                                WHERE book=?'''%lt, (idx,), all=False)
229	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:245:30
244	        ign,lt = self.custom_table_names(data['num'])
245	        extra = self.conn.get('''SELECT extra FROM %s
246	                                 WHERE book=?'''%lt, (idx,), all=False)
247	        return (ans, extra)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:258:28
257	            return []
258	        ans = self.conn.get('SELECT id, value FROM %s'%table)
259	        return ans

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:269:12
268	        new_id = self.conn.get(
269	            'SELECT id FROM %s WHERE value=?'%table, (new_name,), all=False)
270	        if new_id is None or old_id == new_id:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:271:30
270	        if new_id is None or old_id == new_id:
271	            self.conn.execute('UPDATE %s SET value=? WHERE id=?'%table, (new_name, old_id))
272	            new_id = old_id

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:277:38
276	            if data['is_multiple']:
277	                books = self.conn.get('''SELECT book from %s
278	                                         WHERE value=?'''%lt, (old_id,))
279	                for (book_id,) in books:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:280:38
279	                for (book_id,) in books:
280	                    self.conn.execute('''DELETE FROM %s
281	                            WHERE book=? and value=?'''%lt, (book_id, new_id))
282	            self.conn.execute('''UPDATE %s SET value=?

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:282:30
281	                            WHERE book=? and value=?'''%lt, (book_id, new_id))
282	            self.conn.execute('''UPDATE %s SET value=?
283	                                 WHERE value=?'''%lt, (new_id, old_id,))
284	            self.conn.execute('DELETE FROM %s WHERE id=?'%table, (old_id,))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:284:30
283	                                 WHERE value=?'''%lt, (new_id, old_id,))
284	            self.conn.execute('DELETE FROM %s WHERE id=?'%table, (old_id,))
285	        self.dirty_books_referencing('#'+data['label'], new_id, commit=False)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:296:30
295	            self.dirty_books_referencing('#'+data['label'], id, commit=False)
296	            self.conn.execute('DELETE FROM %s WHERE value=?'%lt, (id,))
297	            self.conn.execute('DELETE FROM %s WHERE id=?'%table, (id,))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:297:30
296	            self.conn.execute('DELETE FROM %s WHERE value=?'%lt, (id,))
297	            self.conn.execute('DELETE FROM %s WHERE id=?'%table, (id,))
298	            self.conn.commit()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:320:32
319	            table, lt = self.custom_table_names(data['num'])
320	            id_ = self.conn.get('SELECT id FROM %s WHERE value = ?'%table,
321	                                (existing_tags[idx],), all=False)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:323:38
322	            if id_:
323	                books = self.conn.get('SELECT book FROM %s WHERE value = ?'%lt, (id_,))
324	                if books:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:326:34
325	                    books_affected = [b[0] for b in books]
326	                self.conn.execute('DELETE FROM %s WHERE value=?'%lt, (id_,))
327	                self.conn.execute('DELETE FROM %s WHERE id=?'%table, (id_,))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:327:34
326	                self.conn.execute('DELETE FROM %s WHERE value=?'%lt, (id_,))
327	                self.conn.execute('DELETE FROM %s WHERE id=?'%table, (id_,))
328	                self.conn.commit()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:341:34
340	        # get the id of the row containing the series string
341	        series_id = self.conn.get('SELECT id from %s WHERE value=?'%table,
342	                                                        (series,), all=False)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:347:39
346	            return 1.0
347	        series_indices = self.conn.get('''
348	                SELECT {lt}.extra FROM {lt}
349	                WHERE {lt}.book IN (SELECT book FROM {lt} where value=?)
350	                ORDER BY {lt}.extra
351	                '''.format(lt=lt), (series_id,))
352	        return self._get_next_series_num_for_list(series_indices)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:361:32
360	        if data['normalized']:
361	            ans = self.conn.get('SELECT value FROM %s'%table)
362	        else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:363:32
362	        else:
363	            ans = self.conn.get('SELECT DISTINCT value FROM %s'%table)
364	        ans = set([x[0] for x in ans])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:436:34
435	        if new_tags:
436	            self.conn.executemany('INSERT INTO %s(value) VALUES (?)'%cust_table,
437	                                  [(x,) for x in new_tags])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:457:22
456	            table = temp_tables[table+1]
457	            insert = ('INSERT INTO {tt}(id) SELECT {ct}.id FROM {ct} WHERE value=?'
458	                     ' COLLATE PYNOCASE LIMIT 1').format(tt=table, ct=cust_table)
459	            self.conn.executemany(insert, [(x,) for x in tags])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:464:14
463	            self.conn.execute(
464	              '''DELETE FROM %s WHERE
465	                    book IN (SELECT id FROM %s) AND
466	                    value IN (SELECT id FROM %s)'''
467	              % (link_table, temp_tables[0], temp_tables[2]))
468	        if add:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:470:12
469	            self.conn.execute(
470	            '''
471	            INSERT OR REPLACE INTO {0}(book, value) SELECT {1}.id, {2}.id FROM {1}, {2}
472	            '''.format(link_table, temp_tables[0], temp_tables[1])
473	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:482:20
481	            tags = self.conn.get(
482	                    'SELECT custom_%s FROM meta2 WHERE id=?'%data['num'],
483	                    (x,), all=False)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:543:34
542	            if not append or not data['is_multiple']:
543	                self.conn.execute('DELETE FROM %s WHERE book=?'%lt, (id_,))
544	                self.conn.execute(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:545:16
544	                self.conn.execute(
545	                '''DELETE FROM %s WHERE (SELECT COUNT(id) FROM %s WHERE
546	                    value=%s.id) < 1''' % (table, lt, table))
547	                self.data._data[id_][self.FIELD_MAP[data['num']]] = None

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:570:24
569	                    xid = self.conn.get(
570	                        'SELECT id FROM %s WHERE value=?'%table, (ex,), all=False)
571	                    if allow_case_change and ex != x:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:574:28
573	                        self.conn.execute(
574	                            'UPDATE %s SET value=? WHERE id=?'%table, (x, xid))
575	                else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:579:20
578	                if not self.conn.get(
579	                    'SELECT book FROM %s WHERE book=? AND value=?'%lt, (id_, xid), all=False):
580	                    if data['datatype'] == 'series':

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:582:28
581	                        self.conn.execute(
582	                            '''INSERT INTO %s(book, value, extra)
583	                               VALUES (?,?,?)'''%lt, (id_, xid, extra))
584	                        self.data.set(id_, self.FIELD_MAP[data['num']]+1,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:588:28
587	                        self.conn.execute(
588	                            '''INSERT INTO %s(book, value)
589	                                VALUES (?,?)'''%lt, (id_, xid))
590	                if case_change:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:591:40
590	                if case_change:
591	                    bks = self.conn.get('SELECT book FROM %s WHERE value=?'%lt,
592	                                        (xid,))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:595:20
594	            nval = self.conn.get(
595	                    'SELECT custom_%s FROM meta2 WHERE id=?'%data['num'],
596	                    (id_,), all=False)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:600:30
599	        else:
600	            self.conn.execute('DELETE FROM %s WHERE book=?'%table, (id_,))
601	            if val is not None:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:603:24
602	                self.conn.execute(
603	                        'INSERT INTO %s(book,value) VALUES (?,?)'%table, (id_, val))
604	            nval = self.conn.get(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:605:20
604	            nval = self.conn.get(
605	                    'SELECT custom_%s FROM meta2 WHERE id=?'%data['num'], (id_,), all=False)
606	            self.data.set(id_, self.FIELD_MAP[data['num']], nval,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:642:23
641	                        query = 'sortconcat_bar(link.id, %s.value)'
642	                line = '''(SELECT {query} FROM {lt} AS link INNER JOIN
643	                    {table} ON(link.value={table}.id) WHERE link.book=books.id)
644	                    custom_{num}
645	                '''.format(query=query%table, lt=lt, table=table, num=data['num'])
646	                if data['datatype'] == 'series':

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:647:28
646	                if data['datatype'] == 'series':
647	                    line += ''',(SELECT extra FROM {lt} WHERE {lt}.book=books.id)
648	                        custom_index_{num}'''.format(lt=lt, num=data['num'])
649	            else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:650:23
649	            else:
650	                line = '''
651	                (SELECT value FROM {table} WHERE book=books.id) custom_{num}
652	                '''.format(table=table, num=data['num'])
653	            lines[data['num']] = line

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:713:16
712	
713	                '''\
714	                CREATE TRIGGER fkc_update_{lt}_a
715	                        BEFORE UPDATE OF book ON {lt}
716	                        BEGIN
717	                            SELECT CASE
718	                                WHEN (SELECT id from books WHERE id=NEW.book) IS NULL
719	                                THEN RAISE(ABORT, 'Foreign key violation: book not in books')
720	                            END;
721	                        END;
722	                CREATE TRIGGER fkc_update_{lt}_b
723	                        BEFORE UPDATE OF author ON {lt}
724	                        BEGIN
725	                            SELECT CASE
726	                                WHEN (SELECT id from {table} WHERE id=NEW.value) IS NULL
727	                                THEN RAISE(ABORT, 'Foreign key violation: value not in {table}')
728	                            END;
729	                        END;
730	                CREATE TRIGGER fkc_insert_{lt}
731	                        BEFORE INSERT ON {lt}
732	                        BEGIN
733	                            SELECT CASE
734	                                WHEN (SELECT id from books WHERE id=NEW.book) IS NULL
735	                                THEN RAISE(ABORT, 'Foreign key violation: book not in books')
736	                                WHEN (SELECT id from {table} WHERE id=NEW.value) IS NULL
737	                                THEN RAISE(ABORT, 'Foreign key violation: value not in {table}')
738	                            END;
739	                        END;
740	                CREATE TRIGGER fkc_delete_{lt}
741	                        AFTER DELETE ON {table}
742	                        BEGIN
743	                            DELETE FROM {lt} WHERE value=OLD.id;
744	                        END;
745	
746	                CREATE VIEW tag_browser_{table} AS SELECT
747	                    id,
748	                    value,
749	                    (SELECT COUNT(id) FROM {lt} WHERE value={table}.id) count,
750	                    (SELECT AVG(r.rating)
751	                     FROM {lt},
752	                          books_ratings_link as bl,
753	                          ratings as r
754	                     WHERE {lt}.value={table}.id and bl.book={lt}.book and
755	                           r.id = bl.rating and r.rating <> 0) avg_rating,
756	                    value AS sort
757	                FROM {table};
758	
759	                CREATE VIEW tag_browser_filtered_{table} AS SELECT
760	                    id,
761	                    value,
762	                    (SELECT COUNT({lt}.id) FROM {lt} WHERE value={table}.id AND
763	                    books_list_filter(book)) count,
764	                    (SELECT AVG(r.rating)
765	                     FROM {lt},
766	                          books_ratings_link as bl,
767	                          ratings as r
768	                     WHERE {lt}.value={table}.id AND bl.book={lt}.book AND
769	                           r.id = bl.rating AND r.rating <> 0 AND
770	                           books_list_filter(bl.book)) avg_rating,
771	                    value AS sort
772	                FROM {table};
773	
774	                '''.format(lt=lt, table=table),
775	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\custom_columns.py:789:16
788	
789	                '''\
790	                CREATE TRIGGER fkc_insert_{table}
791	                        BEFORE INSERT ON {table}
792	                        BEGIN
793	                            SELECT CASE
794	                                WHEN (SELECT id from books WHERE id=NEW.book) IS NULL
795	                                THEN RAISE(ABORT, 'Foreign key violation: book not in books')
796	                            END;
797	                        END;
798	                CREATE TRIGGER fkc_update_{table}
799	                        BEFORE UPDATE OF book ON {table}
800	                        BEGIN
801	                            SELECT CASE
802	                                WHEN (SELECT id from books WHERE id=NEW.book) IS NULL
803	                                THEN RAISE(ABORT, 'Foreign key violation: book not in books')
804	                            END;
805	                        END;
806	                '''.format(table=table),
807	            ]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:108:36
107	            self._library_id_ = unicode(val)
108	            self.conn.executescript('''
109	                    DELETE FROM library_id;
110	                    INSERT INTO library_id (uuid) VALUES ("%s");
111	                    '''%self._library_id_)
112	            self.conn.commit()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:273:20
272	                            old_rules.append((col, templ))
273	                    except:
274	                        pass
275	            if old_rules:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:300:12
299	                self.prefs.set('grouped_search_terms', ngst)
300	            except:
301	                pass
302	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:368:32
367	            'UPDATE authors SET sort=author_to_author_sort(name) WHERE sort IS NULL')
368	        self.conn.executescript(u'''
369	            CREATE TEMP VIEW IF NOT EXISTS tag_browser_news AS SELECT DISTINCT
370	                id,
371	                name,
372	                (SELECT COUNT(books_tags_link.id) FROM books_tags_link WHERE tag=x.id) count,
373	                (0) as avg_rating,
374	                name as sort
375	            FROM tags as x WHERE name!="{0}" AND id IN
376	                (SELECT DISTINCT tag FROM books_tags_link WHERE book IN
377	                    (SELECT DISTINCT book FROM books_tags_link WHERE tag IN
378	                        (SELECT id FROM tags WHERE name="{0}")));
379	            '''.format(_('News')))
380	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:381:32
380	
381	        self.conn.executescript(u'''
382	            CREATE TEMP VIEW IF NOT EXISTS tag_browser_filtered_news AS SELECT DISTINCT
383	                id,
384	                name,
385	                (SELECT COUNT(books_tags_link.id) FROM books_tags_link WHERE tag=x.id and books_list_filter(book)) count,
386	                (0) as avg_rating,
387	                name as sort
388	            FROM tags as x WHERE name!="{0}" AND id IN
389	                (SELECT DISTINCT tag FROM books_tags_link WHERE book IN
390	                    (SELECT DISTINCT book FROM books_tags_link WHERE tag IN
391	                        (SELECT id FROM tags WHERE name="{0}")));
392	            '''.format(_('News')))
393	        self.conn.commit()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:472:17
471	
472	        script = '''
473	        DROP VIEW IF EXISTS meta2;
474	        CREATE TEMP VIEW meta2 AS
475	        SELECT
476	        {0}
477	        FROM books;
478	        '''.format(', \n'.join(lines))
479	        self.conn.executescript(script)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:791:8
790	            return utcfromtimestamp(os.stat(path).st_mtime)
791	        except:
792	            # Cover doesn't exist
793	            pass
794	        return self.last_modified()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:846:16
845	                    del self.dirtied_cache[book_id]
846	                except:
847	                    pass
848	            elif dc_sequence is not None:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:884:12
883	                    self.clear_dirtied(book_id, sequence)
884	            except:
885	                pass
886	            if callback is not None:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\library\database2.py:934:48
933	                # reason.
934	                id_ = self.dirtied_cache.keys()[random.randint(0, l-1)]
935	                sequence = self.dirtied_cache[id_]

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:974:8
973	                mi.cover = 'cover.jpg'
974	        except:
975	            # This almost certainly means that the book has been deleted while
976	            # the backup operation sat in the queue.
977	            pass
978	        return (path, mi, sequence)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:1409:20
1408	                            os.rename(path, dest)
1409	                    except:
1410	                        pass  # Nothing too catastrophic happened, the cases mismatch, that's all
1411	                else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:1425:24
1424	                            os.rename(path, dest)
1425	                        except:
1426	                            pass  # Nothing too catastrophic happened, the cases mismatch, that's all
1427	                else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:1432:24
1431	                            return
1432	                        except:
1433	                            pass
1434	                    with lopen(path, 'rb') as f, lopen(dest, 'wb') as d:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:1480:28
1479	                                return True
1480	                            except:
1481	                                pass
1482	                        with lopen(dest, 'wb') as d:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:1514:24
1513	                            os.makedirs(d)
1514	                        except:
1515	                            pass
1516	                        fname = os.path.basename(path)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1664:18
1663	        def doit(table, ltable_col):
1664	            st = ('DELETE FROM books_%s_link WHERE (SELECT COUNT(id) '
1665	                    'FROM books WHERE id=book) < 1;')%table
1666	            self.conn.execute(st)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1667:18
1666	            self.conn.execute(st)
1667	            st = ('DELETE FROM %(table)s WHERE (SELECT COUNT(id) '
1668	                    'FROM books_%(table)s_link WHERE '
1669	                    '%(ltable_col)s=%(table)s.id) < 1;') % dict(
1670	                            table=table, ltable_col=ltable_col)
1671	            self.conn.execute(st)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1683:18
1682	        def doit(ltable, table, ltable_col):
1683	            st = ('DELETE FROM books_%s_link WHERE (SELECT COUNT(id) '
1684	                    'FROM books WHERE id=book) < 1;')%ltable
1685	            self.conn.execute(st)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1686:18
1685	            self.conn.execute(st)
1686	            st = ('DELETE FROM %(table)s WHERE (SELECT COUNT(id) '
1687	                    'FROM books_%(ltable)s_link WHERE '
1688	                    '%(ltable_col)s=%(table)s.id) < 1;') % dict(
1689	                            ltable=ltable, table=table, ltable_col=ltable_col)
1690	            self.conn.execute(st)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1730:16
1729	        ans = self.conn.get(
1730	                'SELECT book FROM books_{tn}_link WHERE {col}=?'.format(
1731	                    tn=field['table'], col=field['link_column']), (id_,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:1780:8
1779	                self.prefs.set('user_categories', new_cats)
1780	        except:
1781	            pass
1782	        return new_cats

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1941:20
1940	        if ids is None:
1941	            query = '''SELECT id, {0}, count, avg_rating, sort
1942	                       FROM tag_browser_{1}'''.format(cn, tn)
1943	        else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:1944:20
1943	        else:
1944	            query = '''SELECT id, {0}, count, avg_rating, sort
1945	                       FROM tag_browser_filtered_{1}'''.format(cn, tn)
1946	        # results will be sorted later

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:2723:12
2722	        bks = self.conn.get(
2723	            'SELECT book from books_{0}_link WHERE {1}=?'.format(table, link),
2724	            (id,))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:3059:14
3058	            self.conn.execute(
3059	              '''DELETE FROM books_tags_link WHERE
3060	                    book IN (SELECT id FROM %s) AND
3061	                    tag IN (SELECT id FROM %s)'''
3062	              % (tables[0], tables[2]))
3063	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:3066:12
3065	            self.conn.execute(
3066	            '''
3067	            INSERT OR REPLACE INTO books_tags_link(book, tag) SELECT {0}.id, {1}.id FROM
3068	            {0}, {1}
3069	            '''.format(tables[0], tables[1])
3070	            )

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:3636:8
3635	            os.unlink(opath)
3636	        except:
3637	            pass
3638	        for dir in old_dirs:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:3641:12
3640	                shutil.rmtree(dir)
3641	            except:
3642	                pass
3643	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:3678:31
3677	        for table in tables:
3678	            rows = db.conn.get('SELECT * FROM %s ORDER BY id ASC'%table)
3679	            for row in rows:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:3747:8
3746	            return json.loads(s, object_hook=from_json)
3747	        except:
3748	            pass
3749	        return default

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\library\database2.py:3761:8
3760	            return res
3761	        except:
3762	            pass
3763	        return default

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\library\database2.py:3783:12
3782	        return self.conn.get(
3783	            'SELECT {0}, count(*) FROM books_{1}_link GROUP BY {0}'.format(
3784	                fm['link_column'], fm['table']))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ptempfile.py:20:4
19	            oss.remove(path)
20	    except:
21	        pass
22	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ptempfile.py:31:4
30	        shutil.rmtree(x, ignore_errors=True)
31	    except:
32	        pass
33	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ptempfile.py:52:4
51	        shutil.rmtree(x, ignore_errors=True)
52	    except:
53	        pass
54	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\ptempfile.py:69:8
68	    if iswindows and _base_dir:
69	        import subprocess
70	        from calibre import prints

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\ptempfile.py:72:18
71	        parent = os.path.dirname(_base_dir)
72	        retcode = subprocess.Popen(['icacls.exe', parent, '/reset', '/Q', '/T']).wait()
73	        prints('Trying to reset permissions of temp folder', parent, 'return code:', retcode)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\ptempfile.py:72:18
71	        parent = os.path.dirname(_base_dir)
72	        retcode = subprocess.Popen(['icacls.exe', parent, '/reset', '/Q', '/T']).wait()
73	        prints('Trying to reset permissions of temp folder', parent, 'return code:', retcode)

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\ptempfile.py:108:12
107	        if td is not None:
108	            import cPickle, binascii
109	            try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\ptempfile.py:207:8
206	            self.close()
207	        except:
208	            pass
209	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\spell\__init__.py:9:0
8	
9	import cPickle
10	from collections import namedtuple

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\spell\import_from.py:11:0
10	
11	from lxml import etree
12	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\spell\import_from.py:29:11
28	    ans = {}
29	    root = etree.fromstring(raw)
30	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\spell\import_from.py:126:15
125	
126	        root = etree.fromstring(zf.open('META-INF/manifest.xml').read())
127	        xcu = XPath('//manifest:file-entry[@manifest:media-type="application/vnd.sun.star.configuration-data"]')(root)[0].get(

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\srv\auth.py:70:11
69	def md5_hex(s):
70	    return md5(as_bytestring(s)).hexdigest().decode('ascii')
71	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\auth.py:111:4
110	        return timestamp + max_age_seconds < monotonic()
111	    except Exception:
112	        pass
113	    return True

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\srv\auth.py:244:50
243	        self.log = log
244	        self.secret = binascii.hexlify(os.urandom(random.randint(20, 30))).decode('ascii')
245	        self.max_age_seconds = max_age_seconds

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\srv\auth.py:246:44
245	        self.max_age_seconds = max_age_seconds
246	        self.key_order = '{%d}:{%d}:{%d}' % random.choice(tuple(permutations((0,1,2))))
247	        self.realm = realm

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\srv\auto_reload.py:9:0
8	
9	import os, sys, subprocess, signal, time, errno, socket, ssl
10	from threading import Thread, Lock

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\srv\auto_reload.py:309:17
308	        self.retry_count = 0
309	        self.p = subprocess.Popen(self.cmd, creationflags=getattr(subprocess, 'CREATE_NEW_PROCESS_GROUP', 0))
310	        self.wait_for_listen()

--------------------------------------------------
>> Issue: [B504:ssl_with_no_version] ssl.wrap_socket call with no SSL/TLS protocol version specified, the default SSLv23 could be insecure, possible security issue.
   Severity: Low   Confidence: Medium
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b504_ssl_with_no_version.html
   Location: .\src\calibre\srv\auto_reload.py:320:24
319	                if self.uses_ssl:
320	                    s = ssl.wrap_socket(s)
321	                s.connect(('localhost', self.port))

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with dumps module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\srv\books.py:10:0
9	from threading import RLock, Lock
10	from cPickle import dumps
11	from zipfile import ZipFile

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\srv\books.py:55:11
54	    raw = dumps((library_uuid, book_id, fmt.upper(), size, mtime, RENDER_VERSION))
55	    return sha1(raw).hexdigest().decode('ascii')
56	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\src\calibre\srv\books.py:198:8
197	            book_id = int(book_id)
198	        except Exception:
199	            continue
200	        if book_id not in allowed_book_ids:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\content.py:309:20
308	                        w, h = map(int, rest.split('_'))
309	                    except Exception:
310	                        pass
311	            elif sz == 'full':

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\content.py:316:16
315	                    w, h = map(int, sz.partition('x')[::2])
316	                except Exception:
317	                    pass
318	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\content.py:321:16
320	                    w = h = int(sz)
321	                except Exception:
322	                    pass
323	            return cover(ctx, rd, library_id, db, book_id, width=w, height=h)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\embedded.py:91:20
90	                        self.start_failure_callback(as_unicode(e))
91	                    except Exception:
92	                        pass
93	                return

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\embedded.py:113:16
112	                    self.start_failure_callback(as_unicode(e))
113	                except Exception:
114	                    pass
115	            return

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\embedded.py:119:12
118	                self.state_callback(True)
119	            except Exception:
120	                pass
121	        reset_caches()  # we reset the cache as the server tdir has changed

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\embedded.py:129:12
128	                self.state_callback(False)
129	            except Exception:
130	                pass
131	

--------------------------------------------------
>> Issue: [B410:blacklist] Using tostring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace tostring with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\srv\legacy.py:8:0
7	from functools import partial
8	from lxml.html import tostring
9	from lxml.html.builder import E as E_

--------------------------------------------------
>> Issue: [B410:blacklist] Using E to parse untrusted XML data is known to be vulnerable to XML attacks. Replace E with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\srv\legacy.py:9:0
8	from lxml.html import tostring
9	from lxml.html.builder import E as E_
10	from urllib import urlencode

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\srv\legacy.py:259:8
258	        redirect = ctx.url_for(None) + '#book_id=' + rest[5:] + "&amp;panel=book_details"
259	        from lxml import etree as ET
260	        return html(ctx, rd, endpoint,

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\srv\loop.py:352:18
351	            # AI_PASSIVE does not work with host of '' or None
352	            ba = ('0.0.0.0', ba[1])
353	        self.bind_address = ba

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\srv\opds.py:13:0
12	
13	from lxml import etree, html
14	from lxml.builder import ElementMaker

--------------------------------------------------
>> Issue: [B410:blacklist] Using ElementMaker to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementMaker with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\srv\opds.py:14:0
13	from lxml import etree, html
14	from lxml.builder import ElementMaker
15	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\srv\opds.py:47:8
46	    else:
47	        from lxml import etree
48	        ans = etree.tostring(output, encoding='utf-8', xml_declaration=True, pretty_print=True)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\srv\opds.py:105:36
104	    href = url_for('/opds/navcatalog', which=hexlify(query))
105	    id_ = 'calibre-navcatalog:'+str(hashlib.sha1(href).hexdigest())
106	    return E.entry(

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\srv\opds.py:129:15
128	    try:
129	        return etree.fromstring(raw)
130	    except:

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\srv\opds.py:140:19
139	        try:
140	            return etree.fromstring(raw)
141	        except:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\srv\opts.py:111:17
110	    _('The interface on which to listen for connections'),
111	    'listen_on', '0.0.0.0',
112	    _('The default is to listen on all available interfaces. You can change this to, for'
113	    ' example, "127.0.0.1" to only listen for connections from the local machine, or'
114	    ' to "::" to listen to all incoming IPv6 and IPv4 connections.'),
115	
116	    _('Fallback to auto-detected interface'),
117	    'fallback_to_detected_interface', True,
118	    _('If for some reason the server is unable to bind to the interface specified in'
119	    ' the listen_on option, then it will try to detect an interface that connects'
120	    ' to the outside world and bind to that.'),
121	
122	    _('Zero copy file transfers for increased performance'),
123	    'use_sendfile', True,
124	    _('This will use zero-copy in-kernel transfers when sending files over the network,'
125	    ' increasing performance. However, it can cause corrupted file transfers on some'
126	    ' broken filesystems. If you experience corrupted file transfers, turn it off.'),
127	
128	    _('Max. log file size (in MB)'),
129	    'max_log_size', 20,
130	    _('The maximum size of log files, generated by the server. When the log becomes larger'
131	    ' than this size, it is automatically rotated. Set to zero to disable log rotation.'),
132	
133	    _('Log HTTP 404 (Not Found) requests'),
134	    'log_not_found', True,
135	    _('Normally, the server logs all HTTP requests for resources that are not found.'
136	    ' This can generate a lot of log spam, if your server is targeted by bots.'
137	    ' Use this option to turn it off.'),
138	
139	    _('Password based authentication to access the server'),
140	    'auth', False,
141	    _('Normally, the server is unrestricted, allowing anyone to access it. You can'
142	    ' restrict access to predefined users with this option.'),
143	
144	    _('Allow un-authenticated local connections to make changes'),
145	    'local_write', False,
146	    _('Normally, if you do not turn on authentication, the server operates in'
147	      ' read-only mode, so as to not allow anonymous users to make changes to your'
148	      ' calibre libraries. This option allows anybody connecting from the same'
149	      ' computer as the server is running on to make changes. This is useful'
150	      ' if you want to run the server without authentication but still'
151	      ' use calibredb to make changes to your calibre libraries. Note that'
152	      ' turning on this option means any program running on the computer'
153	      ' can make changes to your calibre libraries.'),
154	
155	    _('Path to user database'),
156	    'userdb', None,
157	    _('Path to a file in which to store the user and password information. Normally a'
158	    ' file in the calibre configuration directory is used.'),
159	
160	    _('Choose the type of authentication used'), 'auth_mode', Choices('auto', 'basic', 'digest'),
161	    _('Set the HTTP authentication mode used by the server. Set to "basic" if you are'
162	    ' putting this server behind an SSL proxy. Otherwise, leave it as "auto", which'
163	    ' will use "basic" if SSL is configured otherwise it will use "digest".'),
164	
165	    _('Ban IP addresses that have repeated login failures'), 'ban_for', 0,
166	    _('Temporarily bans access for IP addresses that have repeated login failures for the'
167	      ' specified number of minutes. Useful to prevent attempts at guessing passwords. If'
168	      ' set to zero, no banning is done.'),
169	
170	    _('Number of login failures for ban'), 'ban_after', 5,
171	    _('The number of login failures after which an IP address is banned'),
172	
173	    _('Ignored user-defined metadata fields'),
174	    'ignored_fields', None,
175	    _('Comma separated list of user-defined metadata fields that will not be displayed'
176	      ' by the Content server in the /opds and /mobile views. For example: {}').format(
177	      'my_rating,my_tags'),
178	
179	    _('Restrict displayed user-defined fields'),
180	    'displayed_fields', None,
181	    _('Comma separated list of user-defined metadata fields that will be displayed'
182	      ' by the Content server in the /opds and /mobile views. If you specify this'
183	      ' option, any fields not in this list will not be displayed. For example: {}').format(
184	      'my_rating,my_tags'),
185	
186	
187	)
188	assert len(raw_options) % 4 == 0
189	
190	options = []
191	
192	
193	def grouper(n, iterable, fillvalue=None):
194	    "grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx"
195	    args = [iter(iterable)] * n
196	    return izip_longest(*args, fillvalue=fillvalue)
197	
198	
199	for shortdoc, name, default, doc in grouper(4, raw_options):
200	    choices = None
201	    if isinstance(default, Choices):
202	        choices = sorted(default)
203	        default = default.default
204	    options.append(Option(name, default, doc, shortdoc, choices))
205	options = OrderedDict([(o.name, o) for o in sorted(options, key=attrgetter('name'))])
206	del raw_options
207	
208	
209	class Options(object):
210	
211	    __slots__ = tuple(name for name in options)
212	
213	    def __init__(self, **kwargs):
214	        for opt in options.itervalues():
215	            setattr(self, opt.name, kwargs.get(opt.name, opt.default))
216	
217	
218	def opt_to_cli_help(opt):
219	    ans = opt.shortdoc
220	    if not ans.endswith('.'):
221	        ans += '.'
222	    if opt.longdoc:
223	        ans += '\n\t' + opt.longdoc
224	    return ans
225	
226	
227	def bool_callback(option, opt_str, value, parser, *args, **kwargs):
228	    setattr(parser.values, option.dest, opt_str.startswith('--enable-'))
229	
230	
231	def boolean_option(add_option, opt):
232	    name = opt.name.replace('_', '-')
233	    help = opt_to_cli_help(opt)
234	    help += '\n' + (_('By default, this option is enabled.') if opt.default else _('By default, this option is disabled.'))
235	    add_option('--enable-' + name, '--disable-' + name, action='callback', callback=bool_callback, help=help)
236	
237	
238	def opts_to_parser(usage):
239	    from calibre.utils.config import OptionParser
240	    parser =  OptionParser(usage)
241	    for opt in options.itervalues():
242	        add_option = partial(parser.add_option, dest=opt.name, help=opt_to_cli_help(opt), default=opt.default)
243	        if opt.default is True or opt.default is False:
244	            boolean_option(add_option, opt)
245	        elif opt.choices:
246	            name = '--' + opt.name.replace('_', '-')
247	            add_option(name, choices=opt.choices)
248	        else:
249	            name = '--' + opt.name.replace('_', '-')
250	            otype = 'string'
251	            if isinstance(opt.default, (int, long, float)):
252	                otype = type(opt.default).__name__
253	            add_option(name, type=otype)
254	
255	    return parser
256	
257	
258	DEFAULT_CONFIG = os.path.join(config_dir, 'server-config.txt')
259	
260	
261	def parse_config_file(path=DEFAULT_CONFIG):
262	    try:
263	        with ExclusiveFile(path) as f:
264	            raw = f.read().decode('utf-8')
265	    except EnvironmentError as err:
266	        if err.errno != errno.ENOENT:
267	            raise
268	        raw = ''
269	    ans = {}
270	    for line in raw.splitlines():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\srv\opts.py:188:0
187	)
188	assert len(raw_options) % 4 == 0
189	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\pre_activated.py:38:4
37	        systemd.sd_listen_fds
38	    except Exception:
39	        pass
40	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\calibre\srv\routes.py:142:52
141	                        raise route_error('The characters {} are not allowed in default values')
142	                    default = self.defaults[name] = eval(default)
143	                    if isinstance(default, (int, long, float)):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\sendfile.py:21:4
20	        return os.fstat(fd)
21	    except Exception:
22	        pass
23	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\calibre\srv\tests\ajax.py:110:26
109	            def r(path, status=OK, method='GET'):
110	                r, data = make_request(conn, path, username='12', password='test', prefix='', method=method)
111	                ae(status, r.status)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\calibre\srv\tests\ajax.py:129:19
128	            ae(set(r(url_for('/ajax/search?vl=1'))['book_ids']), {1})
129	            data = make_request(conn, '/ajax/search', username='inv', password='test', prefix='', method='GET')[1]
130	            ae(data['bad_restriction'], 'Invalid syntax. Expected a lookup name or a word')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\calibre\srv\tests\ajax.py:170:26
169	            def a(filename, data=None, status=OK, method='POST', username='12', add_duplicates='n', job_id=1):
170	                r, data = make_request(conn, '/cdb/add-book/{}/{}/{}'.format(job_id, add_duplicates, quote(filename.encode('utf-8')).decode('ascii')),
171	                                       username=username, password='test', prefix='', method=method, data=data)
172	                ae(status, r.status)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\calibre\srv\tests\ajax.py:177:26
176	                book_ids = ','.join(map(str, book_ids))
177	                r, data = make_request(conn, '/cdb/delete-books/{}'.format(book_ids),
178	                                       username=username, password='test', prefix='', method='POST')
179	                ae(status, r.status)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\calibre\srv\tests\ajax.py:190:19
189	            ae(data,  {'title': mi.title, 'book_id': data['book_id'], 'authors': mi.authors, 'languages': mi.languages, 'id': '1', 'filename': filename})
190	            r, q = make_request(conn, '/get/txt/{}'.format(data['book_id']), username='12', password='test', prefix='')
191	            ae(r.status, OK)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\srv\tests\auth.py:9:0
8	
9	import httplib, base64, urllib2, subprocess, os, cookielib, time
10	from collections import namedtuple

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\srv\tests\auth.py:234:24
233	                    cmd = [curl] + list(args) + ['http://localhost:%d/closed' % server.address[1]]
234	                    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=open(os.devnull, 'wb'))
235	                    x = p.stdout.read()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testpw'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\calibre\srv\tests\auth.py:281:12
280	            url = 'http://localhost:%d%s' % (server.address[1], '/android')
281	            auth_handler.add_password(realm=REALM, uri=url, user='testuser', passwd='testpw')
282	            cj = cookielib.CookieJar()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\srv\tests\auth.py:297:16
296	                urllib2.build_opener(cookie_handler).open(url+'2')
297	                assert ('Replay attack succeeded')
298	            except urllib2.HTTPError as e:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\srv\tests\web_sockets.py:66:33
65	        headers = read_headers(partial(next, lines))
66	        key = standard_b64encode(sha1(self.key + GUID_STR).digest())
67	        if headers.get('Sec-WebSocket-Accept') != key:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\utils.py:258:12
257	                q = max(0.0, min(1.0, float(v.strip())))
258	            except Exception:
259	                pass
260	        return e.strip(), q

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\srv\web_socket.py:292:54
291	
292	        response = HANDSHAKE_STR % standard_b64encode(sha1(key + GUID_STR).digest())
293	        self.optimize_for_sending_packet()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\srv\web_socket.py:471:12
470	                        self.write(self.control_frames.pop())
471	            except Exception:
472	                pass
473	            Connection.close(self)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\test_build.py:99:8
98	        test_clean_xml_chars()
99	        from lxml import etree
100	        raw = '<a/>'

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\test_build.py:101:15
100	        raw = '<a/>'
101	        root = etree.fromstring(raw)
102	        self.assertEqual(etree.tostring(root), raw)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\translations\dynamic.py:29:16
28	                    buf = cStringIO.StringIO(zf.read(mpath + '/messages.mo'))
29	                except:
30	                    pass
31	                else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\apsw_shell.py:23:4
22	        _win_colour=True
23	    except:  # there are several failure reasons, ignore them all
24	        pass
25	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\calibre\utils\apsw_shell.py:342:19
341	
342	    _binary_type = eval(("buffer", "bytes")[sys.version_info>=(3,0)])
343	    _basestring = eval(("basestring", "str")[sys.version_info>=(3,0)])

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\calibre\utils\apsw_shell.py:343:18
342	    _binary_type = eval(("buffer", "bytes")[sys.version_info>=(3,0)])
343	    _basestring = eval(("basestring", "str")[sys.version_info>=(3,0)])
344	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:600:8
599	        # csv lib always does DOS eol
600	        assert(t.endswith("\r\n"))
601	        t=t[:-2]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:603:8
602	        # should not be other eol irregularities
603	        assert(not t.endswith("\r") and not t.endswith("\n"))
604	        self.write(self.stdout, t+"\n")

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\apsw_shell.py:739:16
738	                    readline.read_history_file(os.path.expanduser(self.history_file))
739	                except:
740	                    # We only expect IOError here but if the history
741	                    # file does not exist and this code has been
742	                    # compiled into the module it is possible to get
743	                    # an IOError that doesn't match the IOError from
744	                    # Python parse time resulting in an IOError
745	                    # exception being raised.  Consequently we just
746	                    # catch all exceptions.
747	                    pass
748	        except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:925:8
924	            cmd=shlex.split(cmd)
925	        assert cmd[0][0]=="."
926	        cmd[0]=cmd[0][1:]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1084:52
1083	                for name in tables:
1084	                    if len(self.db.cursor().execute("select * from "+self._fmt_sql_identifier(stat[0])+" WHERE tbl=?", (name,)).fetchall()):
1085	                        if name not in analyze_needed:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1169:52
1168	                        if sql[0].lower().split()[:3]==["create", "virtual", "table"]:
1169	                            self.write(self.stdout, "DELETE FROM sqlite_master WHERE name="+apsw.format_sql_value(table)+" AND type='table';\n")
1170	                            self.write(self.stdout, "INSERT INTO sqlite_master(type,name,tbl_name,rootpage,sql) VALUES('table',%s,%s,0,%s);\n"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1176:45
1175	                            self._output_table=self._fmt_sql_identifier(table)
1176	                            self.process_sql("select * from "+self._fmt_sql_identifier(table), internal=True)
1177	                        # Now any indices or triggers

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1191:57
1190	                first=True
1191	                for name,sql in self.db.cursor().execute("SELECT name,sql FROM sqlite_master "
1192	                                                         "WHERE sql NOT NULL AND type='view' "
1193	                                                         "AND name IN ( "+",".join([apsw.format_sql_value(i) for i in tables])+
1194	                                                         ") ORDER BY _ROWID_"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:1210:28
1209	                        if len(v):
1210	                            assert len(v)==1
1211	                            if first:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1215:52
1214	                                first=False
1215	                            self.write(self.stdout, 'DELETE FROM main.sqlite_sequence WHERE name=%s;\n' % (apsw.format_sql_value(t),))
1216	                            self.write(self.stdout, 'INSERT INTO main.sqlite_sequence VALUES (%s, %s);\n' % (apsw.format_sql_value(t), v[0][0]))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1216:52
1215	                            self.write(self.stdout, 'DELETE FROM main.sqlite_sequence WHERE name=%s;\n' % (apsw.format_sql_value(t),))
1216	                            self.write(self.stdout, 'INSERT INTO main.sqlite_sequence VALUES (%s, %s);\n' % (apsw.format_sql_value(t), v[0][0]))
1217	                    if not first:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:1409:18
1408	            t=self._fmt_sql_identifier(table)
1409	            query="SELECT * from %s WHERE " % (t,)
1410	            colq=[]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:1444:16
1443	                d=getattr(self, c).__doc__
1444	                assert d, c+" command must have documentation"
1445	                c=c[len("command_"):]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:1452:16
1451	                firstline=parts[0].strip().split(":", 1)
1452	                assert len(firstline)==2, c+" command must have usage: description doc"
1453	                if len(parts)==1 or len(parts[1].strip())==0:  # work around textwrap bug

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:1972:12
1971	            d=getattr(self, "output_"+m).__doc__
1972	            assert d, "output mode "+m+" needs doc"
1973	            d=d.replace("\n", " ").strip()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\src\calibre\utils\apsw_shell.py:2086:16
2085	                # compile step is needed to associate name with code
2086	                exec(compile(open(cmd[0]).read(), cmd[0], 'exec'), g, g)
2087	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:2213:20
2212	                else:
2213	                    assert False, "Bug: didn't find output mode"
2214	            elif i=="output":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:2226:16
2225	            else:
2226	                assert False, "Bug: unknown show handling"
2227	            outs.append((k,v))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:2366:8
2365	        # first item should always be present
2366	        assert len(self._output_stack)
2367	        if len(self._output_stack)==1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\apsw_shell.py:2546:8
2545	        """
2546	        assert(len(self._input_stack))>1
2547	        d=self._input_stack.pop()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\src\calibre\utils\apsw_shell.py:2689:39
2688	                    master="[%s].sqlite_master" % (db,)
2689	                for row in cur.execute("select * from "+master).fetchall():
2690	                    for col in (1,2):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\apsw_shell.py:2929:4
2928	        del v
2929	    except:
2930	        pass
2931	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\bibtex.py:2611:8
2610	        stack = []
2611	        assert len(open_character) == 1 and len(close_character) == 1
2612	        remove = []

--------------------------------------------------
>> Issue: [B323:blacklist] By default, Python will create a secure, verified ssl context for use in such classes as HTTPSConnection. However, it still allows using an insecure context via the _create_unverified_context that  reverts to the previous behavior that does not validate certificates or perform hostname checks.
   Severity: Medium   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b323-unverified-context
   Location: .\src\calibre\utils\browser.py:47:85
46	        if sc is None:
47	            sc = ssl.create_default_context() if kwargs.pop('verify_ssl', True) else ssl._create_unverified_context(cert_reqs=ssl.CERT_NONE)
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\browser.py:168:4
167	    pprint(clone._ua_handlers)
168	    assert orig._ua_handlers.keys() == clone._ua_handlers.keys()
169	    assert orig._ua_handlers['_cookies'].cookiejar is \

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\browser.py:169:4
168	    assert orig._ua_handlers.keys() == clone._ua_handlers.keys()
169	    assert orig._ua_handlers['_cookies'].cookiejar is \
170	            clone._ua_handlers['_cookies'].cookiejar
171	    assert orig.addheaders == clone.addheaders

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\browser.py:171:4
170	            clone._ua_handlers['_cookies'].cookiejar
171	    assert orig.addheaders == clone.addheaders

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\chm\chmlib.py:78:8
77	                destroy(self)
78	        except:
79	            pass
80	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\utils\complete.py:15:0
14	
15	import sys, os, shlex, glob, re, cPickle
16	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\complete.py:143:20
142	                        ans += list(get_opts_from_parser(parser, self.prefix))
143	                    except:
144	                        pass
145	            if self.previous.startswith('-'):

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\utils\exim.py:21:8
20	def send_file(from_obj, to_obj, chunksize=1<<20):
21	    m = hashlib.sha1()
22	    while True:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\utils\exim.py:35:22
34	        self.exporter, self.key = exporter, key
35	        self.hasher = hashlib.sha1()
36	        self.start_pos = exporter.f.tell()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\utils\exim.py:218:22
217	        self.end = f.tell() + size
218	        self.hasher = hashlib.sha1()
219	        self.importer = importer

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\filenames.py:179:8
178	            candidates = [c for c in os.listdir(cpath) if c.lower() == cl]
179	        except:
180	            # Dont have permission to do the listdir, assume the case is
181	            # correct as we have no way to check it.
182	            pass
183	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\filenames.py:376:12
375	                win32file.SetFileAttributes(f, win32file.FILE_ATTRIBUTE_NORMAL)
376	            except:
377	                pass
378	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\filenames.py:429:8
428	            return
429	        except:
430	            pass
431	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\filenames.py:581:4
580	        shutil.copystat(src, dest)
581	    except Exception:
582	        pass
583	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\fonts\scanner.py:278:12
277	                return supports_text(raw, text)
278	            except:
279	                pass
280	            return False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\fonts\sfnt\cmap.py:53:4
52	        sub_ranges.append((ordered_begin, last_code))
53	    assert last_code == end_code
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\fonts\sfnt\cmap.py:95:4
94	
95	    assert len(start) + 1 == len(end)
96	    return start, end

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\fonts\win_fonts.py:94:12
93	                family_name, sub_family_name, full_name = get_font_names(data)
94	            except:
95	                pass
96	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\html2text.py:23:0
22	    from textwrap import wrap
23	except:
24	    pass
25	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\calibre\utils\html2text.py:131:4
130	
131	    assert wrap, "Requires Python 2.3."
132	    result = ''

--------------------------------------------------
>> Issue: [B323:blacklist] By default, Python will create a secure, verified ssl context for use in such classes as HTTPSConnection. However, it still allows using an insecure context via the _create_unverified_context that  reverts to the previous behavior that does not validate certificates or perform hostname checks.
   Severity: Medium   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b323-unverified-context
   Location: .\src\calibre\utils\https.py:40:36
39	            if cafile is None:
40	                kwargs['context'] = ssl._create_unverified_context()
41	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\https.py:193:12
192	                    break
193	            except Exception:
194	                # Invalid proxy, ignore
195	                pass
196	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\utils\img.py:10:0
9	import shutil
10	import subprocess
11	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\img.py:62:8
61	        creationflags = 0x08 if iswindows else 0
62	        subprocess.Popen(cmd, cwd=tdir, stdout=lopen(os.devnull, 'wb'), stderr=subprocess.STDOUT, creationflags=creationflags).wait()
63	        i = QImage()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\img.py:476:12
475	        creationflags = 0x08 if iswindows else 0
476	        p = subprocess.Popen(cmd, cwd=cwd, stdout=subprocess.PIPE, stderr=stderr, stdin=stdin, creationflags=creationflags)
477	        stderr = p.stderr if as_filter else p.stdout

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\img.py:574:10
573	    image_to_data(img, fmt='GIF')
574	    raw = subprocess.Popen([get_exe_path('JxrDecApp'), '-h'], creationflags=0x08 if iswindows else 0, stdout=subprocess.PIPE).stdout.read()
575	    if b'JPEG XR Decoder Utility' not in raw:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\img.py:599:16
598	                    v = float(v)
599	                except Exception:
600	                    pass
601	            kw[n] = v

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\utils\ip_routing.py:7:0
6	                        print_function)
7	import subprocess, re
8	from calibre.constants import iswindows, isosx

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\ip_routing.py:33:14
32	        # Use -6 for IPv6 addresses
33	        raw = subprocess.check_output('route -4 print 0.0.0.0'.split(), creationflags=0x08).decode('utf-8', 'replace')
34	        in_table = False

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\utils\ip_routing.py:52:56
51	        for route in routes():
52	            if route.interface and route.destination == '0.0.0.0':
53	                for addr in get_addresses_for_interface(route.interface):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\ip_routing.py:63:14
62	        # Use -inet6 for IPv6
63	        raw = subprocess.check_output('route -n get -inet default'.split()).decode('utf-8')
64	        m = re.search(r'^\s*interface:\s*(\S+)\s*$', raw, flags=re.MULTILINE)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\job.py:66:16
65	                        safe_encode=True)
66	                except:
67	                    pass
68	            if not self._done_called:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\job.py:72:16
71	                    self.done(self)
72	                except:
73	                    pass
74	                try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\job.py:77:16
76	                        self.done2(self)
77	                except:
78	                    pass
79	        elif self.start_time is not None:

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\utils\ipc\launch.py:9:0
8	
9	import subprocess, os, sys, time, binascii, cPickle
10	from functools import partial

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\launch.py:29:4
28	        os.nice(niceness)
29	    except:
30	        pass
31	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\launch.py:104:12
103	                env[key] = val
104	            except:
105	                pass
106	        env[b'CALIBRE_WORKER'] = b'1'

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\launch.py:132:8
131	            self._file.close()
132	        except:
133	            pass
134	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\launch.py:149:8
148	                        self.child.kill()
149	        except:
150	            pass
151	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\launch.py:167:12
166	                self._env[k] = v
167	            except:
168	                pass
169	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\ipc\launch.py:228:21
227	
228	        self.child = subprocess.Popen(cmd, **args)
229	        if 'stdin' in args:

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\utils\ipc\pool.py:9:0
8	
9	import os, cPickle, sys
10	from threading import Thread

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\utils\ipc\pool.py:44:12
43	            # We are running in a windows console with calibre-debug -g
44	            import subprocess
45	            get_stdout_from_child = True

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\pool.py:307:16
306	                    w(None)
307	                except Exception:
308	                    pass
309	            for w in workers:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\pool.py:312:16
311	                    w.wait()
312	                except Exception:
313	                    pass
314	        reaper = Thread(target=join, name='ReapPoolWorkers')

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\pool.py:321:12
320	                w.conn.close()
321	            except Exception:
322	                pass
323	        for w in workers:

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\utils\ipc\proxy.py:10:0
9	
10	import os, cPickle, struct
11	from threading import Thread

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\proxy.py:113:8
112	            self.listener.close()
113	        except:
114	            pass
115	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\proxy.py:121:12
120	                self.handle_client(conn)
121	            except:
122	                pass
123	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\proxy.py:136:16
135	                    conn.close()
136	                except:
137	                    pass
138	                return

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\proxy.py:145:20
144	                        conn.close()
145	                    except:
146	                        pass
147	                    prints('Proxy function: %s with args: %r and'

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\ipc\proxy.py:165:20
164	                            as_unicode(traceback.format_exc()))))))
165	                    except:
166	                        pass
167	                raise

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\iso8601.py:25:8
24	            return super(SafeLocalTimeZone, self)._isdst(dt)
25	        except Exception:
26	            pass
27	        return False

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\iso8601.py:35:8
34	            return super(SafeLocalTimeZone, self)._naive_is_dst(dt)
35	        except Exception:
36	            pass
37	        return False

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\utils\localization.py:9:0
8	
9	import os, locale, re, cStringIO, cPickle
10	from gettext import GNUTranslations, NullTranslations

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:37:8
36	                lang = None
37	        except:
38	            pass  # Windows XP does not have the GetUserDefaultLocaleName fn
39	    elif isosx:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:58:8
57	                        break
58	        except:
59	            pass  # This happens on Ubuntu apparently
60	        if lang is None and 'LANG' in os.environ:  # Needed for OS X

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:63:12
62	                lang = os.environ['LANG']
63	            except:
64	                pass
65	    if lang:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:222:16
221	                    iso639 = cStringIO.StringIO(zf.read(isof))
222	                except:
223	                    pass  # No iso639 translations for this lang
224	                if buf is not None:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:227:20
226	                        lcdata = cPickle.loads(zf.read(mpath + '/lcdata.pickle'))
227	                    except:
228	                        pass  # No lcdata
229	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:241:4
240	        set_translators.lang = t.info().get('language')
241	    except Exception:
242	        pass
243	    t.install(unicode=True, names=('ngettext',))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\localization.py:384:4
383	        return translate(iso639['by_3t'][lc])
384	    except:
385	        pass
386	    return lc

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\src\calibre\utils\matcher.py:40:32
39	        self.requests, self.results = requests, results
40	        atexit.register(lambda: requests.put(None))
41	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\utils\mdns.py:82:21
81	    result = None
82	    if ip_address != '0.0.0.0' and ip_address != '::':
83	        # do some more sanity checks on the address

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\mdns.py:136:12
135	                desc += ' (on %s)'%hostname
136	            except:
137	                pass
138	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\src\calibre\utils\open_with\linux.py:9:0
8	
9	import re, shlex, os, cPickle
10	from collections import defaultdict

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\utils\open_with\osx.py:9:0
8	
9	import os, plistlib, re, mimetypes, subprocess
10	from collections import defaultdict

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\utils\open_with\osx.py:21:4
20	def generate_public_uti_map():
21	    from lxml import etree
22	    import urllib

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\utils\open_with\osx.py:319:12
318	        try:
319	            subprocess.check_call(['iconutil', '-c', 'iconset', '-o', 'output.iconset', path], cwd=tdir)
320	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\open_with\osx.py:319:12
318	        try:
319	            subprocess.check_call(['iconutil', '-c', 'iconset', '-o', 'output.iconset', path], cwd=tdir)
320	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\utils\opensearch\description.py:14:0
13	
14	from lxml import etree
15	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\calibre\utils\opensearch\description.py:41:18
40	        with closing(br.open(url, timeout=15)) as f:
41	            doc = etree.fromstring(f.read())
42	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\utils\random_ua.py:28:11
27	def random_firefox_version():
28	    return random.choice(all_firefox_versions())
29	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\utils\random_ua.py:32:11
31	def random_desktop_platform():
32	    return random.choice(user_agent_data()['desktop_platforms'])
33	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\utils\random_ua.py:50:11
49	def random_chrome_version():
50	    return random.choice(all_chrome_versions())
51	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\calibre\utils\random_ua.py:80:11
79	def random_user_agent():
80	    return random.choice(all_user_agents())
81	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\utils\rapydscript.py:13:0
12	import shutil
13	import subprocess
14	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\src\calibre\utils\rapydscript.py:41:10
40	    base = os.path.join(base, 'rapydscript')
41	    raw = subprocess.check_output(['node', '--harmony', os.path.join(base, 'bin', 'export')])
42	    if isinstance(raw, type('')):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\rapydscript.py:41:10
40	    base = os.path.join(base, 'rapydscript')
41	    raw = subprocess.check_output(['node', '--harmony', os.path.join(base, 'bin', 'export')])
42	    if isinstance(raw, type('')):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\rapydscript.py:145:14
144	    try:
145	        raw = subprocess.check_output([rs, '--version'])
146	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\rapydscript.py:176:8
175	        args.append('--filename-for-stdin'), args.append(filename)
176	    p = subprocess.Popen([has_external_compiler, 'compile'] + args, stdout=subprocess.PIPE, stdin=subprocess.PIPE, stderr=subprocess.PIPE)
177	    js, stderr = p.communicate(data)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\recycle_bin.py:54:16
53	                    traceback.print_exc()  # goes to stderr, which is the same as for parent process
54	                except Exception:
55	                    pass  # Ignore failures to write the traceback, since GUI processes on windows have no stderr
56	            else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\resources.py:25:12
24	                       os.listdir(path)
25	            except:
26	                pass
27	            return False

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\src\calibre\utils\resources.py:114:40
113	                with open(js_name_to_path(name), 'rb') as f:
114	                    if existing_hash == hashlib.sha1(f.read()).hexdigest():
115	                        return zf.read(name + '.js')

--------------------------------------------------
>> Issue: [B406:blacklist] Using saxutils to parse untrusted XML data is known to be vulnerable to XML attacks. Replace saxutils with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\src\calibre\utils\rss_gen.py:17:8
16	    def write_xml(self, outfile, encoding="iso-8859-1"):
17	        from xml.sax import saxutils
18	        handler = saxutils.XMLGenerator(outfile, encoding)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\utils\serve_coffee.py:274:40
273	
274	def serve(resources={}, port=8000, host='0.0.0.0'):
275	    Handler.special_resources = resources

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\src\calibre\utils\serve_coffee.py:314:38
313	    cs.add_argument('--port', type=int, default=8000, help='The port on which to serve. Default: %default')
314	    cs.add_argument('--host', default='0.0.0.0', help='The IP address on which to listen. Default is to listen on all'
315	            ' IPv4 addresses (0.0.0.0)')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\calibre\utils\smartypants.py:462:27
461	
462	    prev_token_last_char = ""
463	    # This is a cheat, used to get some context

--------------------------------------------------
>> Issue: [B504:ssl_with_no_version] ssl.wrap_socket call with no SSL/TLS protocol version specified, the default SSLv23 could be insecure, possible security issue.
   Severity: Low   Confidence: Medium
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b504_ssl_with_no_version.html
   Location: .\src\calibre\utils\smtplib.py:674:24
673	                raise RuntimeError("No SSL support included in this Python")
674	            self.sock = ssl.wrap_socket(self.sock, keyfile, certfile)
675	            self.file = SSLFakeFile(self.sock)

--------------------------------------------------
>> Issue: [B504:ssl_with_no_version] ssl.wrap_socket call with no SSL/TLS protocol version specified, the default SSLv23 could be insecure, possible security issue.
   Severity: Low   Confidence: Medium
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b504_ssl_with_no_version.html
   Location: .\src\calibre\utils\smtplib.py:830:25
829	            new_socket = socket.create_connection((host, port), timeout)
830	            new_socket = ssl.wrap_socket(new_socket, self.keyfile, self.certfile)
831	            self.file = SSLFakeFile(new_socket)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\utils\soupparser.py:6:0
5	
6	from lxml import etree, html
7	from calibre.ebooks.BeautifulSoup import \

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\terminal.py:141:12
140	                    self.is_console = True
141	            except:
142	                pass
143	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\terminal.py:373:4
372	            os.close(fd)
373	    except Exception:
374	        pass
375	    return None, None

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\utils\terminal.py:391:8
390	                return cols, lines
391	        except Exception:
392	            pass
393	        return 80, 25

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\src\calibre\utils\test_lock.py:9:0
8	import shutil
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\src\calibre\utils\test_lock.py:57:11
56	                 for k, v in env.iteritems()}  # windows needs bytes in env
57	    return subprocess.Popen(exe, **kw)
58	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\calibre\web\feeds\recipes\model.py:119:20
118	                            p.loadFromData(zf.read(self.favicons[icon]))
119	                    except:
120	                        pass
121	                if not p.isNull():

--------------------------------------------------
>> Issue: [B410:blacklist] Using html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\web\feeds\templates.py:9:0
8	
9	from lxml import html, etree
10	from lxml.html.builder import HTML, HEAD, TITLE, STYLE, DIV, BODY, \

--------------------------------------------------
>> Issue: [B410:blacklist] Using HTML to parse untrusted XML data is known to be vulnerable to XML attacks. Replace HTML with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\calibre\web\feeds\templates.py:10:0
9	from lxml import html, etree
10	from lxml.html.builder import HTML, HEAD, TITLE, STYLE, DIV, BODY, \
11	        STRONG, BR, SPAN, A, HR, UL, LI, H2, H3, IMG, P as PT, \
12	        TABLE, TD, TR
13	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\parser.py:307:8
306	    def __init__(self, selector, combinator, subselector):
307	        assert selector is not None
308	        self.selector = selector

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\parser.py:695:12
694	            match = _match_string_by_quote[quote](s, pos=pos + 1)
695	            assert match, 'Should have found at least an empty match'
696	            end_pos = match.end()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\parser.py:727:4
726	
727	    assert pos == len_s
728	    yield EOFToken(pos)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\css_selectors\select.py:14:0
13	
14	from lxml import etree
15	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\css_selectors\select.py:618:11
617	    from pprint import pprint
618	    root = etree.fromstring('<body xmlns="xxx" xml:lang="en"><p id="p" class="one two" lang="fr"><a id="a"/><b/><c/><d/></p></body>')
619	    select = Select(root, ignore_inappropriate_pseudo_classes=True, trace=True)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\src\css_selectors\tests.py:11:0
10	
11	from lxml import etree, html
12	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:416:16
415	            for selector in selectors:
416	                assert selector.pseudo_element is None
417	            return [repr(selector.parsed_tree).replace("(u'", "('")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:423:16
422	            for other in others:
423	                assert repr_parse(other) == result
424	            return result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:426:8
425	
426	        assert parse_many('*') == ['Element[*]']
427	        assert parse_many('*|*') == ['Element[*]']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:427:8
426	        assert parse_many('*') == ['Element[*]']
427	        assert parse_many('*|*') == ['Element[*]']
428	        assert parse_many('*|foo') == ['Element[foo]']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:428:8
427	        assert parse_many('*|*') == ['Element[*]']
428	        assert parse_many('*|foo') == ['Element[foo]']
429	        assert parse_many('foo|*') == ['Element[foo|*]']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:429:8
428	        assert parse_many('*|foo') == ['Element[foo]']
429	        assert parse_many('foo|*') == ['Element[foo|*]']
430	        assert parse_many('foo|bar') == ['Element[foo|bar]']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:430:8
429	        assert parse_many('foo|*') == ['Element[foo|*]']
430	        assert parse_many('foo|bar') == ['Element[foo|bar]']
431	        # This will never match, but it is valid:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:432:8
431	        # This will never match, but it is valid:
432	        assert parse_many('#foo#bar') == ['Hash[Hash[Element[*]#foo]#bar]']
433	        assert parse_many(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:433:8
432	        assert parse_many('#foo#bar') == ['Hash[Hash[Element[*]#foo]#bar]']
433	        assert parse_many(
434	            'div>.foo',
435	            'div> .foo',
436	            'div >.foo',
437	            'div > .foo',
438	            'div \n>  \t \t .foo', 'div\r>\n\n\n.foo', 'div\f>\f.foo'
439	        ) == ['CombinedSelector[Element[div] > Class[Element[*].foo]]']
440	        assert parse_many('td.foo,.bar',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:440:8
439	        ) == ['CombinedSelector[Element[div] > Class[Element[*].foo]]']
440	        assert parse_many('td.foo,.bar',
441	            'td.foo, .bar',
442	            'td.foo\t\r\n\f ,\t\r\n\f .bar'
443	        ) == [
444	            'Class[Element[td].foo]',
445	            'Class[Element[*].bar]'
446	        ]
447	        assert parse_many('div, td.foo, div.bar span') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:447:8
446	        ]
447	        assert parse_many('div, td.foo, div.bar span') == [
448	            'Element[div]',
449	            'Class[Element[td].foo]',
450	            'CombinedSelector[Class[Element[div].bar] '
451	            '<followed> Element[span]]']
452	        assert parse_many('div > p') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:452:8
451	            '<followed> Element[span]]']
452	        assert parse_many('div > p') == [
453	            'CombinedSelector[Element[div] > Element[p]]']
454	        assert parse_many('td:first') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:454:8
453	            'CombinedSelector[Element[div] > Element[p]]']
454	        assert parse_many('td:first') == [
455	            'Pseudo[Element[td]:first]']
456	        assert parse_many('td:first') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:456:8
455	            'Pseudo[Element[td]:first]']
456	        assert parse_many('td:first') == [
457	            'Pseudo[Element[td]:first]']
458	        assert parse_many('td :first') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:458:8
457	            'Pseudo[Element[td]:first]']
458	        assert parse_many('td :first') == [
459	            'CombinedSelector[Element[td] '
460	            '<followed> Pseudo[Element[*]:first]]']
461	        assert parse_many('td :first') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:461:8
460	            '<followed> Pseudo[Element[*]:first]]']
461	        assert parse_many('td :first') == [
462	            'CombinedSelector[Element[td] '
463	            '<followed> Pseudo[Element[*]:first]]']
464	        assert parse_many('a[name]', 'a[ name\t]') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:464:8
463	            '<followed> Pseudo[Element[*]:first]]']
464	        assert parse_many('a[name]', 'a[ name\t]') == [
465	            'Attrib[Element[a][name]]']
466	        assert parse_many('a [name]') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:466:8
465	            'Attrib[Element[a][name]]']
466	        assert parse_many('a [name]') == [
467	            'CombinedSelector[Element[a] <followed> Attrib[Element[*][name]]]']
468	        self.ae(parse_many('a[rel="include"]', 'a[rel = include]'), [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:470:8
469	            "Attrib[Element[a][rel = 'include']]"])
470	        assert parse_many("a[hreflang |= 'en']", "a[hreflang|=en]") == [
471	            "Attrib[Element[a][hreflang |= 'en']]"]
472	        self.ae(parse_many('div:nth-child(10)'), [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:474:8
473	            "Function[Element[div]:nth-child(['10'])]"])
474	        assert parse_many(':nth-child(2n+2)') == [
475	            "Function[Element[*]:nth-child(['2', 'n', '+2'])]"]
476	        assert parse_many('div:nth-of-type(10)') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:476:8
475	            "Function[Element[*]:nth-child(['2', 'n', '+2'])]"]
476	        assert parse_many('div:nth-of-type(10)') == [
477	            "Function[Element[div]:nth-of-type(['10'])]"]
478	        assert parse_many('div div:nth-of-type(10) .aclass') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:478:8
477	            "Function[Element[div]:nth-of-type(['10'])]"]
478	        assert parse_many('div div:nth-of-type(10) .aclass') == [
479	            'CombinedSelector[CombinedSelector[Element[div] <followed> '
480	            "Function[Element[div]:nth-of-type(['10'])]] "
481	            '<followed> Class[Element[*].aclass]]']
482	        assert parse_many('label:only') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:482:8
481	            '<followed> Class[Element[*].aclass]]']
482	        assert parse_many('label:only') == [
483	            'Pseudo[Element[label]:only]']
484	        assert parse_many('a:lang(fr)') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:484:8
483	            'Pseudo[Element[label]:only]']
484	        assert parse_many('a:lang(fr)') == [
485	            "Function[Element[a]:lang(['fr'])]"]
486	        assert parse_many('div:contains("foo")') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:486:8
485	            "Function[Element[a]:lang(['fr'])]"]
486	        assert parse_many('div:contains("foo")') == [
487	            "Function[Element[div]:contains(['foo'])]"]
488	        assert parse_many('div#foobar') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:488:8
487	            "Function[Element[div]:contains(['foo'])]"]
488	        assert parse_many('div#foobar') == [
489	            'Hash[Element[div]#foobar]']
490	        assert parse_many('div:not(div.foo)') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:490:8
489	            'Hash[Element[div]#foobar]']
490	        assert parse_many('div:not(div.foo)') == [
491	            'Negation[Element[div]:not(Class[Element[div].foo])]']
492	        assert parse_many('td ~ th') == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:492:8
491	            'Negation[Element[div]:not(Class[Element[div].foo])]']
492	        assert parse_many('td ~ th') == [
493	            'CombinedSelector[Element[td] ~ Element[th]]']
494	    # }}}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:503:16
502	                # No Symbol here
503	                assert pseudo is None or isinstance(pseudo, type(''))
504	                selector = repr(selector.parsed_tree).replace("(u'", "('")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:510:12
509	            result = parse_pseudo(css)
510	            assert len(result) == 1
511	            return result[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:513:8
512	
513	        assert parse_one('foo') == ('Element[foo]', None)
514	        assert parse_one('*') == ('Element[*]', None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:514:8
513	        assert parse_one('foo') == ('Element[foo]', None)
514	        assert parse_one('*') == ('Element[*]', None)
515	        assert parse_one(':empty') == ('Pseudo[Element[*]:empty]', None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:515:8
514	        assert parse_one('*') == ('Element[*]', None)
515	        assert parse_one(':empty') == ('Pseudo[Element[*]:empty]', None)
516	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:518:8
517	        # Special cases for CSS 2.1 pseudo-elements
518	        assert parse_one(':BEfore') == ('Element[*]', 'before')
519	        assert parse_one(':aftER') == ('Element[*]', 'after')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:519:8
518	        assert parse_one(':BEfore') == ('Element[*]', 'before')
519	        assert parse_one(':aftER') == ('Element[*]', 'after')
520	        assert parse_one(':First-Line') == ('Element[*]', 'first-line')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:520:8
519	        assert parse_one(':aftER') == ('Element[*]', 'after')
520	        assert parse_one(':First-Line') == ('Element[*]', 'first-line')
521	        assert parse_one(':First-Letter') == ('Element[*]', 'first-letter')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:521:8
520	        assert parse_one(':First-Line') == ('Element[*]', 'first-line')
521	        assert parse_one(':First-Letter') == ('Element[*]', 'first-letter')
522	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:523:8
522	
523	        assert parse_one('::befoRE') == ('Element[*]', 'before')
524	        assert parse_one('::AFter') == ('Element[*]', 'after')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:524:8
523	        assert parse_one('::befoRE') == ('Element[*]', 'before')
524	        assert parse_one('::AFter') == ('Element[*]', 'after')
525	        assert parse_one('::firsT-linE') == ('Element[*]', 'first-line')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:525:8
524	        assert parse_one('::AFter') == ('Element[*]', 'after')
525	        assert parse_one('::firsT-linE') == ('Element[*]', 'first-line')
526	        assert parse_one('::firsT-letteR') == ('Element[*]', 'first-letter')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:526:8
525	        assert parse_one('::firsT-linE') == ('Element[*]', 'first-line')
526	        assert parse_one('::firsT-letteR') == ('Element[*]', 'first-letter')
527	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:528:8
527	
528	        assert parse_one('::text-content') == ('Element[*]', 'text-content')
529	        self.ae(parse_one('::attr(name)'), (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:532:8
531	
532	        assert parse_one('::Selection') == ('Element[*]', 'selection')
533	        assert parse_one('foo:after') == ('Element[foo]', 'after')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:533:8
532	        assert parse_one('::Selection') == ('Element[*]', 'selection')
533	        assert parse_one('foo:after') == ('Element[foo]', 'after')
534	        assert parse_one('foo::selection') == ('Element[foo]', 'selection')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:534:8
533	        assert parse_one('foo:after') == ('Element[foo]', 'after')
534	        assert parse_one('foo::selection') == ('Element[foo]', 'selection')
535	        assert parse_one('lorem#ipsum ~ a#b.c[href]:empty::selection') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:535:8
534	        assert parse_one('foo::selection') == ('Element[foo]', 'selection')
535	        assert parse_one('lorem#ipsum ~ a#b.c[href]:empty::selection') == (
536	            'CombinedSelector[Hash[Element[lorem]#ipsum] ~ '
537	            'Pseudo[Attrib[Class[Hash[Element[a]#b].c][href]]:empty]]',
538	            'selection')
539	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:549:12
548	            selectors = parse(css)
549	            assert len(selectors) == 1
550	            return selectors[0].specificity()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:552:8
551	
552	        assert specificity('*') == (0, 0, 0)
553	        assert specificity(' foo') == (0, 0, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:553:8
552	        assert specificity('*') == (0, 0, 0)
553	        assert specificity(' foo') == (0, 0, 1)
554	        assert specificity(':empty ') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:554:8
553	        assert specificity(' foo') == (0, 0, 1)
554	        assert specificity(':empty ') == (0, 1, 0)
555	        assert specificity(':before') == (0, 0, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:555:8
554	        assert specificity(':empty ') == (0, 1, 0)
555	        assert specificity(':before') == (0, 0, 1)
556	        assert specificity('*:before') == (0, 0, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:556:8
555	        assert specificity(':before') == (0, 0, 1)
556	        assert specificity('*:before') == (0, 0, 1)
557	        assert specificity(':nth-child(2)') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:557:8
556	        assert specificity('*:before') == (0, 0, 1)
557	        assert specificity(':nth-child(2)') == (0, 1, 0)
558	        assert specificity('.bar') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:558:8
557	        assert specificity(':nth-child(2)') == (0, 1, 0)
558	        assert specificity('.bar') == (0, 1, 0)
559	        assert specificity('[baz]') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:559:8
558	        assert specificity('.bar') == (0, 1, 0)
559	        assert specificity('[baz]') == (0, 1, 0)
560	        assert specificity('[baz="4"]') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:560:8
559	        assert specificity('[baz]') == (0, 1, 0)
560	        assert specificity('[baz="4"]') == (0, 1, 0)
561	        assert specificity('[baz^="4"]') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:561:8
560	        assert specificity('[baz="4"]') == (0, 1, 0)
561	        assert specificity('[baz^="4"]') == (0, 1, 0)
562	        assert specificity('#lipsum') == (1, 0, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:562:8
561	        assert specificity('[baz^="4"]') == (0, 1, 0)
562	        assert specificity('#lipsum') == (1, 0, 0)
563	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:564:8
563	
564	        assert specificity(':not(*)') == (0, 0, 0)
565	        assert specificity(':not(foo)') == (0, 0, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:565:8
564	        assert specificity(':not(*)') == (0, 0, 0)
565	        assert specificity(':not(foo)') == (0, 0, 1)
566	        assert specificity(':not(.foo)') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:566:8
565	        assert specificity(':not(foo)') == (0, 0, 1)
566	        assert specificity(':not(.foo)') == (0, 1, 0)
567	        assert specificity(':not([foo])') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:567:8
566	        assert specificity(':not(.foo)') == (0, 1, 0)
567	        assert specificity(':not([foo])') == (0, 1, 0)
568	        assert specificity(':not(:empty)') == (0, 1, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:568:8
567	        assert specificity(':not([foo])') == (0, 1, 0)
568	        assert specificity(':not(:empty)') == (0, 1, 0)
569	        assert specificity(':not(#foo)') == (1, 0, 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:569:8
568	        assert specificity(':not(:empty)') == (0, 1, 0)
569	        assert specificity(':not(#foo)') == (1, 0, 0)
570	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:571:8
570	
571	        assert specificity('foo:empty') == (0, 1, 1)
572	        assert specificity('foo:before') == (0, 0, 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:572:8
571	        assert specificity('foo:empty') == (0, 1, 1)
572	        assert specificity('foo:before') == (0, 0, 2)
573	        assert specificity('foo::before') == (0, 0, 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:573:8
572	        assert specificity('foo:before') == (0, 0, 2)
573	        assert specificity('foo::before') == (0, 0, 2)
574	        assert specificity('foo:empty::before') == (0, 1, 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:574:8
573	        assert specificity('foo::before') == (0, 0, 2)
574	        assert specificity('foo:empty::before') == (0, 1, 2)
575	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:576:8
575	
576	        assert specificity('#lorem + foo#ipsum:first-child > bar:first-line'
577	            ) == (2, 1, 3)
578	    # }}}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:590:8
589	            "Expected selector, got <DELIM '(' at 10>"))
590	        assert get_error('attributes(href)') == (
591	            "Expected selector, got <DELIM '(' at 10>")
592	        assert get_error('html/body/a') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:592:8
591	            "Expected selector, got <DELIM '(' at 10>")
592	        assert get_error('html/body/a') == (
593	            "Expected selector, got <DELIM '/' at 4>")
594	        assert get_error(' ') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:594:8
593	            "Expected selector, got <DELIM '/' at 4>")
594	        assert get_error(' ') == (
595	            "Expected selector, got <EOF at 1>")
596	        assert get_error('div, ') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:596:8
595	            "Expected selector, got <EOF at 1>")
596	        assert get_error('div, ') == (
597	            "Expected selector, got <EOF at 5>")
598	        assert get_error(' , div') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:598:8
597	            "Expected selector, got <EOF at 5>")
598	        assert get_error(' , div') == (
599	            "Expected selector, got <DELIM ',' at 1>")
600	        assert get_error('p, , div') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:600:8
599	            "Expected selector, got <DELIM ',' at 1>")
600	        assert get_error('p, , div') == (
601	            "Expected selector, got <DELIM ',' at 3>")
602	        assert get_error('div > ') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:602:8
601	            "Expected selector, got <DELIM ',' at 3>")
602	        assert get_error('div > ') == (
603	            "Expected selector, got <EOF at 6>")
604	        assert get_error('  > div') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:604:8
603	            "Expected selector, got <EOF at 6>")
604	        assert get_error('  > div') == (
605	            "Expected selector, got <DELIM '>' at 2>")
606	        assert get_error('foo|#bar') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:606:8
605	            "Expected selector, got <DELIM '>' at 2>")
606	        assert get_error('foo|#bar') == (
607	            "Expected ident or '*', got <HASH 'bar' at 4>")
608	        assert get_error('#.foo') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:608:8
607	            "Expected ident or '*', got <HASH 'bar' at 4>")
608	        assert get_error('#.foo') == (
609	            "Expected selector, got <DELIM '#' at 0>")
610	        assert get_error('.#foo') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:610:8
609	            "Expected selector, got <DELIM '#' at 0>")
610	        assert get_error('.#foo') == (
611	            "Expected ident, got <HASH 'foo' at 1>")
612	        assert get_error(':#foo') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:612:8
611	            "Expected ident, got <HASH 'foo' at 1>")
612	        assert get_error(':#foo') == (
613	            "Expected ident, got <HASH 'foo' at 1>")
614	        assert get_error('[*]') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:614:8
613	            "Expected ident, got <HASH 'foo' at 1>")
614	        assert get_error('[*]') == (
615	            "Expected '|', got <DELIM ']' at 2>")
616	        assert get_error('[foo|]') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:616:8
615	            "Expected '|', got <DELIM ']' at 2>")
616	        assert get_error('[foo|]') == (
617	            "Expected ident, got <DELIM ']' at 5>")
618	        assert get_error('[#]') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:618:8
617	            "Expected ident, got <DELIM ']' at 5>")
618	        assert get_error('[#]') == (
619	            "Expected ident or '*', got <DELIM '#' at 1>")
620	        assert get_error('[foo=#]') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:620:8
619	            "Expected ident or '*', got <DELIM '#' at 1>")
620	        assert get_error('[foo=#]') == (
621	            "Expected string or ident, got <DELIM '#' at 5>")
622	        assert get_error('[href]a') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:622:8
621	            "Expected string or ident, got <DELIM '#' at 5>")
622	        assert get_error('[href]a') == (
623	            "Expected selector, got <IDENT 'a' at 6>")
624	        assert get_error('[rel=stylesheet]') is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:624:8
623	            "Expected selector, got <IDENT 'a' at 6>")
624	        assert get_error('[rel=stylesheet]') is None
625	        assert get_error('[rel:stylesheet]') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:625:8
624	        assert get_error('[rel=stylesheet]') is None
625	        assert get_error('[rel:stylesheet]') == (
626	            "Operator expected, got <DELIM ':' at 4>")
627	        assert get_error('[rel=stylesheet') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:627:8
626	            "Operator expected, got <DELIM ':' at 4>")
627	        assert get_error('[rel=stylesheet') == (
628	            "Expected ']', got <EOF at 15>")
629	        assert get_error(':lang(fr)') is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:629:8
628	            "Expected ']', got <EOF at 15>")
629	        assert get_error(':lang(fr)') is None
630	        assert get_error(':lang(fr') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:630:8
629	        assert get_error(':lang(fr)') is None
630	        assert get_error(':lang(fr') == (
631	            "Expected an argument, got <EOF at 8>")
632	        assert get_error(':contains("foo') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:632:8
631	            "Expected an argument, got <EOF at 8>")
632	        assert get_error(':contains("foo') == (
633	            "Unclosed string at 10")
634	        assert get_error('foo!') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:634:8
633	            "Unclosed string at 10")
634	        assert get_error('foo!') == (
635	            "Expected selector, got <DELIM '!' at 3>")
636	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:638:8
637	        # Mis-placed pseudo-elements
638	        assert get_error('a:before:empty') == (
639	            "Got pseudo-element ::before not at the end of a selector")
640	        assert get_error('li:before a') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:640:8
639	            "Got pseudo-element ::before not at the end of a selector")
640	        assert get_error('li:before a') == (
641	            "Got pseudo-element ::before not at the end of a selector")
642	        assert get_error(':not(:before)') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:642:8
641	            "Got pseudo-element ::before not at the end of a selector")
642	        assert get_error(':not(:before)') == (
643	            "Got pseudo-element ::before inside :not() at 12")
644	        assert get_error(':not(:not(a))') == (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:644:8
643	            "Got pseudo-element ::before inside :not() at 12")
644	        assert get_error(':not(:not(a))') == (
645	            "Got nested :not()")
646	    # }}}

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\src\css_selectors\tests.py:649:19
648	    def test_select(self):  # {{{
649	        document = etree.fromstring(self.HTML_IDS)
650	        select = Select(document)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:754:8
753	        self.ae(count('*'), 249)
754	        assert count('div:only-child') == 22  # ?
755	        assert count('div:nth-child(even)') == 106

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:755:8
754	        assert count('div:only-child') == 22  # ?
755	        assert count('div:nth-child(even)') == 106
756	        assert count('div:nth-child(2n)') == 106

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:756:8
755	        assert count('div:nth-child(even)') == 106
756	        assert count('div:nth-child(2n)') == 106
757	        assert count('div:nth-child(odd)') == 137

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:757:8
756	        assert count('div:nth-child(2n)') == 106
757	        assert count('div:nth-child(odd)') == 137
758	        assert count('div:nth-child(2n+1)') == 137

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:758:8
757	        assert count('div:nth-child(odd)') == 137
758	        assert count('div:nth-child(2n+1)') == 137
759	        assert count('div:nth-child(n)') == 243

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:759:8
758	        assert count('div:nth-child(2n+1)') == 137
759	        assert count('div:nth-child(n)') == 243
760	        assert count('div:last-child') == 53

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:760:8
759	        assert count('div:nth-child(n)') == 243
760	        assert count('div:last-child') == 53
761	        assert count('div:first-child') == 51

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:761:8
760	        assert count('div:last-child') == 53
761	        assert count('div:first-child') == 51
762	        assert count('div > div') == 242

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:762:8
761	        assert count('div:first-child') == 51
762	        assert count('div > div') == 242
763	        assert count('div + div') == 190

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:763:8
762	        assert count('div > div') == 242
763	        assert count('div + div') == 190
764	        assert count('div ~ div') == 190

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:764:8
763	        assert count('div + div') == 190
764	        assert count('div ~ div') == 190
765	        assert count('body') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:765:8
764	        assert count('div ~ div') == 190
765	        assert count('body') == 1
766	        assert count('body div') == 243

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:766:8
765	        assert count('body') == 1
766	        assert count('body div') == 243
767	        assert count('div') == 243

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:767:8
766	        assert count('body div') == 243
767	        assert count('div') == 243
768	        assert count('div div') == 242

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:768:8
767	        assert count('div') == 243
768	        assert count('div div') == 242
769	        assert count('div div div') == 241

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:769:8
768	        assert count('div div') == 242
769	        assert count('div div div') == 241
770	        assert count('div, div, div') == 243

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:770:8
769	        assert count('div div div') == 241
770	        assert count('div, div, div') == 243
771	        assert count('div, a, span') == 243

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:771:8
770	        assert count('div, div, div') == 243
771	        assert count('div, a, span') == 243
772	        assert count('.dialog') == 51

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:772:8
771	        assert count('div, a, span') == 243
772	        assert count('.dialog') == 51
773	        assert count('div.dialog') == 51

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:773:8
772	        assert count('.dialog') == 51
773	        assert count('div.dialog') == 51
774	        assert count('div .dialog') == 51

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:774:8
773	        assert count('div.dialog') == 51
774	        assert count('div .dialog') == 51
775	        assert count('div.character, div.dialog') == 99

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:775:8
774	        assert count('div .dialog') == 51
775	        assert count('div.character, div.dialog') == 99
776	        assert count('div.direction.dialog') == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:776:8
775	        assert count('div.character, div.dialog') == 99
776	        assert count('div.direction.dialog') == 0
777	        assert count('div.dialog.direction') == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:777:8
776	        assert count('div.direction.dialog') == 0
777	        assert count('div.dialog.direction') == 0
778	        assert count('div.dialog.scene') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:778:8
777	        assert count('div.dialog.direction') == 0
778	        assert count('div.dialog.scene') == 1
779	        assert count('div.scene.scene') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:779:8
778	        assert count('div.dialog.scene') == 1
779	        assert count('div.scene.scene') == 1
780	        assert count('div.scene .scene') == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:780:8
779	        assert count('div.scene.scene') == 1
780	        assert count('div.scene .scene') == 0
781	        assert count('div.direction .dialog ') == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:781:8
780	        assert count('div.scene .scene') == 0
781	        assert count('div.direction .dialog ') == 0
782	        assert count('div .dialog .direction') == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:782:8
781	        assert count('div.direction .dialog ') == 0
782	        assert count('div .dialog .direction') == 4
783	        assert count('div.dialog .dialog .direction') == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:783:8
782	        assert count('div .dialog .direction') == 4
783	        assert count('div.dialog .dialog .direction') == 4
784	        assert count('#speech5') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:784:8
783	        assert count('div.dialog .dialog .direction') == 4
784	        assert count('#speech5') == 1
785	        assert count('div#speech5') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:785:8
784	        assert count('#speech5') == 1
785	        assert count('div#speech5') == 1
786	        assert count('div #speech5') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:786:8
785	        assert count('div#speech5') == 1
786	        assert count('div #speech5') == 1
787	        assert count('div.scene div.dialog') == 49

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:787:8
786	        assert count('div #speech5') == 1
787	        assert count('div.scene div.dialog') == 49
788	        assert count('div#scene1 div.dialog div') == 142

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:788:8
787	        assert count('div.scene div.dialog') == 49
788	        assert count('div#scene1 div.dialog div') == 142
789	        assert count('#scene1 #speech1') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:789:8
788	        assert count('div#scene1 div.dialog div') == 142
789	        assert count('#scene1 #speech1') == 1
790	        assert count('div[class]') == 103

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:790:8
789	        assert count('#scene1 #speech1') == 1
790	        assert count('div[class]') == 103
791	        assert count('div[class=dialog]') == 50

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:791:8
790	        assert count('div[class]') == 103
791	        assert count('div[class=dialog]') == 50
792	        assert count('div[class^=dia]') == 51

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:792:8
791	        assert count('div[class=dialog]') == 50
792	        assert count('div[class^=dia]') == 51
793	        assert count('div[class$=log]') == 50

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:793:8
792	        assert count('div[class^=dia]') == 51
793	        assert count('div[class$=log]') == 50
794	        assert count('div[class*=sce]') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:794:8
793	        assert count('div[class$=log]') == 50
794	        assert count('div[class*=sce]') == 1
795	        assert count('div[class|=dialog]') == 50  # ? Seems right

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:795:8
794	        assert count('div[class*=sce]') == 1
795	        assert count('div[class|=dialog]') == 50  # ? Seems right
796	        assert count('div[class~=dialog]') == 51  # ? Seems right

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\css_selectors\tests.py:796:8
795	        assert count('div[class|=dialog]') == 50  # ? Seems right
796	        assert count('div[class~=dialog]') == 51  # ? Seems right
797	

--------------------------------------------------
>> Issue: [B408:blacklist] Using xml.dom.minidom to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b408-import-xml-minidom
   Location: .\src\odf\odf2moinmoin.py:23:0
22	
23	import sys, zipfile, xml.dom.minidom
24	from namespaces import nsdict

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\odf\odf2moinmoin.py:241:16
240	                        paraProps.setIndented(True)
241	                except:
242	                    pass
243	

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\src\odf\odf2moinmoin.py:293:21
292	
293	        styles_doc = xml.dom.minidom.parseString(zip.read("styles.xml"))
294	        fontfacedecls = styles_doc.getElementsByTagName("office:font-face-decls")

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\src\odf\odf2moinmoin.py:300:23
299	
300	        self.content = xml.dom.minidom.parseString(zip.read("content.xml"))
301	        fontfacedecls = self.content.getElementsByTagName("office:font-face-decls")

--------------------------------------------------
>> Issue: [B406:blacklist] Using handler to parse untrusted XML data is known to be vulnerable to XML attacks. Replace handler with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\src\odf\odf2xhtml.py:24:0
23	from collections import defaultdict
24	from xml.sax import handler
25	from xml.sax.saxutils import escape, quoteattr

--------------------------------------------------
>> Issue: [B406:blacklist] Using escape to parse untrusted XML data is known to be vulnerable to XML attacks. Replace escape with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\src\odf\odf2xhtml.py:25:0
24	from xml.sax import handler
25	from xml.sax.saxutils import escape, quoteattr
26	from xml.dom import Node

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\src\templite\__init__.py:81:8
80	        self.__output = []
81	        eval(self.__code, namespace)
82	        sys.stdout = __stdout

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\tinycss\tokenizer.py:174:16
173	            else:
174	                assert not isinstance(token, ContainerToken), (
175	                    'Token looks already grouped: {0}'.format(token))
176	                content = list(_regroup_inner(end))

--------------------------------------------------

Code scanned:
	Total lines of code: 368925
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 1052
		Medium: 222
		High: 17
	Total issues (by confidence):
		Undefined: 0
		Low: 49
		Medium: 190
		High: 1052
Files skipped (187):
	.\manual\custom.py (syntax error while parsing AST from file)
	.\manual\latex.py (syntax error while parsing AST from file)
	.\setup\__init__.py (syntax error while parsing AST from file)
	.\setup\build.py (syntax error while parsing AST from file)
	.\setup\build_environment.py (syntax error while parsing AST from file)
	.\setup\mathjax.py (syntax error while parsing AST from file)
	.\setup\pypi.py (syntax error while parsing AST from file)
	.\setup\resources.py (syntax error while parsing AST from file)
	.\setup\translations.py (syntax error while parsing AST from file)
	.\setup\upload.py (syntax error while parsing AST from file)
	.\src\calibre\constants.py (syntax error while parsing AST from file)
	.\src\calibre\customize\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\customize\builtins.py (syntax error while parsing AST from file)
	.\src\calibre\customize\ui.py (syntax error while parsing AST from file)
	.\src\calibre\customize\zipplugin.py (syntax error while parsing AST from file)
	.\src\calibre\db\backend.py (syntax error while parsing AST from file)
	.\src\calibre\debug.py (syntax error while parsing AST from file)
	.\src\calibre\devices\cli.py (syntax error while parsing AST from file)
	.\src\calibre\devices\kindle\bookmark.py (syntax error while parsing AST from file)
	.\src\calibre\devices\kindle\driver.py (syntax error while parsing AST from file)
	.\src\calibre\devices\kobo\driver.py (syntax error while parsing AST from file)
	.\src\calibre\devices\misc.py (syntax error while parsing AST from file)
	.\src\calibre\devices\paladin\driver.py (syntax error while parsing AST from file)
	.\src\calibre\devices\prs505\driver.py (syntax error while parsing AST from file)
	.\src\calibre\devices\prst1\driver.py (syntax error while parsing AST from file)
	.\src\calibre\devices\scanner.py (syntax error while parsing AST from file)
	.\src\calibre\devices\udisks.py (syntax error while parsing AST from file)
	.\src\calibre\devices\usbms\cli.py (syntax error while parsing AST from file)
	.\src\calibre\devices\usbms\device.py (syntax error while parsing AST from file)
	.\src\calibre\devices\usbobserver\test.py (syntax error while parsing AST from file)
	.\src\calibre\devices\winusb.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\BeautifulSoup.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\compression\palmdoc.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\conversion\preprocess.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\conversion\utils.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\covers.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\epub\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\html\input.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\hyphenate.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lit\from_any.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lit\mssha1.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lit\reader.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lit\writer.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lrf\html\convert_from.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lrf\html\convert_to.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lrf\lrs\convert_from.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lrf\meta.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lrf\objects.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\lrf\pylrs\pylrs.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\book\json_codec.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\epub.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\kdl.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\mobi.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\opf2.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\sources\overdrive.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\sources\update.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\toc.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\topaz.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\metadata\xisbn.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\mobi\mobiml.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\mobi\reader\mobi6.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\oeb\polish\cascade.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\oeb\polish\create.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\oeb\polish\tests\structure.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\oeb\reader.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\oeb\stylizer.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\oeb\transforms\split.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\pdb\ereader\inspector.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\pdf\pdftohtml.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\pdf\render\serialize.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\pml\pmlml.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\readability\readability.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\ParseRtf.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\body_styles.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\check_encoding.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\colors.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\configure_txt.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\convert_to_tags.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\copy.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\default_encoding.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\delete_info.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\field_strings.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\fields_large.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\fonts.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\get_char_map.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\group_borders.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\group_styles.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\hex_2_utf8.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\info.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\inline.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\list_table.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\options_trem.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\override_table.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\paragraph_def.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\pict.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\preamble_div.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\process_tokens.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\sections.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\styles.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\table_info.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf2xml\tokenize.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\rtf\rtfml.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\sgmllib.py (syntax error while parsing AST from file)
	.\src\calibre\ebooks\snb\snbfile.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\actions\choose_library.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\actions\copy_to_library.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\book_details.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\catalog\catalog_epub_mobi.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\convert\xpath_wizard.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\cover_flow.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\dialogs\search.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\dialogs\select_formats.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\dialogs\template_dialog.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\icon_theme.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\library\alternate_views.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\library\models.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\library\views.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\linux_file_dialogs.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\lrf_renderer\document.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\lrf_renderer\main.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\lrf_renderer\text.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\main.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\metadata\config.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\preferences\coloring.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\preferences\plugboard.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\preferences\tweaks.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\store\loader.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\store\stores\chitanka_plugin.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\tweak_book\diff\view.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\tweak_book\editor\snippets.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\tweak_book\function_replace.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\ui.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\update.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\viewer\config.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\widgets.py (syntax error while parsing AST from file)
	.\src\calibre\gui2\wizard\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\library\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\library\catalogs\epub_mobi.py (syntax error while parsing AST from file)
	.\src\calibre\library\catalogs\epub_mobi_builder.py (syntax error while parsing AST from file)
	.\src\calibre\library\catalogs\utils.py (syntax error while parsing AST from file)
	.\src\calibre\library\comments.py (syntax error while parsing AST from file)
	.\src\calibre\library\database.py (syntax error while parsing AST from file)
	.\src\calibre\library\save_to_disk.py (syntax error while parsing AST from file)
	.\src\calibre\library\schema_upgrades.py (syntax error while parsing AST from file)
	.\src\calibre\library\sqlite.py (syntax error while parsing AST from file)
	.\src\calibre\libunzip.py (syntax error while parsing AST from file)
	.\src\calibre\linux.py (syntax error while parsing AST from file)
	.\src\calibre\srv\code.py (syntax error while parsing AST from file)
	.\src\calibre\srv\http_response.py (syntax error while parsing AST from file)
	.\src\calibre\srv\tests\http.py (syntax error while parsing AST from file)
	.\src\calibre\startup.py (syntax error while parsing AST from file)
	.\src\calibre\translations\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\translations\msgfmt.py (syntax error while parsing AST from file)
	.\src\calibre\utils\Zeroconf.py (syntax error while parsing AST from file)
	.\src\calibre\utils\chm\chm.py (syntax error while parsing AST from file)
	.\src\calibre\utils\config.py (syntax error while parsing AST from file)
	.\src\calibre\utils\config_base.py (syntax error while parsing AST from file)
	.\src\calibre\utils\fonts\sfnt\cff\dict_data.py (syntax error while parsing AST from file)
	.\src\calibre\utils\formatter_functions.py (syntax error while parsing AST from file)
	.\src\calibre\utils\icu.py (syntax error while parsing AST from file)
	.\src\calibre\utils\ipc\server.py (syntax error while parsing AST from file)
	.\src\calibre\utils\ipc\simple_worker.py (syntax error while parsing AST from file)
	.\src\calibre\utils\ipc\worker.py (syntax error while parsing AST from file)
	.\src\calibre\utils\mem.py (syntax error while parsing AST from file)
	.\src\calibre\utils\podofo\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\utils\search_query_parser.py (syntax error while parsing AST from file)
	.\src\calibre\utils\sftp.py (syntax error while parsing AST from file)
	.\src\calibre\utils\shared_file.py (syntax error while parsing AST from file)
	.\src\calibre\utils\smtp.py (syntax error while parsing AST from file)
	.\src\calibre\utils\threadpool.py (syntax error while parsing AST from file)
	.\src\calibre\utils\titlecase.py (syntax error while parsing AST from file)
	.\src\calibre\utils\zipfile.py (syntax error while parsing AST from file)
	.\src\calibre\web\feeds\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\web\feeds\feedparser.py (syntax error while parsing AST from file)
	.\src\calibre\web\feeds\news.py (syntax error while parsing AST from file)
	.\src\calibre\web\feeds\recipes\__init__.py (syntax error while parsing AST from file)
	.\src\calibre\web\feeds\recipes\collection.py (syntax error while parsing AST from file)
	.\src\calibre\web\fetch\simple.py (syntax error while parsing AST from file)
	.\src\duktape\__init__.py (syntax error while parsing AST from file)
	.\src\lzma\xz.py (syntax error while parsing AST from file)
	.\src\odf\attrconverters.py (syntax error while parsing AST from file)
	.\src\odf\draw.py (syntax error while parsing AST from file)
	.\src\odf\element.py (syntax error while parsing AST from file)
	.\src\odf\load.py (syntax error while parsing AST from file)
	.\src\odf\odfmanifest.py (syntax error while parsing AST from file)
	.\src\odf\opendocument.py (syntax error while parsing AST from file)
