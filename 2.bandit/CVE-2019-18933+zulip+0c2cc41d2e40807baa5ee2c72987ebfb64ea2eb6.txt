Working... ---------------------------------------- 100% 0:00:20
Run started:2024-02-10 21:29:30.763231

Test results:
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:133:8
132	        timer = time.time()
133	        assert(stat.data_collector.pull_function is not None)
134	        rows_added = stat.data_collector.pull_function(stat.property, start_time, end_time)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:156:27
155	    if output_table in (UserCount, StreamCount):
156	        realmcount_query = """
157	            INSERT INTO analytics_realmcount
158	                (realm_id, value, property, subgroup, end_time)
159	            SELECT
160	                zerver_realm.id, COALESCE(sum(%(output_table)s.value), 0), '%(property)s',
161	                %(output_table)s.subgroup, %%(end_time)s
162	            FROM zerver_realm
163	            JOIN %(output_table)s
164	            ON
165	                zerver_realm.id = %(output_table)s.realm_id
166	            WHERE
167	                %(output_table)s.property = '%(property)s' AND
168	                %(output_table)s.end_time = %%(end_time)s
169	            GROUP BY zerver_realm.id, %(output_table)s.subgroup
170	        """ % {'output_table': output_table._meta.db_table,
171	               'property': stat.property}
172	        start = time.time()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:179:30
178	    # Aggregate into InstallationCount
179	    installationcount_query = """
180	        INSERT INTO analytics_installationcount
181	            (value, property, subgroup, end_time)
182	        SELECT
183	            sum(value), '%(property)s', analytics_realmcount.subgroup, %%(end_time)s
184	        FROM analytics_realmcount
185	        WHERE
186	            property = '%(property)s' AND
187	            end_time = %%(end_time)s
188	        GROUP BY analytics_realmcount.subgroup
189	    """ % {'property': stat.property}
190	    start = time.time()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\lib\counts.py:390:36
389	# In particular, it's important to ensure that migrations don't cause that to happen.
390	check_realmauditlog_by_user_query = """
391	    INSERT INTO analytics_usercount
392	        (user_id, realm_id, value, property, subgroup, end_time)
393	    SELECT
394	        ral1.modified_user_id, ral1.realm_id, 1, '%(property)s', %(subgroup)s, %%(time_end)s
395	    FROM zerver_realmauditlog ral1
396	    JOIN (
397	        SELECT modified_user_id, max(event_time) AS max_event_time
398	        FROM zerver_realmauditlog
399	        WHERE
400	            event_type in ({user_created}, {user_activated}, {user_deactivated}, {user_reactivated}) AND
401	            event_time < %%(time_end)s
402	        GROUP BY modified_user_id
403	    ) ral2
404	    ON
405	        ral1.event_time = max_event_time AND
406	        ral1.modified_user_id = ral2.modified_user_id
407	    JOIN zerver_userprofile
408	    ON
409	        ral1.modified_user_id = zerver_userprofile.id
410	    WHERE
411	        ral1.event_type in ({user_created}, {user_activated}, {user_reactivated})
412	""".format(user_created=RealmAuditLog.USER_CREATED,
413	           user_activated=RealmAuditLog.USER_ACTIVATED,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:39:29
38	        for i in range(days):
39	            holidays.extend([random() < holiday_rate] * 24)
40	    elif frequency == CountStat.DAY:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:44:20
43	                      [24*non_business_hours_base] * 2
44	        holidays = [random() < holiday_rate for i in range(days)]
45	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:166:16
165	    def make_dummy_count_stat(self, property: str) -> CountStat:
166	        query = """INSERT INTO analytics_realmcount (realm_id, value, property, end_time)
167	                   VALUES (%s, 1, '%s', %%%%(time_end)s)""" % (self.default_realm.id, property)
168	        return CountStat(property, sql_data_collector(RealmCount, query, None), CountStat.HOUR)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:265:16
264	        stat2 = self.make_dummy_count_stat('stat2')
265	        query = """INSERT INTO analytics_realmcount (realm_id, value, property, end_time)
266	                   VALUES (%s, 1, '%s', %%%%(time_end)s)""" % (self.default_realm.id, 'stat3')
267	        stat3 = DependentCountStat('stat3', sql_data_collector(RealmCount, query, None),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\tests\test_counts.py:299:16
298	        # test daily dependent stat with hourly dependencies
299	        query = """INSERT INTO analytics_realmcount (realm_id, value, property, end_time)
300	                   VALUES (%s, 1, '%s', %%%%(time_end)s)""" % (self.default_realm.id, 'stat4')
301	        stat4 = DependentCountStat('stat4', sql_data_collector(RealmCount, query, None),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views.py:161:12
160	            aggregate_table = RemoteInstallationCount
161	            assert server is not None
162	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views.py:167:12
166	            aggregate_table = RemoteRealmCount
167	            assert server is not None
168	            assert remote_realm_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views.py:168:12
167	            assert server is not None
168	            assert remote_realm_id is not None
169	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views.py:229:8
228	        # table.
229	        assert server is not None
230	        if not aggregate_table.objects.filter(server=server).exists():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views.py:254:4
253	
254	    assert len(set([stat.frequency for stat in stats])) == 1
255	    end_times = time_range(start, end, stats[0].frequency, min_length)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\analytics\views.py:621:8
620	            row['hours_per_user'] = '%.1f' % (hours / row['dau_count'],)
621	        except Exception:
622	            pass
623	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\analytics\views.py:834:16
833	
834	        query = '''
835	            select
836	                realm.string_id,
837	                up.id user_id,
838	                client.name,
839	                sum(count) as hits,
840	                max(last_visit) as last_time
841	            from zerver_useractivity ua
842	            join zerver_client client on client.id = ua.client_id
843	            join zerver_userprofile up on up.id = ua.user_profile_id
844	            join zerver_realm realm on realm.id = up.realm_id
845	            where
846	                client.name like '%s'
847	            group by string_id, up.id, client.name
848	            having max(last_visit) > now() - interval '2 week'
849	            order by string_id, up.id, client.name
850	        ''' % (mobile_type,)
851	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views.py:1125:16
1124	                hostname = parse_result.hostname
1125	                assert hostname is not None
1126	                if parse_result.port:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:63:4
62	def add_months(dt: datetime, months: int) -> datetime:
63	    assert(months >= 0)
64	    # It's fine that the max day in Feb is 28 for leap years.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:100:4
99	        return None
100	    assert(plan.next_invoice_date is not None)  # for mypy
101	    months_per_period = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:122:4
121	        return 0
122	    assert(plan.price_per_license is not None)  # for mypy
123	    return plan.price_per_license * last_ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:395:4
394	    make_end_of_cycle_updates_if_needed(plan, event_time)
395	    assert(plan.invoiced_through is not None)
396	    licenses_base = plan.invoiced_through.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:405:16
404	            else:
405	                assert(plan.price_per_license is not None)  # needed for mypy
406	                price_args = {'unit_amount': plan.price_per_license,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:410:12
409	        elif ledger_entry.licenses != licenses_base:
410	            assert(plan.price_per_license)
411	            last_renewal = LicenseLedger.objects.filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:221:8
220	        seat_count = get_latest_seat_count(realm)
221	        assert(seat_count >= 6)
222	        for user in UserProfile.objects.filter(realm=realm, is_active=True, is_bot=False) \

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\corporate\tests\test_stripe.py:263:31
262	            if not talk_to_stripe:
263	                stripe_token = 'token'
264	            stripe_token = kwargs.get('stripe_token', stripe_token)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\corporate\tests\test_stripe.py:1078:23
1077	        with patch('corporate.lib.stripe.do_create_stripe_customer', return_value='returned') as mocked1:
1078	            returned = update_or_create_stripe_customer(user, stripe_token='token')
1079	        mocked1.assert_called()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views.py:92:8
91	            stripe_token is not None, seat_count)
92	        assert licenses is not None
93	        automanage_licenses = license_management == 'automatic'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views.py:208:4
207	                                status: int=REQ("status", validator=check_int)) -> HttpResponse:
208	    assert(status in [CustomerPlan.ACTIVE, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE])
209	    plan = get_current_plan(Customer.objects.get(realm=user.realm))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views.py:210:4
209	    plan = get_current_plan(Customer.objects.get(realm=user.realm))
210	    assert(plan is not None)  # for mypy
211	    do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\clean_node_cache.py:4:0
3	import os
4	import subprocess
5	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\clean_node_cache.py:20:8
19	    try:
20	        subprocess.check_output(["/home/travis/zulip-yarn/bin/yarn", '--version'])
21	    except OSError:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\hash_reqs.py:44:11
43	    deps_str = "\n".join(deps) + "\n"
44	    return hashlib.sha1(deps_str.encode('utf-8')).hexdigest()
45	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\node_cache.py:37:14
36	    YARN_LOCK_FILE_PATH = os.path.join(setup_dir, 'yarn.lock')
37	    sha1sum = hashlib.sha1()
38	    sha1sum.update(subprocess_text_output(['cat', PACKAGE_JSON_FILE_PATH]).encode('utf8'))

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_path_on_import.py:13:4
12	    activate_locals = dict(__file__=activate_this)
13	    exec(open(activate_this).read(), activate_locals)
14	    if not os.path.exists(activate_locals["site_packages"]):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\setup_venv.py:4:0
3	import shutil
4	import subprocess
5	from scripts.lib.zulip_tools import run, run_as_root, ENDC, WARNING

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:282:13
281	    path = os.path.join(ZULIP_PATH, 'scripts', 'lib', 'hash_reqs.py')
282	    output = subprocess.check_output([path, requirements_file], universal_newlines=True)
283	    sha1sum = output.split()[0]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\zulip_tools.py:12:0
11	import shutil
12	import subprocess
13	import sys

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\scripts\lib\zulip_tools.py:45:14
44	    while True:
45	        tmp = tempfile.mktemp(
46	            prefix='.' + os.path.basename(dst) + '.',
47	            dir=os.path.dirname(dst))  # type: ignore # https://github.com/python/typeshed/issues/3449
48	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:112:11
111	    # type: (Sequence[str]) -> str
112	    return subprocess.check_output(args, universal_newlines=True).strip()
113	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:200:8
199	    try:
200	        subprocess.check_call(args, **kwargs)
201	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:304:10
303	    ZULIP_EMOJI_DIR = os.path.join(zulip_path, 'tools', 'setup', 'emoji')
304	    sha = hashlib.sha1()
305	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:390:14
389	    # changed compared to the last execution.
390	    sha1sum = hashlib.sha1()
391	    for path in paths:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\add_mentor.py:37:8
36	
37	    r = requests.get(url)
38	    if r.status_code != 200:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:47:19
46	    try:
47	        response = urllib.request.urlopen(user_api_url)
48	        json.loads(response.read().decode())

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:61:19
60	    try:
61	        response = urllib.request.urlopen(apiurl_keys)
62	        userkeys = json.loads(response.read().decode())

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:78:19
77	    try:
78	        response = urllib.request.urlopen(apiurl_fork)
79	        json.loads(response.read().decode())

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\js-dep-visualizer.py:10:0
9	import re
10	import subprocess
11	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\js-dep-visualizer.py:288:4
287	        f.write(buffer)
288	    subprocess.check_call(["dot", "-Tpng", OUTPUT_FILE_PATH, "-o", PNG_FILE_PATH])
289	    print()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\js-dep-visualizer.py:288:4
287	        f.write(buffer)
288	    subprocess.check_call(["dot", "-Tpng", OUTPUT_FILE_PATH, "-o", PNG_FILE_PATH])
289	    print()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\pretty_print.py:10:0
9	
10	import subprocess
11	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'html_start'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tools\lib\pretty_print.py:25:11
24	    # easier.
25	    info = dict(
26	        block=False,
27	        depth=-1,
28	        line=-1,
29	        token_kind='html_start',
30	        tag='html',
31	        extra_indent=0,
32	        ignore_lines=[])  # type: Dict[str, Any]
33	    stack.append(info)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:188:16
187	                pretty_line = pretty_line[-1 * offset:]
188	                assert line.strip() == pretty_line.strip()
189	        formatted_lines.append(pretty_line)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\pretty_print.py:208:13
207	              '%s\nDiff for the file against expected indented file:' % (fn,), flush=True)
208	        with subprocess.Popen(
209	                ['diff', fn, '-'],
210	                stdin=subprocess.PIPE,
211	                stderr=subprocess.STDOUT,
212	                universal_newlines=True) as p:
213	            p.communicate(phtml)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\pretty_print.py:208:13
207	              '%s\nDiff for the file against expected indented file:' % (fn,), flush=True)
208	        with subprocess.Popen(
209	                ['diff', fn, '-'],
210	                stdin=subprocess.PIPE,
211	                stderr=subprocess.STDOUT,
212	                universal_newlines=True) as p:
213	            p.communicate(phtml)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\provision.py:7:0
6	import platform
7	import subprocess
8	import glob

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\provision.py:277:7
276	    # pg_datadir directory.
277	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
278	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\provision.py:277:7
276	    # pg_datadir directory.
277	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
278	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tools\lib\provision.py:301:14
300	    # hash the apt dependencies
301	    sha_sum = hashlib.sha1()
302	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\tools\lib\provision.py:387:4
386	    provision_inner = os.path.join(ZULIP_PATH, "tools", "lib", "provision_inner.py")
387	    exec(open(activate_this).read(), dict(__file__=activate_this))
388	    os.execvp(

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\tools\lib\provision.py:388:4
387	    exec(open(activate_this).read(), dict(__file__=activate_this))
388	    os.execvp(
389	        provision_inner,
390	        [
391	            provision_inner,
392	            *(["--force"] if options.is_force else []),
393	            *(["--production-travis"] if options.is_production_travis else []),
394	        ]
395	    )
396	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:211:4
210	    # type: (Optional[str], Optional[str], bool) -> None
211	    assert fn or text
212	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_server.py:2:0
1	import os
2	import subprocess
3	import sys

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\lib\test_server.py:48:15
47	        # We could get a 501 error if the reverse proxy is up but the Django app isn't.
48	        return requests.get('http://127.0.0.1:9981/accounts/home').status_code == 200
49	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:73:13
72	        run_dev_server_command.append('--force')
73	    server = subprocess.Popen(run_dev_server_command,
74	                              stdout=log, stderr=log)
75	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\run-dev.py:7:0
6	import signal
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:114:0
113	# Clean up stale .pyc files etc.
114	subprocess.check_call('./tools/clean-repo')
115	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:118:4
117	    print("Clearing memcached ...")
118	    subprocess.check_call('./scripts/setup/flush-memcached')
119	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:156:4
155	    # with a running development server.
156	    subprocess.check_call(['./tools/webpack', '--quiet', '--test'])
157	else:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tools\run-dev.py:168:34
167	    else:
168	        webpack_cmd += ["--host", "0.0.0.0"]
169	    cmds.append(webpack_cmd)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:171:4
170	for cmd in cmds:
171	    subprocess.Popen(cmd)
172	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\gitter.py:4:0
3	import logging
4	import subprocess
5	import ujson

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\gitter.py:278:4
277	
278	    subprocess.check_call(["tar", "-czf", output_dir + '.tar.gz', output_dir, '-P'])
279	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\gitter.py:278:4
277	
278	    subprocess.check_call(["tar", "-czf", output_dir + '.tar.gz', output_dir, '-P'])
279	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\hipchat.py:9:0
8	import shutil
9	import subprocess
10	import ujson

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\hipchat.py:78:4
77	
78	    subprocess.check_call(['tar', '-xf', tar_file, '-C', data_dir])
79	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\hipchat.py:78:4
77	
78	    subprocess.check_call(['tar', '-xf', tar_file, '-C', data_dir])
79	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\hipchat.py:126:16
125	                # Hipchat sometimes doesn't export an email for deactivated users.
126	                assert not is_active
127	                email = delivery_email = "deactivated-{id}@example.com".format(id=id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\hipchat.py:464:8
463	        raw_user_id = raw_message['receiver_id']
464	        assert(raw_user_id)
465	        user_id = user_id_mapper.get(raw_user_id)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\hipchat.py:891:4
890	    logging.info('Start making tarball')
891	    subprocess.check_call(["tar", "-czf", output_dir + '.tar.gz', output_dir, '-P'])
892	    logging.info('Done making tarball')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\hipchat.py:891:4
890	    logging.info('Start making tarball')
891	    subprocess.check_call(["tar", "-czf", output_dir + '.tar.gz', output_dir, '-P'])
892	    logging.info('Done making tarball')

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\import_util.py:148:14
147	    subscription = Subscription(
148	        color=random.choice(stream_colors),
149	        id=subscription_id)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:503:19
502	
503	        response = requests.get(avatar_url + size_url_suffix, stream=True)
504	        with open(image_path, 'wb') as image_file:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:606:19
605	
606	        response = requests.get(upload_url, stream=True)
607	        os.makedirs(os.path.dirname(upload_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:656:19
655	
656	        response = requests.get(emoji_url, stream=True)
657	        os.makedirs(os.path.dirname(upload_emoji_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\mattermost.py:7:0
6	import logging
7	import subprocess
8	import ujson

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\data_import\mattermost.py:210:11
209	    import hashlib
210	    return hashlib.md5(''.join(sorted(huddle_members)).encode('utf-8')).hexdigest()
211	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\mattermost.py:669:12
668	        for post in mattermost_data["post"]["direct_post"]:
669	            assert("team" not in post)
670	            user = username_to_user[post["user"]]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\mattermost.py:837:8
836	        logging.info('Start making tarball')
837	        subprocess.check_call(["tar", "-czf", realm_output_dir + '.tar.gz', realm_output_dir, '-P'])
838	        logging.info('Done making tarball')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\mattermost.py:837:8
836	        logging.info('Start making tarball')
837	        subprocess.check_call(["tar", "-czf", realm_output_dir + '.tar.gz', realm_output_dir, '-P'])
838	        logging.info('Done making tarball')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\slack.py:4:0
3	import shutil
4	import subprocess
5	import logging

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\slack.py:877:15
876	                                  # in sync with 'exports.py' function 'import_message_data'
877	        format(random.randint(0, 255), 'x'),
878	        random_name(18),

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\slack.py:995:4
994	
995	    subprocess.check_call(['unzip', '-q', slack_zip_file, '-d', slack_data_dir])
996	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\slack.py:995:4
994	
995	    subprocess.check_call(['unzip', '-q', slack_zip_file, '-d', slack_data_dir])
996	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\slack.py:1039:4
1038	    rm_tree(slack_data_dir)
1039	    subprocess.check_call(["tar", "-czf", output_dir + '.tar.gz', output_dir, '-P'])
1040	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\slack.py:1039:4
1038	    rm_tree(slack_data_dir)
1039	    subprocess.check_call(["tar", "-czf", output_dir + '.tar.gz', output_dir, '-P'])
1040	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1050:11
1049	def get_slack_api_data(slack_api_url: str, get_param: str, **kwargs: Any) -> Any:
1050	    data = requests.get("{}?{}".format(slack_api_url, urlencode(kwargs)))
1051	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\slack_message_conversion.py:118:4
117	    slack_usermention_match = re.search(SLACK_USERMENTION_REGEX, token, re.VERBOSE)
118	    assert slack_usermention_match is not None
119	    short_name = slack_usermention_match.group(4)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:601:4
600	    property_type = Realm.property_types[name]
601	    assert isinstance(value, property_type), (
602	        'Cannot update %s: %s is not an instance of %s' % (
603	            name, value, property_type,))
604	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:991:8
990	        user_ids = list({recipient.type_id, sender_id})
991	        assert(len(user_ids) in [1, 2])
992	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1027:8
1026	        message_to_user_ids = list({recipient.type_id, sender_id})
1027	        assert(len(message_to_user_ids) in [1, 2])
1028	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1033:8
1032	        # of this function for different message types.
1033	        assert(stream_topic is not None)
1034	        user_ids_muting_topic = stream_topic.user_ids_muting_topic()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1360:8
1359	        # Render our messages.
1360	        assert message['message'].rendered_content is None
1361	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1503:12
1502	                message['stream'] = Stream.objects.select_related("realm").get(id=stream_id)
1503	            assert message['stream'] is not None  # assert needed because stubs for django are missing
1504	            if message['stream'].is_public():

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\actions.py:1653:12
1652	    ])
1653	    query = '''
1654	        INSERT into
1655	            zerver_usermessage (user_profile_id, message_id, flags)
1656	        VALUES
1657	    ''' + vals
1658	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1809:8
1808	    except ValidationError as e:
1809	        assert isinstance(e.messages[0], str)
1810	        raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1811:4
1810	        raise JsonableError(e.messages[0])
1811	    assert recipient.type != Recipient.STREAM
1812	    return {'sender': sender, 'recipient': recipient, 'op': operator}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1931:8
1930	        # message recipients of the message.
1931	        assert forwarder_user_profile is not None
1932	        if forwarder_user_profile.id not in recipient_profile_ids:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2239:12
2238	        else:
2239	            assert(stream_name is not None)
2240	            content = _("Your bot `%(bot_identity)s` tried to send a message to stream "

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2360:8
2359	            stream = addressee.stream()
2360	        assert stream is not None
2361	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2385:12
2384	        except ValidationError as e:
2385	            assert isinstance(e.messages[0], str)
2386	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2406:4
2405	    # We render messages later in the process.
2406	    assert message.rendered_content is None
2407	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2518:4
2517	    # Verify the user is in fact a system bot
2518	    assert(is_cross_realm_bot_email(sender_email) or sender_email == settings.ERROR_BOT)
2519	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\actions.py:2700:12
2699	
2700	    query = '''
2701	        SELECT
2702	            zerver_subscription.recipient_id,
2703	            zerver_subscription.user_profile_id
2704	        FROM
2705	            zerver_subscription
2706	        INNER JOIN zerver_userprofile ON
2707	            zerver_userprofile.id = zerver_subscription.user_profile_id
2708	        WHERE
2709	            zerver_subscription.recipient_id in (%s) AND
2710	            zerver_subscription.active AND
2711	            zerver_userprofile.is_active
2712	        ORDER BY
2713	            zerver_subscription.recipient_id,
2714	            zerver_subscription.user_profile_id
2715	        ''' % (id_list,)
2716	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3789:4
3788	    notification_setting_type = UserProfile.notification_setting_types[name]
3789	    assert isinstance(value, notification_setting_type), (
3790	        'Cannot update %s: %s is not an instance of %s' % (
3791	            name, value, notification_setting_type,))
3792	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3816:4
3815	    property_type = UserProfile.property_types[setting_name]
3816	    assert isinstance(setting_value, property_type)
3817	    setattr(user_profile, setting_name, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3824:8
3823	    if setting_name == "default_language":
3824	        assert isinstance(setting_value, str)
3825	        event['language_name'] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:4102:26
4101	        # when we drop support for the old Android app entirely.
4102	        app_message_ids = UserMessage.objects.filter(
4103	            user_profile=user_profile,
4104	            message__id__gt=prev_pointer,
4105	            message__id__lte=pointer).extra(where=[
4106	                UserMessage.where_unread(),
4107	                UserMessage.where_active_push_notification(),
4108	            ]).values_list("message_id", flat=True)
4109	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:4110:8
4109	
4110	        UserMessage.objects.filter(user_profile=user_profile,
4111	                                   message__id__gt=prev_pointer,
4112	                                   message__id__lte=pointer).extra(where=[UserMessage.where_unread()]) \
4113	                           .update(flags=F('flags').bitor(UserMessage.flags.read))

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:4153:11
4152	
4153	    msgs = UserMessage.objects.filter(
4154	        user_profile=user_profile
4155	    ).extra(
4156	        where=[UserMessage.where_unread()]
4157	    )
4158	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:4174:27
4173	
4174	    all_push_message_ids = UserMessage.objects.filter(
4175	        user_profile=user_profile,
4176	    ).extra(
4177	        where=[UserMessage.where_active_push_notification()],
4178	    ).values_list("message_id", flat=True)[0:10000]
4179	    do_clear_mobile_push_notifications_for_ids(user_profile, all_push_message_ids)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:4202:11
4201	
4202	    msgs = msgs.extra(
4203	        where=[UserMessage.where_unread()]
4204	    )
4205	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:4227:32
4226	                                               message_ids: List[int]) -> None:
4227	    filtered_message_ids = list(UserMessage.objects.filter(
4228	        message_id__in=message_ids,
4229	        user_profile=user_profile,
4230	    ).extra(
4231	        where=[UserMessage.where_active_push_notification()],
4232	    ).values_list('message_id', flat=True))
4233	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4264:4
4263	
4264	    assert messages is not None
4265	    msgs = UserMessage.objects.filter(user_profile=user_profile,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4477:8
4476	    if content is not None:
4477	        assert rendered_content is not None
4478	        update_user_message_flags(message, ums)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4560:4
4559	    message.last_edit_time = timezone_now()
4560	    assert message.last_edit_time is not None  # assert needed because stubs for django are missing
4561	    event['edit_timestamp'] = datetime_to_timestamp(message.last_edit_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5221:4
5220	    # These are two structurally for the caller's code path.
5221	    assert prereg_user.referred_by is not None
5222	    assert prereg_user.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5222:4
5221	    assert prereg_user.referred_by is not None
5222	    assert prereg_user.realm is not None
5223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5417:12
5416	        if include_owner_subscribed and user_profile.is_bot:
5417	            assert user_profile.bot_owner is not None
5418	            owner_subs = get_stream_subscriptions_for_user(user_profile.bot_owner).filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5857:4
5856	    export_extra_data = export.extra_data
5857	    assert export_extra_data is not None
5858	    export_data = ujson.loads(export_extra_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:53:4
52	def validate_topic(topic: str) -> str:
53	    assert topic is not None
54	    topic = topic.strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:78:8
77	                 topic: Optional[str]=None) -> None:
78	        assert(msg_type in ['stream', 'private'])
79	        if msg_type == 'stream' and topic is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:95:8
94	    def user_profiles(self) -> Sequence[UserProfile]:
95	        assert(self.is_private())
96	        assert self._user_profiles is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:96:8
95	        assert(self.is_private())
96	        assert self._user_profiles is not None
97	        return self._user_profiles

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:100:8
99	    def stream(self) -> Optional[Stream]:
100	        assert(self.is_stream())
101	        return self._stream

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:104:8
103	    def stream_name(self) -> Optional[str]:
104	        assert(self.is_stream())
105	        return self._stream_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:108:8
107	    def stream_id(self) -> Optional[int]:
108	        assert(self.is_stream())
109	        return self._stream_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:112:8
111	    def topic(self) -> str:
112	        assert(self.is_stream())
113	        assert(self._topic is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:113:8
112	        assert(self.is_stream())
113	        assert(self._topic is not None)
114	        return self._topic

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:196:8
195	    def for_private(emails: Sequence[str], realm: Realm) -> 'Addressee':
196	        assert len(emails) > 0
197	        user_profiles = get_user_profiles(emails, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:205:8
204	    def for_user_ids(user_ids: Sequence[int], realm: Realm) -> 'Addressee':
205	        assert len(user_ids) > 0
206	        user_profiles = get_user_profiles_by_ids(user_ids, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:108:4
107	        return upload_backend.get_avatar_url(hash_key, medium=medium)
108	    assert email is not None
109	    return _get_unversioned_gravatar_url(email, medium)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:118:4
117	    # avatar_url can return None if client_gravatar=True, however here we use the default value of False
118	    assert avatar is not None
119	    return urllib.parse.urljoin(user_profile.realm.uri, avatar)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_lib.py:80:8
79	
80	        assert message['type'] == 'private'
81	        # Ensure that it's a comma-separated list, even though the

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.cElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\__init__.py:19:0
18	import ujson
19	import xml.etree.cElementTree as etree
20	from xml.etree.cElementTree import Element

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\__init__.py:20:0
19	import xml.etree.cElementTree as etree
20	from xml.etree.cElementTree import Element
21	import ahocorasick

--------------------------------------------------
>> Issue: [B313:blacklist] Using xml.etree.cElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-celementtree
   Location: .\zerver\lib\bugdown\__init__.py:573:14
572	    try:
573	        doc = etree.fromstring(''.join(head))
574	    except etree.ParseError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bugdown\__init__.py:1319:12
1318	            # store xmlns as a normal attribute.  :-[
1319	            assert ' zulip-xmlns="' not in rendered
1320	            rendered = rendered.replace(' xmlns="', ' zulip-xmlns="')

--------------------------------------------------
>> Issue: [B313:blacklist] Using xml.etree.cElementTree.iterparse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.cElementTree.iterparse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-celementtree
   Location: .\zerver\lib\bugdown\__init__.py:1321:21
1320	            rendered = rendered.replace(' xmlns="', ' zulip-xmlns="')
1321	            parsed = etree.iterparse(StringIO(rendered))
1322	            for event, elem in parsed:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bugdown\__init__.py:2264:8
2263	    if message is not None:
2264	        assert message_realm is not None  # ensured above if message is not None
2265	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bugdown\api_code_examples.py:50:4
49	    language_and_options = re.match(r"(?P<language>\w+)(,\s*(?P<options>[\"\'\w\d\[\],= ]+))?", input_str)
50	    assert(language_and_options is not None)
51	    kwargs_pattern = re.compile(r"(?P<key>\w+)\s*=\s*(?P<value>[\'\"\w\d]+|\[[\'\",\w\d ]+\])")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bugdown\api_code_examples.py:53:4
52	    language = language_and_options.group("language")
53	    assert(language is not None)
54	    if language_and_options.group("options"):

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\bugdown\nested_code_blocks.py:4:0
3	import markdown
4	from xml.etree.cElementTree import Element
5	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:24:4
23	    # below doesn't have the logic to set user_profile.email properly.
24	    assert realm.email_address_visibility == Realm.EMAIL_ADDRESS_VISIBILITY_EVERYONE
25	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\cache.py:104:17
103	    # Memcached keys should have a length of less than 256.
104	    KEY_PREFIX = hashlib.sha1(KEY_PREFIX.encode('utf-8')).hexdigest() + ":"
105	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\debug.py:82:11
81	    sock = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)
82	    path = "/tmp/tracemalloc.{}".format(os.getpid())
83	    sock.bind(path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\display_recipient.py:26:8
25	    if recipient_type == Recipient.STREAM:
26	        assert recipient_type_id is not None
27	        stream = Stream.objects.values('name').get(id=recipient_type_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:201:8
200	        display_recipient = get_display_recipient(recipient)
201	        assert not isinstance(display_recipient, str)
202	        recipient_str = display_recipient[0]['email']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:208:8
207	        display_recipient = get_display_recipient(recipient)
208	        assert not isinstance(display_recipient, str)
209	        emails = [user_dict['email'] for user_dict in display_recipient]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:240:12
239	            content = part.get_payload(decode=True)
240	            assert isinstance(content, bytes)
241	            if charsets[idx]:

--------------------------------------------------
>> Issue: [B410:blacklist] Using CSSSelector to parse untrusted XML data is known to be vulnerable to XML attacks. Replace CSSSelector with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:30:0
29	import html2text
30	from lxml.cssselect import CSSSelector
31	import lxml.html

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:31:0
30	from lxml.cssselect import CSSSelector
31	import lxml.html
32	import re

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:90:8
89	        # we assert that it does not.
90	        assert match is not None
91	        emoji_code = match.group('emoji_code')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:164:8
163	
164	        assert message.rendered_content is not None
165	        html = message.rendered_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:184:12
183	            display_recipient = get_display_recipient(message.recipient)
184	            assert not isinstance(display_recipient, str)
185	            narrow_link = get_narrow_url(user_profile, message,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:261:8
260	    if message.recipient.type == Recipient.PERSONAL:
261	        assert stream is None
262	        assert display_recipient is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:262:8
261	        assert stream is None
262	        assert display_recipient is None
263	        return personal_narrow_url(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:268:8
267	    elif message.recipient.type == Recipient.HUDDLE:
268	        assert stream is None
269	        if display_recipient is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:271:8
270	            display_recipient = get_display_recipient(message.recipient)
271	        assert display_recipient is not None
272	        assert not isinstance(display_recipient, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:272:8
271	        assert display_recipient is not None
272	        assert not isinstance(display_recipient, str)
273	        other_user_ids = [r['id'] for r in display_recipient

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:280:8
279	    else:
280	        assert display_recipient is None
281	        if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:365:8
364	        # Make sure that this is a list of strings, not a string.
365	        assert not isinstance(display_recipient, str)
366	        other_recipients = [r['full_name'] for r in display_recipient

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\lib\events.py:207:18
206	        if state.get('realm_zoom_api_secret'):
207	            state['realm_zoom_api_secret'] = ''
208	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:782:8
781	    elif event['type'] == "update_display_settings":
782	        assert event['setting_name'] in UserProfile.property_types
783	        state[event['setting_name']] = event['setting']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:785:8
784	    elif event['type'] == "update_global_notifications":
785	        assert event['notification_name'] in UserProfile.notification_setting_types
786	        state[event['notification_name']] = event['setting']

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\export.py:21:0
20	import ujson
21	import subprocess
22	import tempfile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:282:4
281	    # expertise on this export system.
282	    assert ALL_ZULIP_TABLES == all_tables_db
283	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:283:4
282	    assert ALL_ZULIP_TABLES == all_tables_db
283	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES)
284	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:284:4
283	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES)
284	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES)
285	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:285:4
284	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES)
285	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES)
286	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:286:4
285	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES)
286	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES)
287	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:370:8
369	                 exclude: Optional[List[Field]]=None) -> None:
370	        assert table or custom_tables
371	        self.table = table

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:473:8
472	            logging.info('Deleted temporary %s' % (t,))
473	        assert table is not None
474	        response[table] = data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:477:8
476	    elif config.use_all:
477	        assert model is not None
478	        query = model.objects.all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:487:8
486	        model = config.model
487	        assert parent is not None
488	        assert parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:488:8
487	        assert parent is not None
488	        assert parent.table is not None
489	        assert config.parent_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:489:8
488	        assert parent.table is not None
489	        assert config.parent_key is not None
490	        parent_ids = [r['id'] for r in response[parent.table]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:494:8
493	            filter_parms.update(config.filter_args)
494	        assert model is not None
495	        query = model.objects.filter(**filter_parms)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:503:8
502	        model = config.model
503	        assert model is not None
504	        # This will be a tuple of the form ('zerver_article', 'blog').

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:518:8
517	    if rows is not None:
518	        assert table is not None  # Hint for mypy
519	        response[table] = make_raw(rows, exclude=config.exclude)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:810:16
809	            if row['id'] in exportable_user_ids:
810	                assert not row['is_mirror_dummy']
811	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:878:4
877	    realm = context['realm']
878	    assert config.parent is not None
879	    assert config.parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:879:4
878	    assert config.parent is not None
879	    assert config.parent.table is not None
880	    user_profile_ids = set(r['id'] for r in response[config.parent.table])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1083:8
1082	        message_ids = set(m['id'] for m in message_chunk)
1083	        assert len(message_ids.intersection(all_message_ids)) == 0
1084	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1406:8
1405	    if not settings.TEST_SUITE:
1406	        assert threads >= 1
1407	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1468:4
1467	    os.chdir(os.path.dirname(output_dir))
1468	    subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
1469	    os.chdir(reset_dir)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1468:4
1467	    os.chdir(os.path.dirname(output_dir))
1468	    subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
1469	    os.chdir(reset_dir)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1515:8
1514	
1515	        subprocess.call(arguments)
1516	        return 0

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\fix_unreads.py:52:12
51	    um_id_list = ', '.join(str(id) for id in user_message_ids)
52	    query = '''
53	        UPDATE zerver_usermessage
54	        SET flags = flags | 1
55	        WHERE id IN (%s)
56	    ''' % (um_id_list,)
57	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\fix_unreads.py:107:16
106	
107	        query = '''
108	            SELECT
109	                zerver_usermessage.id
110	            FROM
111	                zerver_usermessage
112	            INNER JOIN zerver_message ON (
113	                zerver_message.id = zerver_usermessage.message_id
114	            )
115	            WHERE (
116	                zerver_usermessage.user_profile_id = %s AND
117	                (zerver_usermessage.flags & 1) = 0 AND
118	                zerver_message.recipient_id in (%s)
119	            )
120	        ''' % (user_profile.id, recips)
121	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\fix_unreads.py:193:16
192	
193	        query = '''
194	            SELECT
195	                zerver_usermessage.id,
196	                zerver_message.recipient_id,
197	                zerver_message.subject
198	            FROM
199	                zerver_usermessage
200	            INNER JOIN zerver_message ON (
201	                zerver_message.id = zerver_usermessage.message_id
202	            )
203	            WHERE (
204	                zerver_usermessage.user_profile_id = %s AND
205	                zerver_usermessage.message_id <= %s AND
206	                (zerver_usermessage.flags & 1) = 0 AND
207	                zerver_message.recipient_id in (%s)
208	            )
209	        ''' % (user_profile.id, pointer, recips)
210	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:119:12
118	    vals = text.split()
119	    start = random.randrange(len(vals))
120	    end = random.randrange(len(vals) - start) + start

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:120:10
119	    start = random.randrange(len(vals))
120	    end = random.randrange(len(vals) - start) + start
121	    vals[start] = mode + vals[start]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:129:12
128	    vals = text.split()
129	    start = random.randrange(len(vals))
130	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:137:12
136	    vals = text.split()
137	    start = random.randrange(len(vals))
138	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:1:0
1	import lxml
2	
3	from lxml.html.diff import htmldiff

--------------------------------------------------
>> Issue: [B410:blacklist] Using htmldiff to parse untrusted XML data is known to be vulnerable to XML attacks. Replace htmldiff with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:3:0
2	
3	from lxml.html.diff import htmldiff
4	from typing import Optional

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\i18n.py:44:4
43	    seconds = list(range(firsts_end, lang_len))
44	    assert len(firsts) + len(seconds) == lang_len
45	    for row in zip_longest(firsts, seconds):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:309:12
308	            )
309	            assert(rendered_content is not None)
310	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\import_realm.py:347:17
346	    sequence = idseq(model_class)
347	    conn.execute("select nextval('%s') from generate_series(1,%s)" %
348	                 (sequence, str(count)))
349	    query = conn.fetchall()  # Each element in the result is a tuple like (5,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:382:4
381	    # See comments in bulk_import_user_message_data.
382	    assert('usermessage' not in related_table)
383	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:513:4
512	    # memory errors. We don't even use ids from ID_MAP.
513	    assert('usermessage' not in table)
514	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\import_realm.py:999:31
998	        # Longer-term, the plan is to eliminate pointer as a concept.
999	        first_unread_message = UserMessage.objects.filter(user_profile=user_profile).extra(
1000	            where=[UserMessage.where_unread()]
1001	        ).order_by("message_id").first()
1002	        if first_unread_message is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:1173:12
1172	        for row in data['zerver_usermessage']:
1173	            assert(row['message'] in message_id_map)
1174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\integrations.py:214:8
213	    def __init__(self, name: str, *args: Any, **kwargs: Any) -> None:
214	        assert kwargs.get("client_name") is None
215	        client_name = self.DEFAULT_CLIENT_NAME.format(name=name.title())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\logging_util.py:85:60
84	                        tb = str(record)
85	                    key = self.__class__.__name__.upper() + hashlib.sha1(tb.encode()).hexdigest()
86	                    duplicate = cache.get(key) == 1

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\mdiff.py:2:0
1	import os
2	import subprocess
3	import logging

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\mdiff.py:17:11
16	    command = ['node', mdiff_path, output, expected_output]
17	    diff = subprocess.check_output(command).decode('utf-8')
18	    return diff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:354:12
353	            obj['last_edit_timestamp'] = datetime_to_timestamp(last_edit_time)
354	            assert edit_history is not None
355	            obj['edit_history'] = ujson.loads(edit_history)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:371:12
370	
371	            assert message is not None  # Hint for mypy.
372	            # It's unfortunate that we need to have side effects on the message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:454:12
453	        elif recipient_type in (Recipient.HUDDLE, Recipient.PERSONAL):
454	            assert not isinstance(display_recipient, str)
455	            display_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:684:4
683	    # str is for streams.
684	    assert not isinstance(display_recipient, str)
685	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:776:16
775	def get_starred_message_ids(user_profile: UserProfile) -> List[int]:
776	    return list(UserMessage.objects.filter(
777	        user_profile=user_profile,
778	    ).extra(
779	        where=[UserMessage.where_starred()]
780	    ).order_by(
781	        'message_id'

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:788:16
787	
788	    user_msgs = UserMessage.objects.filter(
789	        user_profile=user_profile
790	    ).exclude(
791	        message__recipient_id__in=excluded_recipient_ids
792	    ).extra(
793	        where=[UserMessage.where_unread()]
794	    ).values(
795	        'message_id',

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\message.py:1077:12
1076	
1077	    query = '''
1078	    SELECT
1079	        subquery.recipient_id, MAX(subquery.message_id)
1080	    FROM (
1081	        (SELECT
1082	            um.message_id AS message_id,
1083	            m.recipient_id AS recipient_id
1084	        FROM
1085	            zerver_usermessage um
1086	        JOIN
1087	            zerver_message m
1088	        ON
1089	            um.message_id = m.id
1090	        WHERE
1091	            um.user_profile_id=%(user_profile_id)d AND
1092	            um.flags & 2048 <> 0 AND
1093	            m.recipient_id <> %(my_recipient_id)d
1094	        ORDER BY message_id DESC
1095	        LIMIT %(conversation_limit)d)
1096	        UNION ALL
1097	        (SELECT
1098	            um.message_id AS message_id,
1099	            r.id AS recipient_id
1100	        FROM
1101	            zerver_usermessage um
1102	        JOIN
1103	            zerver_message m
1104	        ON
1105	            um.message_id = m.id
1106	        JOIN
1107	            zerver_recipient r
1108	        ON
1109	            r.type = 1 AND
1110	            r.type_id = m.sender_id
1111	        WHERE
1112	            um.user_profile_id=%(user_profile_id)d AND
1113	            um.flags & 2048 <> 0 AND
1114	            m.recipient_id=%(my_recipient_id)d
1115	        ORDER BY message_id DESC
1116	        LIMIT %(conversation_limit)d)
1117	    ) AS subquery
1118	    GROUP BY subquery.recipient_id
1119	    ''' % dict(
1120	        user_profile_id=user_profile.id,
1121	        conversation_limit=RECENT_CONVERSATIONS_LIMIT,
1122	        my_recipient_id=my_recipient_id,
1123	    )
1124	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:18:11
17	    # support multiple postgres versions.
18	    stmt = '''
19	        UPDATE %s
20	        SET %s
21	        WHERE id >= %%s AND id < %%s
22	    ''' % (table, ', '.join(['%s = %%s' % (col) for col in cols]))
23	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:24:19
23	
24	    cursor.execute("SELECT MIN(id), MAX(id) FROM %s" % (table,))
25	    (min_id, max_id) = cursor.fetchall()[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\migrate.py:45:27
44	        if min_id > max_id:
45	            cursor.execute("SELECT MAX(id) FROM %s" % (table,))
46	            max_id = cursor.fetchall()[0][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:17:4
16	    the bitwise xor of the two hex strings."""
17	    assert len(bytes_a) == len(bytes_b)
18	    return ''.join(["%x" % (int(x, 16) ^ int(y, 16),)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:30:4
29	def otp_encrypt_api_key(api_key: str, otp: str) -> str:
30	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
31	    hex_encoded_api_key = ascii_to_hex(api_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:32:4
31	    hex_encoded_api_key = ascii_to_hex(api_key)
32	    assert len(hex_encoded_api_key) == UserProfile.API_KEY_LENGTH * 2
33	    return xor_hex_strings(hex_encoded_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:36:4
35	def otp_decrypt_api_key(otp_encrypted_api_key: str, otp: str) -> str:
36	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
37	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:37:4
36	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
37	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2
38	    hex_encoded_api_key = xor_hex_strings(otp_encrypted_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:43:8
42	    try:
43	        assert len(otp) == UserProfile.API_KEY_LENGTH * 2
44	        [int(c, 16) for c in otp]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\openapi.py:54:8
53	            self.reload()
54	        assert(self.data)
55	        return self.data

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\push_notifications.py:6:0
5	import logging
6	import lxml.html
7	import re

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:585:8
584	        recipients = get_display_recipient(message.recipient)
585	        assert isinstance(recipients, list)
586	        return ', '.join(sorted(r['full_name'] for r in recipients))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:295:16
294	                # or don't declare them using REQ.
295	                assert func_var_name in kwargs
296	            if func_var_name in kwargs:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:298:12
297	                continue
298	            assert func_var_name is not None
299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:328:20
327	                if post_var_name is not None:
328	                    assert req_var is not None
329	                    raise RequestConfusingParmsError(post_var_name, req_var)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:334:16
333	                post_var_name = param.post_var_name
334	                assert post_var_name is not None
335	                if param.default is _REQ.NotSpecified:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:68:4
67	def ids_list_to_sql_query_format(ids: List[int]) -> str:
68	    assert len(ids) > 0
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:86:4
85	    # (such as UserMessage, Reaction, and Attachment) inside the same transaction.atomic() block.
86	    assert type in (ArchiveTransaction.MANUAL, ArchiveTransaction.RETENTION_POLICY_BASED)
87	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:165:4
164	    """
165	    assert realm.message_retention_days is not None
166	    check_date = timezone_now() - timedelta(days=realm.message_retention_days)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:201:4
200	def move_models_with_message_key_to_archive(msg_ids: List[int]) -> None:
201	    assert len(msg_ids) > 0
202	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:216:4
215	def move_attachments_to_archive(msg_ids: List[int]) -> None:
216	    assert len(msg_ids) > 0
217	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:232:4
231	def move_attachment_messages_to_archive(msg_ids: List[int]) -> None:
232	    assert len(msg_ids) > 0
233	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:289:12
288	        else:
289	            assert realm.message_retention_days is not None
290	            retention_policy_dict[stream.id] = realm.message_retention_days

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:43:4
42	    # Callers should pass exactly one of to_user_id and to_email.
43	    assert (to_user_ids is None) ^ (to_emails is None)
44	    if to_user_ids is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:137:4
136	
137	    assert (to_user_ids is None) ^ (to_emails is None)
138	    email = ScheduledEmail.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:151:12
150	        else:
151	            assert to_emails is not None
152	            assert(len(to_emails) == 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:152:12
151	            assert to_emails is not None
152	            assert(len(to_emails) == 1)
153	            email.address = parseaddr(to_emails[0])[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:129:4
128	    """
129	    assert user_profile.last_active_message_id is not None
130	    all_stream_subs = list(Subscription.objects.filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:160:12
159	        if stream_subscription_logs[-1].event_type == RealmAuditLog.SUBSCRIPTION_DEACTIVATED:
160	            assert stream_subscription_logs[-1].event_last_message_id is not None
161	            if stream_subscription_logs[-1].event_last_message_id <= user_profile.last_active_message_id:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\stream_recipient.py:34:16
33	        id_list = ', '.join(str(stream_id) for stream_id in stream_ids)
34	        query = '''
35	            SELECT
36	                zerver_recipient.id as recipient_id,
37	                zerver_stream.id as stream_id
38	            FROM
39	                zerver_stream
40	            INNER JOIN zerver_recipient ON
41	                zerver_stream.id = zerver_recipient.type_id
42	            WHERE
43	                zerver_recipient.type = %d
44	            AND
45	                zerver_stream.id in (%s)
46	            ''' % (Recipient.STREAM, id_list)
47	        self._process_query(query)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\stream_recipient.py:60:16
59	        id_list = ', '.join(str(recip_id) for recip_id in recipient_ids)
60	        query = '''
61	            SELECT
62	                zerver_recipient.id as recipient_id,
63	                zerver_stream.id as stream_id
64	            FROM
65	                zerver_recipient
66	            INNER JOIN zerver_stream ON
67	                zerver_stream.id = zerver_recipient.type_id
68	            WHERE
69	                zerver_recipient.type = %d
70	            AND
71	                zerver_recipient.id in (%s)
72	            ''' % (Recipient.STREAM, id_list)
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:93:4
92	    # backwards-compatibility problem in our view.
93	    assert not notification_settings_null
94	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:26:4
25	    # all callers should have the require_realm_admin decorator.
26	    assert(user_profile.is_realm_admin)
27	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:251:8
250	        # caller, but it makes sense to verify anyway.
251	        assert stream_name == stream_name.strip()
252	        check_stream_name(stream_name)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-z0-9_]{24}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\test_classes.py:132:30
131	    DEFAULT_REALM = Realm.objects.get(string_id='zulip')
132	    TOKENIZED_NOREPLY_REGEX = settings.TOKENIZED_NOREPLY_EMAIL_ADDRESS.format(token="[a-z0-9_]{24}")
133	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:469:8
468	
469	        assert(len(to_emails) >= 2)
470	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:919:8
918	    def setUp(self) -> None:
919	        assert self.migrate_from and self.migrate_to, \
920	            "TestCase '{}' must define migrate_from and migrate_to properties".format(type(self).__name__)
921	        migrate_from = [(self.app, self.migrate_from)]  # type: List[Tuple[str, str]]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_fixtures.py:6:0
5	import hashlib
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_fixtures.py:80:4
79	        return
80	    subprocess.check_call(generate_fixtures_command)
81	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\zerver\lib\test_fixtures.py:88:27
87	        with connection.cursor() as cursor:
88	            cursor.execute("SELECT 1 from pg_database WHERE datname='{}';".format(database_name))
89	            return_value = bool(cursor.fetchone())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\test_fixtures.py:157:26
156	    """
157	    target_hash_content = hashlib.sha1(target_content.encode('utf8')).hexdigest()
158	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\test_fixtures.py:293:8
292	    commands = "\n".join("DROP DATABASE IF EXISTS %s;" % (db,) for db in databases_to_drop)
293	    p = subprocess.Popen(["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost",
294	                          "postgres", "zulip_test"],
295	                         stdin=subprocess.PIPE)
296	    p.communicate(input=commands.encode())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_fixtures.py:293:8
292	    commands = "\n".join("DROP DATABASE IF EXISTS %s;" % (db,) for db in databases_to_drop)
293	    p = subprocess.Popen(["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost",
294	                          "postgres", "zulip_test"],
295	                         stdin=subprocess.PIPE)
296	    p.communicate(input=commands.encode())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:391:8
390	
391	        assert len(pattern_cnt) > 100
392	        untested_patterns = set([p for p in pattern_cnt if pattern_cnt[p] == 0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:469:4
468	def load_subdomain_token(response: HttpResponse) -> Dict[str, Any]:
469	    assert isinstance(response, HttpResponseRedirect)
470	    token = response.url.rsplit('/', 1)[1]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\test_runner.py:42:24
41	# below hack, which fails 1/10000000 of the time.
42	random_id_range_start = random.randint(1, 10000000) * 100
43	# The root directory for this run of the test suite.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_runner.py:104:4
103	
104	    assert isinstance(result, TextTestResult) or isinstance(result, RemoteTestResult)
105	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\tex.py:3:0
2	import os
3	import subprocess
4	from django.conf import settings

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\tex.py:33:12
32	        command.extend(['--display-mode'])
33	    katex = subprocess.Popen(command,
34	                             stdin=subprocess.PIPE,
35	                             stdout=subprocess.PIPE,
36	                             stderr=subprocess.PIPE)
37	    stdout = katex.communicate(input=tex.encode())[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\tex.py:40:8
39	        # stdout contains a newline at the end
40	        assert stdout is not None
41	        return stdout.decode('utf-8').strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:55:12
54	            # Attempt to raise a TimeoutExpired in the thread represented by 'self'.
55	            assert self.ident is not None  # Thread should be running; c_long expects int
56	            tid = ctypes.c_long(self.ident)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:89:4
88	        six.reraise(thread.exc_info[0], thread.exc_info[1], thread.exc_info[2])
89	    assert thread.result is not None  # assured if above did not reraise
90	    return thread.result

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\upload.py:667:19
666	            str(user_profile.realm_id),
667	            format(random.randint(0, 255), 'x'),
668	            random_name(18),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_agent.py:13:4
12	           $""", user_agent, re.X)
13	    assert match is not None
14	    return match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:123:8
122	    if base_query is None:
123	        assert realm is not None
124	        query = UserProfile.objects.filter(realm=realm, is_active=True)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\users.py:146:15
145	        where_clause = "UPPER(zerver_userprofile.email::text) IN (%s)" % (upper_list,)
146	        return query.select_related("realm").extra(
147	            where=[where_clause],
148	            params=emails)
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:241:8
240	        # Put an assertion so that mypy doesn't complain.
241	        assert field_data is not None
242	        result = choice_field_validator(var_name, field_data, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:142:4
141	
142	    assert db_chunk_size >= 2
143	    assert chunk_size >= 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:143:4
142	    assert db_chunk_size >= 2
143	    assert chunk_size >= 2
144	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:146:8
145	    if id_collector is not None:
146	        assert(len(id_collector) == 0)
147	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:154:12
153	        while True:
154	            assert db_chunk_size is not None  # Hint for mypy, but also workaround for mypy bug #3442.
155	            rows = list(q.filter(id__gt=min_id)[0:db_chunk_size])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:172:8
171	        tup_ids = set([tup[0] for tup in tup_chunk])
172	        assert len(tup_ids) == len(tup_chunk)
173	        assert len(tup_ids.intersection(id_collector)) == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:173:8
172	        assert len(tup_ids) == len(tup_chunk)
173	        assert len(tup_ids.intersection(id_collector)) == 0
174	        id_collector.update(tup_ids)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\lib\video_calls.py:12:15
11	
12	    response = requests.post(
13	        'https://api.zoom.us/v2/users/' + user_id + '/meetings',
14	        headers = {
15	            'Authorization': 'Bearer ' + encodedToken,
16	            'content-type': 'application/json'
17	        },
18	        json = {}
19	    )
20	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:62:8
61	    if stream is None:
62	        assert user_profile.bot_owner is not None
63	        check_send_private_message(user_profile, request.client,

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\logging_handlers.py:6:0
5	import os
6	import subprocess
7	import traceback

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\logging_handlers.py:20:15
19	    try:  # nocoverage
20	        return subprocess.check_output(
21	            ['git', 'describe', '--tags', '--match=[0-9]*', '--always', '--dirty', '--long'],
22	            stderr=subprocess.PIPE,
23	            cwd=os.path.join(os.path.dirname(__file__), '..'),
24	        ).strip().decode('utf-8')
25	    except Exception:  # nocoverage

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\logging_handlers.py:20:15
19	    try:  # nocoverage
20	        return subprocess.check_output(
21	            ['git', 'describe', '--tags', '--match=[0-9]*', '--always', '--dirty', '--long'],
22	            stderr=subprocess.PIPE,
23	            cwd=os.path.join(os.path.dirname(__file__), '..'),
24	        ).strip().decode('utf-8')
25	    except Exception:  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\add_users_to_streams.py:24:8
23	        realm = self.get_realm(options)
24	        assert realm is not None  # Should be ensured by parser
25	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\backup.py:91:12
90	
91	            assert not any("|" in name or "|" in path for name, path in paths)
92	            transform_args = [

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\compilemessages.py:6:0
5	import ujson
6	from subprocess import CalledProcessError, check_output
7	from typing import Any, Dict, List

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\compilemessages.py:75:17
74	    def get_locales(self) -> List[str]:
75	        output = check_output(['git', 'ls-files', 'locale'])
76	        tracked_files = output.decode().split()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\compilemessages.py:75:17
74	    def get_locales(self) -> List[str]:
75	        output = check_output(['git', 'ls-files', 'locale'])
76	        tracked_files = output.decode().split()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_default_stream_groups.py:43:8
42	        realm = self.get_realm(options)
43	        assert realm is not None  # Should be ensured by parser
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_stream.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_user.py:55:8
54	        realm = self.get_realm(options)
55	        assert realm is not None  # Should be ensured by parser
56	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\deactivate_realm.py:15:8
14	        realm = self.get_realm(options)
15	        assert realm is not None  # Should be ensured by parser
16	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\export.py:110:8
109	        realm = self.get_realm(options)
110	        assert realm is not None  # Should be ensured by parser
111	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export_single_user.py:3:0
2	import shutil
3	import subprocess
4	import tempfile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export_single_user.py:44:8
43	        tarball_path = output_dir.rstrip('/') + '.tar.gz'
44	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
45	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export_single_user.py:44:8
43	        tarball_path = output_dir.rstrip('/') + '.tar.gz'
44	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
45	        print("Tarball written to %s" % (tarball_path,))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\zerver\management\commands\export_usermessage_batch.py:41:12
40	                shutil.move(partial_path, locked_path)
41	            except Exception:
42	                # Already claimed by another process
43	                continue
44	            logging.info("Thread %s processing %s" % (options['thread'], output_path))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\generate_invite_links.py:27:8
26	        realm = self.get_realm(options)
27	        assert realm is not None  # Should be ensured by parser
28	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\generate_multiuse_invite_link.py:30:8
29	        realm = self.get_realm(options)
30	        assert realm is not None  # Should be ensured by parser
31	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\import.py:3:0
2	import os
3	import subprocess
4	from typing import Any

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\import.py:47:8
46	        call_command('flush', verbosity=0, interactive=False)
47	        subprocess.check_call([os.path.join(settings.DEPLOY_ROOT, "scripts/setup/flush-memcached")])
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\merge_streams.py:32:8
31	        realm = self.get_realm(options)
32	        assert realm is not None  # Should be ensured by parser
33	        stream_to_keep = get_stream(options["stream_to_keep"], realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\process_queue.py:58:12
57	                td.start()
58	            assert len(queues) == cnt
59	            logger.info('%d queue worker threads were launched' % (cnt,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\reactivate_realm.py:15:8
14	        realm = self.get_realm(options)
15	        assert realm is not None  # Should be ensured by parser
16	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:32:8
31	        realm = self.get_realm(options)
32	        assert realm is not None  # Should be ensured by parser
33	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_filters.py:38:8
37	        realm = self.get_realm(options)
38	        assert realm is not None  # Should be ensured by parser
39	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\register_server.py:4:0
3	import requests
4	import subprocess
5	from typing import Any

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\management\commands\register_server.py:74:23
73	        try:
74	            response = requests.post(registration_url, params=request)
75	        except Exception:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\register_server.py:92:16
91	                print("Success! Updating %s with the new key..." % (SECRETS_FILENAME,))
92	                subprocess.check_call(["crudini", '--set', SECRETS_FILENAME, "secrets", "zulip_org_key",
93	                                       request["new_org_key"]])
94	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\register_server.py:92:16
91	                print("Success! Updating %s with the new key..." % (SECRETS_FILENAME,))
92	                subprocess.check_call(["crudini", '--set', SECRETS_FILENAME, "secrets", "zulip_org_key",
93	                                       request["new_org_key"]])
94	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\remove_users_from_stream.py:24:8
23	        realm = self.get_realm(options)
24	        assert realm is not None  # Should be ensured by parser
25	        user_profiles = self.get_users(options, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\rename_stream.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	        old_name = options['old_name']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\scrub_realm.py:15:8
14	        realm = self.get_realm(options)
15	        assert realm is not None  # Should be ensured by parser
16	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\send_custom_email.py:3:0
2	import shutil
3	import subprocess
4	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\send_custom_email.py:53:4
52	    # compile this one template, not all of them.
53	    subprocess.check_call(["./scripts/setup/inline-email-css"])
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_realm_reactivation_email.py:16:8
15	        realm = self.get_realm(options)
16	        assert realm is not None
17	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\show_admins.py:14:8
13	        realm = self.get_realm(options)
14	        assert realm is not None  # True because of required=True above
15	        users = realm.get_admin_users_and_bots()

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\management\commands\show_unreads.py:11:16
10	def get_unread_messages(user_profile: UserProfile) -> List[Dict[str, Any]]:
11	    user_msgs = UserMessage.objects.filter(
12	        user_profile=user_profile,
13	        message__recipient__type=Recipient.STREAM
14	    ).extra(
15	        where=[UserMessage.where_unread()]
16	    ).values(
17	        'message_id',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:110:4
109	                   error_content_iter: Optional[Iterable[AnyStr]]=None) -> None:
110	    assert error_content is None or error_content_iter is None
111	    if error_content is not None:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\middleware.py:220:23
219	        log_data["prof"].disable()
220	        profile_path = "/tmp/profile.data.%s.%s" % (path.split("/")[-1], int(time_delta * 1000),)
221	        log_data["prof"].dump_stats(profile_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:225:8
224	    if 400 <= status_code < 500 and status_code not in [401, 404, 405]:
225	        assert error_content_iter is not None
226	        error_content_list = list(error_content_iter)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:475:12
474	        if getattr(request, "placeholder_open_graph_description", None) is not None:
475	            assert not response.streaming
476	            response.content = alter_content(request, response.content)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\migrations\0077_add_file_name_field_to_realm_emoji.py:62:23
61	        try:
62	            response = requests.get(image_url, stream=True)
63	        except ConnectionError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0237_rename_zulip_realm_to_zulipinternal.py:25:4
24	    welcome_bot = UserProfile.objects.get(email="welcome-bot@zulip.com")
25	    assert welcome_bot.realm.id == internal_realm.id
26	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:68:4
67	    '''
68	    assert(user_ids)
69	    value_list = ', '.join(str(int(user_id)) for user_id in user_ids)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:71:12
70	    clause = '%s in (%s)' % (field, value_list)
71	    query = query.extra(
72	        where=[clause]
73	    )
74	    return query

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:129:4
128	    supported_backends = django.contrib.auth.get_backends()
129	    assert supported_backends is not None
130	    return supported_backends

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:1123:8
1122	
1123	        assert self.realm.invite_to_stream_policy == Realm.INVITE_TO_STREAM_POLICY_WAITING_PERIOD
1124	        diff = (timezone_now() - self.date_joined).days

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:1468:15
1467	        where_clause = "UPPER(zerver_stream.name::text) IN (%s)" % (upper_list,)
1468	        return get_active_streams(realm.id).select_related("realm").extra(
1469	            where=[where_clause],
1470	            params=stream_names)
1471	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:1506:4
1505	def get_huddle_user_ids(recipient: Recipient) -> List[int]:
1506	    assert(recipient.type == Recipient.HUDDLE)
1507	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:1517:4
1516	    """
1517	    assert all(recipient.type == Recipient.HUDDLE for recipient in recipients)
1518	    if not recipients:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2145:4
2144	        return get_system_bot(email)
2145	    assert realm is not None
2146	    return get_user(email, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:47:4
46	
47	    assert ids_list == user_ids
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:86:4
85	    # {code_example|end}
86	    assert result['result'] == 'success'
87	    assert 'newbie@zulip.com' in result['subscribed']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:87:4
86	    assert result['result'] == 'success'
87	    assert 'newbie@zulip.com' in result['subscribed']
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:158:4
157	
158	    assert result['result'] == 'success'
159	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:194:4
193	    members = [m for m in result['members'] if m['email'] == 'newbie@zulip.com']
194	    assert len(members) == 1
195	    newbie = members[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:196:4
195	    newbie = members[0]
196	    assert not newbie['is_admin']
197	    assert newbie['full_name'] == 'New User'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:197:4
196	    assert not newbie['is_admin']
197	    assert newbie['full_name'] == 'New User'
198	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:205:4
204	    validate_against_openapi_schema(result, '/users', 'get', '200')
205	    assert result['members'][0]['avatar_url'] is None
206	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:215:12
214	        if member["is_bot"]:
215	            assert member.get('profile_data', None) is None
216	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:217:12
216	        else:
217	            assert member.get('profile_data', None) is not None
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:299:4
298	
299	    assert result['result'] == 'success'
300	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:312:4
311	    streams = [s for s in result['streams'] if s['name'] == 'new stream']
312	    assert streams[0]['description'] == 'New stream for testing'
313	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:321:4
320	    validate_against_openapi_schema(result, '/streams', 'get', '200')
321	    assert len(result['streams']) == 4
322	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:339:4
338	    validate_against_openapi_schema(result, '/streams/{stream_id}', 'patch', '200')
339	    assert result['result'] == 'success'
340	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:353:4
352	                         if u['name'] == "hamletcharacters"][0]
353	    assert hamlet_user_group['description'] == 'Characters of Hamlet'
354	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:370:4
369	    result = client.get_subscribers(stream='new stream')
370	    assert result['subscribers'] == ['iago@zulip.com', 'newbie@zulip.com']
371	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:376:4
375	    result = client.get_user_agent()
376	    assert result.startswith('ZulipPython/')
377	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:390:4
389	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']
390	    assert streams[0]['description'] == 'New stream for testing'
391	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:408:4
407	    result = client.list_subscriptions()
408	    assert result['result'] == 'success'
409	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:410:4
409	    streams = [s for s in result['subscriptions'] if s['name'] == 'new stream']
410	    assert len(streams) == 0
411	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:560:4
559	    validate_against_openapi_schema(result, '/messages', 'get', '200')
560	    assert len(result['messages']) <= request['num_before']
561	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:566:4
565	
566	    assert int(message_id)
567	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:600:4
599	    )
600	    assert result['result'] == 'success'
601	    assert result['raw_content'] == request['content']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:601:4
600	    assert result['result'] == 'success'
601	    assert result['raw_content'] == request['content']
602	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:622:4
621	    )
622	    assert result['result'] == 'success'
623	    assert result['raw_content'] == request['content']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:623:4
622	    assert result['result'] == 'success'
623	    assert result['raw_content'] == request['content']
624	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:637:4
636	
637	    assert result['result'] == 'success'
638	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:651:4
650	
651	    assert result['result'] == 'success'
652	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:682:4
681	
682	    assert int(message_id)
683	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:704:4
703	    )
704	    assert result['result'] == 'success'
705	    assert result['raw_content'] == request['content']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:705:4
704	    assert result['result'] == 'success'
705	    assert result['raw_content'] == request['content']
706	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:951:4
950	
951	    assert result['result'] == 'success'
952	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:960:4
959	
960	    assert result['result'] == 'success'
961	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:969:4
968	
969	    assert result['result'] == 'success'
970	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:987:4
986	
987	    assert result['result'] == 'success'
988	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1001:4
1000	    # {code_example|end}
1001	    assert result['result'] == 'success'
1002	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1011:4
1010	    validate_against_openapi_schema(result, '/user_groups/{group_id}', 'delete', '200')
1011	    assert result['result'] == 'success'
1012	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1026:4
1025	
1026	    assert result['result'] == 'success'
1027	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1073:8
1072	    else:
1073	        assert result[key] == fixture[key]
1074	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1083:8
1082	    else:
1083	        assert len(result) == len(fixture)
1084	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1092:8
1091	    else:
1092	        assert key in result
1093	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\test_curl_examples.py:4:0
3	import shlex
4	import subprocess
5	import markdown

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\test_curl_examples.py:49:32
48	                # returns non-JSON output, we'll still print it.
49	                response_json = subprocess.check_output(generated_curl_command).decode('utf-8')
50	                response = json.loads(response_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\test_curl_examples.py:51:16
50	                response = json.loads(response_json)
51	                assert(response["result"] == "success")
52	            except (AssertionError, Exception):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\templatetags\app_filters.py:158:11
157	
158	    return mark_safe(rendered_html)

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\templatetags\app_filters.py:158:11
157	
158	    return mark_safe(rendered_html)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_audit_log.py:72:19
71	        user = self.example_user('hamlet')
72	        password = 'test1'
73	        do_change_password(user, password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:92:8
91	
92	        assert good_kwargs is not None
93	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:180:19
179	        user_profile = self.example_user('hamlet')
180	        password = "testpassword"
181	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:217:19
216	        user_profile = self.example_user('hamlet')
217	        password = "testpassword"
218	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:282:26
281	        # Test LDAP auth fails when LDAP server rejects password
282	        self.assertIsNone(backend.authenticate(username=email, password="wrongpass", realm=get_realm("zulip")))
283	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:547:8
546	        self.assertEqual(result.status_code, 302)
547	        assert self.AUTHORIZATION_URL in result.url
548	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:592:12
591	            self.assert_in_success_response(["Select account"], result)
592	            assert self.AUTH_FINISH_URL == "/complete/github/"
593	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:618:12
617	            # that screen.
618	            assert not expect_choose_email_screen
619	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:995:8
994	        self.assertEqual(result.status_code, 302)
995	        assert self.AUTHORIZATION_URL in result.url
996	        assert "samlrequest" in result.url.lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:996:8
995	        assert self.AUTHORIZATION_URL in result.url
996	        assert "samlrequest" in result.url.lower()
997	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://github.com/login/oauth/access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:1227:23
1226	    AUTHORIZATION_URL = "https://github.com/login/oauth/authorize"
1227	    ACCESS_TOKEN_URL = "https://github.com/login/oauth/access_token"
1228	    USER_INFO_URL = "https://api.github.com/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://accounts.google.com/o/oauth2/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:1442:23
1441	    AUTHORIZATION_URL = "https://accounts.google.com/o/oauth2/auth"
1442	    ACCESS_TOKEN_URL = "https://accounts.google.com/o/oauth2/token"
1443	    USER_INFO_URL = "https://www.googleapis.com/oauth2/v3/userinfo"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1718:34
1717	        result = self.client_post("/json/fetch_api_key",
1718	                                  dict(user_profile=self.user_profile,
1719	                                       password="wrong"))
1720	        self.assert_json_error(result, "Your username or password is incorrect.", 400)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:1742:34
1741	        result = self.client_post("/api/v1/fetch_api_key",
1742	                                  dict(username=self.email,
1743	                                       password="wrong"))
1744	        self.assert_json_error(result, "Your username or password is incorrect.", 403)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:2472:19
2471	        user_profile = self.example_user("hamlet")
2472	        password = "testpassword"
2473	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dapu'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:2557:27
2556	        ):
2557	            user_profile = self.backend.authenticate(username='ldapuser1', password='dapu',
2558	                                                     realm=get_realm('zulip'))
2559	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2560:12
2559	
2560	            assert(user_profile is None)
2561	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2568:12
2567	
2568	            assert(user_profile is not None)
2569	            self.assertEqual(user_profile.email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2577:12
2576	
2577	            assert(user_profile is not None)
2578	            self.assertEqual(user_profile, self.example_user("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2587:12
2586	
2587	            assert (user_profile is not None)
2588	            self.assertEqual(user_profile, self.example_user("aaron"))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:2608:23
2607	            othello = self.example_user('othello')
2608	            password = "testpassword"
2609	            othello.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:2620:19
2619	        with self.settings(LDAP_APPEND_DOMAIN='zulip.com'):
2620	            user = self.backend.authenticate(username=self.example_email("hamlet"), password='wrong',
2621	                                             realm=get_realm('zulip'))
2622	            self.assertIs(user, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2778:12
2777	                                                     realm=get_realm('zulip'))
2778	            assert(user_profile is not None)
2779	            self.assertEqual(user_profile.email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2802:12
2801	                                                     realm=get_realm('zulip'))
2802	            assert(user_profile is not None)
2803	            self.assertEqual(user_profile.email, 'newuser@acme.com')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2820:12
2819	                                                     realm=get_realm('zulip'))
2820	            assert(user_profile is not None)
2821	            self.assertEqual(user_profile.email, 'newuser_splitname@zulip.com')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:2845:13
2844	        """
2845	        with self.settings(
2846	                LDAP_DEACTIVATE_NON_MATCHING_USERS=True,
2847	                LDAP_APPEND_DOMAIN='zulip.com',
2848	                AUTH_LDAP_BIND_PASSWORD='wrongpass'):
2849	            with self.assertRaises(ldap.INVALID_CREDENTIALS):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:257:8
256	        profile = get_user(email, realm)
257	        assert(profile.default_sending_stream is not None)
258	        self.assertEqual(profile.default_sending_stream.name, 'Denmark')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:270:8
269	        profile = get_user(email, realm)
270	        assert(profile.default_sending_stream is not None)
271	        self.assertEqual(profile.default_sending_stream.name, 'Rome')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:385:8
384	        profile = get_user(email, realm)
385	        assert(profile.default_sending_stream is not None)
386	        self.assertEqual(profile.default_sending_stream.name, 'Denmark')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:436:8
435	        profile = get_user(bot_email, bot_realm)
436	        assert(profile.default_events_register_stream is not None)
437	        self.assertEqual(profile.default_events_register_stream.name, 'Denmark')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:455:8
454	        bot_profile = get_user(bot_email, bot_realm)
455	        assert(bot_profile.default_events_register_stream is not None)
456	        self.assertEqual(bot_profile.default_events_register_stream.name, 'Denmark')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_bugdown.py:189:19
188	        def make_user(email: str, full_name: str) -> UserProfile:
189	            return create_user(
190	                email=email,
191	                password='whatever',
192	                realm=realm,
193	                full_name=full_name,
194	                short_name='whatever',
195	            )
196	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bugdown.py:242:8
241	        user = mention_data.get_user_by_name('king hamLET')
242	        assert(user is not None)
243	        self.assertEqual(user['email'], hamlet.email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_bugdown.py:1418:19
1417	        def make_user(email: str, full_name: str) -> UserProfile:
1418	            return create_user(
1419	                email=email,
1420	                password='whatever',
1421	                realm=realm,
1422	                full_name=full_name,
1423	                short_name='whatever',
1424	            )
1425	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_compatibility.py:43:16
42	            else:
43	                assert False  # nocoverage
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_compatibility.py:93:16
92	            else:
93	                assert False  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_custom_profile_data.py:644:8
643	        test_bot = self.create_test_bot("foo-bot", iago)
644	        assert(test_bot)
645	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1062:24
1061	        email = user_profile.email
1062	        test_password = "abcd1234"
1063	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1189:24
1188	        email = user_profile.email
1189	        test_password = "abcd1234"
1190	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1375:17
1374	    def test_valid_internal_requests(self) -> None:
1375	        secret = 'random'
1376	        req = self.Request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1399:17
1398	    def test_internal_requests_with_broken_secret(self) -> None:
1399	        secret = 'random'
1400	        req = self.Request(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'broken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1405:13
1404	
1405	        with self.settings(SHARED_SECRET='broken'):
1406	            self.assertFalse(authenticate_notify(req))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1410:17
1409	    def test_external_requests(self) -> None:
1410	        secret = 'random'
1411	        req = self.Request(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1504:8
1503	        user_realm = get_realm('zulip')
1504	        self._login(user_email, user_realm, password="test")  # we set a password because user is a bot
1505	        self.assert_json_error_contains(self._do_test(user_email), "Webhook bots can only access webhooks")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1510:8
1509	        user_realm = get_realm('zulip')
1510	        self._login(user_email, user_realm, password="test")
1511	        # Get user_profile after _login so that we have the latest data.

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_docs.py:4:0
3	import os
4	import subprocess
5	import ujson

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_docs.py:343:12
342	                                         '../../tools/update-authors-json')  # nocoverage
343	            subprocess.check_call([update_script, '--use-fixture'])  # nocoverage
344	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_email_mirror.py:3:0
2	
3	import subprocess
4	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:879:8
878	        os.close(write_pipe)
879	        subprocess.check_call(
880	            [script, '-r', stream_to_address, '-s', settings.SHARED_SECRET, '-t'],
881	            stdin=read_pipe)
882	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:897:12
896	        try:
897	            subprocess.check_output([script, '-s', settings.SHARED_SECRET, '-t'],
898	                                    stdin=read_pipe)
899	        except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:25:8
24	    def test_pm_to_embedded_bot(self) -> None:
25	        assert self.bot_profile is not None
26	        self.send_personal_message(self.user_profile.email, self.bot_profile.email,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:39:8
38	    def test_stream_message_to_embedded_bot(self) -> None:
39	        assert self.bot_profile is not None
40	        self.send_stream_message(self.user_profile.email, "Denmark",

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:57:8
56	    def test_message_to_embedded_bot_with_initialize(self) -> None:
57	        assert self.bot_profile is not None
58	        with patch('zulip_bots.bots.helloworld.helloworld.HelloWorldHandler.initialize',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:66:8
65	    def test_embedded_bot_quit_exception(self) -> None:
66	        assert self.bot_profile is not None
67	        with patch('zulip_bots.bots.helloworld.helloworld.HelloWorldHandler.handle_message',

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:3061:8
3060	        # our tests rely on order
3061	        assert(sender_email < user_profile.email)
3062	        assert(user_profile.email < othello.email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:3062:8
3061	        assert(sender_email < user_profile.email)
3062	        assert(user_profile.email < othello.email)
3063	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:3330:16
3329	            def accepts_event(self, event: Dict[str, Any]) -> bool:
3330	                assert(event['type'] == 'message')
3331	                return True

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\tests\test_home.py:2:0
1	import datetime
2	import lxml.html
3	import ujson

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:463:15
462	    def create_bot(self, owner: UserProfile, bot_email: str, bot_name: str) -> UserProfile:
463	        user = do_create_user(
464	            email=bot_email,
465	            password='123',
466	            realm=owner.realm,
467	            full_name=bot_name,
468	            short_name=bot_name,
469	            bot_type=UserProfile.DEFAULT_BOT,
470	            bot_owner=owner
471	        )
472	        return user

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:475:15
474	    def create_non_active_user(self, realm: Realm, email: str, name: str) -> UserProfile:
475	        user = do_create_user(
476	            email=email,
477	            password='123',
478	            realm=realm,
479	            full_name=name,
480	            short_name=name,
481	        )
482	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:118:12
117	            # at first
118	            assert len(list(query)) > 0
119	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_import_export.py:684:22
683	        # data to test import of botstoragedata and botconfigdata
684	        bot_profile = do_create_user(
685	            email="bot-1@zulip.com",
686	            password="test",
687	            realm=original_realm,
688	            full_name="bot",
689	            short_name="bot",
690	            bot_type=UserProfile.EMBEDDED_BOT,
691	            bot_owner=sample_user)
692	        storage = StateHandler(bot_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:716:12
715	            # the test is kind of meaningless
716	            assert(orig_realm_result)
717	            if equal:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:60:8
59	        self.assertIn('title', data)
60	        assert data is not None  # allow mypy to infer data is indexable
61	        self.assertEqual(data['title'], response_data['title'])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:84:8
83	        self.assertIn('title', data)
84	        assert data is not None  # allow mypy to infer data is indexable
85	        self.assertEqual(data['title'], response_data['title'])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:108:8
107	        self.assertIn('title', data)
108	        assert data is not None  # allow mypy to infer data is indexable
109	        self.assertEqual(data['title'], response_data['title'])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:204:16
203	            for handler in logger.handlers:
204	                assert not isinstance(handler, AdminEmailHandler)
205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:921:8
920	        delay = time.time() - t
921	        assert(delay)  # quiet down lint
922	        # print(delay)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:992:8
991	        message = most_recent_message(user_profile)
992	        assert(UserMessage.objects.get(user_profile=user_profile, message=message).flags.mentioned.is_set)
993	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_messages.py:1068:21
1067	
1068	        normal_bot = do_create_user(
1069	            email='normal-bot@zulip.com',
1070	            password='',
1071	            realm=realm,
1072	            full_name='Normal Bot',
1073	            short_name='',
1074	            bot_type=UserProfile.DEFAULT_BOT,
1075	            bot_owner=cordelia,
1076	        )
1077	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_messages.py:1535:28
1534	        # Bots without owner (except cross realm bot) fail to send to announcement only stream
1535	        bot_without_owner = do_create_user(
1536	            email='free-bot@zulip.testserver',
1537	            password='',
1538	            realm=user_profile.realm,
1539	            full_name='freebot',
1540	            short_name='freebot',
1541	            bot_type=UserProfile.DEFAULT_BOT,
1542	        )
1543	        result = self.api_post(bot_without_owner.email,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_messages.py:1937:19
1936	        user = self.example_user("default_bot")
1937	        password = "test_password"
1938	        user.set_password(password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:3121:8
3120	
3121	        assert(mirror_sender is not None)
3122	        self.assertEqual(mirror_sender.email, sender_email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_messages.py:3674:14
3673	        parent = self.example_user('othello')
3674	        bot = do_create_user(
3675	            email='othello-bot@zulip.com',
3676	            password='',
3677	            realm=parent.realm,
3678	            full_name='',
3679	            short_name='',
3680	            bot_type=UserProfile.DEFAULT_BOT,
3681	            bot_owner=parent
3682	        )
3683	        bot.last_reminder = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_messages.py:3712:8
3711	        # stream doesn't exist
3712	        assert(sender.last_reminder is not None)
3713	        sender.last_reminder = sender.last_reminder - datetime.timedelta(hours=1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1059:12
1058	        for message in result["messages"]:
1059	            assert(message["id"] in message_ids)
1060	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1071:12
1070	        for message in result["messages"]:
1071	            assert(message["id"] in message_ids)
1072	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1141:8
1140	                break
1141	        assert(message_to_assert is not None)
1142	        self.assertEqual(len(message_to_assert['reactions']), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1192:12
1191	        def dr_emails(dr: DisplayRecipientT) -> str:
1192	            assert isinstance(dr, list)
1193	            return ','.join(sorted(set([r['email'] for r in dr] + [me])))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1196:12
1195	        def dr_ids(dr: DisplayRecipientT) -> List[int]:
1196	            assert isinstance(dr, list)
1197	            return list(sorted(set([r['id'] for r in dr] + [self.example_user('hamlet').id])))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1406:8
1405	        stream_name = get_display_recipient(stream_messages[0].recipient)
1406	        assert isinstance(stream_name, str)
1407	        stream_id = get_stream(stream_name, stream_messages[0].get_realm()).id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_narrow.py:1980:16
1979	            for message in messages:
1980	                assert(message["id"] in message_ids)
1981	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:67:8
66	        }
67	        assert(expected_item in actual)
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:405:12
404	            # Tell mypy this is never None.
405	            assert function is not None
406	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:554:20
553	                    print(" -", accepted_arguments)
554	                    assert(url_pattern in self.buggy_documentation_endpoints)
555	                elif len(openapi_parameter_names - accepted_arguments) > 0:  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:560:20
559	                    print(" +", accepted_arguments)
560	                    assert(url_pattern in self.buggy_documentation_endpoints)
561	                else:

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:36:23
35	        service_class = get_service_interface_class('whatever')  # GenericOutgoingWebhookService
36	        self.handler = service_class(service_name='test-service',
37	                                     token='abcdef',
38	                                     user_profile=self.bot_user)
39	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:147:23
146	        service_class = get_service_interface_class(SLACK_INTERFACE)
147	        self.handler = service_class(token="abcdef",
148	                                     user_profile=None,
149	                                     service_name='test-service')
150	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:116:16
115	        user_id = 10
116	        token = "111222"
117	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:127:16
126	    def test_unregister_remote_push_user_params(self) -> None:
127	        token = "111222"
128	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:149:16
148	    def test_register_remote_push_user_paramas(self) -> None:
149	        token = "111222"
150	        user_id = 11

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue_worker.py:58:12
57	        def drain_queue(self, queue_name: str, json: bool) -> List[Event]:
58	            assert json
59	            events = [

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_realm_emoji.py:279:25
278	        realm_1 = do_create_realm('test_realm', 'test_realm')
279	        emoji_author_1 = do_create_user('abc@example.com',
280	                                        password='abc',
281	                                        realm=realm_1,
282	                                        full_name='abc',
283	                                        short_name='abc')
284	        self.create_test_emoji('test_emoji', emoji_author_1)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tests\test_realm_export.py:52:22
51	        self.assertEqual(args['public_only'], True)
52	        self.assertIn('/tmp/zulip-export-', args['output_dir'])
53	        self.assertEqual(args['threads'], 6)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tests\test_realm_export.py:110:22
109	        self.assertEqual(args['public_only'], True)
110	        self.assertIn('/tmp/zulip-export-', args['output_dir'])
111	        self.assertEqual(args['threads'], 6)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:118:8
117	        )
118	        assert msg_id is not None
119	        return msg_id

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:33:23
32	    def _get_outgoing_bot(self) -> UserProfile:
33	        outgoing_bot = do_create_user(
34	            email="bar-bot@zulip.com",
35	            password="test",
36	            realm=get_realm("zulip"),
37	            full_name="BarBot",
38	            short_name='bb',
39	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
40	            bot_owner=self.example_user('cordelia'),
41	        )
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:47:8
46	        sender = self.example_user('hamlet')
47	        assert(not sender.is_bot)
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:71:8
70	        sender = self.example_user('hamlet')
71	        assert(not sender.is_bot)
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:94:8
93	        sender = self.example_user('hamlet')
94	        assert(not sender.is_bot)
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:128:8
127	        sender = self.example_user('hamlet')
128	        assert(not sender.is_bot)
129	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:175:27
174	        self.user_profile = self.example_user("othello")
175	        self.bot_profile = do_create_user(email="embedded-bot-1@zulip.com",
176	                                          password="test",
177	                                          realm=get_realm("zulip"),
178	                                          full_name="EmbeddedBo1",
179	                                          short_name="embedded-bot-1",
180	                                          bot_type=UserProfile.EMBEDDED_BOT,
181	                                          bot_owner=self.user_profile)
182	        self.second_bot_profile = do_create_user(email="embedded-bot-2@zulip.com",

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:182:34
181	                                          bot_owner=self.user_profile)
182	        self.second_bot_profile = do_create_user(email="embedded-bot-2@zulip.com",
183	                                                 password="test",
184	                                                 realm=get_realm("zulip"),
185	                                                 full_name="EmbeddedBot2",
186	                                                 short_name="embedded-bot-2",
187	                                                 bot_type=UserProfile.EMBEDDED_BOT,
188	                                                 bot_owner=self.user_profile)
189	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:413:27
412	        self.user_profile = self.example_user("othello")
413	        self.bot_profile = do_create_user(email="foo-bot@zulip.com",
414	                                          password="test",
415	                                          realm=get_realm("zulip"),
416	                                          full_name="FooBot",
417	                                          short_name="foo-bot",
418	                                          bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
419	                                          bot_owner=self.user_profile)
420	        self.second_bot_profile = do_create_user(email="bar-bot@zulip.com",

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:420:34
419	                                          bot_owner=self.user_profile)
420	        self.second_bot_profile = do_create_user(email="bar-bot@zulip.com",
421	                                                 password="test",
422	                                                 realm=get_realm("zulip"),
423	                                                 full_name="BarBot",
424	                                                 short_name="bar-bot",
425	                                                 bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
426	                                                 bot_owner=self.user_profile)
427	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:65:12
64	            "/json/settings",
65	            dict(
66	                full_name='Foo Bar',
67	                old_password=initial_password(self.example_email("hamlet")),
68	                new_password='foobar1',
69	            ))
70	        self.assert_json_success(json_result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:179:12
178	            "/json/settings",
179	            dict(
180	                old_password='bad_password',
181	                new_password="ignored",
182	            ))
183	        self.assert_json_error(result, "Wrong password!")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:198:16
197	                "/json/settings",
198	                dict(
199	                    old_password=initial_password(self.example_email("hamlet")),
200	                    new_password="ignored",
201	                ))
202	            self.assert_json_error(result, "Your Zulip password is managed in LDAP")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:206:16
205	                "/json/settings",
206	                dict(
207	                    old_password=self.ldap_password(),  # hamlet's password in ldap
208	                    new_password="ignored",
209	                ))
210	            self.assert_json_error(result, "Your Zulip password is managed in LDAP")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:216:16
215	                "/json/settings",
216	                dict(
217	                    old_password=initial_password(self.example_email("hamlet")),
218	                    new_password="ignored",
219	                ))
220	            self.assert_json_success(result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:226:16
225	                "/json/settings",
226	                dict(
227	                    old_password=initial_password(self.example_email("hamlet")),
228	                    new_password="ignored",
229	                ))
230	            self.assert_json_error(result, "Your Zulip password is managed in LDAP")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:240:35
239	        result = self.client_patch("/json/settings",
240	                                   dict(old_password='ignored',))
241	        self.assert_json_error(result, "Please fill out all fields.")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'new_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:255:8
254	        # log back in with new password
255	        self.login(email, password='new_password')
256	        user_profile = self.example_user('hamlet')

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:473:17
472	        email = self.example_email("hamlet")
473	        result = self.login_with_return(email, password="wrongpassword")
474	        self.assert_in_success_response([email], result)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hmb'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:581:19
580	        email = self.nonreg_email('test')
581	        password = u"hmb"
582	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1507:19
1506	    def check_user_able_to_register(self, email: str, invite_link: str) -> None:
1507	        password = "password"
1508	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\zerver\tests\test_signup.py:1731:4
1730	    @override_settings(OPEN_REALM_CREATION=True)
1731	    def check_able_to_create_realm(self, email: str, password: str="test") -> None:
1732	        string_id = "zuliptest"
1733	        # Make sure the realm does not exist
1734	        with self.assertRaises(Realm.DoesNotExist):
1735	            get_realm(string_id)
1736	
1737	        # Create new realm with the email
1738	        result = self.client_post('/new/', {'email': email})
1739	        self.assertEqual(result.status_code, 302)
1740	        self.assertTrue(result["Location"].endswith(
1741	            "/accounts/new/send_confirm/%s" % (email,)))
1742	        result = self.client_get(result["Location"])
1743	        self.assert_in_response("Check your email so we can get started.", result)
1744	
1745	        # Visit the confirmation link.
1746	        confirmation_url = self.get_confirmation_url_from_outbox(email)
1747	        result = self.client_get(confirmation_url)
1748	        self.assertEqual(result.status_code, 200)
1749	
1750	        result = self.submit_reg_form_for_user(email, password, realm_subdomain=string_id)
1751	        self.assertEqual(result.status_code, 302)
1752	        self.assertTrue(result["Location"].startswith('http://zuliptest.testserver/accounts/login/subdomain/'))
1753	
1754	        # Make sure the realm is created
1755	        realm = get_realm(string_id)
1756	        self.assertEqual(realm.string_id, string_id)
1757	        user = get_user(email, realm)
1758	        self.assertEqual(user.realm, realm)
1759	
1760	        # Check that user is the administrator.
1761	        self.assertEqual(user.role, UserProfile.ROLE_REALM_ADMINISTRATOR)
1762	
1763	        # Check defaults
1764	        self.assertEqual(realm.org_type, Realm.CORPORATE)
1765	        self.assertEqual(realm.emails_restricted_to_domains, False)
1766	        self.assertEqual(realm.invite_required, True)
1767	
1768	        # Check welcome messages
1769	        for stream_name, text, message_count in [
1770	                (Realm.DEFAULT_NOTIFICATION_STREAM_NAME, 'with the topic', 3),
1771	                (Realm.INITIAL_PRIVATE_STREAM_NAME, 'private stream', 1)]:
1772	            stream = get_stream(stream_name, realm)
1773	            recipient = get_stream_recipient(stream.id)
1774	            messages = Message.objects.filter(recipient=recipient).order_by('date_sent')
1775	            self.assertEqual(len(messages), message_count)
1776	            self.assertIn(text, messages[0].content)
1777	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1811:19
1810	    def test_create_realm_with_subdomain(self) -> None:
1811	        password = "test"
1812	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1855:19
1854	    def test_subdomain_restrictions(self) -> None:
1855	        password = "test"
1856	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1888:19
1887	    def test_subdomain_restrictions_root_domain(self) -> None:
1888	        password = "test"
1889	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1913:19
1912	    def test_subdomain_restrictions_root_domain_option(self) -> None:
1913	        password = "test"
1914	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2025:19
2024	        email = self.nonreg_email('newguy')
2025	        password = "newpassword"
2026	        timezone = "US/Mountain"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2058:19
2057	        email = self.nonreg_email('newguy')
2058	        password = "newpassword"
2059	        realm = get_realm('zulip')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2106:19
2105	        email = self.example_email('hamlet')
2106	        password = "newpassword"
2107	        realm = get_realm('lear')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2128:19
2127	        email = "newguy@zulip.com"
2128	        password = "newpassword"
2129	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2187:19
2186	        email = "newguy@zulip.com"
2187	        password = "newpassword"
2188	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2218:19
2217	        email = "newguy@zulip.com"
2218	        password = "newpassword"
2219	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2245:19
2244	        email = self.nonreg_email('newguy')
2245	        password = "newpassword"
2246	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2273:19
2272	        email = self.nonreg_email('newguy')
2273	        password = "newpassword"
2274	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2322:19
2321	        email = self.nonreg_email('newguy')
2322	        password = "newpassword"
2323	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2358:19
2357	        email = self.example_email('hamlet')
2358	        password = "newpassword"
2359	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2393:19
2392	        email = self.example_email('hamlet')
2393	        password = "newpassword"
2394	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2449:19
2448	        email = "newuser@zulip.com"
2449	        password = "newpassword"
2450	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:2648:13
2647	
2648	        with self.settings(
2649	                POPULATE_PROFILE_VIA_LDAP=True,
2650	                LDAP_APPEND_DOMAIN='zulip.com',
2651	                AUTH_LDAP_BIND_PASSWORD='',
2652	                AUTH_LDAP_USER_ATTR_MAP=ldap_user_attr_map,
2653	                AUTH_LDAP_USER_DN_TEMPLATE='uid=%(user)s,ou=users,dc=zulip,dc=com'):
2654	            result = self.client_get(confirmation_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2909:19
2908	    def test_signup_with_ldap_and_email_enabled_using_email_with_ldap_append_domain(self) -> None:
2909	        password = "nonldappassword"
2910	        email = "newuser@zulip.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2985:19
2984	        # have a wrong password, then we refuse to create an account
2985	        password = "nonldappassword"
2986	        email = "newuser_email@zulip.com"  # belongs to user uid=newuser_with_email in the test directory

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3027:19
3026	        # database.
3027	        password = "nonldappassword"
3028	        email = "nonexistent@zulip.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3217:19
3216	    def test_registration_of_mirror_dummy_user(self, ignored: Any) -> None:
3217	        password = "test"
3218	        subdomain = "zephyr"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:88:16
87	    def test_get_slack_api_data(self, mock_get: mock.Mock) -> None:
88	        token = 'valid-token'
89	        slack_user_list_url = "https://slack.com/api/users.list"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'invalid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:92:16
91	                         "user_data")
92	        token = 'invalid-token'
93	        with self.assertRaises(Exception) as invalid:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'status404'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:101:16
100	
101	        token = 'status404'
102	        wrong_url = "https://slack.com/api/wrong"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_slack_importer.py:192:12
191	        api_calls = [
192	            call("https://slack.com/api/users.info", "user", token="token", user="U061A3E0G"),
193	            call("https://slack.com/api/team.info", "team", token="token", team="T6LARQE2Z"),

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_slack_importer.py:193:12
192	            call("https://slack.com/api/users.info", "user", token="token", user="U061A3E0G"),
193	            call("https://slack.com/api/team.info", "team", token="token", team="T6LARQE2Z"),
194	            call("https://slack.com/api/users.info", "user", token="token", user="U061A8H1G"),

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_slack_importer.py:194:12
193	            call("https://slack.com/api/team.info", "team", token="token", team="T6LARQE2Z"),
194	            call("https://slack.com/api/users.info", "user", token="token", user="U061A8H1G"),
195	            call("https://slack.com/api/team.info", "team", token="token", team="T7KJRQE8Y")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_slack_importer.py:195:12
194	            call("https://slack.com/api/users.info", "user", token="token", user="U061A8H1G"),
195	            call("https://slack.com/api/team.info", "team", token="token", team="T7KJRQE8Y")
196	        ]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:719:16
718	        output_dir = os.path.join(settings.DEPLOY_ROOT, "var", "test-slack-importer-data")
719	        token = 'valid-token'
720	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1551:8
1550	
1551	        assert(found_sub is not None)
1552	        self.assertEqual(found_sub['color'], new_color)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_subs.py:2005:41
2004	        for stream in existing_stream_names:
2005	            random_stream = stream + str(random.randint(0, 9))
2006	            if random_stream not in all_stream_names:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:3177:8
3176	        test_bot = self.create_test_bot('foo', hamlet, bot_owner=hamlet)
3177	        assert test_bot is not None
3178	        realm = get_realm('zulip')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:3824:8
3823	        self.assertEqual(stream.id, stream_ret.id)
3824	        assert sub_ret is not None
3825	        self.assertEqual(sub_ret.recipient, rec_ret)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:3886:8
3885	        (stream_ret, rec_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
3886	        assert sub_ret is not None
3887	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:3900:8
3899	        (stream_ret, rec_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
3900	        assert sub_ret is not None
3901	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:403:12
402	            result = self.client_post("/json/user_uploads", {'f1': fp})
403	            assert sanitize_name(expected) in result.json()['uri']
404	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:426:8
425	        quota = realm.upload_quota_bytes()
426	        assert(quota is not None)
427	        d1_attachment.size = quota - 11

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\zerver\tests\test_upload.py:1561:36
1560	
1561	        self.assertEqual(b"zulip!", urllib.request.urlopen(redirect_url).read().strip())
1562	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:569:49
568	
569	        result = self.client_post("/json/users", dict(
570	            email='romeo@not-zulip.com',
571	            password='xxxx',
572	        ))
573	        self.assert_json_error(result, "Missing 'full_name' argument")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:575:49
574	
575	        result = self.client_post("/json/users", dict(
576	            email='romeo@not-zulip.com',
577	            password='xxxx',
578	            full_name='Romeo Montague',
579	        ))
580	        self.assert_json_error(result, "Missing 'short_name' argument")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:582:49
581	
582	        result = self.client_post("/json/users", dict(
583	            email='broken',
584	            password='xxxx',
585	            full_name='Romeo Montague',
586	            short_name='Romeo',
587	        ))
588	        self.assert_json_error(result, "Bad name or username")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:590:49
589	
590	        result = self.client_post("/json/users", dict(
591	            email='romeo@not-zulip.com',
592	            password='xxxx',
593	            full_name='Romeo Montague',
594	            short_name='Romeo',
595	        ))
596	        self.assert_json_error(result,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:600:23
599	        RealmDomain.objects.create(realm=get_realm('zulip'), domain='zulip.net')
600	        valid_params = dict(
601	            email='romeo@zulip.net',
602	            password='xxxx',
603	            full_name='Romeo Montague',
604	            short_name='Romeo',
605	        )
606	        result = self.client_post("/json/users", valid_params)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:768:8
767	        iago = get_source_profile("iago@zulip.com", "zulip")
768	        assert iago is not None
769	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:773:8
772	        iago = get_source_profile("IAGO@ZULIP.com", "zulip")
773	        assert iago is not None
774	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:777:8
776	        cordelia = get_source_profile("cordelia@zulip.com", "lear")
777	        assert cordelia is not None
778	        self.assertEqual(cordelia.email, "cordelia@zulip.com")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1137:22
1136	        # Add a service bot.
1137	        service_bot = do_create_user(
1138	            email='service-bot@zulip.com',
1139	            password='',
1140	            realm=realm,
1141	            full_name='',
1142	            short_name='',
1143	            bot_type=UserProfile.EMBEDDED_BOT,
1144	        )
1145	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1157:21
1156	        # Add a normal bot.
1157	        normal_bot = do_create_user(
1158	            email='normal-bot@zulip.com',
1159	            password='',
1160	            realm=realm,
1161	            full_name='',
1162	            short_name='',
1163	            bot_type=UserProfile.DEFAULT_BOT,
1164	        )
1165	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tornado\autoreload.py:60:0
59	import types
60	import subprocess
61	import weakref

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tornado\autoreload.py:220:8
219	    if not _has_execv:
220	        subprocess.Popen([sys.executable] + sys.argv)
221	        sys.exit(0)

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\zerver\tornado\autoreload.py:224:12
223	        try:
224	            os.execv(sys.executable, [sys.executable] + sys.argv)
225	        except OSError:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\zerver\tornado\autoreload.py:237:12
236	            # this error specifically.
237	            os.spawnv(os.P_NOWAIT, sys.executable,
238	                      [sys.executable] + sys.argv)
239	            # At this point the IOLoop has been closed and finally

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tornado\event_queue.py:198:45
197	        ioloop = tornado.ioloop.IOLoop.instance()
198	        interval = HEARTBEAT_MIN_FREQ_SECS + random.randint(0, 10)
199	        if self.client_type_name != 'API: heartbeat test':

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:348:4
347	def clear_client_event_queues_for_testing() -> None:
348	    assert(settings.TEST_SUITE)
349	    clients.clear()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:665:8
664	            continue
665	        assert 'flags' in event
666	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\socket.py:65:4
64	def deregister_connection(conn: 'SocketConnection') -> None:
65	    assert conn.client_id is not None
66	    del connections[conn.client_id]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\tornado\websocket_client.py:81:19
80	        url = urljoin(self.parsed_host_url.geturl(), '/json/events?dont_block=true')
81	        response = requests.get(url, headers={'Cookie': cookies_header}, verify=self.validate_ssl)
82	        return response.json()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'zerver.views.auth.log_into_subdomain'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\auth.py:422:24
421	
422	_subdomain_token_salt = 'zerver.views.auth.log_into_subdomain'
423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:648:8
647	    except ZulipLDAPConfigurationError as e:
648	        assert len(e.args) > 1
649	        return redirect_to_misconfigured_ldap_notice(e.args[1])

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\development\email_log.py:21:0
20	import os
21	import subprocess
22	import ujson

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\development\email_log.py:53:8
52	        # because by role, the tests shouldn't be doing a provision-like thing.
53	        subprocess.check_call(["./scripts/setup/inline-email-css"])
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:74:4
73	    result = client.post('/accounts/password/reset/', {'email': registered_email}, **host_kwargs)
74	    assert result.status_code == 302
75	    # deactivated user

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:79:4
78	    result = client.post('/accounts/password/reset/', {'email': registered_email}, **host_kwargs)
79	    assert result.status_code == 302
80	    user.is_active = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:85:4
84	                         HTTP_HOST=other_realm.host)
85	    assert result.status_code == 302
86	    # no account anywhere

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:88:4
87	    result = client.post('/accounts/password/reset/', {'email': unregistered_email_1}, **host_kwargs)
88	    assert result.status_code == 302
89	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:92:4
91	    result = client.post('/accounts/home/', {'email': unregistered_email_1}, **host_kwargs)
92	    assert result.status_code == 302
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:96:4
95	    result = client.post('/accounts/find/', {'emails': registered_email}, **host_kwargs)
96	    assert result.status_code == 302
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:100:4
99	    logged_in = client.login(dev_auth_username=registered_email, realm=realm)
100	    assert logged_in
101	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:108:4
107	                         **host_kwargs)
108	    assert result.status_code == 200
109	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:114:4
113	                          **host_kwargs)
114	    assert result.status_code == 200
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:121:4
120	    result = client.get(url)
121	    assert result.status_code == 200
122	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:39:4
38	    # Need to add test data to POST request as it doesnt originally contain the required parameters
39	    modify_postdata(request, key=key, full_name=name, password='test', terms='true')
40	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:55:4
54	    # Need to add test data to POST request as it doesnt originally contain the required parameters
55	    modify_postdata(request, key=key, realm_name=realm_name, full_name=name, password='test',
56	                    realm_subdomain=realm_name, terms='true')
57	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\documentation.py:116:70
115	            self.request.placeholder_open_graph_description = (
116	                "REPLACMENT_OPEN_GRAPH_DESCRIPTION_%s" % (int(2**24 * random.random()),))
117	            context["OPEN_GRAPH_DESCRIPTION"] = self.request.placeholder_open_graph_description

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:248:12
247	            # a Zephyr realm are private, so that doesn't happen.
248	            assert(not stream.is_public())
249	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:253:12
252	            # stream name, this will always match
253	            assert(m is not None)
254	            base_stream_name = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:285:12
284	            # Since the regex has a `.*` in it, this will always match
285	            assert(m is not None)
286	            base_topic = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:664:8
663	    else:
664	        assert(need_message)
665	        query = select([column("id").label("message_id")],

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:841:4
840	    # since its inference engine can't figure that out.
841	    assert anchor is not None
842	    anchored_to_left = (anchor == 0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:1394:8
1393	    if len(message_history) > 0:
1394	        assert message.last_edit_time is not None
1395	        assert(datetime_to_timestamp(message.last_edit_time) ==

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:1395:8
1394	        assert message.last_edit_time is not None
1395	        assert(datetime_to_timestamp(message.last_edit_time) ==
1396	               message_history[0]['timestamp'])
1397	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\messages.py:1411:12
1410	            prev_rendered_content = entry['prev_rendered_content']
1411	            assert prev_rendered_content is not None
1412	            entry['content_html_diff'] = highlight_html_differences(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\muting.py:26:8
25	    else:
26	        assert stream_id is not None
27	        (stream, recipient, sub) = access_stream_by_id(user_profile, stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\muting.py:44:8
43	    else:
44	        assert stream_id is not None
45	        stream = access_stream_for_unmute_topic_by_id(user_profile, stream_id, error)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:13:20
12	def validate_token(token_str: str, kind: int) -> None:
13	    if token_str == '' or len(token_str) > 4096:
14	        raise JsonableError(_('Empty or invalid length token'))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_icon.py:54:4
53	    # hacks to prevent us from having to jump through decode/encode hoops.
54	    assert '?' in url
55	    url += '&' + request.META['QUERY_STRING']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_logo.py:52:4
51	    # hacks to prevent us from having to jump through decode/encode hoops.
52	    assert '?' in url
53	    url += '&' + request.META['QUERY_STRING']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:213:8
212	            setup_realm_internal_bots(realm)
213	        assert(realm is not None)
214	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\report.py:21:0
20	
21	import subprocess
22	import logging

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\report.py:108:18
107	    try:
108	        version = subprocess.check_output(["git", "log", "HEAD^..HEAD", "--oneline"],
109	                                          universal_newlines=True)  # type: Optional[str]
110	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\report.py:108:18
107	    try:
108	        version = subprocess.check_output(["git", "log", "HEAD^..HEAD", "--oneline"],
109	                                          universal_newlines=True)  # type: Optional[str]
110	    except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:346:12
345	            # user is a guest, which happens in the decorator above.
346	            assert user_profile.realm.invite_to_stream_policy == \
347	                Realm.INVITE_TO_STREAM_POLICY_WAITING_PERIOD
348	            return json_error(_("Your account is too new to modify other users' subscriptions."))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:67:23
66	
67	    if new_password != "":
68	        return_data = {}  # type: Dict[str, Any]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:76:8
75	    if target.is_bot:
76	        assert target.bot_type is not None
77	        check_bot_creation_policy(user_profile, target.bot_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:153:4
152	    # hacks to prevent us from having to jump through decode/encode hoops.
153	    assert url is not None
154	    assert '?' in url

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:154:4
153	    assert url is not None
154	    assert '?' in url
155	    url += '&' + request.META['QUERY_STRING']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:214:8
213	        check_valid_interface_type(service_interface)
214	        assert service_interface is not None
215	        do_update_outgoing_webhook_service(bot, service_interface, service_payload_url)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\users.py:331:18
330	
331	    bot_profile = do_create_user(email=email, password='',
332	                                 realm=user_profile.realm, full_name=full_name,
333	                                 short_name=short_name,
334	                                 bot_type=bot_type,
335	                                 bot_owner=user_profile,
336	                                 avatar_source=avatar_source,
337	                                 default_sending_stream=default_sending_stream,
338	                                 default_events_register_stream=default_events_register_stream,
339	                                 default_all_public_streams=default_all_public_streams)
340	    if len(request.FILES) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:345:8
344	    if bot_type in (UserProfile.OUTGOING_WEBHOOK_BOT, UserProfile.EMBEDDED_BOT):
345	        assert(isinstance(service_name, str))
346	        add_service(name=service_name,

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\zephyr.py:13:0
12	import logging
13	import subprocess
14	import ujson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:40:8
39	            user = kerberos_alter_egos[user]
40	        assert(user == user_profile.email.split("@")[0])
41	        ccache = make_ccache(parsed_cred)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\zephyr.py:48:8
47	        api_key = get_api_key(user_profile)
48	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--",
49	                               "/home/zulip/python-zulip-api/zulip/integrations/zephyr/process_ccache",
50	                               user,
51	                               api_key,
52	                               base64.b64encode(ccache).decode("utf-8")])
53	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\zephyr.py:48:8
47	        api_key = get_api_key(user_profile)
48	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--",
49	                               "/home/zulip/python-zulip-api/zulip/integrations/zephyr/process_ccache",
50	                               user,
51	                               api_key,
52	                               base64.b64encode(ccache).decode("utf-8")])
53	    except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\appfollow\view.py:19:4
18	    app_name_search = re.search(r'\A(.+)', message)
19	    assert app_name_search is not None
20	    app_name = app_name_search.group(0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:103:4
102	def get_subject(payload: Dict[str, Any]) -> str:
103	    assert(payload['repository'] is not None)
104	    return BITBUCKET_TOPIC_TEMPLATE.format(repository_name=get_repository_name(payload['repository']))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:145:8
144	        event_key = validate_extract_webhook_http_header(request, "X_EVENT_KEY", "BitBucket")
145	        assert event_key is not None
146	        action = re.match('pullrequest:(?P<action>.*)$', event_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\groove\view.py:87:4
86	    event = validate_extract_webhook_http_header(request, 'X_GROOVE_EVENT', 'Groove')
87	    assert event is not None
88	    handler = get_event_handler(event)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\reviewboard\view.py:172:4
171	        request, 'X_REVIEWBOARD_EVENT', 'ReviewBoard')
172	    assert event_type is not None
173	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\stripe\view.py:53:8
52	    def update_string(blacklist: List[str]=[]) -> str:
53	        assert('previous_attributes' in payload['data'])
54	        previous_attributes = payload['data']['previous_attributes']

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\worker\queue_processors.py:102:4
101	            os.kill(os.getpid(), signal.SIGUSR1)
102	    except Exception:
103	        pass
104	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:648:20
647	                    )
648	                    assert message['content'] is not None
649	                bot_handler.handle_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:680:12
679	                                              delete_after_upload=True)
680	            assert public_url is not None
681	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\mark_all_messages_unread.py:14:8
13	    def handle(self, *args: Any, **options: Any) -> None:
14	        assert settings.DEVELOPMENT
15	        UserMessage.objects.all().update(flags=F('flags').bitand(~UserMessage.flags.read))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:420:56
419	        for i in range(options["num_huddles"]):
420	            get_huddle(random.sample(user_profiles_ids, random.randint(3, 4)))
421	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:444:77
443	                count += 1
444	            jobs.append((count, personals_pairs, options, self.stdout.write, random.randint(0, 10**10)))
445	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:606:18
605	
606	        randkey = random.randint(1, random_max)
607	        if (num_messages > 0 and

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:608:16
607	        if (num_messages > 0 and
608	                random.randint(1, random_max) * 100. / random_max < options["stickyness"]):
609	            # Use an old recipient

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:621:52
620	            message_type = Recipient.HUDDLE
621	            message.recipient = get_recipient_by_id(random.choice(recipient_huddles))
622	        elif (randkey <= random_max * (options["percent_huddles"] + options["percent_personals"]) / 100.):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:624:29
623	            message_type = Recipient.PERSONAL
624	            personals_pair = random.choice(personals_pairs)
625	            random.shuffle(personals_pair)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:628:52
627	            message_type = Recipient.STREAM
628	            message.recipient = get_recipient_by_id(random.choice(recipient_streams))
629	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:631:24
630	        if message_type == Recipient.HUDDLE:
631	            sender_id = random.choice(huddle_members[message.recipient.id])
632	            message.sender = get_user_profile_by_id(sender_id)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:641:29
640	            # Pick a random subscriber to the stream
641	            message.sender = random.choice(Subscription.objects.filter(
642	                recipient=message.recipient)).user_profile
643	            message.subject = stream.name + str(random.randint(1, 3))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:643:48
642	                recipient=message.recipient)).user_profile
643	            message.subject = stream.name + str(random.randint(1, 3))
644	            saved_data['subject'] = message.subject

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:698:21
697	
698	    offset_seconds = random.uniform(lower_bound, upper_bound)
699	    spoofed_date += timezone_timedelta(seconds=offset_seconds)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:252:8
251	        # Email search needs to be configured in this case.
252	        assert settings.AUTH_LDAP_USERNAME_ATTR and settings.AUTH_LDAP_REVERSE_EMAIL_SEARCH
253	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:952:4
951	    # being incorrectly authenticated.
952	    assert return_data.get('valid_attestation') is True
953	

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\zproject\jinja2\__init__.py:14:10
13	def environment(**options: Any) -> Environment:
14	    env = Environment(**options)
15	    env.globals.update({

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\settings.py:661:25
660	
661	ZULIP_WORKER_TEST_FILE = '/tmp/zulip-worker-test-file'
662	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\test_settings.py:62:16
61	# Don't use the real message log for tests
62	EVENT_LOG_DIR = '/tmp/zulip-test-event-log'
63	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_settings.py:147:16
146	S3_KEY = 'test-key'
147	S3_SECRET_KEY = 'test-secret-key'
148	S3_AUTH_UPLOADS_BUCKET = 'test-authed-bucket'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_settings.py:161:30
160	GOOGLE_OAUTH2_CLIENT_ID = "id"
161	GOOGLE_OAUTH2_CLIENT_SECRET = "secret"
162	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_settings.py:164:28
163	SOCIAL_AUTH_GITHUB_KEY = "key"
164	SOCIAL_AUTH_GITHUB_SECRET = "secret"
165	SOCIAL_AUTH_GOOGLE_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_settings.py:166:28
165	SOCIAL_AUTH_GOOGLE_KEY = "key"
166	SOCIAL_AUTH_GOOGLE_SECRET = "secret"
167	SOCIAL_AUTH_SUBDOMAIN = 'www'

--------------------------------------------------

Code scanned:
	Total lines of code: 124454
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 566
		Medium: 61
		High: 10
	Total issues (by confidence):
		Undefined: 0
		Low: 26
		Medium: 131
		High: 480
Files skipped (0):
