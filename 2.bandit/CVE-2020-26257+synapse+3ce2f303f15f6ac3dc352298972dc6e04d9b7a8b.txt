Working... ---------------------------------------- 100% 0:00:15
Run started:2024-02-10 21:38:16.484030

Test results:
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'postgres'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\.buildkite\scripts\create_postgres_db.py:29:14
28	    # doesn't exist yet.
29	    db_conn = db_engine.module.connect(
30	        user="postgres", host="postgres", password="postgres", dbname="postgres"
31	    )
32	    db_conn.autocommit = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'END'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\console.py:63:34
62	        self.path_prefix = "/_matrix/client/api/v1"
63	        self.event_stream_token = "END"
64	        self.prompt = ">>> "

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:585:12
584	                args["path"] = parsed_url.path
585	            except Exception:
586	                pass
587	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:774:12
773	                http_client.verbose = "on" == syn_cmd.config["verbose"]
774	            except Exception:
775	                pass
776	            print("Loaded config from %s" % config_path)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:777:4
776	            print("Loaded config from %s" % config_path)
777	    except Exception:
778	        pass
779	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '[REDACTED]'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\http.py:139:30
138	                temp = producer.data["password"]
139	                producer.data["password"] = "[REDACTED]"
140	                print(json.dumps(producer.data, indent=4))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:14:0
13	import json
14	import subprocess
15	import time

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:21:15
20	
21	ACCESS_TOKEN = ""
22	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:166:12
165	        print("sdp from matrix client", answer)
166	        p = subprocess.Popen(
167	            ["node", "unjingle/unjingle.js", "--sdp"],
168	            stdin=subprocess.PIPE,
169	            stdout=subprocess.PIPE,
170	        )
171	        jingle, out_err = p.communicate(answer)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:166:12
165	        print("sdp from matrix client", answer)
166	        p = subprocess.Popen(
167	            ["node", "unjingle/unjingle.js", "--sdp"],
168	            stdin=subprocess.PIPE,
169	            stdout=subprocess.PIPE,
170	        )
171	        jingle, out_err = p.communicate(answer)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:279:12
278	        self.callsid = jingle["sid"]
279	        p = subprocess.Popen(
280	            ["node", "unjingle/unjingle.js", "--jingle"],
281	            stdin=subprocess.PIPE,
282	            stdout=subprocess.PIPE,
283	        )
284	        print("raw jingle invite", str(jingle))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:279:12
278	        self.callsid = jingle["sid"]
279	        p = subprocess.Popen(
280	            ["node", "unjingle/unjingle.js", "--jingle"],
281	            stdin=subprocess.PIPE,
282	            stdout=subprocess.PIPE,
283	        )
284	        print("raw jingle invite", str(jingle))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib\scripts\kick_users.py:28:10
27	    print("Getting room state => %s" % room_state_url)
28	    res = requests.get(room_state_url)
29	    print("HTTP %s" % res.status_code)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib\scripts\kick_users.py:67:18
66	            print("Kicking %s" % uid)
67	            res = requests.put(kick_url, data=json.dumps(kick_body))
68	            if res.status_code != 200:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docker\start.py:6:0
5	import os
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:122:8
121	    if ownership is not None:
122	        subprocess.check_output(["chown", "-R", ownership, "/data"])
123	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:122:8
121	    if ownership is not None:
122	        subprocess.check_output(["chown", "-R", ownership, "/data"])
123	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:125:4
124	
125	    subprocess.check_output(args)
126	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:173:8
172	        # make sure that synapse has perms to write to the data dir.
173	        subprocess.check_output(["chown", ownership, data_dir])
174	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:173:8
172	        # make sure that synapse has perms to write to the data dir.
173	        subprocess.check_output(["chown", ownership, data_dir])
174	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:176:8
175	        args = ["gosu", ownership] + args
176	        os.execv("/usr/sbin/gosu", args)
177	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:178:8
177	    else:
178	        os.execv("/usr/local/bin/python", args)
179	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:251:8
250	        args = ["gosu", ownership] + args
251	        os.execv("/usr/sbin/gosu", args)
252	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:253:8
252	    else:
253	        os.execv("/usr/local/bin/python", args)
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\convert_server_keys.py:81:4
80	    database = config["database"]
81	    assert database["name"] == "psycopg2", "Can only convert for postgresql"
82	    args = database["args"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\federation_client.py:297:19
296	        try:
297	            resp = requests.get(uri)
298	            if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\scripts-dev\tail-synapse.py:36:8
35	        requests.get(
36	            server + "/_synapse/replication", verify=False, params=streams
37	        ).content
38	    )
39	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\tail-synapse.py:35:8
34	    return parse_response(
35	        requests.get(
36	            server + "/_synapse/replication", verify=False, params=streams
37	        ).content
38	    )

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\setup.py:80:4
79	    code = read_file(path_segments)
80	    exec(code, result)
81	    return result

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:43:8
42	    # Get the nonce
43	    r = requests.get(url, verify=False)
44	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:43:8
42	    # Get the nonce
43	    r = requests.get(url, verify=False)
44	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:50:12
49	                _print(r.json()["error"])
50	            except Exception:
51	                pass
52	        return exit(1)

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:81:8
80	    _print("Sending registration request...")
81	    r = requests.post(url, json=data, verify=False)
82	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:81:8
80	    _print("Sending registration request...")
81	    r = requests.post(url, json=data, verify=False)
82	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:88:12
87	                _print(r.json()["error"])
88	            except Exception:
89	                pass
90	        return exit(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth_blocking.py:72:12
71	        if self._limit_usage_by_mau is True:
72	            assert not (user_id and threepid)
73	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\constants.py:59:15
58	class LoginType:
59	    PASSWORD = "m.login.password"
60	    EMAIL_IDENTITY = "m.login.email.identity"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_MISSING_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:46:20
45	    NOT_FOUND = "M_NOT_FOUND"
46	    MISSING_TOKEN = "M_MISSING_TOKEN"
47	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_UNKNOWN_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:47:20
46	    MISSING_TOKEN = "M_MISSING_TOKEN"
47	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"
48	    GUEST_ACCESS_FORBIDDEN = "M_GUEST_ACCESS_FORBIDDEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_TOO_SHORT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:69:25
68	    EXPIRED_ACCOUNT = "ORG_MATRIX_EXPIRED_ACCOUNT"
69	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
70	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_DIGIT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:70:24
69	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
70	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
71	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_UPPERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:71:28
70	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
71	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
72	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_LOWERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:72:28
71	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
72	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
73	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_SYMBOL'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:73:25
72	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
73	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
74	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_IN_DICTIONARY'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:74:29
73	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
74	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
75	    WEAK_PASSWORD = "M_WEAK_PASSWORD"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_WEAK_PASSWORD'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:75:20
74	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
75	    WEAK_PASSWORD = "M_WEAK_PASSWORD"
76	    INVALID_SIGNATURE = "M_INVALID_SIGNATURE"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\app\__init__.py:46:18
45	    """
46	    if address == "0.0.0.0" and "::" in bind_addresses:
47	        logger.warning(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\admin_cmd.py:194:8
193	    if config.worker_app is not None:
194	        assert config.worker_app == "synapse.app.admin_cmd"
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:500:8
499	
500	        assert listener_config.http_options is not None
501	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\generic_worker.py:624:20
623	                    listener.port,
624	                    manhole(
625	                        username="matrix", password="rabbithole", globals={"hs": self}
626	                    ),
627	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:890:4
889	    # For backwards compatibility let any of the old app names.
890	    assert config.worker_app in (
891	        "synapse.app.appservice",
892	        "synapse.app.client_reader",
893	        "synapse.app.event_creator",
894	        "synapse.app.federation_reader",
895	        "synapse.app.federation_sender",
896	        "synapse.app.frontend_proxy",
897	        "synapse.app.generic_worker",
898	        "synapse.app.media_repository",
899	        "synapse.app.pusher",
900	        "synapse.app.synchrotron",
901	        "synapse.app.user_dir",
902	    )
903	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\homeserver.py:303:20
302	                    listener.port,
303	                    manhole(
304	                        username="matrix", password="rabbithole", globals={"hs": self}
305	                    ),
306	                )

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\synapse\app\homeserver.py:482:20
481	                profile.dump_stats(
482	                    "/tmp/%s.%s.%i.pstat" % (hs.hostname, func.__name__, ident)
483	                )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:316:18
315	        dict_copy = self.__dict__.copy()
316	        dict_copy["token"] = "<redacted>"
317	        dict_copy["hs_token"] = "<redacted>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:317:18
316	        dict_copy["token"] = "<redacted>"
317	        dict_copy["hs_token"] = "<redacted>"
318	        return "ApplicationService: %s" % (dict_copy,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:141:8
140	        # running.
141	        assert service.id not in self.requests_in_flight
142	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:235:8
234	        logger.info("Starting recoverer for AS ID %s", service.id)
235	        assert service.id not in self.recoverers
236	        recoverer = self.RECOVERER_CLASS(

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Ensure autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: Medium
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\config\_base.py:242:14
241	        loader = jinja2.FileSystemLoader(search_directories)
242	        env = jinja2.Environment(loader=loader, autoescape=autoescape)
243	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Password reset emails are enabled on this homeserver due to a partial
'email' block. However, the following required keys are missing:
    %s
'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\emailconfig.py:28:38
27	
28	MISSING_PASSWORD_RESET_CONFIG_ERROR = """\
29	Password reset emails are enabled on this homeserver due to a partial
30	'email' block. However, the following required keys are missing:
31	    %s
32	"""
33	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\federation.py:50:55
49	            # Always blacklist 0.0.0.0, ::
50	            self.federation_ip_range_blacklist.update(["0.0.0.0", "::"])
51	        except Exception as e:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#macaroon_secret_key: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:178:34
177	        else:
178	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
179	            form_secret = "#form_secret: <PRIVATE STRING>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#form_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:179:26
178	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
179	            form_secret = "#form_secret: <PRIVATE STRING>"
180	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\config\logger.py:247:12
246	                print("logging during logging: %s" % event_text, file=sys.__stderr__)
247	            except Exception:
248	                # gah.
249	                pass
250	            return

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<html><body>Invalid renewal token.</body><html>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\registration.py:81:16
80	            self.invalid_token_html_content = (
81	                "<html><body>Invalid renewal token.</body><html>"
82	            )
83	
84	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#registration_shared_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\registration.py:201:41
200	        else:
201	            registration_shared_secret = "#registration_shared_secret: <PRIVATE STRING>"
202	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\repository.py:194:56
193	            # unroutable addresses.
194	            self.url_preview_ip_range_blacklist.update(["0.0.0.0", "::"])
195	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:40:32
39	# in the list.
40	DEFAULT_BIND_ADDRESSES = ["::", "0.0.0.0"]
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\server.py:1121:8
1120	    try:
1121	        assert len(thresholds) == 3
1122	        return (int(thresholds[0]), int(thresholds[1]), int(thresholds[2]))

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:1149:34
1148	            # the metrics listener doesn't support IPv6
1149	            bind_addresses.append("0.0.0.0")
1150	        else:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\tls.py:64:76
63	        self.acme_port = acme_config.get("port", 80)
64	        self.acme_bind_addresses = acme_config.get("bind_addresses", ["::", "0.0.0.0"])
65	        self.acme_reprovision_threshold = acme_config.get("reprovision_threshold", 30)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:383:12
382	            # any completed requests should already have been removed
383	            assert not verify_request.key_ready.called
384	            keys_for_server = missing_keys[verify_request.server_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\event_auth.py:58:4
57	    """
58	    assert isinstance(auth_events, dict)
59	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:221:8
220	    ):
221	        assert room_version.event_format == self.format_version
222	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:397:8
396	
397	        assert "event_id" not in event_dict
398	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\spamcheck.py:190:16
189	                behaviour = checker(email_threepid, username, request_info)
190	                assert isinstance(behaviour, RegistrationBehaviour)
191	                if behaviour != RegistrationBehaviour.ALLOW:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\send_queue.py:213:12
212	        if key:
213	            assert isinstance(key, tuple)
214	            self.keyed_edu[(destination, key)] = edu

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:305:8
304	
305	        assert pdu.internal_metadata.stream_ordering
306	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:161:12
160	        else:
161	            assert pdu.internal_metadata.stream_ordering
162	            self._catchup_last_skipped = pdu.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:365:24
364	                        )
365	                        assert last_successful_stream_ordering
366	                        await self._store.set_destination_last_successful_stream_ordering(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:553:8
552	
553	        assert len(edus) <= limit, "get_device_updates_by_remote returned too many EDUs"
554	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\groups\attestations.py:113:27
112	        validity_period = DEFAULT_ATTESTATION_LENGTH_MS
113	        validity_period *= random.uniform(*DEFAULT_ATTESTATION_JITTER)
114	        valid_until_ms = int(self.clock.time_msec() + validity_period)

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\synapse\handlers\cas_handler.py:18:0
17	from typing import Dict, Optional, Tuple
18	from xml.etree import ElementTree as ET
19	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\synapse\handlers\cas_handler.py:122:19
121	        try:
122	            root = ET.fromstring(cas_response_body)
123	            if not root.tag.endswith("serviceResponse"):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\events.py:84:26
83	                # thundering herds on restart.
84	                timeout = random.randint(int(timeout * 0.9), int(timeout * 1.1))
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:891:12
890	            ev = event_map[e_id]
891	            assert not ev.internal_metadata.is_outlier()
892	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:920:12
919	            # non-outliers
920	            assert not event.internal_metadata.is_outlier()
921	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\handlers\federation.py:1082:16
1081	                        joined_domains[dom] = d
1082	                except Exception:
1083	                    pass
1084	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1332:8
1331	        # room stuff after join currently doesn't work on workers.
1332	        assert self.config.worker.worker_app is None
1333	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1348:8
1347	        # at a time - so this is just paranoia.
1348	        assert room_id not in self.room_queues
1349	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1691:8
1690	        # FIXME: Do this in a nicer way
1691	        assert event.type == EventTypes.Member
1692	        assert event.user_id == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1692:8
1691	        assert event.type == EventTypes.Member
1692	        assert event.user_id == user_id
1693	        assert event.state_key == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1693:8
1692	        assert event.user_id == user_id
1693	        assert event.state_key == user_id
1694	        assert event.room_id == room_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1694:8
1693	        assert event.state_key == user_id
1694	        assert event.room_id == room_id
1695	        return origin, event, room_version

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:2908:12
2907	        else:
2908	            assert self.storage.persistence
2909	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:2955:8
2954	        # the event has been persisted so it should have a stream ordering.
2955	        assert event.internal_metadata.stream_ordering
2956	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\identity.py:476:8
475	
476	        assert self.hs.config.public_baseurl
477	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\initial_sync.py:298:12
297	            # to leave.
298	            assert member_event_id
299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:340:8
339	        """
340	        assert self._ephemeral_events_enabled
341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:632:8
631	        u = await self.store.get_user_by_id(user_id)
632	        assert u is not None
633	        if u["user_type"] in (UserTypes.SUPPORT, UserTypes.BOT):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:713:35
712	            # We randomly sleep a bit just to annoy the requester.
713	            await self.clock.sleep(random.randint(1, 10))
714	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:732:20
731	                    # we know it was persisted, so must have a stream ordering
732	                    assert event.internal_metadata.stream_ordering
733	                    return event, event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:739:12
738	
739	            assert self.hs.is_mine_id(event.sender), "User must be our own: %s" % (
740	                event.sender,
741	            )
742	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:758:8
757	        # we know it was persisted, so must have a stream ordering
758	        assert ev.internal_metadata.stream_ordering
759	        return ev, ev.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:790:12
789	        if prev_event_ids is not None:
790	            assert len(prev_event_ids) <= 10, (
791	                "Attempting to create an event with %i prev_events"
792	                % (len(prev_event_ids),)
793	            )
794	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:802:8
801	        # create event in auth events")
802	        assert (
803	            builder.type == EventTypes.Create or len(prev_event_ids) > 0
804	        ), "Attempting to create an event with no prev_events"
805	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:895:35
894	            # We randomly sleep a bit just to annoy the requester.
895	            await self.clock.sleep(random.randint(1, 10))
896	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:919:12
918	            # are invite rejections we have generated ourselves.
919	            assert event.type == EventTypes.Member
920	            assert event.content["membership"] == Membership.LEAVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:920:12
919	            assert event.type == EventTypes.Member
920	            assert event.content["membership"] == Membership.LEAVE
921	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1026:8
1025	        """
1026	        assert self.storage.persistence is not None
1027	        assert self._events_shard_config.should_handle(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1027:8
1026	        assert self.storage.persistence is not None
1027	        assert self._events_shard_config.should_handle(
1028	            self._instance_name, event.room_id
1029	        )
1030	

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\handlers\oidc_handler.py:1026:6
1025	
1026	env = Environment(finalize=jinja_finalize)
1027	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:374:20
373	                    # case "JOIN" would have been returned.
374	                    assert member_event_id
375	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:379:20
378	                    )
379	                    assert leave_token.topological is not None
380	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:98:0
97	
98	assert LAST_ACTIVE_GRANULARITY < IDLE_TIMER
99	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:826:12
825	        async def _process_presence():
826	            assert not self._event_processing
827	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1080:16
1079	            if changed is not None and len(changed) < 500:
1080	                assert isinstance(user_ids_changed, set)
1081	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\profile.py:337:35
336	            # We randomly sleep a bit just to annoy the requester.
337	            await self.clock.sleep(random.randint(1, 10))
338	            return

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\handlers\register.py:504:14
503	
504	        await self.register_with_store(
505	            user_id=user_id,
506	            password_hash="",
507	            appservice_id=service_id,
508	            create_profile_with_displayname=user.localpart,
509	        )
510	        return user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:652:12
651	        if is_guest:
652	            assert valid_until_ms is None
653	            access_token = self.macaroon_gen.generate_access_token(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:188:8
187	        user_id = requester.user.to_string()
188	        assert self.hs.is_mine_id(user_id), "User must be our own: %s" % (user_id,)
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:239:8
238	        # We know the tombstone event isn't an outlier so it has current state.
239	        assert old_room_state is not None
240	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room.py:657:35
656	            # We randomly sleep a bit just to annoy the requester.
657	            await self.clock.sleep(random.randint(1, 10))
658	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:230:8
229	        # we know it was persisted, so should have a stream ordering
230	        assert result_event.internal_metadata.stream_ordering
231	        return result_event.event_id, result_event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:304:35
303	            # We randomly sleep a bit just to annoy the requester.
304	            await self.clock.sleep(random.randint(1, 10))
305	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:447:20
446	                    # we know it was persisted, so must have a stream ordering.
447	                    assert old_state.internal_metadata.stream_ordering
448	                    return (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:669:12
668	            sender = UserID.from_string(event.sender)
669	            assert (
670	                sender == requester.user
671	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
672	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:672:12
671	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
672	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)
673	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:799:35
798	            # We randomly sleep a bit just to annoy the requester.
799	            await self.clock.sleep(random.randint(1, 10))
800	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:1165:8
1164	        # we know it was persisted, so must have a stream ordering
1165	        assert result_event.internal_metadata.stream_ordering
1166	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:113:16
112	
113	                assert batch_group is not None
114	                assert batch_group_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:114:16
113	                assert batch_group is not None
114	                assert batch_group_key is not None
115	                assert batch_token is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:115:16
114	                assert batch_group_key is not None
115	                assert batch_token is not None
116	            except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:848:16
847	                # is indeed the case.
848	                assert since_token is not None
849	                state_at_previous_sync = await self.get_state_at(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1325:8
1324	        )
1325	        assert presence_key
1326	        sync_result_builder.now_token = now_token.copy_and_replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1481:8
1480	
1481	        assert since_token
1482	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1507:8
1506	
1507	        assert since_token
1508	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\typing.py:205:8
204	
205	        assert hs.config.worker.writers.typing == hs.get_instance_name()
206	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:248:35
247	            # We randomly sleep a bit just to annoy the requester.
248	            await self.clock.sleep(random.randint(1, 10))
249	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:282:35
281	            # We randomly sleep a bit just to annoy the requester.
282	            await self.clock.sleep(random.randint(1, 10))
283	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\ui_auth\checkers.py:161:16
160	            if self.hs.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
161	                assert self.hs.config.account_threepid_delegate_email
162	                threepid = await identity_handler.threepid_from_creds(

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\http\client.py:212:8
211	                return defer.fail(Failure(e))
212	        except Exception:
213	            # Not an IP
214	            pass
215	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\srv_resolver.py:80:28
79	        while servers and total_weight:
80	            target_weight = random.randint(1, total_weight)
81	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:149:28
148	            # add some randomness to the TTL to avoid a stampeding herd
149	            cache_period *= random.uniform(
150	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
151	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
152	            )
153	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:203:28
202	            # after startup
203	            cache_period *= random.uniform(
204	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
205	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
206	            )
207	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:554:37
553	                            delay = min(delay, 60)
554	                            delay *= random.uniform(0.8, 1.4)
555	                        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:558:37
557	                            delay = min(delay, 2)
558	                            delay *= random.uniform(0.8, 1.4)
559	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\http\server.py:92:12
91	                request.transport.abortConnection()
92	            except Exception:
93	                # abortConnection throws if the connection is already closed
94	                pass
95	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\server.py:426:8
425	        # We expect to get bytes for us to write
426	        assert isinstance(response_object, bytes)
427	        html_bytes = response_object

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:198:12
197	        if not self._is_processing:
198	            assert self.logcontext is not None
199	            with PreserveLoggingContext(self.logcontext):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:264:8
263	        """
264	        assert self.logcontext is not None
265	        usage = self.logcontext.get_resource_usage()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:394:8
393	
394	        assert config.http_options is not None
395	        proxied = config.http_options.x_forwarded

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:455:12
454	            rusage = get_thread_resource_usage()
455	            assert rusage is not None
456	            utime_delta, stime_delta = self._get_cputime(rusage)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:470:8
469	        """
470	        assert self.usage_start is not None
471	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:130:8
129	        """
130	        assert not self._is_processing
131	        self._is_processing = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:136:8
135	        """
136	        assert self._is_processing
137	        self._is_processing = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:142:8
141	        # we should never get here if we are already processing
142	        assert not self._is_processing
143	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:161:8
160	        # we should never get here if we are already processing
161	        assert not self._is_processing
162	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:99:8
98	        # assert here that sub classes don't try and use the name.
99	        assert (
100	            "instance_name" not in self.PATH_ARGS
101	        ), "`instance_name` is a reserved parameter name"
102	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:102:8
101	        ), "`instance_name` is a reserved parameter name"
102	        assert (
103	            "instance_name"
104	            not in signature(self.__class__._serialize_payload).parameters
105	        ), "`instance_name` is a reserved parameter name"
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:107:8
106	
107	        assert self.METHOD in ("PUT", "POST", "GET")
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:261:8
260	
261	        assert self.CACHE
262	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\membership.py:184:8
183	        """
184	        assert change == "left"
185	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\slave\storage\push_rule.py:30:8
29	        # We assert this for the benefit of mypy
30	        assert isinstance(self._push_rules_stream_id_gen, SlavedIdTracker)
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:143:16
142	                    continue
143	                assert isinstance(row, EventsStreamRow)
144	                assert isinstance(row.data, EventsStreamEventRow)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:144:16
143	                assert isinstance(row, EventsStreamRow)
144	                assert isinstance(row.data, EventsStreamEventRow)
145	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\replication\tcp\client.py:182:16
181	                        deferred.callback(None)
182	                except Exception:
183	                    # The deferred has been cancelled or timed out.
184	                    pass
185	            else:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'batch'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\replication\tcp\commands.py:125:29
124	            instance_name,
125	            None if token == "batch" else int(token),
126	            json_decoder.decode(row_json),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:222:8
221	        """
222	        assert stream_name not in self._processing_streams
223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:391:8
390	
391	        assert self._server_notices_sender is not None
392	        await self._server_notices_sender.on_user_ip(cmd.user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\resource.py:90:8
89	        # If we have streams then we must have redis enabled or on master
90	        assert (
91	            not self.streams
92	            or hs.config.redis.redis_enabled
93	            or not hs.config.worker.worker_app
94	        )
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\streams\events.py:168:8
167	        # that we know it is safe to just take upper_limit = event_rows[-1][0].
168	        assert (
169	            len(event_rows) <= target_row_count
170	        ), "get_all_new_forward_event_rows did not honour row limit"
171	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\rest\client\v1\login.py:45:17
44	    SSO_TYPE = "m.login.sso"
45	    TOKEN_TYPE = "m.login.token"
46	    JWT_TYPE = "org.matrix.login.jwt"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:118:42
117	                # look like we did something.
118	                await self.hs.clock.sleep(random.randint(1, 10) / 10)
119	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\account.py:124:12
123	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
124	            assert self.hs.config.account_threepid_delegate_email
125	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:390:42
389	                # look like we did something.
390	                await self.hs.clock.sleep(random.randint(1, 10) / 10)
391	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\account.py:396:12
395	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
396	            assert self.hs.config.account_threepid_delegate_email
397	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:469:42
468	                # look like we did something.
469	                await self.hs.clock.sleep(random.randint(1, 10) / 10)
470	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\register.py:138:42
137	                # look like we did something.
138	                await self.hs.clock.sleep(random.randint(1, 10) / 10)
139	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\register.py:144:12
143	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
144	            assert self.hs.config.account_threepid_delegate_email
145	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\register.py:217:42
216	                # look like we did something.
217	                await self.hs.clock.sleep(random.randint(1, 10) / 10)
218	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:28:0
27	        )
28	except Exception:
29	    # any other exception is fine
30	    pass
31	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:43:0
42	        )
43	except Exception:
44	    # any other exception is fine
45	    pass

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\media_storage.py:137:12
136	                os.remove(fname)
137	            except Exception:
138	                pass
139	            raise

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:528:12
527	            # we can only get here if we did an oembed request and have an oembed_result.html
528	            assert oembed_result.html is not None
529	            assert oembed_url is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:529:12
528	            assert oembed_result.html is not None
529	            assert oembed_url is not None
530	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:588:8
587	
588	        assert self._worker_run_media_background_jobs
589	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:618:12
617	                    os.rmdir(dir)
618	            except Exception:
619	                pass
620	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:650:12
649	                    os.rmdir(dir)
650	            except Exception:
651	                pass
652	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:668:12
667	                    os.rmdir(dir)
668	            except Exception:
669	                pass
670	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:680:4
679	def decode_and_calc_og(body, media_uri, request_encoding=None):
680	    from lxml import etree
681	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\synapse\rest\media\v1\preview_url_resource.py:684:15
683	        parser = etree.HTMLParser(recover=True, encoding=request_encoding)
684	        tree = etree.fromstring(body, parser)
685	        og = _calc_og(tree, media_uri)

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\synapse\rest\media\v1\preview_url_resource.py:690:15
689	        parser = etree.HTMLParser(recover=True, encoding=request_encoding)
690	        tree = etree.fromstring(body.decode("utf-8", "ignore"), parser)
691	        og = _calc_og(tree, media_uri)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:780:12
779	
780	            from lxml import etree
781	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\synapse\client\password_reset.py:64:8
63	        # This resource should not be mounted if threepid behaviour is not LOCAL
64	        assert hs.config.threepid_behaviour_email == ThreepidBehaviour.LOCAL
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:110:8
109	
110	        assert self._is_mine_id(user_id), "Cannot send server notices to remote users"
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:173:8
172	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
173	        assert latest_event_ids is not None
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:208:8
207	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
208	        assert latest_event_ids is not None
209	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:228:8
227	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
228	        assert latest_event_ids is not None
229	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\synapse\state\v1.py:347:30
346	        # people to send us events with non-ascii event IDs :/
347	        return -int(e.depth), hashlib.sha1(e.event_id.encode("utf-8")).hexdigest()
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:232:8
231	        # is not the case.
232	        assert self.after_callbacks is not None
233	        self.after_callbacks.append((callback, args, kwargs))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:241:8
240	        # is not the case.
241	        assert self.exception_callbacks is not None
242	        self.exception_callbacks.append((callback, args, kwargs))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\database.py:290:12
289	                sql_logger.debug("[SQL values] {%s} %r", self.name, args[0])
290	            except Exception:
291	                # Don't let logging failures stop SQL from working
292	                pass
293	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:689:12
688	            # pool).
689	            assert not self.engine.in_transaction(conn)
690	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1004:18
1003	            # SELECT instead to see if it exists.
1004	            sql = "SELECT 1 FROM %s WHERE %s" % (
1005	                table,
1006	                " AND ".join(_getwhere(k) for k in keyvalues),
1007	            )
1008	            sqlargs = list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1015:18
1014	            # First try to update.
1015	            sql = "UPDATE %s SET %s WHERE %s" % (
1016	                table,
1017	                ", ".join("%s = ?" % (k,) for k in values),
1018	                " AND ".join(_getwhere(k) for k in keyvalues),
1019	            )
1020	            sqlargs = list(values.values()) + list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1033:14
1032	
1033	        sql = "INSERT INTO %s (%s) VALUES (%s)" % (
1034	            table,
1035	            ", ".join(k for k in allvalues),
1036	            ", ".join("?" for _ in allvalues),
1037	        )
1038	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1067:21
1066	            allvalues.update(values)
1067	            latter = "UPDATE SET " + ", ".join(k + "=EXCLUDED." + k for k in values)
1068	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1069:15
1068	
1069	        sql = ("INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s") % (
1070	            table,
1071	            ", ".join(k for k in allvalues),
1072	            ", ".join("?" for _ in allvalues),
1073	            ", ".join(k for k in keyvalues),
1074	            latter,
1075	        )
1076	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1205:21
1204	        else:
1205	            latter = "UPDATE SET " + ", ".join(
1206	                k + "=EXCLUDED." + k for k in value_names
1207	            )
1208	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1209:14
1208	
1209	        sql = "INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s" % (
1210	            table,
1211	            ", ".join(k for k in allnames),
1212	            ", ".join("?" for _ in allnames),
1213	            ", ".join(key_names),
1214	            latter,
1215	        )
1216	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1375:15
1374	    ) -> List[Any]:
1375	        sql = ("SELECT %(retcol)s FROM %(table)s") % {"retcol": retcol, "table": table}
1376	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1463:18
1462	        if keyvalues:
1463	            sql = "SELECT %s FROM %s WHERE %s" % (
1464	                ", ".join(retcols),
1465	                table,
1466	                " AND ".join("%s = ?" % (k,) for k in keyvalues),
1467	            )
1468	            txn.execute(sql, list(keyvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1470:18
1469	        else:
1470	            sql = "SELECT %s FROM %s" % (", ".join(retcols), table)
1471	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1559:14
1558	
1559	        sql = "SELECT %s FROM %s WHERE %s" % (
1560	            ", ".join(retcols),
1561	            table,
1562	            " AND ".join(clauses),
1563	        )
1564	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1591:21
1590	
1591	        update_sql = "UPDATE %s SET %s %s" % (
1592	            table,
1593	            ", ".join("%s = ?" % (k,) for k in updatevalues),
1594	            where,
1595	        )
1596	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1653:21
1652	    ) -> Optional[Dict[str, Any]]:
1653	        select_sql = "SELECT %s FROM %s WHERE %s" % (
1654	            ", ".join(retcols),
1655	            table,
1656	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1657	        )
1658	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1697:14
1696	        """
1697	        sql = "DELETE FROM %s WHERE %s" % (
1698	            table,
1699	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1700	        )
1701	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1742:14
1741	        """
1742	        sql = "DELETE FROM %s WHERE %s" % (
1743	            table,
1744	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1745	        )
1746	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1807:14
1806	
1807	        sql = "DELETE FROM %s" % table
1808	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1835:12
1834	        sql = (
1835	            "SELECT %(entity)s, MAX(%(stream)s) FROM %(table)s"
1836	            " WHERE %(stream)s > ? - %(limit)s"
1837	            " GROUP BY %(entity)s"
1838	        ) % {
1839	            "table": table,
1840	            "entity": entity_column,
1841	            "stream": stream_column,
1842	            "limit": limit,
1843	        }
1844	
1845	        txn = db_conn.cursor(txn_name="get_cache_dict")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1912:14
1911	
1912	        sql = "SELECT %s FROM %s %s ORDER BY %s %s LIMIT ? OFFSET ?" % (
1913	            ", ".join(retcols),
1914	            table,
1915	            where_clause,
1916	            orderby,
1917	            order_direction,
1918	        )
1919	        txn.execute(sql, arg_list + [limit, start])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1977:18
1976	        if term:
1977	            sql = "SELECT %s FROM %s WHERE %s LIKE ?" % (", ".join(retcols), table, col)
1978	            termvalues = ["%%" + term + "%%"]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:404:16
403	                # We do NOT want to escape `stream_id_type`.
404	                "SELECT %s FROM application_services_state WHERE as_id=?"
405	                % stream_id_type,
406	                (service.id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:430:16
429	            txn.execute(
430	                "UPDATE application_services_state SET %s = ? WHERE as_id=?"
431	                % stream_id_type,
432	                (pos, service.id),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:175:16
174	            txn.execute(
175	                """
176	                SELECT user_id, access_token, ip,
177	                       MAX(device_id), MAX(user_agent), MAX(last_seen),
178	                       COUNT(*)
179	                FROM (
180	                    SELECT DISTINCT user_id, access_token, ip
181	                    FROM user_ips
182	                    WHERE {}
183	                ) c
184	                INNER JOIN user_ips USING (user_id, access_token, ip)
185	                GROUP BY user_id, access_token, ip
186	                HAVING count(*) > 1
187	                """.format(
188	                    clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:305:18
304	
305	            sql = """
306	                SELECT
307	                    last_seen, ip, user_agent, user_id, device_id
308	                FROM (
309	                    SELECT
310	                        user_id, device_id, MAX(u.last_seen) AS last_seen
311	                    FROM devices
312	                    INNER JOIN user_ips AS u USING (user_id, device_id)
313	                    WHERE %(where_clause)s
314	                    GROUP BY user_id, device_id
315	                    ORDER BY user_id ASC, device_id ASC
316	                    LIMIT ?
317	                ) c
318	                INNER JOIN user_ips AS u USING (user_id, device_id, last_seen)
319	            """ % {
320	                "where_clause": where_clause
321	            }
322	            txn.execute(sql, where_args + [batch_size])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:451:22
450	                )
451	                sql = "SELECT device_id FROM devices WHERE user_id = ? AND " + clause
452	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\devices.py:956:18
955	            )
956	            sql = """
957	                SELECT stream_id, destination, user_id, device_id, MAX(ts) AS ts
958	                FROM device_lists_outbound_pokes
959	                WHERE %s
960	                GROUP BY %s
961	                HAVING count(*) > 1
962	                ORDER BY %s
963	                LIMIT ?
964	                """ % (
965	                clause,  # WHERE
966	                ",".join(KEY_COLS),  # GROUP BY
967	                ",".join(KEY_COLS),  # ORDER BY
968	            )
969	            txn.execute(sql, args + [batch_size])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\directory.py:181:18
180	
181	            sql = "UPDATE room_aliases SET room_id = ? %s WHERE room_id = ?" % (
182	                update_creator_sql,
183	            )
184	            txn.execute(sql, sql_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\e2e_room_keys.py:202:14
201	
202	        sql = """
203	        SELECT room_id, session_id, first_message_index, forwarded_count,
204	               is_verified, session_data
205	        FROM e2e_room_keys
206	        WHERE user_id = ? AND version = ? AND (%s)
207	        """ % (
208	            " OR ".join(where_clauses)
209	        )
210	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:228:12
227	        sql = (
228	            "SELECT user_id, device_id, "
229	            "    d.display_name, "
230	            "    k.key_json"
231	            " FROM devices d"
232	            "    %s JOIN e2e_device_keys_json k USING (user_id, device_id)"
233	            " WHERE %s AND NOT d.hidden"
234	        ) % (
235	            "LEFT" if include_all_devices else "INNER",
236	            " OR ".join("(" + q + ")" for q in query_clauses),
237	        )
238	
239	        txn.execute(sql, query_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:274:24
273	
274	        signature_sql = """
275	            SELECT user_id, key_id, target_device_id, signature
276	            FROM e2e_cross_signing_signatures WHERE %s
277	            """ % (
278	            " OR ".join("(" + q + ")" for q in signature_query_clauses)
279	        )
280	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:519:16
518	            sql = (
519	                """
520	                SELECT k.user_id, k.keytype, k.keydata, k.stream_id
521	                  FROM e2e_cross_signing_keys k
522	                  INNER JOIN (SELECT user_id, keytype, MAX(stream_id) AS stream_id
523	                                FROM e2e_cross_signing_keys
524	                               GROUP BY user_id, keytype) s
525	                 USING (user_id, stream_id, keytype)
526	                 WHERE
527	            """
528	                + clause
529	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:575:18
574	        for batch in batch_iter(devices.keys(), size=100):
575	            sql = """
576	                SELECT target_user_id, target_device_id, key_id, signature
577	                  FROM e2e_cross_signing_signatures
578	                 WHERE user_id = ?
579	                   AND (%s)
580	            """ % (
581	                " OR ".join(
582	                    "(target_user_id = ? AND target_device_id = ?)" for _ in batch
583	                )
584	            )
585	            query_params = [from_user_id]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_federation.py:419:18
418	
419	            sql = """
420	                SELECT room_id FROM event_forward_extremities
421	                WHERE %s
422	                GROUP BY room_id
423	                HAVING count(*) > ?
424	                ORDER BY count(*) DESC
425	                LIMIT ?
426	            """ % (
427	                where_clause,
428	            )
429	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_push_actions.py:879:16
878	            sql = (
879	                "SELECT epa.event_id, epa.room_id,"
880	                " epa.stream_ordering, epa.topological_ordering,"
881	                " epa.actions, epa.highlight, epa.profile_tag, e.received_ts"
882	                " FROM event_push_actions epa, events e"
883	                " WHERE epa.event_id = e.event_id"
884	                " AND epa.user_id = ? %s"
885	                " AND epa.notif = 1"
886	                " ORDER BY epa.stream_ordering DESC"
887	                " LIMIT ?" % (before_clause,)
888	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:103:8
102	        # This should only exist on instances that are configured to write
103	        assert (
104	            hs.get_instance_name() in hs.config.worker.writers.events
105	        ), "Can only instantiate EventsStore on master"
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:335:8
334	        # stream orderings should have been assigned by now
335	        assert min_stream_order
336	        assert max_stream_order

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:336:8
335	        assert min_stream_order
336	        assert max_stream_order
337	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events.py:740:12
739	        txn.execute(
740	            "SELECT event_id, outlier FROM events WHERE event_id in (%s)"
741	            % (",".join(["?"] * len(events_and_contexts)),),
742	            [event.event_id for event, _ in events_and_contexts],

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:354:16
353	            if not allow_rejected:
354	                assert not entry.event.rejected_reason, (
355	                    "rejected event returned from _get_events_from_cache_or_db despite "
356	                    "allow_rejected=False"
357	                )
358	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:558:8
557	        # non-None.
558	        assert current_state_ids is not None
559	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:693:12
692	                continue
693	            assert row["event_id"] == event_id
694	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:1313:8
1312	        # of the last row in the result.
1313	        assert rows[-1][0] <= to_token
1314	        to_token = rows[-1][0] - 1

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:64:16
63	            sql = (
64	                "SELECT server_name, key_id, verify_key, ts_valid_until_ms "
65	                "FROM server_signature_keys WHERE 1=0"
66	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
67	
68	            txn.execute(sql, tuple(itertools.chain.from_iterable(batch)))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:66:16
65	                "FROM server_signature_keys WHERE 1=0"
66	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
67	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\media_repository.py:186:23
185	        if keep_profiles:
186	            sql_keep = """
187	                AND (
188	                    NOT EXISTS
189	                        (SELECT 1
190	                         FROM profiles
191	                         WHERE profiles.avatar_url = '{media_prefix}' || lmr.media_id)
192	                    AND NOT EXISTS
193	                        (SELECT 1
194	                         FROM groups
195	                         WHERE groups.avatar_url = '{media_prefix}' || lmr.media_id)
196	                    AND NOT EXISTS
197	                        (SELECT 1
198	                         FROM room_memberships
199	                         WHERE room_memberships.avatar_url = '{media_prefix}' || lmr.media_id)
200	                    AND NOT EXISTS
201	                        (SELECT 1
202	                         FROM user_directory
203	                         WHERE user_directory.avatar_url = '{media_prefix}' || lmr.media_id)
204	                    AND NOT EXISTS
205	                        (SELECT 1
206	                         FROM room_stats_state
207	                         WHERE room_stats_state.avatar = '{media_prefix}' || lmr.media_id)
208	                )
209	            """.format(
210	                media_prefix="mxc://%s/" % (self.server_name,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:150:16
149	            txn.execute(
150	                "DELETE FROM monthly_active_users WHERE timestamp < ? AND NOT %s"
151	                % (in_clause,),
152	                [thirty_days_ago] + in_clause_args,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:173:22
172	                # SELECT, meaning that a legitimate mau is deleted.
173	                sql = """
174	                    DELETE FROM monthly_active_users
175	                    WHERE user_id NOT IN (
176	                        SELECT user_id FROM monthly_active_users
177	                        WHERE NOT %s
178	                        ORDER BY timestamp DESC
179	                        LIMIT ?
180	                    )
181	                    AND NOT %s
182	                """ % (
183	                    in_clause,
184	                    in_clause,
185	                )
186	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:126:12
125	        txn.execute(
126	            "INSERT INTO events_to_purge"
127	            " SELECT event_id, %s"
128	            " FROM events AS e LEFT JOIN state_events USING (event_id)"
129	            " WHERE (NOT outlier OR (%s)) AND e.room_id = ? AND topological_ordering < ?"
130	            % (should_delete_expr, should_delete_expr),
131	            should_delete_params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:220:16
219	            txn.execute(
220	                "DELETE FROM %s WHERE event_id IN ("
221	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
222	                ")" % (table,)
223	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:231:16
230	            txn.execute(
231	                "DELETE FROM %s WHERE room_id = ? AND event_id IN ("
232	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
233	                ")" % (table,),
234	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:328:16
327	            txn.execute(
328	                """
329	                DELETE FROM %s WHERE event_id IN (
330	                  SELECT event_id FROM events WHERE room_id=?
331	                )
332	                """
333	                % (table,),
334	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:373:24
372	            logger.info("[purge] removing %s from %s", room_id, table)
373	            txn.execute("DELETE FROM %s WHERE room_id=?" % (table,), (room_id,))
374	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\push_rule.py:658:16
657	            sql = (
658	                """
659	                SELECT 1 FROM push_rules
660	                WHERE user_name = ? AND rule_id = ?
661	                %s
662	            """
663	                % for_key_share
664	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\registration.py:778:8
777	
778	        assert address or sid
779	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:781:18
780	        def get_threepid_validation_session_txn(txn):
781	            sql = """
782	                SELECT address, session_id, medium, client_secret,
783	                last_send_attempt, validated_at
784	                FROM threepid_validation_session WHERE %s
785	                """ % (
786	                " AND ".join("%s = ?" % k for k in keyvalues.keys()),
787	            )
788	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1429:16
1428	            txn.execute(
1429	                "SELECT token, id, device_id FROM access_tokens WHERE %s"
1430	                % where_clause,
1431	                values,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1440:24
1439	
1440	            txn.execute("DELETE FROM access_tokens WHERE %s" % where_clause, values)
1441	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:97:14
96	
97	        sql = """
98	            SELECT event_id, topological_ordering, stream_ordering
99	            FROM event_relations
100	            INNER JOIN events USING (event_id)
101	            WHERE %s
102	            ORDER BY topological_ordering %s, stream_ordering %s
103	            LIMIT ?
104	        """ % (
105	            " AND ".join(where_clause),
106	            order,
107	            order,
108	        )
109	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:188:14
187	
188	        sql = """
189	            SELECT type, aggregation_key, COUNT(DISTINCT sender), MAX(stream_ordering)
190	            FROM event_relations
191	            INNER JOIN events USING (event_id)
192	            WHERE {where_clause}
193	            GROUP BY relation_type, type, aggregation_key
194	            {having_clause}
195	            ORDER BY COUNT(*) {order}, MAX(stream_ordering) {order}
196	            LIMIT ?
197	        """.format(
198	            where_clause=" AND ".join(where_clause),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:171:18
170	
171	            sql = """
172	                SELECT
173	                    COALESCE(COUNT(*), 0)
174	                FROM (
175	                    %(published_sql)s
176	                ) published
177	                INNER JOIN room_stats_state USING (room_id)
178	                INNER JOIN room_stats_current USING (room_id)
179	                WHERE
180	                    (
181	                        join_rules = 'public' OR history_visibility = 'world_readable'
182	                    )
183	                    AND joined_members > 0
184	            """ % {
185	                "published_sql": published_sql
186	            }
187	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:305:14
304	
305	        sql = """
306	            SELECT
307	                room_id, name, topic, canonical_alias, joined_members,
308	                avatar, history_visibility, joined_members, guest_access
309	            FROM (
310	                %(published_sql)s
311	            ) published
312	            INNER JOIN room_stats_state USING (room_id)
313	            INNER JOIN room_stats_current USING (room_id)
314	            WHERE
315	                (
316	                    join_rules = 'public' OR history_visibility = 'world_readable'
317	                )
318	                AND joined_members > 0
319	                %(where_clause)s
320	            ORDER BY joined_members %(dir)s, room_id %(dir)s
321	        """ % {
322	            "published_sql": published_sql,
323	            "where_clause": where_clause,
324	            "dir": "DESC" if forwards else "ASC",
325	        }
326	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:452:19
451	        # returned. Thus allowing us to see if there are more events to paginate through
452	        info_sql = """
453	            SELECT state.room_id, state.name, state.canonical_alias, curr.joined_members,
454	              curr.local_users_in_room, rooms.room_version, rooms.creator,
455	              state.encryption, state.is_federatable, rooms.is_public, state.join_rules,
456	              state.guest_access, state.history_visibility, curr.current_state_events
457	            FROM room_stats_state state
458	            INNER JOIN room_stats_current curr USING (room_id)
459	            INNER JOIN rooms USING (room_id)
460	            %s
461	            ORDER BY %s %s
462	            LIMIT ?
463	            OFFSET ?
464	        """ % (
465	            where_statement,
466	            order_by_column,
467	            "ASC" if order_by_asc else "DESC",
468	        )
469	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:471:20
470	        # Use a nested SELECT statement as SQL can't count(*) with an OFFSET
471	        count_sql = """
472	            SELECT count(*) FROM (
473	              SELECT room_id FROM room_stats_state state
474	              %s
475	            ) AS get_room_ids
476	        """ % (
477	            where_statement,
478	        )
479	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:991:16
990	            txn.execute(
991	                """
992	                SELECT state.room_id, state.event_id, events.json
993	                FROM current_state_events as state
994	                LEFT JOIN event_json AS events ON (state.event_id = events.event_id)
995	                WHERE state.room_id > ? AND state.type = '%s'
996	                ORDER BY state.room_id ASC
997	                LIMIT ?;
998	                """
999	                % EventTypes.Retention,
1000	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1126:16
1125	            txn.execute(
1126	                """
1127	                SELECT room_id
1128	                FROM rooms r
1129	                INNER JOIN current_state_events cse USING (room_id)
1130	                WHERE room_id > ? AND r.is_public
1131	                AND cse.type = '%s' AND cse.state_key = ''
1132	                ORDER BY room_id ASC
1133	                LIMIT ?;
1134	                """
1135	                % EventTypes.Tombstone,
1136	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1513:18
1512	
1513	            sql = """
1514	                SELECT COUNT(*) as total_event_reports
1515	                FROM event_reports AS er
1516	                {}
1517	                """.format(
1518	                where_clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1523:18
1522	
1523	            sql = """
1524	                SELECT
1525	                    er.id,
1526	                    er.received_ts,
1527	                    er.room_id,
1528	                    er.event_id,
1529	                    er.user_id,
1530	                    er.content,
1531	                    events.sender,
1532	                    room_stats_state.canonical_alias,
1533	                    room_stats_state.name
1534	                FROM event_reports AS er
1535	                LEFT JOIN events
1536	                    ON events.event_id = er.event_id
1537	                JOIN room_stats_state
1538	                    ON room_stats_state.room_id = er.room_id
1539	                {where_clause}
1540	                ORDER BY er.received_ts {order}
1541	                LIMIT ?
1542	                OFFSET ?
1543	            """.format(
1544	                where_clause=where_clause, order=order,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:337:14
336	
337	        sql = """
338	            SELECT room_id, e.sender, c.membership, event_id, e.stream_ordering
339	            FROM local_current_membership AS c
340	            INNER JOIN events AS e USING (room_id, event_id)
341	            WHERE
342	                user_id = ?
343	                AND %s
344	        """ % (
345	            clause,
346	        )
347	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:517:8
516	        # with a state_group of None are likely to be different.
517	        assert state_group is not None
518	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:678:8
677	        # with a state_group of None are likely to be different.
678	        assert state_group is not None
679	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:797:14
796	
797	        sql = """
798	            SELECT 1 FROM local_current_membership
799	            WHERE
800	                room_id = ? AND membership = ?
801	                AND NOT (%s)
802	                LIMIT 1
803	        """ % (
804	            clause,
805	        )
806	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\roommember.py:873:16
872	                    content = event_json["content"]
873	                except Exception:
874	                    continue
875	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\20\pushers.py:69:12
68	        cur.execute(
69	            """
70	                INSERT into pushers2 (
71	                id, user_name, access_token, profile_tag, kind,
72	                app_id, app_display_name, device_display_name,
73	                pushkey, ts, lang, data, last_token, last_success,
74	                failing_since
75	                ) values (%s)
76	            """
77	            % (",".join(["?" for _ in range(len(row))])),
78	            row,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\databases\main\schema\delta\30\as_users.py:25:4
24	        cur.execute("ALTER TABLE users ADD COLUMN appservice_id TEXT")
25	    except Exception:
26	        # Maybe we already added the column? Hope so...
27	        pass
28	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\30\as_users.py:62:16
61	            cur.execute(
62	                "UPDATE users SET appservice_id = ? WHERE name IN (%s)"
63	                % (",".join("?" for _ in chunk),),
64	                [as_id] + chunk,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\31\pushers.py:68:12
67	        cur.execute(
68	            """
69	                INSERT into pushers2 (
70	                id, user_name, access_token, profile_tag, kind,
71	                app_id, app_display_name, device_display_name,
72	                pushkey, ts, lang, data, last_stream_ordering, last_success,
73	                failing_since
74	                ) values (%s)
75	            """
76	            % (",".join(["?" for _ in range(len(row))])),
77	            row,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\48\group_unique_indexes.py:42:8
41	    cur.execute(
42	        """
43	        DELETE FROM group_users WHERE %s NOT IN (
44	           SELECT min(%s) FROM group_users GROUP BY group_id, user_id
45	        );
46	    """
47	        % (rowid, rowid)
48	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\48\group_unique_indexes.py:50:8
49	    cur.execute(
50	        """
51	        DELETE FROM group_invites WHERE %s NOT IN (
52	           SELECT min(%s) FROM group_invites GROUP BY group_id, user_id
53	        );
54	    """
55	        % (rowid, rowid)
56	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\search.py:127:16
126	            sql = (
127	                "SELECT stream_ordering, event_id, room_id, type, json, "
128	                " origin_server_ts FROM events"
129	                " JOIN event_json USING (room_id, event_id)"
130	                " WHERE ? <= stream_ordering AND stream_ordering < ?"
131	                " AND (%s)"
132	                " ORDER BY stream_ordering DESC"
133	                " LIMIT ?"
134	            ) % (" OR ".join("type = '%s'" % (t,) for t in TYPES),)
135	
136	            txn.execute(sql, (target_min_stream_id, max_stream_id, batch_size))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\search.py:159:20
158	                        content = event_json["content"]
159	                    except Exception:
160	                        continue
161	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\state_deltas.py:54:8
53	        # check we're not going backwards
54	        assert prev_stream_id <= max_stream_id
55	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:523:18
522	
523	            sql = """
524	                INSERT INTO %(table)s (%(insert_cols_cs)s)
525	                VALUES (%(insert_vals_qs)s)
526	                ON CONFLICT (%(key_columns)s) DO UPDATE SET %(updates)s
527	            """ % {
528	                "table": table,
529	                "insert_cols_cs": ", ".join(insert_cols),
530	                "insert_vals_qs": ", ".join(
531	                    ["?"] * (len(keyvalues) + len(absolutes) + len(additive_relatives))
532	                ),
533	                "key_columns": ", ".join(keyvalues),
534	                "updates": ", ".join(chain(absolute_updates, relative_updates)),
535	            }
536	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:608:18
607	
608	            sql = """
609	                INSERT INTO %(into_table)s (%(ins_columns)s)
610	                SELECT %(sel_exprs)s
611	                FROM %(src_table)s
612	                WHERE %(keyvalues_where)s
613	                ON CONFLICT (%(keyvalues)s)
614	                DO UPDATE SET %(sets)s
615	            """ % {
616	                "into_table": into_table,
617	                "ins_columns": ", ".join(ins_columns),
618	                "sel_exprs": ", ".join(sel_exprs),
619	                "keyvalues_where": " AND ".join(keyvalues_where),
620	                "src_table": src_table,
621	                "keyvalues": ", ".join(
622	                    chain(keyvalues.keys(), extra_dst_keyvalues.keys())
623	                ),
624	                "sets": ", ".join(chain(sets_cc, sets_ar)),
625	            }
626	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:710:14
709	
710	        sql = """
711	            SELECT events.room_id, COUNT(*) AS new_events, SUM(%s) AS new_bytes
712	            FROM events INNER JOIN event_json USING (event_id)
713	            WHERE (? < stream_ordering AND stream_ordering <= ?)
714	                OR (? <= stream_ordering AND stream_ordering <= ?)
715	            GROUP BY events.room_id
716	        """ % (
717	            new_bytes_expression,
718	        )
719	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:727:14
726	
727	        sql = """
728	            SELECT events.sender, COUNT(*) AS new_events, SUM(%s) AS new_bytes
729	            FROM events INNER JOIN event_json USING (event_id)
730	            WHERE (? < stream_ordering AND stream_ordering <= ?)
731	                OR (? <= stream_ordering AND stream_ordering <= ?)
732	            GROUP BY events.sender
733	        """ % (
734	            new_bytes_expression,
735	        )
736	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:979:18
978	            # SQLite does not support SELECT COUNT(*) OVER()
979	            sql = """
980	                SELECT COUNT(*) FROM (
981	                    SELECT lmr.user_id
982	                    {sql_base}
983	                ) AS count_user_ids
984	            """.format(
985	                sql_base=sql_base,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'stream'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:70:16
69	
70	_STREAM_TOKEN = "stream"
71	_TOPOLOGICAL_TOKEN = "topological"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'topological'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:71:21
70	_STREAM_TOKEN = "stream"
71	_TOPOLOGICAL_TOKEN = "topological"
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:121:4
120	    """
121	    assert direction in ("b", "f")
122	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:176:4
175	
176	    assert bound in (">", "<", ">=", "<=")
177	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stream.py:495:18
494	
495	            sql = """
496	                SELECT event_id, instance_name, topological_ordering, stream_ordering
497	                FROM events
498	                WHERE
499	                    room_id = ?
500	                    AND not outlier
501	                    AND stream_ordering > ? AND stream_ordering <= ?
502	                ORDER BY stream_ordering %s LIMIT ?
503	            """ % (
504	                order,
505	            )
506	            txn.execute(sql, (room_id, min_from_id, max_to_id, 2 * limit))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:858:8
857	        # This cannot happen as `allow_none=False`.
858	        assert results is not None
859	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1011:8
1010	        # Ensure we do actually have some values here
1011	        assert set(min_positions) == {"federation", "events"}
1012	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1063:8
1062	
1063	        assert int(limit) >= 0
1064	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\transactions.py:234:8
233	    ):
234	        assert self.database_engine.can_native_upsert
235	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:155:18
154	            # if those 250 rooms have less than batch_size state events.
155	            sql = """
156	                SELECT room_id, events FROM %s
157	                ORDER BY events DESC
158	                LIMIT 250
159	            """ % (
160	                TEMP_TABLE + "_rooms",
161	            )
162	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:170:24
169	            # far we are in processing
170	            txn.execute("SELECT COUNT(*) FROM " + TEMP_TABLE + "_rooms")
171	            progress["remaining"] = txn.fetchone()[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:281:18
280	        def _get_next_batch(txn):
281	            sql = "SELECT user_id FROM %s LIMIT %s" % (
282	                TEMP_TABLE + "_users",
283	                str(batch_size),
284	            )
285	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:295:18
294	            # far we are in processing
295	            sql = "SELECT COUNT(*) FROM " + TEMP_TABLE + "_users"
296	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:758:18
757	            # search: (domain, _, display name, localpart)
758	            sql = """
759	                SELECT d.user_id AS user_id, display_name, avatar_url
760	                FROM user_directory_search as t
761	                INNER JOIN user_directory AS d USING (user_id)
762	                WHERE
763	                    %s
764	                    AND vector @@ to_tsquery('english', ?)
765	                ORDER BY
766	                    (CASE WHEN d.user_id IS NOT NULL THEN 4.0 ELSE 1.0 END)
767	                    * (CASE WHEN display_name IS NOT NULL THEN 1.2 ELSE 1.0 END)
768	                    * (CASE WHEN avatar_url IS NOT NULL THEN 1.2 ELSE 1.0 END)
769	                    * (
770	                        3 * ts_rank_cd(
771	                            '{0.1, 0.1, 0.9, 1.0}',
772	                            vector,
773	                            to_tsquery('english', ?),
774	                            8
775	                        )
776	                        + ts_rank_cd(
777	                            '{0.1, 0.1, 0.9, 1.0}',
778	                            vector,
779	                            to_tsquery('english', ?),
780	                            8
781	                        )
782	                    )
783	                    DESC,
784	                    display_name IS NULL,
785	                    avatar_url IS NULL
786	                LIMIT ?
787	            """ % (
788	                where_clause,
789	            )
790	            args = join_args + (full_query, exact_query, prefix_query, limit + 1)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:794:18
793	
794	            sql = """
795	                SELECT d.user_id AS user_id, display_name, avatar_url
796	                FROM user_directory_search as t
797	                INNER JOIN user_directory AS d USING (user_id)
798	                WHERE
799	                    %s
800	                    AND value MATCH ?
801	                ORDER BY
802	                    rank(matchinfo(user_directory_search)) DESC,
803	                    display_name IS NULL,
804	                    avatar_url IS NULL
805	                LIMIT ?
806	            """ % (
807	                where_clause,
808	            )
809	            args = join_args + (search_query, limit + 1)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\state\bg_updates.py:144:24
143	                    txn.execute(
144	                        "SELECT type, state_key, event_id FROM state_groups_state"
145	                        " WHERE state_group = ? " + where_clause,
146	                        args,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\engines\postgres.py:169:8
168	        numver = self._version
169	        assert numver is not None
170	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:191:8
190	
191	        assert stores.persist_events
192	        self.persist_events_store = stores.persist_events

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:286:8
285	        # stream ordering should have been assigned by now
286	        assert event_stream_id
287	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:408:24
407	                        # extremities, so we'll `continue` above and skip this bit.)
408	                        assert new_latest_event_ids, "No forward extremities left!"
409	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:344:8
343	    if is_empty:
344	        assert not applied_delta_files
345	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:346:8
345	    else:
346	        assert config
347	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:60:20
59	    if step == 1:
60	        cur.execute("SELECT MAX(%s) FROM %s" % (column, table))
61	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:62:20
61	    else:
62	        cur.execute("SELECT MIN(%s) FROM %s" % (column, table))
63	    (val,) = cur.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:96:8
95	    def __init__(self, db_conn, table, column, extra_tables=[], step=1):
96	        assert step != 0
97	        self._lock = threading.Lock()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:309:18
308	            # the server has never backfilled).
309	            sql = """
310	                SELECT GREATEST(COALESCE(%(agg)s(%(id)s), 1), 1)
311	                FROM %(table)s
312	            """ % {
313	                "id": id_column,
314	                "table": table,
315	                "agg": "MAX" if self._positive else "-MIN",
316	            }
317	            cur.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:332:18
331	
332	            sql = """
333	                SELECT %(instance)s, %(id)s FROM %(table)s
334	                WHERE ? %(cmp)s %(id)s
335	            """ % {
336	                "id": id_column,
337	                "table": table,
338	                "instance": instance_column,
339	                "cmp": "<=" if self._positive else ">=",
340	            }
341	            cur.execute(sql, (min_stream_id * self._return_factor,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:523:8
522	        # We require that the lock is locked by caller
523	        assert self._lock.locked()
524	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:571:14
570	        # value (or decrease if stream goes backwards).
571	        sql = """
572	            INSERT INTO stream_positions (stream_name, instance_name, stream_id)
573	            VALUES (?, ?, ?)
574	            ON CONFLICT (stream_name, instance_name)
575	            DO UPDATE SET
576	                stream_id = %(agg)s(stream_positions.stream_id, EXCLUDED.stream_id)
577	        """ % {
578	            "agg": "GREATEST" if self._positive else "LEAST",
579	        }
580	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:99:20
98	        # First we get the current max ID from the table.
99	        table_sql = "SELECT GREATEST(%(agg)s(%(id)s), 0) FROM %(table)s" % {
100	            "id": id_column,
101	            "table": table,
102	            "agg": "MAX" if positive else "-MIN",
103	        }
104	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:116:12
115	        txn.execute(
116	            "SELECT last_value, is_called FROM %(seq)s" % {"seq": self._sequence_name}
117	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:168:16
167	            if self._current_max_id is None:
168	                assert self._callback is not None
169	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:494:8
493	                return cls(topological=None, stream=stream, instance_map=instance_map,)
494	        except Exception:
495	            pass
496	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:503:8
502	                return cls(topological=None, stream=int(string[1:]))
503	        except Exception:
504	            pass
505	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\types.py:545:8
544	        """
545	        assert self.topological is None
546	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async_helpers.py:80:16
79	                    self._observers.pop().callback(r)
80	                except Exception:
81	                    pass
82	            return r

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async_helpers.py:94:16
93	                    self._observers.pop().errback(f)
94	                except Exception:
95	                    pass
96	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\deferred_cache.py:160:16
159	                m = self.cache.metrics
160	                assert m  # we always have a name, so should always have metrics
161	                m.inc_hits()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:89:8
88	        """
89	        assert isinstance(stream_pos, int)
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:138:8
137	        """
138	        assert type(stream_pos) is int
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:157:8
156	        """
157	        assert type(stream_pos) is int
158	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:172:8
171	        """
172	        assert type(stream_pos) is int
173	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\retryutils.py:202:61
201	                self.retry_interval = int(
202	                    self.retry_interval * RETRY_MULTIPLIER * random.uniform(0.8, 1.4)
203	                )

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\util\versionstring.py:19:0
18	import os
19	import subprocess
20	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:48:16
47	            git_branch = (
48	                subprocess.check_output(
49	                    ["git", "rev-parse", "--abbrev-ref", "HEAD"], stderr=null, cwd=cwd
50	                )
51	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:48:16
47	            git_branch = (
48	                subprocess.check_output(
49	                    ["git", "rev-parse", "--abbrev-ref", "HEAD"], stderr=null, cwd=cwd
50	                )
51	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:61:16
60	            git_tag = (
61	                subprocess.check_output(
62	                    ["git", "describe", "--exact-match"], stderr=null, cwd=cwd
63	                )
64	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:61:16
60	            git_tag = (
61	                subprocess.check_output(
62	                    ["git", "describe", "--exact-match"], stderr=null, cwd=cwd
63	                )
64	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:73:16
72	            git_commit = (
73	                subprocess.check_output(
74	                    ["git", "rev-parse", "--short", "HEAD"], stderr=null, cwd=cwd
75	                )
76	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:73:16
72	            git_commit = (
73	                subprocess.check_output(
74	                    ["git", "rev-parse", "--short", "HEAD"], stderr=null, cwd=cwd
75	                )
76	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:85:16
84	            is_dirty = (
85	                subprocess.check_output(
86	                    ["git", "describe", "--dirty=" + dirty_string], stderr=null, cwd=cwd
87	                )
88	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:85:16
84	            is_dirty = (
85	                subprocess.check_output(
86	                    ["git", "describe", "--dirty=" + dirty_string], stderr=null, cwd=cwd
87	                )
88	                .strip()

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\visibility.py:298:20
297	                        domain = get_domain_from_id(ev.state_key)
298	                    except Exception:
299	                        continue
300	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:104:22
103	    def test_get_user_by_req_appservice_valid_token(self):
104	        app_service = Mock(
105	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
106	        )
107	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:121:22
120	
121	        app_service = Mock(
122	            token="foobar",
123	            url="a_url",
124	            sender=self.test_user,
125	            ip_range_whitelist=IPSet(["192.168/16"]),
126	        )
127	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:140:22
139	
140	        app_service = Mock(
141	            token="foobar",
142	            url="a_url",
143	            sender=self.test_user,
144	            ip_range_whitelist=IPSet(["192.168/16"]),
145	        )
146	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:171:22
170	    def test_get_user_by_req_appservice_missing_token(self):
171	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
172	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:185:22
184	        masquerading_user_id = b"@doppelganger:matrix.org"
185	        app_service = Mock(
186	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
187	        )
188	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:208:22
207	        masquerading_user_id = b"@doppelganger:matrix.org"
208	        app_service = Mock(
209	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
210	        )
211	        app_service.is_interested_in_user = Mock(return_value=False)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_frontend_proxy.py:38:35
37	                "port": 8080,
38	                "bind_addresses": ["0.0.0.0"],
39	                "resources": [{"names": ["client"]}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:59:31
58	            "type": "http",
59	            "bind_addresses": ["0.0.0.0"],
60	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:108:31
107	            "type": "http",
108	            "bind_addresses": ["0.0.0.0"],
109	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\appservice\test_appservice.py:32:23
31	    def setUp(self):
32	        self.service = ApplicationService(
33	            id="unique_identifier",
34	            sender="@as:test",
35	            url="some_url",
36	            token="some_token",
37	            hostname="matrix.org",  # only used by get_groups_for_user
38	            namespaces={
39	                ApplicationService.NS_USERS: [],
40	                ApplicationService.NS_ROOMS: [],
41	                ApplicationService.NS_ALIASES: [],
42	            },
43	        )
44	        self.event = Mock(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:146:12
145	            self.addCleanup(setattr, SSL, "SSL.OP_NO_TLSv1_3", OP_NO_TLSv1_3)
146	            assert not hasattr(SSL, "OP_NO_TLSv1_3")
147	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:168:12
167	            self.addCleanup(lambda: delattr(SSL, "OP_NO_TLSv1_3"))
168	            assert hasattr(SSL, "OP_NO_TLSv1_3")
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\federation\test_federation_catch_up.py:252:12
251	        ) -> bool:
252	            assert destination == destination_tm
253	            results_list.extend(pending_pdus)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:143:24
142	        service.is_interested.return_value = make_awaitable(is_interested)
143	        service.token = "mock_service_token"
144	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:150:24
149	        service.is_interested_in_alias.return_value = is_interested_in_alias
150	        service.token = "mock_service_token"
151	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'sometoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_federation.py:52:23
51	        # Send a 3PID invite event with an empty body so it's considered as a revoked one.
52	        invite_token = "sometoken"
53	        self.helper.send_state(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-client-secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_oidc.py:52:16
51	CLIENT_ID = "test-client-id"
52	CLIENT_SECRET = "test-client-secret"
53	BASE_URL = "https://synapse/"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\http\__init__.py:16:0
15	import os.path
16	import subprocess
17	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:90:4
89	    # first build a CSR
90	    subprocess.check_call(
91	        [
92	            "openssl",
93	            "req",
94	            "-new",
95	            "-key",
96	            get_test_key_file(),
97	            "-subj",
98	            "/",
99	            "-out",
100	            csr_filename,
101	        ]
102	    )
103	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:90:4
89	    # first build a CSR
90	    subprocess.check_call(
91	        [
92	            "openssl",
93	            "req",
94	            "-new",
95	            "-key",
96	            get_test_key_file(),
97	            "-subj",
98	            "/",
99	            "-out",
100	            csr_filename,
101	        ]
102	    )
103	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:112:4
111	    ca_cert_filename = get_test_ca_cert_file()
112	    subprocess.check_call(
113	        [
114	            "openssl",
115	            "x509",
116	            "-req",
117	            "-in",
118	            csr_filename,
119	            "-CA",
120	            ca_cert_filename,
121	            "-CAkey",
122	            ca_key_filename,
123	            "-set_serial",
124	            "1",
125	            "-extfile",
126	            cnf_filename,
127	            "-out",
128	            cert_filename,
129	        ]
130	    )
131	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:112:4
111	    ca_cert_filename = get_test_ca_cert_file()
112	    subprocess.check_call(
113	        [
114	            "openssl",
115	            "x509",
116	            "-req",
117	            "-in",
118	            csr_filename,
119	            "-CA",
120	            ca_cert_filename,
121	            "-CAkey",
122	            ca_key_filename,
123	            "-set_serial",
124	            "1",
125	            "-extfile",
126	            cnf_filename,
127	            "-out",
128	            cert_filename,
129	        ]
130	    )
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_email.py:183:8
182	        # Nothing should have happened yet, as we're paused.
183	        assert not self.email_attempts
184	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\_base.py:450:8
449	    def __call__(self, *args, **kwargs):
450	        assert self.request is None
451	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\replication\_base.py:555:12
554	                self._consumer.unregisterProducer()
555	            except Exception:
556	                pass
557	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\slave\storage\test_events.py:249:8
248	        repl_transport = self._server_transport
249	        assert isinstance(repl_transport, FakeTransport)
250	        repl_transport.autoflush = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:33:8
32	        cmd = parse_command_from_line(line)
33	        assert isinstance(cmd, RdataCommand)
34	        self.assertEqual(cmd.stream_name, "events")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:41:8
40	        cmd = parse_command_from_line(line)
41	        assert isinstance(cmd, RdataCommand)
42	        self.assertEqual(cmd.stream_name, "presence")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\test_federation_ack.py:71:8
70	        cmd = mock_connection.send_command.call_args[0][0]
71	        assert isinstance(cmd, FederationAckCommand)
72	        self.assertEqual(cmd.token, 10)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\admin\test_user.py:59:52
58	
59	        self.hs.config.registration_shared_secret = "shared"
60	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_consent.py:40:15
39	        config["public_baseurl"] = "aaaa"
40	        config["form_secret"] = "123abc"
41	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_login.py:511:17
510	
511	    jwt_secret = "secret"
512	    jwt_algorithm = "HS256"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\v1\test_login.py:774:23
773	
774	        self.service = ApplicationService(
775	            id="unique_identifier",
776	            token="some_token",
777	            hostname="example.com",
778	            sender="@asbot:example.com",
779	            namespaces={
780	                ApplicationService.NS_USERS: [
781	                    {"regex": r"@as_user.*", "exclusive": False}
782	                ],
783	                ApplicationService.NS_ROOMS: [],
784	                ApplicationService.NS_ALIASES: [],
785	            },
786	        )
787	        self.another_service = ApplicationService(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'another_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\v1\test_login.py:787:31
786	        )
787	        self.another_service = ApplicationService(
788	            id="another__identifier",
789	            token="another_token",
790	            hostname="example.com",
791	            sender="@as2bot:example.com",
792	            namespaces={
793	                ApplicationService.NS_USERS: [
794	                    {"regex": r"@as2_user.*", "exclusive": False}
795	                ],
796	                ApplicationService.NS_ROOMS: [],
797	                ApplicationService.NS_ALIASES: [],
798	            },
799	        )
800	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 't1-0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:880:16
879	    def test_topo_token_is_accepted(self):
880	        token = "t1-0_0_0_0_0_0_0_0_0"
881	        request, channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:892:16
891	    def test_stream_token_is_accepted_for_fwd_pagianation(self):
892	        token = "s0_0_0_0_0_0_0_0_0"
893	        request, channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1457:16
1456	
1457	        token = "s0_0_0_0_0_0_0_0_0"
1458	        request, channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1475:16
1474	
1475	        token = "s0_0_0_0_0_0_0_0_0"
1476	        request, channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1499:16
1498	
1499	        token = "s0_0_0_0_0_0_0_0_0"
1500	        request, channel = self.make_request(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:59:8
58	
59	        assert channel.result["code"] == b"%d" % expect_code, channel.result
60	        self.auth_user_id = temp_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:133:8
132	
133	        assert int(channel.result["code"]) == expect_code, (
134	            "Expected: %d, got: %d, resp: %r"
135	            % (expect_code, int(channel.result["code"]), channel.result["body"])
136	        )
137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:165:8
164	
165	        assert int(channel.result["code"]) == expect_code, (
166	            "Expected: %d, got: %d, resp: %r"
167	            % (expect_code, int(channel.result["code"]), channel.result["body"])
168	        )
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:217:8
216	
217	        assert int(channel.result["code"]) == expect_code, (
218	            "Expected: %d, got: %d, resp: %r"
219	            % (expect_code, int(channel.result["code"]), channel.result["body"])
220	        )
221	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:307:8
306	
307	        assert channel.code == expect_code, "Expected: %d, got: %d, resp: %r" % (
308	            expect_code,
309	            int(channel.result["code"]),
310	            channel.result["body"],
311	        )
312	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:80:23
79	        """
80	        old_password = "monkey"
81	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:81:23
80	        old_password = "monkey"
81	        new_password = "kangeroo"
82	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:99:24
98	
99	        client_secret = "foobar"
100	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:119:23
118	        """
119	        old_password = "monkey"
120	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:120:23
119	        old_password = "monkey"
120	        new_password = "kangeroo"
121	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:139:24
138	
139	        client_secret = "foobar"
140	        session_id = self._request_token(email_passwort_reset, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:158:23
157	        """
158	        old_password = "monkey"
159	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:159:23
158	        old_password = "monkey"
159	        new_password = "kangeroo"
160	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:177:24
176	
177	        client_secret = "foobar"
178	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:195:23
194	        """
195	        old_password = "monkey"
196	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:196:23
195	        old_password = "monkey"
196	        new_password = "kangeroo"
197	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:214:24
213	
214	        client_secret = "foobar"
215	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:237:24
236	
237	        client_secret = "foobar"
238	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:286:8
285	    def _get_link_from_email(self):
286	        assert self.email_attempts, "No emails have been sent"
287	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:301:8
300	        match = re.search(r"https://example.com\S+", text)
301	        assert match, "Could not find link in email"
302	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:523:24
522	
523	        client_secret = "foobar"
524	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:630:24
629	        """
630	        client_secret = "foobar"
631	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:667:24
666	        """
667	        client_secret = "foobar"
668	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:803:4
802	
803	    def _request_token_invalid_email(
804	        self, email, expected_errcode, expected_error, client_secret="foobar",
805	    ):
806	        request, channel = self.make_request(
807	            "POST",
808	            b"account/3pid/email/requestToken",
809	            {"client_secret": client_secret, "email": email, "send_attempt": 1},
810	        )
811	        self.render(request)
812	        self.assertEqual(400, int(channel.result["code"]), msg=channel.result["body"])
813	        self.assertEqual(expected_errcode, channel.json_body["errcode"])
814	        self.assertEqual(expected_error, channel.json_body["error"])
815	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:825:8
824	    def _get_link_from_email(self):
825	        assert self.email_attempts, "No emails have been sent"
826	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:840:8
839	        match = re.search(r"https://example.com\S+", text)
840	        assert match, "Could not find link in email"
841	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:847:24
846	        """
847	        client_secret = "foobar"
848	        session_id = self._request_token(request_email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_auth.py:171:25
170	
171	        self.user_pass = "pass"
172	        self.user = self.register_user("test", self.user_pass)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_capabilities.py:63:19
62	        localpart = "user"
63	        password = "pass"
64	        user = self.register_user(localpart, password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'C0mpl!antpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_password_policy.py:154:29
153	        """
154	        compliant_password = "C0mpl!antpassword"
155	        not_compliant_password = "notcompliantpassword"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'notcompliantpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_password_policy.py:155:33
154	        compliant_password = "C0mpl!antpassword"
155	        not_compliant_password = "notcompliantpassword"
156	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:51:19
50	        user_id = "@as_user_kermit:test"
51	        as_token = "i_am_an_app_service"
52	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:132:45
131	    def test_POST_guest_registration(self):
132	        self.hs.config.macaroon_secret_key = "test"
133	        self.hs.config.allow_guest_access = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:153:25
152	        for _ in range(20):
153	            from_token = ""
154	            if prev_token:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:212:25
211	        for _ in range(20):
212	            from_token = ""
213	            if prev_token:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:282:25
281	        for _ in range(20):
282	            from_token = ""
283	            if prev_token:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:214:8
213	        keyres = res["targetserver"][keyid]
214	        assert isinstance(keyres, FetchKeyResult)
215	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:236:8
235	        keyres = res[self.hs.hostname][keyid]
236	        assert isinstance(keyres, FetchKeyResult)
237	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:253:8
252	        keyres = res[self.hs.hostname][keyid]
253	        assert isinstance(keyres, FetchKeyResult)
254	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\server.py:80:8
79	    def write(self, content):
80	        assert isinstance(content, bytes), "Should be bytes! " + repr(content)
81	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\server_notices\test_consent.py:49:15
48	        config["public_baseurl"] = "https://example.com/"
49	        config["form_secret"] = "123abc"
50	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\storage\test_appservice.py:50:24
49	
50	        self.as_token = "token1"
51	        self.as_url = "some_url"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\storage\test_appservice.py:69:12
68	                os.remove(f)
69	            except Exception:
70	                pass
71	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:538:13
537	    def test_duplicate_as_tokens(self):
538	        f1 = self._write_config(as_token="as_token", suffix="1")
539	        f2 = self._write_config(as_token="as_token", suffix="2")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:539:13
538	        f1 = self._write_config(as_token="as_token", suffix="1")
539	        f2 = self._write_config(as_token="as_token", suffix="2")
540	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_redaction.py:246:16
245	                built_event._dict["event_id"] = self._event_id
246	                assert built_event.event_id == self._event_id
247	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\event_injection.py:75:4
74	    persistence = hs.get_storage().persistence
75	    assert persistence is not None
76	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittest.py:568:52
567	        """
568	        self.hs.config.registration_shared_secret = "shared"
569	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:666:16
665	            async def list_fn(self, args1, arg2):
666	                assert current_context().request == "c1"
667	                # we want this to behave like an asynchronous function

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:669:16
668	                await run_on_reactor()
669	                assert current_context().request == "c1"
670	                return self.mock(args1, arg2)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:336:15
335	    async def hash(p):
336	        return hashlib.md5(p.encode("utf8")).hexdigest()
337	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:341:15
340	    async def validate_hash(p, h):
341	        return hashlib.md5(p.encode("utf8")).hexdigest() == h
342	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\utils.py:437:8
436	            path = mock_request.path
437	        except Exception:
438	            pass
439	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\utils.py:479:8
478	    def verify(self, message, sig):
479	        assert sig == b"\x9a\x87$"
480	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\utils.py:593:12
592	                d.errback(failure)
593	            except Exception:
594	                pass
595	

--------------------------------------------------

Code scanned:
	Total lines of code: 134135
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 321
		Medium: 106
		High: 8
	Total issues (by confidence):
		Undefined: 0
		Low: 68
		Medium: 120
		High: 247
Files skipped (0):
