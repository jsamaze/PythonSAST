Working... ---------------------------------------- 100% 0:00:01
Run started:2024-02-10 21:38:40.599229

Test results:
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\clickhouse_driver\connection.py:100:4
99	
100	    def __init__(
101	            self, host, port=None,
102	            database='default', user='default', password='',
103	            client_name=defines.CLIENT_NAME,
104	            connect_timeout=defines.DBMS_DEFAULT_CONNECT_TIMEOUT_SEC,
105	            send_receive_timeout=defines.DBMS_DEFAULT_TIMEOUT_SEC,
106	            sync_request_timeout=defines.DBMS_DEFAULT_SYNC_REQUEST_TIMEOUT_SEC,
107	            compress_block_size=defines.DEFAULT_COMPRESS_BLOCK_SIZE,
108	            compression=False,
109	            secure=False,
110	            # Secure socket parameters.
111	            verify=True, ssl_version=None, ca_certs=None, ciphers=None,
112	            alt_hosts=None
113	    ):
114	        if secure:
115	            default_port = defines.DEFAULT_SECURE_PORT
116	        else:
117	            default_port = defines.DEFAULT_PORT
118	
119	        self.hosts = [(host, port or default_port)]
120	
121	        if alt_hosts:
122	            for host in alt_hosts.split(','):
123	                url = urlparse('clickhouse://' + host)
124	                self.hosts.append((url.hostname, url.port or default_port))
125	
126	        self.database = database
127	        self.user = user
128	        self.password = password
129	        self.client_name = defines.DBMS_NAME + ' ' + client_name
130	        self.connect_timeout = connect_timeout
131	        self.send_receive_timeout = send_receive_timeout
132	        self.sync_request_timeout = sync_request_timeout
133	
134	        self.secure_socket = secure
135	        self.verify_cert = verify
136	
137	        ssl_options = {}
138	        if ssl_version is not None:
139	            ssl_options['ssl_version'] = ssl_version
140	        if ca_certs is not None:
141	            ssl_options['ca_certs'] = ca_certs
142	        if ciphers is not None:
143	            ssl_options['ciphers'] = ciphers
144	
145	        self.ssl_options = ssl_options
146	
147	        # Use LZ4 compression by default.
148	        if compression is True:
149	            compression = 'lz4'
150	
151	        if compression is False:
152	            self.compression = Compression.DISABLED
153	            self.compressor_cls = None
154	            self.compress_block_size = None
155	        else:
156	            self.compression = Compression.ENABLED
157	            self.compressor_cls = get_compressor_cls(compression)
158	            self.compress_block_size = compress_block_size
159	
160	        self.socket = None
161	        self.fin = None
162	        self.fout = None
163	
164	        self.connected = False
165	
166	        self.server_info = None
167	        self.context = Context()
168	
169	        # Block writer/reader
170	        self.block_in = None
171	        self.block_out = None
172	
173	        super(Connection, self).__init__()
174	

--------------------------------------------------
>> Issue: [B504:ssl_with_no_version] ssl.wrap_socket call with no SSL/TLS protocol version specified, the default SSLv23 could be insecure, possible security issue.
   Severity: Low   Confidence: Medium
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b504_ssl_with_no_version.html
   Location: .\clickhouse_driver\connection.py:210:27
209	                if self.secure_socket:
210	                    sock = ssl.wrap_socket(sock, **ssl_options)
211	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\test_client.py:159:24
158	            'ssl_version': ssl.PROTOCOL_SSLv23,
159	            'ca_certs': '/tmp/certs',
160	            'ciphers': 'HIGH:-aNULL:-eNULL:-PSK:RC4-SHA:RC4-MD5'
161	        })
162	
163	    def test_alt_hosts(self):
164	        c = Client.from_url('clickhouse://host?alt_hosts=host2:1234')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\testcase.py:2:0
1	from contextlib import contextmanager
2	import subprocess
3	from unittest import TestCase

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\testcase.py:54:18
53	
54	        process = subprocess.Popen(
55	            args, stdout=subprocess.PIPE, stderr=subprocess.PIPE
56	        )
57	        output = process.communicate()

--------------------------------------------------

Code scanned:
	Total lines of code: 7755
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 4
		Medium: 1
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 3
		High: 2
Files skipped (0):
