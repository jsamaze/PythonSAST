Working... ---------------------------------------- 100% 0:00:05
Run started:2024-02-10 21:50:04.745923

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\.github\workflows\ci.py:9:0
8	import shutil
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\.github\workflows\ci.py:24:10
23	    sys.stdout.flush()
24	    ret = subprocess.Popen(a).wait()
25	    if ret != 0:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\.github\workflows\ci.py:92:9
91	    os.chdir(SW)
92	    with urlopen('https://download.calibre-ebook.com/ci/kitty/{}-64.tar.xz'.format(
93	            'macos' if is_macos else 'linux')) as f:
94	        data = f.read()

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b202_tarfile_unsafe_members.html
   Location: .\.github\workflows\ci.py:96:8
95	    with tarfile.open(fileobj=io.BytesIO(data), mode='r:xz') as tf:
96	        tf.extractall()
97	    if not is_macos:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\__main__.py:28:4
27	    sys.argv = ['kitty'] + args[2:]
28	    exec(args[1])
29	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\__main__.py:32:4
31	def hold(args: List[str]) -> None:
32	    import subprocess
33	    ret = subprocess.Popen(args[1:]).wait()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\__main__.py:33:10
32	    import subprocess
33	    ret = subprocess.Popen(args[1:]).wait()
34	    sys.stdin.read()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bypy\init_env.py:8:0
7	import shutil
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\init_env.py:43:11
42	    cwd = env.pop('cwd', KITTY_DIR)
43	    return subprocess.call(list(args), env=env, cwd=cwd)
44	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bypy\linux\__main__.py:9:0
8	import stat
9	import subprocess
10	import tarfile

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\bypy\linux\__main__.py:121:8
120	    for path in files:
121	        os.chmod(path, 0o755)
122	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\linux\__main__.py:151:12
150	            [os.chmod(x, stat.S_IWRITE | old_mode) for x, old_mode in unwritable_files]
151	            subprocess.check_call(cmd)
152	            [os.chmod(x, old_mode) for x, old_mode in unwritable_files]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\linux\__main__.py:184:4
183	    start_time = time.time()
184	    subprocess.check_call(['xz', '--threads=0', '-f', '-' + compression_level, dist])
185	    secs = time.time() - start_time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\linux\__main__.py:184:4
183	    start_time = time.time()
184	    subprocess.check_call(['xz', '--threads=0', '-f', '-' + compression_level, dist])
185	    secs = time.time() - start_time

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bypy\macos\__main__.py:10:0
9	import stat
10	import subprocess
11	import sys

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\bypy\macos\__main__.py:78:8
77	            tostrip.append(flips.pop())
78	        os.spawnv(os.P_WAIT, cmd[0], cmd)
79	        for args in flips:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:181:8
180	        old_mode = flipwritable(path_to_lib)
181	        subprocess.check_call(
182	            ['install_name_tool', '-id', new_id, path_to_lib])
183	        if old_mode is not None:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:181:8
180	        old_mode = flipwritable(path_to_lib)
181	        subprocess.check_call(
182	            ['install_name_tool', '-id', new_id, path_to_lib])
183	        if old_mode is not None:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:188:23
187	    def get_dependencies(self, path_to_lib):
188	        install_name = subprocess.check_output(
189	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
190	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:188:23
187	    def get_dependencies(self, path_to_lib):
188	        install_name = subprocess.check_output(
189	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
190	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:190:14
189	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
190	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')
191	        for line in raw.splitlines():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:190:14
189	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
190	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')
191	        for line in raw.splitlines():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:211:8
210	        cmd = ['-id', new_dep] if is_id else ['-change', old_dep, new_dep]
211	        subprocess.check_call(['install_name_tool'] + cmd + [path_to_lib])
212	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:338:30
337	        os.makedirs(self.site_packages)
338	        sys_path = json.loads(subprocess.check_output([
339	            PYTHON, '-c', 'import sys, json; json.dump(sys.path, sys.stdout)']))
340	        paths = reversed(tuple(map(abspath, [x for x in sys_path if x.startswith('/') and not x.startswith('/Library/')])))

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:421:12
420	        size_in_mb = int(
421	            subprocess.check_output(['du', '-s', '-k', tdir]).decode('utf-8')
422	            .split()[0]) / 1024.

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:421:12
420	        size_in_mb = int(
421	            subprocess.check_output(['du', '-s', '-k', tdir]).decode('utf-8')
422	            .split()[0]) / 1024.

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:434:12
433	        with timeit() as times:
434	            subprocess.check_call(cmd + [dmg])
435	            if internet_enable:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:436:16
435	            if internet_enable:
436	                subprocess.check_call(
437	                    ['/usr/bin/hdiutil', 'internet-enable', '-yes', dmg])
438	        print('dmg created in %d minutes and %d seconds' % tuple(times))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docs\conf.py:12:0
11	import re
12	import subprocess
13	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docs\conf.py:214:20
213	    try:
214	        commit_id = subprocess.check_output(
215	            f'git rev-list --max-count=1 --skip=# {text}'.split()).decode('utf-8').strip()
216	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docs\conf.py:223:15
222	    set_classes(options)
223	    short_id = subprocess.check_output(
224	        f'git rev-list --max-count=1 --abbrev-commit --skip=# {commit_id}'.split()).decode('utf-8').strip()
225	    node = nodes.reference(rawtext, f'commit: {short_id}', refuri=url, **options)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\docs\conf.py:475:12
474	        if group.end_text:
475	            assert current_group is not None
476	            a(''), a(current_group.end_text)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docs\installer.py:16:0
15	import shutil
16	import subprocess
17	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docs\installer.py:55:10
54	    args = list(map(encode_for_subprocess, args))
55	    ret = subprocess.Popen(args).wait()
56	    if ret != 0:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\gen-apc-parsers.py:5:0
4	
5	import subprocess
6	from collections import defaultdict

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\gen-apc-parsers.py:247:4
246	        print(text, file=f)
247	    subprocess.check_call(['clang-format', '-i', path])
248	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\gen-apc-parsers.py:247:4
246	        print(text, file=f)
247	    subprocess.check_call(['clang-format', '-i', path])
248	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\gen-wcwidth.py:34:25
33	    bn = os.path.basename(url)
34	    local = os.path.join('/tmp', bn)
35	    if os.path.exists(local):

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\gen-wcwidth.py:39:15
38	    else:
39	        data = urlopen(url).read()
40	        with open(local, 'wb') as f:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\glad\generate.py:9:0
8	import shutil
9	import subprocess
10	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\glad\generate.py:27:4
26	
27	    subprocess.check_call(
28	        shlex.split(cmdline.format(dest='out'))
29	    )
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\collect.py:168:8
167	        data = data_for_path(path)
168	        assert isinstance(data, str)
169	        data = data.replace('\t', self.replace_tab_by)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\kittens\diff\collect.py:178:11
177	def hash_for_path(path: str) -> bytes:
178	    return md5(raw_data_for_path(path)).digest()
179	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\diff\main.py:8:0
7	import signal
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\main.py:70:16
69	            if not is_binary:
70	                assert changed_path is not None
71	                d.add_diff(path, changed_path)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\diff\main.py:596:20
595	                atexit.register(os.remove, tf.name)
596	                p = subprocess.Popen(['ssh', hostname, 'cat', rpath], stdout=tf)
597	                if p.wait() != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\diff\main.py:596:20
595	                atexit.register(os.remove, tf.name)
596	                p = subprocess.Popen(['ssh', hostname, 'cat', rpath], stdout=tf)
597	                if p.wait() != 0:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\diff\patch.py:9:0
8	import shutil
9	import subprocess
10	from typing import Dict, Iterator, List, Optional, Sequence, Tuple, Union

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\diff\patch.py:24:31
23	def find_differ() -> Optional[str]:
24	    if shutil.which('git') and subprocess.Popen(['git', '--help'], stderr=subprocess.DEVNULL, stdout=subprocess.DEVNULL).wait() == 0:
25	        return GIT_DIFF

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\diff\patch.py:24:31
23	def find_differ() -> Optional[str]:
24	    if shutil.which('git') and subprocess.Popen(['git', '--help'], stderr=subprocess.DEVNULL, stdout=subprocess.DEVNULL).wait() == 0:
25	        return GIT_DIFF

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\diff\patch.py:48:8
47	    path2 = os.path.realpath(file2)
48	    p = subprocess.Popen(
49	            cmd + [path1, path2],
50	            stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.DEVNULL)
51	    worker_processes.append(p.pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\patch.py:235:8
234	        executor = self.diff_executor
235	        assert executor is not None
236	        jobs = {executor.submit(run_diff, key, self.jmap[key], context): key for key in self.jobs}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\render.py:184:8
183	        filler = render_diff_line('', '', 'filler', margin_size, available_cols)
184	        assert other_path is not None
185	        yield filler + fl(other_path, added_format)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\render.py:520:20
519	                else:
520	                    assert other_path is not None
521	                    ans = lines_for_diff(path, other_path, diff_map[path], args, columns, margin_size)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\render.py:539:16
538	            elif item_type == 'rename':
539	                assert other_path is not None
540	                ans = yield_lines_from(rename_lines(path, other_path, args, columns, margin_size), item_ref)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\hints\main.py:426:8
425	        nonlocal idx, active_hyperlink_url, active_hyperlink_id, active_hyperlink_start_offset
426	        assert active_hyperlink_url is not None
427	        hyperlinks.append(Mark(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\kittens\hints\main.py:503:10
502	# CLI {{{
503	OPTIONS = r'''
504	--program
505	type=list
506	What program to use to open matched text. Defaults to the default open program
507	for the operating system. Use a value of :file:`-` to paste the match into the
508	terminal window instead. A value of :file:`@` will copy the match to the
509	clipboard. A value of :file:`*` will copy the match to the primary selection
510	(on systems that support primary selections). A value of :file:`default` will
511	run the default open program. Can be specified multiple times to run multiple
512	programs.
513	
514	
515	--type
516	default=url
517	choices=url,regex,path,line,hash,word,linenum,hyperlink,ip
518	The type of text to search for. A value of :code:`linenum` is special, it looks
519	for error messages using the pattern specified with :option:`--regex`, which
520	must have the named groups, :code:`path` and :code:`line`. If not specified,
521	will look for :code:`path:line`. The :option:`--linenum-action` option
522	controls where to display the selected error message, other options are ignored.
523	
524	
525	--regex
526	default={default_regex}
527	The regular expression to use when :option:`kitty +kitten hints --type`=regex.
528	The regular expression is in python syntax. If you specify a numbered group in
529	the regular expression only the group will be matched. This allow you to match
530	text ignoring a prefix/suffix, as needed. The default expression matches lines.
531	To match text over multiple lines you should prefix the regular expression with
532	:code:`(?ms)`, which turns on MULTILINE and DOTALL modes for the regex engine.
533	If you specify named groups and a :option:`kitty +kitten hints --program` then
534	the program will be passed arguments corresponding to each named group of
535	the form key=value.
536	
537	
538	--linenum-action
539	default=self
540	type=choice
541	choices=self,window,tab,os_window,background
542	Where to perform the action on matched errors. :code:`self` means the current
543	window, :code:`window` a new kitty window, :code:`tab` a new tab,
544	:code:`os_window` a new OS window and :code:`background` run in the background.
545	The action to perform on the matched errors. The actual action is whatever
546	arguments are provided to the kitten, for example: :code:`kitty + kitten hints
547	--type=linenum --linenum-action=tab vim +{line} {path}` will open the matched
548	path at the matched line number in vim in a new kitty tab.
549	
550	
551	--url-prefixes
552	default=default
553	Comma separated list of recognized URL prefixes. Defaults, to
554	the list of prefixes defined in kitty.conf.
555	
556	
557	--word-characters
558	Characters to consider as part of a word. In addition, all characters marked as
559	alphanumeric in the unicode database will be considered as word characters.
560	Defaults to the select_by_word_characters setting from kitty.conf.
561	
562	
563	--minimum-match-length
564	default=3
565	type=int
566	The minimum number of characters to consider a match.
567	
568	
569	--multiple
570	type=bool-set
571	Select multiple matches and perform the action on all of them together at the end.
572	In this mode, press :kbd:`Esc` to finish selecting.
573	
574	
575	--multiple-joiner
576	default=auto
577	String to use to join multiple selections when copying to the clipboard or
578	inserting into the terminal. The special strings: "space", "newline", "empty",
579	"json" and "auto" are interpreted as a space character, a newline an empty
580	joiner, a JSON serialized list and an automatic choice, based on the type of
581	text being selected. In addition, integers are interpreted as zero-based
582	indices into the list of selections. You can use 0 for the first selection and
583	-1 for the last.
584	
585	
586	--add-trailing-space
587	default=auto
588	choices=auto,always,never
589	Add trailing space after matched text. Defaults to auto, which adds the space
590	when used together with --multiple.
591	
592	
593	--hints-offset
594	default=1
595	type=int
596	The offset (from zero) at which to start hint numbering. Note that only numbers
597	greater than or equal to zero are respected.
598	
599	
600	--alphabet
601	The list of characters to use for hints. The default is to use numbers and lowercase
602	English alphabets. Specify your preference as a string of characters. Note that
603	unless you specify the hints offset as zero the first match will be highlighted with
604	the second character you specify.
605	
606	
607	--ascending
608	type=bool-set
609	Have the hints increase from top to bottom instead of decreasing from top to bottom.
610	
611	
612	--hints-foreground-color
613	default=black
614	type=str
615	The foreground color for hints
616	
617	
618	--hints-background-color
619	default=green
620	type=str
621	The background color for hints
622	
623	
624	--hints-text-color
625	default=gray
626	type=str
627	The foreground color for text pointed to by the hints
628	
629	
630	--customize-processing
631	Name of a python file in the kitty config directory which will be imported to provide
632	custom implementations for pattern finding and performing actions
633	on selected matches. See https://sw.kovidgoyal.net/kitty/kittens/hints.html
634	for details. You can also specify absolute paths to load the script from elsewhere.
635	
636	
637	--window-title
638	The window title for the hints window, default title is selected based on
639	the type of text being hinted.
640	'''.format(
641	    default_regex=DEFAULT_REGEX,

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\hints\main.py:700:8
699	    elif action == 'background':
700	        import subprocess
701	        subprocess.Popen(cmd)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\hints\main.py:701:8
700	        import subprocess
701	        subprocess.Popen(cmd)
702	    else:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\hyperlinked_grep\main.py:9:0
8	import socket
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kittens\hyperlinked_grep\main.py:25:8
24	    if not sys.stdout.isatty() and '--pretty' not in sys.argv:
25	        os.execlp('rg', 'rg', *sys.argv[1:])
26	    cmdline = ['rg', '--pretty', '--with-filename'] + sys.argv[1:]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\hyperlinked_grep\main.py:25:8
24	    if not sys.stdout.isatty() and '--pretty' not in sys.argv:
25	        os.execlp('rg', 'rg', *sys.argv[1:])
26	    cmdline = ['rg', '--pretty', '--with-filename'] + sys.argv[1:]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\hyperlinked_grep\main.py:27:8
26	    cmdline = ['rg', '--pretty', '--with-filename'] + sys.argv[1:]
27	    p = subprocess.Popen(cmdline, stdout=subprocess.PIPE)
28	    assert p.stdout is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\hyperlinked_grep\main.py:28:4
27	    p = subprocess.Popen(cmdline, stdout=subprocess.PIPE)
28	    assert p.stdout is not None
29	    write: Callable[[bytes], None] = cast(Callable[[bytes], None], sys.stdout.buffer.write)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\kittens\icat\main.py:379:24
378	                    with socket_timeout(30):
379	                        urlretrieve(item, filename=tf.name)
380	                except Exception as e:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\panel\main.py:7:0
6	import shutil
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\panel\main.py:60:13
59	    try:
60	        cp = subprocess.run(cmd_, stdout=subprocess.DEVNULL if silent else None)
61	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\remote_file\main.py:10:0
9	import shutil
10	import subprocess
11	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:125:8
124	    def __enter__(self) -> 'ControlMaster':
125	        subprocess.check_call(
126	            self.cmd_prefix + ['-o', 'ControlMaster=auto', '-fN', self.conn_data.hostname])
127	        subprocess.check_call(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:127:8
126	            self.cmd_prefix + ['-o', 'ControlMaster=auto', '-fN', self.conn_data.hostname])
127	        subprocess.check_call(
128	            self.batch_cmd_prefix + ['-O', 'check', self.conn_data.hostname])
129	        if not self.dest:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:135:8
134	    def __exit__(self, *a: Any) -> bool:
135	        subprocess.Popen(
136	            self.batch_cmd_prefix + ['-O', 'exit', self.conn_data.hostname],
137	            stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL
138	        ).wait()
139	        if self.tdir:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:145:15
144	    def is_alive(self) -> bool:
145	        return subprocess.Popen(
146	            self.batch_cmd_prefix + ['-O', 'check', self.conn_data.hostname],
147	            stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL
148	        ).wait() == 0
149	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:151:13
150	    def check_hostname_matches(self) -> bool:
151	        cp = subprocess.run(self.batch_cmd_prefix + [self.conn_data.hostname, 'hostname', '-f'], stdout=subprocess.PIPE,
152	                            stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL)
153	        if cp.returncode == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:179:19
178	        with open(self.dest, 'wb') as f:
179	            return subprocess.run(
180	                self.batch_cmd_prefix + [self.conn_data.hostname, 'cat', self.remote_path],
181	                stdout=f, stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL
182	            ).returncode == 0
183	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:191:19
190	        with open(self.dest, 'rb') as f:
191	            return subprocess.run(cmd, stdout=redirect, stderr=redirect, stdin=f).returncode == 0
192	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:298:29
297	            editor = get_editor()
298	            editor_process = subprocess.Popen(editor + [master.dest])
299	            while editor_process.poll() is None:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\kittens\runner.py:38:8
37	        g = {'__name__': 'kitten'}
38	        exec(code, g)
39	        hr = g.get('handle_result', lambda *a, **kw: None)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\ssh\main.py:8:0
7	import shlex
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\ssh\main.py:52:13
51	    boolean_ssh_args: List[str] = []
52	    stderr = subprocess.Popen(['ssh'], stderr=subprocess.PIPE).stderr
53	    assert stderr is not None

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\main.py:52:13
51	    boolean_ssh_args: List[str] = []
52	    stderr = subprocess.Popen(['ssh'], stderr=subprocess.PIPE).stderr
53	    assert stderr is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\ssh\main.py:53:4
52	    stderr = subprocess.Popen(['ssh'], stderr=subprocess.PIPE).stderr
53	    assert stderr is not None
54	    raw = stderr.read().decode('utf-8')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\ssh\main.py:158:19
157	    else:
158	        terminfo = subprocess.check_output(['infocmp']).decode('utf-8')
159	        sh_script = SHELL_SCRIPT.replace('TERMINFO', terminfo, 1)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\main.py:158:19
157	    else:
158	        terminfo = subprocess.check_output(['infocmp']).decode('utf-8')
159	        sh_script = SHELL_SCRIPT.replace('TERMINFO', terminfo, 1)

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kittens\ssh\main.py:167:4
166	        cmd = ['ssh'] + ssh_args + ['-t', server_args[0], sh_script] + server_args[1:]
167	    os.execvp('ssh', cmd)
168	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\ssh\main.py:167:4
166	        cmd = ['ssh'] + ssh_args + ['-t', server_args[0], sh_script] + server_args[1:]
167	    os.execvp('ssh', cmd)
168	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\tui\handler.py:41:8
40	    def image_manager(self) -> ImageManagerType:
41	        assert self._image_manager is not None
42	        return self._image_manager

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\tui\images.py:62:4
61	def run_imagemagick(path: str, cmd: Sequence[str], keep_stdout: bool = True) -> CompletedProcess:
62	    import subprocess
63	    try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\tui\images.py:64:12
63	    try:
64	        p = subprocess.run(cmd, stdout=subprocess.PIPE if keep_stdout else subprocess.DEVNULL, stderr=subprocess.PIPE)
65	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kittens\tui\loop.py:264:16
263	                    name, val = parts[0], unhexlify(parts[1]).decode('utf-8', 'replace')
264	                except Exception:
265	                    continue
266	                self.handler.on_capability_response(name, val)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\tui\loop.py:275:16
274	                    ev = decode_sgr_mouse(csi[1:])
275	                except Exception:
276	                    pass
277	                else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\tui\loop.py:303:12
302	                k = decode_key_event(apc)
303	            except Exception:
304	                pass
305	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\tui\operations.py:329:16
328	                x = to_color(which)
329	                assert x is not None
330	                q = color_as_sharp(x)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\unicode_input\main.py:7:0
6	import string
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\unicode_input\main.py:113:8
112	            code = int(code_text, 16)
113	        except Exception:
114	            pass
115	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\unicode_input\main.py:437:12
436	                val = int(self.line_edit.current_input, 16)
437	            except Exception:
438	                pass
439	            else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\unicode_input\main.py:507:16
506	        with self.suspend():
507	            p = subprocess.Popen(get_editor() + [favorites_path])
508	            if p.wait() == 0:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:327:8
326	    def add_child(self, window: Window) -> None:
327	        assert window.child.pid is not None and window.child.child_fd is not None
328	        self.child_monitor.add_child(window.id, window.child.pid, window.child.child_fd, window.screen)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kitty\boss.py:347:12
346	                no_response = json.loads(cmd).get('no_response')
347	            except Exception:
348	                pass
349	            if not no_response:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:812:8
811	            return
812	        assert tm is not None
813	        self._run_kitten('ask', ['--type=yesno', '--message', _(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\boss.py:1181:8
1180	    ) -> None:
1181	        import subprocess
1182	        if cwd_from:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\boss.py:1189:16
1188	            try:
1189	                subprocess.Popen(cmd, env=env, stdin=r, cwd=cwd)
1190	            except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\boss.py:1197:12
1196	        else:
1197	            subprocess.Popen(cmd, env=env, cwd=cwd)
1198	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:1371:16
1370	            try:
1371	                assert update_check_process.stdout is not None
1372	                raw = update_check_process.stdout.read().decode('utf-8')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:1386:12
1385	        if activated:
1386	            assert isinstance(b, str)
1387	            dbus_notification_activated(a, b)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:1389:12
1388	        else:
1389	            assert isinstance(b, int)
1390	            dbus_notification_created(a, b)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:1431:20
1430	                    q = self.active_tab_manager
1431	                    assert q is not None
1432	                    tm = q

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\child.py:59:12
58	                pid = int(x)
59	            except Exception:
60	                continue
61	            try:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\child.py:68:12
67	                q = int(raw.split(' ', 5)[4])
68	            except Exception:
69	                continue
70	            ans[q].append(pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:300:12
299	        try:
300	            assert self.pid is not None
301	            return cmdline_of_process(self.pid) or list(self.argv)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:308:12
307	        try:
308	            assert self.pid_for_cwd is not None
309	            return cmdline_of_process(self.pid_for_cwd) or self.cmdline

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:316:12
315	        try:
316	            assert self.pid is not None
317	            return environ_of_process(self.pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:324:12
323	        with suppress(Exception):
324	            assert self.pid is not None
325	            return cwd_of_process(self.pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:330:12
329	        with suppress(Exception):
330	            assert self.child_fd is not None
331	            pgrp = os.tcgetpgrp(self.child_fd)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:340:12
339	        with suppress(Exception):
340	            assert self.pid_for_cwd is not None
341	            return cwd_of_process(self.pid_for_cwd) or None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:346:12
345	        try:
346	            assert self.pid_for_cwd is not None
347	            return environ_of_process(self.pid_for_cwd)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:350:16
349	            try:
350	                assert self.pid is not None
351	                return environ_of_process(self.pid)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kitty\child.py:352:12
351	                return environ_of_process(self.pid)
352	            except Exception:
353	                pass
354	        return {}

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\kitty\cli.py:182:56
181	                    elif k == 'condition':
182	                        current_cmd['condition'] = bool(eval(v))
183	        elif state is HELP:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\cli.py:330:12
329	        if print_help_for_seq.allow_pager and sys.stdout.isatty():
330	            import subprocess
331	            p = subprocess.Popen(['less', '-isRXF'], stdin=subprocess.PIPE)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\cli.py:331:16
330	            import subprocess
331	            p = subprocess.Popen(['less', '-isRXF'], stdin=subprocess.PIPE)
332	            try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\cli.py:331:16
330	            import subprocess
331	            p = subprocess.Popen(['less', '-isRXF'], stdin=subprocess.PIPE)
332	            try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\cli.py:843:12
842	        if is_macos:
843	            import subprocess
844	            print(' '.join(subprocess.check_output(['sw_vers']).decode('utf-8').splitlines()).strip())

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\cli.py:844:27
843	            import subprocess
844	            print(' '.join(subprocess.check_output(['sw_vers']).decode('utf-8').splitlines()).strip())
845	        if os.path.exists('/etc/issue'):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\cli.py:844:27
843	            import subprocess
844	            print(' '.join(subprocess.check_output(['sw_vers']).decode('utf-8').splitlines()).strip())
845	        if os.path.exists('/etc/issue'):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\cli_stub.py:79:4
78	if __name__ == '__main__':
79	    import subprocess
80	    subprocess.Popen([

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\cli_stub.py:80:4
79	    import subprocess
80	    subprocess.Popen([
81	        'kitty', '+runpy',
82	        'from kitty.cli_stub import generate_stub; generate_stub()'
83	    ])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\cli_stub.py:80:4
79	    import subprocess
80	    subprocess.Popen([
81	        'kitty', '+runpy',
82	        'from kitty.cli_stub import generate_stub; generate_stub()'
83	    ])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\config.py:446:16
445	            else:
446	                assert key is not None
447	                key_definitions.append(KeyDefinition(False, paction, mods, is_native, key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\fonts\box_drawing.py:1038:12
1037	            height *= len(rows)
1038	            assert len(rgb_data) == width * height * 4, '{} != {}'.format(len(rgb_data), width * height * 4)
1039	            display_bitmap(rgb_data, width, height)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\fonts\render.py:437:4
436	        f.write(rgb_data)
437	    assert len(rgb_data) == 4 * width * height
438	    show(f.name, width, height, 0, 32, align='left')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\key_encoding.py:422:4
421	    import re
422	    import subprocess
423	    keys = {a for a in dir(defines) if a.startswith('GLFW_KEY_')}

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\key_encoding.py:451:4
450	        f.write(nraw)
451	    subprocess.check_call(['yapf', '-i', __file__])
452	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\key_encoding.py:451:4
450	        f.write(nraw)
451	    subprocess.check_call(['yapf', '-i', __file__])
452	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\keys.py:263:12
262	                x = SHIFTED_KEYS.get(key, x)
263	            assert x is not None
264	            data.extend(x)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\base.py:110:4
109	    cells_map = calculate_cells_map(bias, number_of_windows, number_of_cells)
110	    assert sum(cells_map) == number_of_cells
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\base.py:216:8
215	        self.layout_opts = self.parse_layout_opts(layout_opts)
216	        assert self.name is not None
217	        self.full_name = self.name + ((':' + layout_opts) if layout_opts else '')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\base.py:258:8
257	        w = all_windows.active_window
258	        assert w is not None
259	        return self.neighbors_for_window(w, all_windows)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\grid.py:254:8
253	        wg = all_windows.group_for_window(window)
254	        assert wg is not None
255	        ncols, nrows, special_rows, special_col = calc_grid_size(n)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\splits.py:139:8
138	            self.one = pair = Pair(horizontal=self.horizontal)
139	        assert isinstance(window_to_be_split, int)
140	        pair.balanced_add(window_to_be_split)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\splits.py:460:12
459	            ag = all_windows.active_group
460	            assert ag is not None
461	            group_id = ag.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\splits.py:511:8
510	        wg = all_windows.group_for_window(window)
511	        assert wg is not None
512	        pair = self.pairs_root.pair_for_window(wg.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\tall.py:29:4
28	    wg = all_windows.group_for_window(window)
29	    assert wg is not None
30	    groups = tuple(all_windows.iter_all_layoutable_groups())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\vertical.py:124:8
123	        wg = all_windows.group_for_window(window)
124	        assert wg is not None
125	        groups = tuple(all_windows.iter_all_layoutable_groups())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\main.py:75:4
74	    sdata = json.dumps(data, ensure_ascii=False).encode('utf-8')
75	    assert single_instance.socket is not None
76	    single_instance.socket.sendall(sdata)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\main.py:82:8
81	    if args.wait_for_single_instance_window_close:
82	        assert notify_socket is not None
83	        conn = notify_socket.accept()[0]

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:186:23
185	    if do_profile:
186	        start_profiler('/tmp/kitty-profile.log')
187	    yield

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\main.py:189:8
188	    if do_profile:
189	        import subprocess
190	        stop_profiler()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:192:13
191	        exe = kitty_exe()
192	        cg = '/tmp/kitty-profile.callgrind'
193	        print('Post processing profile data for', exe, '...')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\main.py:195:12
194	        with open(cg, 'wb') as f:
195	            subprocess.call(['pprof', '--callgrind', exe, '/tmp/kitty-profile.log'], stdout=f)
196	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\main.py:195:12
194	        with open(cg, 'wb') as f:
195	            subprocess.call(['pprof', '--callgrind', exe, '/tmp/kitty-profile.log'], stdout=f)
196	        try:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:195:58
194	        with open(cg, 'wb') as f:
195	            subprocess.call(['pprof', '--callgrind', exe, '/tmp/kitty-profile.log'], stdout=f)
196	        try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\main.py:197:12
196	        try:
197	            subprocess.Popen(['kcachegrind', cg])
198	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\main.py:197:12
196	        try:
197	            subprocess.Popen(['kcachegrind', cg])
198	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\main.py:199:12
198	        except FileNotFoundError:
199	            subprocess.call(['pprof', '--text', exe, '/tmp/kitty-profile.log'])
200	            print('To view the graphical call data, use: kcachegrind', cg)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\main.py:199:12
198	        except FileNotFoundError:
199	            subprocess.call(['pprof', '--text', exe, '/tmp/kitty-profile.log'])
200	            print('To view the graphical call data, use: kcachegrind', cg)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:199:53
198	        except FileNotFoundError:
199	            subprocess.call(['pprof', '--text', exe, '/tmp/kitty-profile.log'])
200	            print('To view the graphical call data, use: kcachegrind', cg)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\marks.py:84:8
83	    if ftype == 'regex':
84	        assert not isinstance(spec, str)
85	        if len(spec) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\marks.py:90:8
89	        import runpy
90	        assert isinstance(spec, str)
91	        path = spec

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\multiprocessing.py:63:8
62	        x = q.get(timeout=2)
63	        assert x == 'hello'
64	        p.join()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\options_stub.py:47:4
46	if __name__ == '__main__':
47	    import subprocess
48	    subprocess.Popen([

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\options_stub.py:48:4
47	    import subprocess
48	    subprocess.Popen([
49	        'kitty', '+runpy',
50	        'from kitty.options_stub import generate_stub; generate_stub()'
51	    ])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\options_stub.py:48:4
47	    import subprocess
48	    subprocess.Popen([
49	        'kitty', '+runpy',
50	        'from kitty.options_stub import generate_stub; generate_stub()'
51	    ])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\rc\set_background_image.py:100:16
99	            if data:
100	                assert set_background_image.current_file_obj is not None
101	                set_background_image.current_file_obj.write(standard_b64decode(data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\rc\set_background_image.py:110:12
109	        else:
110	            assert set_background_image.current_file_obj is not None
111	            f = set_background_image.current_file_obj

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\remote_control.py:125:12
124	        def send_generator() -> Generator[bytes, None, None]:
125	            assert payload is not None
126	            for chunk in payload:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\kitty\tab_bar.py:86:16
85	        }
86	        title = eval(compile_template(template), {'__builtins__': {}}, eval_locals)
87	    except Exception as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\tabs.py:516:12
515	        else:
516	            assert old_active_tab is not None
517	            add_active_id_to_history(self.active_tab_history, old_active_tab.id)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\update_check.py:6:0
5	import os
6	import subprocess
7	import time

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\kitty\update_check.py:50:14
49	    try:
50	        raw = urlopen(RELEASED_VERSION_URL).read().decode('utf-8').strip()
51	    except Exception:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\update_check.py:71:16
70	                    n = parse_line(line)
71	                except Exception:
72	                    continue
73	                notified_versions[n.version] = n

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty\update_check.py:109:15
108	    import random
109	    time.sleep(random.randint(1000, 4000) / 1000)
110	    with suppress(BrokenPipeError):  # happens if parent process is killed before us

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\update_check.py:116:12
115	    try:
116	        p = subprocess.Popen([
117	            kitty_exe(), '+runpy',
118	            'from kitty.update_check import run_worker; run_worker()'
119	        ], stdout=subprocess.PIPE)
120	    except OSError as e:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\utils.py:113:8
112	                    yield c, r << 16 | g << 8 | b
113	        except Exception:
114	            continue
115	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:210:4
209	def open_cmd(cmd: Union[Iterable[str], List[str]], arg: Union[None, Iterable[str], str] = None, cwd: Optional[str] = None) -> PopenType:
210	    import subprocess
211	    if arg is not None:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:217:11
216	            cmd.extend(arg)
217	    return subprocess.Popen(tuple(cmd), stdin=subprocess.DEVNULL, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, cwd=cwd or None)
218	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\utils.py:489:41
488	    path = abspath(path)
489	    candidates = frozenset(map(abspath, ('/tmp', '/dev/shm', os.environ.get('TMPDIR', None), tempfile.gettempdir())))
490	    for q in candidates:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\utils.py:489:49
488	    path = abspath(path)
489	    candidates = frozenset(map(abspath, ('/tmp', '/dev/shm', os.environ.get('TMPDIR', None), tempfile.gettempdir())))
490	    for q in candidates:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:520:8
519	        setattr(read_shell_environment, 'ans', ans)
520	        import subprocess
521	        shell = resolved_shell(opts)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:525:16
524	        try:
525	            p = subprocess.Popen(shell + ['-l', '-c', 'env'], stdout=slave, stdin=slave, stderr=slave, start_new_session=True, close_fds=True)
526	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:531:12
530	            raw = b''
531	            from subprocess import TimeoutExpired
532	            from time import monotonic

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kitty\utils.py:587:4
586	    editor = get_editor()
587	    os.execvp(editor[0], editor + [p])
588	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\window.py:418:12
417	        if field == 'env':
418	            assert isinstance(pat, tuple)
419	            key_pat, val_pat = pat

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\window.py:425:8
424	            return False
425	        assert not isinstance(pat, tuple)
426	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\window.py:611:12
610	            import shlex
611	            import subprocess
612	            env = self.child.final_env

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\window.py:614:12
613	            env['KITTY_CHILD_CMDLINE'] = ' '.join(map(shlex.quote, self.child.cmdline))
614	            subprocess.Popen(self.opts.command_on_bell, env=env, cwd=self.child.foreground_cwd)
615	        if not self.is_active:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\window.py:700:20
699	                        y = int(x)
700	                    except Exception:
701	                        continue
702	                    if 0 <= y <= 255:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\bench_scrollback.py:23:10
22	
23	    rng = Random()
24	    rng.seed(args.seed)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:89:17
88	        def random_word():
89	            sz = random.randint(2, 10)
90	            return ''.join(random.choice(alphabet) for x in range(sz))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:90:27
89	            sz = random.randint(2, 10)
90	            return ''.join(random.choice(alphabet) for x in range(sz))
91	        words = [random_word() for i in range(400)]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:94:18
93	        def random_item():
94	            num = random.randint(2, 7)
95	            return '/'.join(random.choice(words) for w in range(num))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:95:28
94	            num = random.randint(2, 7)
95	            return '/'.join(random.choice(words) for w in range(num))
96	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty_tests\datatypes.py:412:23
411	
412	        for prefix in ('/tmp', tempfile.gettempdir()):
413	            for path in ('a.png', 'x/b.jpg', 'y/../c.jpg'):

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty_tests\datatypes.py:415:39
414	                self.assertTrue(is_path_in_temp_dir(os.path.join(prefix, path)))
415	        for path in ('/home/xy/d.png', '/tmp/../home/x.jpg'):
416	            self.assertFalse(is_path_in_temp_dir(os.path.join(path)))

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty_tests\open_actions.py:55:69
54	
55	        single('file://hostname/tmp/moo.txt#23', 'launch', 'editor', '/tmp/moo.txt', '23')
56	        single('some thing.txt', 'ignored')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\logo\make.py:6:0
5	import os
6	import subprocess
7	import shutil

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\logo\make.py:19:8
18	    try:
19	        subprocess.check_call(args)
20	    except OSError:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\publish.py:14:0
13	import shutil
14	import subprocess
15	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:43:10
42	        q = list(cmd)
43	    ret = subprocess.Popen(q, cwd=cwd).wait()
44	    if ret != 0:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:92:4
91	def run_docs(args: Any) -> None:
92	    subprocess.check_call(['make', 'docs'])
93	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:92:4
91	def run_docs(args: Any) -> None:
92	    subprocess.check_call(['make', 'docs'])
93	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:104:4
103	    installer = os.path.join(docs_dir, 'installer.py')
104	    subprocess.check_call([
105	        'python3', '-c', f"import runpy; runpy.run_path('{installer}', run_name='update_wrapper')",
106	        os.path.join(publish_dir, 'installer.sh')])
107	    os.chdir(os.path.dirname(publish_dir))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:104:4
103	    installer = os.path.join(docs_dir, 'installer.py')
104	    subprocess.check_call([
105	        'python3', '-c', f"import runpy; runpy.run_path('{installer}', run_name='update_wrapper')",
106	        os.path.join(publish_dir, 'installer.sh')])
107	    os.chdir(os.path.dirname(publish_dir))

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:108:4
107	    os.chdir(os.path.dirname(publish_dir))
108	    subprocess.check_call(['git', 'add', 'kitty'])
109	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:108:4
107	    os.chdir(os.path.dirname(publish_dir))
108	    subprocess.check_call(['git', 'add', 'kitty'])
109	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:109:4
108	    subprocess.check_call(['git', 'add', 'kitty'])
109	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
110	    subprocess.check_call(['git', 'push'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:109:4
108	    subprocess.check_call(['git', 'add', 'kitty'])
109	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
110	    subprocess.check_call(['git', 'push'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:110:4
109	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
110	    subprocess.check_call(['git', 'push'])
111	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:110:4
109	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
110	    subprocess.check_call(['git', 'push'])
111	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\publish.py:117:8
116	        os.mkdir(base)
117	        subprocess.check_call('git archive HEAD | tar -x -C ' + base, shell=True)
118	        dest = os.path.join(base, 'docs', '_build')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:123:8
122	        dest = os.path.abspath(os.path.join('build', f'kitty-{version}.tar'))
123	        subprocess.check_call(['tar', '-cf', dest, os.path.basename(base)], cwd=tdir)
124	        with suppress(FileNotFoundError):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:123:8
122	        dest = os.path.abspath(os.path.join('build', f'kitty-{version}.tar'))
123	        subprocess.check_call(['tar', '-cf', dest, os.path.basename(base)], cwd=tdir)
124	        with suppress(FileNotFoundError):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:126:8
125	            os.remove(dest + '.xz')
126	        subprocess.check_call(['xz', '-9', dest])
127	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:126:8
125	            os.remove(dest + '.xz')
126	        subprocess.check_call(['xz', '-9', dest])
127	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:352:8
351	def require_git_master(branch: str = 'master') -> None:
352	    b = subprocess.check_output(['git', 'symbolic-ref', '--short', 'HEAD']).decode('utf-8').strip()
353	    if b != branch:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:352:8
351	def require_git_master(branch: str = 'master') -> None:
352	    b = subprocess.check_output(['git', 'symbolic-ref', '--short', 'HEAD']).decode('utf-8').strip()
353	    if b != branch:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup.py:13:0
12	import shutil
13	import subprocess
14	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:105:20
104	                shlex.split(
105	                    subprocess.check_output([PKGCONFIG, pkg] + list(args))
106	                    .decode('utf-8')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:116:7
115	    q = '{}.{}'.format(major, minor)
116	    if subprocess.run([PKGCONFIG, package, '--atleast-version=' + q]
117	                      ).returncode != 0:
118	        qmajor = qminor = 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:120:18
119	        try:
120	            ver = subprocess.check_output([PKGCONFIG, package, '--modversion']
121	                                          ).decode('utf-8').strip()
122	            m = re.match(r'(\d+).(\d+)', ver)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:148:10
147	                cc = 'cc'
148	    raw = subprocess.check_output([cc, '-dumpversion']).decode('utf-8')
149	    ver_ = raw.strip().split('.')[:2]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:216:8
215	    src = src or 'int main(void) { return 0; }'
216	    p = subprocess.Popen(
217	        [cc] + list(cflags) + ['-x', lang, '-o', os.devnull, '-'],
218	        stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, stdin=subprocess.PIPE,
219	    )
220	    stdin = p.stdin

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\setup.py:221:4
220	    stdin = p.stdin
221	    assert stdin is not None
222	    try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\setup.py:309:8
308	    if egl_library is not None:
309	        assert('"' not in egl_library)
310	        library_paths['glfw/egl_context.c'] = ['_GLFW_EGL_LIBRARY="' + egl_library + '"']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\setup.py:314:8
313	    if startup_notification_library is not None:
314	        assert('"' not in startup_notification_library)
315	        desktop_libs = ['_KITTY_STARTUP_NOTIFICATION_LIBRARY="' + startup_notification_library + '"']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\setup.py:318:8
317	    if canberra_library is not None:
318	        assert('"' not in canberra_library)
319	        desktop_libs += ['_KITTY_CANBERRA_LIBRARY="' + canberra_library + '"']

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:388:8
387	    print(desc or ' '.join(cmd))
388	    p = subprocess.Popen(cmd)
389	    ret = p.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup.py:400:18
399	        try:
400	            rev = subprocess.check_output(['git', 'rev-parse', 'HEAD']).decode('utf-8')
401	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:400:18
399	        try:
400	            rev = subprocess.check_output(['git', 'rev-parse', 'HEAD']).decode('utf-8')
401	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:504:16
503	            printed = True
504	            w = subprocess.Popen(compile_cmd.cmd, stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)
505	            workers[w.pid] = compile_cmd, w

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup.py:946:8
945	    try:
946	        subprocess.check_call([
947	            'iconutil', '-c', 'icns', iconset_dir, '-o', icns_dir
948	        ])
949	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:946:8
945	    try:
946	        subprocess.check_call([
947	            'iconutil', '-c', 'icns', iconset_dir, '-o', icns_dir
948	        ])
949	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:951:8
950	        print(error('iconutil not found') + ', using png2icns (without retina support) to convert the logo', file=sys.stderr)
951	        subprocess.check_call([
952	            'png2icns', icns_dir
953	        ] + [os.path.join(iconset_dir, logo) for logo in [
954	            # png2icns does not support retina icons, so only pass the non-retina icons
955	            'icon_16x16.png',
956	            'icon_32x32.png',
957	            'icon_128x128.png',
958	            'icon_256x256.png',
959	            'icon_512x512.png',
960	        ]])
961	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\setup.py:1187:8
1186	    if args.action == 'test':
1187	        os.execlp(
1188	            sys.executable, sys.executable, 'test.py'
1189	        )
1190	    if args.action == 'clean':

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1226:12
1225	            dest = ['download.calibre-ebook.com:/srv/download/ci/kitty']
1226	            subprocess.check_call(cmd + ['linux'] + dest)
1227	            subprocess.check_call(cmd + ['macos'] + dest)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1227:12
1226	            subprocess.check_call(cmd + ['linux'] + dest)
1227	            subprocess.check_call(cmd + ['macos'] + dest)
1228	            subprocess.check_call(cmd + ['linux', '32'] + dest)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1228:12
1227	            subprocess.check_call(cmd + ['macos'] + dest)
1228	            subprocess.check_call(cmd + ['linux', '32'] + dest)
1229	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\test.py:77:4
76	    generate_stub()
77	    os.execlp(sys.executable, 'python', '-m', 'mypy', '--pretty')
78	

--------------------------------------------------

Code scanned:
	Total lines of code: 29562
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 214
		Medium: 20
		High: 3
	Total issues (by confidence):
		Undefined: 0
		Low: 1
		Medium: 16
		High: 220
Files skipped (0):
