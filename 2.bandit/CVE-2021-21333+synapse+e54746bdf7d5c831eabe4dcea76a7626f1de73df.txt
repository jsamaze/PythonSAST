Working... ---------------------------------------- 100% 0:00:16
Run started:2024-02-10 21:55:51.441503

Test results:
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'postgres'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\.buildkite\scripts\create_postgres_db.py:30:14
29	    # doesn't exist yet.
30	    db_conn = db_engine.module.connect(
31	        user="postgres", host="postgres", password="postgres", dbname="postgres"
32	    )
33	    db_conn.autocommit = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'END'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\console.py:63:34
62	        self.path_prefix = "/_matrix/client/api/v1"
63	        self.event_stream_token = "END"
64	        self.prompt = ">>> "

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:585:12
584	                args["path"] = parsed_url.path
585	            except Exception:
586	                pass
587	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:774:12
773	                http_client.verbose = "on" == syn_cmd.config["verbose"]
774	            except Exception:
775	                pass
776	            print("Loaded config from %s" % config_path)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:777:4
776	            print("Loaded config from %s" % config_path)
777	    except Exception:
778	        pass
779	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '[REDACTED]'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\http.py:139:30
138	                temp = producer.data["password"]
139	                producer.data["password"] = "[REDACTED]"
140	                print(json.dumps(producer.data, indent=4))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:14:0
13	import json
14	import subprocess
15	import time

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:21:15
20	
21	ACCESS_TOKEN = ""
22	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:166:12
165	        print("sdp from matrix client", answer)
166	        p = subprocess.Popen(
167	            ["node", "unjingle/unjingle.js", "--sdp"],
168	            stdin=subprocess.PIPE,
169	            stdout=subprocess.PIPE,
170	        )
171	        jingle, out_err = p.communicate(answer)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:166:12
165	        print("sdp from matrix client", answer)
166	        p = subprocess.Popen(
167	            ["node", "unjingle/unjingle.js", "--sdp"],
168	            stdin=subprocess.PIPE,
169	            stdout=subprocess.PIPE,
170	        )
171	        jingle, out_err = p.communicate(answer)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:279:12
278	        self.callsid = jingle["sid"]
279	        p = subprocess.Popen(
280	            ["node", "unjingle/unjingle.js", "--jingle"],
281	            stdin=subprocess.PIPE,
282	            stdout=subprocess.PIPE,
283	        )
284	        print("raw jingle invite", str(jingle))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:279:12
278	        self.callsid = jingle["sid"]
279	        p = subprocess.Popen(
280	            ["node", "unjingle/unjingle.js", "--jingle"],
281	            stdin=subprocess.PIPE,
282	            stdout=subprocess.PIPE,
283	        )
284	        print("raw jingle invite", str(jingle))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib\scripts\kick_users.py:28:10
27	    print("Getting room state => %s" % room_state_url)
28	    res = requests.get(room_state_url)
29	    print("HTTP %s" % res.status_code)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib\scripts\kick_users.py:67:18
66	            print("Kicking %s" % uid)
67	            res = requests.put(kick_url, data=json.dumps(kick_body))
68	            if res.status_code != 200:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docker\start.py:6:0
5	import os
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:122:8
121	    if ownership is not None:
122	        subprocess.check_output(["chown", "-R", ownership, "/data"])
123	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:122:8
121	    if ownership is not None:
122	        subprocess.check_output(["chown", "-R", ownership, "/data"])
123	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:125:4
124	
125	    subprocess.check_output(args)
126	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:173:8
172	        # make sure that synapse has perms to write to the data dir.
173	        subprocess.check_output(["chown", ownership, data_dir])
174	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:173:8
172	        # make sure that synapse has perms to write to the data dir.
173	        subprocess.check_output(["chown", ownership, data_dir])
174	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:176:8
175	        args = ["gosu", ownership] + args
176	        os.execv("/usr/sbin/gosu", args)
177	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:178:8
177	    else:
178	        os.execv("/usr/local/bin/python", args)
179	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:251:8
250	        args = ["gosu", ownership] + args
251	        os.execv("/usr/sbin/gosu", args)
252	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:253:8
252	    else:
253	        os.execv("/usr/local/bin/python", args)
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\convert_server_keys.py:81:4
80	    database = config["database"]
81	    assert database["name"] == "psycopg2", "Can only convert for postgresql"
82	    args = database["args"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\federation_client.py:297:19
296	        try:
297	            resp = requests.get(uri)
298	            if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\scripts-dev\tail-synapse.py:36:8
35	        requests.get(
36	            server + "/_synapse/replication", verify=False, params=streams
37	        ).content
38	    )
39	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\tail-synapse.py:35:8
34	    return parse_response(
35	        requests.get(
36	            server + "/_synapse/replication", verify=False, params=streams
37	        ).content
38	    )

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\setup.py:80:4
79	    code = read_file(path_segments)
80	    exec(code, result)
81	    return result

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:43:8
42	    # Get the nonce
43	    r = requests.get(url, verify=False)
44	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:43:8
42	    # Get the nonce
43	    r = requests.get(url, verify=False)
44	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:50:12
49	                _print(r.json()["error"])
50	            except Exception:
51	                pass
52	        return exit(1)

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:81:8
80	    _print("Sending registration request...")
81	    r = requests.post(url, json=data, verify=False)
82	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:81:8
80	    _print("Sending registration request...")
81	    r = requests.post(url, json=data, verify=False)
82	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:88:12
87	                _print(r.json()["error"])
88	            except Exception:
89	                pass
90	        return exit(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth_blocking.py:104:12
103	        if self._limit_usage_by_mau is True:
104	            assert not (user_id and threepid)
105	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\constants.py:59:15
58	class LoginType:
59	    PASSWORD = "m.login.password"
60	    EMAIL_IDENTITY = "m.login.email.identity"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_MISSING_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:46:20
45	    NOT_FOUND = "M_NOT_FOUND"
46	    MISSING_TOKEN = "M_MISSING_TOKEN"
47	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_UNKNOWN_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:47:20
46	    MISSING_TOKEN = "M_MISSING_TOKEN"
47	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"
48	    GUEST_ACCESS_FORBIDDEN = "M_GUEST_ACCESS_FORBIDDEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_TOO_SHORT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:69:25
68	    EXPIRED_ACCOUNT = "ORG_MATRIX_EXPIRED_ACCOUNT"
69	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
70	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_DIGIT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:70:24
69	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
70	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
71	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_UPPERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:71:28
70	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
71	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
72	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_LOWERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:72:28
71	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
72	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
73	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_SYMBOL'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:73:25
72	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
73	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
74	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_IN_DICTIONARY'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:74:29
73	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
74	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
75	    WEAK_PASSWORD = "M_WEAK_PASSWORD"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_WEAK_PASSWORD'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:75:20
74	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
75	    WEAK_PASSWORD = "M_WEAK_PASSWORD"
76	    INVALID_SIGNATURE = "M_INVALID_SIGNATURE"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\app\__init__.py:46:18
45	    """
46	    if address == "0.0.0.0" and "::" in bind_addresses:
47	        logger.warning(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\admin_cmd.py:194:8
193	    if config.worker_app is not None:
194	        assert config.worker_app == "synapse.app.admin_cmd"
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:503:8
502	
503	        assert listener_config.http_options is not None
504	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\generic_worker.py:627:20
626	                    listener.port,
627	                    manhole(
628	                        username="matrix", password="rabbithole", globals={"hs": self}
629	                    ),
630	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:893:4
892	    # For backwards compatibility let any of the old app names.
893	    assert config.worker_app in (
894	        "synapse.app.appservice",
895	        "synapse.app.client_reader",
896	        "synapse.app.event_creator",
897	        "synapse.app.federation_reader",
898	        "synapse.app.federation_sender",
899	        "synapse.app.frontend_proxy",
900	        "synapse.app.generic_worker",
901	        "synapse.app.media_repository",
902	        "synapse.app.pusher",
903	        "synapse.app.synchrotron",
904	        "synapse.app.user_dir",
905	    )
906	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\homeserver.py:306:20
305	                    listener.port,
306	                    manhole(
307	                        username="matrix", password="rabbithole", globals={"hs": self}
308	                    ),
309	                )

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\synapse\app\homeserver.py:489:20
488	                profile.dump_stats(
489	                    "/tmp/%s.%s.%i.pstat" % (hs.hostname, func.__name__, ident)
490	                )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:316:18
315	        dict_copy = self.__dict__.copy()
316	        dict_copy["token"] = "<redacted>"
317	        dict_copy["hs_token"] = "<redacted>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:317:18
316	        dict_copy["token"] = "<redacted>"
317	        dict_copy["hs_token"] = "<redacted>"
318	        return "ApplicationService: %s" % (dict_copy,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:141:8
140	        # running.
141	        assert service.id not in self.requests_in_flight
142	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:235:8
234	        logger.info("Starting recoverer for AS ID %s", service.id)
235	        assert service.id not in self.recoverers
236	        recoverer = self.RECOVERER_CLASS(

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Ensure autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: Medium
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\config\_base.py:252:14
251	        loader = jinja2.FileSystemLoader(search_directories)
252	        env = jinja2.Environment(loader=loader, autoescape=autoescape)
253	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Password reset emails are enabled on this homeserver due to a partial
'email' block. However, the following required keys are missing:
    %s
'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\emailconfig.py:28:38
27	
28	MISSING_PASSWORD_RESET_CONFIG_ERROR = """\
29	Password reset emails are enabled on this homeserver due to a partial
30	'email' block. However, the following required keys are missing:
31	    %s
32	"""
33	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#macaroon_secret_key: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:178:34
177	        else:
178	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
179	            form_secret = "#form_secret: <PRIVATE STRING>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#form_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:179:26
178	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
179	            form_secret = "#form_secret: <PRIVATE STRING>"
180	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\config\logger.py:247:12
246	                print("logging during logging: %s" % event_text, file=sys.__stderr__)
247	            except Exception:
248	                # gah.
249	                pass
250	            return

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<html><body>Invalid renewal token.</body><html>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\registration.py:76:16
75	            self.invalid_token_html_content = (
76	                "<html><body>Invalid renewal token.</body><html>"
77	            )
78	
79	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#registration_shared_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\registration.py:189:41
188	        else:
189	            registration_shared_secret = "#registration_shared_secret: <PRIVATE STRING>"
190	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\repository.py:196:56
195	            # unroutable addresses.
196	            self.url_preview_ip_range_blacklist.update(["0.0.0.0", "::"])
197	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:41:32
40	# in the list.
41	DEFAULT_BIND_ADDRESSES = ["::", "0.0.0.0"]
42	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:302:40
301	        # Always blacklist 0.0.0.0, ::
302	        self.ip_range_blacklist.update(["0.0.0.0", "::"])
303	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:322:51
321	        # Always blacklist 0.0.0.0, ::
322	        self.federation_ip_range_blacklist.update(["0.0.0.0", "::"])
323	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\server.py:1219:8
1218	    try:
1219	        assert len(thresholds) == 3
1220	        return (int(thresholds[0]), int(thresholds[1]), int(thresholds[2]))

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:1247:34
1246	            # the metrics listener doesn't support IPv6
1247	            bind_addresses.append("0.0.0.0")
1248	        else:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\tls.py:64:76
63	        self.acme_port = acme_config.get("port", 80)
64	        self.acme_bind_addresses = acme_config.get("bind_addresses", ["::", "0.0.0.0"])
65	        self.acme_reprovision_threshold = acme_config.get("reprovision_threshold", 30)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:404:12
403	            # any completed requests should already have been removed
404	            assert not verify_request.key_ready.called
405	            keys_for_server = missing_keys[verify_request.server_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:698:8
697	
698	        assert isinstance(query_response, dict)
699	        for response in query_response["server_keys"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:861:12
860	
861	            assert isinstance(response, dict)
862	            if response["server_name"] != server_name:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\event_auth.py:58:4
57	    """
58	    assert isinstance(auth_events, dict)
59	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:222:8
221	    ):
222	        assert room_version.event_format == self.format_version
223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:398:8
397	
398	        assert "event_id" not in event_dict
399	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\spamcheck.py:212:16
211	                )
212	                assert isinstance(behaviour, RegistrationBehaviour)
213	                if behaviour != RegistrationBehaviour.ALLOW:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\federation\federation_server.py:938:23
937	            # Pick an instance randomly so that we don't overload one.
938	            route_to = random.choice(instances)
939	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\send_queue.py:213:12
212	        if key:
213	            assert isinstance(key, tuple)
214	            self.keyed_edu[(destination, key)] = edu

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:325:8
324	
325	        assert pdu.internal_metadata.stream_ordering
326	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:161:12
160	        else:
161	            assert pdu.internal_metadata.stream_ordering
162	            self._catchup_last_skipped = pdu.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:365:24
364	                        )
365	                        assert last_successful_stream_ordering
366	                        await self._store.set_destination_last_successful_stream_ordering(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:553:8
552	
553	        assert len(edus) <= limit, "get_device_updates_by_remote returned too many EDUs"
554	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\groups\attestations.py:113:27
112	        validity_period = DEFAULT_ATTESTATION_LENGTH_MS
113	        validity_period *= random.uniform(*DEFAULT_ATTESTATION_JITTER)
114	        valid_until_ms = int(self.clock.time_msec() + validity_period)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:69:30
68	            response = await self._room_data_client(
69	                instance_name=random.choice(self._account_data_writers),
70	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:102:30
101	            response = await self._user_data_client(
102	                instance_name=random.choice(self._account_data_writers),
103	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:134:30
133	            response = await self._add_tag_client(
134	                instance_name=random.choice(self._account_data_writers),
135	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:159:30
158	            response = await self._remove_tag_client(
159	                instance_name=random.choice(self._account_data_writers),
160	                user_id=user_id,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:967:16
966	                # we've already checked that there is a (valid) password field
967	                assert isinstance(password, str)
968	                (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1060:8
1059	        # we already checked that we have a valid login type
1060	        assert isinstance(login_type, str)
1061	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1096:12
1095	            password = login_submission["password"]
1096	            assert isinstance(password, str)
1097	

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\synapse\handlers\cas_handler.py:18:0
17	from typing import TYPE_CHECKING, Dict, Optional
18	from xml.etree import ElementTree as ET
19	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\synapse\handlers\cas_handler.py:158:15
157	        # Ensure the response is valid.
158	        root = ET.fromstring(cas_response_body)
159	        if not root.tag.endswith("serviceResponse"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\cas_handler.py:214:12
213	        else:
214	            assert client_redirect_url
215	            service_args = {"redirectUrl": client_redirect_url.decode("utf8")}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\cas_handler.py:332:8
331	        # If this not a UI auth request than there must be a redirect URL.
332	        assert client_redirect_url is not None
333	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\events.py:84:26
83	                # thundering herds on restart.
84	                timeout = random.randint(int(timeout * 0.9), int(timeout * 1.1))
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:894:12
893	            ev = event_map[e_id]
894	            assert not ev.internal_metadata.is_outlier()
895	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:923:12
922	            # non-outliers
923	            assert not event.internal_metadata.is_outlier()
924	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\handlers\federation.py:1085:16
1084	                        joined_domains[dom] = d
1085	                except Exception:
1086	                    pass
1087	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1335:8
1334	        # room stuff after join currently doesn't work on workers.
1335	        assert self.config.worker.worker_app is None
1336	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1351:8
1350	        # at a time - so this is just paranoia.
1351	        assert room_id not in self.room_queues
1352	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1694:8
1693	        # FIXME: Do this in a nicer way
1694	        assert event.type == EventTypes.Member
1695	        assert event.user_id == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1695:8
1694	        assert event.type == EventTypes.Member
1695	        assert event.user_id == user_id
1696	        assert event.state_key == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1696:8
1695	        assert event.user_id == user_id
1696	        assert event.state_key == user_id
1697	        assert event.room_id == room_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1697:8
1696	        assert event.state_key == user_id
1697	        assert event.room_id == room_id
1698	        return origin, event, room_version

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:2915:12
2914	        else:
2915	            assert self.storage.persistence
2916	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:2962:8
2961	        # the event has been persisted so it should have a stream ordering.
2962	        assert event.internal_metadata.stream_ordering
2963	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\initial_sync.py:298:12
297	            # to leave.
298	            assert member_event_id
299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:340:8
339	        """
340	        assert self._ephemeral_events_enabled
341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:640:8
639	        u = await self.store.get_user_by_id(user_id)
640	        assert u is not None
641	        if u["user_type"] in (UserTypes.SUPPORT, UserTypes.BOT):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:719:35
718	            # We randomly sleep a bit just to annoy the requester.
719	            await self.clock.sleep(random.randint(1, 10))
720	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:738:20
737	                    # we know it was persisted, so must have a stream ordering
738	                    assert event.internal_metadata.stream_ordering
739	                    return event, event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:745:12
744	
745	            assert self.hs.is_mine_id(event.sender), "User must be our own: %s" % (
746	                event.sender,
747	            )
748	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:764:8
763	        # we know it was persisted, so must have a stream ordering
764	        assert ev.internal_metadata.stream_ordering
765	        return ev, ev.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:796:12
795	        if prev_event_ids is not None:
796	            assert len(prev_event_ids) <= 10, (
797	                "Attempting to create an event with %i prev_events"
798	                % (len(prev_event_ids),)
799	            )
800	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:808:8
807	        # create event in auth events")
808	        assert (
809	            builder.type == EventTypes.Create or len(prev_event_ids) > 0
810	        ), "Attempting to create an event with no prev_events"
811	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:901:35
900	            # We randomly sleep a bit just to annoy the requester.
901	            await self.clock.sleep(random.randint(1, 10))
902	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:925:12
924	            # are invite rejections we have generated ourselves.
925	            assert event.type == EventTypes.Member
926	            assert event.content["membership"] == Membership.LEAVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:926:12
925	            assert event.type == EventTypes.Member
926	            assert event.content["membership"] == Membership.LEAVE
927	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1072:8
1071	        """
1072	        assert self.storage.persistence is not None
1073	        assert self._events_shard_config.should_handle(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1073:8
1072	        assert self.storage.persistence is not None
1073	        assert self._events_shard_config.should_handle(
1074	            self._instance_name, event.room_id
1075	        )
1076	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\oidc_handler.py:83:8
82	        # we should not have been instantiated if there is no configured provider.
83	        assert provider_confs
84	

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\handlers\oidc_handler.py:1135:6
1134	
1135	env = Environment(finalize=jinja_finalize)
1136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:379:20
378	                    # case "JOIN" would have been returned.
379	                    assert member_event_id
380	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:384:20
383	                    )
384	                    assert leave_token.topological is not None
385	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:97:0
96	
97	assert LAST_ACTIVE_GRANULARITY < IDLE_TIMER
98	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:825:12
824	        async def _process_presence():
825	            assert not self._event_processing
826	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1079:16
1078	            if changed is not None and len(changed) < 500:
1079	                assert isinstance(user_ids_changed, set)
1080	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\profile.py:347:35
346	            # We randomly sleep a bit just to annoy the requester.
347	            await self.clock.sleep(random.randint(1, 10))
348	            return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:438:20
437	                    # If an invite is required, there must be a auto-join user ID.
438	                    assert self.hs.config.registration.auto_join_user_id
439	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\handlers\register.py:520:14
519	
520	        await self.register_with_store(
521	            user_id=user_id,
522	            password_hash="",
523	            appservice_id=service_id,
524	            create_profile_with_displayname=user.localpart,
525	        )
526	        return user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:671:12
670	        if is_guest:
671	            assert valid_until_ms is None
672	            access_token = self.macaroon_gen.generate_access_token(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:771:12
770	            # The token better still exist.
771	            assert user_tuple
772	            token_id = user_tuple.token_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:189:8
188	        user_id = requester.user.to_string()
189	        assert self.hs.is_mine_id(user_id), "User must be our own: %s" % (user_id,)
190	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:240:8
239	        # We know the tombstone event isn't an outlier so it has current state.
240	        assert old_room_state is not None
241	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room.py:659:35
658	            # We randomly sleep a bit just to annoy the requester.
659	            await self.clock.sleep(random.randint(1, 10))
660	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:230:8
229	        # we know it was persisted, so should have a stream ordering
230	        assert result_event.internal_metadata.stream_ordering
231	        return result_event.event_id, result_event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:306:35
305	            # We randomly sleep a bit just to annoy the requester.
306	            await self.clock.sleep(random.randint(1, 10))
307	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:457:20
456	                    # we know it was persisted, so must have a stream ordering.
457	                    assert old_state.internal_metadata.stream_ordering
458	                    return (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:689:12
688	            sender = UserID.from_string(event.sender)
689	            assert (
690	                sender == requester.user
691	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
692	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:692:12
691	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
692	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)
693	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:819:35
818	            # We randomly sleep a bit just to annoy the requester.
819	            await self.clock.sleep(random.randint(1, 10))
820	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:1190:8
1189	        # we know it was persisted, so must have a stream ordering
1190	        assert result_event.internal_metadata.stream_ordering
1191	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:120:16
119	
120	                assert batch_group is not None
121	                assert batch_group_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:121:16
120	                assert batch_group is not None
121	                assert batch_group_key is not None
122	                assert batch_token is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:122:16
121	                assert batch_group_key is not None
122	                assert batch_token is not None
123	            except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sso.py:175:8
174	        p_id = p.idp_id
175	        assert p_id not in self._identity_providers
176	        self._identity_providers[p_id] = p

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:850:16
849	                # is indeed the case.
850	                assert since_token is not None
851	                state_at_previous_sync = await self.get_state_at(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1327:8
1326	        )
1327	        assert presence_key
1328	        sync_result_builder.now_token = now_token.copy_and_replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1483:8
1482	
1483	        assert since_token
1484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1509:8
1508	
1509	        assert since_token
1510	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\typing.py:205:8
204	
205	        assert hs.config.worker.writers.typing == hs.get_instance_name()
206	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:251:35
250	            # We randomly sleep a bit just to annoy the requester.
251	            await self.clock.sleep(random.randint(1, 10))
252	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:287:35
286	            # We randomly sleep a bit just to annoy the requester.
287	            await self.clock.sleep(random.randint(1, 10))
288	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_hash'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\handlers\ui_auth\__init__.py:30:20
29	    # password, so that the client does not need to submit it each time.
30	    PASSWORD_HASH = "password_hash"
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\ui_auth\checkers.py:161:16
160	            if self.hs.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
161	                assert self.hs.config.account_threepid_delegate_email
162	                threepid = await identity_handler.threepid_from_creds(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\federation\matrix_federation_agent.py:143:8
142	        # There must be a valid hostname.
143	        assert parsed_uri.hostname
144	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\srv_resolver.py:80:28
79	        while servers and total_weight:
80	            target_weight = random.randint(1, total_weight)
81	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:154:28
153	            # add some randomness to the TTL to avoid a stampeding herd
154	            cache_period *= random.uniform(
155	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
156	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
157	            )
158	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:208:28
207	            # after startup
208	            cache_period *= random.uniform(
209	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
210	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
211	            )
212	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:561:37
560	                            delay = min(delay, 60)
561	                            delay *= random.uniform(0.8, 1.4)
562	                        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:565:37
564	                            delay = min(delay, 2)
565	                            delay *= random.uniform(0.8, 1.4)
566	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\http\server.py:92:12
91	                request.transport.abortConnection()
92	            except Exception:
93	                # abortConnection throws if the connection is already closed
94	                pass
95	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\server.py:423:8
422	        # We expect to get bytes for us to write
423	        assert isinstance(response_object, bytes)
424	        html_bytes = response_object

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:188:12
187	        if not self._is_processing:
188	            assert self.logcontext is not None
189	            with PreserveLoggingContext(self.logcontext):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:254:8
253	        """
254	        assert self.logcontext is not None
255	        usage = self.logcontext.get_resource_usage()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:379:8
378	
379	        assert config.http_options is not None
380	        proxied = config.http_options.x_forwarded

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:449:12
448	            rusage = get_thread_resource_usage()
449	            assert rusage is not None
450	            utime_delta, stime_delta = self._get_cputime(rusage)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:464:8
463	        """
464	        assert self.usage_start is not None
465	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:651:8
650	    else:
651	        assert isinstance(curr_context, LoggingContext)
652	        parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:838:8
837	    else:
838	        assert isinstance(curr_context, LoggingContext)
839	        parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\baserules.py:126:8
125	        # Only modify the actions, keep the conditions the same.
126	        assert isinstance(r["rule_id"], str)
127	        modified = modified_base_rules.get(r["rule_id"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\baserules.py:148:8
147	        # Only modify the actions, keep the conditions the same.
148	        assert isinstance(r["rule_id"], str)
149	        modified = modified_base_rules.get(r["rule_id"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\bulk_push_rule_evaluator.py:381:12
380	            # Ensure the state IDs exist.
381	            assert current_state_ids is not None
382	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:115:8
114	        """
115	        assert not self._is_processing
116	        self._is_processing = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:121:8
120	        """
121	        assert self._is_processing
122	        self._is_processing = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:127:8
126	        # we should never get here if we are already processing
127	        assert not self._is_processing
128	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:134:16
133	                # this is our first loop: load up the throttle params
134	                assert self.pusher_id is not None
135	                self.throttle_params = await self.store.get_throttle_params_by_room(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:303:8
302	        )
303	        assert self.pusher_id is not None
304	        await self.store.set_throttle_params(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:156:8
155	        # we should never get here if we are already processing
156	        assert not self._is_processing
157	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:314:8
313	        # This was checked in the __init__, but mypy doesn't seem to know that.
314	        assert self.data is not None
315	        if self.data.get("format") == "event_id_only":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\push_rule_evaluator.py:50:4
49	    notif_levels = power_levels.get("notifications", {})
50	    assert isinstance(notif_levels, dict)
51	    room_notif_level = notif_levels.get(notif_level_key, 50)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:99:8
98	        # assert here that sub classes don't try and use the name.
99	        assert (
100	            "instance_name" not in self.PATH_ARGS
101	        ), "`instance_name` is a reserved parameter name"
102	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:102:8
101	        ), "`instance_name` is a reserved parameter name"
102	        assert (
103	            "instance_name"
104	            not in signature(self.__class__._serialize_payload).parameters
105	        ), "`instance_name` is a reserved parameter name"
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:107:8
106	
107	        assert self.METHOD in ("PUT", "POST", "GET")
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\membership.py:204:8
203	        """
204	        assert change == "left"
205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\slave\storage\push_rule.py:30:8
29	        # We assert this for the benefit of mypy
30	        assert isinstance(self._push_rules_stream_id_gen, SlavedIdTracker)
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:143:16
142	                    continue
143	                assert isinstance(row, EventsStreamRow)
144	                assert isinstance(row.data, EventsStreamEventRow)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:144:16
143	                assert isinstance(row, EventsStreamRow)
144	                assert isinstance(row.data, EventsStreamEventRow)
145	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\replication\tcp\client.py:182:16
181	                        deferred.callback(None)
182	                except Exception:
183	                    # The deferred has been cancelled or timed out.
184	                    pass
185	            else:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'batch'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\replication\tcp\commands.py:125:29
124	            instance_name,
125	            None if token == "batch" else int(token),
126	            json_decoder.decode(row_json),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:254:8
253	        """
254	        assert stream_name not in self._processing_streams
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:410:8
409	
410	        assert self._server_notices_sender is not None
411	        await self._server_notices_sender.on_user_ip(cmd.user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\resource.py:90:8
89	        # If we have streams then we must have redis enabled or on master
90	        assert (
91	            not self.streams
92	            or hs.config.redis.redis_enabled
93	            or not hs.config.worker.worker_app
94	        )
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\streams\events.py:168:8
167	        # that we know it is safe to just take upper_limit = event_rows[-1][0].
168	        assert (
169	            len(event_rows) <= target_row_count
170	        ), "get_all_new_forward_event_rows did not honour row limit"
171	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\rest\client\v1\login.py:43:17
42	    SSO_TYPE = "m.login.sso"
43	    TOKEN_TYPE = "m.login.token"
44	    JWT_TYPE = "org.matrix.login.jwt"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:120:48
119	                # look like we did something.
120	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
121	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\account.py:126:12
125	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
126	            assert self.hs.config.account_threepid_delegate_email
127	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:394:48
393	                # look like we did something.
394	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
395	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\account.py:400:12
399	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
400	            assert self.hs.config.account_threepid_delegate_email
401	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:473:48
472	                # look like we did something.
473	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
474	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\register.py:139:48
138	                # look like we did something.
139	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
140	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\register.py:145:12
144	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
145	            assert self.hs.config.account_threepid_delegate_email
146	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\register.py:218:48
217	                # look like we did something.
218	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
219	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:28:0
27	        )
28	except Exception:
29	    # any other exception is fine
30	    pass
31	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:43:0
42	        )
43	except Exception:
44	    # any other exception is fine
45	    pass

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\media_storage.py:139:12
138	                os.remove(fname)
139	            except Exception:
140	                pass
141	            raise

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:54:4
53	if TYPE_CHECKING:
54	    from lxml import etree
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:541:12
540	            # we can only get here if we did an oembed request and have an oembed_result.html
541	            assert oembed_result.html is not None
542	            assert oembed_url is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:542:12
541	            assert oembed_result.html is not None
542	            assert oembed_url is not None
543	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:601:8
600	
601	        assert self._worker_run_media_background_jobs
602	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:631:12
630	                    os.rmdir(dir)
631	            except Exception:
632	                pass
633	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:663:12
662	                    os.rmdir(dir)
663	            except Exception:
664	                pass
665	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:681:12
680	                    os.rmdir(dir)
681	            except Exception:
682	                pass
683	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:713:4
712	
713	    from lxml import etree
714	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\synapse\rest\media\v1\preview_url_resource.py:727:15
726	        # Attempt to parse the body. If this fails, log and return no metadata.
727	        tree = etree.fromstring(body_attempt, parser)
728	        return _calc_og(tree, media_uri)

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:823:12
822	
823	            from lxml import etree
824	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:845:8
844	        # This must be a non-empty string at this point.
845	        assert isinstance(og["og:description"], str)
846	        og["og:description"] = summarize_paragraphs([og["og:description"]])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\synapse\client\password_reset.py:64:8
63	        # This resource should not be mounted if threepid behaviour is not LOCAL
64	        assert hs.config.threepid_behaviour_email == ThreepidBehaviour.LOCAL
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:114:8
113	
114	        assert self._is_mine_id(user_id), "Cannot send server notices to remote users"
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:173:8
172	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
173	        assert latest_event_ids is not None
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:208:8
207	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
208	        assert latest_event_ids is not None
209	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:228:8
227	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
228	        assert latest_event_ids is not None
229	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\synapse\state\v1.py:347:30
346	        # people to send us events with non-ascii event IDs :/
347	        return -int(e.depth), hashlib.sha1(e.event_id.encode("utf-8")).hexdigest()
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\background_updates.py:231:8
230	    async def _do_background_update(self, desired_duration_ms: float) -> int:
231	        assert self._current_background_update is not None
232	        update_name = self._current_background_update

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:235:8
234	        # is not the case.
235	        assert self.after_callbacks is not None
236	        self.after_callbacks.append((callback, args, kwargs))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:244:8
243	        # is not the case.
244	        assert self.exception_callbacks is not None
245	        self.exception_callbacks.append((callback, args, kwargs))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:285:8
284	        """
285	        assert isinstance(self.database_engine, PostgresEngine)
286	        from psycopg2.extras import execute_values  # type: ignore

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\database.py:312:12
311	                sql_logger.debug("[SQL values] {%s} %r", self.name, args[0])
312	            except Exception:
313	                # Don't let logging failures stop SQL from working
314	                pass
315	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:710:12
709	        else:
710	            assert isinstance(curr_context, LoggingContext)
711	            parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:721:12
720	            # pool).
721	            assert not self.engine.in_transaction(conn)
722	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1036:18
1035	            # SELECT instead to see if it exists.
1036	            sql = "SELECT 1 FROM %s WHERE %s" % (
1037	                table,
1038	                " AND ".join(_getwhere(k) for k in keyvalues),
1039	            )
1040	            sqlargs = list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1047:18
1046	            # First try to update.
1047	            sql = "UPDATE %s SET %s WHERE %s" % (
1048	                table,
1049	                ", ".join("%s = ?" % (k,) for k in values),
1050	                " AND ".join(_getwhere(k) for k in keyvalues),
1051	            )
1052	            sqlargs = list(values.values()) + list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1065:14
1064	
1065	        sql = "INSERT INTO %s (%s) VALUES (%s)" % (
1066	            table,
1067	            ", ".join(k for k in allvalues),
1068	            ", ".join("?" for _ in allvalues),
1069	        )
1070	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1099:21
1098	            allvalues.update(values)
1099	            latter = "UPDATE SET " + ", ".join(k + "=EXCLUDED." + k for k in values)
1100	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1101:15
1100	
1101	        sql = ("INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s") % (
1102	            table,
1103	            ", ".join(k for k in allvalues),
1104	            ", ".join("?" for _ in allvalues),
1105	            ", ".join(k for k in keyvalues),
1106	            latter,
1107	        )
1108	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1237:21
1236	        else:
1237	            latter = "UPDATE SET " + ", ".join(
1238	                k + "=EXCLUDED." + k for k in value_names
1239	            )
1240	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1241:14
1240	
1241	        sql = "INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s" % (
1242	            table,
1243	            ", ".join(k for k in allnames),
1244	            ", ".join("?" for _ in allnames),
1245	            ", ".join(key_names),
1246	            latter,
1247	        )
1248	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1407:15
1406	    ) -> List[Any]:
1407	        sql = ("SELECT %(retcol)s FROM %(table)s") % {"retcol": retcol, "table": table}
1408	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1495:18
1494	        if keyvalues:
1495	            sql = "SELECT %s FROM %s WHERE %s" % (
1496	                ", ".join(retcols),
1497	                table,
1498	                " AND ".join("%s = ?" % (k,) for k in keyvalues),
1499	            )
1500	            txn.execute(sql, list(keyvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1502:18
1501	        else:
1502	            sql = "SELECT %s FROM %s" % (", ".join(retcols), table)
1503	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1591:14
1590	
1591	        sql = "SELECT %s FROM %s WHERE %s" % (
1592	            ", ".join(retcols),
1593	            table,
1594	            " AND ".join(clauses),
1595	        )
1596	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1623:21
1622	
1623	        update_sql = "UPDATE %s SET %s %s" % (
1624	            table,
1625	            ", ".join("%s = ?" % (k,) for k in updatevalues),
1626	            where,
1627	        )
1628	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1685:21
1684	    ) -> Optional[Dict[str, Any]]:
1685	        select_sql = "SELECT %s FROM %s WHERE %s" % (
1686	            ", ".join(retcols),
1687	            table,
1688	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1689	        )
1690	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1729:14
1728	        """
1729	        sql = "DELETE FROM %s WHERE %s" % (
1730	            table,
1731	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1732	        )
1733	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1774:14
1773	        """
1774	        sql = "DELETE FROM %s WHERE %s" % (
1775	            table,
1776	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1777	        )
1778	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1839:14
1838	
1839	        sql = "DELETE FROM %s" % table
1840	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1867:12
1866	        sql = (
1867	            "SELECT %(entity)s, MAX(%(stream)s) FROM %(table)s"
1868	            " WHERE %(stream)s > ? - %(limit)s"
1869	            " GROUP BY %(entity)s"
1870	        ) % {
1871	            "table": table,
1872	            "entity": entity_column,
1873	            "stream": stream_column,
1874	            "limit": limit,
1875	        }
1876	
1877	        txn = db_conn.cursor(txn_name="get_cache_dict")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1944:14
1943	
1944	        sql = "SELECT %s FROM %s %s ORDER BY %s %s LIMIT ? OFFSET ?" % (
1945	            ", ".join(retcols),
1946	            table,
1947	            where_clause,
1948	            orderby,
1949	            order_direction,
1950	        )
1951	        txn.execute(sql, arg_list + [limit, start])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2009:18
2008	        if term:
2009	            sql = "SELECT %s FROM %s WHERE %s LIKE ?" % (", ".join(retcols), table, col)
2010	            termvalues = ["%%" + term + "%%"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:389:8
388	        """
389	        assert self._can_write_to_account_data
390	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:431:8
430	        """
431	        assert self._can_write_to_account_data
432	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:404:16
403	                # We do NOT want to escape `stream_id_type`.
404	                "SELECT %s FROM application_services_state WHERE as_id=?"
405	                % stream_id_type,
406	                (service.id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:430:16
429	            txn.execute(
430	                "UPDATE application_services_state SET %s = ? WHERE as_id=?"
431	                % stream_id_type,
432	                (pos, service.id),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:176:16
175	            txn.execute(
176	                """
177	                SELECT user_id, access_token, ip,
178	                       MAX(device_id), MAX(user_agent), MAX(last_seen),
179	                       COUNT(*)
180	                FROM (
181	                    SELECT DISTINCT user_id, access_token, ip
182	                    FROM user_ips
183	                    WHERE {}
184	                ) c
185	                INNER JOIN user_ips USING (user_id, access_token, ip)
186	                GROUP BY user_id, access_token, ip
187	                HAVING count(*) > 1
188	                """.format(
189	                    clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:306:18
305	
306	            sql = """
307	                SELECT
308	                    last_seen, ip, user_agent, user_id, device_id
309	                FROM (
310	                    SELECT
311	                        user_id, device_id, MAX(u.last_seen) AS last_seen
312	                    FROM devices
313	                    INNER JOIN user_ips AS u USING (user_id, device_id)
314	                    WHERE %(where_clause)s
315	                    GROUP BY user_id, device_id
316	                    ORDER BY user_id ASC, device_id ASC
317	                    LIMIT ?
318	                ) c
319	                INNER JOIN user_ips AS u USING (user_id, device_id, last_seen)
320	            """ % {
321	                "where_clause": where_clause
322	            }
323	            txn.execute(sql, where_args + [batch_size])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:382:8
381	
382	        assert self._can_write_to_device
383	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:425:8
424	    ) -> int:
425	        assert self._can_write_to_device
426	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:475:8
474	    ):
475	        assert self._can_write_to_device
476	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\devices.py:988:18
987	            )
988	            sql = """
989	                SELECT stream_id, destination, user_id, device_id, MAX(ts) AS ts
990	                FROM device_lists_outbound_pokes
991	                WHERE %s
992	                GROUP BY %s
993	                HAVING count(*) > 1
994	                ORDER BY %s
995	                LIMIT ?
996	                """ % (
997	                clause,  # WHERE
998	                ",".join(KEY_COLS),  # GROUP BY
999	                ",".join(KEY_COLS),  # ORDER BY
1000	            )
1001	            txn.execute(sql, args + [batch_size])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\directory.py:181:18
180	
181	            sql = "UPDATE room_aliases SET room_id = ? %s WHERE room_id = ?" % (
182	                update_creator_sql,
183	            )
184	            txn.execute(sql, sql_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\e2e_room_keys.py:202:14
201	
202	        sql = """
203	        SELECT room_id, session_id, first_message_index, forwarded_count,
204	               is_verified, session_data
205	        FROM e2e_room_keys
206	        WHERE user_id = ? AND version = ? AND (%s)
207	        """ % (
208	            " OR ".join(where_clauses)
209	        )
210	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:229:12
228	        sql = (
229	            "SELECT user_id, device_id, "
230	            "    d.display_name, "
231	            "    k.key_json"
232	            " FROM devices d"
233	            "    %s JOIN e2e_device_keys_json k USING (user_id, device_id)"
234	            " WHERE %s AND NOT d.hidden"
235	        ) % (
236	            "LEFT" if include_all_devices else "INNER",
237	            " OR ".join("(" + q + ")" for q in query_clauses),
238	        )
239	
240	        txn.execute(sql, query_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:275:24
274	
275	        signature_sql = """
276	            SELECT user_id, key_id, target_device_id, signature
277	            FROM e2e_cross_signing_signatures WHERE %s
278	            """ % (
279	            " OR ".join("(" + q + ")" for q in signature_query_clauses)
280	        )
281	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:525:22
524	                # the latest key.
525	                sql = """
526	                    SELECT DISTINCT ON (user_id, keytype) user_id, keytype, keydata, stream_id
527	                        FROM e2e_cross_signing_keys
528	                        WHERE %(clause)s
529	                        ORDER BY user_id, keytype, stream_id DESC
530	                """ % {
531	                    "clause": clause
532	                }
533	            else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:537:22
536	                # a row that matches the MIN/MAX.
537	                sql = """
538	                    SELECT user_id, keytype, keydata, MAX(stream_id)
539	                        FROM e2e_cross_signing_keys
540	                        WHERE %(clause)s
541	                        GROUP BY user_id, keytype
542	                """ % {
543	                    "clause": clause
544	                }
545	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:590:18
589	        for batch in batch_iter(devices.keys(), size=100):
590	            sql = """
591	                SELECT target_user_id, target_device_id, key_id, signature
592	                  FROM e2e_cross_signing_signatures
593	                 WHERE user_id = ?
594	                   AND (%s)
595	            """ % (
596	                " OR ".join(
597	                    "(target_user_id = ? AND target_device_id = ?)" for _ in batch
598	                )
599	            )
600	            query_params = [from_user_id]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_federation.py:606:18
605	
606	            sql = """
607	                SELECT room_id FROM event_forward_extremities
608	                WHERE %s
609	                GROUP BY room_id
610	                HAVING count(*) > ?
611	                ORDER BY count(*) DESC
612	                LIMIT ?
613	            """ % (
614	                where_clause,
615	            )
616	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_push_actions.py:925:16
924	            sql = (
925	                "SELECT epa.event_id, epa.room_id,"
926	                " epa.stream_ordering, epa.topological_ordering,"
927	                " epa.actions, epa.highlight, epa.profile_tag, e.received_ts"
928	                " FROM event_push_actions epa, events e"
929	                " WHERE epa.event_id = e.event_id"
930	                " AND epa.user_id = ? %s"
931	                " AND epa.notif = 1"
932	                " ORDER BY epa.stream_ordering DESC"
933	                " LIMIT ?" % (before_clause,)
934	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:113:8
112	        # This should only exist on instances that are configured to write
113	        assert (
114	            hs.get_instance_name() in hs.config.worker.writers.events
115	        ), "Can only instantiate EventsStore on master"
116	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:345:8
344	        # stream orderings should have been assigned by now
345	        assert min_stream_order
346	        assert max_stream_order

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:346:8
345	        assert min_stream_order
346	        assert max_stream_order
347	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events.py:1216:12
1215	        txn.execute(
1216	            "SELECT event_id, outlier FROM events WHERE event_id in (%s)"
1217	            % (",".join(["?"] * len(events_and_contexts)),),
1218	            [event.event_id for event, _ in events_and_contexts],

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:2039:8
2038	
2039	        assert src_chain != target_chain
2040	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events_bg_updates.py:842:14
841	
842	        sql = """
843	            SELECT
844	                event_id, state_events.type, state_events.state_key,
845	                topological_ordering, stream_ordering,
846	                events.room_id
847	            FROM events
848	            INNER JOIN state_events USING (event_id)
849	            LEFT JOIN event_auth_chains USING (event_id)
850	            LEFT JOIN event_auth_chain_to_calculate USING (event_id)
851	            WHERE event_auth_chains.event_id IS NULL
852	                AND event_auth_chain_to_calculate.event_id IS NULL
853	                AND %(tuple_cmp)s
854	                %(extra)s
855	            ORDER BY events.room_id, topological_ordering, stream_ordering
856	            %(limit)s
857	        """ % {
858	            "tuple_cmp": tuple_clause,
859	            "limit": "LIMIT ?" if batch_size is not None else "",
860	            "extra": extra_clause,
861	        }
862	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:350:16
349	            if not allow_rejected:
350	                assert not entry.event.rejected_reason, (
351	                    "rejected event returned from _get_events_from_cache_or_db despite "
352	                    "allow_rejected=False"
353	                )
354	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:554:8
553	        # non-None.
554	        assert current_state_ids is not None
555	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:689:12
688	                continue
689	            assert row["event_id"] == event_id
690	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:1309:8
1308	        # of the last row in the result.
1309	        assert rows[-1][0] <= to_token
1310	        to_token = rows[-1][0] - 1

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:65:16
64	            sql = (
65	                "SELECT server_name, key_id, verify_key, ts_valid_until_ms "
66	                "FROM server_signature_keys WHERE 1=0"
67	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
68	
69	            txn.execute(sql, tuple(itertools.chain.from_iterable(batch)))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:67:16
66	                "FROM server_signature_keys WHERE 1=0"
67	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
68	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\media_repository.py:187:23
186	        if keep_profiles:
187	            sql_keep = """
188	                AND (
189	                    NOT EXISTS
190	                        (SELECT 1
191	                         FROM profiles
192	                         WHERE profiles.avatar_url = '{media_prefix}' || lmr.media_id)
193	                    AND NOT EXISTS
194	                        (SELECT 1
195	                         FROM groups
196	                         WHERE groups.avatar_url = '{media_prefix}' || lmr.media_id)
197	                    AND NOT EXISTS
198	                        (SELECT 1
199	                         FROM room_memberships
200	                         WHERE room_memberships.avatar_url = '{media_prefix}' || lmr.media_id)
201	                    AND NOT EXISTS
202	                        (SELECT 1
203	                         FROM user_directory
204	                         WHERE user_directory.avatar_url = '{media_prefix}' || lmr.media_id)
205	                    AND NOT EXISTS
206	                        (SELECT 1
207	                         FROM room_stats_state
208	                         WHERE room_stats_state.avatar = '{media_prefix}' || lmr.media_id)
209	                )
210	            """.format(
211	                media_prefix="mxc://%s/" % (self.server_name,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:150:16
149	            txn.execute(
150	                "DELETE FROM monthly_active_users WHERE timestamp < ? AND NOT %s"
151	                % (in_clause,),
152	                [thirty_days_ago] + in_clause_args,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:173:22
172	                # SELECT, meaning that a legitimate mau is deleted.
173	                sql = """
174	                    DELETE FROM monthly_active_users
175	                    WHERE user_id NOT IN (
176	                        SELECT user_id FROM monthly_active_users
177	                        WHERE NOT %s
178	                        ORDER BY timestamp DESC
179	                        LIMIT ?
180	                    )
181	                    AND NOT %s
182	                """ % (
183	                    in_clause,
184	                    in_clause,
185	                )
186	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:126:12
125	        txn.execute(
126	            "INSERT INTO events_to_purge"
127	            " SELECT event_id, %s"
128	            " FROM events AS e LEFT JOIN state_events USING (event_id)"
129	            " WHERE (NOT outlier OR (%s)) AND e.room_id = ? AND topological_ordering < ?"
130	            % (should_delete_expr, should_delete_expr),
131	            should_delete_params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:220:16
219	            txn.execute(
220	                "DELETE FROM %s WHERE event_id IN ("
221	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
222	                ")" % (table,)
223	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:231:16
230	            txn.execute(
231	                "DELETE FROM %s WHERE room_id = ? AND event_id IN ("
232	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
233	                ")" % (table,),
234	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:329:16
328	            txn.execute(
329	                """
330	                DELETE FROM %s WHERE event_id IN (
331	                  SELECT event_id FROM events WHERE room_id=?
332	                )
333	                """
334	                % (table,),
335	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:373:24
372	            logger.info("[purge] removing %s from %s", room_id, table)
373	            txn.execute("DELETE FROM %s WHERE room_id=?" % (table,), (room_id,))
374	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\push_rule.py:658:16
657	            sql = (
658	                """
659	                SELECT 1 FROM push_rules
660	                WHERE user_name = ? AND rule_id = ?
661	                %s
662	            """
663	                % for_key_share
664	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:491:8
490	        """
491	        assert self._can_write_to_receipts
492	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:570:8
569	        """
570	        assert self._can_write_to_receipts
571	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:636:8
635	    ):
636	        assert self._can_write_to_receipts
637	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:651:8
650	    ):
651	        assert self._can_write_to_receipts
652	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\registration.py:824:8
823	
824	        assert address or sid
825	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:827:18
826	        def get_threepid_validation_session_txn(txn):
827	            sql = """
828	                SELECT address, session_id, medium, client_secret,
829	                last_send_attempt, validated_at
830	                FROM threepid_validation_session WHERE %s
831	                """ % (
832	                " AND ".join("%s = ?" % k for k in keyvalues.keys()),
833	            )
834	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1523:16
1522	            txn.execute(
1523	                "SELECT token, id, device_id FROM access_tokens WHERE %s"
1524	                % where_clause,
1525	                values,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1534:24
1533	
1534	            txn.execute("DELETE FROM access_tokens WHERE %s" % where_clause, values)
1535	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:97:14
96	
97	        sql = """
98	            SELECT event_id, topological_ordering, stream_ordering
99	            FROM event_relations
100	            INNER JOIN events USING (event_id)
101	            WHERE %s
102	            ORDER BY topological_ordering %s, stream_ordering %s
103	            LIMIT ?
104	        """ % (
105	            " AND ".join(where_clause),
106	            order,
107	            order,
108	        )
109	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:188:14
187	
188	        sql = """
189	            SELECT type, aggregation_key, COUNT(DISTINCT sender), MAX(stream_ordering)
190	            FROM event_relations
191	            INNER JOIN events USING (event_id)
192	            WHERE {where_clause}
193	            GROUP BY relation_type, type, aggregation_key
194	            {having_clause}
195	            ORDER BY COUNT(*) {order}, MAX(stream_ordering) {order}
196	            LIMIT ?
197	        """.format(
198	            where_clause=" AND ".join(where_clause),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:171:18
170	
171	            sql = """
172	                SELECT
173	                    COALESCE(COUNT(*), 0)
174	                FROM (
175	                    %(published_sql)s
176	                ) published
177	                INNER JOIN room_stats_state USING (room_id)
178	                INNER JOIN room_stats_current USING (room_id)
179	                WHERE
180	                    (
181	                        join_rules = 'public' OR history_visibility = 'world_readable'
182	                    )
183	                    AND joined_members > 0
184	            """ % {
185	                "published_sql": published_sql
186	            }
187	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:305:14
304	
305	        sql = """
306	            SELECT
307	                room_id, name, topic, canonical_alias, joined_members,
308	                avatar, history_visibility, joined_members, guest_access
309	            FROM (
310	                %(published_sql)s
311	            ) published
312	            INNER JOIN room_stats_state USING (room_id)
313	            INNER JOIN room_stats_current USING (room_id)
314	            WHERE
315	                (
316	                    join_rules = 'public' OR history_visibility = 'world_readable'
317	                )
318	                AND joined_members > 0
319	                %(where_clause)s
320	            ORDER BY joined_members %(dir)s, room_id %(dir)s
321	        """ % {
322	            "published_sql": published_sql,
323	            "where_clause": where_clause,
324	            "dir": "DESC" if forwards else "ASC",
325	        }
326	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:452:19
451	        # returned. Thus allowing us to see if there are more events to paginate through
452	        info_sql = """
453	            SELECT state.room_id, state.name, state.canonical_alias, curr.joined_members,
454	              curr.local_users_in_room, rooms.room_version, rooms.creator,
455	              state.encryption, state.is_federatable, rooms.is_public, state.join_rules,
456	              state.guest_access, state.history_visibility, curr.current_state_events
457	            FROM room_stats_state state
458	            INNER JOIN room_stats_current curr USING (room_id)
459	            INNER JOIN rooms USING (room_id)
460	            %s
461	            ORDER BY %s %s
462	            LIMIT ?
463	            OFFSET ?
464	        """ % (
465	            where_statement,
466	            order_by_column,
467	            "ASC" if order_by_asc else "DESC",
468	        )
469	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:471:20
470	        # Use a nested SELECT statement as SQL can't count(*) with an OFFSET
471	        count_sql = """
472	            SELECT count(*) FROM (
473	              SELECT room_id FROM room_stats_state state
474	              %s
475	            ) AS get_room_ids
476	        """ % (
477	            where_statement,
478	        )
479	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:989:16
988	            txn.execute(
989	                """
990	                SELECT state.room_id, state.event_id, events.json
991	                FROM current_state_events as state
992	                LEFT JOIN event_json AS events ON (state.event_id = events.event_id)
993	                WHERE state.room_id > ? AND state.type = '%s'
994	                ORDER BY state.room_id ASC
995	                LIMIT ?;
996	                """
997	                % EventTypes.Retention,
998	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1124:16
1123	            txn.execute(
1124	                """
1125	                SELECT room_id
1126	                FROM rooms r
1127	                INNER JOIN current_state_events cse USING (room_id)
1128	                WHERE room_id > ? AND r.is_public
1129	                AND cse.type = '%s' AND cse.state_key = ''
1130	                ORDER BY room_id ASC
1131	                LIMIT ?;
1132	                """
1133	                % EventTypes.Tombstone,
1134	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1560:18
1559	
1560	            sql = """
1561	                SELECT COUNT(*) as total_event_reports
1562	                FROM event_reports AS er
1563	                {}
1564	                """.format(
1565	                where_clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1570:18
1569	
1570	            sql = """
1571	                SELECT
1572	                    er.id,
1573	                    er.received_ts,
1574	                    er.room_id,
1575	                    er.event_id,
1576	                    er.user_id,
1577	                    er.content,
1578	                    events.sender,
1579	                    room_stats_state.canonical_alias,
1580	                    room_stats_state.name
1581	                FROM event_reports AS er
1582	                LEFT JOIN events
1583	                    ON events.event_id = er.event_id
1584	                JOIN room_stats_state
1585	                    ON room_stats_state.room_id = er.room_id
1586	                {where_clause}
1587	                ORDER BY er.received_ts {order}
1588	                LIMIT ?
1589	                OFFSET ?
1590	            """.format(
1591	                where_clause=where_clause, order=order,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:337:14
336	
337	        sql = """
338	            SELECT room_id, e.sender, c.membership, event_id, e.stream_ordering
339	            FROM local_current_membership AS c
340	            INNER JOIN events AS e USING (room_id, event_id)
341	            WHERE
342	                user_id = ?
343	                AND %s
344	        """ % (
345	            clause,
346	        )
347	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:549:8
548	        # with a state_group of None are likely to be different.
549	        assert state_group is not None
550	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:710:8
709	        # with a state_group of None are likely to be different.
710	        assert state_group is not None
711	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:829:14
828	
829	        sql = """
830	            SELECT 1 FROM local_current_membership
831	            WHERE
832	                room_id = ? AND membership = ?
833	                AND NOT (%s)
834	                LIMIT 1
835	        """ % (
836	            clause,
837	        )
838	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\roommember.py:903:16
902	                    content = event_json["content"]
903	                except Exception:
904	                    continue
905	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\20\pushers.py:69:12
68	        cur.execute(
69	            """
70	                INSERT into pushers2 (
71	                id, user_name, access_token, profile_tag, kind,
72	                app_id, app_display_name, device_display_name,
73	                pushkey, ts, lang, data, last_token, last_success,
74	                failing_since
75	                ) values (%s)
76	            """
77	            % (",".join(["?" for _ in range(len(row))])),
78	            row,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\databases\main\schema\delta\30\as_users.py:25:4
24	        cur.execute("ALTER TABLE users ADD COLUMN appservice_id TEXT")
25	    except Exception:
26	        # Maybe we already added the column? Hope so...
27	        pass
28	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\30\as_users.py:62:16
61	            cur.execute(
62	                "UPDATE users SET appservice_id = ? WHERE name IN (%s)"
63	                % (",".join("?" for _ in chunk),),
64	                [as_id] + chunk,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\31\pushers.py:68:12
67	        cur.execute(
68	            """
69	                INSERT into pushers2 (
70	                id, user_name, access_token, profile_tag, kind,
71	                app_id, app_display_name, device_display_name,
72	                pushkey, ts, lang, data, last_stream_ordering, last_success,
73	                failing_since
74	                ) values (%s)
75	            """
76	            % (",".join(["?" for _ in range(len(row))])),
77	            row,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\48\group_unique_indexes.py:42:8
41	    cur.execute(
42	        """
43	        DELETE FROM group_users WHERE %s NOT IN (
44	           SELECT min(%s) FROM group_users GROUP BY group_id, user_id
45	        );
46	    """
47	        % (rowid, rowid)
48	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\48\group_unique_indexes.py:50:8
49	    cur.execute(
50	        """
51	        DELETE FROM group_invites WHERE %s NOT IN (
52	           SELECT min(%s) FROM group_invites GROUP BY group_id, user_id
53	        );
54	    """
55	        % (rowid, rowid)
56	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\search.py:128:16
127	            sql = (
128	                "SELECT stream_ordering, event_id, room_id, type, json, "
129	                " origin_server_ts FROM events"
130	                " JOIN event_json USING (room_id, event_id)"
131	                " WHERE ? <= stream_ordering AND stream_ordering < ?"
132	                " AND (%s)"
133	                " ORDER BY stream_ordering DESC"
134	                " LIMIT ?"
135	            ) % (" OR ".join("type = '%s'" % (t,) for t in TYPES),)
136	
137	            txn.execute(sql, (target_min_stream_id, max_stream_id, batch_size))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\search.py:160:20
159	                        content = event_json["content"]
160	                    except Exception:
161	                        continue
162	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\state_deltas.py:54:8
53	        # check we're not going backwards
54	        assert prev_stream_id <= max_stream_id
55	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:526:18
525	
526	            sql = """
527	                INSERT INTO %(table)s (%(insert_cols_cs)s)
528	                VALUES (%(insert_vals_qs)s)
529	                ON CONFLICT (%(key_columns)s) DO UPDATE SET %(updates)s
530	            """ % {
531	                "table": table,
532	                "insert_cols_cs": ", ".join(insert_cols),
533	                "insert_vals_qs": ", ".join(
534	                    ["?"] * (len(keyvalues) + len(absolutes) + len(additive_relatives))
535	                ),
536	                "key_columns": ", ".join(keyvalues),
537	                "updates": ", ".join(chain(absolute_updates, relative_updates)),
538	            }
539	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:611:18
610	
611	            sql = """
612	                INSERT INTO %(into_table)s (%(ins_columns)s)
613	                SELECT %(sel_exprs)s
614	                FROM %(src_table)s
615	                WHERE %(keyvalues_where)s
616	                ON CONFLICT (%(keyvalues)s)
617	                DO UPDATE SET %(sets)s
618	            """ % {
619	                "into_table": into_table,
620	                "ins_columns": ", ".join(ins_columns),
621	                "sel_exprs": ", ".join(sel_exprs),
622	                "keyvalues_where": " AND ".join(keyvalues_where),
623	                "src_table": src_table,
624	                "keyvalues": ", ".join(
625	                    chain(keyvalues.keys(), extra_dst_keyvalues.keys())
626	                ),
627	                "sets": ", ".join(chain(sets_cc, sets_ar)),
628	            }
629	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:714:14
713	
714	        sql = """
715	            SELECT events.room_id, COUNT(*) AS new_events, SUM(%s) AS new_bytes
716	            FROM events INNER JOIN event_json USING (event_id)
717	            WHERE (? < stream_ordering AND stream_ordering <= ?)
718	                OR (? <= stream_ordering AND stream_ordering <= ?)
719	            GROUP BY events.room_id
720	        """ % (
721	            new_bytes_expression,
722	        )
723	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:731:14
730	
731	        sql = """
732	            SELECT events.sender, COUNT(*) AS new_events, SUM(%s) AS new_bytes
733	            FROM events INNER JOIN event_json USING (event_id)
734	            WHERE (? < stream_ordering AND stream_ordering <= ?)
735	                OR (? <= stream_ordering AND stream_ordering <= ?)
736	            GROUP BY events.sender
737	        """ % (
738	            new_bytes_expression,
739	        )
740	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:983:18
982	            # SQLite does not support SELECT COUNT(*) OVER()
983	            sql = """
984	                SELECT COUNT(*) FROM (
985	                    SELECT lmr.user_id
986	                    {sql_base}
987	                ) AS count_user_ids
988	            """.format(
989	                sql_base=sql_base,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'stream'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:70:16
69	
70	_STREAM_TOKEN = "stream"
71	_TOPOLOGICAL_TOKEN = "topological"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'topological'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:71:21
70	_STREAM_TOKEN = "stream"
71	_TOPOLOGICAL_TOKEN = "topological"
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:121:4
120	    """
121	    assert direction in ("b", "f")
122	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:176:4
175	
176	    assert bound in (">", "<", ">=", "<=")
177	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stream.py:495:18
494	
495	            sql = """
496	                SELECT event_id, instance_name, topological_ordering, stream_ordering
497	                FROM events
498	                WHERE
499	                    room_id = ?
500	                    AND not outlier
501	                    AND stream_ordering > ? AND stream_ordering <= ?
502	                ORDER BY stream_ordering %s LIMIT ?
503	            """ % (
504	                order,
505	            )
506	            txn.execute(sql, (room_id, min_from_id, max_to_id, 2 * limit))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:858:8
857	        # This cannot happen as `allow_none=False`.
858	        assert results is not None
859	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1011:8
1010	        # Ensure we do actually have some values here
1011	        assert set(min_positions) == {"federation", "events"}
1012	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1063:8
1062	
1063	        assert int(limit) >= 0
1064	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:200:8
199	        """
200	        assert self._can_write_to_account_data
201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:226:8
225	        """
226	        assert self._can_write_to_account_data
227	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:254:8
253	        """
254	        assert self._can_write_to_account_data
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\transactions.py:234:8
233	    ):
234	        assert self.database_engine.can_native_upsert
235	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:155:18
154	            # if those 250 rooms have less than batch_size state events.
155	            sql = """
156	                SELECT room_id, events FROM %s
157	                ORDER BY events DESC
158	                LIMIT 250
159	            """ % (
160	                TEMP_TABLE + "_rooms",
161	            )
162	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:170:24
169	            # far we are in processing
170	            txn.execute("SELECT COUNT(*) FROM " + TEMP_TABLE + "_rooms")
171	            progress["remaining"] = txn.fetchone()[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:281:18
280	        def _get_next_batch(txn):
281	            sql = "SELECT user_id FROM %s LIMIT %s" % (
282	                TEMP_TABLE + "_users",
283	                str(batch_size),
284	            )
285	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:295:18
294	            # far we are in processing
295	            sql = "SELECT COUNT(*) FROM " + TEMP_TABLE + "_users"
296	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:761:18
760	            # search: (domain, _, display name, localpart)
761	            sql = """
762	                SELECT d.user_id AS user_id, display_name, avatar_url
763	                FROM user_directory_search as t
764	                INNER JOIN user_directory AS d USING (user_id)
765	                WHERE
766	                    %s
767	                    AND vector @@ to_tsquery('simple', ?)
768	                ORDER BY
769	                    (CASE WHEN d.user_id IS NOT NULL THEN 4.0 ELSE 1.0 END)
770	                    * (CASE WHEN display_name IS NOT NULL THEN 1.2 ELSE 1.0 END)
771	                    * (CASE WHEN avatar_url IS NOT NULL THEN 1.2 ELSE 1.0 END)
772	                    * (
773	                        3 * ts_rank_cd(
774	                            '{0.1, 0.1, 0.9, 1.0}',
775	                            vector,
776	                            to_tsquery('simple', ?),
777	                            8
778	                        )
779	                        + ts_rank_cd(
780	                            '{0.1, 0.1, 0.9, 1.0}',
781	                            vector,
782	                            to_tsquery('simple', ?),
783	                            8
784	                        )
785	                    )
786	                    DESC,
787	                    display_name IS NULL,
788	                    avatar_url IS NULL
789	                LIMIT ?
790	            """ % (
791	                where_clause,
792	            )
793	            args = join_args + (full_query, exact_query, prefix_query, limit + 1)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:797:18
796	
797	            sql = """
798	                SELECT d.user_id AS user_id, display_name, avatar_url
799	                FROM user_directory_search as t
800	                INNER JOIN user_directory AS d USING (user_id)
801	                WHERE
802	                    %s
803	                    AND value MATCH ?
804	                ORDER BY
805	                    rank(matchinfo(user_directory_search)) DESC,
806	                    display_name IS NULL,
807	                    avatar_url IS NULL
808	                LIMIT ?
809	            """ % (
810	                where_clause,
811	            )
812	            args = join_args + (search_query, limit + 1)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\state\bg_updates.py:144:24
143	                    txn.execute(
144	                        "SELECT type, state_key, event_id FROM state_groups_state"
145	                        " WHERE state_group = ? " + where_clause,
146	                        args,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\engines\postgres.py:169:8
168	        numver = self._version
169	        assert numver is not None
170	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:213:8
212	
213	        assert stores.persist_events
214	        self.persist_events_store = stores.persist_events

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:308:8
307	        # stream ordering should have been assigned by now
308	        assert event_stream_id
309	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:430:24
429	                        # extremities, so we'll `continue` above and skip this bit.)
430	                        assert new_latest_event_ids, "No forward extremities left!"
431	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:485:28
484	                            # extremities, so we'll `continue` above and skip this bit.)
485	                            assert new_latest_event_ids, "No forward extremities left!"
486	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:341:8
340	    if is_empty:
341	        assert not applied_delta_files
342	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:343:8
342	    else:
343	        assert config
344	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:358:8
357	
358	        assert config is not None
359	        check_database_before_upgrade(cur, database_engine, config)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:59:20
58	    if step == 1:
59	        cur.execute("SELECT MAX(%s) FROM %s" % (column, table))
60	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:61:20
60	    else:
61	        cur.execute("SELECT MIN(%s) FROM %s" % (column, table))
62	    (val,) = cur.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:95:8
94	    def __init__(self, db_conn, table, column, extra_tables=[], step=1):
95	        assert step != 0
96	        self._lock = threading.Lock()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:320:22
319	            for table, _, id_column in tables:
320	                sql = """
321	                    SELECT GREATEST(COALESCE(%(agg)s(%(id)s), 1), 1)
322	                    FROM %(table)s
323	                """ % {
324	                    "id": id_column,
325	                    "table": table,
326	                    "agg": "MAX" if self._positive else "-MIN",
327	                }
328	                cur.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:350:22
349	            for table, instance_column, id_column in tables:
350	                sql = """
351	                    SELECT %(instance)s, %(id)s FROM %(table)s
352	                    WHERE ? %(cmp)s %(id)s
353	                """ % {
354	                    "id": id_column,
355	                    "table": table,
356	                    "instance": instance_column,
357	                    "cmp": "<=" if self._positive else ">=",
358	                }
359	                cur.execute(sql, (min_stream_id * self._return_factor,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:544:8
543	        # We require that the lock is locked by caller
544	        assert self._lock.locked()
545	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:592:14
591	        # value (or decrease if stream goes backwards).
592	        sql = """
593	            INSERT INTO stream_positions (stream_name, instance_name, stream_id)
594	            VALUES (?, ?, ?)
595	            ON CONFLICT (stream_name, instance_name)
596	            DO UPDATE SET
597	                stream_id = %(agg)s(stream_positions.stream_id, EXCLUDED.stream_id)
598	        """ % {
599	            "agg": "GREATEST" if self._positive else "LEAST",
600	        }
601	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:131:20
130	        # First we get the current max ID from the table.
131	        table_sql = "SELECT GREATEST(%(agg)s(%(id)s), 0) FROM %(table)s" % {
132	            "id": id_column,
133	            "table": table,
134	            "agg": "MAX" if positive else "-MIN",
135	        }
136	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:148:12
147	        txn.execute(
148	            "SELECT last_value, is_called FROM %(seq)s" % {"seq": self._sequence_name}
149	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:220:16
219	            if self._current_max_id is None:
220	                assert self._callback is not None
221	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:230:16
229	            if self._current_max_id is None:
230	                assert self._callback is not None
231	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:502:8
501	                return cls(topological=None, stream=stream, instance_map=instance_map,)
502	        except Exception:
503	            pass
504	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:511:8
510	                return cls(topological=None, stream=int(string[1:]))
511	        except Exception:
512	            pass
513	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\types.py:553:8
552	        """
553	        assert self.topological is None
554	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async_helpers.py:82:16
81	                    self._observers.pop().callback(r)
82	                except Exception:
83	                    pass
84	            return r

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async_helpers.py:96:16
95	                    self._observers.pop().errback(f)
96	                except Exception:
97	                    pass
98	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\async_helpers.py:551:8
550	    if inspect.isawaitable(value):
551	        assert isinstance(value, Awaitable)
552	        return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\deferred_cache.py:160:16
159	                m = self.cache.metrics
160	                assert m  # we always have a name, so should always have metrics
161	                m.inc_hits()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:89:8
88	        """
89	        assert isinstance(stream_pos, int)
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:138:8
137	        """
138	        assert type(stream_pos) is int
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:157:8
156	        """
157	        assert type(stream_pos) is int
158	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:172:8
171	        """
172	        assert type(stream_pos) is int
173	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\metrics.py:119:12
118	        else:
119	            assert isinstance(curr_context, LoggingContext)
120	            parent_context = curr_context

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\retryutils.py:202:61
201	                self.retry_interval = int(
202	                    self.retry_interval * RETRY_MULTIPLIER * random.uniform(0.8, 1.4)
203	                )

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\util\versionstring.py:19:0
18	import os
19	import subprocess
20	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:48:16
47	            git_branch = (
48	                subprocess.check_output(
49	                    ["git", "rev-parse", "--abbrev-ref", "HEAD"], stderr=null, cwd=cwd
50	                )
51	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:48:16
47	            git_branch = (
48	                subprocess.check_output(
49	                    ["git", "rev-parse", "--abbrev-ref", "HEAD"], stderr=null, cwd=cwd
50	                )
51	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:61:16
60	            git_tag = (
61	                subprocess.check_output(
62	                    ["git", "describe", "--exact-match"], stderr=null, cwd=cwd
63	                )
64	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:61:16
60	            git_tag = (
61	                subprocess.check_output(
62	                    ["git", "describe", "--exact-match"], stderr=null, cwd=cwd
63	                )
64	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:73:16
72	            git_commit = (
73	                subprocess.check_output(
74	                    ["git", "rev-parse", "--short", "HEAD"], stderr=null, cwd=cwd
75	                )
76	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:73:16
72	            git_commit = (
73	                subprocess.check_output(
74	                    ["git", "rev-parse", "--short", "HEAD"], stderr=null, cwd=cwd
75	                )
76	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:85:16
84	            is_dirty = (
85	                subprocess.check_output(
86	                    ["git", "describe", "--dirty=" + dirty_string], stderr=null, cwd=cwd
87	                )
88	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:85:16
84	            is_dirty = (
85	                subprocess.check_output(
86	                    ["git", "describe", "--dirty=" + dirty_string], stderr=null, cwd=cwd
87	                )
88	                .strip()

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\visibility.py:311:20
310	                        domain = get_domain_from_id(ev.state_key)
311	                    except Exception:
312	                        continue
313	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:104:22
103	    def test_get_user_by_req_appservice_valid_token(self):
104	        app_service = Mock(
105	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
106	        )
107	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:121:22
120	
121	        app_service = Mock(
122	            token="foobar",
123	            url="a_url",
124	            sender=self.test_user,
125	            ip_range_whitelist=IPSet(["192.168/16"]),
126	        )
127	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:140:22
139	
140	        app_service = Mock(
141	            token="foobar",
142	            url="a_url",
143	            sender=self.test_user,
144	            ip_range_whitelist=IPSet(["192.168/16"]),
145	        )
146	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:171:22
170	    def test_get_user_by_req_appservice_missing_token(self):
171	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
172	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:185:22
184	        masquerading_user_id = b"@doppelganger:matrix.org"
185	        app_service = Mock(
186	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
187	        )
188	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:208:22
207	        masquerading_user_id = b"@doppelganger:matrix.org"
208	        app_service = Mock(
209	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
210	        )
211	        app_service.is_interested_in_user = Mock(return_value=False)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_frontend_proxy.py:39:35
38	                "port": 8080,
39	                "bind_addresses": ["0.0.0.0"],
40	                "resources": [{"names": ["client"]}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:60:31
59	            "type": "http",
60	            "bind_addresses": ["0.0.0.0"],
61	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:108:31
107	            "type": "http",
108	            "bind_addresses": ["0.0.0.0"],
109	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\appservice\test_appservice.py:32:23
31	    def setUp(self):
32	        self.service = ApplicationService(
33	            id="unique_identifier",
34	            sender="@as:test",
35	            url="some_url",
36	            token="some_token",
37	            hostname="matrix.org",  # only used by get_groups_for_user
38	            namespaces={
39	                ApplicationService.NS_USERS: [],
40	                ApplicationService.NS_ROOMS: [],
41	                ApplicationService.NS_ALIASES: [],
42	            },
43	        )
44	        self.event = Mock(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:146:12
145	            self.addCleanup(setattr, SSL, "SSL.OP_NO_TLSv1_3", OP_NO_TLSv1_3)
146	            assert not hasattr(SSL, "OP_NO_TLSv1_3")
147	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:168:12
167	            self.addCleanup(lambda: delattr(SSL, "OP_NO_TLSv1_3"))
168	            assert hasattr(SSL, "OP_NO_TLSv1_3")
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\federation\test_federation_catch_up.py:252:12
251	        ) -> bool:
252	            assert destination == destination_tm
253	            results_list.extend(pending_pdus)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:143:24
142	        service.is_interested.return_value = make_awaitable(is_interested)
143	        service.token = "mock_service_token"
144	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:150:24
149	        service.is_interested_in_alias.return_value = is_interested_in_alias
150	        service.token = "mock_service_token"
151	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'sometoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_federation.py:52:23
51	        # Send a 3PID invite event with an empty body so it's considered as a revoked one.
52	        invite_token = "sometoken"
53	        self.helper.send_state(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-client-secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_oidc.py:41:16
40	CLIENT_ID = "test-client-id"
41	CLIENT_SECRET = "test-client-secret"
42	BASE_URL = "https://synapse/"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\http\__init__.py:16:0
15	import os.path
16	import subprocess
17	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:90:4
89	    # first build a CSR
90	    subprocess.check_call(
91	        [
92	            "openssl",
93	            "req",
94	            "-new",
95	            "-key",
96	            get_test_key_file(),
97	            "-subj",
98	            "/",
99	            "-out",
100	            csr_filename,
101	        ]
102	    )
103	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:90:4
89	    # first build a CSR
90	    subprocess.check_call(
91	        [
92	            "openssl",
93	            "req",
94	            "-new",
95	            "-key",
96	            get_test_key_file(),
97	            "-subj",
98	            "/",
99	            "-out",
100	            csr_filename,
101	        ]
102	    )
103	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:112:4
111	    ca_cert_filename = get_test_ca_cert_file()
112	    subprocess.check_call(
113	        [
114	            "openssl",
115	            "x509",
116	            "-req",
117	            "-in",
118	            csr_filename,
119	            "-CA",
120	            ca_cert_filename,
121	            "-CAkey",
122	            ca_key_filename,
123	            "-set_serial",
124	            "1",
125	            "-extfile",
126	            cnf_filename,
127	            "-out",
128	            cert_filename,
129	        ]
130	    )
131	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:112:4
111	    ca_cert_filename = get_test_ca_cert_file()
112	    subprocess.check_call(
113	        [
114	            "openssl",
115	            "x509",
116	            "-req",
117	            "-in",
118	            csr_filename,
119	            "-CA",
120	            ca_cert_filename,
121	            "-CAkey",
122	            ca_key_filename,
123	            "-set_serial",
124	            "1",
125	            "-extfile",
126	            cnf_filename,
127	            "-out",
128	            cert_filename,
129	        ]
130	    )
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_email.py:183:8
182	        # Nothing should have happened yet, as we're paused.
183	        assert not self.email_attempts
184	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_presentable_names.py:56:8
55	    ) -> Optional[FrozenEvent]:
56	        assert allow_none, "Mock not configured for allow_none = False"
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\_base.py:450:8
449	    def __call__(self, *args, **kwargs):
450	        assert self.request is None
451	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\replication\_base.py:555:12
554	                self._consumer.unregisterProducer()
555	            except Exception:
556	                pass
557	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\slave\storage\test_events.py:249:8
248	        repl_transport = self._server_transport
249	        assert isinstance(repl_transport, FakeTransport)
250	        repl_transport.autoflush = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:33:8
32	        cmd = parse_command_from_line(line)
33	        assert isinstance(cmd, RdataCommand)
34	        self.assertEqual(cmd.stream_name, "events")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:41:8
40	        cmd = parse_command_from_line(line)
41	        assert isinstance(cmd, RdataCommand)
42	        self.assertEqual(cmd.stream_name, "presence")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\test_federation_ack.py:71:8
70	        cmd = mock_connection.send_command.call_args[0][0]
71	        assert isinstance(cmd, FederationAckCommand)
72	        self.assertEqual(cmd.token, 10)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\admin\test_user.py:62:52
61	
62	        self.hs.config.registration_shared_secret = "shared"
63	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_consent.py:40:15
39	        config["public_baseurl"] = "aaaa"
40	        config["form_secret"] = "123abc"
41	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_login.py:732:17
731	
732	    jwt_secret = "secret"
733	    jwt_algorithm = "HS256"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\v1\test_login.py:998:23
997	
998	        self.service = ApplicationService(
999	            id="unique_identifier",
1000	            token="some_token",
1001	            hostname="example.com",
1002	            sender="@asbot:example.com",
1003	            namespaces={
1004	                ApplicationService.NS_USERS: [
1005	                    {"regex": r"@as_user.*", "exclusive": False}
1006	                ],
1007	                ApplicationService.NS_ROOMS: [],
1008	                ApplicationService.NS_ALIASES: [],
1009	            },
1010	        )
1011	        self.another_service = ApplicationService(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'another_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\v1\test_login.py:1011:31
1010	        )
1011	        self.another_service = ApplicationService(
1012	            id="another__identifier",
1013	            token="another_token",
1014	            hostname="example.com",
1015	            sender="@as2bot:example.com",
1016	            namespaces={
1017	                ApplicationService.NS_USERS: [
1018	                    {"regex": r"@as2_user.*", "exclusive": False}
1019	                ],
1020	                ApplicationService.NS_ROOMS: [],
1021	                ApplicationService.NS_ALIASES: [],
1022	            },
1023	        )
1024	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 't1-0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:815:16
814	    def test_topo_token_is_accepted(self):
815	        token = "t1-0_0_0_0_0_0_0_0_0"
816	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:826:16
825	    def test_stream_token_is_accepted_for_fwd_pagianation(self):
826	        token = "s0_0_0_0_0_0_0_0_0"
827	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1369:16
1368	
1369	        token = "s0_0_0_0_0_0_0_0_0"
1370	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1386:16
1385	
1386	        token = "s0_0_0_0_0_0_0_0_0"
1387	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1409:16
1408	
1409	        token = "s0_0_0_0_0_0_0_0_0"
1410	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:93:8
92	
93	        assert channel.result["code"] == b"%d" % expect_code, channel.result
94	        self.auth_user_id = temp_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:169:8
168	
169	        assert int(channel.result["code"]) == expect_code, (
170	            "Expected: %d, got: %d, resp: %r"
171	            % (expect_code, int(channel.result["code"]), channel.result["body"])
172	        )
173	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:204:8
203	
204	        assert int(channel.result["code"]) == expect_code, (
205	            "Expected: %d, got: %d, resp: %r"
206	            % (expect_code, int(channel.result["code"]), channel.result["body"])
207	        )
208	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:254:8
253	
254	        assert int(channel.result["code"]) == expect_code, (
255	            "Expected: %d, got: %d, resp: %r"
256	            % (expect_code, int(channel.result["code"]), channel.result["body"])
257	        )
258	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:345:8
344	
345	        assert channel.code == expect_code, "Expected: %d, got: %d, resp: %r" % (
346	            expect_code,
347	            int(channel.result["code"]),
348	            channel.result["body"],
349	        )
350	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:369:8
368	        # expect a confirmation page
369	        assert channel.code == 200, channel.result
370	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:376:8
375	        )
376	        assert m, channel.text_body
377	        login_token = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:388:8
387	        )
388	        assert channel.code == 200
389	        return channel.json_body

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:432:12
431	            # can't set the client redirect url for UI Auth
432	            assert client_redirect_url is None
433	            oauth_uri = self.initiate_sso_ui_auth(ui_auth_session_id, cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:444:8
443	        oauth_uri_path, _ = oauth_uri.split("?", 1)
444	        assert oauth_uri_path == TEST_OIDC_AUTH_ENDPOINT, (
445	            "unexpected SSO URI " + oauth_uri_path
446	        )
447	        return self.complete_oidc_auth(oauth_uri, cookies, user_info_dict)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:492:12
491	            (expected_uri, resp_obj) = expected_requests.pop(0)
492	            assert uri == expected_uri
493	            resp = FakeResponse(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:539:8
538	
539	        assert channel.code == 302
540	        channel.extract_cookies(cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:567:8
566	        # that should serve a confirmation page
567	        assert channel.code == 200, channel.text_body
568	        channel.extract_cookies(cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:574:8
573	        p.close()
574	        assert len(p.links) == 1, "not exactly one link in confirmation page"
575	        oauth_uri = p.links[0]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://issuer.test/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\utils.py:581:27
580	TEST_OIDC_AUTH_ENDPOINT = "https://issuer.test/auth"
581	TEST_OIDC_TOKEN_ENDPOINT = "https://issuer.test/token"
582	TEST_OIDC_USERINFO_ENDPOINT = "https://issuer.test/userinfo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:80:23
79	        """
80	        old_password = "monkey"
81	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:81:23
80	        old_password = "monkey"
81	        new_password = "kangeroo"
82	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:99:24
98	
99	        client_secret = "foobar"
100	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:119:23
118	        """
119	        old_password = "monkey"
120	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:120:23
119	        old_password = "monkey"
120	        new_password = "kangeroo"
121	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:139:24
138	
139	        client_secret = "foobar"
140	        session_id = self._request_token(email_passwort_reset, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:158:23
157	        """
158	        old_password = "monkey"
159	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:159:23
158	        old_password = "monkey"
159	        new_password = "kangeroo"
160	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:177:24
176	
177	        client_secret = "foobar"
178	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:195:23
194	        """
195	        old_password = "monkey"
196	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:196:23
195	        old_password = "monkey"
196	        new_password = "kangeroo"
197	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:214:24
213	
214	        client_secret = "foobar"
215	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:237:24
236	
237	        client_secret = "foobar"
238	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:283:8
282	    def _get_link_from_email(self):
283	        assert self.email_attempts, "No emails have been sent"
284	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:298:8
297	        match = re.search(r"https://example.com\S+", text)
298	        assert match, "Could not find link in email"
299	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:517:24
516	
517	        client_secret = "foobar"
518	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:618:24
617	        """
618	        client_secret = "foobar"
619	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:653:24
652	        """
653	        client_secret = "foobar"
654	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:784:4
783	
784	    def _request_token_invalid_email(
785	        self, email, expected_errcode, expected_error, client_secret="foobar",
786	    ):
787	        channel = self.make_request(
788	            "POST",
789	            b"account/3pid/email/requestToken",
790	            {"client_secret": client_secret, "email": email, "send_attempt": 1},
791	        )
792	        self.assertEqual(400, int(channel.result["code"]), msg=channel.result["body"])
793	        self.assertEqual(expected_errcode, channel.json_body["errcode"])
794	        self.assertEqual(expected_error, channel.json_body["error"])
795	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:804:8
803	    def _get_link_from_email(self):
804	        assert self.email_attempts, "No emails have been sent"
805	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:819:8
818	        match = re.search(r"https://example.com\S+", text)
819	        assert match, "Could not find link in email"
820	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:826:24
825	        """
826	        client_secret = "foobar"
827	        session_id = self._request_token(request_email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_auth.py:182:25
181	    def prepare(self, reactor, clock, hs):
182	        self.user_pass = "pass"
183	        self.user = self.register_user("test", self.user_pass)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_capabilities.py:61:19
60	        localpart = "user"
61	        password = "pass"
62	        user = self.register_user(localpart, password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'C0mpl!antpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_password_policy.py:145:29
144	        """
145	        compliant_password = "C0mpl!antpassword"
146	        not_compliant_password = "notcompliantpassword"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'notcompliantpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_password_policy.py:146:33
145	        compliant_password = "C0mpl!antpassword"
146	        not_compliant_password = "notcompliantpassword"
147	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:51:19
50	        user_id = "@as_user_kermit:test"
51	        as_token = "i_am_an_app_service"
52	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:127:45
126	    def test_POST_guest_registration(self):
127	        self.hs.config.macaroon_secret_key = "test"
128	        self.hs.config.allow_guest_access = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:151:25
150	        for _ in range(20):
151	            from_token = ""
152	            if prev_token:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:209:25
208	        for _ in range(20):
209	            from_token = ""
210	            if prev_token:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:278:25
277	        for _ in range(20):
278	            from_token = ""
279	            if prev_token:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:214:8
213	        keyres = res["targetserver"][keyid]
214	        assert isinstance(keyres, FetchKeyResult)
215	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:236:8
235	        keyres = res[self.hs.hostname][keyid]
236	        assert isinstance(keyres, FetchKeyResult)
237	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:253:8
252	        keyres = res[self.hs.hostname][keyid]
253	        assert isinstance(keyres, FetchKeyResult)
254	        self.assertEqual(

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tests\rest\media\v1\test_url_preview.py:30:4
29	try:
30	    import lxml
31	except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\server.py:92:8
91	    def write(self, content):
92	        assert isinstance(content, bytes), "Should be bytes! " + repr(content)
93	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\server_notices\test_consent.py:49:15
48	        config["public_baseurl"] = "https://example.com/"
49	        config["form_secret"] = "123abc"
50	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\storage\test_appservice.py:50:24
49	
50	        self.as_token = "token1"
51	        self.as_url = "some_url"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\storage\test_appservice.py:69:12
68	                os.remove(f)
69	            except Exception:
70	                pass
71	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:538:13
537	    def test_duplicate_as_tokens(self):
538	        f1 = self._write_config(as_token="as_token", suffix="1")
539	        f2 = self._write_config(as_token="as_token", suffix="2")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:539:13
538	        f1 = self._write_config(as_token="as_token", suffix="1")
539	        f2 = self._write_config(as_token="as_token", suffix="2")
540	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\tests\storage\test_id_generators.py:645:20
644	                txn.execute(
645	                    "INSERT INTO %s VALUES (nextval('foobar_seq'), ?)" % (table,),
646	                    (instance_name,),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_redaction.py:241:16
240	                built_event._dict["event_id"] = self._event_id
241	                assert built_event.event_id == self._event_id
242	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobartoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_mau.py:105:19
104	        # with.
105	        as_token = "foobartoken"
106	        self.store.services_cache.append(

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tests\test_preview.py:24:4
23	try:
24	    import lxml
25	except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\event_injection.py:75:4
74	    persistence = hs.get_storage().persistence
75	    assert persistence is not None
76	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\html_parsers.py:46:16
45	            if attr_dict["type"] == "radio":
46	                assert input_name
47	                self.radios.setdefault(input_name, []).append(attr_dict["value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\html_parsers.py:49:16
48	            elif attr_dict["type"] == "hidden":
49	                assert input_name
50	                self.hiddens[input_name] = attr_dict["value"]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittest.py:542:52
541	        """
542	        self.hs.config.registration_shared_secret = "shared"
543	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:666:16
665	            async def list_fn(self, args1, arg2):
666	                assert current_context().request == "c1"
667	                # we want this to behave like an asynchronous function

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:669:16
668	                await run_on_reactor()
669	                assert current_context().request == "c1"
670	                return self.mock(args1, arg2)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:332:15
331	    async def hash(p):
332	        return hashlib.md5(p.encode("utf8")).hexdigest()
333	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:337:15
336	    async def validate_hash(p, h):
337	        return hashlib.md5(p.encode("utf8")).hexdigest() == h
338	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\utils.py:410:8
409	            path = mock_request.path
410	        except Exception:
411	            pass
412	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\utils.py:452:8
451	    def verify(self, message, sig):
452	        assert sig == b"\x9a\x87$"
453	

--------------------------------------------------

Code scanned:
	Total lines of code: 141984
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 383
		Medium: 108
		High: 8
	Total issues (by confidence):
		Undefined: 0
		Low: 69
		Medium: 125
		High: 305
Files skipped (0):
