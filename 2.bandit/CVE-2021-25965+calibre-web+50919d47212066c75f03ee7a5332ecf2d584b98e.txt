Working... ---------------------------------------- 100% 0:00:03
Run started:2024-02-10 22:00:01.402163

Test results:
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\__init__.py:41:4
40	try:
41	    import lxml
42	    lxml_present = True

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\cps\admin.py:948:8
947	            data["sort"] = data["fullpath"].lower()
948	        except Exception:
949	            continue
950	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\admin.py:1740:23
1739	    content.name = username
1740	    content.password = ''  # dummy password which will be replaced by ldap one
1741	    content.email = useremail

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\db.py:844:16
843	                    old_session.close()
844	                except Exception:
845	                    pass
846	                if old_session.bind:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\db.py:849:20
848	                        old_session.bind.dispose()
849	                    except Exception:
850	                        pass
851	

--------------------------------------------------
>> Issue: [B410:blacklist] Using clean_html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace clean_html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\editbooks.py:31:4
30	try:
31	    from lxml.html.clean import clean_html
32	except ImportError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\epub.py:22:0
21	import zipfile
22	from lxml import etree
23	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:54:11
53	    txt = epubZip.read('META-INF/container.xml')
54	    tree = etree.fromstring(txt)
55	    cfname = tree.xpath('n:rootfiles/n:rootfile/@full-path', namespaces=ns)[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:57:11
56	    cf = epubZip.read(cfname)
57	    tree = etree.fromstring(cf)
58	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:127:29
126	                markup = epubZip.read(os.path.join(coverpath, coversection[0]))
127	                markupTree = etree.fromstring(markup)
128	                # no matter xhtml or html with no namespace

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\fb2.py:20:0
19	from __future__ import division, print_function, unicode_literals
20	from lxml import etree
21	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\fb2.py:33:11
32	    fb2_file = open(tmp_file_path, encoding="utf-8")
33	    tree = etree.fromstring(fb2_file.read().encode())
34	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\comicvine.py:37:21
36	
37	            result = requests.get("https://comicvine.gamespot.com/api/search?api_key="
38	                                  + apikey + "&resources=issue&query=" + query + "&sort=name:desc&format=json", headers=headers)
39	            for r in result.json()['results']:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\google.py:32:21
31	            val = list()
32	            result = requests.get("https://www.googleapis.com/books/v1/volumes?q="+query.replace(" ","+"))
33	            for r in result.json()['items']:

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o660 on file (socket_file).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\cps\server.py:112:8
111	        # between the user running calibre-web and the user running the fronting webserver
112	        os.chmod(socket_file, 0o660)
113	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cps\server.py:126:34
125	        if os.name == 'nt':
126	            self.listen_address = '0.0.0.0'
127	            return (self.listen_address, self.listen_port), None

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\services\simpleldap.py:49:51
48	            if config.config_ldap_serv_password is None:
49	                config.config_ldap_serv_password = ''
50	            app.config['LDAP_PASSWORD'] = base64.b64decode(config.config_ldap_serv_password)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\cps\subproc_wrapper.py:22:0
21	import os
22	import subprocess
23	import re

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\ub.py:768:20
767	    user.role = constants.ROLE_ANONYMOUS
768	    user.password = ''
769	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\ub.py:841:8
840	            old_session.close()
841	        except Exception:
842	            pass
843	        if old_session.bind:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\ub.py:846:12
845	                old_session.bind.dispose()
846	            except Exception:
847	                pass
848	

--------------------------------------------------
>> Issue: [B410:blacklist] Using LXML_VERSION to parse untrusted XML data is known to be vulnerable to XML attacks. Replace LXML_VERSION with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\uploader.py:33:4
32	try:
33	    from lxml.etree import LXML_VERSION as lxmlversion
34	except ImportError:

--------------------------------------------------

Code scanned:
	Total lines of code: 21022
	Total lines skipped (#nosec): 12
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 14
		Medium: 8
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 2
		Medium: 4
		High: 16
Files skipped (0):
