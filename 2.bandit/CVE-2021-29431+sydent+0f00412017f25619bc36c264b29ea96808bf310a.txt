Working... ---------------------------------------- 100% 0:00:00
Run started:2024-02-10 22:01:37.828372

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\matrix_is_test\launcher.py:21:0
20	import time
21	from subprocess import Popen
22	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\matrix_is_test\launcher.py:80:23
79	
80	        self.process = Popen(
81	            args=[pybin, '-m', 'sydent.sydent'],
82	            cwd=self.tmpdir,
83	            env=newEnv,
84	            stderr=stderr_fp,
85	        )
86	        # XXX: wait for startup in a sensible way

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\hashing_metadata.py:95:14
94	        # Medium/address combos are marked as UNIQUE in the database
95	        sql = "SELECT COUNT(*) FROM %s" % table
96	        res = cur.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\hashing_metadata.py:106:16
105	            sql = (
106	                "SELECT medium, address FROM %s ORDER BY id LIMIT %s OFFSET %s" %
107	                (table, batch_size, count)
108	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\hashing_metadata.py:127:20
126	                sql = (
127	                    "UPDATE %s SET lookup_hash = ? "
128	                    "WHERE medium = ? AND address = ?"
129	                    % table
130	                )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\valsession.py:158:20
157	
158	        cur.execute("select id, medium, address, clientSecret, validated, mtime from "+
159	            "threepid_validation_sessions where id = ?", (sid,))
160	        row = cur.fetchone()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\http\matrixfederationagent.py:339:28
338	            cache_period = WELL_KNOWN_INVALID_CACHE_PERIOD
339	            cache_period += random.uniform(0, WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER)
340	            defer.returnValue((None, cache_period))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\http\matrixfederationagent.py:353:28
352	            # after startup
353	            cache_period += random.uniform(0, WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER)
354	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sydent\http\servlets\emailservlet.py:100:8
99	            resp = self.do_validate_request(request)
100	        except:
101	            pass
102	        if resp and 'success' in resp and resp['success']:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\http\srvresolver.py:70:20
69	    total_weight = sum(s.weight for s in eligible_servers)
70	    target_weight = random.randint(0, total_weight)
71	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\util\emailutils.py:61:25
60	        myHostname = socket.getfqdn()
61	    midRandom = "".join([random.choice(string.ascii_letters) for _ in range(16)])
62	    messageid = "<%d%s@%s>" % (time_msec(), midRandom, myHostname)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testingtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_auth.py:29:26
28	        self.sydent = make_sydent()
29	        self.test_token = "testingtoken"
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_replication.py:162:12
161	            # Check the method and the URI.
162	            assert method == b'POST'
163	            assert uri == b'https://fake.server:1234/_matrix/identity/replicate/v1/push'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_replication.py:163:12
162	            assert method == b'POST'
163	            assert uri == b'https://fake.server:1234/_matrix/identity/replicate/v1/push'
164	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\utils.py:105:8
104	    def write(self, content):
105	        assert isinstance(content, bytes), "Should be bytes! " + repr(content)
106	

--------------------------------------------------

Code scanned:
	Total lines of code: 5782
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 11
		Medium: 4
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 3
		Medium: 2
		High: 10
Files skipped (0):
