Working... ---------------------------------------- 100% 0:00:17
Run started:2024-02-10 22:02:05.878037

Test results:
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'postgres'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\.buildkite\scripts\create_postgres_db.py:29:14
28	    # doesn't exist yet.
29	    db_conn = db_engine.module.connect(
30	        user="postgres", host="postgres", password="postgres", dbname="postgres"
31	    )
32	    db_conn.autocommit = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'END'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\console.py:64:34
63	        self.path_prefix = "/_matrix/client/api/v1"
64	        self.event_stream_token = "END"
65	        self.prompt = ">>> "

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:586:12
585	                args["path"] = parsed_url.path
586	            except Exception:
587	                pass
588	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:777:12
776	                http_client.verbose = "on" == syn_cmd.config["verbose"]
777	            except Exception:
778	                pass
779	            print("Loaded config from %s" % config_path)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:780:4
779	            print("Loaded config from %s" % config_path)
780	    except Exception:
781	        pass
782	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '[REDACTED]'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\http.py:148:30
147	                temp = producer.data["password"]
148	                producer.data["password"] = "[REDACTED]"
149	                print(json.dumps(producer.data, indent=4))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:14:0
13	import json
14	import subprocess
15	import time

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:21:15
20	
21	ACCESS_TOKEN = ""
22	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:166:12
165	        print("sdp from matrix client", answer)
166	        p = subprocess.Popen(
167	            ["node", "unjingle/unjingle.js", "--sdp"],
168	            stdin=subprocess.PIPE,
169	            stdout=subprocess.PIPE,
170	        )
171	        jingle, out_err = p.communicate(answer)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:166:12
165	        print("sdp from matrix client", answer)
166	        p = subprocess.Popen(
167	            ["node", "unjingle/unjingle.js", "--sdp"],
168	            stdin=subprocess.PIPE,
169	            stdout=subprocess.PIPE,
170	        )
171	        jingle, out_err = p.communicate(answer)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:276:12
275	        self.callsid = jingle["sid"]
276	        p = subprocess.Popen(
277	            ["node", "unjingle/unjingle.js", "--jingle"],
278	            stdin=subprocess.PIPE,
279	            stdout=subprocess.PIPE,
280	        )
281	        print("raw jingle invite", str(jingle))

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\contrib\jitsimeetbridge\jitsimeetbridge.py:276:12
275	        self.callsid = jingle["sid"]
276	        p = subprocess.Popen(
277	            ["node", "unjingle/unjingle.js", "--jingle"],
278	            stdin=subprocess.PIPE,
279	            stdout=subprocess.PIPE,
280	        )
281	        print("raw jingle invite", str(jingle))

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib\scripts\kick_users.py:28:10
27	    print("Getting room state => %s" % room_state_url)
28	    res = requests.get(room_state_url)
29	    print("HTTP %s" % res.status_code)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\contrib\scripts\kick_users.py:67:18
66	            print("Kicking %s" % uid)
67	            res = requests.put(kick_url, data=json.dumps(kick_body))
68	            if res.status_code != 200:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docker\configure_workers_and_start.py:30:0
29	import os
30	import subprocess
31	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\configure_workers_and_start.py:301:4
300	    os.environ["SYNAPSE_HTTP_PORT"] = str(MAIN_PROCESS_HTTP_LISTENER_PORT)
301	    subprocess.check_output(["/usr/local/bin/python", "/start.py", "migrate_config"])
302	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\configure_workers_and_start.py:524:4
523	    """
524	    subprocess.run(["/usr/bin/supervisord"], stdin=subprocess.PIPE)
525	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docker\start.py:7:0
6	import platform
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:123:8
122	    if ownership is not None:
123	        subprocess.check_output(["chown", "-R", ownership, "/data"])
124	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:123:8
122	    if ownership is not None:
123	        subprocess.check_output(["chown", "-R", ownership, "/data"])
124	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:126:4
125	
126	    subprocess.check_output(args)
127	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:174:8
173	        # make sure that synapse has perms to write to the data dir.
174	        subprocess.check_output(["chown", ownership, data_dir])
175	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:174:8
173	        # make sure that synapse has perms to write to the data dir.
174	        subprocess.check_output(["chown", ownership, data_dir])
175	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:177:8
176	        args = ["gosu", ownership] + args
177	        os.execv("/usr/sbin/gosu", args)
178	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:179:8
178	    else:
179	        os.execv("/usr/local/bin/python", args)
180	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:259:8
258	        args = ["gosu", ownership] + args
259	        os.execve("/usr/sbin/gosu", args, environ)
260	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:261:8
260	    else:
261	        os.execve("/usr/local/bin/python", args, environ)
262	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\convert_server_keys.py:81:4
80	    database = config["database"]
81	    assert database["name"] == "psycopg2", "Can only convert for postgresql"
82	    args = database["args"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\federation_client.py:260:19
259	        try:
260	            resp = requests.get(uri)
261	            if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts-dev\release.py:20:0
19	
20	import subprocess
21	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\release.py:79:4
78	    current_version = version.parse(version_node.value.value.strip('"'))
79	    assert isinstance(current_version, version.Version)
80	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:189:4
188	    # Generate changelogs
189	    subprocess.run("python3 -m towncrier", shell=True)
190	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:189:4
188	    # Generate changelogs
189	    subprocess.run("python3 -m towncrier", shell=True)
190	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:194:8
193	        subprocess.run(
194	            f'dch -M -v {new_version} "New synapse release {new_version}."', shell=True
195	        )
196	        subprocess.run('dch -M -r -D stable ""', shell=True)
197	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:196:8
195	        )
196	        subprocess.run('dch -M -r -D stable ""', shell=True)
197	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:196:8
195	        )
196	        subprocess.run('dch -M -r -D stable ""', shell=True)
197	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:200:4
199	    repo.git.add("-u")
200	    subprocess.run("git diff --cached", shell=True)
201	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:200:4
199	    repo.git.add("-u")
200	    subprocess.run("git diff --cached", shell=True)
201	

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\scripts-dev\tail-synapse.py:36:8
35	        requests.get(
36	            server + "/_synapse/replication", verify=False, params=streams
37	        ).content
38	    )
39	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\tail-synapse.py:35:8
34	    return parse_response(
35	        requests.get(
36	            server + "/_synapse/replication", verify=False, params=streams
37	        ).content
38	    )

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\setup.py:80:4
79	    code = read_file(path_segments)
80	    exec(code, result)
81	    return result

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:42:8
41	    # Get the nonce
42	    r = requests.get(url, verify=False)
43	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:42:8
41	    # Get the nonce
42	    r = requests.get(url, verify=False)
43	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:49:12
48	                _print(r.json()["error"])
49	            except Exception:
50	                pass
51	        return exit(1)

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:80:8
79	    _print("Sending registration request...")
80	    r = requests.post(url, json=data, verify=False)
81	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:80:8
79	    _print("Sending registration request...")
80	    r = requests.post(url, json=data, verify=False)
81	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:87:12
86	                _print(r.json()["error"])
87	            except Exception:
88	                pass
89	        return exit(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:283:8
282	        # This will always be set by the time Twisted calls us.
283	        assert request.args is not None
284	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:564:8
563	        # This will always be set by the time Twisted calls us.
564	        assert request.args is not None
565	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:583:8
582	        # This will always be set by the time Twisted calls us.
583	        assert request.args is not None
584	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth_blocking.py:106:12
105	        if self._limit_usage_by_mau is True:
106	            assert not (user_id and threepid)
107	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\constants.py:69:15
68	class LoginType:
69	    PASSWORD = "m.login.password"
70	    EMAIL_IDENTITY = "m.login.email.identity"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_MISSING_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:45:20
44	    NOT_FOUND = "M_NOT_FOUND"
45	    MISSING_TOKEN = "M_MISSING_TOKEN"
46	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_UNKNOWN_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:46:20
45	    MISSING_TOKEN = "M_MISSING_TOKEN"
46	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"
47	    GUEST_ACCESS_FORBIDDEN = "M_GUEST_ACCESS_FORBIDDEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_TOO_SHORT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:68:25
67	    EXPIRED_ACCOUNT = "ORG_MATRIX_EXPIRED_ACCOUNT"
68	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
69	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_DIGIT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:69:24
68	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
69	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
70	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_UPPERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:70:28
69	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
70	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
71	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_LOWERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:71:28
70	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
71	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
72	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_SYMBOL'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:72:25
71	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
72	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
73	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_IN_DICTIONARY'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:73:29
72	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
73	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
74	    WEAK_PASSWORD = "M_WEAK_PASSWORD"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_WEAK_PASSWORD'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:74:20
73	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
74	    WEAK_PASSWORD = "M_WEAK_PASSWORD"
75	    INVALID_SIGNATURE = "M_INVALID_SIGNATURE"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\app\__init__.py:45:18
44	    """
45	    if address == "0.0.0.0" and "::" in bind_addresses:
46	        logger.warning(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'rabbithole'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\app\_base.py:215:8
214	        port,
215	        manhole(username="matrix", password="rabbithole", globals=manhole_globals),
216	    )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\admin_cmd.py:187:8
186	    if config.worker_app is not None:
187	        assert config.worker_app == "synapse.app.admin_cmd"
188	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:261:8
260	
261	        assert listener_config.http_options is not None
262	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:410:4
409	    # For backwards compatibility let any of the old app names.
410	    assert config.worker_app in (
411	        "synapse.app.appservice",
412	        "synapse.app.client_reader",
413	        "synapse.app.event_creator",
414	        "synapse.app.federation_reader",
415	        "synapse.app.federation_sender",
416	        "synapse.app.frontend_proxy",
417	        "synapse.app.generic_worker",
418	        "synapse.app.media_repository",
419	        "synapse.app.pusher",
420	        "synapse.app.synchrotron",
421	        "synapse.app.user_dir",
422	    )
423	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\synapse\app\homeserver.py:473:20
472	                profile.dump_stats(
473	                    "/tmp/%s.%s.%i.pstat" % (hs.hostname, func.__name__, ident)
474	                )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:318:18
317	        dict_copy = self.__dict__.copy()
318	        dict_copy["token"] = "<redacted>"
319	        dict_copy["hs_token"] = "<redacted>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:319:18
318	        dict_copy["token"] = "<redacted>"
319	        dict_copy["hs_token"] = "<redacted>"
320	        return "ApplicationService: %s" % (dict_copy,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:140:8
139	        # running.
140	        assert service.id not in self.requests_in_flight
141	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:234:8
233	        logger.info("Starting recoverer for AS ID %s", service.id)
234	        assert service.id not in self.recoverers
235	        recoverer = self.RECOVERER_CLASS(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Password reset emails are enabled on this homeserver due to a partial
'email' block. However, the following required keys are missing:
    %s
'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\emailconfig.py:27:38
26	
27	MISSING_PASSWORD_RESET_CONFIG_ERROR = """\
28	Password reset emails are enabled on this homeserver due to a partial
29	'email' block. However, the following required keys are missing:
30	    %s
31	"""
32	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#macaroon_secret_key: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:177:34
176	        else:
177	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
178	            form_secret = "#form_secret: <PRIVATE STRING>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#form_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:178:26
177	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
178	            form_secret = "#form_secret: <PRIVATE STRING>"
179	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\config\logger.py:251:12
250	                print("logging during logging: %s" % event_text, file=sys.__stderr__)
251	            except Exception:
252	                # gah.
253	                pass
254	            return

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#registration_shared_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\registration.py:131:41
130	        else:
131	            registration_shared_secret = "#registration_shared_secret: <PRIVATE STRING>"
132	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\repository.py:194:17
193	                config["url_preview_ip_range_blacklist"],
194	                ["0.0.0.0", "::"],
195	                config_path=("url_preview_ip_range_blacklist",),

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:42:32
41	# in the list.
42	DEFAULT_BIND_ADDRESSES = ["::", "0.0.0.0"]
43	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:394:33
393	        self.ip_range_blacklist = generate_ip_set(
394	            ip_range_blacklist, ["0.0.0.0", "::"], config_path=("ip_range_blacklist",)
395	        )

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:410:13
409	            federation_ip_range_blacklist,
410	            ["0.0.0.0", "::"],
411	            config_path=("federation_ip_range_blacklist",),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\server.py:1332:8
1331	    try:
1332	        assert len(thresholds) == 3
1333	        return (int(thresholds[0]), int(thresholds[1]), int(thresholds[2]))

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:1360:34
1359	            # the metrics listener doesn't support IPv6
1360	            bind_addresses.append("0.0.0.0")
1361	        else:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\tls.py:63:76
62	        self.acme_port = acme_config.get("port", 80)
63	        self.acme_bind_addresses = acme_config.get("bind_addresses", ["::", "0.0.0.0"])
64	        self.acme_reprovision_threshold = acme_config.get("reprovision_threshold", 30)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:403:12
402	            # any completed requests should already have been removed
403	            assert not verify_request.key_ready.called
404	            keys_for_server = missing_keys[verify_request.server_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:697:8
696	
697	        assert isinstance(query_response, dict)
698	        for response in query_response["server_keys"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:860:12
859	
860	            assert isinstance(response, dict)
861	            if response["server_name"] != server_name:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\event_auth.py:57:4
56	    """
57	    assert isinstance(auth_events, dict)
58	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:224:8
223	    ):
224	        assert room_version.event_format == self.format_version
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:404:8
403	
404	        assert "event_id" not in event_dict
405	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\spamcheck.py:235:16
234	                behaviour = await maybe_awaitable(d)
235	                assert isinstance(behaviour, RegistrationBehaviour)
236	                if behaviour != RegistrationBehaviour.ALLOW:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\federation_server.py:214:8
213	        # add an entry to _active_transactions.
214	        assert origin not in self._active_transactions
215	        self._active_transactions[origin] = transaction.transaction_id  # type: ignore

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\federation\federation_server.py:955:23
954	            # Pick an instance randomly so that we don't overload one.
955	            route_to = random.choice(instances)
956	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\send_queue.py:216:12
215	        if key:
216	            assert isinstance(key, tuple)
217	            self.keyed_edu[(destination, key)] = edu

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:391:8
390	
391	        assert pdu.internal_metadata.stream_ordering
392	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:513:12
512	        for state in states:
513	            assert self.is_mine_id(state.user_id)
514	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:168:12
167	        else:
168	            assert pdu.internal_metadata.stream_ordering
169	            self._catchup_last_skipped = pdu.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:454:24
453	                        # We pulled this from the DB, so it'll be non-null
454	                        assert p.internal_metadata.stream_ordering
455	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:497:16
496	                # We pulled this from the DB, so it'll be non-null
497	                assert pdu.internal_metadata.stream_ordering
498	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:550:8
549	
550	        assert len(edus) <= limit, "get_device_updates_by_remote returned too many EDUs"
551	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:681:12
680	            ].internal_metadata.stream_ordering
681	            assert self._last_stream_ordering
682	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\groups\attestations.py:109:8
108	
109	        assert server_name is not None
110	        await self.keyring.verify_json_for_server(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\groups\attestations.py:118:58
117	        """
118	        validity_period = DEFAULT_ATTESTATION_LENGTH_MS * random.uniform(
119	            *DEFAULT_ATTESTATION_JITTER
120	        )
121	        valid_until_ms = int(self.clock.time_msec() + validity_period)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\groups\groups_server.py:655:12
654	            groups_local = self.hs.get_groups_local_handler()
655	            assert isinstance(
656	                groups_local, GroupsLocalHandler
657	            ), "Workers cannot invites users to groups."
658	            res = await groups_local.on_invite(group_id, user_id, content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\groups\groups_server.py:801:16
800	                groups_local = self.hs.get_groups_local_handler()
801	                assert isinstance(
802	                    groups_local, GroupsLocalHandler
803	                ), "Workers cannot remove users from groups."
804	                await groups_local.user_removed_from_group(group_id, user_id, {})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\groups\groups_server.py:926:16
925	                groups_local = self.hs.get_groups_local_handler()
926	                assert isinstance(
927	                    groups_local, GroupsLocalHandler
928	                ), "Workers cannot kick users from groups."
929	                await groups_local.user_removed_from_group(group_id, user_id, {})

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:68:30
67	            response = await self._room_data_client(
68	                instance_name=random.choice(self._account_data_writers),
69	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:101:30
100	            response = await self._user_data_client(
101	                instance_name=random.choice(self._account_data_writers),
102	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:133:30
132	            response = await self._add_tag_client(
133	                instance_name=random.choice(self._account_data_writers),
134	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:158:30
157	            response = await self._remove_tag_client(
158	                instance_name=random.choice(self._account_data_writers),
159	                user_id=user_id,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:995:16
994	                # we've already checked that there is a (valid) password field
995	                assert isinstance(password, str)
996	                (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1090:8
1089	        # we already checked that we have a valid login type
1090	        assert isinstance(login_type, str)
1091	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1126:12
1125	            password = login_submission["password"]
1126	            assert isinstance(password, str)
1127	

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\synapse\handlers\cas.py:17:0
16	from typing import TYPE_CHECKING, Dict, List, Optional
17	from xml.etree import ElementTree as ET
18	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\synapse\handlers\cas.py:161:15
160	        # Ensure the response is valid.
161	        root = ET.fromstring(cas_response_body)
162	        if not root.tag.endswith("serviceResponse"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\cas.py:217:12
216	        else:
217	            assert client_redirect_url
218	            service_args = {"redirectUrl": client_redirect_url.decode("utf8")}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\cas.py:319:8
318	        # If this not a UI auth request than there must be a redirect URL.
319	        assert client_redirect_url is not None
320	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\events.py:82:26
81	                # thundering herds on restart.
82	                timeout = random.randint(int(timeout * 0.9), int(timeout * 1.1))
83	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:999:12
998	            ev = event_map[e_id]
999	            assert not ev.internal_metadata.is_outlier()
1000	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1030:12
1029	            # non-outliers
1030	            assert not event.internal_metadata.is_outlier()
1031	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\handlers\federation.py:1193:16
1192	                        joined_domains[dom] = d
1193	                except Exception:
1194	                    pass
1195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1453:8
1452	        # room stuff after join currently doesn't work on workers.
1453	        assert self.config.worker.worker_app is None
1454	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1469:8
1468	        # at a time - so this is just paranoia.
1469	        assert room_id not in self.room_queues
1470	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1846:8
1845	        # FIXME: Do this in a nicer way
1846	        assert event.type == EventTypes.Member
1847	        assert event.user_id == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1847:8
1846	        assert event.type == EventTypes.Member
1847	        assert event.user_id == user_id
1848	        assert event.state_key == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1848:8
1847	        assert event.user_id == user_id
1848	        assert event.state_key == user_id
1849	        assert event.room_id == room_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1849:8
1848	        assert event.state_key == user_id
1849	        assert event.room_id == room_id
1850	        return origin, event, room_version

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:3089:12
3088	        else:
3089	            assert self.storage.persistence
3090	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:3136:8
3135	        # the event has been persisted so it should have a stream ordering.
3136	        assert event.internal_metadata.stream_ordering
3137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\identity.py:540:8
539	        # should only be used if account_threepid_delegate_msisdn is true.
540	        assert self.hs.config.public_baseurl
541	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\initial_sync.py:303:12
302	            # to leave.
303	            assert member_event_id
304	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:347:8
346	        """
347	        assert self._ephemeral_events_enabled
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:653:8
652	        u = await self.store.get_user_by_id(user_id)
653	        assert u is not None
654	        if u["user_type"] in (UserTypes.SUPPORT, UserTypes.BOT):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:732:35
731	            # We randomly sleep a bit just to annoy the requester.
732	            await self.clock.sleep(random.randint(1, 10))
733	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:751:20
750	                    # we know it was persisted, so must have a stream ordering
751	                    assert event.internal_metadata.stream_ordering
752	                    return event, event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:758:12
757	
758	            assert self.hs.is_mine_id(event.sender), "User must be our own: %s" % (
759	                event.sender,
760	            )
761	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:777:8
776	        # we know it was persisted, so must have a stream ordering
777	        assert ev.internal_metadata.stream_ordering
778	        return ev, ev.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:809:12
808	        if prev_event_ids is not None:
809	            assert (
810	                len(prev_event_ids) <= 10
811	            ), "Attempting to create an event with %i prev_events" % (
812	                len(prev_event_ids),
813	            )
814	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:822:8
821	        # create event in auth events")
822	        assert (
823	            builder.type == EventTypes.Create or len(prev_event_ids) > 0
824	        ), "Attempting to create an event with no prev_events"
825	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:917:35
916	            # We randomly sleep a bit just to annoy the requester.
917	            await self.clock.sleep(random.randint(1, 10))
918	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:941:12
940	            # are invite rejections we have generated ourselves.
941	            assert event.type == EventTypes.Member
942	            assert event.content["membership"] == Membership.LEAVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:942:12
941	            assert event.type == EventTypes.Member
942	            assert event.content["membership"] == Membership.LEAVE
943	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1090:8
1089	
1090	        assert self.storage.persistence is not None
1091	        assert self._events_shard_config.should_handle(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1091:8
1090	        assert self.storage.persistence is not None
1091	        assert self._events_shard_config.should_handle(
1092	            self._instance_name, event.room_id
1093	        )
1094	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\oidc.py:105:8
104	        # we should not have been instantiated if there is no configured provider.
105	        assert provider_confs
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\oidc.py:149:8
148	        # This will always be set by the time Twisted calls us.
149	        assert request.args is not None
150	

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\handlers\oidc.py:1298:6
1297	
1298	env = Environment(finalize=jinja_finalize)
1299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:384:20
383	                    # case "JOIN" would have been returned.
384	                    assert member_event_id
385	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:389:20
388	                    )
389	                    assert leave_token.topological is not None
390	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:120:0
119	
120	assert LAST_ACTIVE_GRANULARITY < IDLE_TIMER
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1156:12
1155	        async def _process_presence():
1156	            assert not self._event_processing
1157	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1463:12
1462	            # Make mypy happy. users_interested_in should now be a set
1463	            assert not isinstance(users_interested_in, str)
1464	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1626:8
1625	        # without mypy complaining.
1626	        assert cache_context
1627	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1974:8
1973	        # This should only be called on a presence writer.
1974	        assert self._presence_writer
1975	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\profile.py:356:35
355	            # We randomly sleep a bit just to annoy the requester.
356	            await self.clock.sleep(random.randint(1, 10))
357	            return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:471:20
470	                    # If an invite is required, there must be a auto-join user ID.
471	                    assert self.hs.config.registration.auto_join_user_id
472	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\handlers\register.py:553:14
552	
553	        await self.register_with_store(
554	            user_id=user_id,
555	            password_hash="",
556	            appservice_id=service_id,
557	            create_profile_with_displayname=user.localpart,
558	        )
559	        return user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:711:8
710	        """
711	        assert not self.hs.config.worker_app
712	        valid_until_ms = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:724:12
723	        if is_guest:
724	            assert valid_until_ms is None
725	            access_token = self.macaroon_gen.generate_access_token(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:829:12
828	            # The token better still exist.
829	            assert user_tuple
830	            token_id = user_tuple.token_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:193:8
192	        user_id = requester.user.to_string()
193	        assert self.hs.is_mine_id(user_id), "User must be our own: %s" % (user_id,)
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:248:8
247	        # We know the tombstone event isn't an outlier so it has current state.
248	        assert old_room_state is not None
249	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room.py:673:35
672	            # We randomly sleep a bit just to annoy the requester.
673	            await self.clock.sleep(random.randint(1, 10))
674	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:287:8
286	        # we know it was persisted, so should have a stream ordering
287	        assert result_event.internal_metadata.stream_ordering
288	        return result_event.event_id, result_event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:363:35
362	            # We randomly sleep a bit just to annoy the requester.
363	            await self.clock.sleep(random.randint(1, 10))
364	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:518:20
517	                    # we know it was persisted, so must have a stream ordering.
518	                    assert old_state.internal_metadata.stream_ordering
519	                    return (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:753:12
752	            sender = UserID.from_string(event.sender)
753	            assert (
754	                sender == requester.user
755	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
756	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:756:12
755	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
756	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)
757	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:883:35
882	            # We randomly sleep a bit just to annoy the requester.
883	            await self.clock.sleep(random.randint(1, 10))
884	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:1256:8
1255	        # we know it was persisted, so must have a stream ordering
1256	        assert result_event.internal_metadata.stream_ordering
1257	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:119:16
118	
119	                assert batch_group is not None
120	                assert batch_group_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:120:16
119	                assert batch_group is not None
120	                assert batch_group_key is not None
121	                assert batch_token is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:121:16
120	                assert batch_group_key is not None
121	                assert batch_token is not None
122	            except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\space_summary.py:326:8
325	        # there should always be an entry
326	        assert stats is not None, "unable to retrieve stats for %s" % (room_id,)
327	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sso.py:206:8
205	        p_id = p.idp_id
206	        assert p_id not in self._identity_providers
207	        self._identity_providers[p_id] = p

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:871:16
870	                # is indeed the case.
871	                assert since_token is not None
872	                state_at_previous_sync = await self.get_state_at(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1357:8
1356	        )
1357	        assert presence_key
1358	        sync_result_builder.now_token = now_token.copy_and_replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1515:8
1514	
1515	        assert since_token
1516	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1540:8
1539	
1540	        assert since_token
1541	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\typing.py:207:8
206	
207	        assert hs.config.worker.writers.typing == hs.get_instance_name()
208	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:253:35
252	            # We randomly sleep a bit just to annoy the requester.
253	            await self.clock.sleep(random.randint(1, 10))
254	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:289:35
288	            # We randomly sleep a bit just to annoy the requester.
289	            await self.clock.sleep(random.randint(1, 10))
290	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_hash'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\handlers\ui_auth\__init__.py:29:20
28	    # password, so that the client does not need to submit it each time.
29	    PASSWORD_HASH = "password_hash"
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\ui_auth\checkers.py:160:16
159	            if self.hs.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
160	                assert self.hs.config.account_threepid_delegate_email
161	                threepid = await identity_handler.threepid_from_creds(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\client.py:788:12
787	            # discarded anyway.
788	            assert self.transport is not None
789	            self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\client.py:825:12
824	            # discarded anyway.
825	            assert self.transport is not None
826	            self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\federation\matrix_federation_agent.py:143:8
142	        # There must be a valid hostname.
143	        assert parsed_uri.hostname
144	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\srv_resolver.py:79:28
78	        while servers and total_weight:
79	            target_weight = random.randint(1, total_weight)
80	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:154:28
153	            # add some randomness to the TTL to avoid a stampeding herd
154	            cache_period *= random.uniform(
155	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
156	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
157	            )
158	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:208:28
207	            # after startup
208	            cache_period *= random.uniform(
209	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
210	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
211	            )
212	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:593:37
592	                            delay = min(delay, 60)
593	                            delay *= random.uniform(0.8, 1.4)
594	                        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:597:37
596	                            delay = min(delay, 2)
597	                            delay *= random.uniform(0.8, 1.4)
598	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\http\server.py:106:12
105	                request.transport.abortConnection()
106	            except Exception:
107	                # abortConnection throws if the connection is already closed
108	                pass
109	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\server.py:469:8
468	        # We expect to get bytes for us to write
469	        assert isinstance(response_object, bytes)
470	        html_bytes = response_object

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:105:8
104	        # we should have a `content` by now.
105	        assert self.content, "handleContentChunk() called before gotLength()"
106	        if self.content.tell() + len(data) > self._max_request_body_size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:124:8
123	        # This should only be called once.
124	        assert self._requester is None
125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:129:8
128	        # A logging context should exist by now (and have a ContextRequest).
129	        assert self.logcontext is not None
130	        assert self.logcontext.request is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:130:8
129	        assert self.logcontext is not None
130	        assert self.logcontext.request is not None
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:292:12
291	        if not self._is_processing:
292	            assert self.logcontext is not None
293	            with PreserveLoggingContext(self.logcontext):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:357:8
356	        """Log the completion of this request and update the metrics"""
357	        assert self.logcontext is not None
358	        usage = self.logcontext.get_resource_usage()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:542:8
541	
542	        assert config.http_options is not None
543	        proxied = config.http_options.x_forwarded

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:486:12
485	            rusage = get_thread_resource_usage()
486	            assert rusage is not None
487	            utime_delta, stime_delta = self._get_cputime(rusage)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:501:8
500	        """
501	        assert self.usage_start is not None
502	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:705:8
704	    else:
705	        assert isinstance(curr_context, LoggingContext)
706	        parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:897:8
896	    else:
897	        assert isinstance(curr_context, LoggingContext)
898	        parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\baserules.py:126:8
125	        # Only modify the actions, keep the conditions the same.
126	        assert isinstance(r["rule_id"], str)
127	        modified = modified_base_rules.get(r["rule_id"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\baserules.py:148:8
147	        # Only modify the actions, keep the conditions the same.
148	        assert isinstance(r["rule_id"], str)
149	        modified = modified_base_rules.get(r["rule_id"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\bulk_push_rule_evaluator.py:412:12
411	            # Ensure the state IDs exist.
412	            assert current_state_ids is not None
413	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:121:8
120	        """
121	        assert not self._is_processing
122	        self._is_processing = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:126:8
125	        """Used by tests to resume processing of events after pausing."""
126	        assert self._is_processing
127	        self._is_processing = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:132:8
131	        # we should never get here if we are already processing
132	        assert not self._is_processing
133	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:139:16
138	                # this is our first loop: load up the throttle params
139	                assert self.pusher_id is not None
140	                self.throttle_params = await self.store.get_throttle_params_by_room(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:313:8
312	        )
313	        assert self.pusher_id is not None
314	        await self.store.set_throttle_params(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:157:8
156	        # we should never get here if we are already processing
157	        assert not self._is_processing
158	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:320:8
319	        # This was checked in the __init__, but mypy doesn't seem to know that.
320	        assert self.data is not None
321	        if self.data.get("format") == "event_id_only":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\push_rule_evaluator.py:49:4
48	    notif_levels = power_levels.get("notifications", {})
49	    assert isinstance(notif_levels, dict)
50	    room_notif_level = notif_levels.get(notif_level_key, 50)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:101:8
100	        # assert here that sub classes don't try and use the name.
101	        assert (
102	            "instance_name" not in self.PATH_ARGS
103	        ), "`instance_name` is a reserved parameter name"
104	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:104:8
103	        ), "`instance_name` is a reserved parameter name"
104	        assert (
105	            "instance_name"
106	            not in signature(self.__class__._serialize_payload).parameters
107	        ), "`instance_name` is a reserved parameter name"
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:109:8
108	
109	        assert self.METHOD in ("PUT", "POST", "GET")
110	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\membership.py:205:8
204	        """
205	        assert change == "left"
206	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\slave\storage\push_rule.py:29:8
28	        # We assert this for the benefit of mypy
29	        assert isinstance(self._push_rules_stream_id_gen, SlavedIdTracker)
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:199:16
198	                    continue
199	                assert isinstance(row, EventsStreamRow)
200	                assert isinstance(row.data, EventsStreamEventRow)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:200:16
199	                assert isinstance(row, EventsStreamRow)
200	                assert isinstance(row.data, EventsStreamEventRow)
201	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\replication\tcp\client.py:242:16
241	                        deferred.callback(None)
242	                except Exception:
243	                    # The deferred has been cancelled or timed out.
244	                    pass
245	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:337:8
336	    def __init__(self, hs: "HomeServer"):
337	        assert hs.should_send_federation()
338	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:347:8
346	        sender = hs.get_federation_sender()
347	        assert isinstance(sender, FederationSender)
348	        self.federation_sender = sender

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:431:8
430	        # We should only be calling this once we've got a token.
431	        assert self.federation_position is not None
432	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'batch'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\replication\tcp\commands.py:124:29
123	            instance_name,
124	            None if token == "batch" else int(token),
125	            json_decoder.decode(row_json),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:266:8
265	        """
266	        assert stream_name not in self._processing_streams
267	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:410:8
409	
410	        assert self._server_notices_sender is not None
411	        await self._server_notices_sender.on_user_ip(cmd.user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:196:8
195	
196	        assert self.transport is not None
197	        self.transport.registerProducer(self, True)  # For the *Producing callbacks

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:221:16
220	                )
221	                assert self.transport is not None
222	                self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:311:8
310	        self.time_we_closed = self.clock.time_msec()
311	        assert self.transport is not None
312	        self.transport.loseConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:409:12
408	        if isinstance(reason, Failure):
409	            assert reason.type is not None
410	            connection_close_counter.labels(reason.type.__name__).inc()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\resource.py:88:8
87	        # If we have streams then we must have redis enabled or on master
88	        assert (
89	            not self.streams
90	            or hs.config.redis.redis_enabled
91	            or not hs.config.worker.worker_app
92	        )
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\streams\_base.py:284:12
283	
284	            assert isinstance(presence_handler, PresenceHandler)
285	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\streams\events.py:166:8
165	        # that we know it is safe to just take upper_limit = event_rows[-1][0].
166	        assert (
167	            len(event_rows) <= target_row_count
168	        ), "get_all_new_forward_event_rows did not honour row limit"
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\rooms.py:393:8
392	        # This will always be set by the time Twisted calls us.
393	        assert request.args is not None
394	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:281:12
280	            user = await self.admin_handler.get_user(target_user)
281	            assert user is not None
282	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:341:12
340	            user = await self.admin_handler.get_user(target_user)
341	            assert user is not None
342	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:833:8
832	        # This will always be set by the time Twisted calls us.
833	        assert request.args is not None
834	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:1072:8
1071	        ratelimit = await self.store.get_ratelimit_for_user(user_id)
1072	        assert ratelimit is not None
1073	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\rest\client\v1\login.py:46:17
45	    SSO_TYPE = "m.login.sso"
46	    TOKEN_TYPE = "m.login.token"
47	    JWT_TYPE = "org.matrix.login.jwt"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:123:48
122	                # look like we did something.
123	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
124	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\account.py:129:12
128	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
129	            assert self.hs.config.account_threepid_delegate_email
130	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:407:48
406	                # look like we did something.
407	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
408	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\account.py:413:12
412	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
413	            assert self.hs.config.account_threepid_delegate_email
414	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\account.py:490:48
489	                # look like we did something.
490	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
491	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:96:8
95	        )
96	        assert isinstance(
97	            self.groups_handler, GroupsLocalHandler
98	        ), "Workers cannot create group profiles."
99	        await self.groups_handler.update_group_profile(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:174:8
173	        content = parse_json_object_from_request(request)
174	        assert isinstance(
175	            self.groups_handler, GroupsLocalHandler
176	        ), "Workers cannot modify group summaries."
177	        resp = await self.groups_handler.update_group_summary_room(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:194:8
193	
194	        assert isinstance(
195	            self.groups_handler, GroupsLocalHandler
196	        ), "Workers cannot modify group profiles."
197	        resp = await self.groups_handler.delete_group_summary_room(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:249:8
248	        content = parse_json_object_from_request(request)
249	        assert isinstance(
250	            self.groups_handler, GroupsLocalHandler
251	        ), "Workers cannot modify group categories."
252	        resp = await self.groups_handler.update_group_category(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:265:8
264	
265	        assert isinstance(
266	            self.groups_handler, GroupsLocalHandler
267	        ), "Workers cannot modify group categories."
268	        resp = await self.groups_handler.delete_group_category(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:343:8
342	        content = parse_json_object_from_request(request)
343	        assert isinstance(
344	            self.groups_handler, GroupsLocalHandler
345	        ), "Workers cannot modify group roles."
346	        resp = await self.groups_handler.update_group_role(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:359:8
358	
359	        assert isinstance(
360	            self.groups_handler, GroupsLocalHandler
361	        ), "Workers cannot modify group roles."
362	        resp = await self.groups_handler.delete_group_role(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:437:8
436	        content = parse_json_object_from_request(request)
437	        assert isinstance(
438	            self.groups_handler, GroupsLocalHandler
439	        ), "Workers cannot modify group summaries."
440	        resp = await self.groups_handler.update_group_summary_user(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:457:8
456	
457	        assert isinstance(
458	            self.groups_handler, GroupsLocalHandler
459	        ), "Workers cannot modify group summaries."
460	        resp = await self.groups_handler.delete_group_summary_user(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:561:8
560	
561	        assert isinstance(
562	            self.groups_handler, GroupsLocalHandler
563	        ), "Workers cannot modify group join policy."
564	        result = await self.groups_handler.set_group_join_policy(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:602:8
601	
602	        assert isinstance(
603	            self.groups_handler, GroupsLocalHandler
604	        ), "Workers cannot create groups."
605	        result = await self.groups_handler.create_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:633:8
632	        content = parse_json_object_from_request(request)
633	        assert isinstance(
634	            self.groups_handler, GroupsLocalHandler
635	        ), "Workers cannot modify rooms in a group."
636	        result = await self.groups_handler.add_room_to_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:649:8
648	
649	        assert isinstance(
650	            self.groups_handler, GroupsLocalHandler
651	        ), "Workers cannot modify group categories."
652	        result = await self.groups_handler.remove_room_from_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:681:8
680	        content = parse_json_object_from_request(request)
681	        assert isinstance(
682	            self.groups_handler, GroupsLocalHandler
683	        ), "Workers cannot modify group categories."
684	        result = await self.groups_handler.update_room_in_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:715:8
714	        config = content.get("config", {})
715	        assert isinstance(
716	            self.groups_handler, GroupsLocalHandler
717	        ), "Workers cannot invite users to a group."
718	        result = await self.groups_handler.invite(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:746:8
745	        content = parse_json_object_from_request(request)
746	        assert isinstance(
747	            self.groups_handler, GroupsLocalHandler
748	        ), "Workers cannot kick users from a group."
749	        result = await self.groups_handler.remove_user_from_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:775:8
774	        content = parse_json_object_from_request(request)
775	        assert isinstance(
776	            self.groups_handler, GroupsLocalHandler
777	        ), "Workers cannot leave a group for a users."
778	        result = await self.groups_handler.remove_user_from_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:804:8
803	        content = parse_json_object_from_request(request)
804	        assert isinstance(
805	            self.groups_handler, GroupsLocalHandler
806	        ), "Workers cannot join a user to a group."
807	        result = await self.groups_handler.join_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\groups.py:833:8
832	        content = parse_json_object_from_request(request)
833	        assert isinstance(
834	            self.groups_handler, GroupsLocalHandler
835	        ), "Workers cannot accept an invite to a group."
836	        result = await self.groups_handler.accept_invite(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\register.py:145:48
144	                # look like we did something.
145	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
146	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\register.py:151:12
150	        if self.config.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
151	            assert self.hs.config.account_threepid_delegate_email
152	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\v2_alpha\register.py:229:48
228	                # look like we did something.
229	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
230	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\v2_alpha\sync.py:94:8
93	        # This will always be set by the time Twisted calls us.
94	        assert request.args is not None
95	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:27:0
26	        )
27	except Exception:
28	    # any other exception is fine
29	    pass
30	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\__init__.py:42:0
41	        )
42	except Exception:
43	    # any other exception is fine
44	    pass

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\_base.py:53:8
52	        postpath = request.postpath  # type: List[bytes]  # type: ignore
53	        assert postpath
54	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\media_storage.py:153:12
152	                os.remove(fname)
153	            except Exception:
154	                pass
155	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:54:4
53	if TYPE_CHECKING:
54	    from lxml import etree
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:190:8
189	        # This will always be set by the time Twisted calls us.
190	        assert request.args is not None
191	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:528:12
527	            # we can only get here if we did an oembed request and have an oembed_result.html
528	            assert oembed_result.html is not None
529	            assert oembed_url is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:529:12
528	            assert oembed_result.html is not None
529	            assert oembed_url is not None
530	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:587:8
586	
587	        assert self._worker_run_media_background_jobs
588	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:617:12
616	                    os.rmdir(dir)
617	            except Exception:
618	                pass
619	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:649:12
648	                    os.rmdir(dir)
649	            except Exception:
650	                pass
651	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:667:12
666	                    os.rmdir(dir)
667	            except Exception:
668	                pass
669	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:741:4
740	
741	    from lxml import etree
742	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\synapse\rest\media\v1\preview_url_resource.py:755:15
754	        # Attempt to parse the body. If this fails, log and return no metadata.
755	        tree = etree.fromstring(body_attempt, parser)
756	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_url_resource.py:856:12
855	
856	            from lxml import etree
857	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:878:8
877	        # This must be a non-empty string at this point.
878	        assert isinstance(og["og:description"], str)
879	        og["og:description"] = summarize_paragraphs([og["og:description"]])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\upload_resource.py:81:12
80	            content_type_headers = headers.getRawHeaders(b"Content-Type")
81	            assert content_type_headers  # for mypy
82	            media_type = content_type_headers[0].decode("ascii")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\synapse\client\password_reset.py:63:8
62	        # This resource should not be mounted if threepid behaviour is not LOCAL
63	        assert hs.config.threepid_behaviour_email == ThreepidBehaviour.LOCAL
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\synapse\client\pick_username.py:107:8
106	        # This will always be set by the time Twisted calls us.
107	        assert request.args is not None
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:113:8
112	
113	        assert self._is_mine_id(user_id), "Cannot send server notices to remote users"
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:174:8
173	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
174	        assert latest_event_ids is not None
175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:209:8
208	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
209	        assert latest_event_ids is not None
210	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:229:8
228	            latest_event_ids = await self.store.get_latest_event_ids_in_room(room_id)
229	        assert latest_event_ids is not None
230	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\synapse\state\v1.py:354:30
353	        # people to send us events with non-ascii event IDs :/
354	        return -int(e.depth), hashlib.sha1(e.event_id.encode("utf-8")).hexdigest()
355	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\background_updates.py:230:8
229	    async def _do_background_update(self, desired_duration_ms: float) -> int:
230	        assert self._current_background_update is not None
231	        update_name = self._current_background_update

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:229:8
228	        # is not the case.
229	        assert self.after_callbacks is not None
230	        self.after_callbacks.append((callback, args, kwargs))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:238:8
237	        # is not the case.
238	        assert self.exception_callbacks is not None
239	        self.exception_callbacks.append((callback, args, kwargs))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:282:8
281	        """
282	        assert isinstance(self.database_engine, PostgresEngine)
283	        from psycopg2.extras import execute_values  # type: ignore

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\database.py:309:12
308	                sql_logger.debug("[SQL values] {%s} %r", self.name, args[0])
309	            except Exception:
310	                # Don't let logging failures stop SQL from working
311	                pass
312	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:705:12
704	        else:
705	            assert isinstance(curr_context, LoggingContext)
706	            parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:716:12
715	            # pool).
716	            assert not self.engine.in_transaction(conn)
717	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:752:8
751	        """
752	        assert cursor.description is not None, "cursor.description was None"
753	        col_headers = [intern(str(column[0])) for column in cursor.description]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1038:18
1037	            # SELECT instead to see if it exists.
1038	            sql = "SELECT 1 FROM %s WHERE %s" % (
1039	                table,
1040	                " AND ".join(_getwhere(k) for k in keyvalues),
1041	            )
1042	            sqlargs = list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1049:18
1048	            # First try to update.
1049	            sql = "UPDATE %s SET %s WHERE %s" % (
1050	                table,
1051	                ", ".join("%s = ?" % (k,) for k in values),
1052	                " AND ".join(_getwhere(k) for k in keyvalues),
1053	            )
1054	            sqlargs = list(values.values()) + list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1067:14
1066	
1067	        sql = "INSERT INTO %s (%s) VALUES (%s)" % (
1068	            table,
1069	            ", ".join(k for k in allvalues),
1070	            ", ".join("?" for _ in allvalues),
1071	        )
1072	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1101:21
1100	            allvalues.update(values)
1101	            latter = "UPDATE SET " + ", ".join(k + "=EXCLUDED." + k for k in values)
1102	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1103:15
1102	
1103	        sql = ("INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s") % (
1104	            table,
1105	            ", ".join(k for k in allvalues),
1106	            ", ".join("?" for _ in allvalues),
1107	            ", ".join(k for k in keyvalues),
1108	            latter,
1109	        )
1110	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1239:21
1238	        else:
1239	            latter = "UPDATE SET " + ", ".join(
1240	                k + "=EXCLUDED." + k for k in value_names
1241	            )
1242	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1243:14
1242	
1243	        sql = "INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s" % (
1244	            table,
1245	            ", ".join(k for k in allnames),
1246	            ", ".join("?" for _ in allnames),
1247	            ", ".join(key_names),
1248	            latter,
1249	        )
1250	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1412:15
1411	    ) -> List[Any]:
1412	        sql = ("SELECT %(retcol)s FROM %(table)s") % {"retcol": retcol, "table": table}
1413	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1500:18
1499	        if keyvalues:
1500	            sql = "SELECT %s FROM %s WHERE %s" % (
1501	                ", ".join(retcols),
1502	                table,
1503	                " AND ".join("%s = ?" % (k,) for k in keyvalues),
1504	            )
1505	            txn.execute(sql, list(keyvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1507:18
1506	        else:
1507	            sql = "SELECT %s FROM %s" % (", ".join(retcols), table)
1508	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1598:14
1597	
1598	        sql = "SELECT %s FROM %s WHERE %s" % (
1599	            ", ".join(retcols),
1600	            table,
1601	            " AND ".join(clauses),
1602	        )
1603	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1630:21
1629	
1630	        update_sql = "UPDATE %s SET %s %s" % (
1631	            table,
1632	            ", ".join("%s = ?" % (k,) for k in updatevalues),
1633	            where,
1634	        )
1635	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1692:21
1691	    ) -> Optional[Dict[str, Any]]:
1692	        select_sql = "SELECT %s FROM %s WHERE %s" % (
1693	            ", ".join(retcols),
1694	            table,
1695	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1696	        )
1697	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1740:14
1739	        """
1740	        sql = "DELETE FROM %s WHERE %s" % (
1741	            table,
1742	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1743	        )
1744	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1785:14
1784	        """
1785	        sql = "DELETE FROM %s WHERE %s" % (
1786	            table,
1787	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1788	        )
1789	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1850:14
1849	
1850	        sql = "DELETE FROM %s" % table
1851	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1878:12
1877	        sql = (
1878	            "SELECT %(entity)s, MAX(%(stream)s) FROM %(table)s"
1879	            " WHERE %(stream)s > ? - %(limit)s"
1880	            " GROUP BY %(entity)s"
1881	        ) % {
1882	            "table": table,
1883	            "entity": entity_column,
1884	            "stream": stream_column,
1885	            "limit": limit,
1886	        }
1887	
1888	        txn = db_conn.cursor(txn_name="get_cache_dict")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1962:14
1961	
1962	        sql = "SELECT %s FROM %s %s ORDER BY %s %s LIMIT ? OFFSET ?" % (
1963	            ", ".join(retcols),
1964	            table,
1965	            where_clause,
1966	            orderby,
1967	            order_direction,
1968	        )
1969	        txn.execute(sql, arg_list + [limit, start])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2027:18
2026	        if term:
2027	            sql = "SELECT %s FROM %s WHERE %s LIKE ?" % (", ".join(retcols), table, col)
2028	            termvalues = ["%%" + term + "%%"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:388:8
387	        """
388	        assert self._can_write_to_account_data
389	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:430:8
429	        """
430	        assert self._can_write_to_account_data
431	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:402:16
401	                # We do NOT want to escape `stream_id_type`.
402	                "SELECT %s FROM application_services_state WHERE as_id=?"
403	                % stream_id_type,
404	                (service.id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:428:16
427	            txn.execute(
428	                "UPDATE application_services_state SET %s = ? WHERE as_id=?"
429	                % stream_id_type,
430	                (pos, service.id),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:175:16
174	            txn.execute(
175	                """
176	                SELECT user_id, access_token, ip,
177	                       MAX(device_id), MAX(user_agent), MAX(last_seen),
178	                       COUNT(*)
179	                FROM (
180	                    SELECT DISTINCT user_id, access_token, ip
181	                    FROM user_ips
182	                    WHERE {}
183	                ) c
184	                INNER JOIN user_ips USING (user_id, access_token, ip)
185	                GROUP BY user_id, access_token, ip
186	                HAVING count(*) > 1
187	                """.format(
188	                    clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:303:18
302	
303	            sql = """
304	                SELECT
305	                    last_seen, ip, user_agent, user_id, device_id
306	                FROM (
307	                    SELECT
308	                        user_id, device_id, MAX(u.last_seen) AS last_seen
309	                    FROM devices
310	                    INNER JOIN user_ips AS u USING (user_id, device_id)
311	                    WHERE %(where_clause)s
312	                    GROUP BY user_id, device_id
313	                    ORDER BY user_id ASC, device_id ASC
314	                    LIMIT ?
315	                ) c
316	                INNER JOIN user_ips AS u USING (user_id, device_id, last_seen)
317	            """ % {
318	                "where_clause": where_clause
319	            }
320	            txn.execute(sql, where_args + [batch_size])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:381:8
380	
381	        assert self._can_write_to_device
382	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:424:8
423	    ) -> int:
424	        assert self._can_write_to_device
425	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:474:8
473	    ):
474	        assert self._can_write_to_device
475	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\devices.py:997:18
996	            )
997	            sql = """
998	                SELECT stream_id, destination, user_id, device_id, MAX(ts) AS ts
999	                FROM device_lists_outbound_pokes
1000	                WHERE %s
1001	                GROUP BY %s
1002	                HAVING count(*) > 1
1003	                ORDER BY %s
1004	                LIMIT ?
1005	                """ % (
1006	                clause,  # WHERE
1007	                ",".join(KEY_COLS),  # GROUP BY
1008	                ",".join(KEY_COLS),  # ORDER BY
1009	            )
1010	            txn.execute(sql, args + [batch_size])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\directory.py:183:18
182	
183	            sql = "UPDATE room_aliases SET room_id = ? %s WHERE room_id = ?" % (
184	                update_creator_sql,
185	            )
186	            txn.execute(sql, sql_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\e2e_room_keys.py:201:14
200	
201	        sql = """
202	        SELECT room_id, session_id, first_message_index, forwarded_count,
203	               is_verified, session_data
204	        FROM e2e_room_keys
205	        WHERE user_id = ? AND version = ? AND (%s)
206	        """ % (
207	            " OR ".join(where_clauses)
208	        )
209	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:228:12
227	        sql = (
228	            "SELECT user_id, device_id, "
229	            "    d.display_name, "
230	            "    k.key_json"
231	            " FROM devices d"
232	            "    %s JOIN e2e_device_keys_json k USING (user_id, device_id)"
233	            " WHERE %s AND NOT d.hidden"
234	        ) % (
235	            "LEFT" if include_all_devices else "INNER",
236	            " OR ".join("(" + q + ")" for q in query_clauses),
237	        )
238	
239	        txn.execute(sql, query_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:274:24
273	
274	        signature_sql = """
275	            SELECT user_id, key_id, target_device_id, signature
276	            FROM e2e_cross_signing_signatures WHERE %s
277	            """ % (
278	            " OR ".join("(" + q + ")" for q in signature_query_clauses)
279	        )
280	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:526:22
525	                # the latest key.
526	                sql = """
527	                    SELECT DISTINCT ON (user_id, keytype) user_id, keytype, keydata, stream_id
528	                        FROM e2e_cross_signing_keys
529	                        WHERE %(clause)s
530	                        ORDER BY user_id, keytype, stream_id DESC
531	                """ % {
532	                    "clause": clause
533	                }
534	            else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:538:22
537	                # a row that matches the MIN/MAX.
538	                sql = """
539	                    SELECT user_id, keytype, keydata, MAX(stream_id)
540	                        FROM e2e_cross_signing_keys
541	                        WHERE %(clause)s
542	                        GROUP BY user_id, keytype
543	                """ % {
544	                    "clause": clause
545	                }
546	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:594:18
593	        for batch in batch_iter(devices.keys(), size=100):
594	            sql = """
595	                SELECT target_user_id, target_device_id, key_id, signature
596	                  FROM e2e_cross_signing_signatures
597	                 WHERE user_id = ?
598	                   AND (%s)
599	            """ % (
600	                " OR ".join(
601	                    "(target_user_id = ? AND target_device_id = ?)" for _ in batch
602	                )
603	            )
604	            query_params = [from_user_id]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_federation.py:749:18
748	
749	            sql = """
750	                SELECT room_id FROM event_forward_extremities
751	                WHERE %s
752	                GROUP BY room_id
753	                HAVING count(*) > ?
754	                ORDER BY count(*) DESC
755	                LIMIT ?
756	            """ % (
757	                where_clause,
758	            )
759	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_push_actions.py:932:16
931	            sql = (
932	                "SELECT epa.event_id, epa.room_id,"
933	                " epa.stream_ordering, epa.topological_ordering,"
934	                " epa.actions, epa.highlight, epa.profile_tag, e.received_ts"
935	                " FROM event_push_actions epa, events e"
936	                " WHERE epa.event_id = e.event_id"
937	                " AND epa.user_id = ? %s"
938	                " AND epa.notif = 1"
939	                " ORDER BY epa.stream_ordering DESC"
940	                " LIMIT ?" % (before_clause,)
941	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:118:8
117	        # This should only exist on instances that are configured to write
118	        assert (
119	            hs.get_instance_name() in hs.config.worker.writers.events
120	        ), "Can only instantiate EventsStore on master"
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:353:8
352	        # stream orderings should have been assigned by now
353	        assert min_stream_order
354	        assert max_stream_order

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:354:8
353	        assert min_stream_order
354	        assert max_stream_order
355	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events.py:1243:12
1242	        txn.execute(
1243	            "SELECT event_id, outlier FROM events WHERE event_id in (%s)"
1244	            % (",".join(["?"] * len(events_and_contexts)),),
1245	            [event.event_id for event, _ in events_and_contexts],

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:2091:8
2090	
2091	        assert src_chain != target_chain
2092	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events_bg_updates.py:852:14
851	
852	        sql = """
853	            SELECT
854	                event_id, state_events.type, state_events.state_key,
855	                topological_ordering, stream_ordering,
856	                events.room_id
857	            FROM events
858	            INNER JOIN state_events USING (event_id)
859	            LEFT JOIN event_auth_chains USING (event_id)
860	            LEFT JOIN event_auth_chain_to_calculate USING (event_id)
861	            WHERE event_auth_chains.event_id IS NULL
862	                AND event_auth_chain_to_calculate.event_id IS NULL
863	                AND %(tuple_cmp)s
864	                %(extra)s
865	            ORDER BY events.room_id, topological_ordering, stream_ordering
866	            %(limit)s
867	        """ % {
868	            "tuple_cmp": tuple_clause,
869	            "limit": "LIMIT ?" if batch_size is not None else "",
870	            "extra": extra_clause,
871	        }
872	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:377:16
376	            if not allow_rejected:
377	                assert not entry.event.rejected_reason, (
378	                    "rejected event returned from _get_events_from_cache_or_db despite "
379	                    "allow_rejected=False"
380	                )
381	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:581:8
580	        # non-None.
581	        assert current_state_ids is not None
582	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:716:12
715	                continue
716	            assert row["event_id"] == event_id
717	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:1337:8
1336	        # of the last row in the result.
1337	        assert rows[-1][0] <= to_token
1338	        to_token = rows[-1][0] - 1

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:63:16
62	            sql = (
63	                "SELECT server_name, key_id, verify_key, ts_valid_until_ms "
64	                "FROM server_signature_keys WHERE 1=0"
65	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
66	
67	            txn.execute(sql, tuple(itertools.chain.from_iterable(batch)))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:65:16
64	                "FROM server_signature_keys WHERE 1=0"
65	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
66	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\media_repository.py:192:18
191	
192	            sql = """
193	                SELECT
194	                    "media_id",
195	                    "media_type",
196	                    "media_length",
197	                    "upload_name",
198	                    "created_ts",
199	                    "last_access_ts",
200	                    "quarantined_by",
201	                    "safe_from_quarantine"
202	                FROM local_media_repository
203	                WHERE user_id = ?
204	                ORDER BY {order_by_column} {order}, media_id ASC
205	                LIMIT ? OFFSET ?
206	            """.format(
207	                order_by_column=order_by_column,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\media_repository.py:239:23
238	        if keep_profiles:
239	            sql_keep = """
240	                AND (
241	                    NOT EXISTS
242	                        (SELECT 1
243	                         FROM profiles
244	                         WHERE profiles.avatar_url = '{media_prefix}' || lmr.media_id)
245	                    AND NOT EXISTS
246	                        (SELECT 1
247	                         FROM groups
248	                         WHERE groups.avatar_url = '{media_prefix}' || lmr.media_id)
249	                    AND NOT EXISTS
250	                        (SELECT 1
251	                         FROM room_memberships
252	                         WHERE room_memberships.avatar_url = '{media_prefix}' || lmr.media_id)
253	                    AND NOT EXISTS
254	                        (SELECT 1
255	                         FROM user_directory
256	                         WHERE user_directory.avatar_url = '{media_prefix}' || lmr.media_id)
257	                    AND NOT EXISTS
258	                        (SELECT 1
259	                         FROM room_stats_state
260	                         WHERE room_stats_state.avatar = '{media_prefix}' || lmr.media_id)
261	                )
262	            """.format(
263	                media_prefix="mxc://%s/" % (self.server_name,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:149:16
148	            txn.execute(
149	                "DELETE FROM monthly_active_users WHERE timestamp < ? AND NOT %s"
150	                % (in_clause,),
151	                [thirty_days_ago] + in_clause_args,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:172:22
171	                # SELECT, meaning that a legitimate mau is deleted.
172	                sql = """
173	                    DELETE FROM monthly_active_users
174	                    WHERE user_id NOT IN (
175	                        SELECT user_id FROM monthly_active_users
176	                        WHERE NOT %s
177	                        ORDER BY timestamp DESC
178	                        LIMIT ?
179	                    )
180	                    AND NOT %s
181	                """ % (
182	                    in_clause,
183	                    in_clause,
184	                )
185	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\presence.py:76:8
75	    async def update_presence(self, presence_states):
76	        assert self._can_persist_presence
77	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:130:12
129	        txn.execute(
130	            "INSERT INTO events_to_purge"
131	            " SELECT event_id, %s"
132	            " FROM events AS e LEFT JOIN state_events USING (event_id)"
133	            " WHERE (NOT outlier OR (%s)) AND e.room_id = ? AND topological_ordering < ?"
134	            % (should_delete_expr, should_delete_expr),
135	            should_delete_params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:224:16
223	            txn.execute(
224	                "DELETE FROM %s WHERE event_id IN ("
225	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
226	                ")" % (table,)
227	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:235:16
234	            txn.execute(
235	                "DELETE FROM %s WHERE room_id = ? AND event_id IN ("
236	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
237	                ")" % (table,),
238	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:356:16
355	            txn.execute(
356	                """
357	                DELETE FROM %s WHERE event_id IN (
358	                  SELECT event_id FROM events WHERE room_id=?
359	                )
360	                """
361	                % (table,),
362	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:400:24
399	            logger.info("[purge] removing %s from %s", room_id, table)
400	            txn.execute("DELETE FROM %s WHERE room_id=?" % (table,), (room_id,))
401	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\push_rule.py:661:16
660	            sql = (
661	                """
662	                SELECT 1 FROM push_rules
663	                WHERE user_name = ? AND rule_id = ?
664	                %s
665	            """
666	                % for_key_share
667	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:491:8
490	        """
491	        assert self._can_write_to_receipts
492	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:570:8
569	        """
570	        assert self._can_write_to_receipts
571	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:636:8
635	    ):
636	        assert self._can_write_to_receipts
637	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:651:8
650	    ):
651	        assert self._can_write_to_receipts
652	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\registration.py:887:8
886	
887	        assert address or sid
888	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:890:18
889	        def get_threepid_validation_session_txn(txn):
890	            sql = """
891	                SELECT address, session_id, medium, client_secret,
892	                last_send_attempt, validated_at
893	                FROM threepid_validation_session WHERE %s
894	                """ % (
895	                " AND ".join("%s = ?" % k for k in keyvalues.keys()),
896	            )
897	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1572:16
1571	            txn.execute(
1572	                "SELECT token, id, device_id FROM access_tokens WHERE %s"
1573	                % where_clause,
1574	                values,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1583:24
1582	
1583	            txn.execute("DELETE FROM access_tokens WHERE %s" % where_clause, values)
1584	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:96:14
95	
96	        sql = """
97	            SELECT event_id, topological_ordering, stream_ordering
98	            FROM event_relations
99	            INNER JOIN events USING (event_id)
100	            WHERE %s
101	            ORDER BY topological_ordering %s, stream_ordering %s
102	            LIMIT ?
103	        """ % (
104	            " AND ".join(where_clause),
105	            order,
106	            order,
107	        )
108	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:187:14
186	
187	        sql = """
188	            SELECT type, aggregation_key, COUNT(DISTINCT sender), MAX(stream_ordering)
189	            FROM event_relations
190	            INNER JOIN events USING (event_id)
191	            WHERE {where_clause}
192	            GROUP BY relation_type, type, aggregation_key
193	            {having_clause}
194	            ORDER BY COUNT(*) {order}, MAX(stream_ordering) {order}
195	            LIMIT ?
196	        """.format(
197	            where_clause=" AND ".join(where_clause),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:170:18
169	
170	            sql = """
171	                SELECT
172	                    COALESCE(COUNT(*), 0)
173	                FROM (
174	                    %(published_sql)s
175	                ) published
176	                INNER JOIN room_stats_state USING (room_id)
177	                INNER JOIN room_stats_current USING (room_id)
178	                WHERE
179	                    (
180	                        join_rules = 'public' OR history_visibility = 'world_readable'
181	                    )
182	                    AND joined_members > 0
183	            """ % {
184	                "published_sql": published_sql
185	            }
186	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:303:14
302	
303	        sql = """
304	            SELECT
305	                room_id, name, topic, canonical_alias, joined_members,
306	                avatar, history_visibility, joined_members, guest_access
307	            FROM (
308	                %(published_sql)s
309	            ) published
310	            INNER JOIN room_stats_state USING (room_id)
311	            INNER JOIN room_stats_current USING (room_id)
312	            WHERE
313	                (
314	                    join_rules = 'public' OR history_visibility = 'world_readable'
315	                )
316	                AND joined_members > 0
317	                %(where_clause)s
318	            ORDER BY joined_members %(dir)s, room_id %(dir)s
319	        """ % {
320	            "published_sql": published_sql,
321	            "where_clause": where_clause,
322	            "dir": "DESC" if forwards else "ASC",
323	        }
324	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:450:19
449	        # returned. Thus allowing us to see if there are more events to paginate through
450	        info_sql = """
451	            SELECT state.room_id, state.name, state.canonical_alias, curr.joined_members,
452	              curr.local_users_in_room, rooms.room_version, rooms.creator,
453	              state.encryption, state.is_federatable, rooms.is_public, state.join_rules,
454	              state.guest_access, state.history_visibility, curr.current_state_events
455	            FROM room_stats_state state
456	            INNER JOIN room_stats_current curr USING (room_id)
457	            INNER JOIN rooms USING (room_id)
458	            %s
459	            ORDER BY %s %s
460	            LIMIT ?
461	            OFFSET ?
462	        """ % (
463	            where_statement,
464	            order_by_column,
465	            "ASC" if order_by_asc else "DESC",
466	        )
467	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:469:20
468	        # Use a nested SELECT statement as SQL can't count(*) with an OFFSET
469	        count_sql = """
470	            SELECT count(*) FROM (
471	              SELECT room_id FROM room_stats_state state
472	              %s
473	            ) AS get_room_ids
474	        """ % (
475	            where_statement,
476	        )
477	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1047:16
1046	            txn.execute(
1047	                """
1048	                SELECT state.room_id, state.event_id, events.json
1049	                FROM current_state_events as state
1050	                LEFT JOIN event_json AS events ON (state.event_id = events.event_id)
1051	                WHERE state.room_id > ? AND state.type = '%s'
1052	                ORDER BY state.room_id ASC
1053	                LIMIT ?;
1054	                """
1055	                % EventTypes.Retention,
1056	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1183:16
1182	            txn.execute(
1183	                """
1184	                SELECT room_id
1185	                FROM rooms r
1186	                INNER JOIN current_state_events cse USING (room_id)
1187	                WHERE room_id > ? AND r.is_public
1188	                AND cse.type = '%s' AND cse.state_key = ''
1189	                ORDER BY room_id ASC
1190	                LIMIT ?;
1191	                """
1192	                % EventTypes.Tombstone,
1193	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1619:18
1618	
1619	            sql = """
1620	                SELECT COUNT(*) as total_event_reports
1621	                FROM event_reports AS er
1622	                {}
1623	                """.format(
1624	                where_clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1629:18
1628	
1629	            sql = """
1630	                SELECT
1631	                    er.id,
1632	                    er.received_ts,
1633	                    er.room_id,
1634	                    er.event_id,
1635	                    er.user_id,
1636	                    er.content,
1637	                    events.sender,
1638	                    room_stats_state.canonical_alias,
1639	                    room_stats_state.name
1640	                FROM event_reports AS er
1641	                LEFT JOIN events
1642	                    ON events.event_id = er.event_id
1643	                JOIN room_stats_state
1644	                    ON room_stats_state.room_id = er.room_id
1645	                {where_clause}
1646	                ORDER BY er.received_ts {order}
1647	                LIMIT ?
1648	                OFFSET ?
1649	            """.format(
1650	                where_clause=where_clause,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:382:14
381	
382	        sql = """
383	            SELECT room_id, e.sender, c.membership, event_id, e.stream_ordering
384	            FROM local_current_membership AS c
385	            INNER JOIN events AS e USING (room_id, event_id)
386	            WHERE
387	                user_id = ?
388	                AND %s
389	        """ % (
390	            clause,
391	        )
392	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:593:8
592	        # with a state_group of None are likely to be different.
593	        assert state_group is not None
594	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:761:8
760	        # The `state_group` must match the `state_entry.state_group` (if not None).
761	        assert state_group is not None
762	        assert state_entry.state_group is None or state_entry.state_group == state_group

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:762:8
761	        assert state_group is not None
762	        assert state_entry.state_group is None or state_entry.state_group == state_group
763	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:936:14
935	
936	        sql = """
937	            SELECT 1 FROM local_current_membership
938	            WHERE
939	                room_id = ? AND membership = ?
940	                AND NOT (%s)
941	                LIMIT 1
942	        """ % (
943	            clause,
944	        )
945	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\roommember.py:1010:16
1009	                    content = event_json["content"]
1010	                except Exception:
1011	                    continue
1012	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\20\pushers.py:69:12
68	        cur.execute(
69	            """
70	                INSERT into pushers2 (
71	                id, user_name, access_token, profile_tag, kind,
72	                app_id, app_display_name, device_display_name,
73	                pushkey, ts, lang, data, last_token, last_success,
74	                failing_since
75	                ) values (%s)
76	            """
77	            % (",".join(["?" for _ in range(len(row))])),
78	            row,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\databases\main\schema\delta\30\as_users.py:25:4
24	        cur.execute("ALTER TABLE users ADD COLUMN appservice_id TEXT")
25	    except Exception:
26	        # Maybe we already added the column? Hope so...
27	        pass
28	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\30\as_users.py:62:16
61	            cur.execute(
62	                "UPDATE users SET appservice_id = ? WHERE name IN (%s)"
63	                % (",".join("?" for _ in chunk),),
64	                [as_id] + chunk,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\31\pushers.py:68:12
67	        cur.execute(
68	            """
69	                INSERT into pushers2 (
70	                id, user_name, access_token, profile_tag, kind,
71	                app_id, app_display_name, device_display_name,
72	                pushkey, ts, lang, data, last_stream_ordering, last_success,
73	                failing_since
74	                ) values (%s)
75	            """
76	            % (",".join(["?" for _ in range(len(row))])),
77	            row,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\48\group_unique_indexes.py:42:8
41	    cur.execute(
42	        """
43	        DELETE FROM group_users WHERE %s NOT IN (
44	           SELECT min(%s) FROM group_users GROUP BY group_id, user_id
45	        );
46	    """
47	        % (rowid, rowid)
48	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\schema\delta\48\group_unique_indexes.py:50:8
49	    cur.execute(
50	        """
51	        DELETE FROM group_invites WHERE %s NOT IN (
52	           SELECT min(%s) FROM group_invites GROUP BY group_id, user_id
53	        );
54	    """
55	        % (rowid, rowid)
56	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\search.py:126:16
125	            sql = (
126	                "SELECT stream_ordering, event_id, room_id, type, json, "
127	                " origin_server_ts FROM events"
128	                " JOIN event_json USING (room_id, event_id)"
129	                " WHERE ? <= stream_ordering AND stream_ordering < ?"
130	                " AND (%s)"
131	                " ORDER BY stream_ordering DESC"
132	                " LIMIT ?"
133	            ) % (" OR ".join("type = '%s'" % (t,) for t in TYPES),)
134	
135	            txn.execute(sql, (target_min_stream_id, max_stream_id, batch_size))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\search.py:158:20
157	                        content = event_json["content"]
158	                    except Exception:
159	                        continue
160	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\state_deltas.py:53:8
52	        # check we're not going backwards
53	        assert prev_stream_id <= max_stream_id
54	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:544:18
543	
544	            sql = """
545	                INSERT INTO %(table)s (%(insert_cols_cs)s)
546	                VALUES (%(insert_vals_qs)s)
547	                ON CONFLICT (%(key_columns)s) DO UPDATE SET %(updates)s
548	            """ % {
549	                "table": table,
550	                "insert_cols_cs": ", ".join(insert_cols),
551	                "insert_vals_qs": ", ".join(
552	                    ["?"] * (len(keyvalues) + len(absolutes) + len(additive_relatives))
553	                ),
554	                "key_columns": ", ".join(keyvalues),
555	                "updates": ", ".join(chain(absolute_updates, relative_updates)),
556	            }
557	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:629:18
628	
629	            sql = """
630	                INSERT INTO %(into_table)s (%(ins_columns)s)
631	                SELECT %(sel_exprs)s
632	                FROM %(src_table)s
633	                WHERE %(keyvalues_where)s
634	                ON CONFLICT (%(keyvalues)s)
635	                DO UPDATE SET %(sets)s
636	            """ % {
637	                "into_table": into_table,
638	                "ins_columns": ", ".join(ins_columns),
639	                "sel_exprs": ", ".join(sel_exprs),
640	                "keyvalues_where": " AND ".join(keyvalues_where),
641	                "src_table": src_table,
642	                "keyvalues": ", ".join(
643	                    chain(keyvalues.keys(), extra_dst_keyvalues.keys())
644	                ),
645	                "sets": ", ".join(chain(sets_cc, sets_ar)),
646	            }
647	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:732:14
731	
732	        sql = """
733	            SELECT events.room_id, COUNT(*) AS new_events, SUM(%s) AS new_bytes
734	            FROM events INNER JOIN event_json USING (event_id)
735	            WHERE (? < stream_ordering AND stream_ordering <= ?)
736	                OR (? <= stream_ordering AND stream_ordering <= ?)
737	            GROUP BY events.room_id
738	        """ % (
739	            new_bytes_expression,
740	        )
741	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:749:14
748	
749	        sql = """
750	            SELECT events.sender, COUNT(*) AS new_events, SUM(%s) AS new_bytes
751	            FROM events INNER JOIN event_json USING (event_id)
752	            WHERE (? < stream_ordering AND stream_ordering <= ?)
753	                OR (? <= stream_ordering AND stream_ordering <= ?)
754	            GROUP BY events.sender
755	        """ % (
756	            new_bytes_expression,
757	        )
758	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:1001:18
1000	            # SQLite does not support SELECT COUNT(*) OVER()
1001	            sql = """
1002	                SELECT COUNT(*) FROM (
1003	                    SELECT lmr.user_id
1004	                    {sql_base}
1005	                ) AS count_user_ids
1006	            """.format(
1007	                sql_base=sql_base,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'stream'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:69:16
68	
69	_STREAM_TOKEN = "stream"
70	_TOPOLOGICAL_TOKEN = "topological"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'topological'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:70:21
69	_STREAM_TOKEN = "stream"
70	_TOPOLOGICAL_TOKEN = "topological"
71	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:120:4
119	    """
120	    assert direction in ("b", "f")
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:175:4
174	
175	    assert bound in (">", "<", ">=", "<=")
176	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stream.py:494:18
493	
494	            sql = """
495	                SELECT event_id, instance_name, topological_ordering, stream_ordering
496	                FROM events
497	                WHERE
498	                    room_id = ?
499	                    AND not outlier
500	                    AND stream_ordering > ? AND stream_ordering <= ?
501	                ORDER BY stream_ordering %s LIMIT ?
502	            """ % (
503	                order,
504	            )
505	            txn.execute(sql, (room_id, min_from_id, max_to_id, 2 * limit))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:866:8
865	        # This cannot happen as `allow_none=False`.
866	        assert results is not None
867	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1019:8
1018	        # Ensure we do actually have some values here
1019	        assert set(min_positions) == {"federation", "events"}
1020	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1071:8
1070	
1071	        assert int(limit) >= 0
1072	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:199:8
198	        """
199	        assert self._can_write_to_account_data
200	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:225:8
224	        """
225	        assert self._can_write_to_account_data
226	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:253:8
252	        """
253	        assert self._can_write_to_account_data
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\transactions.py:231:8
230	    ):
231	        assert self.database_engine.can_native_upsert
232	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:154:18
153	            # if those 250 rooms have less than batch_size state events.
154	            sql = """
155	                SELECT room_id, events FROM %s
156	                ORDER BY events DESC
157	                LIMIT 250
158	            """ % (
159	                TEMP_TABLE + "_rooms",
160	            )
161	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:169:24
168	            # far we are in processing
169	            txn.execute("SELECT COUNT(*) FROM " + TEMP_TABLE + "_rooms")
170	            progress["remaining"] = txn.fetchone()[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:280:18
279	        def _get_next_batch(txn):
280	            sql = "SELECT user_id FROM %s LIMIT %s" % (
281	                TEMP_TABLE + "_users",
282	                str(batch_size),
283	            )
284	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:294:18
293	            # far we are in processing
294	            sql = "SELECT COUNT(*) FROM " + TEMP_TABLE + "_users"
295	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:782:18
781	            # search: (domain, _, display name, localpart)
782	            sql = """
783	                SELECT d.user_id AS user_id, display_name, avatar_url
784	                FROM user_directory_search as t
785	                INNER JOIN user_directory AS d USING (user_id)
786	                WHERE
787	                    %(where_clause)s
788	                    AND vector @@ to_tsquery('simple', ?)
789	                ORDER BY
790	                    (CASE WHEN d.user_id IS NOT NULL THEN 4.0 ELSE 1.0 END)
791	                    * (CASE WHEN display_name IS NOT NULL THEN 1.2 ELSE 1.0 END)
792	                    * (CASE WHEN avatar_url IS NOT NULL THEN 1.2 ELSE 1.0 END)
793	                    * (
794	                        3 * ts_rank_cd(
795	                            '{0.1, 0.1, 0.9, 1.0}',
796	                            vector,
797	                            to_tsquery('simple', ?),
798	                            8
799	                        )
800	                        + ts_rank_cd(
801	                            '{0.1, 0.1, 0.9, 1.0}',
802	                            vector,
803	                            to_tsquery('simple', ?),
804	                            8
805	                        )
806	                    )
807	                    %(order_case_statements)s
808	                    DESC,
809	                    display_name IS NULL,
810	                    avatar_url IS NULL
811	                LIMIT ?
812	            """ % {
813	                "where_clause": where_clause,
814	                "order_case_statements": " ".join(additional_ordering_statements),
815	            }
816	            args = (

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:837:18
836	
837	            sql = """
838	                SELECT d.user_id AS user_id, display_name, avatar_url
839	                FROM user_directory_search as t
840	                INNER JOIN user_directory AS d USING (user_id)
841	                WHERE
842	                    %(where_clause)s
843	                    AND value MATCH ?
844	                ORDER BY
845	                    rank(matchinfo(user_directory_search)) DESC,
846	                    %(order_statements)s
847	                    display_name IS NULL,
848	                    avatar_url IS NULL
849	                LIMIT ?
850	            """ % {
851	                "where_clause": where_clause,
852	                "order_statements": " ".join(additional_ordering_statements),
853	            }
854	            args = join_args + (search_query,) + ordering_arguments + (limit + 1,)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\state\bg_updates.py:146:24
145	                    txn.execute(
146	                        "SELECT type, state_key, event_id FROM state_groups_state"
147	                        " WHERE state_group = ? " + where_clause,
148	                        args,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\engines\postgres.py:160:8
159	        numver = self._version
160	        assert numver is not None
161	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:211:8
210	
211	        assert stores.persist_events
212	        self.persist_events_store = stores.persist_events

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:306:8
305	        # stream ordering should have been assigned by now
306	        assert event_stream_id
307	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:428:24
427	                        # extremities, so we'll `continue` above and skip this bit.)
428	                        assert new_latest_event_ids, "No forward extremities left!"
429	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\persist_events.py:483:28
482	                            # extremities, so we'll `continue` above and skip this bit.)
483	                            assert new_latest_event_ids, "No forward extremities left!"
484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:339:8
338	    if is_empty:
339	        assert not applied_delta_files
340	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:341:8
340	    else:
341	        assert config
342	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:356:8
355	
356	        assert config is not None
357	        check_database_before_upgrade(cur, database_engine, config)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:58:20
57	    if step == 1:
58	        cur.execute("SELECT MAX(%s) FROM %s" % (column, table))
59	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:60:20
59	    else:
60	        cur.execute("SELECT MIN(%s) FROM %s" % (column, table))
61	    (val,) = cur.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:101:8
100	    ):
101	        assert step != 0
102	        self._lock = threading.Lock()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:328:22
327	            for table, _, id_column in tables:
328	                sql = """
329	                    SELECT GREATEST(COALESCE(%(agg)s(%(id)s), 1), 1)
330	                    FROM %(table)s
331	                """ % {
332	                    "id": id_column,
333	                    "table": table,
334	                    "agg": "MAX" if self._positive else "-MIN",
335	                }
336	                cur.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:358:22
357	            for table, instance_column, id_column in tables:
358	                sql = """
359	                    SELECT %(instance)s, %(id)s FROM %(table)s
360	                    WHERE ? %(cmp)s %(id)s
361	                """ % {
362	                    "id": id_column,
363	                    "table": table,
364	                    "instance": instance_column,
365	                    "cmp": "<=" if self._positive else ">=",
366	                }
367	                cur.execute(sql, (min_stream_id * self._return_factor,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:554:8
553	        # We require that the lock is locked by caller
554	        assert self._lock.locked()
555	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:601:14
600	        # value (or decrease if stream goes backwards).
601	        sql = """
602	            INSERT INTO stream_positions (stream_name, instance_name, stream_id)
603	            VALUES (?, ?, ?)
604	            ON CONFLICT (stream_name, instance_name)
605	            DO UPDATE SET
606	                stream_id = %(agg)s(stream_positions.stream_id, EXCLUDED.stream_id)
607	        """ % {
608	            "agg": "GREATEST" if self._positive else "LEAST",
609	        }
610	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:109:8
108	        fetch_res = txn.fetchone()
109	        assert fetch_res is not None
110	        return fetch_res[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:131:20
130	        # First we get the current max ID from the table.
131	        table_sql = "SELECT GREATEST(%(agg)s(%(id)s), 0) FROM %(table)s" % {
132	            "id": id_column,
133	            "table": table,
134	            "agg": "MAX" if positive else "-MIN",
135	        }
136	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:148:12
147	        txn.execute(
148	            "SELECT last_value, is_called FROM %(seq)s" % {"seq": self._sequence_name}
149	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:151:8
150	        fetch_res = txn.fetchone()
151	        assert fetch_res is not None
152	        last_value, is_called = fetch_res

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:222:16
221	            if self._current_max_id is None:
222	                assert self._callback is not None
223	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:232:16
231	            if self._current_max_id is None:
232	                assert self._callback is not None
233	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:282:8
281	    if table:
282	        assert id_column
283	        seq.check_consistency(

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:506:8
505	                )
506	        except Exception:
507	            pass
508	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:515:8
514	                return cls(topological=None, stream=int(string[1:]))
515	        except Exception:
516	            pass
517	        raise SynapseError(400, "Invalid token %r" % (string,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\types.py:557:8
556	        """
557	        assert self.topological is None
558	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\async_helpers.py:559:8
558	    if inspect.isawaitable(value):
559	        assert isinstance(value, Awaitable)
560	        return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\deferred_cache.py:159:16
158	                m = self.cache.metrics
159	                assert m  # we always have a name, so should always have metrics
160	                m.inc_hits()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:86:8
85	        """Returns True if the entity may have been updated since stream_pos"""
86	        assert isinstance(stream_pos, int)
87	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:134:8
133	        """Returns if any entity has changed"""
134	        assert type(stream_pos) is int
135	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:153:8
152	        """
153	        assert type(stream_pos) is int
154	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:168:8
167	        """
168	        assert type(stream_pos) is int
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\ttlcache.py:60:12
59	        if e is not SENTINEL:
60	            assert isinstance(e, _CacheEntry)
61	            self._expiry_list.remove(e)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\ttlcache.py:85:8
84	            return default
85	        assert isinstance(e, _CacheEntry)
86	        self._metrics.inc_hits()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\ttlcache.py:131:8
130	            return default
131	        assert isinstance(e, _CacheEntry)
132	        self._expiry_list.remove(e)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\metrics.py:124:12
123	        else:
124	            assert isinstance(curr_context, LoggingContext)
125	            parent_context = curr_context

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\retryutils.py:201:61
200	                self.retry_interval = int(
201	                    self.retry_interval * RETRY_MULTIPLIER * random.uniform(0.8, 1.4)
202	                )

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Ensure autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: Medium
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\util\templates.py:60:10
59	    loader = jinja2.FileSystemLoader(template_search_directories)
60	    env = jinja2.Environment(loader=loader, autoescape=autoescape)
61	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\util\versionstring.py:18:0
17	import os
18	import subprocess
19	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:47:16
46	            git_branch = (
47	                subprocess.check_output(
48	                    ["git", "rev-parse", "--abbrev-ref", "HEAD"], stderr=null, cwd=cwd
49	                )
50	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:47:16
46	            git_branch = (
47	                subprocess.check_output(
48	                    ["git", "rev-parse", "--abbrev-ref", "HEAD"], stderr=null, cwd=cwd
49	                )
50	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:60:16
59	            git_tag = (
60	                subprocess.check_output(
61	                    ["git", "describe", "--exact-match"], stderr=null, cwd=cwd
62	                )
63	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:60:16
59	            git_tag = (
60	                subprocess.check_output(
61	                    ["git", "describe", "--exact-match"], stderr=null, cwd=cwd
62	                )
63	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:72:16
71	            git_commit = (
72	                subprocess.check_output(
73	                    ["git", "rev-parse", "--short", "HEAD"], stderr=null, cwd=cwd
74	                )
75	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:72:16
71	            git_commit = (
72	                subprocess.check_output(
73	                    ["git", "rev-parse", "--short", "HEAD"], stderr=null, cwd=cwd
74	                )
75	                .strip()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\synapse\util\versionstring.py:84:16
83	            is_dirty = (
84	                subprocess.check_output(
85	                    ["git", "describe", "--dirty=" + dirty_string], stderr=null, cwd=cwd
86	                )
87	                .strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\util\versionstring.py:84:16
83	            is_dirty = (
84	                subprocess.check_output(
85	                    ["git", "describe", "--dirty=" + dirty_string], stderr=null, cwd=cwd
86	                )
87	                .strip()

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\visibility.py:309:20
308	                        domain = get_domain_from_id(ev.state_key)
309	                    except Exception:
310	                        continue
311	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:95:22
94	    def test_get_user_by_req_appservice_valid_token(self):
95	        app_service = Mock(
96	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
97	        )
98	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:111:22
110	
111	        app_service = Mock(
112	            token="foobar",
113	            url="a_url",
114	            sender=self.test_user,
115	            ip_range_whitelist=IPSet(["192.168/16"]),
116	        )
117	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:130:22
129	
130	        app_service = Mock(
131	            token="foobar",
132	            url="a_url",
133	            sender=self.test_user,
134	            ip_range_whitelist=IPSet(["192.168/16"]),
135	        )
136	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:163:22
162	    def test_get_user_by_req_appservice_missing_token(self):
163	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
164	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:177:22
176	        masquerading_user_id = b"@doppelganger:matrix.org"
177	        app_service = Mock(
178	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
179	        )
180	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:198:22
197	        masquerading_user_id = b"@doppelganger:matrix.org"
198	        app_service = Mock(
199	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
200	        )
201	        app_service.is_interested_in_user = Mock(return_value=False)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:59:31
58	            "type": "http",
59	            "bind_addresses": ["0.0.0.0"],
60	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:107:31
106	            "type": "http",
107	            "bind_addresses": ["0.0.0.0"],
108	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\appservice\test_appservice.py:30:23
29	    def setUp(self):
30	        self.service = ApplicationService(
31	            id="unique_identifier",
32	            sender="@as:test",
33	            url="some_url",
34	            token="some_token",
35	            hostname="matrix.org",  # only used by get_groups_for_user
36	            namespaces={
37	                ApplicationService.NS_USERS: [],
38	                ApplicationService.NS_ROOMS: [],
39	                ApplicationService.NS_ALIASES: [],
40	            },
41	        )
42	        self.event = Mock(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:145:12
144	            self.addCleanup(setattr, SSL, "SSL.OP_NO_TLSv1_3", OP_NO_TLSv1_3)
145	            assert not hasattr(SSL, "OP_NO_TLSv1_3")
146	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:167:12
166	            self.addCleanup(lambda: delattr(SSL, "OP_NO_TLSv1_3"))
167	            assert hasattr(SSL, "OP_NO_TLSv1_3")
168	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\federation\test_federation_catch_up.py:253:12
252	        ) -> bool:
253	            assert destination == destination_tm
254	            results_list.extend(pending_pdus)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:141:24
140	        service.is_interested.return_value = make_awaitable(is_interested)
141	        service.token = "mock_service_token"
142	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:148:24
147	        service.is_interested_in_alias.return_value = is_interested_in_alias
148	        service.token = "mock_service_token"
149	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'sometoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_federation.py:51:23
50	        # Send a 3PID invite event with an empty body so it's considered as a revoked one.
51	        invite_token = "sometoken"
52	        self.helper.send_state(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-client-secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_oidc.py:40:16
39	CLIENT_ID = "test-client-id"
40	CLIENT_SECRET = "test-client-secret"
41	BASE_URL = "https://synapse/"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\http\__init__.py:15:0
14	import os.path
15	import subprocess
16	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:89:4
88	    # first build a CSR
89	    subprocess.check_call(
90	        [
91	            "openssl",
92	            "req",
93	            "-new",
94	            "-key",
95	            get_test_key_file(),
96	            "-subj",
97	            "/",
98	            "-out",
99	            csr_filename,
100	        ]
101	    )
102	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:89:4
88	    # first build a CSR
89	    subprocess.check_call(
90	        [
91	            "openssl",
92	            "req",
93	            "-new",
94	            "-key",
95	            get_test_key_file(),
96	            "-subj",
97	            "/",
98	            "-out",
99	            csr_filename,
100	        ]
101	    )
102	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:111:4
110	    ca_cert_filename = get_test_ca_cert_file()
111	    subprocess.check_call(
112	        [
113	            "openssl",
114	            "x509",
115	            "-req",
116	            "-in",
117	            csr_filename,
118	            "-CA",
119	            ca_cert_filename,
120	            "-CAkey",
121	            ca_key_filename,
122	            "-set_serial",
123	            "1",
124	            "-extfile",
125	            cnf_filename,
126	            "-out",
127	            cert_filename,
128	        ]
129	    )
130	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:111:4
110	    ca_cert_filename = get_test_ca_cert_file()
111	    subprocess.check_call(
112	        [
113	            "openssl",
114	            "x509",
115	            "-req",
116	            "-in",
117	            csr_filename,
118	            "-CA",
119	            ca_cert_filename,
120	            "-CAkey",
121	            ca_key_filename,
122	            "-set_serial",
123	            "1",
124	            "-extfile",
125	            cnf_filename,
126	            "-out",
127	            cert_filename,
128	        ]
129	    )
130	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_email.py:217:8
216	        # Nothing should have happened yet, as we're paused.
217	        assert not self.email_attempts
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_email.py:247:8
246	        # Nothing should have happened yet, as we're paused.
247	        assert not self.email_attempts
248	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_presentable_names.py:56:8
55	    ) -> Optional[FrozenEvent]:
56	        assert allow_none, "Mock not configured for allow_none = False"
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\_base.py:533:8
532	        """Send a message back to the client."""
533	        assert self.transport is not None
534	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\slave\storage\test_events.py:253:8
252	        repl_transport = self._server_transport
253	        assert isinstance(repl_transport, FakeTransport)
254	        repl_transport.autoflush = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\streams\test_typing.py:71:8
70	        # The from token should be the token from the last RDATA we got.
71	        assert request.args is not None
72	        self.assertEqual(int(request.args[b"from_token"][0]), token)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:32:8
31	        cmd = parse_command_from_line(line)
32	        assert isinstance(cmd, RdataCommand)
33	        self.assertEqual(cmd.stream_name, "events")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:40:8
39	        cmd = parse_command_from_line(line)
40	        assert isinstance(cmd, RdataCommand)
41	        self.assertEqual(cmd.stream_name, "presence")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\test_federation_ack.py:72:8
71	        cmd = mock_connection.send_command.call_args[0][0]
72	        assert isinstance(cmd, FederationAckCommand)
73	        self.assertEqual(cmd.token, 10)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\admin\test_user.py:59:52
58	
59	        self.hs.config.registration_shared_secret = "shared"
60	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_consent.py:39:15
38	        config["public_baseurl"] = "aaaa"
39	        config["form_secret"] = "123abc"
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:526:8
525	        location_headers = channel.headers.getRawHeaders("Location")
526	        assert location_headers
527	        cas_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:551:8
550	        location_headers = channel.headers.getRawHeaders("Location")
551	        assert location_headers
552	        saml_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:575:8
574	        location_headers = channel.headers.getRawHeaders("Location")
575	        assert location_headers
576	        oidc_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:584:8
583	        cookie_headers = channel.headers.getRawHeaders("Set-Cookie")
584	        assert cookie_headers
585	        cookies = {}  # type: Dict[str, str]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:602:8
601	        content_type_headers = channel.headers.getRawHeaders("Content-Type")
602	        assert content_type_headers
603	        self.assertTrue(content_type_headers[-1].startswith("text/html"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:826:8
825	        location_headers = channel.headers.getRawHeaders("Location")
826	        assert location_headers
827	        self.assertEqual(location_headers[0][: len(redirect_url)], redirect_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_login.py:865:17
864	
865	    jwt_secret = "secret"
866	    jwt_algorithm = "HS256"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\v1\test_login.py:1131:23
1130	
1131	        self.service = ApplicationService(
1132	            id="unique_identifier",
1133	            token="some_token",
1134	            hostname="example.com",
1135	            sender="@asbot:example.com",
1136	            namespaces={
1137	                ApplicationService.NS_USERS: [
1138	                    {"regex": r"@as_user.*", "exclusive": False}
1139	                ],
1140	                ApplicationService.NS_ROOMS: [],
1141	                ApplicationService.NS_ALIASES: [],
1142	            },
1143	        )
1144	        self.another_service = ApplicationService(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'another_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\v1\test_login.py:1144:31
1143	        )
1144	        self.another_service = ApplicationService(
1145	            id="another__identifier",
1146	            token="another_token",
1147	            hostname="example.com",
1148	            sender="@as2bot:example.com",
1149	            namespaces={
1150	                ApplicationService.NS_USERS: [
1151	                    {"regex": r"@as2_user.*", "exclusive": False}
1152	                ],
1153	                ApplicationService.NS_ROOMS: [],
1154	                ApplicationService.NS_ALIASES: [],
1155	            },
1156	        )
1157	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:1270:8
1269	        location_headers = channel.headers.getRawHeaders("Location")
1270	        assert location_headers
1271	        picker_url = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:1314:8
1313	        location_headers = chan.headers.getRawHeaders("Location")
1314	        assert location_headers
1315	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\test_login.py:1324:8
1323	        location_headers = chan.headers.getRawHeaders("Location")
1324	        assert location_headers
1325	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 't1-0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:853:16
852	    def test_topo_token_is_accepted(self):
853	        token = "t1-0_0_0_0_0_0_0_0_0"
854	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:864:16
863	    def test_stream_token_is_accepted_for_fwd_pagianation(self):
864	        token = "s0_0_0_0_0_0_0_0_0"
865	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1407:16
1406	
1407	        token = "s0_0_0_0_0_0_0_0_0"
1408	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1424:16
1423	
1424	        token = "s0_0_0_0_0_0_0_0_0"
1425	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\test_rooms.py:1447:16
1446	
1447	        token = "s0_0_0_0_0_0_0_0_0"
1448	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:91:8
90	
91	        assert channel.result["code"] == b"%d" % expect_code, channel.result
92	        self.auth_user_id = temp_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:167:8
166	
167	        assert (
168	            int(channel.result["code"]) == expect_code
169	        ), "Expected: %d, got: %d, resp: %r" % (
170	            expect_code,
171	            int(channel.result["code"]),
172	            channel.result["body"],
173	        )
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:211:8
210	
211	        assert (
212	            int(channel.result["code"]) == expect_code
213	        ), "Expected: %d, got: %d, resp: %r" % (
214	            expect_code,
215	            int(channel.result["code"]),
216	            channel.result["body"],
217	        )
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:264:8
263	
264	        assert (
265	            int(channel.result["code"]) == expect_code
266	        ), "Expected: %d, got: %d, resp: %r" % (
267	            expect_code,
268	            int(channel.result["code"]),
269	            channel.result["body"],
270	        )
271	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:358:8
357	
358	        assert channel.code == expect_code, "Expected: %d, got: %d, resp: %r" % (
359	            expect_code,
360	            int(channel.result["code"]),
361	            channel.result["body"],
362	        )
363	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:382:8
381	        # expect a confirmation page
382	        assert channel.code == 200, channel.result
383	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:389:8
388	        )
389	        assert m, channel.text_body
390	        login_token = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:401:8
400	        )
401	        assert channel.code == 200
402	        return channel.json_body

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:445:12
444	            # can't set the client redirect url for UI Auth
445	            assert client_redirect_url is None
446	            oauth_uri = self.initiate_sso_ui_auth(ui_auth_session_id, cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:457:8
456	        oauth_uri_path, _ = oauth_uri.split("?", 1)
457	        assert oauth_uri_path == TEST_OIDC_AUTH_ENDPOINT, (
458	            "unexpected SSO URI " + oauth_uri_path
459	        )
460	        return self.complete_oidc_auth(oauth_uri, cookies, user_info_dict)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:508:12
507	            (expected_uri, resp_obj) = expected_requests.pop(0)
508	            assert uri == expected_uri
509	            resp = FakeResponse(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:558:8
557	        )
558	        assert channel.code == 302
559	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:574:8
573	
574	        assert channel.code == 302
575	        channel.extract_cookies(cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:602:8
601	        # that should serve a confirmation page
602	        assert channel.code == 200, channel.text_body
603	        channel.extract_cookies(cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v1\utils.py:609:8
608	        p.close()
609	        assert len(p.links) == 1, "not exactly one link in confirmation page"
610	        oauth_uri = p.links[0]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://issuer.test/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v1\utils.py:616:27
615	TEST_OIDC_AUTH_ENDPOINT = "https://issuer.test/auth"
616	TEST_OIDC_TOKEN_ENDPOINT = "https://issuer.test/token"
617	TEST_OIDC_USERINFO_ENDPOINT = "https://issuer.test/userinfo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:78:23
77	        """Test basic password reset flow"""
78	        old_password = "monkey"
79	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:79:23
78	        old_password = "monkey"
79	        new_password = "kangeroo"
80	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:97:24
96	
97	        client_secret = "foobar"
98	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:116:23
115	        """Test that we ratelimit /requestToken for the same email."""
116	        old_password = "monkey"
117	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:117:23
116	        old_password = "monkey"
117	        new_password = "kangeroo"
118	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:136:28
135	        def reset(ip):
136	            client_secret = "foobar"
137	            session_id = self._request_token(email, client_secret, ip)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:166:23
165	        """
166	        old_password = "monkey"
167	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:167:23
166	        old_password = "monkey"
167	        new_password = "kangeroo"
168	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:186:24
185	
186	        client_secret = "foobar"
187	        session_id = self._request_token(email_passwort_reset, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:204:23
203	        """Test that we do actually need to click the link in the email"""
204	        old_password = "monkey"
205	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:205:23
204	        old_password = "monkey"
205	        new_password = "kangeroo"
206	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:223:24
222	
223	        client_secret = "foobar"
224	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:241:23
240	        """
241	        old_password = "monkey"
242	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:242:23
241	        old_password = "monkey"
242	        new_password = "kangeroo"
243	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:260:24
259	
260	        client_secret = "foobar"
261	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:283:24
282	
283	        client_secret = "foobar"
284	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:336:8
335	    def _get_link_from_email(self):
336	        assert self.email_attempts, "No emails have been sent"
337	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:351:8
350	        match = re.search(r"https://example.com\S+", text)
351	        assert match, "Could not find link in email"
352	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:583:24
582	
583	        client_secret = "foobar"
584	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:687:24
686	        """Test that we do actually need to click the link in the email"""
687	        client_secret = "foobar"
688	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:724:24
723	        """
724	        client_secret = "foobar"
725	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:870:4
869	
870	    def _request_token_invalid_email(
871	        self,
872	        email,
873	        expected_errcode,
874	        expected_error,
875	        client_secret="foobar",
876	    ):
877	        channel = self.make_request(
878	            "POST",
879	            b"account/3pid/email/requestToken",
880	            {"client_secret": client_secret, "email": email, "send_attempt": 1},
881	        )
882	        self.assertEqual(400, int(channel.result["code"]), msg=channel.result["body"])
883	        self.assertEqual(expected_errcode, channel.json_body["errcode"])
884	        self.assertEqual(expected_error, channel.json_body["error"])
885	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:894:8
893	    def _get_link_from_email(self):
894	        assert self.email_attempts, "No emails have been sent"
895	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:909:8
908	        match = re.search(r"https://example.com\S+", text)
909	        assert match, "Could not find link in email"
910	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_account.py:917:24
916	
917	        client_secret = "foobar"
918	        session_id = self._request_token(request_email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_auth.py:187:25
186	    def prepare(self, reactor, clock, hs):
187	        self.user_pass = "pass"
188	        self.user = self.register_user("test", self.user_pass)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_capabilities.py:62:19
61	        localpart = "user"
62	        password = "pass"
63	        user = self.register_user(localpart, password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_capabilities.py:75:19
74	        localpart = "user"
75	        password = "pass"
76	        user = self.register_user(localpart, password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_capabilities.py:92:19
91	        localpart = "user"
92	        password = "pass"
93	        user = self.register_user(localpart, password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'C0mpl!antpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_password_policy.py:154:29
153	        """
154	        compliant_password = "C0mpl!antpassword"
155	        not_compliant_password = "notcompliantpassword"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'notcompliantpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_password_policy.py:155:33
154	        compliant_password = "C0mpl!antpassword"
155	        not_compliant_password = "notcompliantpassword"
156	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:49:19
48	        user_id = "@as_user_kermit:test"
49	        as_token = "i_am_an_app_service"
50	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:73:19
72	    def test_POST_appservice_registration_no_type(self):
73	        as_token = "i_am_an_app_service"
74	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_register.py:149:45
148	    def test_POST_guest_registration(self):
149	        self.hs.config.macaroon_secret_key = "test"
150	        self.hs.config.allow_guest_access = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:153:25
152	        for _ in range(20):
153	            from_token = ""
154	            if prev_token:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:210:25
209	        for _ in range(20):
210	            from_token = ""
211	            if prev_token:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\v2_alpha\test_relations.py:278:25
277	        for _ in range(20):
278	            from_token = ""
279	            if prev_token:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:215:8
214	        keyres = res["targetserver"][keyid]
215	        assert isinstance(keyres, FetchKeyResult)
216	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:237:8
236	        keyres = res[self.hs.hostname][keyid]
237	        assert isinstance(keyres, FetchKeyResult)
238	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:254:8
253	        keyres = res[self.hs.hostname][keyid]
254	        assert isinstance(keyres, FetchKeyResult)
255	        self.assertEqual(

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tests\rest\media\v1\test_url_preview.py:28:4
27	try:
28	    import lxml
29	except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\server.py:97:8
96	    def write(self, content):
97	        assert isinstance(content, bytes), "Should be bytes! " + repr(content)
98	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\server_notices\test_consent.py:48:15
47	        config["public_baseurl"] = "https://example.com/"
48	        config["form_secret"] = "123abc"
49	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\storage\test_appservice.py:48:24
47	
48	        self.as_token = "token1"
49	        self.as_url = "some_url"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\storage\test_appservice.py:67:12
66	                os.remove(f)
67	            except Exception:
68	                pass
69	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:536:13
535	    def test_duplicate_as_tokens(self):
536	        f1 = self._write_config(as_token="as_token", suffix="1")
537	        f2 = self._write_config(as_token="as_token", suffix="2")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:537:13
536	        f1 = self._write_config(as_token="as_token", suffix="1")
537	        f2 = self._write_config(as_token="as_token", suffix="2")
538	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\tests\storage\test_id_generators.py:648:20
647	                txn.execute(
648	                    "INSERT INTO %s VALUES (nextval('foobar_seq'), ?)" % (table,),
649	                    (instance_name,),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_redaction.py:242:16
241	                built_event._dict["event_id"] = self._event_id
242	                assert built_event.event_id == self._event_id
243	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobartoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_mau.py:102:19
101	        # with.
102	        as_token = "foobartoken"
103	        self.store.services_cache.append(

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tests\test_preview.py:24:4
23	try:
24	    import lxml
25	except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\event_injection.py:74:4
73	    persistence = hs.get_storage().persistence
74	    assert persistence is not None
75	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\html_parsers.py:45:16
44	            if attr_dict["type"] == "radio":
45	                assert input_name
46	                self.radios.setdefault(input_name, []).append(attr_dict["value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\html_parsers.py:48:16
47	            elif attr_dict["type"] == "hidden":
48	                assert input_name
49	                self.hiddens[input_name] = attr_dict["value"]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittest.py:561:52
560	        """
561	        self.hs.config.registration_shared_secret = "shared"
562	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:660:16
659	            async def list_fn(self, args1, arg2):
660	                assert current_context().name == "c1"
661	                # we want this to behave like an asynchronous function

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:663:16
662	                await run_on_reactor()
663	                assert current_context().name == "c1"
664	                return self.mock(args1, arg2)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:336:15
335	    async def hash(p):
336	        return hashlib.md5(p.encode("utf8")).hexdigest()
337	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\utils.py:341:15
340	    async def validate_hash(p, h):
341	        return hashlib.md5(p.encode("utf8")).hexdigest() == h
342	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\utils.py:414:8
413	            path = mock_request.path
414	        except Exception:
415	            pass
416	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\utils.py:456:8
455	    def verify(self, message, sig):
456	        assert sig == b"\x9a\x87$"
457	

--------------------------------------------------

Code scanned:
	Total lines of code: 151168
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 476
		Medium: 108
		High: 9
	Total issues (by confidence):
		Undefined: 0
		Low: 70
		Medium: 128
		High: 395
Files skipped (0):
