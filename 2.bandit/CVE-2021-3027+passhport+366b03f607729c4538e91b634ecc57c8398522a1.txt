Working... ---------------------------------------- 100% 0:00:01
Run started:2024-02-10 22:03:28.177912

Test results:
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhport-admin\manager\requests_functions.py:112:20
111	    if ret == 0 and obj == "target":
112	        passwords = eval(silentget(config.url_passhport + obj + \
113	                         "/getpassword/" + param["<name>"]))
114	        if len(passwords) >= 1:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhport-admin\manager\requests_functions.py:150:12
149	    try:
150	        r = requests.post(url, data = data, verify=config.certificate_path)
151	    except requests.exceptions.Timeout:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhport\connections_utils\password.py:28:31
27	    for i in range(pw_len//3):
28	        pwlist.append(alphabet[random.randrange(len(alphabet))])
29	        pwlist.append(upperalphabet[random.randrange(len(upperalphabet))])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhport\connections_utils\password.py:29:36
28	        pwlist.append(alphabet[random.randrange(len(alphabet))])
29	        pwlist.append(upperalphabet[random.randrange(len(upperalphabet))])
30	        pwlist.append(str(random.randrange(10)))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhport\connections_utils\password.py:30:26
29	        pwlist.append(upperalphabet[random.randrange(len(upperalphabet))])
30	        pwlist.append(str(random.randrange(10)))
31	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhport\connections_utils\password.py:33:31
32	    for i in range(pw_len-len(pwlist)):
33	        pwlist.append(alphabet[random.randrange(len(alphabet))])
34	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\passhport\connections_utils\password.py:57:8
56	    # 3. Propage password (this command HAS to be launched as root)
57	    r = os.popen("ssh -q -o BatchMode=yes root@" + server + ' ' + sshoptions + \
58	              ' -p ' + str(port) + ' -l root \'echo "' + \
59	              user + ':' + pwdstring + '" | chpasswd\' ' +\
60	              '&& echo -n changed').read()
61	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhport\connections_utils\password.py:76:20
75	            if SSL:
76	                r = requests.post(url, data = data, verify=SSL_CERTIFICAT)
77	            else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhport\connections_utils\password.py:78:20
77	            else:
78	                r = requests.post(url, data = data)
79	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\passhport\connections_utils\scp.py:64:4
63	    # Actually execute the command
64	    os.system(cmd)
65	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\passhport\connections_utils\scp.py:87:4
86	    # Actually execute the command
87	    os.system(cmd)
88	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\passhport\connections_utils\ssh.py:16:8
15	        # We replace this process by the connexion to free some memory
16	        os.execl("/bin/bash", " ",
17	                 ssh_script,
18	                 filelog, str(port), login, target, str(pid),
19	                 url_passhport, cert, username, sshoptions)
20	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\passhport\connections_utils\ssh.py:25:8
24	        f.close()
25	        os.system('ssh -p ' + str(port) + " " + login + '@' + target + \
26	                  ' ' + sshoptions + " '" + originalcmd + "'" )
27	        

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhport\connections_utils\ssh.py:31:16
30	        if cert != "/dev/null": 
31	            r = requests.get(url, verify=cert)
32	        else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhport\connections_utils\ssh.py:33:16
32	        else:
33	            r = requests.get(url)
34	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\passhportd\app\models_mod\target.py:7:0
6	from flask import jsonify
7	from subprocess import Popen, PIPE
8	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhportd\app\models_mod\target.py:449:35
448	        for i in range(pw_len//3):
449	            pwlist.append(alphabet[random.randrange(len(alphabet))])
450	            pwlist.append(upperalphabet[random.randrange(len(upperalphabet))])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhportd\app\models_mod\target.py:450:40
449	            pwlist.append(alphabet[random.randrange(len(alphabet))])
450	            pwlist.append(upperalphabet[random.randrange(len(upperalphabet))])
451	            pwlist.append(str(random.randrange(10)))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhportd\app\models_mod\target.py:451:30
450	            pwlist.append(upperalphabet[random.randrange(len(upperalphabet))])
451	            pwlist.append(str(random.randrange(10)))
452	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\passhportd\app\models_mod\target.py:454:35
453	        for i in range(pw_len-len(pwlist)):
454	            pwlist.append(alphabet[random.randrange(len(alphabet))])
455	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\passhportd\app\models_mod\target.py:472:12
471	        # 3. Propage password (this command HAS to be launched as root)
472	        r = os.popen("ssh -q -o BatchMode=yes root@" + self.hostname + \
473	                     ' ' + self.sshoptions + \
474	                     ' -p ' + str(self.show_port()) + ' -l root \'echo "' + \
475	                     self.show_login() + ':' + pwdstring + '" | chpasswd\' ' +\
476	                     '&& echo -n changed').read()
477	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\passhportd\app\tests\test_views_mod\test_user.py:11:10
10	
11	TEST_DB = '/tmp/test.db'
12	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\passhportd\app\views.py:4:0
3	import re
4	import subprocess
5	import os

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\passhportd\app\views.py:360:12
359	    try:
360	        p = subprocess.check_output(command)
361	    except:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\passhportd\app\views.py:403:12
402	    try:
403	        p = subprocess.Popen(command, stdout=subprocess.PIPE)
404	    except:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\passhportd\app\views_mod\target\target.py:8:0
7	from . import api
8	from subprocess import Popen, PIPE
9	from datetime import datetime, timedelta

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\passhportd\app\views_mod\target\target.py:101:16
100	            # Try to connect and get the result
101	            r = os.system(sshcommand)
102	            if r == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\passhportd\app\views_mod\target\target.py:610:14
609	    #Call the external script
610	    process = Popen([config.OPEN_ACCESS_PATH, 
611	                    t.show_targettype(),
612	                    formatedstop,                    
613	                    ip,
614	                    t.show_hostname(),
615	                    str(t.show_port()),
616	                    username,
617	                    t.show_name()], stdout=PIPE)
618	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhportd\app\views_mod\target\target.py:631:21
630	        try:
631	            output = eval(output)
632	        except:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\passhportd\app\views_mod\target\target.py:696:14
695	    #Call the external script
696	    process = Popen([config.OPEN_ACCESS_PATH, 
697	                    "db-close",
698	                    str(pid)], stdout=PIPE)
699	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhportd\app\views_mod\target\target.py:712:21
711	        try:
712	            output = eval(output)
713	        except:

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\passhweb\app\requests_functions.py:14:12
13	    try:
14	        r = requests.get(url, verify=False)
15	    except requests.RequestException as e:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhweb\app\requests_functions.py:14:12
13	    try:
14	        r = requests.get(url, verify=False)
15	    except requests.RequestException as e:

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\passhweb\app\requests_functions.py:37:12
36	    try:
37	        r = requests.post(url, data = data, verify=False)
38	    except requests.exceptions.Timeout:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhweb\app\requests_functions.py:37:12
36	    try:
37	        r = requests.post(url, data = data, verify=False)
38	    except requests.exceptions.Timeout:

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\passhweb\app\requests_functions.py:61:11
60	    print("==> Connection to passhportd via stream: " + url)
61	    return requests.post(url, data = data, stream = True, verify=False)
62	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\passhweb\app\requests_functions.py:61:11
60	    print("==> Connection to passhportd via stream: " + url)
61	    return requests.post(url, data = data, stream = True, verify=False)
62	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhweb\app\requests_functions.py:68:15
67	        # passhportd return a json, that we eval in dict
68	        return eval(str(api_resp).replace("\r",""))
69	    else:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhweb\app\requests_functions.py:238:26
237	        return output
238	    players = [p for p in eval(r) if p[:3] == "jcd"]
239	

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhweb\app\views.py:96:33
95	    if targetlist:
96	        playerlist = [p for p in eval(targetlist) if p[:3] == "jcd"]
97	        if len(playerlist) > 0:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\passhweb\app\views.py:577:12
576	        return "[]"
577	    names = eval(names)
578	    # Format in json

--------------------------------------------------

Code scanned:
	Total lines of code: 7454
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 16
		Medium: 16
		High: 9
	Total issues (by confidence):
		Undefined: 0
		Low: 8
		Medium: 2
		High: 31
Files skipped (0):
