Working... ---------------------------------------- 100% 0:00:01
Run started:2024-02-10 22:04:36.870852

Test results:
>> Issue: [B403:blacklist] Consider possible security implications associated with dumps module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\fail2ban\client\csocket.py:28:0
27	#from cPickle import dumps, loads, HIGHEST_PROTOCOL
28	from pickle import dumps, loads, HIGHEST_PROTOCOL
29	from ..protocol import CSPROTO

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\fail2ban\client\csocket.py:67:9
66				msg = msg + chunk
67			return loads(msg)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\fail2ban\client\fail2banregex.py:271:2
270		def readRegex(self, value, regextype):
271			assert(regextype in ('fail', 'ignore'))
272			regex = regextype + 'regex'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\fail2ban\client\fail2banregex.py:392:4
391				if len(ret) > 0:
392					assert(not is_ignored)
393					self._line_stats.matched += 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\fail2ban\client\fail2banregex.py:410:2
409			lstats = self._line_stats
410			assert(self._line_stats.missed == lstats.tested - (lstats.matched + lstats.ignored))
411			lines = lstats[ltype]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\fail2ban\server\action.py:28:0
27	import signal
28	import subprocess
29	import tempfile

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\fail2ban\server\action.py:577:11
576				popen = subprocess.Popen(
577					realCmd, stdout=stdout, stderr=stderr, shell=True,
578					preexec_fn=os.setsid  # so that killpg does not kill our process
579				)
580				stime = time.time()
581				retcode = popen.poll()

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with dumps module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\fail2ban\server\asyncserver.py:27:0
26	
27	from pickle import dumps, loads, HIGHEST_PROTOCOL
28	import asynchat

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\fail2ban\server\asyncserver.py:77:12
76			# Deserialize
77			message = loads(message)
78			# Gives the message to the transmitter.

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\fail2ban\server\database.py:274:21
273			if version < 2:
274				cur.executescript("BEGIN TRANSACTION;"
275							"CREATE TEMPORARY TABLE logs_temp AS SELECT * FROM logs;"
276							"DROP TABLE logs;"
277							"%s;"
278							"INSERT INTO logs SELECT * from logs_temp;"
279							"DROP TABLE logs_temp;"
280							"UPDATE fail2banDb SET version = 2;"
281							"COMMIT;" % Fail2BanDb._TABLE_logs)
282	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\fail2ban\server\database.py:337:15
336			else:
337				cur.execute("SELECT name FROM jails WHERE enabled=%s" %
338					(int(enabled),))
339			return set(row[0] for row in cur.fetchmany())

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\fail2ban\tests\actiontestcase.py:268:16
267			# temporary file for a nasty kid shell script
268			tmpFilename = tempfile.mktemp(".sh", "fail2ban_")
269			# Create a nasty script which would hang there for a while

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\fail2ban\tests\banmanagertestcase.py:101:21
100			# non-existing IP
101			ticket = BanTicket("0.0.0.0", 1167605999.0)
102			self.assertTrue(self.__banManager.addBanTicket(ticket))

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\fail2ban\tests\databasetestcase.py:97:47
96			self.assertEqual(self.db.getJailNames(), set(['DummyJail #29162448 with 0 tickets']))
97			self.assertEqual(self.db.getLogPaths(), set(['/tmp/Fail2BanDb_pUlZJh.log']))
98			ticket = FailTicket("127.0.0.1", 1388009242.26, [u"abc\n"])

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\fail2ban\tests\files\config\apache-auth\digest.py:50:8
49	def preauth():
50	    r = requests.get(host + url)
51	    print(r)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\fail2ban\tests\files\config\apache-auth\digest.py:62:11
61	username="username"
62	password = "password"
63	print(v)

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\fail2ban\tests\servertestcase.py:383:9
382			# Broken symlink
383			name = tempfile.mktemp(prefix='tmp_fail2ban_broken_symlink')
384			sname = name + '.slink'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\fail2ban\tests\utils.py:408:1
407	def assert_dict_equal(a, b):
408		assert isinstance(a, dict), "Object is not dictionary: %r" % a
409		assert isinstance(b, dict), "Object is not dictionary: %r" % b

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\fail2ban\tests\utils.py:409:1
408		assert isinstance(a, dict), "Object is not dictionary: %r" % a
409		assert isinstance(b, dict), "Object is not dictionary: %r" % b
410		assert a==b, "Dictionaries differ:\n%r !=\n%r" % (a, b)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\fail2ban\tests\utils.py:410:1
409		assert isinstance(b, dict), "Object is not dictionary: %r" % b
410		assert a==b, "Dictionaries differ:\n%r !=\n%r" % (a, b)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\setup.py:132:0
131	# This is due to tests not functioning for python3 as 2to3 takes place later
132	exec(open(join("fail2ban", "version.py")).read())
133	

--------------------------------------------------

Code scanned:
	Total lines of code: 11217
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 10
		Medium: 10
		High: 1
	Total issues (by confidence):
		Undefined: 0
		Low: 2
		Medium: 4
		High: 15
Files skipped (6):
	.\fail2ban\protocol.py (syntax error while parsing AST from file)
	.\fail2ban\server\filter.py (syntax error while parsing AST from file)
	.\fail2ban\server\server.py (syntax error while parsing AST from file)
	.\fail2ban\tests\clientreadertestcase.py (syntax error while parsing AST from file)
	.\fail2ban\tests\filtertestcase.py (syntax error while parsing AST from file)
	.\fail2ban\tests\misctestcase.py (syntax error while parsing AST from file)
