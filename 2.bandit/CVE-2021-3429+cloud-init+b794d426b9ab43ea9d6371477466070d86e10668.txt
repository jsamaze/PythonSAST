Working... ---------------------------------------- 100% 0:00:11
Run started:2024-02-10 22:05:50.085215

Test results:
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\analyze\show.py:234:4
233	
234	    except Exception:
235	        pass
236	    return TIMESTAMP_UNKNOWN

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\apport.py:61:45
60	    root_command_output(
61	        ['cloud-init', 'collect-logs', '-t', '/tmp/cloud-init-logs.tgz'])
62	    attach_file(report, '/tmp/cloud-init-logs.tgz', 'logs.tgz')

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\apport.py:62:24
61	        ['cloud-init', 'collect-logs', '-t', '/tmp/cloud-init-logs.tgz'])
62	    attach_file(report, '/tmp/cloud-init-logs.tgz', 'logs.tgz')
63	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\cmd\devel\logs.py:98:21
97	    log_dir = 'cloud-init-logs-{0}'.format(date)
98	    with tempdir(dir='/tmp') as tmp_dir:
99	        log_dir = os.path.join(tmp_dir, log_dir)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\cmd\main.py:626:8
625	            status = json.loads(util.load_file(status_path))
626	        except Exception:
627	            pass
628	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:69:12
68	        ) as m_cli_log:
69	            assert 1 == query.handle_args('anyname', args)
70	        expected_error = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:73:8
72	            ' or varname\n')
73	        assert expected_error in caplog.text
74	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:75:8
74	        out, _err = capsys.readouterr()
75	        assert 'usage: query' in out
76	        assert 1 == m_cli_log.call_count

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:76:8
75	        assert 'usage: query' in out
76	        assert 1 == m_cli_log.call_count
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:85:8
84	            list_keys=False, user_data='ud', vendor_data='vd', varname=None)
85	        assert 1 == query.handle_args('anyname', args)
86	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:88:8
87	        msg = 'Missing instance-data file: %s' % absent_fn
88	        assert msg in caplog.text
89	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:102:12
101	            m_load.side_effect = OSError(errno.EACCES, 'Not allowed')
102	            assert 1 == query.handle_args('anyname', args)
103	        msg = "No read permission on '%s'. Try sudo" % noread_fn

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:104:8
103	        msg = "No read permission on '%s'. Try sudo" % noread_fn
104	        assert msg in caplog.text
105	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:114:12
113	            m_paths.return_value = paths
114	            assert 1 == query.handle_args('anyname', args)
115	        json_file = run_dir.join(INSTANCE_JSON_FILE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:117:8
116	        msg = 'Missing instance-data file: %s' % json_file.strpath
117	        assert msg in caplog.text
118	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:129:16
128	                m_getuid.return_value = 0
129	                assert 1 == query.handle_args('anyname', args)
130	        json_file = run_dir.join(INSTANCE_JSON_FILE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:138:8
137	        )
138	        assert msg in caplog.text
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:166:16
165	                m_getuid.return_value = 0
166	                assert 0 == query.handle_args('anyname', args)
167	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:169:8
168	        cmd_output = json.loads(out)
169	        assert "it worked" == cmd_output['my_var']
170	        if ud_expected == "ci-b64:":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:174:8
173	            vd_expected = "ci-b64:{}".format(b64e(vd_src))
174	        assert ud_expected == cmd_output['userdata']
175	        assert vd_expected == cmd_output['vendordata']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:175:8
174	        assert ud_expected == cmd_output['userdata']
175	        assert vd_expected == cmd_output['vendordata']
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:194:16
193	                m_getuid.return_value = 0
194	                assert 0 == query.handle_args('anyname', args)
195	        expected = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:200:8
199	        out, _err = capsys.readouterr()
200	        assert expected == out
201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:212:12
211	            m_getuid.return_value = 100
212	            assert 0 == query.handle_args('anyname', args)
213	        expected = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:220:8
219	        out, _err = capsys.readouterr()
220	        assert expected == out
221	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:232:12
231	            m_getuid.return_value = 100
232	            assert 0 == query.handle_args('anyname', args)
233	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:234:8
233	        out, _err = capsys.readouterr()
234	        assert 'it worked\n' == out
235	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:248:12
247	            m_getuid.return_value = 100
248	            assert 0 == query.handle_args('anyname', args)
249	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:250:8
249	        out, _err = capsys.readouterr()
250	        assert 'value-2\n' == out
251	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:281:12
280	            m_getuid.return_value = 100
281	            assert 0 == query.handle_args('anyname', args)
282	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:283:8
282	        out, _err = capsys.readouterr()
283	        assert expected == out
284	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:300:12
299	            m_getuid.return_value = 100
300	            assert 0 == query.handle_args('anyname', args)
301	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:302:8
301	        out, _err = capsys.readouterr()
302	        assert expected == out
303	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:319:12
318	            m_getuid.return_value = 100
319	            assert 0 == query.handle_args('anyname', args)
320	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:321:8
320	        out, _err = capsys.readouterr()
321	        assert expected == out
322	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:338:12
337	            m_getuid.return_value = 100
338	            assert 1 == query.handle_args('anyname', args)
339	        assert expected_error in caplog.text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\cmd\tests\test_query.py:339:8
338	            assert 1 == query.handle_args('anyname', args)
339	        assert expected_error in caplog.text
340	

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\cc_disk_setup.py:1008:8
1007	    try:
1008	        subp.subp(fs_cmd, shell=shell)
1009	    except Exception as e:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\config\cc_mounts.py:392:12
391	                toks = WS.split(line)
392	            except Exception:
393	                pass
394	            fstab_devs[toks[0]] = line

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\cloudinit\config\cc_power_state_change.py:58:0
57	import re
58	import subprocess
59	import time

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\cloudinit\config\cc_power_state_change.py:96:15
95	    try:
96	        proc = subprocess.Popen(cond, shell=not isinstance(cond, list))
97	        proc.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\cloudinit\config\cc_power_state_change.py:189:15
188	    try:
189	        proc = subprocess.Popen(exe_args, stdin=subprocess.PIPE,
190	                                stdout=output, stderr=subprocess.STDOUT)
191	        proc.communicate(data_in)

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\cc_snap.py:208:12
207	        try:
208	            subp.subp(command, shell=shell, status_cb=sys.stderr.write)
209	        except subp.ProcessExecutionError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_final_message.py:42:8
41	        # We should not change the status of the instance directory
42	        assert instance_dir_exists == instance_dir.exists()
43	        assert file_is_written == boot_finished.exists()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_final_message.py:43:8
42	        assert instance_dir_exists == instance_dir.exists()
43	        assert file_is_written == boot_finished.exists()
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_final_message.py:46:12
45	        if expected_log_substring:
46	            assert expected_log_substring in caplog.text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_grub_dpkg.py:94:8
93	        idevs = fetch_idevs(log)
94	        assert expected_idevs == idevs
95	        if expected_log_call is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_grub_dpkg.py:96:12
95	        if expected_log_call is not None:
96	            assert expected_log_call in log.debug.call_args_list
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_keys_to_console.py:34:8
33	
34	        assert subp_called == (m_subp.call_count == 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_mounts.py:29:8
28	        create_swapfile(fname, '')
29	        assert mock.call(['mkswap', fname]) in m_subp.call_args_list
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_mounts.py:51:8
50	        cmds = [args[0][0] for args, _kwargs in m_subp.call_args_list]
51	        assert "fallocate" in cmds, "fallocate was not called"
52	        assert "dd" in cmds, "fallocate failure did not fallback to dd"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_mounts.py:52:8
51	        assert "fallocate" in cmds, "fallocate was not called"
52	        assert "dd" in cmds, "fallocate failure did not fallback to dd"
53	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_mounts.py:54:8
53	
54	        assert cmds.index("dd") > cmds.index(
55	            "fallocate"
56	        ), "dd ran before fallocate"
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_mounts.py:58:8
57	
58	        assert mock.call(["mkswap", fname]) in m_subp.call_args_list
59	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_mounts.py:61:8
60	        msg = "fallocate swap creation failed, will attempt with dd"
61	        assert msg in caplog.text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_resolv_conf.py:21:8
20	
21	        assert [
22	            mock.call(mock.ANY, "/etc/resolv.conf", mock.ANY)
23	        ] == m_render_to_file.call_args_list
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_resolv_conf.py:31:8
30	
31	        assert [
32	            mock.call(mock.ANY, "/use/this/path", mock.ANY)
33	        ] == m_render_to_file.call_args_list
34	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\config\tests\test_resolv_conf.py:84:8
83	            expected_content += "\n".join([expected_extra_line, ""])
84	        assert [
85	            mock.call(mock.ANY, expected_content, mode=mock.ANY)
86	        ] == m_write_file.call_args_list

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:35:12
34	        with self.assertRaises(RuntimeError) as context_manager:
35	            configure_ua(token='SomeToken')
36	        self.assertEqual(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:45:8
44	        """When token is provided, attach the machine to ua using the token."""
45	        configure_ua(token='SomeToken')
46	        m_subp.assert_called_once_with(['ua', 'attach', 'SomeToken'])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:65:12
64	        with self.assertRaises(RuntimeError) as context_manager:
65	            configure_ua(token='SomeToken', enable=['esm', 'cc', 'fips'])
66	        self.assertEqual(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:89:8
88	        """When services is an empty list, do not auto-enable attach."""
89	        configure_ua(token='SomeToken', enable=[])
90	        m_subp.assert_called_once_with(['ua', 'attach', 'SomeToken'])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:98:8
97	        """When services a list, only enable specific services."""
98	        configure_ua(token='SomeToken', enable=['fips'])
99	        self.assertEqual(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:111:8
110	        """When services a string, treat as singleton list and warn"""
111	        configure_ua(token='SomeToken', enable='fips')
112	        self.assertEqual(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'SomeToken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:125:8
124	        """When services not string or list, warn but still attach"""
125	        configure_ua(token='SomeToken', enable={'deffo': 'wont work'})
126	        self.assertEqual(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:223:8
222	        handle('nomatter', cfg=cfg, cloud=None, log=self.logger, args=None)
223	        m_configure_ua.assert_called_once_with(
224	            token='token', enable=['esm'])
225	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:238:8
237	            self.logs.getvalue().splitlines()[0])
238	        m_configure_ua.assert_called_once_with(
239	            token='token', enable=['esm'])
240	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\cloudinit\config\tests\test_ubuntu_advantage.py:276:8
275	            self.logs.getvalue().splitlines()[0])
276	        m_configure_ua.assert_called_once_with(
277	            token='token', enable=['esm'])
278	

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\tests\test_users_groups.py:45:13
44	            [mock.call('ubuntu', groups='lxd,sudo', lock_passwd=True,
45	                       shell='/bin/bash'),
46	             mock.call('me2', default=False)])
47	        m_group.assert_not_called()

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\tests\test_users_groups.py:71:13
70	            [mock.call('freebsd', groups='wheel', lock_passwd=True,
71	                       shell='/bin/tcsh'),
72	             mock.call('me2', default=False)])
73	        m_fbsd_group.assert_not_called()

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\tests\test_users_groups.py:92:13
91	            [mock.call('ubuntu', groups='lxd,sudo', lock_passwd=True,
92	                       shell='/bin/bash'),
93	             mock.call('me2', cloud_public_ssh_keys=['key1'], default=False,
94	                       ssh_redirect_user='ubuntu')])

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\tests\test_users_groups.py:113:13
112	            [mock.call('ubuntu', groups='lxd,sudo', lock_passwd=True,
113	                       shell='/bin/bash'),
114	             mock.call('me2', cloud_public_ssh_keys=['key1'], default=False,
115	                       ssh_redirect_user='ubuntu')])

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\config\tests\test_users_groups.py:152:13
151	            [mock.call('ubuntu', groups='lxd,sudo', lock_passwd=True,
152	                       shell='/bin/bash'),
153	             mock.call('me2', default=False)])
154	        m_group.assert_not_called()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_init.py:58:8
57	        """
58	        assert expected == _get_package_mirror_info(mirror_info,
59	                                                    mirror_filter=lambda x: x)
60	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_init.py:67:8
66	        }
67	        assert {'primary': 'http://other'} == _get_package_mirror_info(
68	            mirror_info, mirror_filter=lambda x: False)
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_init.py:156:8
155	        print(expected)
156	        assert {'primary': expected} == ret

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:62:8
61	    def test_returns_false_by_default(self, sys_class_net):
62	        assert not LinuxNetworking().is_physical("eth0")
63	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:69:8
68	        sys_class_net.join(devname).mkdir()
69	        assert not LinuxNetworking().is_physical(devname)
70	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:77:8
76	
77	        assert LinuxNetworking().is_physical(devname)
78	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:94:8
93	
94	        assert (mock.call(['ip', 'link', 'set', devname, 'up']) ==
95	                m_subp.call_args_list[-1])
96	        assert is_success

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:96:8
95	                m_subp.call_args_list[-1])
96	        assert is_success
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:103:8
102	
103	        assert (mock.call(['ip', 'link', 'set', devname, 'up']) ==
104	                m_subp.call_args_list[-1])
105	        assert not is_success

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:105:8
104	                m_subp.call_args_list[-1])
105	        assert not is_success
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:120:8
119	
120	        assert [mock.call(exists=None)] == m_udevadm_settle.call_args_list
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:126:8
125	        expected_path = net.sys_dev_path("ens3")
126	        assert [
127	            mock.call(exists=expected_path)
128	        ] == m_udevadm_settle.call_args_list
129	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:169:12
168	                networking.wait_for_physdevs(wait_for_physdevs_netcfg)
169	            assert 0 == m_settle.call_count
170	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\distros\tests\test_networking.py:220:8
219	
220	        assert (
221	            5 * len(wait_for_physdevs_netcfg["ethernets"])
222	            == m_settle.call_count
223	        )

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\log.py:104:8
103	            return
104	        except Exception:
105	            # We do not write any logs of this here, because the default
106	            # configuration includes an attempt at using /dev/log, followed
107	            # up by writing to a file.  /dev/log will not exist in very early
108	            # boot, so an exception on that is expected.
109	            pass
110	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\net\__init__.py:214:4
213	        features = read_sys_net(devname, 'device/features')
214	    except Exception:
215	        pass
216	    return features

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\bsd.py:91:35
90	                    routes.append({
91	                        'network': '0.0.0.0',
92	                        'netmask': '0.0.0.0',
93	                        'gateway': gateway})
94	                routes += subnet.get('routes', [])
95	        for route in routes:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\bsd.py:92:35
91	                        'network': '0.0.0.0',
92	                        'netmask': '0.0.0.0',
93	                        'gateway': gateway})
94	                routes += subnet.get('routes', [])
95	        for route in routes:
96	            network = route.get('network')

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\dhcp.py:397:26
396	                return static_routes
397	            net_address = "0.0.0.0"
398	            gateway = ".".join(tokens[idx+1:idx+req_toks])

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\eni.py:375:31
374	        default_gw = ''
375	        if route['network'] == '0.0.0.0' and route['netmask'] == '0.0.0.0':
376	            default_gw = ' default'

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\eni.py:375:65
374	        default_gw = ''
375	        if route['network'] == '0.0.0.0' and route['netmask'] == '0.0.0.0':
376	            default_gw = ' default'

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\freebsd.py:49:22
48	    def set_route(self, network, netmask, gateway):
49	        if network == '0.0.0.0':
50	            self.set_rc_config_value('defaultrouter', gateway)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\netbsd.py:39:22
38	    def set_route(self, network, netmask, gateway):
39	        if network == '0.0.0.0':
40	            self.set_rc_config_value('defaultroute', gateway)

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: ' '
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\cloudinit\net\netplan.py:76:4
75	
76	    def _listify(obj, token=' '):
77	        "Helper to convert strings to list of strings, handle single string"
78	        if not obj or type(obj) not in [str]:
79	            return obj
80	        if token in obj:
81	            return obj.split(token)
82	        else:
83	            return [obj, ]
84	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\network_state.py:214:30
213	    def _is_default_route(self, route):
214	        default_nets = ('::', '0.0.0.0')
215	        return (

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\openbsd.py:38:22
37	    def set_route(self, network, netmask, gateway):
38	        if network == '0.0.0.0':
39	            if_file = 'etc/mygate'

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\net\sysconfig.py:39:26
38	def _is_default_route(route):
39	    default_nets = ('::', '0.0.0.0')
40	    return route['prefix'] == 0 and route['network'] in default_nets

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\net\tests\test_dhcp.py:301:22
300	        self.assertEqual('eth9', call[0][1])
301	        self.assertIn('/var/tmp/cloud-init/cloud-init-dhcp-', call[0][2])
302	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1248:8
1247	        m_which.return_value = which_return
1248	        assert expected == net.openvswitch_is_installed()
1249	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1254:8
1253	        net.openvswitch_is_installed()
1254	        assert 1 == m_which.call_count
1255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1272:8
1271	
1272	        assert [
1273	            mock.call(net.OVS_INTERNAL_INTERFACE_LOOKUP_CMD)
1274	        ] == m_subp.call_args_list
1275	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1281:8
1280	
1281	        assert [
1282	            "iface1",
1283	            "iface2",
1284	            "iface3",
1285	        ] == net.get_ovs_internal_interfaces()
1286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1293:8
1292	
1293	        assert [] == net.get_ovs_internal_interfaces()
1294	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1307:8
1306	
1307	        assert 1 == m_subp.call_count
1308	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1319:8
1318	
1319	        assert not net.is_openvswitch_internal_interface("devname")
1320	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1341:8
1340	        m_get_ovs_internal_interfaces.return_value = detected_interfaces
1341	        assert expected_return == net.is_openvswitch_internal_interface(
1342	            devname
1343	        )
1344	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1363:8
1362	            ret = net.is_ip_address(mock.sentinel.ip_address_in)
1363	        assert expected_return == ret
1364	        expected_call = mock.call(mock.sentinel.ip_address_in)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1365:8
1364	        expected_call = mock.call(mock.sentinel.ip_address_in)
1365	        assert [expected_call] == m_ip_address.call_args_list
1366	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1384:8
1383	            ret = net.is_ipv4_address(mock.sentinel.ip_address_in)
1384	        assert expected_return == ret
1385	        expected_call = mock.call(mock.sentinel.ip_address_in)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\tests\test_init.py:1386:8
1385	        expected_call = mock.call(mock.sentinel.ip_address_in)
1386	        assert [expected_call] == m_ipv4address.call_args_list
1387	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\udev.py:10:4
9	    """Return a udev comparison clause, like `ACTION=="add"`."""
10	    assert key == key.upper()
11	    return '%s=="%s"' % (key, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\udev.py:16:4
15	    """Return a udev attribute comparison clause, like `ATTR{type}=="1"`."""
16	    assert attribute == attribute.lower()
17	    return 'ATTR{%s}=="%s"' % (attribute, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\net\udev.py:22:4
21	    """Return a udev assignment clause, like `NAME="eth0"`."""
22	    assert key == key.upper()
23	    return '%s="%s"' % (key, value)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\netinfo.py:265:35
264	        if toks[0] == "default":
265	            entry['destination'] = "0.0.0.0"
266	            entry['genmask'] = "0.0.0.0"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\netinfo.py:266:31
265	            entry['destination'] = "0.0.0.0"
266	            entry['genmask'] = "0.0.0.0"
267	        else:

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\netinfo.py:277:31
276	            entry['genmask'] = net_prefix_to_ipv4_mask(cidr)
277	            entry['gateway'] = "0.0.0.0"
278	        for i in range(len(toks)):

--------------------------------------------------
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\cloudinit\safeyaml.py:30:11
29	def load(blob):
30	    return(yaml.load(blob, Loader=_CustomSafeLoader))
31	

--------------------------------------------------
>> Issue: [B408:blacklist] Using minidom to parse untrusted XML data is known to be vulnerable to XML attacks. Replace minidom with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b408-import-xml-minidom
   Location: .\cloudinit\sources\DataSourceAzure.py:16:0
15	from time import sleep
16	from xml.dom import minidom
17	import xml.etree.ElementTree as ET

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\cloudinit\sources\DataSourceAzure.py:17:0
16	from xml.dom import minidom
17	import xml.etree.ElementTree as ET
18	from enum import Enum

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'REDACTED'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\DataSourceAzure.py:287:23
286	# so we can safely use this to mask/redact the password in the ovf-env.xml
287	DEF_PASSWD_REDACTION = 'REDACTED'
288	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\cloudinit\sources\DataSourceAzure.py:1653:19
1652	        try:
1653	            root = ET.fromstring(cnt)
1654	            for elem in root.iter():

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\sources\DataSourceAzure.py:1680:8
1679	        LOG.debug("invoking agent: %s", cmd)
1680	        subp.subp(cmd, shell=(not isinstance(cmd, list)))
1681	    else:

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\cloudinit\sources\DataSourceAzure.py:1751:14
1750	    try:
1751	        dom = minidom.parseString(contents)
1752	    except Exception as e:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'bad_request'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\DataSourceCloudStack.py:62:23
61	            return None
62	        if password == 'bad_request':
63	            raise RuntimeError('Error when attempting to fetch root password.')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'latest/api/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\DataSourceEc2.py:32:18
31	
32	API_TOKEN_ROUTE = 'latest/api/token'
33	AWS_TOKEN_TTL_SECONDS = '21600'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '21600'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\DataSourceEc2.py:33:24
32	API_TOKEN_ROUTE = 'latest/api/token'
33	AWS_TOKEN_TTL_SECONDS = '21600'
34	AWS_TOKEN_PUT_HEADER = 'X-aws-ec2-metadata-token'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'X-aws-ec2-metadata-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\DataSourceEc2.py:34:23
33	AWS_TOKEN_TTL_SECONDS = '21600'
34	AWS_TOKEN_PUT_HEADER = 'X-aws-ec2-metadata-token'
35	AWS_TOKEN_REQ_HEADER = AWS_TOKEN_PUT_HEADER + '-ttl-seconds'

--------------------------------------------------
>> Issue: [B408:blacklist] Using minidom to parse untrusted XML data is known to be vulnerable to XML attacks. Replace minidom with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b408-import-xml-minidom
   Location: .\cloudinit\sources\DataSourceOVF.py:15:0
14	import time
15	from xml.dom import minidom
16	

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\cloudinit\sources\DataSourceOVF.py:640:10
639	
640	    dom = minidom.parseString(contents)
641	    if dom.documentElement.localName != "Environment":

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\sources\DataSourceScaleway.py:152:53
151	                'http://',
152	                SourceAddressAdapter(source_address=('0.0.0.0', port))
153	            )

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\cloudinit\sources\DataSourceSmartOS.py:437:38
436	    def request(self, rtype, param=None):
437	        request_id = '{0:08x}'.format(random.randint(0, 0xffffffff))
438	        message_body = ' '.join((request_id, rtype,))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\__init__.py:32:14
31	DSMODE_NETWORK = "net"
32	DSMODE_PASS = "pass"
33	

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\cloudinit\sources\helpers\azure.py:19:0
18	from contextlib import contextmanager
19	from xml.etree import ElementTree
20	from xml.sax.saxutils import escape

--------------------------------------------------
>> Issue: [B406:blacklist] Using escape to parse untrusted XML data is known to be vulnerable to XML attacks. Replace escape with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\cloudinit\sources\helpers\azure.py:20:0
19	from xml.etree import ElementTree
20	from xml.sax.saxutils import escape
21	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\cloudinit\sources\helpers\azure.py:395:24
394	        try:
395	            self.root = ElementTree.fromstring(unparsed_xml)
396	        except ElementTree.ParseError as e:

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\cloudinit\sources\helpers\azure.py:512:14
511	        """
512	        tag = ElementTree.fromstring(certificates_xml).find('.//Data')
513	        certificates_content = tag.text

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\sources\helpers\azure.py:527:21
526	                ' -password pass:'.format(**self.certificate_names),
527	                shell=True, data=b'\n'.join(lines))
528	        return out
529	
530	    @azure_ds_telemetry_reporter
531	    def parse_certificates(self, certificates_xml):
532	        """Given the Certificates XML document, return a dictionary of

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\cloudinit\sources\helpers\digitalocean.py:35:39
34	
35	    addr = "169.254.{0}.{1}/16".format(random.randint(1, 168),
36	                                       random.randint(0, 255))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\cloudinit\sources\helpers\digitalocean.py:36:39
35	    addr = "169.254.{0}.{1}/16".format(random.randint(1, 168),
36	                                       random.randint(0, 255))
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:96:4
95	    '''
96	    assert (data is not None), ("data is none")
97	    assert (len(data) >= NLMSGHDR_SIZE), (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:97:4
96	    assert (data is not None), ("data is none")
97	    assert (len(data) >= NLMSGHDR_SIZE), (
98	        "data is smaller than netlink message header")
99	    msg_len, msg_type, flags, seq, pid = struct.unpack(NLMSGHDR_FMT,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:115:4
114	    '''
115	    assert (netlink_socket is not None), ("netlink socket is none")
116	    read_set, _, _ = select.select([netlink_socket], [], [], timeout)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:136:4
135	    '''
136	    assert (data is not None), ("data is none")
137	    assert (type(offset) == int), ("offset is not integer")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:137:4
136	    assert (data is not None), ("data is none")
137	    assert (type(offset) == int), ("offset is not integer")
138	    assert (offset >= RTATTR_START_OFFSET), (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:138:4
137	    assert (type(offset) == int), ("offset is not integer")
138	    assert (offset >= RTATTR_START_OFFSET), (
139	        "rta offset is less than expected length")
140	    length = rta_type = 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:163:4
162	    '''
163	    assert (data is not None), ("data is none")
164	    assert (len(data) > RTATTR_START_OFFSET), (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:164:4
163	    assert (data is not None), ("data is none")
164	    assert (len(data) > RTATTR_START_OFFSET), (
165	        "length of data is smaller than RTATTR_START_OFFSET")
166	    ifname = operstate = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:246:4
245	    '''
246	    assert (netlink_socket is not None), ("netlink socket is none")
247	    assert (ifname is not None), ("interface name is none")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:247:4
246	    assert (netlink_socket is not None), ("netlink socket is none")
247	    assert (ifname is not None), ("interface name is none")
248	    assert (len(ifname) > 0), ("interface name cannot be empty")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\helpers\netlink.py:248:4
247	    assert (ifname is not None), ("interface name is none")
248	    assert (len(ifname) > 0), ("interface name cannot be empty")
249	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'PASSWORD|-PASS'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cloudinit\sources\helpers\vmware\imc\config.py:23:11
22	    MARKERID = 'MISC|MARKER-ID'
23	    PASS = 'PASSWORD|-PASS'
24	    RESETPASS = 'PASSWORD|RESET'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:128:8
127	    def test_platform_info(self, oracle_ds):
128	        assert "oracle" == oracle_ds.cloud_name
129	        assert "oracle" == oracle_ds.platform_type

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:129:8
128	        assert "oracle" == oracle_ds.cloud_name
129	        assert "oracle" == oracle_ds.platform_type
130	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:132:8
131	    def test_subplatform_before_fetch(self, oracle_ds):
132	        assert 'unknown' == oracle_ds.subplatform
133	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:136:8
135	        oracle_ds._get_data()
136	        assert 'metadata (http://169.254.169.254/opc/v2/)' == \
137	            oracle_ds.subplatform
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:142:8
141	        oracle_ds._get_data()
142	        assert 'metadata (http://169.254.169.254/opc/v1/)' == \
143	            oracle_ds.subplatform
144	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:146:8
145	    def test_secondary_nics_disabled_by_default(self, oracle_ds):
146	        assert not oracle_ds.ds_cfg["configure_secondary_nics"]
147	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:152:8
151	    def test_sys_cfg_can_enable_configure_secondary_nics(self, oracle_ds):
152	        assert oracle_ds.ds_cfg["configure_secondary_nics"]
153	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:195:8
194	        oracle_ds._add_network_config_from_opc_imds()
195	        assert 'bare metal machine' in caplog.text
196	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:206:8
205	
206	        assert 1 == len(oracle_ds.network_config['config'])
207	        assert 'Interface with MAC 00:00:17:02:2b:b1 not found; skipping' in \

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:207:8
206	        assert 1 == len(oracle_ds.network_config['config'])
207	        assert 'Interface with MAC 00:00:17:02:2b:b1 not found; skipping' in \
208	            caplog.text
209	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:219:8
218	
219	        assert 1 == len(oracle_ds.network_config['ethernets'])
220	        assert 'Interface with MAC 00:00:17:02:2b:b1 not found; skipping' in \

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:220:8
219	        assert 1 == len(oracle_ds.network_config['ethernets'])
220	        assert 'Interface with MAC 00:00:17:02:2b:b1 not found; skipping' in \
221	            caplog.text
222	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:234:8
233	        # The input is mutated
234	        assert 2 == len(oracle_ds.network_config['config'])
235	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:237:8
236	        secondary_nic_cfg = oracle_ds.network_config['config'][1]
237	        assert nic_name == secondary_nic_cfg['name']
238	        assert 'physical' == secondary_nic_cfg['type']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:238:8
237	        assert nic_name == secondary_nic_cfg['name']
238	        assert 'physical' == secondary_nic_cfg['type']
239	        assert mac_addr == secondary_nic_cfg['mac_address']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:239:8
238	        assert 'physical' == secondary_nic_cfg['type']
239	        assert mac_addr == secondary_nic_cfg['mac_address']
240	        assert 9000 == secondary_nic_cfg['mtu']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:240:8
239	        assert mac_addr == secondary_nic_cfg['mac_address']
240	        assert 9000 == secondary_nic_cfg['mtu']
241	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:242:8
241	
242	        assert 1 == len(secondary_nic_cfg['subnets'])
243	        subnet_cfg = secondary_nic_cfg['subnets'][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:245:8
244	        # These values are hard-coded in OPC_VM_SECONDARY_VNIC_RESPONSE
245	        assert '10.0.0.231' == subnet_cfg['address']
246	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:258:8
257	        # The input is mutated
258	        assert 2 == len(oracle_ds.network_config['ethernets'])
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:261:8
260	        secondary_nic_cfg = oracle_ds.network_config['ethernets']['ens3']
261	        assert secondary_nic_cfg['dhcp4'] is False
262	        assert secondary_nic_cfg['dhcp6'] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:262:8
261	        assert secondary_nic_cfg['dhcp4'] is False
262	        assert secondary_nic_cfg['dhcp6'] is False
263	        assert mac_addr == secondary_nic_cfg['match']['macaddress']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:263:8
262	        assert secondary_nic_cfg['dhcp6'] is False
263	        assert mac_addr == secondary_nic_cfg['match']['macaddress']
264	        assert 9000 == secondary_nic_cfg['mtu']

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:264:8
263	        assert mac_addr == secondary_nic_cfg['match']['macaddress']
264	        assert 9000 == secondary_nic_cfg['mtu']
265	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:266:8
265	
266	        assert 1 == len(secondary_nic_cfg['addresses'])
267	        # These values are hard-coded in OPC_VM_SECONDARY_VNIC_RESPONSE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:268:8
267	        # These values are hard-coded in OPC_VM_SECONDARY_VNIC_RESPONSE
268	        assert '10.0.0.231' == secondary_nic_cfg['addresses'][0]
269	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:418:8
417	        print(response_headers)
418	        assert request.headers.get("Authorization") == "Bearer Oracle"
419	        return [200, response_headers, OPC_V2_METADATA]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:422:8
421	    def vnics_callback(request, uri, response_headers):
422	        assert request.headers.get("Authorization") == "Bearer Oracle"
423	        return [200, response_headers, OPC_BM_SECONDARY_VNIC_RESPONSE]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:478:8
477	
478	        assert version == metadata.version
479	        assert instance_data == metadata.instance_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:479:8
478	        assert version == metadata.version
479	        assert instance_data == metadata.instance_data
480	        assert vnics_data == metadata.vnics_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:480:8
479	        assert instance_data == metadata.instance_data
480	        assert vnics_data == metadata.vnics_data
481	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:513:12
512	        with expectation:
513	            assert expected_body == oracle.read_opc_metadata().instance_data
514	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:553:8
552	    ):
553	        assert not parameterized_oracle_ds._get_data()
554	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:576:8
575	    ):
576	        assert parameterized_oracle_ds._get_data()
577	        assert expected_value == parameterized_oracle_ds.metadata[keyname]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:577:8
576	        assert parameterized_oracle_ds._get_data()
577	        assert expected_value == parameterized_oracle_ds.metadata[keyname]
578	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:596:8
595	    ):
596	        assert parameterized_oracle_ds._get_data()
597	        assert expected_value == getattr(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:597:8
596	        assert parameterized_oracle_ds._get_data()
597	        assert expected_value == getattr(
598	            parameterized_oracle_ds, attribute_name
599	        )
600	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:629:12
628	        ):
629	            assert parameterized_oracle_ds._get_data()
630	            assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:630:12
629	            assert parameterized_oracle_ds._get_data()
630	            assert (
631	                expected_value == parameterized_oracle_ds.get_public_ssh_keys()
632	            )
633	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:643:12
642	        ):
643	            assert parameterized_oracle_ds._get_data()
644	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:645:8
644	
645	        assert parameterized_oracle_ds.userdata_raw is None
646	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:656:12
655	        ):
656	            assert parameterized_oracle_ds._get_data()
657	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:658:8
657	
658	        assert parameterized_oracle_ds.userdata_raw is None
659	        assert [] == parameterized_oracle_ds.get_public_ssh_keys()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:659:8
658	        assert parameterized_oracle_ds.userdata_raw is None
659	        assert [] == parameterized_oracle_ds.get_public_ssh_keys()
660	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:687:12
686	        def assert_in_context_manager(**kwargs):
687	            assert in_context_manager
688	            return mock.MagicMock()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:694:12
693	        ):
694	            assert oracle_ds._get_data()
695	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:696:8
695	
696	        assert [
697	            mock.call(m_find_fallback_nic.return_value)
698	        ] == m_EphemeralDHCPv4.call_args_list
699	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:706:8
705	        """.network_config should be cached"""
706	        assert 0 == m_read_initramfs_config.call_count
707	        oracle_ds.network_config  # pylint: disable=pointless-statement

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:708:8
707	        oracle_ds.network_config  # pylint: disable=pointless-statement
708	        assert 1 == m_read_initramfs_config.call_count
709	        oracle_ds.network_config  # pylint: disable=pointless-statement

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:710:8
709	        oracle_ds.network_config  # pylint: disable=pointless-statement
710	        assert 1 == m_read_initramfs_config.call_count
711	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:717:8
716	
717	        assert ncfg == oracle_ds.network_config
718	        assert 0 == oracle_ds.distro.generate_fallback_config.call_count

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:718:8
717	        assert ncfg == oracle_ds.network_config
718	        assert 0 == oracle_ds.distro.generate_fallback_config.call_count
719	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:729:8
728	
729	        assert ncfg == oracle_ds.network_config
730	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:762:8
761	            was_secondary_added = "secondary_added" in oracle_ds.network_config
762	        assert expect_secondary_nics == was_secondary_added
763	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:778:8
777	            network_config = oracle_ds.network_config
778	        assert network_config == m_read_initramfs_config.return_value
779	        assert "Failed to parse secondary network configuration" in caplog.text

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:779:8
778	        assert network_config == m_read_initramfs_config.return_value
779	        assert "Failed to parse secondary network configuration" in caplog.text
780	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\sources\tests\test_oracle.py:786:8
785	        initramfs_idx = config_sources.index(NetworkConfigSource.initramfs)
786	        assert ds_idx < initramfs_idx
787	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\cloudinit\stages.py:9:0
8	import os
9	import pickle
10	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\stages.py:304:8
303	            previous_ds = util.load_file(ds_fn).strip()
304	        except Exception:
305	            pass
306	        if not previous_ds:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\cloudinit\stages.py:991:15
990	    try:
991	        return pickle.loads(pickle_contents)
992	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\cloudinit\subp.py:6:0
5	import os
6	import subprocess
7	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\cloudinit\subp.py:259:13
258	                              stderr=stderr, stdin=stdin,
259	                              env=env, shell=shell, cwd=cwd)
260	        (out, err) = sp.communicate(data)
261	    except OSError as e:
262	        if status_cb:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\temp_utils.py:11:19
10	_ROOT_TMPDIR = "/run/cloud-init/tmp"
11	_EXE_ROOT_TMPDIR = "/var/tmp/cloud-init"
12	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o1777 on file (tdir).
   Severity: High   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\cloudinit\temp_utils.py:35:12
34	            os.makedirs(tdir)
35	            os.chmod(tdir, 0o1777)
36	        return tdir

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\temp_utils.py:45:40
44	    else:
45	        tdir = os.environ.get('TMPDIR', '/tmp')
46	    if not os.path.isdir(tdir):

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o1777 on file (tdir).
   Severity: High   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\cloudinit\temp_utils.py:48:8
47	        os.makedirs(tdir)
48	        os.chmod(tdir, 0o1777)
49	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\cloudinit\tests\helpers.py:224:12
223	        return ''.join(
224	            random.choice(string.ascii_lowercase) for _ in range(length))
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\helpers.py:475:4
474	    import jsonschema
475	    assert jsonschema  # avoid pyflakes error F401: import unused
476	    _missing_jsonschema_dep = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_conftest.py:30:8
29	            subp.subp(["some", "args"])
30	        assert "allowed: whoami" in str(excinfo.value)
31	        subp.subp(['whoami'])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_conftest.py:37:8
36	            subp.subp(["some", "args"])
37	        assert "allowed: whoami,bash" in str(excinfo.value)
38	        subp.subp(['bash', '-c', 'true'])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_features.py:46:8
45	        from cloudinit.features import ERROR_ON_USER_DATA_FAILURE
46	        assert ERROR_ON_USER_DATA_FAILURE is True
47	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_features.py:53:8
52	        from cloudinit.features import ERROR_ON_USER_DATA_FAILURE
53	        assert ERROR_ON_USER_DATA_FAILURE is False
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_features.py:60:8
59	        from cloudinit.features import SPAM
60	        assert SPAM is True

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\cloudinit\tests\test_persistence.py:27:0
26	
27	import pickle
28	from unittest import mock

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:55:8
54	    def _unpickle(self, ci_pkl_version: int) -> None:
55	        assert 1 == ci_pkl_version
56	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:69:8
68	    def _unpickle(self, ci_pkl_version: int) -> None:
69	        assert 0 == ci_pkl_version
70	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:78:8
77	    def _unpickle(self, ci_pkl_version: int) -> None:
78	        assert 1 == ci_pkl_version
79	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:88:8
87	    def _unpickle(self, ci_pkl_version: int) -> None:
88	        assert "some state" == self.some_state
89	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:99:8
98	    def _unpickle(self, ci_pkl_version: int) -> None:
99	        assert 0 == ci_pkl_version
100	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:108:8
107	        # in instance state, so we need to explicitly check self.__dict__.
108	        assert "_ci_pkl_version" not in self.__dict__
109	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\cloudinit\tests\test_persistence.py:117:12
116	        ) as m_unpickle:
117	            pickle.loads(pickle.dumps(CloudInitPickleMixin()))
118	        assert 1 == m_unpickle.call_count

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_persistence.py:118:8
117	            pickle.loads(pickle.dumps(CloudInitPickleMixin()))
118	        assert 1 == m_unpickle.call_count
119	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\cloudinit\tests\test_persistence.py:127:8
126	        """
127	        pickle.loads(pickle.dumps(cls()))

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\tests\test_simpletable.py:37:10
36	ROUTE_IPV4_ROWS = (
37	    ('0', '0.0.0.0', '172.31.0.1', '0.0.0.0', 'ens3', 'UG'),
38	    ('1', '169.254.0.0', '0.0.0.0', '255.255.0.0', 'ens3', 'U'),

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\tests\test_simpletable.py:37:35
36	ROUTE_IPV4_ROWS = (
37	    ('0', '0.0.0.0', '172.31.0.1', '0.0.0.0', 'ens3', 'UG'),
38	    ('1', '169.254.0.0', '0.0.0.0', '255.255.0.0', 'ens3', 'U'),

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\tests\test_simpletable.py:38:25
37	    ('0', '0.0.0.0', '172.31.0.1', '0.0.0.0', 'ens3', 'UG'),
38	    ('1', '169.254.0.0', '0.0.0.0', '255.255.0.0', 'ens3', 'U'),
39	    ('2', '172.31.0.0', '0.0.0.0', '255.255.240.0', 'ens3', 'U'),

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cloudinit\tests\test_simpletable.py:39:24
38	    ('1', '169.254.0.0', '0.0.0.0', '255.255.0.0', 'ens3', 'U'),
39	    ('2', '172.31.0.0', '0.0.0.0', '255.255.240.0', 'ens3', 'U'),
40	)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_stages.py:378:8
377	
378	        assert 0 == m_ensure_file.call_count
379	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_stages.py:387:8
386	
387	        assert log_file.exists
388	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_stages.py:404:8
403	
404	        assert mode == stat.S_IMODE(log_file.stat().mode)
405	

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\tests\test_subp.py:93:22
92	        cmd = 'echo HI MOM >> {tmp_file}'.format(tmp_file=tmp_file)
93	        (out, _err) = subp.subp(cmd.encode('utf-8'), shell=True)
94	        self.assertEqual(u'', out)

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\cloudinit\tests\test_subp.py:102:22
101	        cmd = 'echo HI MOM >> {tmp_file}'.format(tmp_file=tmp_file)
102	        (out, _err) = subp.subp(cmd, shell=True)
103	        self.assertEqual(u'', out)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\tests\test_temp_utils.py:28:34
27	        self.assertEqual('/fake/return/path', retval)
28	        self.assertEqual([{'dir': '/tmp'}], calls)
29	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\tests\test_temp_utils.py:46:34
45	        self.assertEqual('/fake/return/path', retval)
46	        self.assertEqual([{'dir': '/var/tmp/cloud-init'}], calls)
47	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\tests\test_temp_utils.py:82:34
81	        self.assertEqual('/fake/return/path', retval)
82	        self.assertEqual([{'dir': '/tmp'}], calls)
83	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_upgrade.py:41:8
40	        """We always expect to have ``.networking`` on ``Distro`` objects."""
41	        assert previous_obj_pkl.distro.networking is not None
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_upgrade.py:45:8
44	        """We always expect Networking.blacklist_drivers to be initialised."""
45	        assert previous_obj_pkl.distro.networking.blacklist_drivers is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_url_helper.py:16:4
15	    import oauthlib
16	    assert oauthlib  # avoid pyflakes error F401: import unused
17	    _missing_oauthlib_dep = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:704:8
703	    def test_read_conf_from_cmdline_config(self, expected_cfg, cmdline):
704	        assert expected_cfg == util.read_conf_from_cmdline(cmdline=cmdline)
705	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\tests\test_util.py:756:40
755	        m_tmpdir.return_value.__enter__ = mock.Mock(
756	            autospec=True, return_value="/tmp/fake"
757	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:764:8
763	        util.mount_cb('/dev/fake0', callback, mtype=mtype)
764	        assert mock.call(
765	            ["mount", "-o", "ro", "-t", expected, "/dev/fake0", "/tmp/fake"],
766	            update_env=None) in m_subp.call_args_list
767	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\cloudinit\tests\test_util.py:765:64
764	        assert mock.call(
765	            ["mount", "-o", "ro", "-t", expected, "/dev/fake0", "/tmp/fake"],
766	            update_env=None) in m_subp.call_args_list

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:779:8
778	
779	        assert 0 == m_subp.call_count
780	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:794:8
793	        # slash, regardless of the input
794	        assert [mock.call(mountpoint + "/")] == callback.call_args_list
795	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:804:8
803	
804	        assert [
805	            mock.call(mock.ANY, mock.sentinel.data)
806	        ] == callback.call_args_list
807	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:821:8
820	
821	        assert 1 == m_write_file.call_count
822	        args, kwargs = m_write_file.call_args

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:823:8
822	        args, kwargs = m_write_file.call_args
823	        assert (mock.sentinel.path,) == args
824	        assert mock.sentinel.mode == kwargs["mode"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:824:8
823	        assert (mock.sentinel.path,) == args
824	        assert mock.sentinel.mode == kwargs["mode"]
825	        assert mock.sentinel.preserve_mode == kwargs["preserve_mode"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:825:8
824	        assert mock.sentinel.mode == kwargs["mode"]
825	        assert mock.sentinel.preserve_mode == kwargs["preserve_mode"]
826	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:840:8
839	
840	        assert 1 == m_write_file.call_count
841	        _args, kwargs = m_write_file.call_args

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:842:8
841	        _args, kwargs = m_write_file.call_args
842	        assert expected == kwargs[kwarg]
843	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:848:8
847	
848	        assert 1 == m_write_file.call_count
849	        _args, kwargs = m_write_file.call_args

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:850:8
849	        _args, kwargs = m_write_file.call_args
850	        assert "" == kwargs["content"]
851	        assert "ab" == kwargs["omode"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cloudinit\tests\test_util.py:851:8
850	        assert "" == kwargs["content"]
851	        assert "ab" == kwargs["omode"]
852	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\user_data.py:183:12
182	                    payload_idx = payload.get('launch-index')
183	            except Exception:
184	                pass
185	        # Header overrides contents, for now (?) or the other way around?

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\cloudinit\util.py:31:0
30	import string
31	import subprocess
32	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\util.py:494:8
493	            dist = platform.dist()  # pylint: disable=W1505,E1101
494	        except Exception:
495	            pass
496	        finally:

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\cloudinit\util.py:635:19
634	        elif mode == "|":
635	            proc = subprocess.Popen(arg, shell=True, stdin=subprocess.PIPE)
636	            new_fp = proc.stdin

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\cloudinit\util.py:657:19
656	        elif mode == "|":
657	            proc = subprocess.Popen(arg, shell=True, stdin=subprocess.PIPE)
658	            new_fp = proc.stdin

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\util.py:1087:8
1086	                return cand
1087	        except Exception:
1088	            pass
1089	    return None

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\cloudinit\util.py:1598:12
1597	                    opts = m.group(4)
1598	            except Exception:
1599	                continue
1600	            # If the name of the mount point contains spaces these

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cloudinit\util.py:2336:8
2335	            logfunc(msg + tmsg)
2336	        except Exception:
2337	            pass
2338	    return ret

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup.py:26:0
25	
26	import subprocess
27	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:47:15
46	    try:
47	        path = subprocess.check_output(cmd).decode('utf-8')
48	        path = path.strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:69:10
68	    cmd = [sys.executable, 'tools/read-version']
69	    ver = subprocess.check_output(cmd)
70	    return ver.decode('utf-8').strip()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:75:11
74	    cmd = [sys.executable, 'tools/read-dependencies']
75	    deps = subprocess.check_output(cmd)
76	    return deps.decode('utf-8').splitlines()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:104:8
103	    if VARIANT:
104	        subprocess.run([sys.executable, './tools/render-cloudcfg', '--variant',
105	                        VARIANT, template, fpath])
106	    else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:107:8
106	    else:
107	        subprocess.run(
108	            [sys.executable, './tools/render-cloudcfg', template, fpath])
109	    if mode:

--------------------------------------------------
>> Issue: [B601:paramiko_calls] Possible shell injection via Paramiko call, check inputs are properly sanitized.
   Severity: Medium   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b601_paramiko_calls.html
   Location: .\tests\cloud_tests\platforms\instances.py:69:32
68	        cmd = util.shell_pack(command)
69	        fp_in, fp_out, fp_err = client.exec_command(cmd)
70	        channel = fp_in.channel

--------------------------------------------------
>> Issue: [B507:ssh_no_host_key_verification] Paramiko call with policy set to automatically trust the unknown host key.
   Severity: High   Confidence: Medium
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b507_ssh_no_host_key_verification.html
   Location: .\tests\cloud_tests\platforms\instances.py:104:8
103	        client = paramiko.SSHClient()
104	        client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
105	        private_key = paramiko.RSAKey.from_private_key_file(self.ssh_key_file)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\cloud_tests\platforms\lxd\instance.py:137:22
136	        elif method == "logfile-tmp":
137	            log_dir = "/tmp"
138	        else:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\cloud_tests\platforms\nocloudkvm\instance.py:8:0
7	import socket
8	import subprocess
9	import time

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\cloud_tests\platforms\nocloudkvm\instance.py:120:12
119	                os.remove(self.pid_file)
120	            except Exception:
121	                pass
122	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\cloud_tests\platforms\nocloudkvm\instance.py:176:8
175	               '-serial', 'file:' + self.console_file]
176	        subprocess.Popen(cmd,
177	                         close_fds=True,
178	                         stdin=subprocess.PIPE,
179	                         stdout=subprocess.PIPE,
180	                         stderr=subprocess.PIPE)
181	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\cloud_tests\setup_image.py:50:31
49	    LOG.debug(msg)
50	    remote_path = os.path.join('/tmp', os.path.basename(args.deb))
51	    image.push_file(args.deb, remote_path)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\cloud_tests\setup_image.py:83:31
82	    LOG.debug(msg)
83	    remote_path = os.path.join('/tmp', os.path.basename(args.rpm))
84	    image.push_file(args.rpm, remote_path)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\cloud_tests\util.py:14:0
13	import string
14	import subprocess
15	import tempfile

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\cloud_tests\util.py:83:34
82	        num = max_len - len(name) - len(delim)
83	        return join(name, ''.join(random.choice(valid) for _ in range(num)))
84	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\cloud_tests\util.py:296:10
295	    """
296	    out = subprocess.check_output(
297	        ["getopt", "--shell", "sh", "--options", "", "--", "--"] + list(cmd))
298	    # out contains ' -- <data>\n'. drop the ' -- ' and the '\n'

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\cloud_tests\util.py:464:15
463	        """
464	        path = "/tmp/%s-%04d" % (type(self).__name__, self._tmp_count)
465	        self._tmp_count += 1

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\integration_tests\__init__.py:10:40
9	    """
10	    return "02:00:00:%02x:%02x:%02x" % (random.randint(0, 255),
11	                                        random.randint(0, 255),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\integration_tests\__init__.py:11:40
10	    return "02:00:00:%02x:%02x:%02x" % (random.randint(0, 255),
11	                                        random.randint(0, 255),
12	                                        random.randint(0, 255))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\integration_tests\__init__.py:12:40
11	                                        random.randint(0, 255),
12	                                        random.randint(0, 255))

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\integration_tests\bugs\test_gh570.py:22:15
21	def test_nocloud_seedfrom_vendordata(client: IntegrationInstance):
22	    seed_dir = '/var/tmp/test_seed_dir'
23	    result = client.execute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh570.py:30:4
29	    )
30	    assert result.return_code == 0
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh570.py:38:4
37	    client.restart()
38	    assert client.execute('cloud-init status').ok
39	    assert 'seeded_vendordata_test_file' in client.execute('ls /var/tmp')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh570.py:39:4
38	    assert client.execute('cloud-init status').ok
39	    assert 'seeded_vendordata_test_file' in client.execute('ls /var/tmp')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh626.py:41:8
40	        eni = client.execute('cat /etc/network/interfaces.d/50-cloud-init.cfg')
41	        assert eni.endswith(EXPECTED_ENI_END)
42	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh626.py:46:4
45	    netplan_yaml = yaml.safe_load(netplan_cfg)
46	    assert 'wakeonlan' in netplan_yaml['network']['ethernets']['eth0']
47	    assert netplan_yaml['network']['ethernets']['eth0']['wakeonlan'] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh626.py:47:4
46	    assert 'wakeonlan' in netplan_yaml['network']['ethernets']['eth0']
47	    assert netplan_yaml['network']['ethernets']['eth0']['wakeonlan'] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh632.py:29:4
28	    log = client.read_from_file('/var/log/cloud-init.log')
29	    assert 'WARNING' not in log
30	    assert 'Traceback' not in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh632.py:30:4
29	    assert 'WARNING' not in log
30	    assert 'Traceback' not in log
31	    assert 'Failed to load metadata and userdata' not in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh632.py:31:4
30	    assert 'Traceback' not in log
31	    assert 'Failed to load metadata and userdata' not in log
32	    assert ("Getting data from <class 'cloudinit.sources.DataSourceRbxCloud."

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh632.py:32:4
31	    assert 'Failed to load metadata and userdata' not in log
32	    assert ("Getting data from <class 'cloudinit.sources.DataSourceRbxCloud."
33	            "DataSourceRbxCloud'> failed") not in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh668.py:43:4
42	    route = client.execute("ip route | grep {}".format(DESTINATION_IP))
43	    assert route.startswith(EXPECTED_ROUTE)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'DoIM33tTheComplexityRequirements!??'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\integration_tests\bugs\test_gh671.py:14:15
13	
14	OLD_PASSWORD = 'DoIM33tTheComplexityRequirements!??'
15	NEW_PASSWORD = 'DoIM33tTheComplexityRequirementsNow!??'

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'DoIM33tTheComplexityRequirementsNow!??'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\integration_tests\bugs\test_gh671.py:15:15
14	OLD_PASSWORD = 'DoIM33tTheComplexityRequirements!??'
15	NEW_PASSWORD = 'DoIM33tTheComplexityRequirementsNow!??'
16	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_gh671.py:22:4
21	    hashed_password = crypt.crypt(unhashed_password, salt)
22	    assert shadow_password == hashed_password
23	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:50:4
49	    uuid = instance.read_from_file("/sys/class/dmi/id/product_uuid")
50	    assert uuid.isupper(), (
51	        "Expected uppercase UUID on Ubuntu FIPS image {}".format(
52	            uuid
53	        )
54	    )
55	    orig_kernel = instance.execute("uname -r").strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:56:4
55	    orig_kernel = instance.execute("uname -r").strip()
56	    assert "azure-fips" in orig_kernel
57	    result = instance.execute("apt-get update")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:64:4
63	    new_kernel = instance.execute("uname -r").strip()
64	    assert orig_kernel != new_kernel
65	    assert "azure-fips" not in new_kernel

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:65:4
64	    assert orig_kernel != new_kernel
65	    assert "azure-fips" not in new_kernel
66	    assert "azure" in new_kernel

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:66:4
65	    assert "azure-fips" not in new_kernel
66	    assert "azure" in new_kernel
67	    new_uuid = instance.read_from_file("/sys/class/dmi/id/product_uuid")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:68:4
67	    new_uuid = instance.read_from_file("/sys/class/dmi/id/product_uuid")
68	    assert (
69	        uuid.lower() == new_uuid
70	    ), "Expected UUID on linux-azure to be lowercase of FIPS: {}".format(uuid)
71	    log = instance.read_from_file("/var/log/cloud-init.log")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1835584.py:74:4
73	    ssh_runs = len(re.findall(RE_CONFIG_SSH_SEMAPHORE, log))
74	    assert 1 == ssh_runs, "config_ssh ran too many times {}".format(ssh_runs)
75	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1886531.py:27:8
26	        log_content = client.read_from_file("/var/log/cloud-init.log")
27	        assert "WARNING" not in log_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1897099.py:27:4
26	    log = client.read_from_file('/var/log/cloud-init.log')
27	    assert '/swap.img' in client.execute('cat /proc/swaps')
28	    assert '/swap.img' in client.execute('cat /etc/fstab')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1897099.py:28:4
27	    assert '/swap.img' in client.execute('cat /proc/swaps')
28	    assert '/swap.img' in client.execute('cat /etc/fstab')
29	    assert 'fallocate swap creation failed, will attempt with dd' in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1897099.py:29:4
28	    assert '/swap.img' in client.execute('cat /etc/fstab')
29	    assert 'fallocate swap creation failed, will attempt with dd' in log
30	    assert "Running command ['dd', 'if=/dev/zero', 'of=/swap.img'" in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1897099.py:30:4
29	    assert 'fallocate swap creation failed, will attempt with dd' in log
30	    assert "Running command ['dd', 'if=/dev/zero', 'of=/swap.img'" in log
31	    assert 'SUCCESS: config-mounts ran successfully' in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1897099.py:31:4
30	    assert "Running command ['dd', 'if=/dev/zero', 'of=/swap.img'" in log
31	    assert 'SUCCESS: config-mounts ran successfully' in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1898997.py:62:8
61	        # Confirm that the network configuration was applied successfully
62	        assert "WARN" not in cloudinit_output
63	        # Confirm that the applied network config created the OVS bridge

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1898997.py:64:8
63	        # Confirm that the applied network config created the OVS bridge
64	        assert "ovs-br" in client.execute("ip addr")
65	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1898997.py:73:8
72	        )
73	        assert ping_result.ok

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1900837.py:18:8
17	        # Confirm that the current permissions aren't 600
18	        assert "644" == _get_log_perms(client)
19	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1900837.py:22:8
21	        client.execute("chmod 600 /var/log/cloud-init.log")
22	        assert "600" == _get_log_perms(client)
23	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1900837.py:26:8
25	        client.restart()
26	        assert client.execute('cloud-init status').ok
27	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1900837.py:29:8
28	        # Check that permissions are not reset on reboot
29	        assert "600" == _get_log_perms(client)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:36:8
35	        log = client.read_from_file('/var/log/cloud-init.log')
36	        assert expected_log in log
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:40:8
39	        dev_links = client.execute('ls /dev/disk/cloud')
40	        assert 'azure_root' in dev_links
41	        assert 'azure_root-part1' in dev_links

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:41:8
40	        assert 'azure_root' in dev_links
41	        assert 'azure_root-part1' in dev_links
42	        if is_ephemeral:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:43:12
42	        if is_ephemeral:
43	            assert 'azure_resource' in dev_links
44	            assert 'azure_resource-part1' in dev_links

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:44:12
43	            assert 'azure_resource' in dev_links
44	            assert 'azure_resource-part1' in dev_links
45	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:51:8
50	        )
51	        assert 'NAME="{}" TYPE="part" MOUNTPOINT="/"'.format(
52	            root_device) in blks
53	        if is_ephemeral:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1901011.py:57:12
56	            )
57	            assert 'NAME="{}" TYPE="part" MOUNTPOINT="/mnt"'.format(
58	                ephemeral_device) in blks

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1910835.py:60:8
59	        # We expect one key from the cloud, one from user-data
60	        assert 2 == len(authorized_keys)
61	        # And those two keys should be the same, except for a possible key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1910835.py:63:8
62	        # comment, which Azure strips out
63	        assert (
64	            authorized_keys[0].rsplit(" ")[:2]
65	            == authorized_keys[1].split(" ")[:2]
66	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\bugs\test_lp1912844.py:103:8
102	        )
103	        assert result.ok

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\integration_tests\conftest.py:196:23
195	    tarball_path = log_dir / 'cloud-init.tar.gz'
196	    instance.pull_file('/var/tmp/cloud-init.tar.gz', tarball_path)
197	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\integration_tests\instances.py:26:11
25	    tmp_filename = str(uuid.uuid4())
26	    return '/var/tmp/{}.tmp'.format(tmp_filename)
27	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\integration_tests\instances.py:167:22
166	        deb_name = os.path.basename(deb_path)
167	        remote_path = '/var/tmp/{}'.format(deb_name)
168	        self.push_file(

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\integration_tests\integration_settings.py:79:17
78	COLLECT_LOGS = 'ON_ERROR'
79	LOCAL_LOG_PATH = '/tmp/cloud_init_test_logs'
80	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\log_utils.py:11:8
10	        index = text[index:].find(item)
11	        assert index > -1, "Expected item not found: '{}'".format(item)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:111:8
110	        sources_list = class_client.read_from_file('/etc/apt/sources.list')
111	        assert 6 == len(sources_list.rstrip().split('\n'))
112	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:114:12
113	        for expected_re in EXPECTED_REGEXES:
114	            assert re.search(expected_re, sources_list) is not None
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:124:8
123	        )
124	        assert 'Assume-Yes "true";' in apt_config
125	        assert 'Fix-Broken "true";' in apt_config

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:125:8
124	        assert 'Assume-Yes "true";' in apt_config
125	        assert 'Fix-Broken "true";' in apt_config
126	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:134:8
133	            '/etc/apt/apt.conf.d/90cloud-init-aptproxy')
134	        assert 'Acquire::http::Proxy "http://proxy.internal:3128";' in out
135	        assert 'Acquire::http::Proxy "http://squid.internal:3128";' in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:135:8
134	        assert 'Acquire::http::Proxy "http://proxy.internal:3128";' in out
135	        assert 'Acquire::http::Proxy "http://squid.internal:3128";' in out
136	        assert 'Acquire::ftp::Proxy "ftp://squid.internal:3128";' in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:136:8
135	        assert 'Acquire::http::Proxy "http://squid.internal:3128";' in out
136	        assert 'Acquire::ftp::Proxy "ftp://squid.internal:3128";' in out
137	        assert 'Acquire::https::Proxy "https://squid.internal:3128";' in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:137:8
136	        assert 'Acquire::ftp::Proxy "ftp://squid.internal:3128";' in out
137	        assert 'Acquire::https::Proxy "https://squid.internal:3128";' in out
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:151:8
150	
151	        assert (
152	            'http://ppa.launchpad.net/simplestreams-dev/trunk/ubuntu'
153	        ) in ppa_path_contents
154	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:156:8
155	        keys = class_client.execute('apt-key finger')
156	        assert TEST_PPA_KEY in keys
157	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:168:8
167	
168	        assert (
169	            'http://ppa.launchpad.net/cloud-init-dev/test-archive/ubuntu'
170	        ) in test_archive_contents
171	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:173:8
172	        keys = class_client.execute('apt-key finger')
173	        assert TEST_KEY in keys
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:185:8
184	
185	        assert (
186	            'http://ppa.launchpad.net/cloud-init-raharper/curtin-dev/ubuntu'
187	        ) in test_keyserver_contents
188	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:190:8
189	        keys = class_client.execute('apt-key finger')
190	        assert TEST_KEYSERVER_KEY in keys
191	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:200:8
199	        ).ok
200	        assert conf_exists is False
201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:228:8
227	        sources_list = class_client.read_from_file('/etc/apt/sources.list')
228	        assert '{}.clouds.archive.ubuntu.com'.format(zone) in sources_list
229	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:239:8
238	        # 3 lines from main, universe, and multiverse
239	        assert 3 == sources_list.count('deb http://security.ubuntu.com/ubuntu')
240	        assert 3 == sources_list.count(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:240:8
239	        assert 3 == sources_list.count('deb http://security.ubuntu.com/ubuntu')
240	        assert 3 == sources_list.count(
241	            '# deb-src http://security.ubuntu.com/ubuntu'
242	        )
243	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:258:4
257	    sources_list = client.read_from_file('/etc/apt/sources.list')
258	    assert 'archive.ubuntu.com' not in sources_list
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:260:4
259	
260	    assert 'something.random.invalid' in sources_list
261	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:287:8
286	        ).strip()
287	        assert '' == sources_list
288	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_apt.py:298:8
297	        )
298	        assert 'Acquire::http::Pipeline-Depth "0";' in conf

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ca_certs.py:76:8
75	
76	        assert ["ca-certificates.crt"] == unlinked_files
77	        assert "cloud-init-ca-certs.pem" == links["a535c1f3.0"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ca_certs.py:77:8
76	        assert ["ca-certificates.crt"] == unlinked_files
77	        assert "cloud-init-ca-certs.pem" == links["a535c1f3.0"]
78	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ca_certs.py:78:8
77	        assert "cloud-init-ca-certs.pem" == links["a535c1f3.0"]
78	        assert (
79	            "/usr/share/ca-certificates/cloud-init-ca-certs.crt"
80	            == links["cloud-init-ca-certs.pem"]
81	        )
82	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ca_certs.py:88:8
87	        )
88	        assert (
89	            "78e875f18c73c1aab9167ae0bd323391e52222cc2dbcda42d129537219300062"
90	            in checksum
91	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_cli.py:31:4
30	    result = client.execute('cloud-init devel schema --system')
31	    assert result.ok
32	    assert 'Valid cloud-config: system userdata' == result.stdout.strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_cli.py:32:4
31	    assert result.ok
32	    assert 'Valid cloud-config: system userdata' == result.stdout.strip()
33	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_cli.py:43:4
42	    result = client.execute('cloud-init devel schema --system')
43	    assert not result.ok
44	    assert 'Cloud config schema errors' in result.stderr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_cli.py:44:4
43	    assert not result.ok
44	    assert 'Cloud config schema errors' in result.stderr
45	    assert 'needs to begin with "#cloud-config"' in result.stderr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_cli.py:45:4
44	    assert 'Cloud config schema errors' in result.stderr
45	    assert 'needs to begin with "#cloud-config"' in result.stderr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_keys_to_console.py:26:8
25	        syslog = class_client.read_from_file("/var/log/syslog")
26	        assert "({})".format(key_type) not in syslog
27	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_keys_to_console.py:31:8
30	        syslog = class_client.read_from_file("/var/log/syslog")
31	        assert "({})".format(key_type) in syslog
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_keys_to_console.py:40:8
39	        syslog = class_client.read_from_file("/var/log/syslog")
40	        assert "({})".format(key_type) not in syslog
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_keys_to_console.py:44:8
43	        syslog = class_client.read_from_file("/var/log/syslog")
44	        assert "BEGIN SSH HOST KEY FINGERPRINTS" not in syslog
45	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_keys_to_console.py:48:8
47	        syslog = class_client.read_from_file("/var/log/syslog")
48	        assert "END SSH HOST KEY FINGERPRINTS" not in syslog

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_lxd_bridge.py:34:8
33	        """Check that the expected LXD binaries are installed"""
34	        assert class_client.execute(["which", binary_name]).ok
35	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_lxd_bridge.py:41:8
40	        cloud_init_log = class_client.read_from_file("/var/log/cloud-init.log")
41	        assert "WARN" not in cloud_init_log
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_lxd_bridge.py:44:8
43	        # The bridge should exist
44	        assert class_client.execute("ip addr show lxdbr0")
45	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_lxd_bridge.py:48:8
47	        network_config = yaml.safe_load(raw_network_config)
48	        assert "10.100.100.1/24" == network_config["config"]["ipv4.address"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ntp_servers.py:32:8
31	        result = class_client.execute("ntpd --version")
32	        assert 0 == result.return_code
33	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ntp_servers.py:43:8
42	        dist_file = class_client.read_from_file("/etc/ntp.conf.dist")
43	        assert 0 == len(dist_file.strip().splitlines())
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ntp_servers.py:48:12
47	        for expected_server in EXPECTED_SERVERS:
48	            assert re.search(
49	                r"^server {} iburst".format(expected_server),
50	                ntp_conf,
51	                re.MULTILINE
52	            )
53	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ntp_servers.py:56:8
55	        result = class_client.execute("ntpq -p -w -n")
56	        assert result.ok
57	        for expected_server in EXPECTED_SERVERS:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ntp_servers.py:58:12
57	        for expected_server in EXPECTED_SERVERS:
58	            assert expected_server in result.stdout

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:62:8
61	            "grep ^Commandline: /var/log/apt/history.log")
62	        assert (
63	            "Commandline: /usr/bin/apt-get --option=Dpkg::Options"
64	            "::=--force-confold --option=Dpkg::options::=--force-unsafe-io "
65	            "--assume-yes --quiet install sl tree") in out
66	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:70:8
69	        out = class_client.read_from_file("/var/log/cloud-init-output.log")
70	        assert "Setting up tree (" in out
71	        assert "Setting up sl (" in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:71:8
70	        assert "Setting up tree (" in out
71	        assert "Setting up sl (" in out
72	        assert "Reading package lists..." in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:72:8
71	        assert "Setting up sl (" in out
72	        assert "Reading package lists..." in out
73	        assert "Building dependency tree..." in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:73:8
72	        assert "Reading package lists..." in out
73	        assert "Building dependency tree..." in out
74	        assert "Reading state information..." in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:74:8
73	        assert "Building dependency tree..." in out
74	        assert "Reading state information..." in out
75	        assert "Calculating upgrade..." in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_package_update_upgrade_install.py:75:8
74	        assert "Reading state information..." in out
75	        assert "Calculating upgrade..." in out

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\integration_tests\modules\test_power_state_change.py:39:8
38	                break
39	        except Exception:
40	            pass
41	        time.sleep(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_power_state_change.py:76:12
75	            log = instance.read_from_file('/var/log/cloud-init.log')
76	            assert _can_connect(instance)
77	        lines_to_check = [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_power_state_change.py:89:8
88	        log = client.read_from_file('/var/log/cloud-init.log')
89	        assert _can_connect(client)
90	        assert 'Condition was false. Will not perform state change' in log

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_power_state_change.py:90:8
89	        assert _can_connect(client)
90	        assert 'Condition was false. Will not perform state change' in log

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\integration_tests\modules\test_runcmd.py:24:46
23	    def test_runcmd(self, client):
24	        runcmd_output = client.read_from_file("/var/tmp/run_cmd")
25	        assert runcmd_output.strip() == "cloud-init run cmd test"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_runcmd.py:25:8
24	        runcmd_output = client.read_from_file("/var/tmp/run_cmd")
25	        assert runcmd_output.strip() == "cloud-init run cmd test"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_seed_random_data.py:30:8
29	        result = client.execute("head -c 31 < /root/seed")
30	        assert result.startswith("MYUb34023nD:LFDK10913jk;dfnk:Df")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_hostname.py:34:8
33	        hostname_output = client.execute("hostname")
34	        assert "cloudinit2" in hostname_output.strip()
35	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_hostname.py:39:8
38	        hostname_output = client.execute("hostname")
39	        assert "cloudinit1" in hostname_output.strip()
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_hostname.py:42:8
41	        fqdn_output = client.execute("hostname --fqdn")
42	        assert "cloudinit2.i9n.cloud-init.io" in fqdn_output.strip()
43	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_hostname.py:45:8
44	        host_output = client.execute("grep ^127 /etc/hosts")
45	        assert '127.0.1.1 {} {}'.format(
46	            fqdn_output, hostname_output) in host_output
47	        assert '127.0.0.1 localhost' in host_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_hostname.py:47:8
46	            fqdn_output, hostname_output) in host_output
47	        assert '127.0.0.1 localhost' in host_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:91:8
90	
91	        assert [] == dupes
92	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:96:8
95	        shadow_users, _ = self._fetch_and_parse_etc_shadow(class_client)
96	        assert USERS_PASSWD_VALUES["jane"] == shadow_users["jane"]
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:102:8
101	        mikey_hash = "$5$xZ$B2YGGEx2AOf4PeW48KC6.QyT1W2B4rZ9Qbltudtha89"
102	        assert mikey_hash == shadow_users["mikey"]
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:109:8
108	        # These should have been changed
109	        assert shadow_users["harry"] != USERS_PASSWD_VALUES["harry"]
110	        assert shadow_users["dick"] != USERS_PASSWD_VALUES["dick"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:110:8
109	        assert shadow_users["harry"] != USERS_PASSWD_VALUES["harry"]
110	        assert shadow_users["dick"] != USERS_PASSWD_VALUES["dick"]
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:113:8
112	        # To random passwords
113	        assert shadow_users["harry"].startswith("$")
114	        assert shadow_users["dick"].startswith("$")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:114:8
113	        assert shadow_users["harry"].startswith("$")
114	        assert shadow_users["dick"].startswith("$")
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:117:8
116	        # Which are not the same
117	        assert shadow_users["harry"] != shadow_users["dick"]
118	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:126:8
125	
126	        assert expected_value == shadow_users["tom"]
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:133:16
132	            if "name" in user_dict:
133	                assert "{}:".format(user_dict["name"]) in shadow
134	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_set_password.py:139:8
138	        # We look for the exact line match, to avoid a commented line matching
139	        assert "PasswordAuthentication yes" in sshd_config.splitlines()
140	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_snap.py:29:8
28	        snap_output = client.execute("snap list")
29	        assert "core " in snap_output
30	        assert "hello-world " in snap_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_snap.py:30:8
29	        assert "core " in snap_output
30	        assert "hello-world " in snap_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_auth_key_fingerprints.py:37:8
36	        cloudinit_output = client.read_from_file("/var/log/cloud-init.log")
37	        assert (
38	            "Skipping module named ssh-authkey-fingerprints, "
39	            "logging of SSH fingerprints disabled") in cloudinit_output
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_auth_key_fingerprints.py:45:8
44	
45	        assert re.search(r'256 SHA256:.*(ECDSA)', syslog_output) is not None
46	        assert re.search(r'256 SHA256:.*(ED25519)', syslog_output) is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_auth_key_fingerprints.py:46:8
45	        assert re.search(r'256 SHA256:.*(ECDSA)', syslog_output) is not None
46	        assert re.search(r'256 SHA256:.*(ED25519)', syslog_output) is not None
47	        assert re.search(r'1024 SHA256:.*(DSA)', syslog_output) is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_auth_key_fingerprints.py:47:8
46	        assert re.search(r'256 SHA256:.*(ED25519)', syslog_output) is not None
47	        assert re.search(r'1024 SHA256:.*(DSA)', syslog_output) is None
48	        assert re.search(r'2048 SHA256:.*(RSA)', syslog_output) is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_auth_key_fingerprints.py:48:8
47	        assert re.search(r'1024 SHA256:.*(DSA)', syslog_output) is None
48	        assert re.search(r'2048 SHA256:.*(RSA)', syslog_output) is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_generate.py:39:8
38	        )
39	        assert out.failed
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_generate.py:51:8
50	        out = class_client.read_from_file(ssh_key_path)
51	        assert "" != out.strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_import_id.py:33:8
32	
33	        assert '# ssh-import-id gh:powersj' in ssh_output
34	        assert '# ssh-import-id lp:smoser' in ssh_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_import_id.py:34:8
33	        assert '# ssh-import-id gh:powersj' in ssh_output
34	        assert '# ssh-import-id lp:smoser' in ssh_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_ssh_keys_provided.py:160:8
159	        out = class_client.read_from_file(config_path).strip()
160	        assert expected_out in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_timezone.py:25:8
24	            'date "+%Z" --date="Thu, 03 Nov 2016 00:47:00 -0400"')
25	        assert timezone_output.strip() == "HDT"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_users_groups.py:84:8
83	        result = class_client.execute(["getent"] + getent_args)
84	        assert re.search(regex, result.stdout) is not None, (
85	            "'getent {}' resulted in '{}', "
86	            "but expected to match regex {}".format(
87	                ' '.join(getent_args), result.stdout, regex))
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_users_groups.py:94:8
93	        groups = groups_str.split()
94	        assert "secret" in groups
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_users_groups.py:122:4
121	
122	    assert '#includedir' not in sudoers
123	    assert sudoers.count('includedir /etc/sudoers.d') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_users_groups.py:123:4
122	    assert '#includedir' not in sudoers
123	    assert sudoers.count('includedir /etc/sudoers.d') == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\integration_tests\modules\test_write_files.py:66:8
65	        out = class_client.execute(cmd)
66	        assert expected_out in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_aliyun.py:214:8
213	        # route-metric numbers should be 100 apart
214	        assert 100 == abs(met0 - met1)
215	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o664 on file (deltacloud_user_data_file).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\tests\unittests\test_datasource\test_altcloud.py:40:4
39	    udfile.close()
40	    os.chmod(deltacloud_user_data_file, 0o664)
41	

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o664 on file (user_data_file).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\tests\unittests\test_datasource\test_altcloud.py:45:4
44	    udfile.close()
45	    os.chmod(user_data_file, 0o664)
46	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\unittests\test_datasource\test_altcloud.py:268:49
267	        '''Set up.'''
268	        self.paths = helpers.Paths({'cloud_dir': '/tmp'})
269	        self.mount_dir = self.tmp_dir()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\unittests\test_datasource\test_altcloud.py:391:49
390	        '''Set up.'''
391	        self.paths = helpers.Paths({'cloud_dir': '/tmp'})
392	        self.mount_dir = tempfile.mkdtemp()

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\tests\unittests\test_datasource\test_azure.py:23:0
22	import stat
23	import xml.etree.ElementTree as ET
24	import yaml

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\tests\unittests\test_datasource\test_azure.py:723:17
722	        def create_tag_index(xml):
723	            et = ET.fromstring(xml)
724	            ret = {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:731:16
730	            for tag in x.keys():
731	                assert tag in y
732	            for tag in y.keys():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:733:16
732	            for tag in y.keys():
733	                assert tag in x
734	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:738:16
737	                y_val = y.get(x_val.tag)
738	                assert x_val.text == y_val.text
739	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:1379:12
1378	                             dsaz.RESOURCE_DISK_PATH)
1379	            assert 'disk_setup' in cfg
1380	            assert 'fs_setup' in cfg

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:1380:12
1379	            assert 'disk_setup' in cfg
1380	            assert 'fs_setup' in cfg
1381	            self.assertIsInstance(cfg['disk_setup'], dict)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:1402:12
1401	
1402	            assert 'disk_setup' not in cfg
1403	            assert 'fs_setup' not in cfg

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_azure.py:1403:12
1402	            assert 'disk_setup' not in cfg
1403	            assert 'fs_setup' not in cfg
1404	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\tests\unittests\test_datasource\test_azure.py:1452:13
1451	        # Make sure that the password was really encrypted
1452	        et = ET.fromstring(on_disk_ovf)
1453	        for elem in et.iter():

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\tests\unittests\test_datasource\test_azure_helper.py:8:0
7	from textwrap import dedent
8	from xml.etree import ElementTree
9	from xml.sax.saxutils import escape, unescape

--------------------------------------------------
>> Issue: [B406:blacklist] Using escape to parse untrusted XML data is known to be vulnerable to XML attacks. Replace escape with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b406-import-xml-sax
   Location: .\tests\unittests\test_datasource\test_azure_helper.py:9:0
8	from xml.etree import ElementTree
9	from xml.sax.saxutils import escape, unescape
10	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\tests\unittests\test_datasource\test_azure_helper.py:754:26
753	
754	        generated_xroot = ElementTree.fromstring(generated_health_document)
755	        self.assertEqual(

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\tests\unittests\test_datasource\test_azure_helper.py:803:26
802	
803	        generated_xroot = ElementTree.fromstring(generated_health_document)
804	        self.assertEqual(

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\tests\unittests\test_datasource\test_azure_helper.py:923:26
922	
923	        generated_xroot = ElementTree.fromstring(generated_health_document)
924	        generated_health_report_description = self._text_from_xpath_in_xroot(

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\tests\unittests\test_datasource\test_azure_helper.py:971:26
970	
971	        generated_xroot = ElementTree.fromstring(generated_health_document)
972	        generated_health_report_description = self._text_from_xpath_in_xroot(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SekritSquirrel'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_datasource\test_cloudstack.py:65:19
64	        m_wait.return_value = True
65	        password = 'SekritSquirrel'
66	        self._set_password_server_response(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SekritSquirrel'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_datasource\test_cloudstack.py:92:19
91	        m_wait.return_value = True
92	        password = 'SekritSquirrel'
93	        subp = self._set_password_server_response(password)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:90:32
89	         "netmask": "255.255.255.248", "link": "eth0",
90	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
91	                     "gateway": "2.2.2.9"}],
92	         "ip_address": "2.2.2.10", "id": "network0-ipv4"},

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:90:54
89	         "netmask": "255.255.255.248", "link": "eth0",
90	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
91	                     "gateway": "2.2.2.9"}],
92	         "ip_address": "2.2.2.10", "id": "network0-ipv4"},

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:112:32
111	         "id": "network0",
112	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
113	                     "gateway": "172.17.48.1"}]},
114	        {"network_id": "7c41450c-ba44-401a-9ab1-1604bb2da51e",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:112:54
111	         "id": "network0",
112	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
113	                     "gateway": "172.17.48.1"}]},
114	        {"network_id": "7c41450c-ba44-401a-9ab1-1604bb2da51e",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:125:32
124	         "id": "network2",
125	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
126	                    "gateway": "172.16.48.1"},
127	                    {"netmask": "255.255.0.0", "network": "172.16.0.0",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:125:54
124	         "id": "network2",
125	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
126	                    "gateway": "172.16.48.1"},
127	                    {"netmask": "255.255.0.0", "network": "172.16.0.0",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:150:32
149	         "type": "ipv4",
150	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
151	                    "gateway": "2.2.2.9"}]},
152	        {"id": "network3-ipv4", "ip_address": "10.0.1.5",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:150:54
149	         "type": "ipv4",
150	         "routes": [{"netmask": "0.0.0.0", "network": "0.0.0.0",
151	                    "gateway": "2.2.2.9"}]},
152	        {"id": "network3-ipv4", "ip_address": "10.0.1.5",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:574:35
573	                    'routes': [{
574	                        'netmask': '0.0.0.0',
575	                        'network': '0.0.0.0',
576	                        'gateway': '172.19.3.254',
577	                    }],
578	                    'ip_address': '172.19.1.34',
579	                    'id': 'network0',

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:575:35
574	                        'netmask': '0.0.0.0',
575	                        'network': '0.0.0.0',
576	                        'gateway': '172.19.3.254',
577	                    }],
578	                    'ip_address': '172.19.1.34',
579	                    'id': 'network0',
580	                }],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:642:47
641	                                    'gateway': '172.19.3.254',
642	                                    'netmask': '0.0.0.0',
643	                                    'network': '0.0.0.0',
644	                                }],
645	                            }
646	                        ]
647	                    },

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:643:47
642	                                    'netmask': '0.0.0.0',
643	                                    'network': '0.0.0.0',
644	                                }],
645	                            }
646	                        ]
647	                    },
648	                    {

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:710:24
709	        self.assertIn(
710	            {'network': '0.0.0.0', 'netmask': '0.0.0.0', 'gateway': '2.2.2.9'},
711	            routes)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_configdrive.py:710:46
709	        self.assertIn(
710	            {'network': '0.0.0.0', 'netmask': '0.0.0.0', 'gateway': '2.2.2.9'},
711	            routes)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'p@ssw0rd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_datasource\test_exoscale.py:61:28
60	        service."""
61	        expected_password = "p@ssw0rd"
62	        httpretty.register_uri(httpretty.GET,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'p@ssw0rd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_datasource\test_exoscale.py:86:28
85	        ds._is_platform_viable = lambda: True
86	        expected_password = "p@ssw0rd"
87	        expected_id = "12345"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_hetzner.py:142:8
141	    def test_happy_path(self, in_data, expected):
142	        assert expected == hc_helper.maybe_b64decode(in_data)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_ibmcloud.py:156:29
155	             "routes": [
156	                 {"network": "0.0.0.0", "netmask": "0.0.0.0",
157	                  "gateway": "108.168.194.249"}]}
158	        ],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_ibmcloud.py:156:51
155	             "routes": [
156	                 {"network": "0.0.0.0", "netmask": "0.0.0.0",
157	                  "gateway": "108.168.194.249"}]}
158	        ],

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'BOO'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_datasource\test_maas.py:194:12
193	        cfg = self.v1_cfg.copy()
194	        cfg['consumer_secret'] = "BOO"
195	        cfg['unrelated'] = "HI MOM"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_opennebula.py:936:8
935	        ret = ds.parse_shell_config(cfg)
936	        assert ret == {"foo": "bar", "xx": "foo"}
937	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_opennebula.py:966:12
965	        ):
966	            assert expected_return == ds.get_physical_nics_by_mac(distro)
967	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:34:18
33	    'local-hostname': 'sm-foo-test.novalocal',
34	    'local-ipv4': '0.0.0.0',
35	    'public-hostname': 'sm-foo-test.novalocal',
36	    'public-ipv4': '0.0.0.1',
37	    'reservation-id': 'r-iru5qm4m',
38	}
39	USER_DATA = b'#!/bin/sh\necho This is user data\n'
40	VENDOR_DATA = {
41	    'magic': '',
42	}
43	VENDOR_DATA2 = {
44	    'static': {}
45	}
46	OSTACK_META = {
47	    'availability_zone': 'nova',
48	    'files': [{'content_path': '/content/0000', 'path': '/etc/foo.cfg'},

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:504:12
503	                return ''  # Empty string on EC2
504	            assert False, 'Unexpected dmi read of %s' % dmi_key
505	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:534:12
533	                return 'OpenTelekomCloud'
534	            assert False, 'Unexpected dmi read of %s' % dmi_key
535	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:552:12
551	                return 'SAP CCloud VM'
552	            assert False, 'Unexpected dmi read of %s' % dmi_key
553	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:570:12
569	                return 'OracleCloud.com'
570	            assert False, 'Unexpected dmi read of %s' % dmi_key
571	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:591:12
590	                return chassis_tag
591	            assert False, 'Unexpected dmi read of %s' % dmi_key
592	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_openstack.py:625:12
624	                return ''  # Nothin 'openstackish'
625	            assert False, 'Unexpected dmi read of %s' % dmi_key
626	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '$6$uktth46t$FvpDzFD2iL9YNZIG1Epz7957hJqbH0fQKhnzcfBcUhEodGAWRqTy7tYG4nEW7SUOYBjxOSFIQW5tToyGP41.s1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_datasource\test_rbx.py:11:14
10	
11	CRYPTO_PASS = "$6$uktth46t$FvpDzFD2iL9YNZIG1Epz7957hJqbH0f" \
12	              "QKhnzcfBcUhEodGAWRqTy7tYG4nEW7SUOYBjxOSFIQW5" \
13	              "tToyGP41.s1"
14	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_smartos.py:44:4
43	    import serial as _pyserial
44	    assert _pyserial  # avoid pyflakes error F401: import unused
45	    HAS_PYSERIAL = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_smartos.py:367:8
366	    def open_transport(self):
367	        assert(not self._is_open)
368	        self._is_open = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_smartos.py:371:8
370	    def close_transport(self):
371	        assert(self._is_open)
372	        self._is_open = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_smartos.py:628:8
627	
628	        assert 'disk_setup' in cfg
629	        assert 'fs_setup' in cfg

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_datasource\test_smartos.py:629:8
628	        assert 'disk_setup' in cfg
629	        assert 'fs_setup' in cfg
630	        self.assertIsInstance(cfg['disk_setup'], dict)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'passfoo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittests\test_distros\test_create_users.py:110:19
109	        user = 'foouser'
110	        password = 'passfoo'
111	        self.dist.create_user(user, passwd=password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:266:12
265	                           mirror_filter=self.return_first)
266	            assert(results == mirrors[0])
267	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:270:12
269	                           mirror_filter=self.return_second)
270	            assert(results == mirrors[1])
271	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:274:12
273	                           mirror_filter=self.return_none)
274	            assert(results == package_mirrors[0]['failsafe'])
275	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:282:8
281	                       mirror_filter=self.return_first)
282	        assert(results == {
283	            'primary': 'http://nova.cloudvendor.clouds/',
284	            'security': 'http://security-mirror1-intel'}
285	        )
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:289:8
288	                       mirror_filter=self.return_last)
289	        assert(results == {
290	            'primary': 'http://nova.cloudvendor.clouds/',
291	            'security': 'http://security-mirror2-intel'}
292	        )
293	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:303:8
302	                       mirror_filter=self.return_first)
303	        assert(results == {
304	            'primary': 'http://fs-primary-intel',
305	            'security': 'http://security-mirror1-intel'}
306	        )
307	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_generic.py:310:8
309	                       mirror_filter=self.return_last)
310	        assert(results == {
311	            'primary': 'http://fs-primary-intel',
312	            'security': 'http://security-mirror2-intel'}
313	        )
314	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_netbsd.py:16:4
15	    expectation = ['pkgin', '-y', 'full-upgrade'] if with_pkgin else None
16	    assert distro.pkg_cmd_upgrade_prefix == expectation
17	    assert [mock.call('/usr/pkg/bin/pkgin')] == m_os.path.exists.call_args_list

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_distros\test_netbsd.py:17:4
16	    assert distro.pkg_cmd_upgrade_prefix == expectation
17	    assert [mock.call('/usr/pkg/bin/pkgin')] == m_os.path.exists.call_args_list

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\unittests\test_handler\test_handler_disk_setup.py:65:24
64	    def _test_for_sector_size(self, sector_size):
65	        size_in_bytes = random.randint(10000, 10000000) * 512
66	        size_in_sectors = size_in_bytes / sector_size

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\unittests\test_handler\test_handler_disk_setup.py:91:20
90	    def test_single_partition_using_list(self):
91	        disk_size = random.randint(1000000, 1000000000000)
92	        self.assertEqual(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\unittests\test_handler\test_handler_disk_setup.py:97:20
96	    def test_half_and_half(self):
97	        disk_size = random.randint(1000000, 1000000000000)
98	        expected_partition_size = int(float(disk_size) / 2)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\unittests\test_handler\test_handler_disk_setup.py:104:20
103	    def test_thirds_with_different_partition_type(self):
104	        disk_size = random.randint(1000000, 1000000000000)
105	        expected_partition_size = int(float(disk_size) * 0.33)

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\tests\unittests\test_handler\test_handler_disk_setup.py:205:8
204	        subp.assert_called_once_with(
205	            'mkfs -t ext4 -L with_cmd /dev/xdb1', shell=True)
206	
207	    @mock.patch('cloudinit.config.cc_disk_setup.subp.which')

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_handler\test_handler_lxd.py:18:35
17	            'init': {
18	                'network_address': '0.0.0.0',
19	                'storage_backend': 'zfs',
20	                'storage_pool': 'poolname',
21	            }
22	        }
23	    }

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\tests\unittests\test_handler\test_handler_seed_random.py:35:26
34	        super(TestRandomSeed, self).setUp()
35	        self._seed_file = tempfile.mktemp()
36	        self.unapply = []

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\unittests\test_handler\test_handler_write_files.py:40:4
39	    '/wark': "foobar\n",
40	    '/tmp/message': "hi mom line 1\nhi mom line 2\n",
41	}
42	
43	VALID_SCHEMA = {
44	    'write_files': [
45	        {'append': False, 'content': 'a', 'encoding': 'gzip', 'owner': 'jeff',

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\unittests\test_handler\test_handler_write_files.py:130:19
129	        expected = "hello world\n"
130	        filename = "/tmp/my.file"
131	        write_files(

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\unittests\test_handler\test_handler_write_files.py:140:19
139	        expected = existing + added
140	        filename = "/tmp/append.file"
141	        util.write_file(filename, existing)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\tests\unittests\test_handler\test_handler_write_files.py:177:35
176	                    cur = {'content': content,
177	                           'path': '/tmp/file-%s-%s' % (name, enc),
178	                           'encoding': enc}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_handler_zypper_add_repo.py:46:12
45	        if len(repos) != 2:
46	            assert 'Number of repos written is "%d" expected 2' % len(repos)
47	        for repo in repos:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_handler_zypper_add_repo.py:50:16
49	            if repo_name not in expected_repos:
50	                assert 'Found repo with name "%s"; unexpected' % repo_name
51	        # Validation that the content gets properly written is in another test

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_handler_zypper_add_repo.py:187:12
186	        if len(repos) != 2:
187	            assert 'Number of repos written is "%d" expected 2' % len(repos)
188	        for repo in repos:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_handler_zypper_add_repo.py:191:16
190	            if repo_name not in expected_repos:
191	                assert 'Found repo with name "%s"; unexpected' % repo_name
192	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:416:8
415	                main()
416	        assert 1 == context_manager.value.code
417	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:422:8
421	        )
422	        assert expected == err
423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:429:8
428	                main()
429	        assert 1 == context_manager.value.code
430	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:435:8
434	        )
435	        assert expected == err
436	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:443:8
442	                main()
443	        assert 1 == context_manager.value.code
444	        _out, err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:445:8
444	        _out, err = capsys.readouterr()
445	        assert 'Configfile NOT_A_FILE does not exist\n' == err
446	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:451:12
450	        with mock.patch('sys.argv', myargs):
451	            assert 0 == main(), 'Expected 0 exit code'
452	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:453:8
452	        out, _err = capsys.readouterr()
453	        assert '\nNTP\n---\n' in out
454	        assert '\nRuncmd\n------\n' in out

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:454:8
453	        assert '\nNTP\n---\n' in out
454	        assert '\nRuncmd\n------\n' in out
455	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:462:12
461	        with mock.patch('sys.argv', myargs):
462	            assert 0 == main(), 'Expected 0 exit code'
463	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:464:8
463	        out, _err = capsys.readouterr()
464	        assert 'Valid cloud-config: {0}\n'.format(myyaml) == out
465	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:477:12
476	        with mock.patch('sys.argv', myargs):
477	            assert 0 == main(), 'Expected 0 exit code'
478	        out, _err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:479:8
478	        out, _err = capsys.readouterr()
479	        assert 'Valid cloud-config: system userdata\n' == out
480	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:488:8
487	                main()
488	        assert 1 == context_manager.value.code
489	        _out, err = capsys.readouterr()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:493:8
492	        )
493	        assert expected == err
494	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_handler\test_schema.py:539:4
538	        cloudinit.__file__).parent.parent / 'doc' / 'examples'
539	    assert examples_dir.is_dir()
540	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\unittests\test_merging.py:95:11
94	    max_depth = max(1, max_depth)
95	    rand = random.Random(seed)
96	    return _make_dict(0, max_depth, rand)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:481:31
480	                "routes": [{
481	                    "netmask": "0.0.0.0",
482	                    "network": "0.0.0.0",
483	                    "gateway": "172.19.3.254",
484	                }],
485	                "ip_address": "172.19.1.34", "id": "network0"
486	            }],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:482:31
481	                    "netmask": "0.0.0.0",
482	                    "network": "0.0.0.0",
483	                    "gateway": "172.19.3.254",
484	                }],
485	                "ip_address": "172.19.1.34", "id": "network0"
486	            }],
487	            "links": [

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:569:31
568	                "routes": [{
569	                    "netmask": "0.0.0.0",
570	                    "network": "0.0.0.0",
571	                    "gateway": "172.19.3.254",
572	                }],
573	                "ip_address": "172.19.1.34", "id": "network0"
574	            }, {

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:570:31
569	                    "netmask": "0.0.0.0",
570	                    "network": "0.0.0.0",
571	                    "gateway": "172.19.3.254",
572	                }],
573	                "ip_address": "172.19.1.34", "id": "network0"
574	            }, {
575	                "network_id": "private-ipv4",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:667:31
666	                "routes": [{
667	                    "netmask": "0.0.0.0",
668	                    "network": "0.0.0.0",
669	                    "gateway": "172.19.3.254",
670	                }],
671	                "ip_address": "172.19.1.34", "id": "network0"
672	            }, {

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:668:31
667	                    "netmask": "0.0.0.0",
668	                    "network": "0.0.0.0",
669	                    "gateway": "172.19.3.254",
670	                }],
671	                "ip_address": "172.19.1.34", "id": "network0"
672	            }, {
673	                "network_id": "public-ipv6-a",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:2648:52
2647	                             'netmask': '255.255.240.0',
2648	                             'routes': [{'netmask': '0.0.0.0',
2649	                                         'network': '0.0.0.0',
2650	                                         'gateway': '51.68.80.1'}],
2651	                             'address': '51.68.89.122',

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:2649:52
2648	                             'routes': [{'netmask': '0.0.0.0',
2649	                                         'network': '0.0.0.0',
2650	                                         'gateway': '51.68.80.1'}],
2651	                             'address': '51.68.89.122',
2652	                             'ipv4': True}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3050:31
3049	                "routes": [{
3050	                    "netmask": "0.0.0.0",
3051	                    "network": "0.0.0.0",
3052	                    "gateway": "172.19.3.254",
3053	                }, {
3054	                    "netmask": "0.0.0.0",  # A second default gateway
3055	                    "network": "0.0.0.0",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3051:31
3050	                    "netmask": "0.0.0.0",
3051	                    "network": "0.0.0.0",
3052	                    "gateway": "172.19.3.254",
3053	                }, {
3054	                    "netmask": "0.0.0.0",  # A second default gateway
3055	                    "network": "0.0.0.0",
3056	                    "gateway": "172.20.3.254",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3054:31
3053	                }, {
3054	                    "netmask": "0.0.0.0",  # A second default gateway
3055	                    "network": "0.0.0.0",
3056	                    "gateway": "172.20.3.254",
3057	                }],
3058	                "ip_address": "172.19.1.34", "id": "network0"
3059	            }],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3055:31
3054	                    "netmask": "0.0.0.0",  # A second default gateway
3055	                    "network": "0.0.0.0",
3056	                    "gateway": "172.20.3.254",
3057	                }],
3058	                "ip_address": "172.19.1.34", "id": "network0"
3059	            }],
3060	            "links": [

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3318:31
3317	                "routes": [{
3318	                    "netmask": "0.0.0.0",
3319	                    "network": "0.0.0.0",
3320	                    "gateway": "172.19.3.254",
3321	                }, {
3322	                    "netmask": "0.0.0.0",  # A second default gateway
3323	                    "network": "0.0.0.0",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3319:31
3318	                    "netmask": "0.0.0.0",
3319	                    "network": "0.0.0.0",
3320	                    "gateway": "172.19.3.254",
3321	                }, {
3322	                    "netmask": "0.0.0.0",  # A second default gateway
3323	                    "network": "0.0.0.0",
3324	                    "gateway": "172.20.3.254",

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3322:31
3321	                }, {
3322	                    "netmask": "0.0.0.0",  # A second default gateway
3323	                    "network": "0.0.0.0",
3324	                    "gateway": "172.20.3.254",
3325	                }],
3326	                "ip_address": "172.19.1.34", "id": "network0"
3327	            }, {

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\unittests\test_net.py:3323:31
3322	                    "netmask": "0.0.0.0",  # A second default gateway
3323	                    "network": "0.0.0.0",
3324	                    "gateway": "172.20.3.254",
3325	                }],
3326	                "ip_address": "172.19.1.34", "id": "network0"
3327	            }, {
3328	                "network_id": "mgmt",

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_net.py:4978:12
4977	            )
4978	            assert renderer_selected == renderer_name
4979	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_net_freebsd.py:16:8
15	        a = net.get_interfaces_by_mac()
16	        assert a == {'52:54:00:50:b7:0d': 'vtnet0',
17	                     '80:00:73:63:5c:48': 're0.33',
18	                     '02:14:39:0e:25:00': 'bridge0',
19	                     '02:ff:60:8c:f3:72': 'vnet0:11'}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_render_cloudcfg.py:31:8
30	            variant = 'ubuntu'  # Unknown is defaulted to ubuntu
31	        assert system_cfg['system_info']['distro'] == variant
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_render_cloudcfg.py:44:8
43	        default_user = system_cfg['system_info']['default_user']['name']
44	        assert default_user == default_user_exceptions.get(variant, variant)
45	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_render_cloudcfg.py:59:8
58	
59	        assert renderers == system_cfg['system_info']['network']['renderers']

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o666 on file (path).
   Severity: High   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\tests\unittests\test_util.py:145:8
144	        open(path, 'w').close()
145	        os.chmod(path, 0o666)
146	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:883:8
882	        m_uname.return_value.release = uname_release
883	        assert expected == util.kernel_version()
884	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:894:8
893	        devlist = util.find_devs_with()
894	        assert devlist == [
895	            '/dev/sda1: UUID="some-uuid" TYPE="ext4" PARTUUID="some-partid"']
896	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:898:8
897	        devlist = util.find_devs_with("LABEL_FATBOOT=A_LABEL")
898	        assert devlist == [
899	            '/dev/sda1: UUID="some-uuid" TYPE="ext4" PARTUUID="some-partid"']
900	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:907:8
906	        devlist = util.find_devs_with_openbsd()
907	        assert devlist == ['/dev/cd0a', '/dev/sd1i']
908	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:915:8
914	        devlist = util.find_devs_with_openbsd(criteria="TYPE=iso9660")
915	        assert devlist == ['/dev/cd0a']
916	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:919:8
918	        devlist = util.find_devs_with_openbsd(criteria="LABEL_FATBOOT=A_LABEL")
919	        assert devlist == ['/dev/cd0a', '/dev/sd1i']
920	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:942:8
941	        devlist = util.find_devs_with_freebsd(criteria=criteria)
942	        assert devlist == expected_devlist
943	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittests\test_util.py:996:8
995	        devlist = util.find_devs_with_netbsd(criteria=criteria)
996	        assert devlist == expected_devlist
997	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tools\mock-meta.py:167:18
166	def id_generator(size=6, lower=False):
167	    txt = ''.join(random.choice(ID_CHARS) for x in range(size))
168	    if lower:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tools\mock-meta.py:212:26
211	        elif action == 'ami-launch-index':
212	            return "%s" % random.choice([0, 1, 2, 3])
213	        elif action == 'aki-id':

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tools\mock-meta.py:233:19
232	        elif action == 'instance-type':
233	            return random.choice(INSTANCE_TYPES)
234	        elif action == 'ami-manifest-path':

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tools\mock-meta.py:293:34
292	                    zones = PLACEMENT_CAPABILITIES[pentry]
293	                    return "%s" % random.choice(zones)
294	                else:

--------------------------------------------------

Code scanned:
	Total lines of code: 87471
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 456
		Medium: 110
		High: 8
	Total issues (by confidence):
		Undefined: 0
		Low: 12
		Medium: 108
		High: 454
Files skipped (0):
