Working... ---------------------------------------- 100% 0:00:27
Run started:2024-02-10 22:20:55.207817

Test results:
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:178:8
177	        timer = time.time()
178	        assert stat.data_collector.pull_function is not None
179	        rows_added = stat.data_collector.pull_function(stat.property, start_time, end_time, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:304:8
303	    if table == RealmCount:
304	        assert isinstance(zerver_object, Realm)
305	        id_args: Dict[str, Union[Realm, UserProfile, Stream]] = {"realm": zerver_object}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:307:8
306	    elif table == UserCount:
307	        assert isinstance(zerver_object, UserProfile)
308	        id_args = {"realm": zerver_object.realm, "user": zerver_object}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:310:8
309	    else:  # StreamCount
310	        assert isinstance(zerver_object, Stream)
311	        id_args = {"realm": zerver_object.realm, "stream": zerver_object}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:47:29
46	        for i in range(days):
47	            holidays.extend([random() < holiday_rate] * 24)
48	    elif frequency == CountStat.DAY:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:53:20
52	        ] * 2
53	        holidays = [random() < holiday_rate for i in range(days)]
54	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\management\commands\update_analytics_counts.py:63:8
62	        fill_to_time = parse_datetime(options["time"])
63	        assert fill_to_time is not None
64	        if options["utc"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_counts.py:244:8
243	        fill_state = FillState.objects.filter(property=stat.property).first()
244	        assert fill_state is not None
245	        self.assertEqual(fill_state.end_time, end_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:75:12
74	            first_human_user = zulip_realm.get_first_human_user()
75	            assert first_human_user is not None
76	            self.assert_in_success_response(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:432:8
431	        customer = get_customer_by_realm(lear_realm)
432	        assert customer is not None
433	        self.assertTrue(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:440:8
439	        customer = get_customer_by_realm(lear_realm)
440	        assert customer is not None
441	        self.assertFalse(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:471:8
470	        customer = get_customer_by_realm(lear_realm)
471	        assert customer is not None
472	        self.assertFalse(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\analytics\views\installation_activity.py:253:8
252	            row["hours_per_user"] = "{:.1f}".format(hours / row["dau_count"])
253	        except Exception:
254	            pass
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:57:4
56	) -> HttpResponse:
57	    assert request.user.is_authenticated
58	    page_params = dict(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:83:4
82	def stats(request: HttpRequest) -> HttpResponse:
83	    assert request.user.is_authenticated
84	    realm = request.user.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:115:4
114	) -> HttpResponse:
115	    assert settings.ZILENCER_ENABLED
116	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:146:4
145	) -> HttpResponse:
146	    assert settings.ZILENCER_ENABLED
147	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:165:4
164	def stats_for_remote_installation(request: HttpRequest, remote_server_id: int) -> HttpResponse:
165	    assert settings.ZILENCER_ENABLED
166	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:195:4
194	) -> HttpResponse:
195	    assert settings.ZILENCER_ENABLED
196	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:230:12
229	        if remote:
230	            assert settings.ZILENCER_ENABLED
231	            aggregate_table: TableType = RemoteInstallationCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:232:12
231	            aggregate_table: TableType = RemoteInstallationCount
232	            assert server is not None
233	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:237:12
236	        if remote:
237	            assert settings.ZILENCER_ENABLED
238	            aggregate_table = RemoteRealmCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:239:12
238	            aggregate_table = RemoteRealmCount
239	            assert server is not None
240	            assert remote_realm_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:240:12
239	            assert server is not None
240	            assert remote_realm_id is not None
241	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:320:8
319	        # table.
320	        assert server is not None
321	        assert aggregate_table is RemoteInstallationCount or aggregate_table is RemoteRealmCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:321:8
320	        assert server is not None
321	        assert aggregate_table is RemoteInstallationCount or aggregate_table is RemoteRealmCount
322	        aggregate_table_remote = cast(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:331:12
330	            first = aggregate_table_remote.objects.filter(server=server).first()
331	            assert first is not None
332	            start = first.end_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:335:12
334	            last = aggregate_table_remote.objects.filter(server=server).last()
335	            assert last is not None
336	            end = last.end_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:365:4
364	
365	    assert len({stat.frequency for stat in stats}) == 1
366	    end_times = time_range(start, end, stats[0].frequency, min_length)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:85:8
84	
85	        assert content_object is not None
86	        if hasattr(content_object, "status"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:169:8
168	        acting_user = request.user
169	        assert isinstance(acting_user, UserProfile)
170	        if plan_type is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:266:16
265	                hostname = parse_result.hostname
266	                assert hostname is not None
267	                if parse_result.port:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:77:4
76	    obj = confirmation.content_object
77	    assert obj is not None
78	    if activate_object and hasattr(obj, "status"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:106:4
105	def add_months(dt: datetime, months: int) -> datetime:
106	    assert months >= 0
107	    # It's fine that the max day in Feb is 28 for leap years.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:160:4
159	        return None
160	    assert plan.next_invoice_date is not None  # for mypy
161	    months_per_period = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:185:4
184	        plan = new_plan
185	    assert plan.price_per_license is not None  # for mypy
186	    return plan.price_per_license * last_ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:336:4
335	    customer = get_customer_by_realm(user.realm)
336	    assert customer is not None  # for mypy
337	    assert customer.stripe_customer_id is not None  # for mypy

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:337:4
336	    assert customer is not None  # for mypy
337	    assert customer.stripe_customer_id is not None  # for mypy
338	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:387:4
386	    )
387	    assert last_ledger_renewal is not None
388	    last_renewal = last_ledger_renewal.event_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:391:8
390	    if plan.is_free_trial() or plan.status == CustomerPlan.SWITCH_NOW_FROM_STANDARD_TO_PLUS:
391	        assert plan.next_invoice_date is not None
392	        next_billing_cycle = plan.next_invoice_date

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:397:8
396	        licenses_at_next_renewal = last_ledger_entry.licenses_at_next_renewal
397	        assert licenses_at_next_renewal is not None
398	        if plan.status == CustomerPlan.ACTIVE:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:458:12
457	            realm = new_plan.customer.realm
458	            assert realm is not None
459	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:634:4
633	    customer = update_or_create_stripe_customer(user)
634	    assert customer.stripe_customer_id is not None  # for mypy
635	    assert customer.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:635:4
634	    assert customer.stripe_customer_id is not None  # for mypy
635	    assert customer.realm is not None
636	    ensure_realm_does_not_have_active_plan(customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:729:8
728	    if licenses is not None:
729	        assert plan.customer.realm is not None
730	        assert get_latest_seat_count(plan.customer.realm) <= licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:730:8
729	        assert plan.customer.realm is not None
730	        assert get_latest_seat_count(plan.customer.realm) <= licenses
731	        assert licenses > plan.licenses()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:731:8
730	        assert get_latest_seat_count(plan.customer.realm) <= licenses
731	        assert licenses > plan.licenses()
732	        LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:736:8
735	    elif licenses_at_next_renewal is not None:
736	        assert plan.customer.realm is not None
737	        assert get_latest_seat_count(plan.customer.realm) <= licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:737:8
736	        assert plan.customer.realm is not None
737	        assert get_latest_seat_count(plan.customer.realm) <= licenses_at_next_renewal
738	        LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:788:8
787	    if not plan.customer.stripe_customer_id:
788	        assert plan.customer.realm is not None
789	        raise BillingError(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:799:8
798	    else:
799	        assert plan.invoiced_through is not None
800	        licenses_base = plan.invoiced_through.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:812:16
811	            else:
812	                assert plan.price_per_license is not None  # needed for mypy
813	                price_args = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:819:12
818	        elif licenses_base is not None and ledger_entry.licenses != licenses_base:
819	            assert plan.price_per_license
820	            last_ledger_entry_renewal = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:827:12
826	            )
827	            assert last_ledger_entry_renewal is not None
828	            last_renewal = last_ledger_entry_renewal.event_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:991:4
990	
991	    assert plan.customer.realm is not None
992	    do_change_plan_type(plan.customer.realm, Realm.PLAN_TYPE_LIMITED, acting_user=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1038:4
1037	    plan = get_current_plan_by_realm(realm)
1038	    assert plan is not None
1039	    do_change_plan_status(plan, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1158:4
1157	    plus_plan = get_current_plan_by_realm(realm)
1158	    assert plus_plan is not None  # for mypy
1159	    invoice_plan(plus_plan, plan_switch_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:74:4
73	    stripe_customer = stripe.Customer.retrieve(stripe_setup_intent.customer)
74	    assert session.customer.realm is not None
75	    user = get_user_by_delivery_email(stripe_customer.email, session.customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:120:4
119	    metadata = stripe_payment_intent.metadata
120	    assert payment_intent.customer.realm is not None
121	    user = get_user_by_delivery_email(metadata["user_email"], payment_intent.customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:41:12
40	        if is_self_hosted:
41	            assert self.realm is None
42	        return is_self_hosted

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:48:12
47	        if is_cloud:
48	            assert self.remote_server is None
49	        return is_cloud

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:292:8
291	        ledger_entry = LicenseLedger.objects.filter(plan=self).order_by("id").last()
292	        assert ledger_entry is not None
293	        return ledger_entry.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:299:8
298	        ledger_entry = LicenseLedger.objects.filter(plan=self).order_by("id").last()
299	        assert ledger_entry is not None
300	        return ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:339:12
338	        if generate_fixture:  # nocoverage
339	            assert stripe.api_key
340	        for mocked_function_name in MOCKED_STRIPE_FUNCTION_NAMES:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:438:12
437	        if attaches_to_customer:
438	            assert charge_succeeds is not None
439	            if charge_succeeds:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:506:8
505	        )
506	        assert response.status_code == 200
507	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:512:8
511	        )
512	        assert response.status_code == 200
513	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:693:8
692	        [payment_intent] = PaymentIntent.objects.all()
693	        assert payment_intent.stripe_payment_intent_id is not None
694	        self.assert_details_of_valid_session_from_event_status_endpoint(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1448:8
1447	        customer = Customer.objects.first()
1448	        assert customer is not None
1449	        stripe_customer_id: str = assert_is_not_none(customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1461:8
1460	        ledger_entry = LicenseLedger.objects.first()
1461	        assert ledger_entry is not None
1462	        self.assertEqual(ledger_entry.licenses, new_seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1511:8
1510	        stripe_customer_id = Customer.objects.get(realm=get_realm("zulip")).stripe_customer_id
1511	        assert stripe_customer_id is not None
1512	        self.assertFalse(CustomerPlan.objects.exists())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1652:8
1651	        [payment_intent] = PaymentIntent.objects.all()
1652	        assert payment_intent.stripe_payment_intent_id is not None
1653	        self.assert_details_of_valid_session_from_event_status_endpoint(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1678:8
1677	        stripe_customer_id = Customer.objects.get(realm=get_realm("zulip")).stripe_customer_id
1678	        assert stripe_customer_id is not None
1679	        self.assertFalse(CustomerPlan.objects.exists())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1710:8
1709	        [second_payment_intent, _] = PaymentIntent.objects.all().order_by("-id")
1710	        assert second_payment_intent.stripe_payment_intent_id is not None
1711	        self.assert_details_of_valid_session_from_event_status_endpoint(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1866:8
1865	        customer = get_customer_by_realm(get_realm("zulip"))
1866	        assert customer is not None
1867	        assert customer.stripe_customer_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1867:8
1866	        assert customer is not None
1867	        assert customer.stripe_customer_id is not None
1868	        [invoice, _] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2231:8
2230	        ).first()
2231	        assert sponsorship_request is not None
2232	        self.assertEqual(sponsorship_request.org_website, data["website"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2240:8
2239	        customer = get_customer_by_realm(user.realm)
2240	        assert customer is not None
2241	        self.assertEqual(customer.sponsorship_pending, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2431:8
2430	        ).last()
2431	        assert realm_audit_log is not None
2432	        expected_extra_data = str({"old_discount": None, "new_discount": Decimal("85")})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2440:8
2439	        customer = Customer.objects.first()
2440	        assert customer is not None
2441	        [charge] = stripe.Charge.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2444:8
2443	        stripe_customer_id = customer.stripe_customer_id
2444	        assert stripe_customer_id is not None
2445	        [invoice] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2462:8
2461	        stripe_customer_id = customer.stripe_customer_id
2462	        assert stripe_customer_id is not None
2463	        [invoice, _] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2478:8
2477	        stripe_customer_id = customer.stripe_customer_id
2478	        assert stripe_customer_id is not None
2479	        [invoice, _, _] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2484:8
2483	        ).last()
2484	        assert realm_audit_log is not None
2485	        expected_extra_data = str(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2501:8
2500	        message = Message.objects.filter(sender=sender.id).first()
2501	        assert message is not None
2502	        self.assertEqual(message.content, expected_message)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2511:8
2510	        customer = get_customer_by_realm(realm=lear)
2511	        assert customer is not None
2512	        self.assertTrue(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2516:8
2515	        ).last()
2516	        assert realm_audit_log is not None
2517	        expected_extra_data = {"sponsorship_pending": True}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2535:8
2534	        customer = Customer.objects.first()
2535	        assert customer is not None
2536	        stripe_customer_id = customer.stripe_customer_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2537:8
2536	        stripe_customer_id = customer.stripe_customer_id
2537	        assert stripe_customer_id is not None
2538	        stripe.InvoiceItem.create(amount=5000, currency="usd", customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2596:8
2595	        self.assert_in_success_response(["payment method: <strong>visa ending in 0341"], response)
2596	        assert RealmAuditLog.objects.filter(event_type=RealmAuditLog.STRIPE_CARD_CHANGED).exists()
2597	        stripe_payment_methods = stripe.PaymentMethod.list(customer=stripe_customer_id, type="card")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2655:8
2654	        plan = get_current_plan_by_realm(user.realm)
2655	        assert plan is not None
2656	        self.assertEqual(plan.licenses(), self.seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2665:16
2664	                new_plan = get_current_plan_by_realm(user.realm)
2665	                assert new_plan is not None
2666	                expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2714:8
2713	        plan = CustomerPlan.objects.first()
2714	        assert plan is not None
2715	        self.assertEqual(get_realm("zulip").plan_type, Realm.PLAN_TYPE_LIMITED)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2737:8
2736	        plan = CustomerPlan.objects.first()
2737	        assert plan is not None
2738	        self.assertIsNotNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2745:8
2744	        plan = CustomerPlan.objects.first()
2745	        assert plan is not None
2746	        self.assertIsNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2765:8
2764	        monthly_plan = get_current_plan_by_realm(user.realm)
2765	        assert monthly_plan is not None
2766	        self.assertEqual(monthly_plan.automanage_licenses, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2771:8
2770	        new_plan = get_current_plan_by_realm(user.realm)
2771	        assert new_plan is not None
2772	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2805:8
2804	        customer = get_customer_by_realm(user.realm)
2805	        assert customer is not None
2806	        self.assertEqual(CustomerPlan.objects.filter(customer=customer).count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2811:8
2810	        annual_plan = get_current_plan_by_realm(user.realm)
2811	        assert annual_plan is not None
2812	        self.assertEqual(annual_plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2848:8
2847	
2848	        assert customer.stripe_customer_id
2849	        [invoice0, invoice1, invoice2] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2954:8
2953	        monthly_plan = get_current_plan_by_realm(user.realm)
2954	        assert monthly_plan is not None
2955	        self.assertEqual(monthly_plan.automanage_licenses, False)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2959:8
2958	        new_plan = get_current_plan_by_realm(user.realm)
2959	        assert new_plan is not None
2960	        with self.assertLogs("corporate.stripe", "INFO") as m:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2983:8
2982	        customer = get_customer_by_realm(user.realm)
2983	        assert customer is not None
2984	        self.assertEqual(CustomerPlan.objects.filter(customer=customer).count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2989:8
2988	        annual_plan = get_current_plan_by_realm(user.realm)
2989	        assert annual_plan is not None
2990	        self.assertEqual(annual_plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3013:8
3012	
3013	        assert customer.stripe_customer_id
3014	        [invoice0, invoice1] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3068:16
3067	                new_plan = get_current_plan_by_realm(user.realm)
3068	                assert new_plan is not None
3069	                expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3073:8
3072	        plan = CustomerPlan.objects.first()
3073	        assert plan is not None
3074	        self.assertEqual(plan.status, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3082:8
3081	        plan = CustomerPlan.objects.first()
3082	        assert plan is not None
3083	        self.assertEqual(plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3101:12
3100	            new_plan = get_current_plan_by_realm(user.realm)
3101	            assert new_plan is not None
3102	            with patch("corporate.views.billing_page.timezone_now", return_value=self.now):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3110:8
3109	        plan = CustomerPlan.objects.first()
3110	        assert plan is not None
3111	        self.assertIsNotNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3115:8
3114	        plan = CustomerPlan.objects.first()
3115	        assert plan is not None
3116	        self.assertIsNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3137:12
3136	            last_ledger_entry = LicenseLedger.objects.order_by("id").last()
3137	            assert last_ledger_entry is not None
3138	            self.assertEqual(last_ledger_entry.licenses, 21)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3182:12
3181	            new_plan = get_current_plan_by_realm(user.realm)
3182	            assert new_plan is not None
3183	            expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3211:8
3210	        current_plan = CustomerPlan.objects.all().order_by("id").last()
3211	        assert current_plan is not None
3212	        next_invoice_date = add_months(self.next_year, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3218:8
3217	        old_plan = CustomerPlan.objects.all().order_by("id").first()
3218	        assert old_plan is not None
3219	        self.assertEqual(old_plan.next_invoice_date, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3440:8
3439	        last_ledger_entry = LicenseLedger.objects.order_by("id").last()
3440	        assert last_ledger_entry is not None
3441	        self.assertEqual(last_ledger_entry.licenses, 20)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3491:8
3490	        current_plan = CustomerPlan.objects.all().order_by("id").last()
3491	        assert current_plan is not None
3492	        self.assertEqual(current_plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3497:8
3496	        old_plan = CustomerPlan.objects.all().order_by("id").first()
3497	        assert old_plan is not None
3498	        self.assertEqual(old_plan.next_invoice_date, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3511:8
3510	
3511	        assert zulip_customer.stripe_customer_id
3512	        stripe.InvoiceItem.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3529:8
3528	
3529	        assert lear_customer.stripe_customer_id
3530	        stripe.InvoiceItem.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3568:8
3567	        invoices = []
3568	        assert customer.stripe_customer_id is not None
3569	        for _ in range(num_invoices):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\corporate\tests\test_stripe.py:3596:45
3595	        ) -> Tuple[Realm, Optional[Customer], Optional[CustomerPlan], List[stripe.Invoice]]:
3596	            realm_string_id = "realm_" + str(random.randrange(1, 1000000))
3597	            realm = Realm.objects.create(string_id=realm_string_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3617:16
3616	            if num_invoices is not None:
3617	                assert customer is not None
3618	                invoices = self.create_invoices(customer, num_invoices)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3760:8
3759	        plus_plan = get_current_plan_by_realm(realm)
3760	        assert plus_plan is not None
3761	        self.assertEqual(plus_plan.tier, CustomerPlan.PLUS)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3771:8
3770	        stripe_customer_id = customer.stripe_customer_id
3771	        assert stripe_customer_id is not None
3772	        _, cb_txn = stripe.Customer.list_balance_transactions(  # type: ignore[attr-defined] # mypy seems to incorrectly think that this function doesn't exist

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3806:8
3805	        ).last()
3806	        assert realm_audit_log is not None
3807	        expected_extra_data = {"charge_automatically": plan.charge_automatically}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3817:8
3816	        ).last()
3817	        assert realm_audit_log is not None
3818	        expected_extra_data = {"charge_automatically": plan.charge_automatically}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4479:8
4478	        plan = CustomerPlan.objects.first()
4479	        assert plan is not None
4480	        self.assertEqual(plan.licenses(), self.seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4529:8
4528	        plan = get_current_plan_by_realm(realm)
4529	        assert plan is not None
4530	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4609:8
4608	        plan = CustomerPlan.objects.first()
4609	        assert plan is not None
4610	        plan.invoicing_status = CustomerPlan.STARTED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4618:8
4617	        plan = get_current_plan_by_realm(get_realm("zulip"))
4618	        assert plan and plan.customer
4619	        plan.customer.stripe_customer_id = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4650:8
4649	        plan = CustomerPlan.objects.first()
4650	        assert plan is not None
4651	        invoice_plan(plan, self.now + timedelta(days=400))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4653:8
4652	        stripe_cutomer_id = plan.customer.stripe_customer_id
4653	        assert stripe_cutomer_id is not None
4654	        [invoice0, invoice1] = stripe.Invoice.list(customer=stripe_cutomer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4702:8
4701	        plan = CustomerPlan.objects.first()
4702	        assert plan is not None
4703	        plan.fixed_price = 100

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4708:8
4707	        stripe_customer_id = plan.customer.stripe_customer_id
4708	        assert stripe_customer_id is not None
4709	        [invoice0, invoice1] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4729:8
4728	        plan = CustomerPlan.objects.first()
4729	        assert plan is not None
4730	        self.assertEqual(plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4735:8
4734	        # Test that we still update next_invoice_date
4735	        assert plan is not None
4736	        self.assertEqual(plan.next_invoice_date, self.next_month + timedelta(days=29))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4742:8
4741	        plan = CustomerPlan.objects.first()
4742	        assert plan is not None
4743	        self.assertEqual(plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4751:8
4750	        plan = CustomerPlan.objects.first()
4751	        assert plan is not None
4752	        self.assertEqual(plan.next_invoice_date, self.next_month + timedelta(days=29))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:67:4
66	    user = request.user
67	    assert user.is_authenticated
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:103:12
102	                plan = new_plan
103	            assert plan is not None  # for mypy
104	            downgrade_at_end_of_cycle = plan.status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:114:16
113	            if plan.is_free_trial():
114	                assert plan.next_invoice_date is not None
115	                renewal_date = "{dt:%B} {dt.day}, {dt.year}".format(dt=plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:123:12
122	            charge_automatically = plan.charge_automatically
123	            assert customer.stripe_customer_id is not None  # for mypy
124	            stripe_customer = stripe_get_customer(customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:175:4
174	    plan = get_current_plan_by_realm(user.realm)
175	    assert plan is not None  # for mypy
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:188:12
187	        if status == CustomerPlan.ACTIVE:
188	            assert plan.status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE
189	            do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:191:12
190	        elif status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE:
191	            assert plan.status == CustomerPlan.ACTIVE
192	            downgrade_at_the_end_of_billing_cycle(user.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:194:12
193	        elif status == CustomerPlan.SWITCH_TO_ANNUAL_AT_END_OF_CYCLE:
194	            assert plan.billing_schedule == CustomerPlan.MONTHLY
195	            assert plan.status == CustomerPlan.ACTIVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:195:12
194	            assert plan.billing_schedule == CustomerPlan.MONTHLY
195	            assert plan.status == CustomerPlan.ACTIVE
196	            assert plan.fixed_price is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:196:12
195	            assert plan.status == CustomerPlan.ACTIVE
196	            assert plan.fixed_price is None
197	            do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:199:12
198	        elif status == CustomerPlan.ENDED:
199	            assert plan.is_free_trial()
200	            downgrade_now_without_creating_additional_invoices(user.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\session.py:21:4
20	    customer = get_customer_by_realm(user.realm)
21	    assert customer
22	    stripe_session = stripe.checkout.Session.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\support.py:23:4
22	    user = request.user
23	    assert user.is_authenticated
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:88:4
87	    customer = update_or_create_stripe_customer(user)
88	    assert customer is not None  # for mypy
89	    free_trial = is_free_trial_offer_enabled()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:176:8
175	        )
176	        assert licenses is not None and license_management is not None
177	        automanage_licenses = license_management == "automatic"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:237:4
236	    user = request.user
237	    assert user.is_authenticated
238	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:40:8
39	    else:
40	        assert not settings.PRODUCTION
41	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:65:8
64	        stripe_session = stripe_event.data.object
65	        assert isinstance(stripe_session, stripe.checkout.Session)
66	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:76:8
75	        stripe_payment_intent = stripe_event.data.object
76	        assert isinstance(stripe_payment_intent, stripe.PaymentIntent)
77	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:92:12
91	        try:
92	            assert isinstance(stripe_payment_intent, stripe.PaymentIntent)
93	            payment_intent = PaymentIntent.objects.get(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\check_rabbitmq_queue.py:4:0
3	import re
4	import subprocess
5	import time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\check_rabbitmq_queue.py:135:25
134	
135	    list_queues_output = subprocess.check_output(
136	        ["/usr/sbin/rabbitmqctl", "list_queues", "name", "messages", "consumers"],
137	        universal_newlines=True,
138	    )
139	    queue_counts_rabbitmqctl = {}

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\check_rabbitmq_queue.py:152:22
151	
152	    queue_stats_dir = subprocess.check_output(
153	        [os.path.join(ZULIP_PATH, "scripts/get-django-setting"), "QUEUE_STATS_DIR"],
154	        universal_newlines=True,
155	    ).strip()
156	    queue_stats: Dict[str, Dict[str, Any]] = {}

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\hash_reqs.py:5:0
4	import os
5	import subprocess
6	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\hash_reqs.py:38:11
37	    """
38	    return subprocess.check_output(["/usr/bin/python3", "-VV"], universal_newlines=True)
39	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\hash_reqs.py:43:11
42	    deps_str = "\n".join(deps) + "\n" + python_version()
43	    return hashlib.sha1(deps_str.encode()).hexdigest()
44	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\node_cache.py:5:0
4	import shutil
5	import subprocess
6	from typing import Dict, List, Optional

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\node_cache.py:45:27
44	        data["yarn-package-version"] = json.load(f)["version"]
45	    data["node-version"] = subprocess.check_output(
46	        ["node", "--version"], universal_newlines=True
47	    ).strip()
48	    data["yarn-args"] = get_yarn_args(production=production)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\node_cache.py:45:27
44	        data["yarn-package-version"] = json.load(f)["version"]
45	    data["node-version"] = subprocess.check_output(
46	        ["node", "--version"], universal_newlines=True
47	    ).strip()
48	    data["yarn-args"] = get_yarn_args(production=production)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\node_cache.py:50:14
49	
50	    sha1sum = hashlib.sha1()
51	    sha1sum.update(json.dumps(data, sort_keys=True).encode())

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\puppet_cache.py:5:0
4	import shutil
5	import subprocess
6	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\puppet_cache.py:23:29
22	        data["deps.yaml"] = fb.read().strip()
23	    data["puppet-version"] = subprocess.check_output(
24	        # This is 10x faster than `puppet --version`
25	        ["ruby", "-r", "puppet/version", "-e", "puts Puppet.version"],
26	        universal_newlines=True,
27	    ).strip()
28	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\puppet_cache.py:23:29
22	        data["deps.yaml"] = fb.read().strip()
23	    data["puppet-version"] = subprocess.check_output(
24	        # This is 10x faster than `puppet --version`
25	        ["ruby", "-r", "puppet/version", "-e", "puts Puppet.version"],
26	        universal_newlines=True,
27	    ).strip()
28	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\puppet_cache.py:29:14
28	
29	    sha1sum = hashlib.sha1()
30	    sha1sum.update(json.dumps(data, sort_keys=True).encode())

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_path.py:15:12
14	        with open(activate_this) as f:
15	            exec(f.read(), activate_locals)
16	        # Check that the python version running this function

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\setup_venv.py:4:0
3	import shutil
4	import subprocess
5	from typing import List, Optional, Set, Tuple

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:181:30
180	            continue
181	        venv_python_version = subprocess.check_output(
182	            [venv_python3, "-VV"], universal_newlines=True
183	        )
184	        if desired_python_version != venv_python_version:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:285:13
284	    path = os.path.join(ZULIP_PATH, "scripts", "lib", "hash_reqs.py")
285	    output = subprocess.check_output([path, requirements_file], universal_newlines=True)
286	    return output.split()[0]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\sharding.py:6:0
5	import os
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\sharding.py:39:4
38	    expected_ports = list(range(9800, max(ports) + 1))
39	    assert (
40	        sorted(ports) == expected_ports
41	    ), f"ports ({sorted(ports)}) must be contiguous, starting with 9800"
42	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\sharding.py:54:24
53	        shard_map: Dict[str, int] = {}
54	        external_host = subprocess.check_output(
55	            [os.path.join(BASE_DIR, "scripts/get-django-setting"), "EXTERNAL_HOST"],
56	            universal_newlines=True,
57	        ).strip()
58	        for port in config_file["tornado_sharding"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\sharding.py:67:20
66	                        host = f"{shard}.{external_host}"
67	                    assert host not in shard_map, f"host {host} duplicated"
68	                    shard_map[host] = int(port)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\zulip_tools.py:15:0
14	import shutil
15	import subprocess
16	import sys

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\scripts\lib\zulip_tools.py:49:43
48	        # overwrite an existing target; we handle the error and try again.
49	        tmp = os.path.join(dir, f".{base}.{random.randrange(1 << 40):010x}")
50	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:228:8
227	    try:
228	        subprocess.check_call(args, **kwargs)
229	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:341:10
340	def generate_sha1sum_emoji(zulip_path: str) -> str:
341	    sha = hashlib.sha1()
342	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:448:14
447	    # see is_digest_obsolete for more context
448	    sha1sum = hashlib.sha1()
449	    for fn in filenames:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\zulip_tools.py:587:4
586	    )
587	    subprocess.check_call(["su", "postgres", "-c", subcmd])
588	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:587:4
586	    )
587	    subprocess.check_call(["su", "postgres", "-c", subcmd])
588	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\zulip_tools.py:621:20
620	def list_supervisor_processes(*args: str) -> List[str]:
621	    worker_status = subprocess.run(
622	        ["supervisorctl", "status", *args],
623	        universal_newlines=True,
624	        stdout=subprocess.PIPE,
625	    )
626	    # `supercisorctl status` returns 3 if any are stopped, which is

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:621:20
620	def list_supervisor_processes(*args: str) -> List[str]:
621	    worker_status = subprocess.run(
622	        ["supervisorctl", "status", *args],
623	        universal_newlines=True,
624	        stdout=subprocess.PIPE,
625	    )
626	    # `supercisorctl status` returns 3 if any are stopped, which is

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\zulip_tools.py:652:4
651	    r = SplitResult("", netloc, "", "", "")
652	    assert r.hostname is not None
653	    return "[" + r.hostname + "]" if ":" in r.hostname else r.hostname

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:69:8
68	    ):
69	        assert output.count("<html>") == 0
70	        assert output.count("<body>") == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:70:8
69	        assert output.count("<html>") == 0
70	        assert output.count("<body>") == 0
71	        assert output.count("</html>") == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:71:8
70	        assert output.count("<body>") == 0
71	        assert output.count("</html>") == 0
72	        assert output.count("</body>") == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:72:8
71	        assert output.count("</html>") == 0
72	        assert output.count("</body>") == 0
73	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\add_mentor.py:36:8
35	
36	    r = requests.get(url)
37	    if r.status_code != 200:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:46:19
45	    try:
46	        response = urllib.request.urlopen(user_api_url)
47	        json.load(response)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:60:19
59	    try:
60	        response = urllib.request.urlopen(apiurl_keys)
61	        userkeys = json.load(response)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:79:19
78	    try:
79	        response = urllib.request.urlopen(apiurl_fork)
80	        json.load(response)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\create.py:280:15
279	def get_zulip_oneclick_app_slug(api_token: str) -> str:
280	    response = requests.get(
281	        "https://api.digitalocean.com/v2/1-clicks", headers={"Authorization": f"Bearer {api_token}"}
282	    ).json()
283	    one_clicks = response["1_clicks"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\html_branches.py:132:8
131	    def walk(node: Node, tag_info_list: Sequence[TagInfo] = []) -> None:
132	        assert node.token is not None
133	        info = get_tag_info(node.token)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\pretty_print.py:1:0
1	import subprocess
2	from typing import List, Optional, Set
3	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:114:16
113	                # to be None.
114	                assert start is not None
115	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\pretty_print.py:216:8
215	        )
216	        subprocess.run(["diff", fn, "-"], input=phtml, universal_newlines=True)
217	        print()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\pretty_print.py:216:8
215	        )
216	        subprocess.run(["diff", fn, "-"], input=phtml, universal_newlines=True)
217	        print()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\provision.py:7:0
6	import platform
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\provision.py:324:7
323	    # pg_datadir directory.
324	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
325	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\provision.py:324:7
323	    # pg_datadir directory.
324	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
325	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tools\lib\provision.py:362:14
361	    # hash the apt dependencies
362	    sha_sum = hashlib.sha1()
363	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\tools\lib\provision.py:467:8
466	    with open(activate_this) as f:
467	        exec(f.read(), dict(__file__=activate_this))
468	    os.execvp(

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\tools\lib\provision.py:468:4
467	        exec(f.read(), dict(__file__=activate_this))
468	    os.execvp(
469	        provision_inner,
470	        [
471	            provision_inner,
472	            *(["--force"] if options.is_force else []),
473	            *(["--build-release-tarball-only"] if options.is_build_release_tarball_only else []),
474	            *(["--skip-dev-db-build"] if options.skip_dev_db_build else []),
475	        ],
476	    )
477	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:246:4
245	def validate(fn: Optional[str] = None, text: Optional[str] = None) -> None:
246	    assert fn or text
247	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_script.py:3:0
2	import os
3	import subprocess
4	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\test_script.py:131:4
130	    os.environ["PUPPETEER_PRODUCT"] = "firefox" if is_firefox else "chrome"
131	    subprocess.check_call(["node", "node_modules/puppeteer/install.js"])
132	    os.makedirs("var/puppeteer", exist_ok=True)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_script.py:131:4
130	    os.environ["PUPPETEER_PRODUCT"] = "firefox" if is_firefox else "chrome"
131	    subprocess.check_call(["node", "node_modules/puppeteer/install.js"])
132	    os.makedirs("var/puppeteer", exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_server.py:2:0
1	import os
2	import subprocess
3	import sys

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\lib\test_server.py:49:15
48	        # Note that zulipdev.com is mapped via DNS to 127.0.0.1.
49	        return requests.get("http://zulipdev.com:9981/accounts/home").status_code == 200
50	    except requests.RequestException:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:77:13
76	        run_dev_server_command.append("--skip-provision-check")
77	    server = subprocess.Popen(run_dev_server_command, stdout=log, stderr=log)
78	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:2:0
1	import os
2	import subprocess
3	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:18:4
17	def generate_ssh_keys() -> None:
18	    subprocess.call(
19	        ["ssh-keygen", "-f", str(Path.home()) + "/.ssh/id_ed25519", "-P", "", "-t", "ed25519"]
20	    )
21	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:18:4
17	def generate_ssh_keys() -> None:
18	    subprocess.call(
19	        ["ssh-keygen", "-f", str(Path.home()) + "/.ssh/id_ed25519", "-P", "", "-t", "ed25519"]
20	    )
21	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:107:4
106	def setup_one_click_app_installer(droplet: digitalocean.Droplet) -> None:
107	    subprocess.call(
108	        [
109	            "fab",
110	            "build_image",
111	            "-H",
112	            droplet.ip_address,
113	            "--keepalive",
114	            "5",
115	            "--connection-attempts",
116	            "10",
117	        ],
118	        cwd="marketplace-partners/marketplace_docs/templates/Fabric",
119	    )
120	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:107:4
106	def setup_one_click_app_installer(droplet: digitalocean.Droplet) -> None:
107	    subprocess.call(
108	        [
109	            "fab",
110	            "build_image",
111	            "-H",
112	            droplet.ip_address,
113	            "--keepalive",
114	            "5",
115	            "--connection-attempts",
116	            "10",
117	        ],
118	        cwd="marketplace-partners/marketplace_docs/templates/Fabric",
119	    )
120	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\run-dev.py:6:0
5	import signal
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:103:4
102	if options.clear_memcached:
103	    subprocess.check_call("./scripts/setup/flush-memcached")
104	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:169:4
168	    # with a running development server.
169	    subprocess.check_call(["./tools/webpack", "--quiet", "--test"])
170	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:184:11
183	        webpack_cmd.append("--host=0.0.0.0")
184	    return subprocess.Popen(webpack_cmd)
185	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:370:24
369	    for cmd in server_processes():
370	        children.append(subprocess.Popen(cmd))
371	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\tests\test_hash_reqs.py:22:8
21	
22	        assert hash1 == hash2
23	        assert hash1 != hash3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\tests\test_hash_reqs.py:23:8
22	        assert hash1 == hash2
23	        assert hash1 != hash3

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\context_processors.py:134:29
133	    support_email = FromAddress.SUPPORT
134	    support_email_html_tag = SafeString(
135	        f'<a href="mailto:{escape(support_email)}">{escape(support_email)}</a>'
136	    )
137	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\gitter.py:3:0
2	import os
3	import subprocess
4	from typing import Any, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\gitter.py:342:4
341	
342	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
343	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\gitter.py:342:4
341	
342	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
343	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\import_util.py:191:38
190	def build_subscription(recipient_id: int, user_id: int, subscription_id: int) -> ZerverFieldsT:
191	    subscription = Subscription(color=random.choice(stream_colors), id=subscription_id)
192	    subscription_dict = model_to_dict(subscription, exclude=["user_profile", "recipient_id"])

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:536:15
535	
536	    response = requests.get(avatar_url + size_url_suffix, stream=True)
537	    with open(image_path, "wb") as image_file:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:622:15
621	
622	    response = requests.get(upload_url, stream=True)
623	    os.makedirs(os.path.dirname(upload_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:670:15
669	
670	    response = requests.get(emoji_url, stream=True)
671	    os.makedirs(os.path.dirname(upload_emoji_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\mattermost.py:11:0
10	import shutil
11	import subprocess
12	from typing import Any, Callable, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\data_import\mattermost.py:230:11
229	
230	    return hashlib.md5("".join(sorted(huddle_members)).encode()).hexdigest()
231	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\mattermost.py:347:23
346	                str(realm_id),
347	                format(random.randint(0, 255), "x"),
348	                secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\mattermost.py:837:12
836	        for post in mattermost_data["post"]["direct_post"]:
837	            assert "team" not in post
838	            user = username_to_user[post["user"]]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\mattermost.py:1014:8
1013	        logging.info("Start making tarball")
1014	        subprocess.check_call(["tar", "-czf", realm_output_dir + ".tar.gz", realm_output_dir, "-P"])
1015	        logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\mattermost.py:1014:8
1013	        logging.info("Start making tarball")
1014	        subprocess.check_call(["tar", "-czf", realm_output_dir + ".tar.gz", realm_output_dir, "-P"])
1015	        logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\rocketchat.py:5:0
4	import secrets
5	import subprocess
6	from typing import Any, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\rocketchat.py:379:19
378	            str(realm_id),
379	            format(random.randint(0, 255), "x"),
380	            secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\rocketchat.py:1140:4
1139	    logging.info("Start making tarball")
1140	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1141	    logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\rocketchat.py:1140:4
1139	    logging.info("Start making tarball")
1140	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1141	    logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\slack.py:6:0
5	import shutil
6	import subprocess
7	import zipfile

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\slack.py:1098:19
1097	            str(realm_id),
1098	            format(random.randint(0, 255), "x"),
1099	            secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1242:15
1241	
1242	    response = requests.get(icon_url, stream=True)
1243	    response_raw = response.raw

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\slack.py:1375:4
1374	        rm_tree(slack_data_dir)
1375	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1376	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\slack.py:1375:4
1374	        rm_tree(slack_data_dir)
1375	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1376	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1391:15
1390	    elif token.startswith("xoxb-"):
1391	        data = requests.get(
1392	            "https://slack.com/api/team.info", headers={"Authorization": f"Bearer {token}"}
1393	        )
1394	        if data.status_code != 200 or not data.json()["ok"]:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1413:11
1412	    token = kwargs.pop("token")
1413	    data = requests.get(slack_api_url, headers={"Authorization": f"Bearer {token}"}, params=kwargs)
1414	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\slack_message_conversion.py:125:4
124	    slack_usermention_match = re.search(SLACK_USERMENTION_REGEX, token, re.VERBOSE)
125	    assert slack_usermention_match is not None
126	    short_name = slack_usermention_match.group(4)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:99:4
98	
99	    assert request_notes.client is not None
100	    event = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:193:4
192	
193	    assert client_name is not None
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:478:8
477	    def _wrapped_view_func(request: HttpRequest, *args: object, **kwargs: object) -> HttpResponse:
478	        assert request.user.is_authenticated
479	        if request.user.is_bot:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:923:4
922	    ip_addr = request.META["REMOTE_ADDR"]
923	    assert ip_addr
924	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:981:16
980	            else:
981	                assert isinstance(user, UserProfile)
982	                rate_limit_user(request, user, domain="api_by_user")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:1056:8
1055	        page_params = context.setdefault("page_params", {})
1056	        assert isinstance(page_params, dict)
1057	        page_params["google_analytics_id"] = settings.GOOGLE_ANALYTICS_ID

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\filters.py:11:8
10	        post_data = SafeExceptionReporterFilter.get_post_parameters(self, request)
11	        assert isinstance(post_data, dict)
12	        filtered_post = post_data.copy()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Your password has been disabled because it is too weak. Reset your password to create a new one.'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\forms.py:62:4
61	PASSWORD_RESET_NEEDED_ERROR = (
62	    "Your password has been disabled because it is too weak. "
63	    "Reset your password to create a new one."
64	)
65	PASSWORD_TOO_WEAK_ERROR = "The password is too weak."
66	AUTHENTICATION_RATE_LIMITED_ERROR = (

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'The password is too weak.'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\forms.py:65:26
64	)
65	PASSWORD_TOO_WEAK_ERROR = "The password is too weak."
66	AUTHENTICATION_RATE_LIMITED_ERROR = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:427:16
426	            except RateLimited as e:
427	                assert e.secs_to_freedom is not None
428	                secs_to_freedom = int(e.secs_to_freedom)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:540:8
539	    if used_preregistration_user is None:
540	        assert not realm_creation, "realm_creation should only happen with a PreregistrationUser"
541	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:700:8
699	        )
700	        assert realm_creation_audit_log is not None
701	        realm_creation_audit_log.acting_user = user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:821:4
820	    property_type = Realm.property_types[name]
821	    assert isinstance(
822	        value, property_type
823	    ), f"Cannot update {name}: {value} is not an instance of {property_type}"
824	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1206:4
1205	    # to this recipient (all private messages sent to the user).
1206	    assert personal_recipient is not None
1207	    personal_recipient.delete()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1545:8
1544	        message_to_user_ids = list({recipient.type_id, sender_id})
1545	        assert len(message_to_user_ids) in [1, 2]
1546	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1551:8
1550	        # of this function for different message types.
1551	        assert stream_topic is not None
1552	        user_ids_muting_topic = stream_topic.user_ids_muting_topic()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1824:8
1823	        scheduled_message.realm = send_request.realm
1824	        assert send_request.deliver_at is not None
1825	        scheduled_message.scheduled_timestamp = send_request.deliver_at

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1877:4
1876	    # Render our message_dicts.
1877	    assert message.rendered_content is None
1878	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2034:12
2033	            # assert needed because stubs for django are missing
2034	            assert send_request.stream is not None
2035	            realm_id = send_request.stream.realm_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2134:12
2133	            # assert needed because stubs for django are missing
2134	            assert send_request.stream is not None
2135	            if send_request.stream.is_public():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2477:8
2476	        reaction = query.first()
2477	        assert reaction is not None
2478	        emoji_name = reaction.emoji_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2630:8
2629	        # message recipients of the message.
2630	        assert forwarder_user_profile is not None
2631	        if forwarder_user_profile.id not in recipient_profiles_map:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2639:4
2638	
2639	    assert recipient_profiles_map
2640	    if len(recipient_profiles_map) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2960:4
2959	
2960	    assert topic_name is not None
2961	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3075:8
3074	    if stream_id is not None:
3075	        assert message.is_stream_message()
3076	        if not user_profile.can_move_messages_between_streams():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3203:20
3202	                else:
3203	                    assert stream_name is not None
3204	                    content = _(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3305:8
3304	            stream = addressee.stream()
3305	        assert stream is not None
3306	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3331:12
3330	            # else can sneak past the access check.
3331	            assert sender.bot_type == sender.OUTGOING_WEBHOOK_BOT
3332	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3353:12
3352	        except ValidationError as e:
3353	            assert isinstance(e.messages[0], str)
3354	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3374:4
3373	    # We render messages later in the process.
3374	    assert message.rendered_content is None
3375	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3814:8
3813	    for stream in streams:
3814	        assert stream.realm_id == realm.id
3815	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3817:8
3816	    for user in users:
3817	        assert user.realm_id == realm.id
3818	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4000:4
3999	
4000	    assert op in ["peer_add", "peer_remove"]
4001	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4886:8
4885	    else:
4886	        assert invite_only is not None
4887	        do_change_stream_invite_only(stream, invite_only, history_public_to_subscribers)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5099:8
5098	        # suites that want to backdate the date of a realm's creation.
5099	        assert not settings.PRODUCTION
5100	        kwargs["date_created"] = date_created

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5194:8
5193	    if setting_name == "timezone":
5194	        assert isinstance(setting_value, str)
5195	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5197:8
5196	        property_type = UserProfile.property_types[setting_name]
5197	        assert isinstance(setting_value, property_type)
5198	    setattr(user_profile, setting_name, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5228:8
5227	    if setting_name == "email_notifications_batching_period_seconds":
5228	        assert isinstance(old_value, int)
5229	        assert isinstance(setting_value, int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5229:8
5228	        assert isinstance(old_value, int)
5229	        assert isinstance(setting_value, int)
5230	        update_scheduled_email_notifications_time(user_profile, old_value, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5239:8
5238	    if setting_name == "default_language":
5239	        assert isinstance(setting_value, str)
5240	        event["language_name"] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5267:12
5266	        if setting_name == "default_language":
5267	            assert isinstance(setting_value, str)
5268	            legacy_event["language_name"] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:5680:8
5679	    all_push_message_ids = (
5680	        UserMessage.objects.filter(
5681	            user_profile=user_profile,
5682	        )
5683	        .extra(
5684	            where=[UserMessage.where_active_push_notification()],
5685	        )
5686	        .values_list("message_id", flat=True)[0:10000]

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:5690:11
5689	
5690	    msgs = UserMessage.objects.filter(user_profile=user_profile).extra(
5691	        where=[UserMessage.where_unread()],
5692	    )
5693	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:5739:11
5738	
5739	    msgs = msgs.extra(
5740	        where=[UserMessage.where_unread()],
5741	    )
5742	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:5777:15
5776	) -> int:
5777	    messages = UserMessage.objects.filter(
5778	        user_profile=user_profile, message__sender=muted_user
5779	    ).extra(where=[UserMessage.where_unread()])
5780	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5840:4
5839	    # only for the message-edit use case where we'll have a single message_id.
5840	    assert len(user_profile_ids) == 1 or len(message_ids) == 1
5841	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:5844:8
5843	    notifications_to_update = list(
5844	        UserMessage.objects.filter(
5845	            message_id__in=message_ids,
5846	            user_profile_id__in=user_profile_ids,
5847	        )
5848	        .extra(
5849	            where=[UserMessage.where_active_push_notification()],
5850	        )
5851	        .values_list("user_profile_id", "message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6214:8
6213	    if content is not None:
6214	        assert rendering_result is not None
6215	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6217:8
6216	        # mention_data is required if there's a content edit.
6217	        assert mention_data is not None
6218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6306:8
6305	    if new_stream is not None:
6306	        assert content is None
6307	        assert target_message.is_stream_message()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6307:8
6306	        assert content is None
6307	        assert target_message.is_stream_message()
6308	        assert stream_being_edited is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6308:8
6307	        assert target_message.is_stream_message()
6308	        assert stream_being_edited is not None
6309	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6375:8
6374	    if propagate_mode in ["change_later", "change_all"]:
6375	        assert topic_name is not None or new_stream is not None
6376	        assert stream_being_edited is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6376:8
6375	        assert topic_name is not None or new_stream is not None
6376	        assert stream_being_edited is not None
6377	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6404:12
6403	        if new_stream is not None:
6404	            assert stream_being_edited is not None
6405	            changed_message_ids = [msg.id for msg in changed_messages]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6490:16
6489	            if new_stream is not None:
6490	                assert delete_event_notify_user_ids is not None
6491	                subscriptions = subscriptions.exclude(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6555:8
6554	    ):
6555	        assert stream_being_edited is not None
6556	        maybe_send_resolve_topic_notifications(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6584:8
6583	    if not sample_message.is_stream_message():
6584	        assert len(messages) == 1
6585	        message_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6877:16
6876	            for stream_dict in lst:
6877	                assert isinstance(stream_dict["stream_id"], int)
6878	                stream_id = stream_dict["stream_id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7222:8
7221	        invite = confirmation_obj.content_object
7222	        assert invite is not None
7223	        invites.append(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7282:4
7281	    # These are two structurally for the caller's code path.
7282	    assert prereg_user.referred_by is not None
7283	    assert prereg_user.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7283:4
7282	    assert prereg_user.referred_by is not None
7283	    assert prereg_user.realm is not None
7284	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7622:12
7621	            bot_owner = user_profile.bot_owner
7622	            assert bot_owner is not None
7623	            owner_stream_ids = get_subscribed_stream_ids_for_user(bot_owner)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:8159:4
8158	    export_extra_data = export.extra_data
8159	    assert export_extra_data is not None
8160	    export_data = orjson.loads(export_extra_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:39:4
38	def validate_topic(topic: str) -> str:
39	    assert topic is not None
40	    topic = topic.strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:72:8
71	    ) -> None:
72	        assert msg_type in ["stream", "private"]
73	        if msg_type == "stream" and topic is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:89:8
88	    def user_profiles(self) -> Sequence[UserProfile]:
89	        assert self.is_private()
90	        assert self._user_profiles is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:90:8
89	        assert self.is_private()
90	        assert self._user_profiles is not None
91	        return self._user_profiles

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:94:8
93	    def stream(self) -> Optional[Stream]:
94	        assert self.is_stream()
95	        return self._stream

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:98:8
97	    def stream_name(self) -> Optional[str]:
98	        assert self.is_stream()
99	        return self._stream_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:102:8
101	    def stream_id(self) -> Optional[int]:
102	        assert self.is_stream()
103	        return self._stream_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:106:8
105	    def topic(self) -> str:
106	        assert self.is_stream()
107	        assert self._topic is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:107:8
106	        assert self.is_stream()
107	        assert self._topic is not None
108	        return self._topic

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:190:8
189	    def for_private(emails: Sequence[str], realm: Realm) -> "Addressee":
190	        assert len(emails) > 0
191	        user_profiles = get_user_profiles(emails, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:199:8
198	    def for_user_ids(user_ids: Sequence[int], realm: Realm) -> "Addressee":
199	        assert len(user_ids) > 0
200	        user_profiles = get_user_profiles_by_ids(user_ids, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:123:4
122	        return upload_backend.get_avatar_url(hash_key, medium=medium)
123	    assert email is not None
124	    return _get_unversioned_gravatar_url(email, medium)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:134:4
133	    # avatar_url can return None if client_gravatar=True, however here we use the default value of False
134	    assert avatar is not None
135	    return urllib.parse.urljoin(user_profile.realm.uri, avatar)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar_hash.py:27:4
26	    # it in order to make the hashing scheme different from Gravatar's.
27	    assert settings.AVATAR_SALT is not None
28	    user_key = uid + settings.AVATAR_SALT

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_lib.py:99:8
98	
99	        assert message["type"] == "private"
100	        # Ensure that it's a comma-separated list, even though the

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_storage.py:43:8
42	    for key, value in entries:
43	        assert isinstance(key, str), "Key type should be str."
44	        assert isinstance(value, str), "Value type should be str."

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_storage.py:44:8
43	        assert isinstance(key, str), "Key type should be str."
44	        assert isinstance(value, str), "Value type should be str."
45	        storage_size_difference += (len(key) + len(value)) - get_bot_storage_size(bot_profile, key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:104:4
103	) -> None:
104	    assert model in [UserProfile, Stream]
105	    for obj in objects:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:106:8
105	    for obj in objects:
106	        assert isinstance(obj, model)
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:121:8
120	    for recipient in recipients:
121	        assert recipient.type == recipient_type
122	        result = objects_dict.get(recipient.type_id)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\cache.py:123:17
122	    # Memcached keys should have a length of less than 250.
123	    KEY_PREFIX = hashlib.sha1(KEY_PREFIX.encode()).hexdigest() + ":"
124	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:261:4
260	    keys = rkeys + okeys
261	    assert len(keys) == len(set(keys))
262	    assert "type" in rkeys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:262:4
261	    assert len(keys) == len(set(keys))
262	    assert "type" in rkeys
263	    assert "id" not in keys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:263:4
262	    assert "type" in rkeys
263	    assert "id" not in keys
264	    return DictType(

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\debug.py:87:11
86	    sock = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)
87	    path = f"/tmp/tracemalloc.{os.getpid()}"
88	    sock.bind(path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\digest.py:281:4
280	    # We expect a non-empty list of users all from the same realm.
281	    assert users
282	    realm = users[0].realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\digest.py:284:8
283	    for user in users:
284	        assert user.realm_id == realm.id
285	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\display_recipient.py:38:8
37	    if recipient_type == Recipient.STREAM:
38	        assert recipient_type_id is not None
39	        stream = Stream.objects.values("name").get(id=recipient_type_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:242:12
241	            content = part.get_payload(decode=True)
242	            assert isinstance(content, bytes)
243	            if charsets[idx]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:269:12
268	        else:
269	            assert html_content  # Needed for mypy. Ensured by the validating block above.
270	            return html_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:275:12
274	        else:
275	            assert plaintext_content  # Needed for mypy. Ensured by the validating block above.
276	            return plaintext_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:453:4
452	
453	    assert recipient is not None
454	    if recipient.type == Recipient.STREAM:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:460:8
459	        display_recipient = get_display_recipient(recipient)
460	        assert not isinstance(display_recipient, str)
461	        recipient_str = display_recipient[0]["email"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:466:8
465	        display_recipient = get_display_recipient(recipient)
466	        assert not isinstance(display_recipient, str)
467	        emails = [user_dict["email"] for user_dict in display_recipient]

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:11:0
10	import html2text
11	import lxml.html
12	import pytz

--------------------------------------------------
>> Issue: [B410:blacklist] Using builder to parse untrusted XML data is known to be vulnerable to XML attacks. Replace builder with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:19:0
18	from django.utils.translation import override as override_language
19	from lxml.html import builder as E
20	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:100:8
99	        # we assert that it does not.
100	        assert match is not None
101	        emoji_code = match.group("emoji_code")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:214:8
213	
214	        assert message.rendered_content is not None
215	        fragment = lxml.html.fragment_fromstring(message.rendered_content, create_parent=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:235:12
234	            display_recipient = get_display_recipient(message.recipient)
235	            assert not isinstance(display_recipient, str)
236	            narrow_link = get_narrow_url(user, message, display_recipient=display_recipient)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:319:8
318	    if message.recipient.type == Recipient.PERSONAL:
319	        assert stream is None
320	        assert display_recipient is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:320:8
319	        assert stream is None
320	        assert display_recipient is None
321	        return personal_narrow_url(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:326:8
325	    elif message.recipient.type == Recipient.HUDDLE:
326	        assert stream is None
327	        if display_recipient is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:329:8
328	            display_recipient = get_display_recipient(message.recipient)
329	        assert display_recipient is not None
330	        assert not isinstance(display_recipient, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:330:8
329	        assert display_recipient is not None
330	        assert not isinstance(display_recipient, str)
331	        other_user_ids = [r["id"] for r in display_recipient if r["id"] != user_profile.id]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:337:8
336	    else:
337	        assert display_recipient is None
338	        if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:466:8
465	        # Make sure that this is a list of strings, not a string.
466	        assert not isinstance(display_recipient, str)
467	        other_recipients = [r["full_name"] for r in display_recipient if r["id"] != user_profile.id]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_validation.py:208:8
207	    for key, error_info in error_dict.items():
208	        assert key == email
209	        msg, deactivated = error_info

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:241:4
240	
241	    assert event["message_type"] == message_type
242	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:251:8
250	    if is_legacy:
251	        assert num_message_ids == 1
252	        keys.add("message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:254:8
253	    else:
254	        assert isinstance(event["message_ids"], list)
255	        assert num_message_ids == len(event["message_ids"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:255:8
254	        assert isinstance(event["message_ids"], list)
255	        assert num_message_ids == len(event["message_ids"])
256	        keys.add("message_ids")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:258:4
257	
258	    assert set(event.keys()) == keys
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:278:4
277	    _check_has_zoom_token(var_name, event)
278	    assert event["value"] == value
279	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:435:4
434	
435	    assert ("email" in event) == has_email
436	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:437:4
436	
437	    assert isinstance(event["presence"], dict)
438	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:440:4
439	    # Our tests only have one presence value.
440	    assert len(event["presence"]) == 1
441	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:442:4
441	
442	    assert list(event["presence"].keys())[0] == presence_key
443	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:444:4
443	
444	    assert list(event["presence"].values())[0]["status"] == status
445	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:563:4
562	
563	    assert isinstance(event["bot"], dict)
564	    bot_type = event["bot"]["bot_type"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:651:4
650	
651	    assert isinstance(event["bot"], dict)
652	    assert {"user_id", field} == set(event["bot"].keys())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:652:4
651	    assert isinstance(event["bot"], dict)
652	    assert {"user_id", field} == set(event["bot"].keys())
653	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:705:4
704	    _check_realm_playgrounds(var_name, event)
705	    assert isinstance(event["realm_playgrounds"], list)
706	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:741:4
740	
741	    assert isinstance(event["realm_emoji"], dict)
742	    for k, v in event["realm_emoji"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:743:8
742	    for k, v in event["realm_emoji"].items():
743	        assert v["id"] == k
744	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:784:4
783	    # exercise that case, so we do strict validation for a single export here.
784	    assert isinstance(event["exports"], list)
785	    assert len(event["exports"]) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:785:4
784	    assert isinstance(event["exports"], list)
785	    assert len(event["exports"]) == 1
786	    export = event["exports"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:789:4
788	    # Now verify which fields have non-None values.
789	    assert has_export_url == (export["export_url"] is not None)
790	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:790:4
789	    assert has_export_url == (export["export_url"] is not None)
790	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)
791	    assert has_failed_timestamp == (export["failed_timestamp"] is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:791:4
790	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)
791	    assert has_failed_timestamp == (export["failed_timestamp"] is not None)
792	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:878:4
877	
878	    assert prop == event["property"]
879	    value = event["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:882:8
881	    if prop == "plan_type":
882	        assert isinstance(value, int)
883	        assert "extra_data" in event.keys()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:883:8
882	        assert isinstance(value, int)
883	        assert "extra_data" in event.keys()
884	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:886:4
885	
886	    assert "extra_data" not in event.keys()
887	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:889:8
888	    if prop in ["notifications_stream_id", "signup_notifications_stream_id"]:
889	        assert isinstance(value, int)
890	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:895:8
894	    if property_type in (bool, int, str):
895	        assert isinstance(value, property_type)
896	    elif property_type == (int, type(None)):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:897:8
896	    elif property_type == (int, type(None)):
897	        assert isinstance(value, int)
898	    elif property_type == (str, type(None)):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:899:8
898	    elif property_type == (str, type(None)):
899	        assert isinstance(value, str)
900	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:922:4
921	
922	    assert prop == event["property"]
923	    assert prop != "default_language"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:923:4
922	    assert prop == event["property"]
923	    assert prop != "default_language"
924	    assert prop in RealmUserDefault.property_types

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:924:4
923	    assert prop != "default_language"
924	    assert prop in RealmUserDefault.property_types
925	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:927:4
926	    prop_type = RealmUserDefault.property_types[prop]
927	    assert isinstance(event["value"], prop_type)
928	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1012:8
1011	    if event["property"] == "default":
1012	        assert isinstance(event["data"], dict)
1013	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1262:8
1261	    if prop == "description":
1262	        assert extra_keys == {"rendered_description"}
1263	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1263:8
1262	        assert extra_keys == {"rendered_description"}
1263	        assert isinstance(value, str)
1264	    elif prop == "email_address":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1265:8
1264	    elif prop == "email_address":
1265	        assert extra_keys == set()
1266	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1266:8
1265	        assert extra_keys == set()
1266	        assert isinstance(value, str)
1267	    elif prop == "invite_only":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1268:8
1267	    elif prop == "invite_only":
1268	        assert extra_keys == {"history_public_to_subscribers", "is_web_public"}
1269	        assert isinstance(value, bool)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1269:8
1268	        assert extra_keys == {"history_public_to_subscribers", "is_web_public"}
1269	        assert isinstance(value, bool)
1270	    elif prop == "message_retention_days":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1271:8
1270	    elif prop == "message_retention_days":
1271	        assert extra_keys == set()
1272	        if value is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1273:12
1272	        if value is not None:
1273	            assert isinstance(value, int)
1274	    elif prop == "name":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1275:8
1274	    elif prop == "name":
1275	        assert extra_keys == set()
1276	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1276:8
1275	        assert extra_keys == set()
1276	        assert isinstance(value, str)
1277	    elif prop == "stream_post_policy":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1278:8
1277	    elif prop == "stream_post_policy":
1278	        assert extra_keys == set()
1279	        assert value in Stream.STREAM_POST_POLICY_TYPES

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1279:8
1278	        assert extra_keys == set()
1279	        assert value in Stream.STREAM_POST_POLICY_TYPES
1280	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1365:4
1364	    _check_subscription_update(var_name, event)
1365	    assert event["property"] == property
1366	    assert event["value"] == value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1366:4
1365	    assert event["property"] == property
1366	    assert event["value"] == value
1367	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1457:4
1456	
1457	    assert isinstance(setting_name, str)
1458	    if setting_name == "timezone":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1459:8
1458	    if setting_name == "timezone":
1459	        assert isinstance(setting, str)
1460	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1462:8
1461	        setting_type = UserProfile.property_types[setting_name]
1462	        assert isinstance(setting, setting_type)
1463	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1465:8
1464	    if setting_name == "default_language":
1465	        assert "language_name" in event.keys()
1466	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1467:8
1466	    else:
1467	        assert "language_name" not in event.keys()
1468	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1478:4
1477	
1478	    assert isinstance(setting_name, str)
1479	    if setting_name == "timezone":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1480:8
1479	    if setting_name == "timezone":
1480	        assert isinstance(value, str)
1481	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1483:8
1482	        setting_type = UserProfile.property_types[setting_name]
1483	        assert isinstance(value, setting_type)
1484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1486:8
1485	    if setting_name == "default_language":
1486	        assert "language_name" in event.keys()
1487	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1488:8
1487	    else:
1488	        assert "language_name" not in event.keys()
1489	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1514:4
1513	    setting = event["setting"]
1514	    assert setting == desired_val
1515	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1516:4
1515	
1516	    assert isinstance(setting_name, str)
1517	    setting_type = UserProfile.notification_settings_legacy[setting_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1518:4
1517	    setting_type = UserProfile.notification_settings_legacy[setting_name]
1518	    assert isinstance(setting, setting_type)
1519	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1594:4
1593	
1594	    assert expected_keys == actual_keys
1595	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1706:4
1705	
1706	    assert isinstance(event["data"], dict)
1707	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1708:4
1707	
1708	    assert set(event["data"].keys()) == {field}
1709	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1732:4
1731	
1732	    assert set(event.keys()) == {"id", "type", "user_id"} | fields

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:127:8
126	    if realm is None:
127	        assert user_profile is not None
128	        realm = user_profile.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:597:8
596	        # To ensure we have the correct user state set.
597	        assert state["is_admin"] is False
598	        assert state["is_owner"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:598:8
597	        assert state["is_admin"] is False
598	        assert state["is_owner"] is False
599	        assert state["is_guest"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:599:8
598	        assert state["is_owner"] is False
599	        assert state["is_guest"] is True
600	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:714:12
713	                    break
714	            assert state_draft_idx is not None
715	            _draft_update_action(state_draft_idx)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1195:12
1194	        if event["setting_name"] != "timezone":
1195	            assert event["setting_name"] in UserProfile.display_settings_legacy
1196	        state[event["setting_name"]] = event["setting"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1198:8
1197	    elif event["type"] == "update_global_notifications":
1198	        assert event["notification_name"] in UserProfile.notification_settings_legacy
1199	        state[event["notification_name"]] = event["setting"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1204:12
1203	        if event["property"] != "timezone":
1204	            assert event["property"] in UserProfile.property_types
1205	        if event["property"] in {

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\export.py:14:0
13	import shutil
14	import subprocess
15	import tempfile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:335:4
334	
335	    assert ALL_ZULIP_TABLES == all_tables_db, error_message
336	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:336:4
335	    assert ALL_ZULIP_TABLES == all_tables_db, error_message
336	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message
337	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:337:4
336	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message
337	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
338	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:338:4
337	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
338	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
339	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:339:4
338	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
339	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES), error_message
340	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:440:8
439	    ) -> None:
440	        assert table or custom_tables
441	        self.table = table

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:518:8
517	    else:
518	        assert (
519	            table is not None
520	        ), """
521	            You must specify config.custom_tables if you
522	            are not specifying config.table"""
523	        exported_tables = [table]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:552:8
551	            logging.info("Deleted temporary %s", t)
552	        assert table is not None
553	        response[table] = data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:556:8
555	    elif config.use_all:
556	        assert model is not None
557	        query = model.objects.all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:566:8
565	        model = config.model
566	        assert parent is not None
567	        assert parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:567:8
566	        assert parent is not None
567	        assert parent.table is not None
568	        assert config.parent_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:568:8
567	        assert parent.table is not None
568	        assert config.parent_key is not None
569	        parent_ids = [r["id"] for r in response[parent.table]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:573:8
572	            filter_parms.update(config.filter_args)
573	        assert model is not None
574	        query = model.objects.filter(**filter_parms)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:582:8
581	        model = config.model
582	        assert model is not None
583	        # This will be a tuple of the form ('zerver_article', 'blog').

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:596:8
595	    if rows is not None:
596	        assert table is not None  # Hint for mypy
597	        response[table] = make_raw(rows, exclude=config.exclude)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:909:16
908	            if row["id"] in exportable_user_ids:
909	                assert not row["is_mirror_dummy"]
910	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:994:4
993	    realm = context["realm"]
994	    assert config.parent is not None
995	    assert config.parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:995:4
994	    assert config.parent is not None
995	    assert config.parent.table is not None
996	    user_profile_ids = {r["id"] for r in response[config.parent.table]}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1225:8
1224	        message_ids = {m["id"] for m in message_chunk}
1225	        assert len(message_ids.intersection(all_message_ids)) == 0
1226	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1660:8
1659	    if not settings.TEST_SUITE:
1660	        assert threads >= 1
1661	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1727:4
1726	    os.chdir(os.path.dirname(output_dir))
1727	    subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
1728	    os.chdir(reset_dir)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1727:4
1726	    os.chdir(os.path.dirname(output_dir))
1727	    subprocess.check_call(["tar", "-czf", tarball_path, os.path.basename(output_dir)])
1728	    os.chdir(reset_dir)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1779:18
1778	
1779	        process = subprocess.Popen(arguments)
1780	        pids[process.pid] = shard_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:2031:8
2030	
2031	        assert acting_user is not None
2032	        exports_dict[export.id] = dict(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:28:22
27	    for _ in itertools.repeat(None, num_single_word_topics):
28	        topics.append(random.choice(config["nouns"]))
29	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:36:27
35	    for _ in itertools.repeat(None, num_topics - num_single_word_topics):
36	        generated_topic = [random.choice(config[pos]) for pos in sentence]
37	        topic = " ".join(filter(None, generated_topic))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:44:7
43	    # experience perfectly.
44	    if random.random() < 0.15:
45	        resolved_topic_probability = 0.5

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:51:11
50	    for topic in topics:
51	        if random.random() < resolved_topic_probability:
52	            final_topics.append(RESOLVED_TOPIC_PREFIX + topic)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:168:12
167	    vals = text.split()
168	    start = random.randrange(len(vals))
169	    end = random.randrange(len(vals) - start) + start

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:169:10
168	    start = random.randrange(len(vals))
169	    end = random.randrange(len(vals) - start) + start
170	    vals[start] = mode + vals[start]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:179:12
178	    vals = text.split()
179	    start = random.randrange(len(vals))
180	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:188:12
187	    vals = text.split()
188	    start = random.randrange(len(vals))
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\home.py:143:8
142	        client = RequestNotes.get_notes(request).client
143	        assert client is not None
144	        register_ret = do_events_register(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\home.py:237:8
236	        page_params["max_message_id"] = max_message_id
237	        assert isinstance(page_params["user_settings"], dict)
238	        page_params["user_settings"]["enable_desktop_notifications"] = False

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:3:0
2	
3	import lxml
4	from lxml.html.diff import htmldiff

--------------------------------------------------
>> Issue: [B410:blacklist] Using htmldiff to parse untrusted XML data is known to be vulnerable to XML attacks. Replace htmldiff with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:4:0
3	import lxml
4	from lxml.html.diff import htmldiff
5	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:440:4
439	    # See comments in bulk_import_user_message_data.
440	    assert "usermessage" not in related_table
441	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:607:4
606	    # memory errors. We don't even use ids from ID_MAP.
607	    assert "usermessage" not in table
608	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:837:12
836	        else:
837	            assert settings.LOCAL_UPLOADS_DIR is not None
838	            if processing_avatars or processing_emojis or processing_realm_icons:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:1401:12
1400	        for row in data["zerver_usermessage"]:
1401	            assert row["message"] in message_id_map
1402	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\integrations.py:308:8
307	    def __init__(self, name: str, *args: Any, **kwargs: Any) -> None:
308	        assert kwargs.get("client_name") is None
309	        client_name = self.DEFAULT_CLIENT_NAME.format(name=name.title())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\logging_util.py:84:60
83	                        tb = str(record)
84	                    key = self.__class__.__name__.upper() + hashlib.sha1(tb.encode()).hexdigest()
85	                    duplicate = cache.get(key) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\logging_util.py:282:8
281	        client = RequestNotes.get_notes(request).client
282	        assert client is not None
283	

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\__init__.py:28:0
27	from urllib.parse import urlencode, urljoin, urlsplit
28	from xml.etree import ElementTree as etree
29	from xml.etree.ElementTree import Element, SubElement

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\__init__.py:29:0
28	from xml.etree import ElementTree as etree
29	from xml.etree.ElementTree import Element, SubElement
30	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\markdown\__init__.py:34:0
33	import dateutil.tz
34	import lxml.etree
35	import markdown

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:586:12
585	            url = img.get("src")
586	            assert url is not None
587	            if is_static_or_current_realm_url(url, self.md.zulip_realm):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1001:16
1000	                elem = url_to_a(db_data, item["url"], item["text"])
1001	                assert isinstance(elem, Element)
1002	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1079:12
1078	            url = e.get("href")
1079	            assert url is not None
1080	            return (url, e.text)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1110:12
1109	        elif parent.tag == "p":
1110	            assert grandparent is not None
1111	            parent_index = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:2048:8
2047	        href = el.get("href")
2048	        assert href is not None
2049	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\api_arguments_table_generator.py:152:16
151	                # Any path variable is required
152	                assert argument["required"]
153	                required_string = "required in path"

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\markdown\fenced_code.py:81:0
80	
81	import lxml.html
82	from django.utils.html import escape

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\nested_code_blocks.py:2:0
1	from typing import Any, List, Mapping, Optional, Tuple
2	from xml.etree.ElementTree import Element, SubElement
3	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\mdiff.py:3:0
2	import os
3	import subprocess
4	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\mdiff.py:19:11
18	    command = ["node", mdiff_path, output, expected_output]
19	    diff = subprocess.check_output(command, universal_newlines=True)
20	    return diff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:502:12
501	            obj["last_edit_timestamp"] = datetime_to_timestamp(last_edit_time)
502	            assert edit_history is not None
503	            obj["edit_history"] = orjson.loads(edit_history)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:520:12
519	
520	            assert message is not None  # Hint for mypy.
521	            # It's unfortunate that we need to have side effects on the message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:597:12
596	        elif recipient_type in (Recipient.HUDDLE, Recipient.PERSONAL):
597	            assert not isinstance(display_recipient, str)
598	            display_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:745:4
744	    # get_web_public_streams_queryset
745	    assert stream.is_web_public
746	    assert not stream.deactivated

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:746:4
745	    assert stream.is_web_public
746	    assert not stream.deactivated
747	    assert not stream.invite_only

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:747:4
746	    assert not stream.deactivated
747	    assert not stream.invite_only
748	    assert stream.history_public_to_subscribers

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:748:4
747	    assert not stream.invite_only
748	    assert stream.history_public_to_subscribers
749	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:783:8
782	    else:
783	        assert stream.recipient_id == message.recipient_id
784	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:907:4
906	    # str is for streams.
907	    assert not isinstance(display_recipient, str)
908	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:1000:8
999	    return list(
1000	        UserMessage.objects.filter(
1001	            user_profile=user_profile,
1002	        )
1003	        .extra(
1004	            where=[UserMessage.where_starred()],
1005	        )
1006	        .order_by(

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:1017:8
1016	    user_msgs = (
1017	        UserMessage.objects.filter(
1018	            user_profile=user_profile,
1019	        )
1020	        .exclude(
1021	            message__recipient_id__in=excluded_recipient_ids,
1022	        )
1023	        .extra(
1024	            where=[UserMessage.where_unread()],
1025	        )
1026	        .values(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:1484:4
1483	        raise RequestVariableConversionError("message_content_delete_limit_seconds", value)
1484	    assert isinstance(value, int)
1485	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:17:4
16	    the bitwise xor of the two hex strings."""
17	    assert len(bytes_a) == len(bytes_b)
18	    return "".join(f"{int(x, 16) ^ int(y, 16):x}" for x, y in zip(bytes_a, bytes_b))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:32:4
31	def otp_encrypt_api_key(api_key: str, otp: str) -> str:
32	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
33	    hex_encoded_api_key = ascii_to_hex(api_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:34:4
33	    hex_encoded_api_key = ascii_to_hex(api_key)
34	    assert len(hex_encoded_api_key) == UserProfile.API_KEY_LENGTH * 2
35	    return xor_hex_strings(hex_encoded_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:39:4
38	def otp_decrypt_api_key(otp_encrypted_api_key: str, otp: str) -> str:
39	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
40	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:40:4
39	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
40	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2
41	    hex_encoded_api_key = xor_hex_strings(otp_encrypted_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:47:8
46	    try:
47	        assert len(otp) == UserProfile.API_KEY_LENGTH * 2
48	        [int(c, 16) for c in otp]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notification_data.py:25:12
24	        if self.pm_email_notify or self.pm_push_notify:
25	            assert not (self.stream_email_notify or self.stream_push_notify)
26	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notification_data.py:28:12
27	        if self.stream_email_notify or self.stream_push_notify:
28	            assert not (self.pm_email_notify or self.pm_push_notify)
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\onboarding.py:113:4
112	    human_recipient_id = send_request.message.sender.recipient_id
113	    assert human_recipient_id is not None
114	    if Message.objects.filter(sender=welcome_bot, recipient_id=human_recipient_id).count() < 2:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\outgoing_webhook.py:206:4
205	    content = response_data.get("content")
206	    assert content
207	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\outgoing_webhook.py:260:4
259	    bot_owner = bot.bot_owner
260	    assert bot_owner is not None
261	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\push_notifications.py:12:0
11	import gcm
12	import lxml.html
13	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:156:8
155	    if remote:
156	        assert settings.ZILENCER_ENABLED
157	        DeviceTokenClass: Type[AbstractPushDeviceToken] = RemotePushDeviceToken

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:354:8
353	    if remote:
354	        assert settings.ZILENCER_ENABLED
355	        DeviceTokenClass: Type[AbstractPushDeviceToken] = RemotePushDeviceToken

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:429:4
428	    response_data = send_json_to_push_bouncer("POST", "push/notify", post_data)
429	    assert isinstance(response_data["total_android_devices"], int)
430	    assert isinstance(response_data["total_apple_devices"], int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:430:4
429	    assert isinstance(response_data["total_android_devices"], int)
430	    assert isinstance(response_data["total_apple_devices"], int)
431	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:596:8
595	    else:
596	        assert message.is_stream_message() and trigger == NotificationTriggers.STREAM_PUSH
597	        return f"New stream message from {sender_str} in #{display_recipient}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:710:8
709	    if mentioned_user_group_id is not None:
710	        assert mentioned_user_group_name is not None
711	        data["mentioned_user_group_id"] = mentioned_user_group_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:733:8
732	        recipients = get_display_recipient(message.recipient)
733	        assert isinstance(recipients, list)
734	        return ", ".join(sorted(r["full_name"] for r in recipients))

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\push_notifications.py:780:8
779	    return (
780	        UserMessage.objects.filter(user_profile=user_profile)
781	        .extra(where=[UserMessage.where_active_push_notification()])
782	        .exclude(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:808:4
807	
808	    assert message.rendered_content is not None
809	    with override_language(user_profile.default_language):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:837:4
836	    )
837	    assert message.rendered_content is not None
838	    with override_language(user_profile.default_language):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:162:8
161	
162	        assert self.channel is not None
163	        self.channel.basic_qos(prefetch_count=self.prefetch)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:195:20
194	                if body is not None:
195	                    assert method is not None
196	                    events.append(orjson.loads(body))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:201:24
200	                    if events:
201	                        assert max_processed is not None
202	                        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:216:8
215	    def local_queue_size(self) -> int:
216	        assert self.channel is not None
217	        return self.channel.get_waiting_message_count() + len(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:222:8
221	    def stop_consuming(self) -> None:
222	        assert self.channel is not None
223	        assert self.is_consuming

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:223:8
222	        assert self.channel is not None
223	        assert self.is_consuming
224	        self.is_consuming = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:319:8
318	    def _on_open(self, connection: pika.connection.Connection) -> None:
319	        assert self.connection is not None
320	        self._connection_failure_count = 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:341:12
340	        def set_qos(frame: Any) -> None:
341	            assert self.channel is not None
342	            self.queues.add(queue_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:346:12
345	        def finish(frame: Any) -> None:
346	            assert self.channel is not None
347	            callback(self.channel)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:356:12
355	
356	            assert self.channel is not None
357	            self.channel.queue_declare(queue=queue_name, durable=True, callback=set_qos)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:359:12
358	        else:
359	            assert self.channel is not None
360	            callback(self.channel)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:375:12
374	        ) -> None:
375	            assert method.delivery_tag is not None
376	            callback([orjson.loads(body)])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:379:8
378	
379	        assert batch_size == 1
380	        assert timeout is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:380:8
379	        assert batch_size == 1
380	        assert timeout is None
381	        self.consumers[queue_name].add(wrapped_consumer)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:320:8
319	
320	        assert rules
321	        for time_window, max_count in rules:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:390:8
389	        "Returns a tuple of (rate_limited, time_till_free)"
390	        assert rules
391	        list_key, set_key, blocking_key = cls.get_keys(entity_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:513:12
512	        if over_limit:
513	            assert not remaining
514	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\redis_utils.py:82:4
81	def validate_key_fits_format(key: str, key_format: str) -> None:
82	    assert "{token}" in key_format
83	    regex = key_format.format(token=r"[a-zA-Z0-9]+")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-zA-Z0-9]+'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\redis_utils.py:83:12
82	    assert "{token}" in key_format
83	    regex = key_format.format(token=r"[a-zA-Z0-9]+")
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\remote_server.py:54:4
53	    """
54	    assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
55	    url = urllib.parse.urljoin(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:183:8
182	
183	        assert converter is None or (
184	            json_validator is None and str_validator is None
185	        ), "converter and json_validator are mutually exclusive"
186	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:186:8
185	        ), "converter and json_validator are mutually exclusive"
186	        assert (
187	            json_validator is None or str_validator is None
188	        ), "json_validator and str_validator are mutually exclusive"
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:366:16
365	                # or don't declare them using REQ.
366	                assert func_var_name in kwargs
367	            if func_var_name in kwargs:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:369:12
368	                continue
369	            assert func_var_name is not None
370	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:380:16
379	                # This is a view bug, not a user error, and thus should throw a 500.
380	                assert param.argument_type is None, "Invalid argument type"
381	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:390:16
389	            for req_var in post_var_names:
390	                assert req_var is not None
391	                if req_var in request.POST:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:402:20
401	                if post_var_name is not None:
402	                    assert req_var is not None
403	                    raise RequestConfusingParmsError(post_var_name, req_var)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:408:16
407	                post_var_name = param.post_var_name
408	                assert post_var_name is not None
409	                if param.default is _REQ.NotSpecified:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:137:4
136	    # (such as UserMessage, Reaction, and Attachment) inside the same transaction.atomic() block.
137	    assert type in (ArchiveTransaction.MANUAL, ArchiveTransaction.RETENTION_POLICY_BASED)
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:191:4
190	) -> int:
191	    assert message_retention_days != -1
192	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:223:4
222	    message_retention_days = realm.message_retention_days
223	    assert message_retention_days != -1
224	    check_date = timezone_now() - timedelta(days=message_retention_days)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:297:4
296	def move_models_with_message_key_to_archive(msg_ids: List[int]) -> None:
297	    assert len(msg_ids) > 0
298	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:323:4
322	def move_attachments_to_archive(msg_ids: List[int]) -> None:
323	    assert len(msg_ids) > 0
324	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:341:4
340	def move_attachment_messages_to_archive(msg_ids: List[int]) -> None:
341	    assert len(msg_ids) > 0
342	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:414:12
413	        else:
414	            assert realm.message_retention_days != -1
415	            retention_policy_dict[stream.id] = realm.message_retention_days

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:698:4
697	        raise RequestVariableConversionError("message_retention_days", value)
698	    assert isinstance(value, int)
699	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:47:8
46	        # shouldn't be called with request being None.
47	        assert request is not None
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:153:8
152	        email = d.get("userName")
153	        assert isinstance(email, str)
154	        self.change_delivery_email(email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:166:12
165	        if full_name:
166	            assert isinstance(full_name, str)
167	            self.change_full_name(full_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:179:12
178	        if active is not None:
179	            assert isinstance(active, bool)
180	            self.change_is_active(active)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:215:12
214	            # overridden upstream method.
215	            assert path is not None
216	            value = {path: value}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:218:8
217	
218	        assert isinstance(value, dict)
219	        for path, val in (value or {}).items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:221:16
220	            if path.first_path == ("userName", None, None):
221	                assert isinstance(val, str)
222	                self.change_delivery_email(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:226:16
225	                # for updates via PUT.
226	                assert isinstance(val, str)
227	                self.change_full_name(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:229:16
228	            elif path.first_path == ("active", None, None):
229	                assert isinstance(val, bool)
230	                self.change_is_active(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:243:8
242	        realm = RequestNotes.get_notes(self._request).realm
243	        assert realm is not None
244	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:336:8
335	        realm = RequestNotes.get_notes(request).realm
336	        assert realm is not None
337	        return {"realm_id": realm.id, "is_bot": False}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:351:4
350	    realm = RequestNotes.get_notes(request).realm
351	    assert realm is not None
352	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim_filter.py:58:8
57	        """
58	        assert request is not None
59	        realm = RequestNotes.get_notes(request).realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim_filter.py:60:8
59	        realm = RequestNotes.get_notes(request).realm
60	        assert realm is not None
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:64:12
63	        if language is None:
64	            assert user_profile is not None
65	            language = user_profile.default_language

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:83:4
82	    # Callers should pass exactly one of to_user_id and to_email.
83	    assert (to_user_ids is None) ^ (to_emails is None)
84	    if to_user_ids is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:87:12
86	        if realm is None:
87	            assert len({to_user.realm_id for to_user in to_users}) == 1
88	            realm = to_users[0].realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:294:8
293	        connection = get_connection()
294	        assert connection is not None
295	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:313:12
312	        try:
313	            assert connection.connection is not None
314	            status = connection.connection.noop()[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:357:4
356	
357	    assert (to_user_ids is None) ^ (to_emails is None)
358	    with transaction.atomic():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:373:16
372	            else:
373	                assert to_emails is not None
374	                assert len(to_emails) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:374:16
373	                assert to_emails is not None
374	                assert len(to_emails) == 1
375	                email.address = parseaddr(to_emails[0])[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:149:4
148	    """
149	    assert user_profile.last_active_message_id is not None
150	    all_stream_subs = list(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:187:12
186	        if stream_subscription_logs[-1].event_type == RealmAuditLog.SUBSCRIPTION_DEACTIVATED:
187	            assert stream_subscription_logs[-1].event_last_message_id is not None
188	            if (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:249:8
248	        last_message = Message.objects.last()
249	        assert last_message is not None
250	        user_profile.last_active_message_id = last_message.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:210:8
209	        # Our caller should only pass us private streams.
210	        assert stream.invite_only
211	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:245:4
244	    # backwards-compatibility problem in our view.
245	    assert not notification_settings_null
246	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:637:8
636	        # caller, but it makes sense to verify anyway.
637	        assert stream_name == stream_name.strip()
638	        check_stream_name(stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\subdomains.py:85:8
84	        public_upload_root_url = get_public_upload_root_url()
85	        assert public_upload_root_url.endswith("/")
86	        if url.startswith(public_upload_root_url):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\lib\templates.py:176:11
175	
176	    return mark_safe(rendered_html)
177	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\lib\templates.py:176:11
175	
176	    return mark_safe(rendered_html)
177	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_classes.py:5:0
4	import shutil
5	import subprocess
6	import tempfile

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\test_classes.py:27:0
26	
27	import lxml.html
28	import orjson

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-z0-9_]{24}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\test_classes.py:201:30
200	    DEFAULT_SUBDOMAIN = "zulip"
201	    TOKENIZED_NOREPLY_REGEX = settings.TOKENIZED_NOREPLY_EMAIL_ADDRESS.format(token="[a-z0-9_]{24}")
202	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:223:12
222	            # Provide a way to disable setting User-Agent if desired.
223	            assert "HTTP_USER_AGENT" not in kwargs
224	            del kwargs["skip_user_agent"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:561:8
560	        """
561	        assert "@" not in name, "use login_by_email for email logins"
562	        user = self.example_user(name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:688:16
687	                match = re.search(url_pattern, message.body)
688	                assert match is not None
689	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:720:8
719	        # TODO: use encode_user where possible
720	        assert "@" in email
721	        user = get_user_by_delivery_email(email, get_realm(realm))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:797:8
796	        to_user_ids = [u.id for u in to_users]
797	        assert len(to_user_ids) >= 2
798	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:866:8
865	        response = self.client_get(url)
866	        assert isinstance(response, StreamingHttpResponse)
867	        data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1533:8
1532	        """
1533	        assert self.STREAM_NAME is not None
1534	        self.subscribe(self.test_user, self.STREAM_NAME)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1566:8
1565	            )
1566	        assert expected_message is not None and expected_topic is not None
1567	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1648:8
1647	    def get_body(self, fixture_name: str) -> str:
1648	        assert self.WEBHOOK_DIR_NAME is not None
1649	        body = self.webhook_fixture_data(self.WEBHOOK_DIR_NAME, fixture_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1665:8
1664	        app_config = apps.get_containing_app_config(type(self).__module__)
1665	        assert app_config is not None
1666	        return app_config.name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1672:8
1671	    def setUp(self) -> None:
1672	        assert (
1673	            self.migrate_from and self.migrate_to
1674	        ), f"TestCase '{type(self).__name__}' must define migrate_from and migrate_to properties"
1675	        migrate_from: List[Tuple[str, str]] = [(self.app, self.migrate_from)]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_console_output.py:62:8
61	
62	        assert isinstance(self.console_log_handler, logging.StreamHandler)
63	        assert self.console_log_handler.stream == sys.stderr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_console_output.py:63:8
62	        assert isinstance(self.console_log_handler, logging.StreamHandler)
63	        assert self.console_log_handler.stream == sys.stderr
64	        self.extra_output_finder = extra_output_finder

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_fixtures.py:6:0
5	import shutil
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\test_fixtures.py:369:4
368	    commands = "\n".join(f"DROP DATABASE IF EXISTS {db};" for db in databases_to_drop)
369	    subprocess.run(
370	        ["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost", "postgres", "zulip_test"],
371	        input=commands,
372	        check=True,
373	        universal_newlines=True,
374	    )
375	    return len(databases_to_drop)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_fixtures.py:369:4
368	    commands = "\n".join(f"DROP DATABASE IF EXISTS {db};" for db in databases_to_drop)
369	    subprocess.run(
370	        ["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost", "postgres", "zulip_test"],
371	        input=commands,
372	        check=True,
373	        universal_newlines=True,
374	    )
375	    return len(databases_to_drop)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_fixtures.py:401:4
400	    # Make sure default database is 'zulip_test'.
401	    assert connections["default"].settings_dict["NAME"] == "zulip_test"
402	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:212:4
211	    avatar_url_path = avatar_url(user_profile, medium)
212	    assert avatar_url_path is not None
213	    avatar_disk_path = os.path.join(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:236:12
235	            match = key_regex.search(message.body)
236	            assert match is not None
237	            [key] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:450:8
449	
450	        assert len(pattern_cnt) > 100
451	        untested_patterns = {p.replace("\\", "") for p in pattern_cnt if pattern_cnt[p] == 0}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:522:4
521	def load_subdomain_token(response: HttpResponse) -> ExternalAuthDataDict:
522	    assert isinstance(response, HttpResponseRedirect)
523	    token = response.url.rsplit("/", 1)[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:525:4
524	    data = ExternalAuthResult(login_token=token, delete_stored_data=False).data_dict
525	    assert data is not None
526	    return data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:696:8
695	        marshalled_event = orjson.loads(orjson.dumps(event))
696	        assert marshalled_event == event
697	        inner(queue_name, event, processor)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\test_runner.py:31:28
30	# below hack, which fails 1/10000000 of the time.
31	random_id_range_start = str(random.randint(1, 10000000))
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_runner.py:253:8
252	        # definitions.
253	        assert not isinstance(self.subsuites, SubSuiteList)
254	        self.subsuites: Union[SubSuiteList, List[TestSuite]] = SubSuiteList(self.subsuites)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_runner.py:449:8
448	        # implementation details.
449	        assert isinstance(suite.subsuites, SubSuiteList)
450	        return [name for subsuite in suite.subsuites for name in subsuite[1]]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\tex.py:3:0
2	import os
3	import subprocess
4	from typing import Optional

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\tex.py:37:17
36	    try:
37	        stdout = subprocess.check_output(
38	            command, input=tex, stderr=subprocess.DEVNULL, universal_newlines=True
39	        )
40	        # stdout contains a newline at the end

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:60:12
59	            # Attempt to raise a TimeoutExpired in the thread represented by 'self'.
60	            assert self.ident is not None  # Thread should be running; c_long expects int
61	            tid = ctypes.c_long(self.ident)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:95:4
94	        raise thread.exc_info[1].with_traceback(thread.exc_info[2])
95	    assert thread.result is not None  # assured if above did not reraise
96	    return thread.result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\unminify.py:22:8
21	        # Prevent path traversal
22	        assert ".." not in minified_src and "/" not in minified_src
23	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:99:4
98	    value = re.sub(r"[-\s]+", "-", value)
99	    assert value not in {"", ".", ".."}
100	    return mark_safe(value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:181:12
180	        if image_format == "GIF":
181	            assert isinstance(im, GifImageFile)
182	            # There are a number of bugs in Pillow.GifImagePlugin which cause

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:424:8
423	        split_url = urllib.parse.urlsplit(foo_url)
424	        assert split_url.path.endswith(f"/{DUMMY_KEY}")
425	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:434:8
433	    ) -> str:
434	        assert not key.startswith("/")
435	        return urllib.parse.urljoin(self.public_upload_url_base, key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:705:12
704	            )
705	            assert still_image_data is not None
706	            upload_image_to_s3(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:719:12
718	            # We currently only support animated GIFs.
719	            assert emoji_file_name.endswith(".gif")
720	            emoji_path = RealmEmoji.STILL_PATH_ID_TEMPLATE.format(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:751:8
750	    def delete_export_tarball(self, export_path: str) -> Optional[str]:
751	        assert export_path.startswith("/")
752	        path_id = export_path[1:]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'local_file_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\lib\upload.py:794:31
793	
794	LOCAL_FILE_ACCESS_TOKEN_SALT = "local_file_"
795	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\upload.py:825:23
824	                realm_id,
825	                format(random.randint(0, 255), "x"),
826	                secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:961:12
960	        if is_animated:
961	            assert still_image_data is not None
962	            still_path = RealmEmoji.STILL_PATH_ID_TEMPLATE.format(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:972:12
971	            # We currently only support animated GIFs.
972	            assert emoji_file_name.endswith(".gif")
973	            return os.path.join(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:1008:8
1007	        # Get the last element of a list in the form ['user_avatars', '<file_path>']
1008	        assert export_path.startswith("/")
1009	        file_path = export_path[1:].split("/", 1)[-1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_agent.py:18:4
17	    match = pattern.match(user_agent)
18	    assert match is not None
19	    return match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:165:8
164	    if base_query is None:
165	        assert realm is not None
166	        query = UserProfile.objects.filter(realm=realm, is_active=True)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\users.py:187:15
186	        where_clause = "upper(zerver_userprofile.email::text) IN (SELECT upper(email) FROM unnest(%s) AS email)"
187	        return query.select_related("realm").extra(where=[where_clause], params=(emails,))
188	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:326:8
325	        # Put an assertion so that mypy doesn't complain.
326	        assert field_data is not None
327	        return choice_field_validator(var_name, field_data, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:95:4
94	def assert_is_not_none(value: Optional[T]) -> T:
95	    assert value is not None
96	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:213:12
212	            valid_item = sub_validator(vname, item)
213	            assert item is valid_item  # To justify the unchecked cast below
214	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:276:16
275	                valid_value = value_validator(vname, val[key])
276	                assert val[key] is valid_value  # To justify the unchecked cast below
277	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:384:8
383	        valid_value = validator("field_data", value)
384	        assert value is valid_value  # To justify the unchecked cast below
385	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:460:4
459	
460	    assert isinstance(poll_data, dict)
461	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:503:4
502	
503	    assert isinstance(todo_data, dict)
504	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:111:4
110	    client = RequestNotes.get_notes(request).client
111	    assert client is not None
112	    if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:113:8
112	    if stream is None:
113	        assert user_profile.bot_owner is not None
114	        check_send_private_message(user_profile, client, user_profile.bot_owner, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:167:4
166	) -> Optional[str]:
167	    assert request.user.is_authenticated
168	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\logging_handlers.py:5:0
4	import platform
5	import subprocess
6	import traceback

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\logging_handlers.py:24:15
23	    try:  # nocoverage
24	        return subprocess.check_output(
25	            ["git", "describe", "--tags", "--match=[0-9]*", "--always", "--dirty", "--long"],
26	            stderr=subprocess.PIPE,
27	            cwd=os.path.join(os.path.dirname(__file__), ".."),
28	            universal_newlines=True,
29	        ).strip()
30	    except (FileNotFoundError, subprocess.CalledProcessError):  # nocoverage

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\logging_handlers.py:24:15
23	    try:  # nocoverage
24	        return subprocess.check_output(
25	            ["git", "describe", "--tags", "--match=[0-9]*", "--always", "--dirty", "--long"],
26	            stderr=subprocess.PIPE,
27	            cwd=os.path.join(os.path.dirname(__file__), ".."),
28	            universal_newlines=True,
29	        ).strip()
30	    except (FileNotFoundError, subprocess.CalledProcessError):  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\add_scim_client.py:18:8
17	        realm = self.get_realm(options)
18	        assert realm
19	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\add_users_to_streams.py:22:8
21	        realm = self.get_realm(options)
22	        assert realm is not None  # Should be ensured by parser
23	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\backup.py:104:12
103	
104	            assert not any("|" in name or "|" in path for name, path in paths)
105	            transform_args = [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\change_realm_subdomain.py:17:8
16	        realm = self.get_realm(options)
17	        assert realm is not None  # Should be ensured by parser
18	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\compilemessages.py:4:0
3	import re
4	from subprocess import CalledProcessError, check_output
5	from typing import Any, Dict, List

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\compilemessages.py:73:17
72	    def get_locales(self) -> List[str]:
73	        output = check_output(["git", "ls-files", "locale"], universal_newlines=True)
74	        tracked_files = output.split()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\compilemessages.py:73:17
72	    def get_locales(self) -> List[str]:
73	        output = check_output(["git", "ls-files", "locale"], universal_newlines=True)
74	        tracked_files = output.split()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_default_stream_groups.py:39:8
38	        realm = self.get_realm(options)
39	        assert realm is not None  # Should be ensured by parser
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_stream.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_user.py:66:8
65	        realm = self.get_realm(options)
66	        assert realm is not None  # Should be ensured by parser
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\deactivate_realm.py:20:8
19	
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\delete_realm.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\edit_linkifiers.py:44:8
43	        realm = self.get_realm(options)
44	        assert realm is not None  # Should be ensured by parser
45	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\email_mirror.py:66:16
65	                status, msg_data = mbox.fetch(message_id, "(RFC822)")
66	                assert isinstance(msg_data[0], tuple)
67	                msg_as_bytes = msg_data[0][1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\email_mirror.py:70:16
69	                # https://github.com/python/typeshed/issues/2417
70	                assert isinstance(message, EmailMessage)
71	                yield message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\export.py:111:8
110	        realm = self.get_realm(options)
111	        assert realm is not None  # Should be ensured by parser
112	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export_single_user.py:3:0
2	import shutil
3	import subprocess
4	import tempfile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export_single_user.py:42:8
41	        tarball_path = output_dir.rstrip("/") + ".tar.gz"
42	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
43	        print(f"Tarball written to {tarball_path}")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export_single_user.py:42:8
41	        tarball_path = output_dir.rstrip("/") + ".tar.gz"
42	        subprocess.check_call(["tar", "--strip-components=1", "-czf", tarball_path, output_dir])
43	        print(f"Tarball written to {tarball_path}")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\import.py:3:0
2	import os
3	import subprocess
4	from typing import Any

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\import.py:57:8
56	        call_command("flush", verbosity=0, interactive=False)
57	        subprocess.check_call([os.path.join(settings.DEPLOY_ROOT, "scripts/setup/flush-memcached")])
58	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\makemessages.py:39:0
38	import re
39	import subprocess
40	from typing import Any, Collection, Dict, Iterator, List, Mapping

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\makemessages.py:202:20
201	
202	        extracted = subprocess.check_output(
203	            [
204	                "node_modules/.bin/formatjs",
205	                "extract",
206	                "--additional-function-names=$t,$t_html",
207	                "--format=simple",
208	                "--ignore=**/*.d.ts",
209	                "static/js/**/*.js",
210	                "static/js/**/*.ts",
211	            ]
212	        )
213	        translation_strings.extend(json.loads(extracted).values())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\makemessages.py:202:20
201	
202	        extracted = subprocess.check_output(
203	            [
204	                "node_modules/.bin/formatjs",
205	                "extract",
206	                "--additional-function-names=$t,$t_html",
207	                "--format=simple",
208	                "--ignore=**/*.d.ts",
209	                "static/js/**/*.js",
210	                "static/js/**/*.ts",
211	            ]
212	        )
213	        translation_strings.extend(json.loads(extracted).values())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\merge_streams.py:36:8
35	        realm = self.get_realm(options)
36	        assert realm is not None  # Should be ensured by parser
37	        stream_to_keep = get_stream(options["stream_to_keep"], realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\process_queue.py:80:12
79	                td.start()
80	            assert len(queues) == cnt
81	            logger.info("%d queue worker threads were launched", cnt)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\reactivate_realm.py:16:8
15	        realm = self.get_realm(options)
16	        assert realm is not None  # Should be ensured by parser
17	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:29:8
28	        realm = self.get_realm(options)
29	        assert realm is not None  # Should be ensured by parser
30	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:39:8
38	
39	        assert isinstance(options["domain"], str)
40	        domain = options["domain"].strip().lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:46:12
45	        if options["op"] == "add":
46	            assert isinstance(options["allow_subdomains"], bool)
47	            try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\register_server.py:1:0
1	import subprocess
2	from argparse import ArgumentParser
3	from typing import Any

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\register_server.py:112:16
111	                print(f"Success! Updating {SECRETS_FILENAME} with the new key...")
112	                subprocess.check_call(
113	                    [
114	                        "crudini",
115	                        "--set",
116	                        SECRETS_FILENAME,
117	                        "secrets",
118	                        "zulip_org_key",
119	                        request["new_org_key"],
120	                    ]
121	                )
122	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\register_server.py:112:16
111	                print(f"Success! Updating {SECRETS_FILENAME} with the new key...")
112	                subprocess.check_call(
113	                    [
114	                        "crudini",
115	                        "--set",
116	                        SECRETS_FILENAME,
117	                        "secrets",
118	                        "zulip_org_key",
119	                        request["new_org_key"],
120	                    ]
121	                )
122	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\remove_users_from_stream.py:23:8
22	        realm = self.get_realm(options)
23	        assert realm is not None  # Should be ensured by parser
24	        user_profiles = self.get_users(options, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\rename_stream.py:21:8
20	        realm = self.get_realm(options)
21	        assert realm is not None  # Should be ensured by parser
22	        old_name = options["old_name"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\runtornado.py:53:8
52	        addrport = options["addrport"]
53	        assert isinstance(addrport, str)
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\runtornado.py:87:16
86	                queue_client = get_queue_client()
87	                assert isinstance(queue_client, TornadoQueueClient)
88	                # Process notifications received via RabbitMQ

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\scrub_realm.py:16:8
15	        realm = self.get_realm(options)
16	        assert realm is not None  # Should be ensured by parser
17	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_realm_reactivation_email.py:18:8
17	        realm = self.get_realm(options)
18	        assert realm is not None
19	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_to_email_mirror.py:105:16
104	                # https://github.com/python/typeshed/issues/2417
105	                assert isinstance(message, EmailMessage)
106	                return message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\show_admins.py:17:8
16	        realm = self.get_realm(options)
17	        assert realm is not None  # True because of required=True above
18	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:67:4
66	    log_data = RequestNotes.get_notes(request).log_data
67	    assert log_data is not None
68	    record_request_stop_data(log_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:83:4
82	    log_data = RequestNotes.get_notes(request).log_data
83	    assert log_data is not None
84	    if "time_restarted" in log_data:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:164:4
163	) -> None:
164	    assert error_content is None or error_content_iter is None
165	    if error_content is not None:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\middleware.py:282:23
281	        log_data["prof"].disable()
282	        profile_path = "/tmp/profile.data.{}.{}".format(path.split("/")[-1], int(time_delta * 1000))
283	        log_data["prof"].dump_stats(profile_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:287:8
286	    if 400 <= status_code < 500 and status_code not in [401, 404, 405]:
287	        assert error_content_iter is not None
288	        error_content_list = list(error_content_iter)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:351:12
350	            # Tornado code path that returns responses asynchronously.
351	            assert request_notes.saved_response is not None
352	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:379:8
378	        # importing modules on the first start)
379	        assert request_notes.log_data is not None
380	        request_notes.log_data["startup_time_delta"] = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:410:12
409	        if response.streaming:
410	            assert isinstance(response, StreamingHttpResponse)
411	            content_iter: Optional[Iterator[bytes]] = response.streaming_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:417:8
416	
417	        assert request_notes.client_name is not None and request_notes.log_data is not None
418	        write_log_line(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:516:8
515	            patch_vary_headers(response, ("Accept-Language",))
516	        assert language is not None
517	        response.setdefault("Content-Language", language)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:631:4
630	    ).placeholder_open_graph_description
631	    assert placeholder_open_graph_description is not None
632	    return content.replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:644:12
643	        if RequestNotes.get_notes(request).placeholder_open_graph_description is not None:
644	            assert not response.streaming
645	            response.content = alter_content(request, response.content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:688:4
687	    # allowing free access to the SCIM API:
688	    assert valid_bearer_token
689	    assert scim_client_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:689:4
688	    assert valid_bearer_token
689	    assert scim_client_name
690	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:695:4
694	    request_notes = RequestNotes.get_notes(request)
695	    assert request_notes.realm
696	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:105:8
104	        # Since these users are in password_change_user_ids, this must not be None.
105	        assert earliest_password_change is not None
106	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'empty_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:140:40
139	
140	    AFFECTED_USER_TYPE_EMPTY_PASSWORD = "empty_password"
141	    AFFECTED_USER_TYPE_CHANGED_PASSWORD = "changed_password"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'changed_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:141:42
140	    AFFECTED_USER_TYPE_EMPTY_PASSWORD = "empty_password"
141	    AFFECTED_USER_TYPE_CHANGED_PASSWORD = "changed_password"
142	    MIGRATION_ID = "0209_user_profile_no_empty_password"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0237_rename_zulip_realm_to_zulipinternal.py:31:4
30	    welcome_bot = UserProfile.objects.get(email="welcome-bot@zulip.com")
31	    assert welcome_bot.realm.id == internal_realm.id
32	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\migrations\0257_fix_has_link_attribute.py:5:0
4	
5	import lxml
6	from django.db import migrations

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:67:4
66	    # so it's not worth writing code to fix them.
67	    assert not RealmAuditLog.objects.filter(event_type__in=unlikely_event_types).exists()
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:94:16
93	            if isinstance(old_value, dict):
94	                assert prop in improperly_marshalled_properties
95	                old_value = old_value["id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:97:16
96	            if isinstance(new_value, dict):
97	                assert prop in improperly_marshalled_properties
98	                new_value = new_value["id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:101:8
100	        # Sanity check that the original event has exactly the keys we expect.
101	        assert set(extra_data.keys()) <= {OLD_VALUE, NEW_VALUE}
102	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:113:4
112	    """
113	    assert user_ids
114	    clause = f"{field} IN %s"

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:115:12
114	    clause = f"{field} IN %s"
115	    query = query.extra(
116	        where=[clause],
117	        params=(tuple(user_ids),),
118	    )
119	    return query

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:178:4
177	    supported_backends = django.contrib.auth.get_backends()
178	    assert supported_backends is not None
179	    return supported_backends

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:1960:8
1959	
1960	        assert policy_value == Realm.POLICY_FULL_MEMBERS_ONLY
1961	        return not self.is_provisional_member

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:2488:12
2487	        return (
2488	            get_active_streams(realm)
2489	            .select_related()
2490	            .extra(where=[where_clause], params=(list(stream_names),))
2491	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2518:4
2517	def get_huddle_user_ids(recipient: Recipient) -> List[int]:
2518	    assert recipient.type == Recipient.HUDDLE
2519	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2534:4
2533	    """
2534	    assert all(recipient.type == Recipient.HUDDLE for recipient in recipients)
2535	    if not recipients:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2783:20
2782	                for r in get_display_recipient(self.recipient):
2783	                    assert not isinstance(r, str)  # It will only be a string for streams
2784	                    if not r["id"] == self.user_profile_id:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:3346:4
3345	        return get_system_bot(email, realm.id)
3346	    assert realm is not None
3347	    return get_user(email, realm)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\javascript_examples.py:9:0
8	import os
9	import subprocess
10	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\javascript_examples.py:21:13
20	
21	    output = subprocess.check_output(
22	        args=["node", "--unhandled-rejections=strict", "zerver/openapi/javascript_examples.js"],
23	        universal_newlines=True,
24	    )
25	    endpoint_responses = json.loads(output)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\markdown_extension.py:251:8
250	        # We currently don't have any non-JSON encoded arrays.
251	        assert jsonify
252	        if curl_argument:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:44:12
43	        if isinstance(b_value, list):
44	            assert isinstance(a_value, list)
45	            ret[key] = a_value + b_value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:47:12
46	        elif isinstance(b_value, dict):
47	            assert isinstance(a_value, dict)
48	            ret[key] = naively_merge(a_value, b_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:66:8
65	        ret = naively_merge_allOf_dict(ret)
66	        assert isinstance(subschemas, list)
67	        for subschema in subschemas:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:68:12
67	        for subschema in subschemas:
68	            assert isinstance(subschema, dict)
69	            ret = naively_merge(ret, naively_merge_allOf_dict(subschema))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:153:8
152	        self.check_reload()
153	        assert len(self._openapi) > 0
154	        return self._openapi

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:161:8
160	        self.check_reload()
161	        assert len(self._endpoints_dict) > 0
162	        return self._endpoints_dict

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:170:8
169	        self.check_reload()
170	        assert self._request_validator is not None
171	        return self._request_validator

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:489:8
488	    if likely_deprecated_parameter(description):
489	        assert argument["deprecated"]
490	    if "deprecated" in argument:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:491:8
490	    if "deprecated" in argument:
491	        assert likely_deprecated_parameter(description)
492	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:63:4
62	
63	    assert ids_list == user_ids
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:95:4
94	    # {code_example|end}
95	    assert result["result"] == "success"
96	    assert "newbie@zulip.com" in result["subscribed"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:96:4
95	    assert result["result"] == "success"
96	    assert "newbie@zulip.com" in result["subscribed"]
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:164:4
163	
164	    assert result["result"] == "success"
165	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:224:4
223	    members = [m for m in result["members"] if m["email"] == "newbie@zulip.com"]
224	    assert len(members) == 1
225	    newbie = members[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:226:4
225	    newbie = members[0]
226	    assert not newbie["is_admin"]
227	    assert newbie["full_name"] == "New User"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:227:4
226	    assert not newbie["is_admin"]
227	    assert newbie["full_name"] == "New User"
228	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:235:4
234	    validate_against_openapi_schema(result, "/users", "get", "200")
235	    assert result["members"][0]["avatar_url"] is not None
236	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:245:12
244	        if member["is_bot"]:
245	            assert member.get("profile_data", None) is None
246	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:247:12
246	        else:
247	            assert member.get("profile_data", None) is not None
248	        assert member["avatar_url"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:248:8
247	            assert member.get("profile_data", None) is not None
248	        assert member["avatar_url"] is None
249	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:524:4
523	
524	    assert result["result"] == "success"
525	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:541:4
540	
541	    assert result["result"] == "success"
542	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:554:4
553	    streams = [s for s in result["streams"] if s["name"] == "new stream"]
554	    assert streams[0]["description"] == "New stream for testing"
555	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:563:4
562	    validate_against_openapi_schema(result, "/streams", "get", "200")
563	    assert len(result["streams"]) == 5
564	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:581:4
580	    validate_against_openapi_schema(result, "/streams/{stream_id}", "patch", "200")
581	    assert result["result"] == "success"
582	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:594:4
593	    hamlet_user_group = [u for u in result["user_groups"] if u["name"] == "hamletcharacters"][0]
594	    assert hamlet_user_group["description"] == "Characters of Hamlet"
595	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:614:4
613	    # {code_example|end}
614	    assert result["subscribers"] == [11, 26]
615	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:620:4
619	    result = client.get_user_agent()
620	    assert result.startswith("ZulipPython/")
621	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:633:4
632	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]
633	    assert streams[0]["description"] == "New stream for testing"
634	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:650:4
649	    result = client.get_subscriptions()
650	    assert result["result"] == "success"
651	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:652:4
651	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]
652	    assert len(streams) == 0
653	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:824:4
823	    validate_against_openapi_schema(result, "/messages", "get", "200")
824	    assert len(result["messages"]) <= request["num_before"]
825	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:853:4
852	
853	    assert int(message_id)
854	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:913:4
912	    )
913	    assert result["result"] == "success"
914	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:914:4
913	    assert result["result"] == "success"
914	    assert result["raw_content"] == request["content"]
915	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:938:4
937	    )
938	    assert result["result"] == "success"
939	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:939:4
938	    assert result["result"] == "success"
939	    assert result["raw_content"] == request["content"]
940	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1000:4
999	
1000	    assert int(message_id)
1001	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1021:4
1020	    )
1021	    assert result["result"] == "success"
1022	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1022:4
1021	    assert result["result"] == "success"
1022	    assert result["raw_content"] == request["content"]
1023	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1331:4
1330	
1331	    assert result["result"] == "success"
1332	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1340:4
1339	
1340	    assert result["result"] == "success"
1341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1349:4
1348	
1349	    assert result["result"] == "success"
1350	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1367:4
1366	
1367	    assert result["result"] == "success"
1368	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1381:4
1380	    # {code_example|end}
1381	    assert result["result"] == "success"
1382	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1391:4
1390	    validate_against_openapi_schema(result, "/user_groups/{user_group_id}", "delete", "200")
1391	    assert result["result"] == "success"
1392	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\test_curl_examples.py:13:0
12	import shlex
13	import subprocess
14	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\test_curl_examples.py:101:36
100	                    # returns non-JSON output, we'll still print it.
101	                    response_json = subprocess.check_output(
102	                        generated_curl_command, universal_newlines=True
103	                    )
104	                    response = json.loads(response_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\test_curl_examples.py:105:20
104	                    response = json.loads(response_json)
105	                    assert response["result"] == "success"
106	                except (AssertionError, Exception):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_audit_log.py:156:19
155	        user = self.example_user("hamlet")
156	        password = "test1"
157	        do_change_password(user, password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:291:8
290	        modified_stream = subscription_creation_logs[0].modified_stream
291	        assert modified_stream is not None
292	        self.assertEqual(subscription_creation_logs.count(), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:305:8
304	        modified_stream = subscription_deactivation_logs[0].modified_stream
305	        assert modified_stream is not None
306	        self.assertEqual(subscription_deactivation_logs.count(), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:502:8
501	        audit_log = audit_entries.first()
502	        assert audit_log is not None
503	        self.assert_length(audit_entries, 1)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:264:19
263	        user_profile = self.example_user("hamlet")
264	        password = "testpassword"
265	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:302:19
301	        user_profile = self.example_user("hamlet")
302	        password = "testpassword"
303	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:318:19
317	        # Now do the same test with the empty string as the password.
318	        password = ""
319	        with self.assertRaises(PasswordTooWeakError):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:337:19
336	        user_profile = self.example_user("hamlet")
337	        password = "testpassword"
338	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:353:19
352	        user_profile = self.example_user("hamlet")
353	        password = "a_password_of_22_chars"
354	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:382:8
381	        self.assert_in_response(realm.description, result)
382	        assert realm.name is not None
383	        self.assert_in_response(realm.name, result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:435:12
434	        self.assertIsNone(
435	            backend.authenticate(
436	                request=mock.MagicMock(),
437	                username=email,
438	                password="wrongpass",
439	                realm=get_realm("zulip"),
440	            )
441	        )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:679:19
678	        user_profile = self.example_user("hamlet")
679	        password = "testpassword"
680	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'email_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:741:25
740	
741	        email_password = "email_password"
742	        user_profile.set_password(email_password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1005:8
1004	        self.assertEqual(result.status_code, 302)
1005	        assert self.AUTHORIZATION_URL in result.url
1006	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1366:8
1365	        confirmation = Confirmation.objects.all().last()
1366	        assert confirmation is not None
1367	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1555:8
1554	        multiuse_confirmation = Confirmation.objects.all().last()
1555	        assert multiuse_confirmation is not None
1556	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1868:8
1867	        self.assertEqual(result.status_code, 302)
1868	        assert self.AUTHORIZATION_URL in result.url
1869	        assert "samlrequest" in result.url.lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1869:8
1868	        assert self.AUTHORIZATION_URL in result.url
1869	        assert "samlrequest" in result.url.lower()
1870	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1876:8
1875	        data = SAMLAuthBackend.get_data_from_redis(orjson.loads(relay_state)["state_token"])
1876	        assert data is not None
1877	        if next:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://appleid.apple.com/auth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:2866:23
2865	    AUTHORIZATION_URL = "https://appleid.apple.com/auth/authorize"
2866	    ACCESS_TOKEN_URL = "https://appleid.apple.com/auth/token"
2867	    AUTH_FINISH_URL = "/complete/apple/"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'invalid'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:3158:27
3157	        def initiate_auth(mobile_flow_otp: Optional[str] = None) -> None:
3158	            url, headers = self.prepare_login_url_and_headers(
3159	                subdomain="zulip",
3160	                id_token="invalid",
3161	                mobile_flow_otp=mobile_flow_otp,
3162	                account_data_dict=account_data_dict,
3163	            )
3164	            result = self.client_get(url, **headers)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_TESTOIDC_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3239:28
3238	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_TESTOIDC_KEY"
3239	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_TESTOIDC_SECRET"
3240	    LOGIN_URL = "/accounts/login/social/oidc"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GITHUB_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3423:28
3422	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GITHUB_KEY"
3423	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GITHUB_SECRET"
3424	    LOGIN_URL = "/accounts/login/social/github"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://github.com/login/oauth/access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3427:23
3426	    AUTHORIZATION_URL = "https://github.com/login/oauth/authorize"
3427	    ACCESS_TOKEN_URL = "https://github.com/login/oauth/access_token"
3428	    USER_INFO_URL = "https://api.github.com/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GITLAB_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3944:28
3943	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GITLAB_KEY"
3944	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GITLAB_SECRET"
3945	    LOGIN_URL = "/accounts/login/social/gitlab"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://gitlab.com/oauth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3948:23
3947	    AUTHORIZATION_URL = "https://gitlab.com/oauth/authorize"
3948	    ACCESS_TOKEN_URL = "https://gitlab.com/oauth/token"
3949	    USER_INFO_URL = "https://gitlab.com/api/v4/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GOOGLE_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3965:28
3964	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GOOGLE_KEY"
3965	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GOOGLE_SECRET"
3966	    LOGIN_URL = "/accounts/login/social/google"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://accounts.google.com/o/oauth2/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3969:23
3968	    AUTHORIZATION_URL = "https://accounts.google.com/o/oauth2/auth"
3969	    ACCESS_TOKEN_URL = "https://accounts.google.com/o/oauth2/token"
3970	    USER_INFO_URL = "https://www.googleapis.com/oauth2/v3/userinfo"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'nonsense'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4120:21
4119	        with self.assertLogs(level="WARNING") as m:
4120	            result = self.get_log_into_subdomain(data, force_token="nonsense")
4121	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4174:8
4173	        confirmation = Confirmation.objects.all().first()
4174	        assert confirmation is not None
4175	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4210:8
4209	        confirmation = Confirmation.objects.all().first()
4210	        assert confirmation is not None
4211	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4260:8
4259	        multiuse_confirmation = Confirmation.objects.all().last()
4260	        assert multiuse_confirmation is not None
4261	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4268:8
4267	        confirmation = Confirmation.objects.all().last()
4268	        assert confirmation is not None
4269	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4337:57
4336	        self.login_user(user)
4337	        result = self.client_post("/json/fetch_api_key", dict(password="wrong"))
4338	        self.assert_json_error(result, "Your username or password is incorrect.", 400)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4373:37
4372	        result = self.client_post(
4373	            "/api/v1/fetch_api_key", dict(username=self.email, password="wrong")
4374	        )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4534:19
4533	        user_profile = self.example_user("hamlet")
4534	        password = "a_password_of_22_chars"
4535	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:5526:19
5525	        user_profile = self.example_user("hamlet")
5526	        password = "testpassword"
5527	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dapu'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5625:27
5624	        ):
5625	            user_profile = self.backend.authenticate(
5626	                request=mock.MagicMock(),
5627	                username="ldapuser1",
5628	                password="dapu",
5629	                realm=get_realm("zulip"),
5630	            )
5631	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5632:12
5631	
5632	            assert user_profile is None
5633	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5644:12
5643	
5644	            assert user_profile is not None
5645	            self.assertEqual(user_profile.delivery_email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5657:12
5656	
5657	            assert user_profile is not None
5658	            self.assertEqual(user_profile, self.example_user("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5671:12
5670	
5671	            assert user_profile is not None
5672	            self.assertEqual(user_profile, self.example_user("aaron"))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:5700:23
5699	            othello = self.example_user("othello")
5700	            password = "testpassword"
5701	            othello.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5716:19
5715	        with self.settings(LDAP_APPEND_DOMAIN="zulip.com"):
5716	            user = self.backend.authenticate(
5717	                request=mock.MagicMock(),
5718	                username=self.example_email("hamlet"),
5719	                password="wrong",
5720	                realm=get_realm("zulip"),
5721	            )
5722	            self.assertIs(user, None)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'doesnt_matter'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5729:19
5728	        ) as log_debug:
5729	            user = self.backend.authenticate(
5730	                request=mock.MagicMock(),
5731	                username="nonexistent@zulip.com",
5732	                password="doesnt_matter",
5733	                realm=get_realm("zulip"),
5734	            )
5735	            self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5912:12
5911	            )
5912	            assert user_profile is not None
5913	            self.assertEqual(user_profile.delivery_email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5944:12
5943	            )
5944	            assert user_profile is not None
5945	            self.assertEqual(user_profile.delivery_email, "newuser@acme.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5952:12
5951	            url = avatar_url(user_profile)
5952	            assert url is not None
5953	            result = self.client_get(url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5968:12
5967	            )
5968	            assert user_profile is not None
5969	            self.assertEqual(user_profile.delivery_email, "newuser_splitname@zulip.com")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5997:13
5996	        """
5997	        with self.settings(
5998	            LDAP_DEACTIVATE_NON_MATCHING_USERS=True,
5999	            LDAP_APPEND_DOMAIN="zulip.com",
6000	            AUTH_LDAP_BIND_PASSWORD="wrongpass",
6001	        ):
6002	            with self.assertRaises(ldap.INVALID_CREDENTIALS):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6538:12
6537	            confirmation = Confirmation.objects.all().first()
6538	            assert confirmation is not None
6539	            confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6571:12
6570	            confirmation = Confirmation.objects.all().last()
6571	            assert confirmation is not None
6572	            confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:304:8
303	        profile = get_user(email, realm)
304	        assert profile.default_sending_stream is not None
305	        self.assertEqual(profile.default_sending_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:317:8
316	        profile = get_user(email, realm)
317	        assert profile.default_sending_stream is not None
318	        self.assertEqual(profile.default_sending_stream.name, "Rome")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:435:8
434	        profile = get_user(email, realm)
435	        assert profile.default_sending_stream is not None
436	        self.assertEqual(profile.default_sending_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:488:8
487	        profile = get_user(bot_email, bot_realm)
488	        assert profile.default_events_register_stream is not None
489	        self.assertEqual(profile.default_events_register_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:507:8
506	        bot_profile = get_user(bot_email, bot_realm)
507	        assert bot_profile.default_events_register_stream is not None
508	        self.assertEqual(bot_profile.default_events_register_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_cache.py:154:8
153	        last_user = UserProfile.objects.last()
154	        assert last_user is not None
155	        last_user_id = last_user.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_compatibility.py:51:16
50	            else:
51	                assert False  # nocoverage
52	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_compatibility.py:110:16
109	            else:
110	                assert False  # nocoverage
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_custom_profile_data.py:749:8
748	        self.login_user(iago)
749	        assert test_bot
750	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1057:24
1056	        user_profile = self.example_user("hamlet")
1057	        test_password = "abcd1234"
1058	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1144:57
1143	        self.login("cordelia")
1144	        result = self.client_post("/json/fetch_api_key", dict(password="wrong_password"))
1145	        self.assert_json_error_contains(result, "password is incorrect")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1204:24
1203	        email = user_profile.delivery_email
1204	        test_password = "abcd1234"
1205	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1424:17
1423	    def test_valid_internal_requests(self) -> None:
1424	        secret = "random"
1425	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1455:17
1454	    def test_internal_requests_with_broken_secret(self) -> None:
1455	        secret = "random"
1456	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'broken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1461:13
1460	
1461	        with self.settings(SHARED_SECRET="broken"):
1462	            self.assertFalse(authenticate_notify(request))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1468:17
1467	    def test_external_requests(self) -> None:
1468	        secret = "random"
1469	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1622:8
1621	        bot.save()
1622	        self.login_by_email(bot.email, password="test")
1623	        self.assert_json_error_contains(self._do_test(bot), "Webhook bots can only access webhooks")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1742:12
1741	            request.session = self.client.session
1742	            assert type(request.user) is UserProfile
1743	            self.create_default_device(request.user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1772:12
1771	            request.session = self.client.session
1772	            assert type(request.user) is UserProfile
1773	            self.create_default_device(request.user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1948:16
1947	                match = re.match('^(?P<count>[0-9]+) "(?P<user_agent>.*)"$', line)
1948	                assert match is not None
1949	                groupdict = match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_digest.py:272:8
271	
272	        assert len(users) >= 5
273	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_digest.py:395:8
394	        num_queued_users = len(queue_mock.call_args[0][0])
395	        assert num_queued_users >= 5
396	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_email_mirror.py:4:0
3	import os
4	import subprocess
5	from email import message_from_string

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:1280:8
1279	        mail = mail_template.format(stream_to_address=stream_to_address, sender=sender)
1280	        subprocess.run(
1281	            [script, "-r", stream_to_address, "-s", settings.SHARED_SECRET, "-t"],
1282	            input=mail,
1283	            check=True,
1284	            universal_newlines=True,
1285	        )
1286	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:1295:12
1294	        mail = mail_template.format(stream_to_address=stream_to_address, sender=sender)
1295	        p = subprocess.run(
1296	            [script, "-s", settings.SHARED_SECRET, "-t"],
1297	            input=mail,
1298	            stdout=subprocess.PIPE,
1299	            universal_newlines=True,
1300	        )
1301	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:1452:8
1451	        # https://github.com/python/typeshed/issues/2417
1452	        assert isinstance(incoming_message, EmailMessage)
1453	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\tests\test_email_notifications.py:10:0
9	import ldap
10	import lxml.html
11	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1374:12
1373	            output_data = lxml.html.tostring(fragment, encoding="unicode")
1374	            assert "spoiler-header" not in output_data
1375	            assert "spoiler-content" not in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1375:12
1374	            assert "spoiler-header" not in output_data
1375	            assert "spoiler-content" not in output_data
1376	            assert "spoiler-block" in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1376:12
1375	            assert "spoiler-content" not in output_data
1376	            assert "spoiler-block" in output_data
1377	            assert "spoiler-title" in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1377:12
1376	            assert "spoiler-block" in output_data
1377	            assert "spoiler-title" in output_data
1378	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:30:8
29	    def test_pm_to_embedded_bot(self) -> None:
30	        assert self.bot_profile is not None
31	        self.send_personal_message(self.user_profile, self.bot_profile, content="help")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:36:8
35	        display_recipient = get_display_recipient(last_message.recipient)
36	        assert isinstance(display_recipient, list)
37	        self.assert_length(display_recipient, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:41:8
40	    def test_stream_message_to_embedded_bot(self) -> None:
41	        assert self.bot_profile is not None
42	        self.send_stream_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:61:8
60	    def test_message_to_embedded_bot_with_initialize(self) -> None:
61	        assert self.bot_profile is not None
62	        with patch(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:74:8
73	    def test_embedded_bot_quit_exception(self) -> None:
74	        assert self.bot_profile is not None
75	        with patch(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_event_system.py:701:16
700	            def accepts_event(self, event: Dict[str, Any]) -> bool:
701	                assert event["type"] == "message"
702	                return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:450:8
449	        check_message("events[0]", events[0])
450	        assert isinstance(events[0]["message"]["avatar_url"], str)
451	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:457:8
456	        check_message("events[0]", events[0])
457	        assert events[0]["message"]["avatar_url"] is None
458	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1183:8
1182	        mute_object = get_mute_object(self.user_profile, muted_user)
1183	        assert mute_object is not None
1184	        # This is a hack to silence mypy errors which result from it not taking

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1199:8
1198	        check_realm_user_update("events[0]", events[0], "avatar_fields")
1199	        assert isinstance(events[0]["person"]["avatar_url"], str)
1200	        assert isinstance(events[0]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1200:8
1199	        assert isinstance(events[0]["person"]["avatar_url"], str)
1200	        assert isinstance(events[0]["person"]["avatar_url_medium"], str)
1201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1233:8
1232	        check_realm_user_update("events[1]", events[1], "avatar_fields")
1233	        assert isinstance(events[1]["person"]["avatar_url"], str)
1234	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1234:8
1233	        assert isinstance(events[1]["person"]["avatar_url"], str)
1234	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)
1235	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1253:8
1252	        check_realm_user_update("events[2]", events[2], "email")
1253	        assert isinstance(events[1]["person"]["avatar_url"], str)
1254	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1254:8
1253	        assert isinstance(events[1]["person"]["avatar_url"], str)
1254	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)
1255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1631:8
1630	        last_realm_playground = RealmPlayground.objects.last()
1631	        assert last_realm_playground is not None
1632	        last_id = last_realm_playground.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1989:8
1988	        self.subscribe(hamlet, "Denmark")
1989	        assert uri is not None
1990	        body = f"First message ...[zulip.txt](http://{hamlet.realm.host}" + uri + ")"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:2049:8
2048	        ).first()
2049	        assert audit_log_entry is not None
2050	        audit_log_entry_id = audit_log_entry.id

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_example.py:164:17
163	
164	        params = dict(
165	            email="romeo@zulip.net",
166	            password="xxxx",
167	            full_name="Romeo Montague",
168	        )
169	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_example.py:191:23
190	        do_change_can_create_users(iago, False)
191	        valid_params = dict(
192	            email="romeo@zulip.net",
193	            password="xxxx",
194	            full_name="Romeo Montague",
195	        )
196	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_example.py:253:8
252	        row = UserStatus.objects.last()
253	        assert row is not None
254	        self.assertEqual(row.user_profile_id, cordelia.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_external.py:312:8
311	        # Having closed it, it's now cached.  Clear the cache.
312	        assert CircuitBreakerMonitor.get("get_tor_ips").closed
313	        cache_delete("tor_ip_addresses:")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:545:15
544	    def create_bot(self, owner: UserProfile, bot_email: str, bot_name: str) -> UserProfile:
545	        user = do_create_user(
546	            email=bot_email,
547	            password="123",
548	            realm=owner.realm,
549	            full_name=bot_name,
550	            bot_type=UserProfile.DEFAULT_BOT,
551	            bot_owner=owner,
552	            acting_user=None,
553	        )
554	        return user

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:557:15
556	    def create_non_active_user(self, realm: Realm, email: str, name: str) -> UserProfile:
557	        user = do_create_user(
558	            email=email, password="123", realm=realm, full_name=name, acting_user=None
559	        )
560	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:507:8
506	        realm_emoji.delete()
507	        assert message is not None
508	        full_data = self._export_realm(realm, consent_message_id=message.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:585:8
584	        # Third huddle is not exported since none of the members gave consent
585	        assert huddle_a is not None and huddle_b is not None
586	        huddle_recipients = Recipient.objects.filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:694:8
693	        recipient = stream.recipient
694	        assert recipient is not None
695	        add_topic_mute(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_import_export.py:715:22
714	        # data to test import of botstoragedata and botconfigdata
715	        bot_profile = do_create_user(
716	            email="bot-1@zulip.com",
717	            password="test",
718	            realm=original_realm,
719	            full_name="bot",
720	            bot_type=UserProfile.EMBEDDED_BOT,
721	            bot_owner=sample_user,
722	            acting_user=None,
723	        )
724	        storage = StateHandler(bot_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:751:12
750	            # the test is kind of meaningless
751	            assert orig_realm_result
752	            if equal:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_integrations.py:25:8
24	        integration = INTEGRATIONS["airbrake"]
25	        assert isinstance(integration, WebhookIntegration)
26	        screenshot_config = ScreenshotConfig("error_message.json", "002.png", "ci")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_integrations.py:33:8
32	        integration = INTEGRATIONS["nagios"]
33	        assert isinstance(integration, Integration)
34	        screenshot_config = BaseScreenshotConfig("service_notify.json", "001.png")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:82:8
81	        self.assertIn("title", data)
82	        assert data is not None  # allow mypy to infer data is indexable
83	        self.assertEqual(data["title"], response_data["title"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:112:8
111	        self.assertIn("title", data)
112	        assert data is not None  # allow mypy to infer data is indexable
113	        self.assertEqual(data["title"], response_data["title"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:141:8
140	        self.assertIn("title", data)
141	        assert data is not None  # allow mypy to infer data is indexable
142	        self.assertEqual(data["title"], response_data["title"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:138:8
137	        record = self.simulate_error()
138	        assert isinstance(record, HasRequest)
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:256:16
255	            for handler in logger.handlers:
256	                assert not isinstance(handler, AdminEmailHandler)
257	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_management_commands.py:209:8
208	        ]
209	        assert self.commands
210	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_management_commands.py:512:8
511	        message = Message.objects.last()
512	        assert message is not None
513	        do_add_reaction(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:217:19
216	        def make_user(email: str, full_name: str) -> UserProfile:
217	            return create_user(
218	                email=email,
219	                password="whatever",
220	                realm=realm,
221	                full_name=full_name,
222	            )
223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_markdown.py:275:8
274	        user = mention_data.get_user_by_name("king hamLET")
275	        assert user is not None
276	        self.assertEqual(user["email"], hamlet.email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:2142:19
2141	        def make_user(email: str, full_name: str) -> UserProfile:
2142	            return create_user(
2143	                email=email,
2144	                password="whatever",
2145	                realm=realm,
2146	                full_name=full_name,
2147	            )
2148	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:2197:20
2196	        # Create a user that potentially interferes with the pattern.
2197	        test_user = create_user(
2198	            email="atomic@example.com",
2199	            password="whatever",
2200	            realm=realm,
2201	            full_name="Atomic #123",
2202	        )
2203	        content = "@**Atomic #123**"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1360:12
1359	        for message in result["messages"]:
1360	            assert message["id"] in message_ids
1361	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1372:12
1371	        for message in result["messages"]:
1372	            assert message["id"] in message_ids
1373	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1723:12
1722	        def dr_emails(dr: DisplayRecipientT) -> str:
1723	            assert isinstance(dr, list)
1724	            return ",".join(sorted({*(r["email"] for r in dr), me.email}))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1727:12
1726	        def dr_ids(dr: DisplayRecipientT) -> List[int]:
1727	            assert isinstance(dr, list)
1728	            return sorted({*(r["id"] for r in dr), self.example_user("hamlet").id})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1923:8
1922	        stream_name = get_display_recipient(stream_messages[0].recipient)
1923	        assert isinstance(stream_name, str)
1924	        stream_id = get_stream(stream_name, stream_messages[0].get_realm()).id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:2562:16
2561	            for message in messages:
2562	                assert message["id"] in message_ids
2563	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:3311:8
3310	        stream = get_stream("Scotland", realm)
3311	        assert stream.recipient is not None
3312	        recipient_id = stream.recipient.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:37:4
36	    """
37	    assert "has_alert_word" not in expected
38	    flag_set = set(flags)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:377:12
376	            recipient = stream.recipient
377	            assert recipient is not None
378	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:470:12
469	        return list(
470	            UserMessage.objects.filter(
471	                user_profile=user_profile,
472	            )
473	            .extra(
474	                where=[UserMessage.where_active_push_notification()],
475	            )
476	            .order_by("message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:577:8
576	        recipient = stream.recipient
577	        assert recipient is not None
578	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:228:28
227	        # Bots without owner (except cross realm bot) cannot send to announcement only streams
228	        bot_without_owner = do_create_user(
229	            email="free-bot@zulip.testserver",
230	            password="",
231	            realm=non_admin_profile.realm,
232	            full_name="freebot",
233	            bot_type=UserProfile.DEFAULT_BOT,
234	            acting_user=None,
235	        )
236	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:308:28
307	        # Bots without owner (except cross realm bot) cannot send to STREAM_POST_POLICY_MODERATORS streams.
308	        bot_without_owner = do_create_user(
309	            email="free-bot@zulip.testserver",
310	            password="",
311	            realm=non_admin_profile.realm,
312	            full_name="freebot",
313	            bot_type=UserProfile.DEFAULT_BOT,
314	            acting_user=None,
315	        )
316	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:398:28
397	        # STREAM_POST_POLICY_RESTRICT_NEW_MEMBERS streams
398	        bot_without_owner = do_create_user(
399	            email="free-bot@zulip.testserver",
400	            password="",
401	            realm=non_admin_profile.realm,
402	            full_name="freebot",
403	            bot_type=UserProfile.DEFAULT_BOT,
404	            acting_user=None,
405	        )
406	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1312:8
1311	        # We subscribe the bot owner! (aka cordelia)
1312	        assert bot.bot_owner is not None
1313	        self.subscribe(bot.bot_owner, stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1686:8
1685	        message = most_recent_message(user_profile)
1686	        assert UserMessage.objects.get(
1687	            user_profile=user_profile, message=message
1688	        ).flags.mentioned.is_set
1689	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:1770:21
1769	
1770	        normal_bot = do_create_user(
1771	            email="normal-bot@zulip.com",
1772	            password="",
1773	            realm=realm,
1774	            full_name="Normal Bot",
1775	            bot_type=UserProfile.DEFAULT_BOT,
1776	            bot_owner=cordelia,
1777	            acting_user=None,
1778	        )
1779	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:2299:8
2298	        )
2299	        assert result is not None
2300	        message = result.message

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:2660:14
2659	        parent = self.example_user("othello")
2660	        bot = do_create_user(
2661	            email="othello-bot@zulip.com",
2662	            password="",
2663	            realm=parent.realm,
2664	            full_name="",
2665	            bot_type=UserProfile.DEFAULT_BOT,
2666	            bot_owner=parent,
2667	            acting_user=None,
2668	        )
2669	        bot.last_reminder = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:2698:8
2697	        # stream doesn't exist
2698	        assert sender.last_reminder is not None
2699	        sender.last_reminder = sender.last_reminder - datetime.timedelta(hours=1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_mirror_users.py:101:8
100	
101	        assert mirror_sender is not None
102	        self.assertEqual(mirror_sender.email, sender_email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:28:8
27	
28	        assert recipient is not None
29	        add_topic_mute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:60:12
59	        def mute_topic_for_user(user: UserProfile) -> None:
60	            assert recipient is not None
61	            add_topic_mute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:132:8
131	
132	        assert recipient is not None
133	        for data in payloads:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:156:8
155	        recipient = stream.recipient
156	        assert recipient is not None
157	        add_topic_mute(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_new_users.py:300:22
299	        ) -> None:
300	            user_no = random.randrange(100000)
301	            new_user = UserProfile.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:85:8
84	        }
85	        assert expected_item in actual
86	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:414:16
413	                # The only content-type we use in our API is application/json.
414	                assert "schema" in element["content"]["application/json"]
415	                # If content_type is application/json, then the

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:440:12
439	            # Tell mypy this is never None.
440	            assert function is not None
441	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:464:16
463	                vname = defval.post_var_name
464	                assert vname is not None
465	                if vname in json_params:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:486:8
485	        # After the above operations `json_params` should be empty.
486	        assert len(json_params) == 0
487	        diff = openapi_params - function_params

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:606:20
605	                    print(" -", accepted_arguments)
606	                    assert url_pattern in self.buggy_documentation_endpoints
607	                elif len(openapi_parameter_names - accepted_arguments) > 0:  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:611:20
610	                    print(" +", accepted_arguments)
611	                    assert url_pattern in self.buggy_documentation_endpoints
612	                else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:935:16
934	                # Check if every file has an operationId
935	                assert "operationId" in operation
936	                assert "tags" in operation

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:936:16
935	                assert "operationId" in operation
936	                assert "tags" in operation
937	                tag = operation["tags"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:938:16
937	                tag = operation["tags"][0]
938	                assert tag in VALID_TAGS
939	                for status_code, response in operation["responses"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:944:28
943	                            validate_schema(subschema)
944	                            assert validate_against_openapi_schema(
945	                                subschema["example"],
946	                                path,
947	                                method,
948	                                status_code + "_" + str(subschema_index),
949	                            )
950	                        continue

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:952:20
951	                    validate_schema(schema)
952	                    assert validate_against_openapi_schema(
953	                        schema["example"], path, method, status_code
954	                    )
955	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:965:8
964	        # some of the documented endpoints.
965	        assert find_openapi_endpoint("/users/me/presence") is None
966	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:966:8
965	        assert find_openapi_endpoint("/users/me/presence") is None
966	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None
967	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:967:8
966	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None
967	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None
968	        assert find_openapi_endpoint("/messages/matches_narrow") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:968:8
967	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None
968	        assert find_openapi_endpoint("/messages/matches_narrow") is None
969	        # Making sure documented endpoints are matched correctly.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:970:8
969	        # Making sure documented endpoints are matched correctly.
970	        assert (
971	            find_openapi_endpoint("/users/23/subscriptions/21")
972	            == "/users/{user_id}/subscriptions/{stream_id}"
973	        )
974	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:974:8
973	        )
974	        assert (
975	            find_openapi_endpoint("/users/iago@zulip.com/presence")
976	            == "/users/{user_id_or_email}/presence"
977	        )
978	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:978:8
977	        )
978	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"
979	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:979:8
978	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"
979	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"
980	        assert find_openapi_endpoint("/realm/emoji/realm_emoji_1") == "/realm/emoji/{emoji_name}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:980:8
979	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"
980	        assert find_openapi_endpoint("/realm/emoji/realm_emoji_1") == "/realm/emoji/{emoji_name}"
981	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:24:23
23	        service_class = get_service_interface_class("whatever")  # GenericOutgoingWebhookService
24	        self.handler = service_class(
25	            service_name="test-service", token="abcdef", user_profile=self.bot_user
26	        )
27	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:192:23
191	        service_class = get_service_interface_class(SLACK_INTERFACE)
192	        self.handler = service_class(
193	            token="abcdef", user_profile=self.bot_user, service_name="test-service"
194	        )
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:114:12
113	            final_response = do_rest_call("", mock_event, service_handler)
114	            assert final_response is not None
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:129:8
128	
129	        assert bot_user.bot_owner is not None
130	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:144:12
143	            final_response = do_rest_call("", mock_event, service_handler)
144	            assert final_response is not None
145	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:162:8
161	
162	        assert bot_user.bot_owner is not None
163	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:175:12
174	                final_response = do_rest_call("https://example.com/", mock_event, service_handler)
175	            assert final_response is not None
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:205:12
204	            self.assertIn("triggered", bot_owner_notification.content)
205	            assert bot_user.bot_owner is not None
206	            self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:248:8
247	        )
248	        assert bot_user.bot_owner is not None
249	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:277:8
276	            )
277	        assert bot_user.bot_owner is not None
278	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:304:8
303	            )
304	        assert bot_user.bot_owner is not None
305	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:333:8
332	            )
333	        assert bot_user.bot_owner is not None
334	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'weather_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:362:8
361	
362	        add_service(
363	            "weather",
364	            user_profile=bot,
365	            interface=Service.GENERIC,
366	            base_url="https://weather.example.com/",
367	            token="weather_token",
368	        )
369	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'qotd_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:370:8
369	
370	        add_service(
371	            "qotd",
372	            user_profile=bot,
373	            interface=Service.GENERIC,
374	            base_url="https://qotd.example.com/",
375	            token="qotd_token",
376	        )
377	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:108:8
107	    def request_callback(self, request: PreparedRequest) -> Tuple[int, ResponseHeaders, bytes]:
108	        assert isinstance(request.body, str) or request.body is None
109	        params: Dict[str, List[str]] = parse.parse_qs(request.body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:115:8
114	        data = {k: v[0] for k, v in params.items()}
115	        assert request.url is not None  # allow mypy to infer url is present.
116	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:116:8
115	        assert request.url is not None  # allow mypy to infer url is present.
116	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
117	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:126:8
125	        # Match any endpoint with the PUSH_NOTIFICATION_BOUNCER_URL.
126	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
127	        COMPILED_URL = re.compile(settings.PUSH_NOTIFICATION_BOUNCER_URL + ".*")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:133:16
132	        user_id = 10
133	        token = "111222"
134	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:143:16
142	    def test_unregister_remote_push_user_params(self) -> None:
143	        token = "111222"
144	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:168:16
167	    def test_register_remote_push_user_paramas(self) -> None:
168	        token = "111222"
169	        user_id = 11

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'aaaa'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:281:16
280	        server = RemoteZulipServer.objects.get(uuid=self.server_uuid)
281	        token = "aaaa"
282	        android_tokens = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:413:12
412	
413	            assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
414	            URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/register"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:507:8
506	        """
507	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
508	        ANALYTICS_URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/server/analytics"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:526:8
525	        audit_log = RealmAuditLog.objects.all().order_by("id").last()
526	        assert audit_log is not None
527	        audit_log_max_id = audit_log.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:719:8
718	        )
719	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
720	        ANALYTICS_URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/server/analytics"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:786:8
785	        remote_log_entry = RemoteRealmAuditLog.objects.order_by("id").last()
786	        assert remote_log_entry is not None
787	        self.assertEqual(remote_log_entry.server.uuid, self.server_uuid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:871:8
870	    def request_callback(self, request: PreparedRequest) -> Tuple[int, ResponseHeaders, bytes]:
871	        assert request.url is not None  # allow mypy to infer url is present.
872	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:872:8
871	        assert request.url is not None  # allow mypy to infer url is present.
872	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
873	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1015:8
1014	        }
1015	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
1016	        URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/notify"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1428:16
1427	                apns_context = get_apns_context()
1428	                assert apns_context is not None
1429	                self.assertEqual(mock_apns.return_value, apns_context.apns)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2009:8
2008	    ) -> None:
2009	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
2010	        URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/register"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2092:16
2091	            ), responses.RequestsMock() as resp:
2092	                assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
2093	                URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/unregister"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2375:12
2374	        with mock_queue_publish("zerver.lib.actions.queue_json_publish") as mock_publish:
2375	            assert stream.recipient_id is not None
2376	            do_mark_stream_messages_as_read(hamlet, stream.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:40:12
39	        def collect(events: List[Dict[str, Any]]) -> None:
40	            assert isinstance(queue_client, SimpleQueueClient)
41	            assert len(events) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:41:12
40	            assert isinstance(queue_client, SimpleQueueClient)
41	            assert len(events) == 1
42	            output.append(events[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:60:12
59	        def collect(events: List[Dict[str, Any]]) -> None:
60	            assert isinstance(queue_client, SimpleQueueClient)
61	            assert len(events) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:61:12
60	            assert isinstance(queue_client, SimpleQueueClient)
61	            assert len(events) == 1
62	            queue_client.stop_consuming()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:84:8
83	        queue_client = get_queue_client()
84	        assert isinstance(queue_client, SimpleQueueClient)
85	        actual_publish = queue_client.publish

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:104:8
103	
104	        assert queue_client.channel
105	        (_, _, message) = queue_client.channel.basic_get("test_suite")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:106:8
105	        (_, _, message) = queue_client.channel.basic_get("test_suite")
106	        assert message
107	        result = orjson.loads(message)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:111:8
110	        (_, _, message) = queue_client.channel.basic_get("test_suite")
111	        assert not message
112	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:116:8
115	        queue_client = get_queue_client()
116	        assert queue_client.channel
117	        if "test_suite" in queue_client.queues:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue_worker.py:193:8
192	        )
193	        assert (
194	            hamlet.email_notifications_batching_period_seconds
195	            == othello.email_notifications_batching_period_seconds
196	        )
197	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:292:8
291	        ).last()
292	        assert realm_audit_log is not None
293	        expected_extra_data = {"old_subdomain": "zulip", "new_subdomain": "newzulip"}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:369:8
368	        confirmation = Confirmation.objects.last()
369	        assert confirmation is not None
370	        self.assertEqual(confirmation.content_object, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:425:8
424	        realm = get_realm("zulip")
425	        assert realm.notifications_stream is not None
426	        self.assertEqual(realm.notifications_stream.id, new_notif_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:433:8
432	        realm = get_realm("zulip")
433	        assert realm.notifications_stream is not None
434	        self.assertNotEqual(realm.notifications_stream.id, invalid_notif_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:441:8
440	        notifications_stream = realm.get_notifications_stream()
441	        assert notifications_stream is not None
442	        self.assertEqual(notifications_stream.id, verona.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:469:8
468	        realm = get_realm("zulip")
469	        assert realm.signup_notifications_stream is not None
470	        self.assertEqual(realm.signup_notifications_stream.id, new_signup_notifications_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:481:8
480	        realm = get_realm("zulip")
481	        assert realm.signup_notifications_stream is not None
482	        self.assertNotEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:493:8
492	        signup_notifications_stream = realm.get_signup_notifications_stream()
493	        assert signup_notifications_stream is not None
494	        self.assertEqual(signup_notifications_stream, verona)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:665:8
664	        ).last()
665	        assert realm_audit_log is not None
666	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:687:8
686	        ).last()
687	        assert realm_audit_log is not None
688	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:791:8
790	
791	        assert realm.notifications_stream is not None
792	        self.assertEqual(realm.notifications_stream.name, "general")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:795:8
794	
795	        assert realm.signup_notifications_stream is not None
796	        self.assertEqual(realm.signup_notifications_stream.name, "core team")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:830:8
829	
830	        assert realm.notifications_stream is not None
831	        self.assertEqual(realm.notifications_stream.name, "general")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:834:8
833	
834	        assert realm.signup_notifications_stream is not None
835	        self.assertEqual(realm.signup_notifications_stream.name, "core team")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_emoji.py:77:8
76	        realm_emoji = RealmEmoji.objects.get(name="my_emoji")
77	        assert realm_emoji.author is not None
78	        self.assertEqual(realm_emoji.author.email, email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_emoji.py:109:8
108	        realm_emoji = RealmEmoji.objects.get(name="smile")
109	        assert realm_emoji is not None and realm_emoji.author is not None
110	        self.assertEqual(realm_emoji.author.email, email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_realm_emoji.py:336:25
335	        realm_1 = do_create_realm("test_realm", "test_realm")
336	        emoji_author_1 = do_create_user(
337	            "abc@example.com", password="abc", realm=realm_1, full_name="abc", acting_user=None
338	        )
339	        self.create_test_emoji("test_emoji", emoji_author_1)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tests\test_realm_export.py:58:22
57	        self.assertEqual(args["public_only"], True)
58	        self.assertIn("/tmp/zulip-export-", args["output_dir"])
59	        self.assertEqual(args["threads"], 6)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:65:8
64	        ).first()
65	        assert audit_log_entry is not None
66	        self.assertEqual(audit_log_entry.acting_user_id, admin.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:70:8
69	        extra_data = audit_log_entry.extra_data
70	        assert extra_data is not None
71	        export_path = orjson.loads(extra_data)["export_path"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:72:8
71	        export_path = orjson.loads(extra_data)["export_path"]
72	        assert export_path.startswith("/")
73	        path_id = export_path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:103:8
102	        extra_data = audit_log_entry.extra_data
103	        assert extra_data is not None
104	        export_data = orjson.loads(extra_data)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tests\test_realm_export.py:128:22
127	        self.assertEqual(args["public_only"], True)
128	        self.assertIn("/tmp/zulip-export-", args["output_dir"])
129	        self.assertEqual(args["threads"], 6)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:135:8
134	        ).first()
135	        assert audit_log_entry is not None
136	        self.assertEqual(audit_log_entry.acting_user_id, admin.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:140:8
139	        extra_data = audit_log_entry.extra_data
140	        assert extra_data is not None
141	        export_path = orjson.loads(extra_data).get("export_path")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:170:8
169	        extra_data = audit_log_entry.extra_data
170	        assert extra_data is not None
171	        export_data = orjson.loads(extra_data)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_report.py:1:0
1	import subprocess
2	from typing import Callable, ContextManager, Dict, List, Tuple
3	from unittest import mock

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:149:8
148	        )
149	        assert msg_id is not None
150	        return msg_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:606:8
605	        archive_transaction = ArchiveTransaction.objects.last()
606	        assert archive_transaction is not None
607	        self.assertEqual(archive_transaction.realm, realm)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:26:23
25	    def _get_outgoing_bot(self) -> UserProfile:
26	        outgoing_bot = do_create_user(
27	            email="bar-bot@zulip.com",
28	            password="test",
29	            realm=get_realm("zulip"),
30	            full_name="BarBot",
31	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
32	            bot_owner=self.example_user("cordelia"),
33	            acting_user=None,
34	        )
35	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:40:8
39	        sender = self.example_user("hamlet")
40	        assert not sender.is_bot
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:43:8
42	        outgoing_bot = self._get_outgoing_bot()
43	        assert outgoing_bot.bot_type is not None
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:65:8
64	        sender = self.example_user("hamlet")
65	        assert not sender.is_bot
66	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:68:8
67	        outgoing_bot = self._get_outgoing_bot()
68	        assert outgoing_bot.bot_type is not None
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:89:8
88	        sender = self.example_user("hamlet")
89	        assert not sender.is_bot
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:92:8
91	        outgoing_bot = self._get_outgoing_bot()
92	        assert outgoing_bot.bot_type is not None
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:124:8
123	        sender = self.example_user("hamlet")
124	        assert not sender.is_bot
125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:127:8
126	        outgoing_bot = self._get_outgoing_bot()
127	        assert outgoing_bot.bot_type is not None
128	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:175:27
174	        self.user_profile = self.example_user("othello")
175	        self.bot_profile = do_create_user(
176	            email="embedded-bot-1@zulip.com",
177	            password="test",
178	            realm=get_realm("zulip"),
179	            full_name="EmbeddedBo1",
180	            bot_type=UserProfile.EMBEDDED_BOT,
181	            bot_owner=self.user_profile,
182	            acting_user=None,
183	        )
184	        self.second_bot_profile = do_create_user(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:184:34
183	        )
184	        self.second_bot_profile = do_create_user(
185	            email="embedded-bot-2@zulip.com",
186	            password="test",
187	            realm=get_realm("zulip"),
188	            full_name="EmbeddedBot2",
189	            bot_type=UserProfile.EMBEDDED_BOT,
190	            bot_owner=self.user_profile,
191	            acting_user=None,
192	        )
193	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:421:8
420	    def _wrapped(*args: object, **kwargs: object) -> None:
421	        assert len(args) > 0
422	        self = cast(TestServiceBotEventTriggers, args[0])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:435:27
434	        self.user_profile = self.example_user("othello")
435	        self.bot_profile = do_create_user(
436	            email="foo-bot@zulip.com",
437	            password="test",
438	            realm=get_realm("zulip"),
439	            full_name="FooBot",
440	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
441	            bot_owner=self.user_profile,
442	            acting_user=None,
443	        )
444	        self.second_bot_profile = do_create_user(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:444:34
443	        )
444	        self.second_bot_profile = do_create_user(
445	            email="bar-bot@zulip.com",
446	            password="test",
447	            realm=get_realm("zulip"),
448	            full_name="BarBot",
449	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
450	            bot_owner=self.user_profile,
451	            acting_user=None,
452	        )
453	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:467:12
466	        ) -> None:
467	            assert self.bot_profile.bot_type
468	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:510:12
509	        ) -> None:
510	            assert self.bot_profile.bot_type
511	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:552:12
551	        ) -> None:
552	            assert self.bot_profile.bot_type
553	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:51:12
50	            "/json/settings",
51	            dict(
52	                full_name="Foo Bar",
53	                old_password=initial_password(user.delivery_email),
54	                new_password="foobar1",
55	            ),
56	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:69:12
68	        self.assertTrue(
69	            self.client.login(
70	                request=request,
71	                username=user.delivery_email,
72	                password="foobar1",
73	                realm=user.realm,
74	            ),
75	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'easy'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:83:16
82	                "/json/settings",
83	                dict(
84	                    full_name="Foo Bar",
85	                    old_password=initial_password(self.example_email("hamlet")),
86	                    new_password="easy",
87	                ),
88	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'f657gdGGk9'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:93:16
92	                "/json/settings",
93	                dict(
94	                    full_name="Foo Bar",
95	                    old_password=initial_password(self.example_email("hamlet")),
96	                    new_password="f657gdGGk9",
97	                ),
98	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:230:12
229	            "/json/settings",
230	            dict(
231	                old_password="bad_password",
232	                new_password="ignored",
233	            ),
234	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:245:20
244	                    "/json/settings",
245	                    dict(
246	                        old_password="bad_password",
247	                        new_password="ignored",
248	                    ),
249	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:253:20
252	                    "/json/settings",
253	                    dict(
254	                        old_password="bad_password",
255	                        new_password="ignored",
256	                    ),
257	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:263:20
262	                    "/json/settings",
263	                    dict(
264	                        old_password=initial_password(self.example_email("hamlet")),
265	                        new_password="ignored",
266	                    ),
267	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:276:20
275	                    "/json/settings",
276	                    dict(
277	                        old_password=initial_password(self.example_email("hamlet")),
278	                        new_password="foobar1",
279	                    ),
280	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:303:16
302	                "/json/settings",
303	                dict(
304	                    old_password=initial_password(self.example_email("hamlet")),
305	                    new_password="ignored",
306	                ),
307	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:312:16
311	                "/json/settings",
312	                dict(
313	                    old_password=self.ldap_password("hamlet"),  # hamlet's password in LDAP
314	                    new_password="ignored",
315	                ),
316	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:324:16
323	                "/json/settings",
324	                dict(
325	                    old_password=initial_password(self.example_email("hamlet")),
326	                    new_password="ignored",
327	                ),
328	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:340:16
339	                "/json/settings",
340	                dict(
341	                    old_password=initial_password(self.example_email("hamlet")),
342	                    new_password="ignored",
343	                ),
344	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:373:8
372	        old_password = initial_password(email)
373	        assert old_password is not None
374	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'f657gdGGk9'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:423:12
422	            # log back in with new password
423	            self.login_by_email(email, password="f657gdGGk9")
424	            user_profile = self.example_user("hamlet")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:773:12
772	        with patch("time.time", return_value=start_time):
773	            self.login_with_return(email, password="wrongpassword")
774	            self.assert_logged_in_user_id(None)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:775:12
774	            self.assert_logged_in_user_id(None)
775	            self.login_with_return(email, password="wrongpassword")
776	            self.assert_logged_in_user_id(None)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:792:19
791	        user_profile = self.example_user("hamlet")
792	        password = "a_password_of_22_chars"
793	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hümbüǵ'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:944:19
943	        email = self.nonreg_email("test")
944	        password = "hümbüǵ"
945	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:1265:8
1264	        prereg_user = PreregistrationUser.objects.get(email=mirror_user.email)
1265	        assert prereg_user.referred_by is not None and inviter is not None
1266	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:1892:8
1891	        prereg_user = obj.content_object
1892	        assert prereg_user is not None
1893	        prereg_user.email = "invalid.email"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2113:19
2112	        email = self.nonreg_email("alice")
2113	        password = "password"
2114	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2139:19
2138	        email = self.nonreg_email("alice")
2139	        password = "password"
2140	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2592:8
2591	        inviter = UserProfile.objects.exclude(realm=get_realm("zulip")).first()
2592	        assert inviter is not None
2593	        prereg_user = PreregistrationUser.objects.create(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2604:19
2603	        email = self.nonreg_email("alice")
2604	        password = "password"
2605	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2621:8
2620	        confirmation = Confirmation.objects.get(confirmation_key=registration_key)
2621	        assert confirmation.content_object is not None
2622	        prereg_user = confirmation.content_object

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2689:19
2688	    def check_user_able_to_register(self, email: str, invite_link: str) -> None:
2689	        password = "password"
2690	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\zerver\tests\test_signup.py:2994:4
2993	    @override_settings(OPEN_REALM_CREATION=True)
2994	    def check_able_to_create_realm(self, email: str, password: str = "test") -> None:
2995	        internal_realm = get_realm(settings.SYSTEM_BOT_REALM)
2996	        notification_bot = get_system_bot(settings.NOTIFICATION_BOT, internal_realm.id)
2997	        signups_stream, _ = create_stream_if_needed(notification_bot.realm, "signups")
2998	
2999	        string_id = "zuliptest"
3000	        # Make sure the realm does not exist
3001	        with self.assertRaises(Realm.DoesNotExist):
3002	            get_realm(string_id)
3003	
3004	        # Create new realm with the email
3005	        result = self.client_post("/new/", {"email": email})
3006	        self.assertEqual(result.status_code, 302)
3007	        self.assertTrue(result["Location"].endswith(f"/accounts/new/send_confirm/{email}"))
3008	        result = self.client_get(result["Location"])
3009	        self.assert_in_response("Check your email so we can get started.", result)
3010	
3011	        # Check confirmation email has the correct subject and body, extract
3012	        # confirmation link and visit it
3013	        confirmation_url = self.get_confirmation_url_from_outbox(
3014	            email,
3015	            email_subject_contains="Create your Zulip organization",
3016	            email_body_contains="You have requested a new Zulip organization",
3017	        )
3018	        result = self.client_get(confirmation_url)
3019	        self.assertEqual(result.status_code, 200)
3020	
3021	        result = self.submit_reg_form_for_user(email, password, realm_subdomain=string_id)
3022	        self.assertEqual(result.status_code, 302)
3023	        self.assertTrue(
3024	            result["Location"].startswith("http://zuliptest.testserver/accounts/login/subdomain/")
3025	        )
3026	
3027	        # Make sure the realm is created
3028	        realm = get_realm(string_id)
3029	        self.assertEqual(realm.string_id, string_id)
3030	        user = get_user(email, realm)
3031	        self.assertEqual(user.realm, realm)
3032	
3033	        # Check that user is the owner.
3034	        self.assertEqual(user.role, UserProfile.ROLE_REALM_OWNER)
3035	
3036	        # Check defaults
3037	        self.assertEqual(realm.org_type, Realm.ORG_TYPES["business"]["id"])
3038	        self.assertEqual(realm.emails_restricted_to_domains, False)
3039	        self.assertEqual(realm.invite_required, True)
3040	
3041	        # Check welcome messages
3042	        for stream_name, text, message_count in [
3043	            (Realm.DEFAULT_NOTIFICATION_STREAM_NAME, "with the topic", 3),
3044	            (Realm.INITIAL_PRIVATE_STREAM_NAME, "private stream", 1),
3045	        ]:
3046	            stream = get_stream(stream_name, realm)
3047	            recipient = stream.recipient
3048	            messages = Message.objects.filter(recipient=recipient).order_by("date_sent")
3049	            self.assert_length(messages, message_count)
3050	            self.assertIn(text, messages[0].content)
3051	
3052	        # Check signup messages
3053	        recipient = signups_stream.recipient
3054	        messages = Message.objects.filter(recipient=recipient).order_by("id")
3055	        self.assert_length(messages, 2)
3056	        self.assertIn("Signups enabled", messages[0].content)
3057	        self.assertIn("signed up", messages[1].content)
3058	        self.assertEqual("zuliptest", messages[1].topic_name())
3059	
3060	        realm_creation_audit_log = RealmAuditLog.objects.get(
3061	            realm=realm, event_type=RealmAuditLog.REALM_CREATED
3062	        )
3063	        self.assertEqual(realm_creation_audit_log.acting_user, user)
3064	        self.assertEqual(realm_creation_audit_log.event_time, realm.date_created)
3065	
3066	        # Piggyback a little check for how we handle
3067	        # empty string_ids.
3068	        realm.string_id = ""
3069	        self.assertEqual(realm.display_subdomain, ".")
3070	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3106:19
3105	    def test_create_realm_with_subdomain(self) -> None:
3106	        password = "test"
3107	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3146:19
3145	    def test_create_realm_with_marketing_emails_enabled(self) -> None:
3146	        password = "test"
3147	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3189:19
3188	    def test_create_realm_with_marketing_emails_disabled(self) -> None:
3189	        password = "test"
3190	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3232:19
3231	    def test_create_regular_realm_welcome_bot_pm(self) -> None:
3232	        password = "test"
3233	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3267:19
3266	    def test_create_demo_realm_welcome_bot_pm(self) -> None:
3267	        password = "test"
3268	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3303:19
3302	    def test_create_realm_during_free_trial(self) -> None:
3303	        password = "test"
3304	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3345:19
3344	        """
3345	        password = "test"
3346	        first_string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3423:19
3422	    def test_subdomain_restrictions(self) -> None:
3423	        password = "test"
3424	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3461:19
3460	
3461	        password = "test"
3462	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3476:19
3475	    def test_subdomain_restrictions_root_domain(self) -> None:
3476	        password = "test"
3477	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3501:19
3500	    def test_subdomain_restrictions_root_domain_option(self) -> None:
3501	        password = "test"
3502	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3686:19
3685	        email = self.nonreg_email("newguy")
3686	        password = "newpassword"
3687	        timezone = "US/Mountain"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3719:19
3718	        email = self.nonreg_email("newguy")
3719	        password = "newpassword"
3720	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3795:8
3794	
3795	        assert isinstance(user_profile, UserProfile)
3796	        # User should now be logged in.

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3805:19
3804	        email = "newguy@zulip.com"
3805	        password = "newpassword"
3806	        result = self.verify_signup(email=email, password=password, full_name="")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3831:19
3830	        email = "newguy@zulip.com"
3831	        password = "newpassword"
3832	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3897:19
3896	        email = self.nonreg_email("newguy")
3897	        password = "newpassword"
3898	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3931:19
3930	        email = self.nonreg_email("newguy")
3931	        password = "newpassword"
3932	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3979:19
3978	        email = self.nonreg_email("newguy")
3979	        password = "newpassword"
3980	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4019:19
4018	        email = hamlet_in_zulip.delivery_email
4019	        password = "newpassword"
4020	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4055:19
4054	        email = hamlet_in_zulip.delivery_email
4055	        password = "newpassword"
4056	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4125:19
4124	        email = "newuser@zulip.com"
4125	        password = "newpassword"
4126	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4166:19
4165	
4166	        password = "test"
4167	        email = self.example_email("iago")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4228:12
4227	            last_message = Message.objects.last()
4228	            assert last_message is not None
4229	            self.assertIn(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4329:16
4328	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
4329	                assert match is not None
4330	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4412:16
4411	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
4412	                assert match is not None
4413	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:4418:13
4417	
4418	        with self.settings(
4419	            POPULATE_PROFILE_VIA_LDAP=True,
4420	            LDAP_APPEND_DOMAIN="zulip.com",
4421	            AUTH_LDAP_BIND_PASSWORD="",
4422	            AUTH_LDAP_USER_ATTR_MAP=ldap_user_attr_map,
4423	            AUTH_LDAP_USER_DN_TEMPLATE="uid=%(user)s,ou=users,dc=zulip,dc=com",
4424	        ):
4425	            result = self.client_get(confirmation_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4731:19
4730	    def test_signup_with_ldap_and_email_enabled_using_email_with_ldap_append_domain(self) -> None:
4731	        password = "nonldappassword"
4732	        email = "newuser@zulip.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4853:19
4852	        # have a wrong password, then we refuse to create an account
4853	        password = "nonldappassword"
4854	        email = "newuser_email@zulip.com"  # belongs to user uid=newuser_with_email in the test directory

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4897:19
4896	        # database.
4897	        password = "nonldappassword"
4898	        email = "nonexistent@zulip.com"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5094:16
5093	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
5094	                assert match is not None
5095	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5113:12
5112	            prereg_user = confirmation.content_object
5113	            assert prereg_user is not None
5114	            prereg_user.realm_creation = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:5135:19
5134	    def test_registration_of_mirror_dummy_user(self, ignored: Any) -> None:
5135	        password = "test"
5136	        subdomain = "zephyr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5155:16
5154	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
5155	                assert match is not None
5156	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5246:8
5245	        user_profile = UserProfile.objects.all().order_by("id").last()
5246	        assert user_profile is not None
5247	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5268:8
5267	        user_profile = UserProfile.objects.all().order_by("id").last()
5268	        assert user_profile is not None
5269	        self.assert_logged_in_user_id(user_profile.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5287:8
5286	        user_profile = UserProfile.objects.all().order_by("id").last()
5287	        assert user_profile is not None
5288	        self.assert_logged_in_user_id(user_profile.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5307:8
5306	        password = initial_password(email)
5307	        assert password is not None
5308	        self.assert_login_failure(email, password=password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:115:16
114	    def test_get_slack_api_data(self) -> None:
115	        token = "xoxp-valid-token"
116	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-invalid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:152:16
151	
152	        token = "xoxp-invalid-token"
153	        with self.assertRaises(Exception) as invalid:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-status404'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:161:16
160	
161	        token = "xoxp-status404"
162	        wrong_url = "https://slack.com/api/wrong"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:1090:16
1089	        output_dir = os.path.join(settings.DEPLOY_ROOT, "var", "test-slack-importer-data")
1090	        token = "xoxp-valid-token"
1091	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:2350:8
2349	
2350	        assert found_sub is not None
2351	        self.assertEqual(found_sub["color"], new_color)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_subs.py:2987:41
2986	        for stream in existing_stream_names:
2987	            random_stream = stream + str(random.randint(0, 9))
2988	            if random_stream not in all_stream_names:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:4474:8
4473	        test_bot = self.create_test_bot("foo", hamlet)
4474	        assert test_bot is not None
4475	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5226:8
5225	        self.assertEqual(stream.id, stream_ret.id)
5226	        assert sub_ret is not None
5227	        self.assertEqual(sub_ret.recipient.type_id, stream.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5285:8
5284	        (stream_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
5285	        assert sub_ret is not None
5286	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5298:8
5297	        (stream_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
5298	        assert sub_ret is not None
5299	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5307:8
5306	        self.assertTrue(can_access_stream_history(guest_user_profile, stream))
5307	        assert sub_ret is None
5308	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:30:8
29	        missing = set(dict(reversed(ambiguous_abbrevs)).items()) - set(common_timezones.items())
30	        assert not missing, missing
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:42:16
41	                delta = tz.utcoffset(date)
42	                assert delta is not None
43	                offset = delta.total_seconds()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:44:16
43	                offset = delta.total_seconds()
44	                assert (
45	                    common_timezones[abbrev] == offset or (abbrev, offset) in ambiguous_abbrevs
46	                ), (name, abbrev, offset)
47	                extra.discard((abbrev, offset))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:48:8
47	                extra.discard((abbrev, offset))
48	        assert not extra, extra

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_transfer.py:126:8
125	        resized_key = bucket.Object(emoji_path)
126	        assert emoji.file_name
127	        still_key = bucket.Object(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:79:4
78	def destroy_uploads() -> None:
79	    assert settings.LOCAL_UPLOADS_DIR is not None
80	    if os.path.exists(settings.LOCAL_UPLOADS_DIR):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:104:8
103	        self.assertEqual(response.status_code, 200)
104	        assert isinstance(response, StreamingHttpResponse)
105	        data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:138:8
137	        self.assertEqual(response.status_code, 200)
138	        assert isinstance(response, StreamingHttpResponse)
139	        data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:521:12
520	            result = self.client_post("/json/user_uploads", {"f1": fp})
521	            assert sanitize_name(expected) in result.json()["uri"]
522	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:544:8
543	        quota = realm.upload_quota_bytes()
544	        assert quota is not None
545	        d1_attachment.size = quota - 11

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:602:8
601	        self.assertEqual(response.status_code, 200)
602	        assert isinstance(response, StreamingHttpResponse)
603	        data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:642:12
641	            self.assertEqual(response.status_code, 200)
642	            assert isinstance(response, StreamingHttpResponse)
643	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:653:12
652	            self.assertEqual(response.status_code, 200)
653	            assert isinstance(response, StreamingHttpResponse)
654	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:709:12
708	            self.assertEqual(response.status_code, 200)
709	            assert isinstance(response, StreamingHttpResponse)
710	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:720:12
719	            self.assertEqual(response.status_code, 200)
720	            assert isinstance(response, StreamingHttpResponse)
721	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:731:12
730	            self.assertEqual(response.status_code, 200)
731	            assert isinstance(response, StreamingHttpResponse)
732	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:795:12
794	            self.assertEqual(response.status_code, 200)
795	            assert isinstance(response, StreamingHttpResponse)
796	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:828:12
827	            response = self.client_get(uri)
828	            assert isinstance(response, StreamingHttpResponse)
829	            data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:848:16
847	                _get_sendfile.cache_clear()
848	                assert settings.LOCAL_UPLOADS_DIR is not None
849	                test_run, worker = os.path.split(os.path.dirname(settings.LOCAL_UPLOADS_DIR))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1170:16
1169	                response = self.client_get(url)
1170	                assert isinstance(response, StreamingHttpResponse)
1171	                data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1312:8
1311	        self.assertTrue(is_animated)
1312	        assert still_img_data is not None
1313	        still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1332:12
1331	            self.assertTrue(is_animated)
1332	            assert still_img_data
1333	            still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1346:12
1345	            self.assertTrue(is_animated)
1346	            assert still_img_data is not None
1347	            still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1362:12
1361	            # We unconditionally resize the still_image
1362	            assert still_img_data is not None
1363	            still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1449:16
1448	                response = self.client_get(url)
1449	                assert isinstance(response, StreamingHttpResponse)
1450	                data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1621:16
1620	                response = self.client_get(logo_url)
1621	                assert isinstance(response, StreamingHttpResponse)
1622	                data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1756:8
1755	
1756	        assert settings.LOCAL_UPLOADS_DIR is not None
1757	        file_path = os.path.join(settings.LOCAL_UPLOADS_DIR, "avatars", emoji_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1924:8
1923	        path = urllib.parse.urlparse(redirect_url).path
1924	        assert path.startswith("/")
1925	        key = path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1935:8
1934	        path = urllib.parse.urlparse(url_only_url).path
1935	        assert path.startswith("/")
1936	        key = path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_user_groups.py:39:8
38	        user_group = UserGroup.objects.first()
39	        assert user_group is not None
40	        membership = UserGroupMembership.objects.filter(user_group=user_group)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:502:8
501	
502	        assert role == UserProfile.ROLE_GUEST
503	        return (

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:793:27
792	                with self.tornado_redirected_to_list(events, expected_num_events=8):
793	                    fred = do_create_user(
794	                        email="fred@zulip.com",
795	                        password="password",
796	                        realm=realm,
797	                        full_name="Fred Flintstone",
798	                        prereg_user=prereg_user,
799	                        acting_user=None,
800	                    )
801	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:872:23
871	        do_change_user_role(admin, UserProfile.ROLE_REALM_ADMINISTRATOR, acting_user=None)
872	        valid_params = dict(
873	            email="romeo@zulip.net",
874	            password="xxxx",
875	            full_name="Romeo Montague",
876	        )
877	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:903:12
902	            "/json/users",
903	            dict(
904	                email="romeo@not-zulip.com",
905	                password="xxxx",
906	            ),
907	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:913:12
912	            "/json/users",
913	            dict(
914	                email="romeo@zulip.com",
915	                password="xxxx",
916	                full_name="Romeo Montague",
917	                short_name="DEPRECATED",
918	            ),
919	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:924:12
923	            "/json/users",
924	            dict(
925	                email="broken",
926	                password="xxxx",
927	                full_name="Romeo Montague",
928	            ),
929	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:935:12
934	            "/json/users",
935	            dict(
936	                email="romeo@not-zulip.com",
937	                password="xxxx",
938	                full_name="Romeo Montague",
939	            ),
940	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1141:8
1140	        iago = get_source_profile("iago@zulip.com", zulip_realm_id)
1141	        assert iago is not None
1142	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1146:8
1145	        iago = get_source_profile("IAGO@ZULIP.com", zulip_realm_id)
1146	        assert iago is not None
1147	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1151:8
1150	        cordelia = get_source_profile("cordelia@zulip.com", lear_realm_id)
1151	        assert cordelia is not None
1152	        self.assertEqual(cordelia.email, "cordelia@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1461:8
1460	        email = ScheduledEmail.objects.all().first()
1461	        assert email is not None and email.users is not None
1462	        self.assertEqual(email.users.count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1516:8
1515	        email = ScheduledEmail.objects.all().first()
1516	        assert email is not None
1517	        email.users.remove(*to_user_ids)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1559:8
1558	        recipient = stream.recipient
1559	        assert recipient is not None
1560	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1729:22
1728	        # Add a service bot.
1729	        service_bot = do_create_user(
1730	            email="service-bot@zulip.com",
1731	            password="",
1732	            realm=realm,
1733	            full_name="",
1734	            bot_type=UserProfile.EMBEDDED_BOT,
1735	            acting_user=None,
1736	        )
1737	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1753:21
1752	        # Add a normal bot.
1753	        normal_bot = do_create_user(
1754	            email="normal-bot@zulip.com",
1755	            password="",
1756	            realm=realm,
1757	            full_name="",
1758	            bot_type=UserProfile.DEFAULT_BOT,
1759	            acting_user=None,
1760	        )
1761	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_zephyr.py:1:0
1	import subprocess
2	from typing import Any
3	from unittest.mock import patch

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tornado\autoreload.py:58:0
57	import os
58	import subprocess
59	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tornado\autoreload.py:219:8
218	    if not _has_execv:
219	        subprocess.Popen([sys.executable] + sys.argv)
220	        sys.exit(0)

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\zerver\tornado\autoreload.py:223:12
222	        try:
223	            os.execv(sys.executable, [sys.executable] + sys.argv)
224	        except OSError:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\zerver\tornado\autoreload.py:236:12
235	            # this error specifically.
236	            os.spawnv(os.P_NOWAIT, sys.executable, [sys.executable] + sys.argv)
237	            # At this point the IOLoop has been closed and finally

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tornado\event_queue.py:254:45
253	        ioloop = tornado.ioloop.IOLoop.instance()
254	        interval = HEARTBEAT_MIN_FREQ_SECS + random.randint(0, 10)
255	        if self.client_type_name != "API: heartbeat test":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:430:4
429	def clear_client_event_queues_for_testing() -> None:
430	    assert settings.TEST_SUITE
431	    clients.clear()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:656:16
655	            if dont_block:
656	                assert new_queue_data is not None
657	                client = allocate_client_descriptor(new_queue_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:60:8
59	        log_data = RequestNotes.get_notes(request).log_data
60	        assert log_data is not None
61	        if len(contents) != 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:175:16
174	
175	                assert isinstance(response, HttpResponse)
176	                self.write_django_response_as_tornado_response(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:265:12
264	            patch_vary_headers(response, ("Cookie",))
265	            assert isinstance(response, HttpResponse)
266	            self.write_django_response_as_tornado_response(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:40:4
39	    log_data = RequestNotes.get_notes(request).log_data
40	    assert log_data is not None
41	    log_data["extra"] = f"[{queue_id}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:115:4
114	    tornado_handler = RequestNotes.get_notes(request).tornado_handler
115	    assert tornado_handler is not None
116	    handler = tornado_handler()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:117:4
116	    handler = tornado_handler()
117	    assert handler is not None
118	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:121:8
120	        valid_user_client = RequestNotes.get_notes(request).client
121	        assert valid_user_client is not None
122	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:159:8
158	        log_data = RequestNotes.get_notes(request).log_data
159	        assert log_data is not None
160	        log_data["extra"] = result["extra_log_data"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:173:4
172	    # devices, e.g. just creating an account on the web on their laptop.
173	    assert not (mobile_flow_otp and desktop_flow_otp)
174	    if mobile_flow_otp:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:193:8
192	
193	        assert multiuse_obj is not None
194	        realm = multiuse_obj.realm

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'zerver.views.auth.log_into_subdomain'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\auth.py:619:24
618	
619	_subdomain_token_salt = "zerver.views.auth.log_into_subdomain"
620	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:798:8
797	    except ZulipLDAPConfigurationError as e:
798	        assert len(e.args) > 1
799	        return redirect_to_misconfigured_ldap_notice(request, e.args[1])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:809:4
808	
809	    assert isinstance(template_response, HttpResponse)
810	    return template_response

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:886:4
885	
886	    assert user_profile.is_authenticated
887	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1004:8
1003	    except RateLimited as e:
1004	        assert e.secs_to_freedom is not None
1005	        return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1011:4
1010	        )
1011	    assert isinstance(response, HttpResponse)
1012	    return response

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\custom_profile_fields.py:111:12
110	            field_subtype = field_data["subtype"]
111	            assert isinstance(field_subtype, str)
112	            field = try_add_realm_default_custom_profile_field(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\dev_login.py:134:4
133	        raise AuthenticationFailedError()
134	    assert user_profile is not None
135	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\development\email_log.py:2:0
1	import os
2	import subprocess
3	import urllib

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\development\email_log.py:56:8
55	        # because by role, the tests shouldn't be doing a provision-like thing.
56	        subprocess.check_call(["./scripts/setup/inline_email_css.py"])
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:79:4
78	    result = client.post("/accounts/password/reset/", {"email": registered_email}, **host_kwargs)
79	    assert result.status_code == 302
80	    # deactivated user

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:83:4
82	    result = client.post("/accounts/password/reset/", {"email": registered_email}, **host_kwargs)
83	    assert result.status_code == 302
84	    change_user_is_active(user, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:86:4
85	    # account on different realm
86	    assert other_realm is not None
87	    result = client.post(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:90:4
89	    )
90	    assert result.status_code == 302
91	    # no account anywhere

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:95:4
94	    )
95	    assert result.status_code == 302
96	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:99:4
98	    result = client.post("/accounts/home/", {"email": unregistered_email_1}, **host_kwargs)
99	    assert result.status_code == 302
100	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:103:4
102	    result = client.post("/accounts/find/", {"emails": registered_email}, **host_kwargs)
103	    assert result.status_code == 302
104	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:107:4
106	    logged_in = client.login(dev_auth_username=registered_email, realm=realm)
107	    assert logged_in
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:120:4
119	    )
120	    assert result.status_code == 200
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:126:4
125	    )
126	    assert result.status_code == 200
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:133:4
132	    result = client.get(url)
133	    assert result.status_code == 200
134	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:49:4
48	    # Need to add test data to POST request as it doesn't originally contain the required parameters
49	    modify_postdata(request, key=key, full_name=name, password="test", terms="true")
50	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:67:4
66	    # Need to add test data to POST request as it doesn't originally contain the required parameters
67	    modify_postdata(
68	        request,
69	        key=key,
70	        realm_name=realm_name,
71	        realm_type=realm_type,
72	        full_name=name,
73	        password="test",
74	        realm_subdomain=realm_name,
75	        terms="true",
76	    )
77	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:94:4
93	    # Need to add test data to POST request as it doesn't originally contain the required parameters
94	    modify_postdata(
95	        request,
96	        key=key,
97	        realm_name=realm_name,
98	        realm_type=realm_type,
99	        full_name=name,
100	        password="test",
101	        realm_subdomain=realm_name,
102	        terms="true",
103	        is_demo_organization="true",
104	    )
105	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\digest.py:16:4
15	    user_profile = request.user
16	    assert user_profile.is_authenticated
17	    cutoff = time.mktime((timezone_now() - timedelta(days=DIGEST_CUTOFF)).timetuple())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:157:16
156	                )
157	                assert endpoint_name is not None
158	                assert endpoint_method is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:158:16
157	                assert endpoint_name is not None
158	                assert endpoint_method is not None
159	                article_title = get_openapi_summary(endpoint_name, endpoint_method)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\documentation.py:173:65
172	            request_notes.placeholder_open_graph_description = (
173	                f"REPLACMENT_OPEN_GRAPH_DESCRIPTION_{int(2**24 * random.random())}"
174	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\events_register.py:84:4
83	    client = RequestNotes.get_notes(request).client
84	    assert client is not None
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:40:4
39	def accounts_accept_terms(request: HttpRequest) -> HttpResponse:
40	    assert request.user.is_authenticated
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:178:8
177	        # See the assert in `home` above for why this must be true.
178	        assert request.session.get("prefers_web_public_view")
179	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:226:4
225	    log_data = RequestNotes.get_notes(request).log_data
226	    assert log_data is not None
227	    log_data["extra"] = f"[{queue_id}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:40:8
39	    if len(message_history) > 0:
40	        assert message.last_edit_time is not None
41	        assert datetime_to_timestamp(message.last_edit_time) == message_history[0]["timestamp"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:41:8
40	        assert message.last_edit_time is not None
41	        assert datetime_to_timestamp(message.last_edit_time) == message_history[0]["timestamp"]
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:56:12
55	            prev_rendered_content = entry["prev_rendered_content"]
56	            assert prev_rendered_content is not None
57	            entry["content_html_diff"] = highlight_html_differences(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:123:4
122	    log_data = RequestNotes.get_notes(request).log_data
123	    assert log_data is not None
124	    log_data["extra"] = f"[{number_changed}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:204:8
203	        # This operator does not support is_web_public_query.
204	        assert not self.is_web_public_query
205	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:205:8
204	        assert not self.is_web_public_query
205	        assert self.user_profile is not None
206	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:217:8
216	        # This operator class does not support is_web_public_query.
217	        assert not self.is_web_public_query
218	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:218:8
217	        assert not self.is_web_public_query
218	        assert self.user_profile is not None
219	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:286:12
285	            # a Zephyr realm are private, so that doesn't happen.
286	            assert not stream.is_public()
287	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:291:12
290	            # stream name, this will always match
291	            assert m is not None
292	            base_stream_name = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:325:12
324	            # Since the regex has a `.*` in it, this will always match
325	            assert m is not None
326	            base_topic = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:393:8
392	        # This operator does not support is_web_public_query.
393	        assert not self.is_web_public_query
394	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:394:8
393	        assert not self.is_web_public_query
394	        assert self.user_profile is not None
395	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:468:8
467	        # This operator does not support is_web_public_query.
468	        assert not self.is_web_public_query
469	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:469:8
468	        assert not self.is_web_public_query
469	        assert self.user_profile is not None
470	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:690:8
689	    if is_web_public_query:
690	        assert user_profile is None
691	        return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:693:4
692	
693	    assert user_profile is not None
694	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:781:8
780	    if not need_user_message:
781	        assert need_message
782	        query = select([column("id", Integer).label("message_id")], None, table("zerver_message"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:786:4
785	
786	    assert user_profile is not None
787	    if need_message:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:977:8
976	            raise MissingAuthenticationError()
977	        assert narrow is not None
978	        if not is_spectator_compatible(narrow):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:987:8
986	    else:
987	        assert isinstance(maybe_user_profile, UserProfile)
988	        user_profile = maybe_user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:989:8
988	        user_profile = maybe_user_profile
989	        assert user_profile is not None
990	        is_web_public_query = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:992:4
991	
992	    assert realm is not None
993	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:1049:8
1048	        log_data = RequestNotes.get_notes(request).log_data
1049	        assert log_data is not None
1050	        log_data["extra"] = "[{}]".format(",".join(verbose_operators))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:1117:8
1116	    elif include_history:
1117	        assert user_profile is not None
1118	        message_ids = [row[0] for row in rows]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:39:4
38	    request_notes = RequestNotes.get_notes(request)
39	    assert request_notes.client is not None
40	    assert request_notes.log_data is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:40:4
39	    assert request_notes.client is not None
40	    assert request_notes.log_data is not None
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:54:4
53	    request_notes = RequestNotes.get_notes(request)
54	    assert request_notes.client is not None
55	    count = do_mark_all_as_read(user_profile, request_notes.client)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:58:4
57	    log_data_str = f"[{count} updated]"
58	    assert request_notes.log_data is not None
59	    request_notes.log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:73:4
72	    log_data = RequestNotes.get_notes(request).log_data
73	    assert log_data is not None
74	    log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:102:4
101	    log_data = RequestNotes.get_notes(request).log_data
102	    assert log_data is not None
103	    log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:57:4
56	    client = RequestNotes.get_notes(request).client
57	    assert client is not None
58	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:230:4
229	    client = RequestNotes.get_notes(request).client
230	    assert client is not None
231	    can_forge_sender = user_profile.can_forge_sender

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:334:4
333	    client = RequestNotes.get_notes(request).client
334	    assert client is not None
335	    message.sending_client = client

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\muting.py:36:8
35	    else:
36	        assert stream_id is not None
37	        (stream, sub) = access_stream_by_id(user_profile, stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\muting.py:54:8
53	    else:
54	        assert stream_id is not None
55	        stream = access_stream_for_unmute_topic_by_id(user_profile, stream_id, error)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:112:8
111	    if emoji_name not in ["", None]:
112	        assert emoji_name is not None
113	        assert emoji_code is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:113:8
112	        assert emoji_name is not None
113	        assert emoji_code is not None
114	        assert emoji_type is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:114:8
113	        assert emoji_code is not None
114	        assert emoji_type is not None
115	        check_emoji_request(user_profile.realm, emoji_name, emoji_code, emoji_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:118:4
117	    client = RequestNotes.get_notes(request).client
118	    assert client is not None
119	    do_update_user_status(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:147:8
146	        client = RequestNotes.get_notes(request).client
147	        assert client is not None
148	        update_user_presence(user_profile, client, timezone_now(), status_val, new_user_input)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:18:20
17	def validate_token(token_str: str, kind: int) -> None:
18	    if token_str == "" or len(token_str) > 4096:
19	        raise JsonableError(_("Empty or invalid length token"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:111:4
110	    prereg_user = confirmation.content_object
111	    assert prereg_user is not None
112	    if prereg_user.status == confirmation_settings.STATUS_REVOKED:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:148:4
147	    prereg_user = confirmation.content_object
148	    assert prereg_user is not None
149	    if prereg_user.status == confirmation_settings.STATUS_REVOKED:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:332:8
331	            setup_realm_internal_bots(realm)
332	        assert realm is not None
333	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:610:16
609	            except RateLimited as e:
610	                assert e.secs_to_freedom is not None
611	                return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:674:16
673	            except RateLimited as e:
674	                assert e.secs_to_freedom is not None
675	                return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:741:20
740	                except RateLimited as e:
741	                    assert e.secs_to_freedom is not None
742	                    return render(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\report.py:3:0
2	import logging
3	import subprocess
4	from typing import Any, Dict, Mapping, Optional, Union

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:58:4
57	    log_data = RequestNotes.get_notes(request).log_data
58	    assert log_data is not None
59	    log_data[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:85:4
84	    log_data = RequestNotes.get_notes(request).log_data
85	    assert log_data is not None
86	    log_data["extra"] = f"[{initial_core}ms/{initial_free}ms/{network}ms]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:103:4
102	    log_data = RequestNotes.get_notes(request).log_data
103	    assert log_data is not None
104	    log_data["extra"] = f"[{initial_core}ms/{initial_free}ms]"

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\report.py:135:33
134	    try:
135	        version: Optional[str] = subprocess.check_output(
136	            ["git", "show", "-s", "--oneline"],
137	            universal_newlines=True,
138	        )
139	    except (FileNotFoundError, subprocess.CalledProcessError):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\report.py:135:33
134	    try:
135	        version: Optional[str] = subprocess.check_output(
136	            ["git", "show", "-s", "--oneline"],
137	            universal_newlines=True,
138	        )
139	    except (FileNotFoundError, subprocess.CalledProcessError):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:738:8
737	        is_web_public_query = False
738	        assert isinstance(maybe_user_profile, UserProfile)
739	        user_profile = maybe_user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:740:8
739	        user_profile = maybe_user_profile
740	        assert user_profile is not None
741	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:750:8
749	    else:
750	        assert user_profile is not None
751	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\views\user_settings.py:87:30
86	    ctx = {
87	        "new_email_html_tag": SafeString(
88	            f'<a href="mailto:{escape(new_email)}">{escape(new_email)}</a>'
89	        ),
90	        "old_email_html_tag": SafeString(

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\views\user_settings.py:90:30
89	        ),
90	        "old_email_html_tag": SafeString(
91	            f'<a href="mailto:{escape(old_email)}">{escape(old_email)}</a>'
92	        ),
93	    }

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:217:23
216	
217	    if new_password != "":
218	        return_data: Dict[str, Any] = {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:232:12
231	        except RateLimited as e:
232	            assert e.secs_to_freedom is not None
233	            secs_to_freedom = int(e.secs_to_freedom)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:141:8
140	    if target.is_bot:
141	        assert target.bot_type is not None
142	        check_bot_creation_policy(user_profile, target.bot_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:207:12
206	        for entry in profile_data:
207	            assert isinstance(entry["id"], int)
208	            if entry["value"] is None or not entry["value"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:272:4
271	    # hacks to prevent us from having to jump through decode/encode hoops.
272	    assert url is not None
273	    url = append_url_query_string(url, request.META["QUERY_STRING"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:337:8
336	        check_valid_interface_type(service_interface)
337	        assert service_interface is not None
338	        do_update_outgoing_webhook_service(bot, service_interface, service_payload_url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:486:8
485	    if bot_type in (UserProfile.OUTGOING_WEBHOOK_BOT, UserProfile.EMBEDDED_BOT):
486	        assert isinstance(service_name, str)
487	        add_service(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:92:4
91	def register_zoom_user(request: HttpRequest) -> HttpResponse:
92	    assert request.user.is_authenticated
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:126:4
125	) -> HttpResponse:
126	    assert request.user.is_authenticated
127	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\video_calls.py:179:24
178	    # https://docs.bigbluebutton.org/dev/api.html#usage for reference for checksum
179	    id = "zulip-" + str(random.randint(100000000000, 999999999999))
180	    password = b32encode(secrets.token_bytes(7))[:10].decode()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:221:4
220	) -> HttpResponse:
221	    assert request.user.is_authenticated
222	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\zephyr.py:5:0
4	import shlex
5	import subprocess
6	from typing import Optional

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:45:8
44	            user = kerberos_alter_egos[user]
45	        assert user == user_profile.email.split("@")[0]
46	        # Limit characters in usernames to valid MIT usernames

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:48:8
47	        # This is important for security since DNS is not secure.
48	        assert re.match(r"^[a-z0-9_.-]+$", user) is not None
49	        ccache = make_ccache(parsed_cred)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\zephyr.py:70:8
69	        ]
70	        subprocess.check_call(
71	            ["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--", " ".join(map(shlex.quote, command))]
72	        )
73	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\zephyr.py:70:8
69	        ]
70	        subprocess.check_call(
71	            ["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--", " ".join(map(shlex.quote, command))]
72	        )
73	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\appfollow\view.py:23:4
22	    app_name_search = re.search(r"\A(.+)", message)
23	    assert app_name_search is not None
24	    app_name = app_name_search.group(0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:144:4
143	def get_subject(payload: Dict[str, Any]) -> str:
144	    assert payload["repository"] is not None
145	    return BITBUCKET_TOPIC_TEMPLATE.format(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:190:8
189	        event_key = validate_extract_webhook_http_header(request, "X_EVENT_KEY", "BitBucket")
190	        assert event_key is not None
191	        action = re.match("pullrequest:(?P<action>.*)$", event_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\dialogflow\view.py:39:4
38	    client = RequestNotes.get_notes(request).client
39	    assert client is not None
40	    check_send_private_message(user_profile, client, receiving_user, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\groove\view.py:101:4
100	    event = validate_extract_webhook_http_header(request, "X_GROOVE_EVENT", "Groove")
101	    assert event is not None
102	    handler = EVENTS_FUNCTION_MAPPER.get(event)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\reviewboard\view.py:186:4
185	    event_type = validate_extract_webhook_http_header(request, "X_REVIEWBOARD_EVENT", "ReviewBoard")
186	    assert event_type is not None
187	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\slack\view.py:39:4
38	    client = RequestNotes.get_notes(request).client
39	    assert client is not None
40	    check_send_stream_message(user_profile, client, stream, subject, content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\stripe\view.py:84:8
83	    def update_string(blacklist: Sequence[str] = []) -> str:
84	        assert "previous_attributes" in payload["data"]
85	        previous_attributes = payload["data"]["previous_attributes"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\teamcity\view.py:141:8
140	        client = RequestNotes.get_notes(request).client
141	        assert client is not None
142	        check_send_private_message(user_profile, client, teamcity_user, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\yo\view.py:26:4
25	    client = RequestNotes.get_notes(request).client
26	    assert client is not None
27	    check_send_private_message(user_profile, client, receiving_user, body)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\worker\queue_processors.py:182:4
181	            os.kill(os.getpid(), signal.SIGUSR1)
182	    except Exception:
183	        pass
184	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:402:8
401	    def start(self) -> None:
402	        assert self.q is not None
403	        self.initialize_statistics()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:410:8
409	    def stop(self) -> None:  # nocoverage
410	        assert self.q is not None
411	        self.q.stop_consuming()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:422:8
421	    def start(self) -> None:  # nocoverage
422	        assert self.q is not None
423	        self.initialize_statistics()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:828:8
827	        )
828	        assert isinstance(msg, EmailMessage)  # https://github.com/python/typeshed/issues/2417
829	        if not is_missed_message_address(rcpt_to):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:883:8
882	    ) -> None:
883	        assert len(events) == 1
884	        event = events[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:939:20
938	                    )
939	                    assert message["content"] is not None
940	                bot_handler.handle_message(

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\worker\queue_processors.py:982:16
981	                ).order_by("id")[offset : offset + batch_size]
982	                UserMessage.objects.filter(message__in=messages).extra(
983	                    where=[UserMessage.where_unread()]
984	                ).update(flags=F("flags").bitor(UserMessage.flags.read))
985	                offset += len(messages)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:1034:12
1033	
1034	            assert public_url is not None
1035	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\add_new_realm.py:25:8
24	        )
25	        assert realm.signup_notifications_stream is not None
26	        bulk_add_subscriptions(realm, [realm.signup_notifications_stream], [user], acting_user=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\mark_all_messages_unread.py:15:8
14	    def handle(self, *args: Any, **options: Any) -> None:
15	        assert settings.DEVELOPMENT
16	        UserMessage.objects.all().update(flags=F("flags").bitand(~UserMessage.flags.read))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\populate_db.py:320:12
319	            RealmDomain.objects.create(realm=zulip_realm, domain="zulip.com")
320	            assert zulip_realm.notifications_stream is not None
321	            zulip_realm.notifications_stream.name = "Verona"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:454:24
453	            for i in range(num_boring_names, num_names):
454	                fname = random.choice(fnames) + str(i)
455	                full_name = fname

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:456:19
455	                full_name = fname
456	                if random.random() < 0.7:
457	                    if random.random() < 0.3:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:457:23
456	                if random.random() < 0.7:
457	                    if random.random() < 0.3:
458	                        full_name += " " + random.choice(non_ascii_names)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:458:43
457	                    if random.random() < 0.3:
458	                        full_name += " " + random.choice(non_ascii_names)
459	                    else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:460:43
459	                    else:
460	                        full_name += " " + random.choice(mnames)
461	                    if random.random() < 0.1:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:461:23
460	                        full_name += " " + random.choice(mnames)
461	                    if random.random() < 0.1:
462	                        full_name += f" {random.choice(raw_emojis)} "

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:462:41
461	                    if random.random() < 0.1:
462	                        full_name += f" {random.choice(raw_emojis)} "
463	                    else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:464:43
463	                    else:
464	                        full_name += " " + random.choice(lnames)
465	                email = fname.lower() + "@zulip.com"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:760:56
759	        for i in range(options["num_huddles"]):
760	            get_huddle(random.sample(user_profiles_ids, random.randint(3, 4)))
761	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:857:40
856	                for i in range(options["extra_streams"]):
857	                    extra_stream_name = random.choice(extra_stream_names) + " " + str(i)
858	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:860:23
859	                    # to imitate emoji insertions in stream names
860	                    if random.random() <= 0.15:
861	                        extra_stream_name += random.choice(raw_emojis)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:861:45
860	                    if random.random() <= 0.15:
861	                        extra_stream_name += random.choice(raw_emojis)
862	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:894:58
893	                count += 1
894	            jobs.append((count, personals_pairs, options, random.randint(0, 10 ** 10)))
895	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:995:18
994	
995	        randkey = random.randint(1, random_max)
996	        if (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:998:16
997	            num_messages > 0
998	            and random.randint(1, random_max) * 100.0 / random_max < options["stickyness"]
999	        ):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1012:52
1011	            message_type = Recipient.HUDDLE
1012	            message.recipient = get_recipient_by_id(random.choice(recipient_huddles))
1013	        elif (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1018:29
1017	            message_type = Recipient.PERSONAL
1018	            personals_pair = random.choice(personals_pairs)
1019	            random.shuffle(personals_pair)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1022:52
1021	            message_type = Recipient.STREAM
1022	            message.recipient = get_recipient_by_id(random.choice(recipient_streams))
1023	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1025:24
1024	        if message_type == Recipient.HUDDLE:
1025	            sender_id = random.choice(huddle_members[message.recipient.id])
1026	            message.sender = get_user_profile_by_id(sender_id)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1035:29
1034	            # Pick a random subscriber to the stream
1035	            message.sender = random.choice(
1036	                list(Subscription.objects.filter(recipient=message.recipient))
1037	            ).user_profile
1038	            message.subject = random.choice(possible_topics[message.recipient.id])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1038:30
1037	            ).user_profile
1038	            message.subject = random.choice(possible_topics[message.recipient.id])
1039	            saved_data["subject"] = message.subject

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1107:24
1106	            max_num_users = min(7, len(msg_user_ids))
1107	            num_users = random.randrange(1, max_num_users + 1)
1108	            user_ids = random.sample(msg_user_ids, num_users)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1112:29
1111	                # each user does between 1 and 3 emojis
1112	                num_emojis = random.choice([1, 2, 3])
1113	                emojis = random.sample(DEFAULT_EMOJIS, num_emojis)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1152:21
1151	
1152	    offset_seconds = random.uniform(lower_bound, upper_bound)
1153	    spoofed_date += timezone_timedelta(seconds=offset_seconds)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\queue_rate.py:63:16
62	
63	                assert worker.q is not None
64	                assert worker.q.channel is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\queue_rate.py:64:16
63	                assert worker.q is not None
64	                assert worker.q.channel is not None
65	                worker.q.channel.basic_qos(prefetch_count=prefetch)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\models.py:103:8
102	        # inside Tornado.
103	        assert not settings.RUNNING_INSIDE_TORNADO
104	        assert settings.ZILENCER_ENABLED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\models.py:104:8
103	        assert not settings.RUNNING_INSIDE_TORNADO
104	        assert settings.ZILENCER_ENABLED
105	

--------------------------------------------------
>> Issue: [B410:blacklist] Using XMLSyntaxError to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XMLSyntaxError with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zproject\backends.py:36:0
35	from django_auth_ldap.backend import LDAPBackend, _LDAPUser, ldap_error
36	from lxml.etree import XMLSyntaxError
37	from onelogin.saml2.errors import OneLogin_Saml2_Error

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\backends.py:400:19
399	
400	    if password == "":
401	        # zxcvbn throws an exception when passed the empty string, so

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\backends.py:440:23
439	            return None
440	        if password == "":
441	            # Never allow an empty password.  This is defensive code;

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:483:8
482	        # Email search needs to be configured in this case.
483	        assert settings.AUTH_LDAP_USERNAME_ATTR and settings.AUTH_LDAP_REVERSE_EMAIL_SEARCH
484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:487:4
486	    # and thus don't make sense to have enabled together.
487	    assert not (
488	        settings.AUTH_LDAP_USER_ATTR_MAP.get("userAccountControl")
489	        and settings.AUTH_LDAP_USER_ATTR_MAP.get("deactivated")
490	    )
491	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:750:8
749	
750	        assert "deactivated" in settings.AUTH_LDAP_USER_ATTR_MAP
751	        attr_value = ldap_user.attrs[settings.AUTH_LDAP_USER_ATTR_MAP["deactivated"]][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:760:8
759	        attr_value_upper = attr_value.upper()
760	        assert (
761	            attr_value_upper in true_values or attr_value_upper in false_values
762	        ), f"Invalid value '{attr_value}' in the LDAP attribute mapped to deactivated"
763	        return attr_value_upper in true_values

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1224:4
1223	def external_auth_method(cls: Type[ExternalAuthMethod]) -> Type[ExternalAuthMethod]:
1224	    assert issubclass(cls, ExternalAuthMethod)
1225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1263:12
1262	        if login_token is not None:
1263	            assert (not data_dict) and (
1264	                user_profile is None
1265	            ), "Passing in data_dict or user_profile with login_token is disallowed."
1266	            self.instantiate_with_token(login_token, delete_stored_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1273:12
1272	            # Ensure data inconsistent with the user_profile wasn't passed in inside the data_dict argument.
1273	            assert (
1274	                "full_name" not in data_dict
1275	                or data_dict["full_name"] == self.user_profile.full_name
1276	            )
1277	            assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1277:12
1276	            )
1277	            assert (
1278	                "email" not in data_dict
1279	                or data_dict["email"].lower() == self.user_profile.delivery_email.lower()
1280	            )
1281	            # Update these data_dict fields to ensure consistency with self.user_profile. This is mostly

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1675:4
1674	    # being incorrectly authenticated.
1675	    assert return_data.get("valid_attestation") is True
1676	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1701:8
1700	        # for it otherwise.
1701	        assert backend.name == "saml"
1702	        custom_profile_field_name_to_attr_name = attrs_by_backend.get(backend.name, {})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2417:8
2416	            ]
2417	        assert isinstance(entitlements, list)
2418	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2636:8
2635	        idp_name = self.strategy.session_get("saml_idp_name")
2636	        assert isinstance(idp_name, str)
2637	        auto_signup = settings.SOCIAL_AUTH_SAML_ENABLED_IDPS[idp_name].get("auto_signup", False)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2638:8
2637	        auto_signup = settings.SOCIAL_AUTH_SAML_ENABLED_IDPS[idp_name].get("auto_signup", False)
2638	        assert isinstance(auto_signup, bool)
2639	        return auto_signup

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2655:4
2654	    display_icon: Optional[str] = cast(Optional[str], settings_dict.get("display_icon", None))
2655	    assert isinstance(display_icon, (str, type(None)))
2656	    display_name: str = cast(str, settings_dict.get("display_name", "OIDC"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2657:4
2656	    display_name: str = cast(str, settings_dict.get("display_name", "OIDC"))
2657	    assert isinstance(display_name, str)
2658	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2667:8
2666	        client_id = self.settings_dict.get("client_id", "")
2667	        assert isinstance(client_id, str)
2668	        secret = self.settings_dict.get("secret", "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2669:8
2668	        secret = self.settings_dict.get("secret", "")
2669	        assert isinstance(secret, str)
2670	        return client_id, secret

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2699:8
2698	        result = self.settings_dict.get("auto_signup", False)
2699	        assert isinstance(result, bool)
2700	        return result

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\computed_settings.py:728:25
727	
728	ZULIP_WORKER_TEST_FILE = "/tmp/zulip-worker-test-file"
729	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:73:12
72	            html_alternative = list(email_message.alternatives[0])
73	            assert isinstance(html_alternative[0], str)
74	            # Here, we replace the email addresses used in development

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:80:12
79	            )
80	            assert isinstance(email_message.alternatives, MutableSequence)
81	            email_message.alternatives[0] = tuple(html_alternative)

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\zproject\jinja2\__init__.py:21:10
20	def environment(**options: Any) -> Environment:
21	    env = Environment(**options)
22	    env.globals.update(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:162:16
161	S3_KEY = "test-key"
162	S3_SECRET_KEY = "test-secret-key"
163	S3_AUTH_UPLOADS_BUCKET = "test-authed-bucket"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:176:30
175	GOOGLE_OAUTH2_CLIENT_ID = "id"
176	GOOGLE_OAUTH2_CLIENT_SECRET = "secret"
177	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:179:28
178	SOCIAL_AUTH_GITHUB_KEY = "key"
179	SOCIAL_AUTH_GITHUB_SECRET = "secret"
180	SOCIAL_AUTH_GITLAB_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:181:28
180	SOCIAL_AUTH_GITLAB_KEY = "key"
181	SOCIAL_AUTH_GITLAB_SECRET = "secret"
182	SOCIAL_AUTH_GOOGLE_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:183:28
182	SOCIAL_AUTH_GOOGLE_KEY = "key"
183	SOCIAL_AUTH_GOOGLE_SECRET = "secret"
184	SOCIAL_AUTH_SUBDOMAIN = "auth"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'client_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:211:27
210	VIDEO_ZOOM_CLIENT_ID = "client_id"
211	VIDEO_ZOOM_CLIENT_SECRET = "client_secret"
212	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:213:25
212	
213	BIG_BLUE_BUTTON_SECRET = "123"
214	BIG_BLUE_BUTTON_URL = "https://bbb.example.com/bigbluebutton/"

--------------------------------------------------

Code scanned:
	Total lines of code: 181687
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 1331
		Medium: 37
		High: 10
	Total issues (by confidence):
		Undefined: 0
		Low: 9
		Medium: 168
		High: 1201
Files skipped (0):
