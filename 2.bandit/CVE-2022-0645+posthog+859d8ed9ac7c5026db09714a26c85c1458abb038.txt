Working... ---------------------------------------- 100% 0:00:12
Run started:2024-02-10 22:25:49.411724

Test results:
>> Issue: [B506:yaml_load] Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b506_yaml_load.html
   Location: .\docker-compose-config.py:23:17
22	    with open(FILE_PATH, "r") as file:
23	        config = yaml.load(file, Loader=FullLoader)
24	    if not config:

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\api\test\test_dashboard.py:47:8
46	        self.client.logout()
47	        Dashboard.objects.create(
48	            team=self.team, share_token="testtoken", name="public dashboard", is_shared=True,
49	        )
50	        response = self.client.get("/shared_dashboard/testtoken")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:133:8
132	
133	        assert response.json()["verified"] is False
134	        assert response.json()["verified_by"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:134:8
133	        assert response.json()["verified"] is False
134	        assert response.json()["verified_by"] is None
135	        assert response.json()["verified_at"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:135:8
134	        assert response.json()["verified_by"] is None
135	        assert response.json()["verified_at"] is None
136	        assert response.json()["updated_at"] == "2021-08-25T22:09:14.252000Z"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:136:8
135	        assert response.json()["verified_at"] is None
136	        assert response.json()["updated_at"] == "2021-08-25T22:09:14.252000Z"
137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:140:8
139	        matches = [p["name"] for p in query_list_response.json()["results"] if p["name"] == "enterprise event"]
140	        assert len(matches) == 1
141	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:151:8
150	
151	        assert response.json()["verified"] is False
152	        assert response.json()["verified_by"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:152:8
151	        assert response.json()["verified"] is False
152	        assert response.json()["verified_by"] is None
153	        assert response.json()["verified_at"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:153:8
152	        assert response.json()["verified_by"] is None
153	        assert response.json()["verified_at"] is None
154	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:160:8
159	
160	        assert response.json()["verified"] is True
161	        assert response.json()["verified_by"]["id"] == self.user.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:161:8
160	        assert response.json()["verified"] is True
161	        assert response.json()["verified_by"]["id"] == self.user.id
162	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:162:8
161	        assert response.json()["verified_by"]["id"] == self.user.id
162	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"
163	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:169:8
168	
169	        assert response.json()["verified"] is False
170	        assert response.json()["verified_by"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:170:8
169	        assert response.json()["verified"] is False
170	        assert response.json()["verified_by"] is None
171	        assert response.json()["verified_at"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:171:8
170	        assert response.json()["verified_by"] is None
171	        assert response.json()["verified_at"] is None
172	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:181:8
180	
181	        assert response.json()["verified"] is False
182	        assert response.json()["verified_by"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:182:8
181	        assert response.json()["verified"] is False
182	        assert response.json()["verified_by"] is None
183	        assert response.json()["verified_at"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:183:8
182	        assert response.json()["verified_by"] is None
183	        assert response.json()["verified_at"] is None
184	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:190:8
189	
190	        assert response.json()["verified"] is True
191	        assert response.json()["verified_by"]["id"] == self.user.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:191:8
190	        assert response.json()["verified"] is True
191	        assert response.json()["verified_by"]["id"] == self.user.id
192	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:192:8
191	        assert response.json()["verified_by"]["id"] == self.user.id
192	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"
193	        assert response.json()["updated_at"] == "2021-08-25T22:09:14.252000Z"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:193:8
192	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"
193	        assert response.json()["updated_at"] == "2021-08-25T22:09:14.252000Z"
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:200:8
199	
200	        assert response.json()["verified"] is True
201	        assert response.json()["verified_by"]["id"] == self.user.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:201:8
200	        assert response.json()["verified"] is True
201	        assert response.json()["verified_by"]["id"] == self.user.id
202	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"  # Note `verified_at` did not change

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:202:8
201	        assert response.json()["verified_by"]["id"] == self.user.id
202	        assert response.json()["verified_at"] == "2021-08-25T22:09:14.252000Z"  # Note `verified_at` did not change
203	        # updated_at automatically updates on every patch request

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:204:8
203	        # updated_at automatically updates on every patch request
204	        assert response.json()["updated_at"] == "2021-10-26T22:09:14.252000Z"
205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:215:8
214	
215	        assert response.json()["verified"] is False
216	        assert response.json()["verified_by"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:216:8
215	        assert response.json()["verified"] is False
216	        assert response.json()["verified_by"] is None
217	        assert response.json()["verified_at"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:217:8
216	        assert response.json()["verified_by"] is None
217	        assert response.json()["verified_at"] is None
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:230:8
229	
230	        assert response.json()["verified"] is False
231	        assert response.json()["verified_by"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:231:8
230	        assert response.json()["verified"] is False
231	        assert response.json()["verified_by"] is None
232	        assert response.json()["verified_at"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_event_definition.py:232:8
231	        assert response.json()["verified_by"] is None
232	        assert response.json()["verified_at"] is None
233	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_hooks.py:77:8
76	        test_output = valid_domain(test_input)
77	        assert test_output == expected_test_output

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_property_definition.py:24:8
23	
24	        assert response.json()["property_type"] == "DateTime"
25	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\api\test\test_property_definition.py:29:8
28	        matches = [p["name"] for p in query_list_response.json()["results"] if p["name"] == "a timestamp"]
29	        assert len(matches) == 1
30	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\benchmarks\helpers.py:37:8
36	    rows = client.sync_execute(
37	        f"""
38	        SELECT
39	            query_duration_ms,
40	            read_rows,
41	            read_bytes,
42	            memory_usage
43	        FROM system.query_log
44	        WHERE
45	            query NOT LIKE '%%query_log%%'
46	            AND query LIKE %(matcher)s
47	            AND type = 'QueryFinish'
48	        """,
49	        {"matcher": f"%benchmark:{uuid}%"},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\materialized_columns\analyze.py:82:8
81	    raw_queries = sync_execute(
82	        f"""
83	        SELECT
84	            query,
85	            query_duration_ms
86	        FROM system.query_log
87	        WHERE
88	            query NOT LIKE '%%query_log%%'
89	            AND query LIKE '/* request:%%'
90	            AND query NOT LIKE '%%INSERT%%'
91	            AND type = 'QueryFinish'
92	            AND query_start_time > now() - toIntervalHour(%(since)s)
93	            AND query_duration_ms > %(min_query_time)s
94	        ORDER BY query_duration_ms desc
95	        """,
96	        {"since": since_hours_ago, "min_query_time": min_query_time},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\materialized_columns\test\test_analyze.py:13:16
12	            (
13	                f"""
14	                SELECT JSONExtractString(properties, 'event_prop')
15	                FROM events
16	                WHERE team_id = {self.team.pk}
17	                  AND {trim_quotes_expr("JSONExtractRaw(properties, 'another_prop')")}
18	                """,
19	                6723,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\materialized_columns\test\test_analyze.py:21:13
20	            ),
21	            (f"SELECT JSONExtractString(properties, 'person_prop') FROM person WHERE team_id = {self.team.pk}", 9723),
22	        ]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\materialized_columns\test\test_analyze.py:58:12
57	        query_with_unknown_property = Query(
58	            f"SELECT JSONExtractString(properties, '$unknown_prop') FROM events WHERE team_id = {self.team.pk}", 0
59	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\migrations\0016_collapsing_person_distinct_id.py:19:12
18	        migrations.RunSQL(
19	            f"""
20	            INSERT INTO {TEMPORARY_TABLE_NAME} (distinct_id, person_id, team_id, _sign, _timestamp, _offset)
21	            SELECT
22	                distinct_id,
23	                person_id,
24	                team_id,
25	                if(is_deleted==0, 1, -1) as _sign,
26	                _timestamp,
27	                _offset
28	            FROM {PERSONS_DISTINCT_ID_TABLE}
29	        """
30	        ),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\cohort.py:79:8
78	    return (
79	        f"{custom_match_field} IN (SELECT person_id FROM {PERSON_STATIC_COHORT_TABLE} WHERE cohort_id = %({prepend}_cohort_id_{index})s AND team_id = %(team_id)s)",
80	        {f"{prepend}_cohort_id_{index}": cohort_id},

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\event.py:33:4
32	        timestamp = timezone.now()
33	    assert timestamp is not None
34	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\ee\clickhouse\models\person.py:119:4
118	            sync_execute(DELETE_PERSON_EVENTS_BY_ID, {"id": person_id, "team_id": team_id})
119	    except:
120	        pass  # cannot delete if the table is distributed
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\property.py:370:8
369	        # TODO introducing duplication in these branches now rather than refactor too early
370	        assert isinstance(prop.value, str)
371	        prop_value_param_key = "v{}_{}".format(prepend, idx)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\property.py:387:8
386	        # TODO introducing duplication in these branches now rather than refactor too early
387	        assert isinstance(prop.value, str)
388	        prop_value_param_key = "v{}_{}".format(prepend, idx)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\property.py:412:8
411	        # TODO introducing duplication in these branches now rather than refactor too early
412	        assert isinstance(prop.value, str)
413	        prop_value_param_key = "v{}_{}".format(prepend, idx)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_action.py:31:12
30	    formatted_query, params = format_action_filter(team_id=action.team_id, action=action, prepend="")
31	    query = f"""
32	        SELECT
33	            events.uuid,
34	            events.distinct_id
35	        FROM events
36	        WHERE {formatted_query}
37	        AND events.team_id = %(team_id)s
38	        ORDER BY events.timestamp DESC
39	    """
40	    events = sync_execute(query, {"team_id": action.team_id, **params})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:78:22
77	        query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
78	        final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
79	        result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:106:22
105	        query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
106	        final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
107	        result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:145:26
144	            query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
145	            final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
146	            result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:157:26
156	            query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
157	            final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
158	            result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:197:26
196	            query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
197	            final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
198	            result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:209:26
208	            query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
209	            final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
210	            result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:234:22
233	        query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
234	        final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
235	        result = sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_cohort.py:262:22
261	        query, params = parse_prop_grouped_clauses(team_id=self.team.pk, property_group=filter.property_groups)
262	        final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
263	        self.assertIn("\nFROM person_distinct_id2\n", final_query)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_dead_letter_queue.py:102:48
101	
102	        dead_letter_queue_events = sync_execute(f"SELECT * FROM {DEAD_LETTER_QUEUE_TABLE} LIMIT 1")
103	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_filters.py:45:8
44	    rows = sync_execute(
45	        f"SELECT id, properties AS person_props FROM person WHERE team_id = %(team_id)s {prop_filters}",
46	        {"team_id": team.pk, **prop_filter_params},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_filters.py:729:16
728	        )
729	        query = """
730	        SELECT distinct_id FROM person_distinct_id WHERE team_id = %(team_id)s {prop_clause}
731	        """.format(
732	            prop_clause=prop_clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_filters.py:743:16
742	        )
743	        query = """
744	        SELECT distinct_id FROM person_distinct_id WHERE team_id = %(team_id)s {prop_clause}
745	        """.format(
746	            prop_clause=prop_clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_property.py:51:22
50	        )
51	        final_query = "SELECT uuid FROM events WHERE team_id = %(team_id)s {}".format(query)
52	        return sync_execute(final_query, {**params, "team_id": self.team.pk})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_property.py:470:22
469	
470	        final_query = f"SELECT uuid FROM events {joins} WHERE team_id = %(team_id)s {query}"
471	        # Make sure we don't accidentally use json on the properties field

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:616:4
615	
616	    assert (
617	        parse_prop_grouped_clauses(property_group=filter.property_groups, allow_denormalized_props=False, team_id=1)
618	        == snapshot
619	    )
620	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:620:4
619	    )
620	    assert (
621	        parse_prop_grouped_clauses(
622	            property_group=filter.property_groups,
623	            person_properties_mode=PersonPropertiesMode.USING_PERSON_PROPERTIES_COLUMN,
624	            allow_denormalized_props=False,
625	            team_id=1,
626	        )
627	        == snapshot
628	    )
629	    assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:629:4
628	    )
629	    assert (
630	        parse_prop_grouped_clauses(
631	            team_id=1,
632	            property_group=filter.property_groups,
633	            person_properties_mode=PersonPropertiesMode.DIRECT,
634	            allow_denormalized_props=False,
635	        )
636	        == snapshot
637	    )
638	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:645:4
644	    )
645	    assert (
646	        parse_prop_grouped_clauses(
647	            team_id=1,
648	            property_group=filter.property_groups,
649	            person_properties_mode=PersonPropertiesMode.USING_PERSON_PROPERTIES_COLUMN,
650	            allow_denormalized_props=True,
651	        )
652	        == snapshot
653	    )
654	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:680:4
679	
680	    assert actual == expected
681	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_property.py:1008:20
1007	                for (uuid,) in sync_execute(
1008	                    f"SELECT uuid FROM events WHERE team_id = %(team_id)s {query}", {"team_id": team.pk, **params}
1009	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1015:4
1014	
1015	    assert len(uuids) == len(expected)  # helpful when diagnosing assertion failure below
1016	    assert uuids == expected

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1016:4
1015	    assert len(uuids) == len(expected)  # helpful when diagnosing assertion failure below
1016	    assert uuids == expected
1017	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1028:4
1027	
1028	    assert "JSONExtract" not in query
1029	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_property.py:1035:20
1034	                for (uuid,) in sync_execute(
1035	                    f"SELECT uuid FROM events WHERE team_id = %(team_id)s {query}", {"team_id": team.pk, **params}
1036	                )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1042:4
1041	
1042	    assert uuids == expected
1043	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1054:4
1053	    combined_group = property_group.combine_properties(PropertyOperatorType.AND, [propertyC, propertyD])
1054	    assert combined_group.to_dict() == {
1055	        "type": "AND",
1056	        "values": [
1057	            {
1058	                "type": "OR",
1059	                "values": [
1060	                    {"key": "a", "operator": "exact", "value": ["a", "b", "c"], "type": "event"},
1061	                    {"key": "b", "operator": "exact", "value": ["d", "e", "f"], "type": "event"},
1062	                ],
1063	            },
1064	            {
1065	                "type": "AND",
1066	                "values": [
1067	                    {"key": "c", "operator": "exact", "value": ["g", "h", "i"], "type": "event"},
1068	                    {"key": "d", "operator": "exact", "value": ["j", "k", "l"], "type": "event"},
1069	                ],
1070	            },
1071	        ],
1072	    }
1073	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1075:4
1074	    combined_group = property_group.combine_properties(PropertyOperatorType.OR, [propertyC, propertyD])
1075	    assert combined_group.to_dict() == {
1076	        "type": "OR",
1077	        "values": [
1078	            {
1079	                "type": "OR",
1080	                "values": [
1081	                    {"key": "a", "operator": "exact", "value": ["a", "b", "c"], "type": "event"},
1082	                    {"key": "b", "operator": "exact", "value": ["d", "e", "f"], "type": "event"},
1083	                ],
1084	            },
1085	            {
1086	                "type": "AND",
1087	                "values": [
1088	                    {"key": "c", "operator": "exact", "value": ["g", "h", "i"], "type": "event"},
1089	                    {"key": "d", "operator": "exact", "value": ["j", "k", "l"], "type": "event"},
1090	                ],
1091	            },
1092	        ],
1093	    }
1094	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1096:4
1095	    combined_group = property_group.combine_properties(PropertyOperatorType.OR, [])
1096	    assert combined_group.to_dict() == {
1097	        "type": "OR",
1098	        "values": [
1099	            {"key": "a", "operator": "exact", "value": ["a", "b", "c"], "type": "event"},
1100	            {"key": "b", "operator": "exact", "value": ["d", "e", "f"], "type": "event"},
1101	        ],
1102	    }
1103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\models\test\test_property.py:1107:4
1106	    )
1107	    assert combined_group.to_dict() == {
1108	        "type": "AND",
1109	        "values": [
1110	            {"key": "c", "operator": "exact", "value": ["g", "h", "i"], "type": "event"},
1111	            {"key": "d", "operator": "exact", "value": ["j", "k", "l"], "type": "event"},
1112	        ],
1113	    }

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_team.py:69:28
68	        ids = [team.pk for team in self.teams]
69	        rows = sync_execute(f"SELECT {column} FROM {table} WHERE team_id IN %(ids)s", {"ids": ids})
70	        return [row[0] for row in rows]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\test_team.py:74:12
73	        sync_execute(
74	            f"""
75	            INSERT INTO cohortpeople (person_id, cohort_id, team_id, sign)
76	            VALUES (%(person_id)s, %(cohort_id)s, %(team_id)s, 1)
77	        """,
78	            {"person_id": str(person_id), "cohort_id": cohort_id, "team_id": team.pk},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\models\test\utils\util.py:11:30
10	    while time() < ts_start + timeout_seconds:
11	        result = sync_execute(f"SELECT COUNT(1) FROM {table_name}")
12	        if result[0][0] == target_row_count:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\ee\clickhouse\models\util.py:16:4
15	        return False
16	    except:
17	        pass
18	    try:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\breakdown_props.py:133:12
132	    )
133	    query = f"""
134	            SELECT DISTINCT distinct_id, {ALL_USERS_COHORT_ID} as value
135	            FROM events all_events
136	            WHERE team_id = {team_id}
137	            {parsed_date_from}
138	            {parsed_date_to}
139	            {prop_filters}
140	            """
141	    return query, {**date_params, **prop_filter_params}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\column_optimizer.py:37:16
36	                # :TRICKY: We only support string breakdown for group properties
37	                assert isinstance(self.filter.breakdown, str)
38	                counter[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\base.py:616:16
615	                # :TRICKY: We only support string breakdown for group properties
616	                assert isinstance(self._filter.breakdown, str)
617	                properties_field = f"group_properties_{self._filter.breakdown_group_type_index}"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel.py:36:15
35	
36	        return f"""
37	        SELECT {self._get_count_columns(max_steps)} {self._get_step_time_avgs(max_steps)} {self._get_step_time_median(max_steps)} {breakdown_clause} FROM (
38	                {self.get_step_counts_query()}
39	        ) {'GROUP BY prop' if breakdown_clause != '' else ''} SETTINGS allow_experimental_window_functions = 1
40	        """
41	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel.py:48:15
47	
48	        return f"""
49	            SELECT aggregation_target, steps {self._get_step_time_avgs(max_steps, inner_query=True)} {self._get_step_time_median(max_steps, inner_query=True)} {self._get_matching_event_arrays(max_steps)} {breakdown_clause} {outer_timestamps} FROM (
50	                SELECT aggregation_target, steps, max(steps) over (PARTITION BY aggregation_target {breakdown_clause}) as max_steps {self._get_step_time_names(max_steps)} {self._get_matching_events(max_steps)} {breakdown_clause} {inner_timestamps} FROM (
51	                        {steps_per_person_query}
52	                )
53	            ) GROUP BY aggregation_target, steps {breakdown_clause}
54	            HAVING steps = max_steps
55	            SETTINGS allow_experimental_window_functions = 1
56	        """
57	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel.py:146:15
145	
146	        return f"""
147	        SELECT *, {self._get_sorting_condition(max_steps, max_steps)} AS steps {exclusion_clause} {self._get_step_times(max_steps)}{self._get_matching_events(max_steps)} {breakdown_query} FROM (
148	            {formatted_query}
149	        ) WHERE step_0 = 1
150	        {'AND exclusion = 0' if exclusion_clause else ''}
151	        SETTINGS allow_experimental_window_functions = 1
152	        """
153	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel.py:193:19
192	        if level_index >= max_steps:
193	            return f"""
194	            SELECT
195	            aggregation_target,
196	            timestamp,
197	            {self._get_partition_cols(1, max_steps)}
198	            {self._get_breakdown_prop(group_remaining=True)}
199	            FROM ({self._get_inner_event_query()})
200	            """
201	        else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel.py:202:19
201	        else:
202	            return f"""
203	            SELECT
204	            aggregation_target,
205	            timestamp,
206	            {self._get_partition_cols(level_index, max_steps)}
207	            {self._get_breakdown_prop()}
208	            FROM (
209	                SELECT
210	                aggregation_target,
211	                timestamp,
212	                {self.get_comparison_cols(level_index, max_steps)}
213	                {self._get_breakdown_prop()}
214	                FROM ({self.build_step_subquery(level_index + 1, max_steps)})
215	            )
216	            """

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_correlation.py:174:16
173	
174	        query = f"""
175	            WITH
176	                funnel_actors as ({funnel_persons_query}),
177	                toDateTime(%(date_to)s) AS date_to,
178	                toDateTime(%(date_from)s) AS date_from,
179	                %(target_step)s AS target_step,
180	                %(funnel_step_names)s as funnel_step_names
181	
182	            SELECT
183	                event.event AS name,
184	
185	                -- If we have a `person.steps = target_step`, we know the person
186	                -- reached the end of the funnel
187	                countDistinctIf(
188	                    actors.actor_id,
189	                    actors.steps = target_step
190	                ) AS success_count,
191	
192	                -- And the converse being for failures
193	                countDistinctIf(
194	                    actors.actor_id,
195	                    actors.steps <> target_step
196	                ) AS failure_count
197	
198	            FROM events AS event
199	                {event_join_query}
200	                AND event.event NOT IN %(exclude_event_names)s
201	            GROUP BY name
202	
203	            -- To get the total success/failure numbers, we do an aggregation on
204	            -- the funnel people CTE and count distinct actor_ids
205	            UNION ALL
206	
207	            SELECT
208	                -- We're not using WITH TOTALS because the resulting queries are
209	                -- not runnable in Metabase
210	                '{self.TOTAL_IDENTIFIER}' as name,
211	
212	                countDistinctIf(
213	                    actors.actor_id,
214	                    actors.steps = target_step
215	                ) AS success_count,
216	
217	                countDistinctIf(
218	                    actors.actor_id,
219	                    actors.steps <> target_step
220	                ) AS failure_count
221	            FROM funnel_actors AS actors
222	        """
223	        params = {

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_correlation.py:257:16
256	
257	        query = f"""
258	            WITH
259	                funnel_actors as ({funnel_persons_query}),
260	                toDateTime(%(date_to)s) AS date_to,
261	                toDateTime(%(date_from)s) AS date_from,
262	                %(target_step)s AS target_step,
263	                %(funnel_step_names)s as funnel_step_names
264	
265	            SELECT concat(event_name, '::', prop.1, '::', prop.2) as name,
266	                   countDistinctIf(actor_id, steps = target_step) as success_count,
267	                   countDistinctIf(actor_id, steps <> target_step) as failure_count
268	            FROM (
269	                SELECT
270	                    actors.actor_id as actor_id,
271	                    actors.steps as steps,
272	                    events.event as event_name,
273	                    -- Same as what we do in $all property queries
274	                    {array_join_query}
275	                FROM events AS event
276	                    {event_join_query}
277	                    AND event.event IN %(event_names)s
278	            )
279	            GROUP BY name
280	            -- Discard high cardinality / low hits properties
281	            -- This removes the long tail of random properties with empty, null, or very small values
282	            HAVING (success_count + failure_count) > 2
283	            AND prop.1 NOT IN %(exclude_property_names)s
284	
285	            UNION ALL
286	            -- To get the total success/failure numbers, we do an aggregation on
287	            -- the funnel people CTE and count distinct actor_ids
288	            SELECT
289	                '{self.TOTAL_IDENTIFIER}' as name,
290	
291	                countDistinctIf(
292	                    actors.actor_id,
293	                    actors.steps = target_step
294	                ) AS success_count,
295	
296	                countDistinctIf(
297	                    actors.actor_id,
298	                    actors.steps <> target_step
299	                ) AS failure_count
300	            FROM funnel_actors AS actors
301	        """
302	        params = {

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_correlation.py:323:16
322	
323	        query = f"""
324	            WITH
325	                funnel_actors as ({funnel_actors_query}),
326	                %(target_step)s AS target_step
327	            SELECT
328	                concat(prop.1, '::', prop.2) as name,
329	                -- We generate a unique identifier for each property value as: PropertyName::Value
330	                countDistinctIf(actor_id, steps = target_step) AS success_count,
331	                countDistinctIf(actor_id, steps <> target_step) AS failure_count
332	            FROM (
333	                SELECT
334	                    actor_id,
335	                    funnel_actors.steps as steps,
336	                    /*
337	                        We can extract multiple property values at the same time, since we're
338	                        already querying the person table.
339	                        This gives us something like:
340	                        --------------------
341	                        person1, steps, [property_value_0, property_value_1, property_value_2]
342	                        person2, steps, [property_value_0, property_value_1, property_value_2]
343	
344	                        To group by property name, we need to extract the property from the array. ArrayJoin helps us do that.
345	                        It transforms the above into:
346	
347	                        --------------------
348	
349	                        person1, steps, property_value_0
350	                        person1, steps, property_value_1
351	                        person1, steps, property_value_2
352	
353	                        person2, steps, property_value_0
354	                        person2, steps, property_value_1
355	                        person2, steps, property_value_2
356	
357	                        To avoid clashes and clarify the values, we also zip with the property name, to generate
358	                        tuples like: (property_name, property_value), which we then group by
359	                    */
360	                    {person_prop_query}
361	                FROM funnel_actors
362	                {aggregation_join_query}
363	
364	            ) aggregation_target_with_props
365	            -- Group by the tuple items: (property_name, property_value) generated by zip
366	            GROUP BY prop.1, prop.2
367	            HAVING prop.1 NOT IN %(exclude_property_names)s
368	            UNION ALL
369	            SELECT
370	                '{self.TOTAL_IDENTIFIER}' as name,
371	                countDistinctIf(actor_id, steps = target_step) AS success_count,
372	                countDistinctIf(actor_id, steps <> target_step) AS failure_count
373	            FROM funnel_actors
374	        """
375	        params = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\funnel_correlation_persons.py:71:8
70	
71	        assert isinstance(self._filter.correlation_person_entity, Entity)
72	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_correlation_persons.py:95:16
94	
95	        query = f"""
96	            WITH
97	                funnel_actors as ({funnel_persons_query}),
98	                toDateTime(%(date_to)s) AS date_to,
99	                toDateTime(%(date_from)s) AS date_from,
100	                %(target_step)s AS target_step,
101	                %(funnel_step_names)s as funnel_step_names
102	            SELECT
103	                actors.actor_id AS actor_id
104	                {recording_event_select_statement}
105	            FROM events AS event
106	                {event_join_query}
107	                AND event.event = %(target_event)s
108	                {conversion_filter}
109	                {prop_query}
110	            GROUP BY actor_id
111	            ORDER BY actor_id
112	            {"LIMIT %(limit)s" if limit_actors else ""}
113	            {"OFFSET %(offset)s" if limit_actors else ""}
114	        """
115	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_correlation_persons.py:159:16
158	
159	        query = f"""
160	            WITH
161	                funnel_actors AS ({funnel_persons_query}),
162	                %(target_step)s AS target_step
163	            SELECT
164	                funnel_actors.actor_id AS actor_id
165	                {recording_event_select_statement}
166	            FROM funnel_actors
167	            {actor_join_subquery}
168	            WHERE {conversion_filter}
169	            {group_filters}
170	            GROUP BY funnel_actors.actor_id
171	            ORDER BY actor_id
172	            {"LIMIT %(limit)s" if limit_actors else ""}
173	            {"OFFSET %(offset)s" if limit_actors else ""}
174	        """
175	        params = {

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_event_query.py:72:16
71	
72	        query = f"""
73	            SELECT {', '.join(_fields)} FROM events {self.EVENT_TABLE_ALIAS}
74	            {self._get_distinct_id_query()}
75	            {person_query}
76	            {groups_query}
77	            WHERE team_id = %(team_id)s
78	            {entity_query}
79	            {date_query}
80	            {prop_query}
81	        """
82	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_strict.py:12:15
11	
12	        return f"""
13	        SELECT {self._get_count_columns(max_steps)} {self._get_step_time_avgs(max_steps)} {self._get_step_time_median(max_steps)} {breakdown_clause} FROM (
14	            {self.get_step_counts_query()}
15	        ) {'GROUP BY prop' if breakdown_clause != '' else ''} SETTINGS allow_experimental_window_functions = 1
16	        """
17	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_strict.py:25:15
24	
25	        return f"""
26	            SELECT aggregation_target, steps {self._get_step_time_avgs(max_steps, inner_query=True)} {self._get_step_time_median(max_steps, inner_query=True)} {breakdown_clause} {outer_timestamps} {self._get_matching_event_arrays(max_steps)} FROM (
27	                SELECT aggregation_target, steps, max(steps) over (PARTITION BY aggregation_target {breakdown_clause}) as max_steps {self._get_step_time_names(max_steps)} {breakdown_clause} {inner_timestamps} {self._get_matching_events(max_steps)} FROM (
28	                        {steps_per_person_query}
29	                )
30	            ) GROUP BY aggregation_target, steps {breakdown_clause}
31	            HAVING steps = max_steps
32	        """
33	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_strict.py:41:22
40	
41	        inner_query = f"""
42	            SELECT
43	            aggregation_target,
44	            timestamp,
45	            {partition_select}
46	            {breakdown_clause}
47	            FROM ({self._get_inner_event_query(skip_entity_filter=True, skip_step_filter=True)})
48	        """
49	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_strict.py:50:26
49	
50	        formatted_query = f"""
51	            SELECT *, {sorting_condition} AS steps {self._get_step_times(max_steps)}{self._get_matching_events(max_steps)} FROM (
52	                    {inner_query}
53	                ) WHERE step_0 = 1"""
54	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_time_to_convert.py:66:16
65	
66	        query = f"""
67	            WITH
68	                step_runs AS (
69	                    SELECT * FROM (
70	                        {steps_per_person_query}
71	                    ) WHERE {" AND ".join(steps_average_conditional_for_invalid_values)}
72	                ),
73	                histogram_params AS (
74	                    /* Binning ensures that each sample belongs to a bin in results */
75	                    /* If bin_count is not a custom number, it's calculated in bin_count_expression */
76	                    SELECT
77	                        floor(min({steps_average_conversion_time_expression_sum})) AS from_seconds,
78	                        ceil(max({steps_average_conversion_time_expression_sum})) AS to_seconds,
79	                        round(avg({steps_average_conversion_time_expression_sum}), 2) AS average_conversion_time,
80	                        {bin_count_expression or ""}
81	                        ceil((to_seconds - from_seconds) / {bin_count_identifier}) AS bin_width_seconds_raw,
82	                        /* Use 60 seconds as fallback bin width in case of only one sample */
83	                        if(bin_width_seconds_raw > 0, bin_width_seconds_raw, 60) AS bin_width_seconds
84	                    FROM step_runs
85	                ),
86	                /* Below CTEs make histogram_params columns available to the query below as straightforward identifiers */
87	                ( SELECT bin_width_seconds FROM histogram_params ) AS bin_width_seconds,
88	                /* bin_count is only made available as an identifier if it had to be calculated */
89	                {
90	                    f"( SELECT {bin_count_identifier} FROM histogram_params ) AS {bin_count_identifier},"
91	                    if bin_count_expression else ""
92	                }
93	                ( SELECT from_seconds FROM histogram_params ) AS histogram_from_seconds,
94	                ( SELECT to_seconds FROM histogram_params ) AS histogram_to_seconds,
95	                ( SELECT average_conversion_time FROM histogram_params ) AS histogram_average_conversion_time
96	            SELECT
97	                bin_from_seconds,
98	                person_count,
99	                histogram_average_conversion_time AS average_conversion_time
100	            FROM (
101	                /* Calculating bins from step runs */
102	                SELECT
103	                    histogram_from_seconds + floor(({steps_average_conversion_time_expression_sum} - histogram_from_seconds) / bin_width_seconds) * bin_width_seconds AS bin_from_seconds,
104	                    count() AS person_count
105	                FROM step_runs
106	                GROUP BY bin_from_seconds
107	            ) results
108	            RIGHT OUTER JOIN (
109	                /* Making sure bin_count bins are returned */
110	                /* Those not present in the results query due to lack of data simply get person_count 0 */
111	                SELECT histogram_from_seconds + number * bin_width_seconds AS bin_from_seconds FROM system.numbers LIMIT ifNull({bin_count_identifier}, 0) + 1
112	            ) fill
113	            USING (bin_from_seconds)
114	            ORDER BY bin_from_seconds
115	            SETTINGS allow_experimental_window_functions = 1"""
116	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_time_to_convert.py:90:20
89	                {
90	                    f"( SELECT {bin_count_identifier} FROM histogram_params ) AS {bin_count_identifier},"
91	                    if bin_count_expression else ""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_trends.py:78:15
77	        breakdown_clause = self._get_breakdown_prop()
78	        return f"""
79	            SELECT
80	                aggregation_target,
81	                {trunc_func}(timestamp) AS entrance_period_start,
82	                max(steps) AS steps_completed
83	                {event_select_clause}
84	                {breakdown_clause}
85	            FROM (
86	                {steps_per_person_query}
87	            )
88	            {"WHERE toDateTime(entrance_period_start) = %(entrance_period_start)s" if specific_entrance_period_start else ""}
89	            GROUP BY aggregation_target, entrance_period_start {breakdown_clause}"""
90	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_trends.py:117:16
116	
117	        query = f"""
118	            SELECT
119	                entrance_period_start,
120	                reached_from_step_count,
121	                reached_to_step_count,
122	                if(reached_from_step_count > 0, round(reached_to_step_count / reached_from_step_count * 100, 2), 0) AS conversion_rate
123	                {breakdown_clause}
124	            FROM (
125	                SELECT
126	                    entrance_period_start,
127	                    countIf({reached_from_step_count_condition}) AS reached_from_step_count,
128	                    countIf({reached_to_step_count_condition}) AS reached_to_step_count
129	                    {breakdown_clause}
130	                FROM (
131	                    {step_counts}
132	                ) GROUP BY entrance_period_start {breakdown_clause}
133	            ) data
134	            RIGHT OUTER JOIN (
135	                SELECT
136	                    {trunc_func}(toDateTime(%(formatted_date_from)s) + {interval_func}(number)) AS entrance_period_start
137	                    {', breakdown_value as prop' if breakdown_clause else ''}
138	                FROM numbers(dateDiff(%(interval)s, toDateTime(%(formatted_date_from)s), toDateTime(%(formatted_date_to)s)) + 1) AS period_offsets
139	                {'ARRAY JOIN (%(breakdown_values)s) AS breakdown_value' if breakdown_clause else ''}
140	            ) fill
141	            USING (entrance_period_start {breakdown_clause})
142	            ORDER BY entrance_period_start ASC
143	            SETTINGS allow_experimental_window_functions = 1"""
144	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_unordered.py:44:15
43	
44	        return f"""
45	        SELECT {self._get_count_columns(max_steps)} {self._get_step_time_avgs(max_steps)} {self._get_step_time_median(max_steps)} {breakdown_clause} FROM (
46	            {self.get_step_counts_query()}
47	        ) {'GROUP BY prop' if breakdown_clause != '' else ''} SETTINGS allow_experimental_window_functions = 1
48	        """
49	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_unordered.py:58:15
57	
58	        return f"""
59	            SELECT aggregation_target, steps {self._get_step_time_avgs(max_steps, inner_query=True)} {self._get_step_time_median(max_steps, inner_query=True)} {breakdown_clause} {outer_timestamps} FROM (
60	                SELECT aggregation_target, steps, max(steps) over (PARTITION BY aggregation_target {breakdown_clause}) as max_steps {self._get_step_time_names(max_steps)} {breakdown_clause} {inner_timestamps} FROM (
61	                        {union_query}
62	                )
63	            ) GROUP BY aggregation_target, steps {breakdown_clause}
64	            HAVING steps = max_steps
65	        """
66	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_unordered.py:78:26
77	        for i in range(max_steps):
78	            inner_query = f"""
79	                SELECT
80	                aggregation_target,
81	                timestamp,
82	                {partition_select}
83	                {breakdown_clause}
84	                FROM ({self._get_inner_event_query(entities_to_use, f"events_{i}")})
85	            """
86	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\funnels\funnel_unordered.py:87:30
86	
87	            formatted_query = f"""
88	                SELECT *, {sorting_condition} AS steps {exclusion_clause} {self._get_step_times(max_steps)} FROM (
89	                        {inner_query}
90	                    ) WHERE step_0 = 1
91	                    {'AND exclusion = 0' if exclusion_clause else ''}
92	                    """
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\test\breakdown_cases.py:1369:4
1368	
1369	    assert len(left) == len(right)
1370	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\test\breakdown_cases.py:1373:8
1372	        other = exclude_people_urls_from_funnel_response(right)[index]
1373	        assert item.keys() == other.keys()
1374	        for key in item.keys():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\test\breakdown_cases.py:1376:16
1375	            try:
1376	                assert item[key] == other[key]
1377	            except AssertionError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\test\breakdown_cases.py:1390:4
1389	    """
1390	    assert [exclude_people_urls_from_funnel_response(result) for result in left] == [
1391	        exclude_people_urls_from_funnel_response(result) for result in right
1392	    ]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\funnels\test\test_funnel.py:1331:12
1330	        except KeyError as ke:
1331	            assert False, f"Should not have raised a key error: {ke}"
1332	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\groups_join_query.py:38:16
37	            join_queries.append(
38	                f"""
39	                INNER JOIN (
40	                    SELECT
41	                        group_key,
42	                        argMax(group_properties, _timestamp) AS group_properties_{group_type_index}
43	                    FROM groups
44	                    WHERE team_id = %(team_id)s AND group_type_index = %({var})s
45	                    GROUP BY group_key
46	                ) groups_{group_type_index}
47	                ON {group_join_key} == groups_{group_type_index}.group_key
48	                """
49	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\paths\path_event_query.py:91:16
90	
91	        query = f"""
92	            SELECT {','.join(_fields)} FROM events {self.EVENT_TABLE_ALIAS}
93	            {self._get_distinct_id_query()}
94	            {person_query}
95	            {groups_query}
96	            {funnel_paths_join}
97	            WHERE team_id = %(team_id)s
98	            {event_query}
99	            {date_query}
100	            {prop_query}
101	            {funnel_paths_filter}
102	            ORDER BY {self.DISTINCT_ID_TABLE_ALIAS}.person_id, {self.EVENT_TABLE_ALIAS}.timestamp
103	        """
104	        return query, self.params

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\paths\paths.py:211:15
210	
211	        return f"""
212	            SELECT last_path_key as source_event,
213	                path_key as target_event,
214	                COUNT(*) AS event_count,
215	                avg(conversion_time) AS average_conversion_time
216	            FROM ({paths_per_person_query})
217	            WHERE source_event IS NOT NULL
218	            GROUP BY source_event,
219	                    target_event
220	            {edge_weight_filter}
221	            ORDER BY event_count DESC,
222	                    source_event,
223	                    target_event
224	            {'LIMIT %(edge_limit)s' if self._filter.edge_limit else ''}
225	        """
226	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\paths\paths_actors.py:49:12
48	        return (
49	            f"""
50	            {paths_funnel_cte}
51	            SELECT
52	            {select_statement}
53	            FROM (
54	                {paths_per_person_query}
55	            )
56	            WHERE {person_path_filter}
57	            {group_statement}
58	            ORDER BY person_id
59	            {"LIMIT %(limit)s" if limit_actors else ""}
60	            {"OFFSET %(offset)s" if limit_actors else ""}
61	        """,
62	            self.params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\related_actors_query.py:51:16
50	            sync_execute(
51	                f"""
52	            SELECT DISTINCT person_id
53	            FROM events e
54	            {self._distinct_ids_join}
55	            WHERE team_id = %(team_id)s
56	              AND timestamp > %(after)s
57	              AND timestamp < %(before)s
58	              AND {self._filter_clause}
59	            """,
60	                self._params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\related_actors_query.py:73:16
72	            sync_execute(
73	                f"""
74	            SELECT DISTINCT $group_{group_type_index} AS group_key
75	            FROM events e
76	            {'' if self.is_aggregating_by_groups else self._distinct_ids_join}
77	            JOIN (
78	                SELECT group_key
79	                FROM groups
80	                WHERE team_id = %(team_id)s AND group_type_index = %(group_type_index)s
81	                GROUP BY group_key
82	            ) groups ON $group_{group_type_index} = groups.group_key
83	            WHERE team_id = %(team_id)s
84	              AND timestamp > %(after)s
85	              AND timestamp < %(before)s
86	              AND group_key != ''
87	              AND {self._filter_clause}
88	            ORDER BY group_key
89	            """,
90	                {**self._params, "group_type_index": group_type_index},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\retention\retention_event_query.py:143:16
142	
143	        query = f"""
144	            SELECT {','.join(_fields)} FROM events {self.EVENT_TABLE_ALIAS}
145	            {self._get_distinct_id_query()}
146	            {person_query}
147	            {groups_query}
148	            WHERE team_id = %(team_id)s
149	            {f"AND {entity_query}"}
150	            {f"AND {date_query}" if self._event_query_type != RetentionQueryType.TARGET_FIRST_TIME else ''}
151	            {prop_query}
152	            {f"GROUP BY target HAVING {date_query}" if self._event_query_type == RetentionQueryType.TARGET_FIRST_TIME else ''}
153	        """
154	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\stickiness\clickhouse_stickiness.py:41:16
40	
41	        query = f"""
42	        SELECT countDistinct(aggregation_target), num_intervals FROM ({events_query})
43	        WHERE num_intervals <= %(num_intervals)s
44	        GROUP BY num_intervals
45	        ORDER BY num_intervals
46	        """
47	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\stickiness\stickiness_actors.py:30:12
29	        return (
30	            f"""
31	        SELECT DISTINCT aggregation_target AS actor_id FROM ({events_query}) WHERE num_intervals = %(stickiness_day)s
32	        {"LIMIT %(limit)s" if limit_actors else ""}
33	        {"OFFSET %(offset)s" if limit_actors else ""}
34	        """,
35	            {

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\stickiness\stickiness_event_query.py:40:16
39	
40	        query = f"""
41	            SELECT
42	                {self.aggregation_target()} AS aggregation_target,
43	                countDistinct({get_trunc_func_ch(self._filter.interval)}(toDateTime(timestamp))) as num_intervals
44	            FROM events {self.EVENT_TABLE_ALIAS}
45	            {self._get_distinct_id_query()}
46	            {person_query}
47	            {groups_query}
48	            WHERE team_id = %(team_id)s
49	              {date_query}
50	              AND {actions_query}
51	              {prop_query}
52	            GROUP BY aggregation_target
53	        """
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_groups_join_query.py:8:4
7	
8	    assert GroupsJoinQuery(filter, 2).get_join_query() == ("", {})
9	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_groups_join_query.py:16:4
15	
16	    assert GroupsJoinQuery(filter, 2).get_join_query() == snapshot
17	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_groups_join_query.py:29:4
28	
29	    assert GroupsJoinQuery(filter, 2, join_key="call_me_industry").get_join_query() == snapshot

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\ee\clickhouse\queries\test\test_paths.py:45:8
44	            event_uuid = event.pop("uuid")
45	        except:
46	            pass
47	        data.update(event)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\test\test_paths.py:54:8
53	    sync_execute(
54	        f"""
55	    INSERT INTO {EVENTS_DATA_TABLE()} (uuid, event, properties, timestamp, team_id, distinct_id, elements_chain, created_at, _timestamp, _offset) VALUES
56	    {parsed}
57	    """
58	    )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_distinct_id_query.py:6:4
5	    person_distinct_id_query.using_new_table = True
6	    assert person_distinct_id_query.get_team_distinct_ids_query(2) == snapshot
7	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_distinct_id_query.py:9:4
8	    person_distinct_id_query.using_new_table = False
9	    assert person_distinct_id_query.get_team_distinct_ids_query(2) == snapshot
10	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:53:4
52	
53	    assert person_query(team, filter) == snapshot
54	    assert run_query(team, filter) == {"rows": 3, "columns": 1}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:54:4
53	    assert person_query(team, filter) == snapshot
54	    assert run_query(team, filter) == {"rows": 3, "columns": 1}
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:65:4
64	
65	    assert person_query(team, filter) == snapshot
66	    assert run_query(team, filter) == {"rows": 2, "columns": 1}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:66:4
65	    assert person_query(team, filter) == snapshot
66	    assert run_query(team, filter) == {"rows": 2, "columns": 1}
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:84:4
83	
84	    assert person_query(team, filter) == snapshot
85	    assert run_query(team, filter) == {"rows": 1, "columns": 1}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:85:4
84	    assert person_query(team, filter) == snapshot
85	    assert run_query(team, filter) == {"rows": 1, "columns": 1}
86	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:119:4
118	
119	    assert person_query(team, filter) == snapshot
120	    assert run_query(team, filter) == {"rows": 2, "columns": 2}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:120:4
119	    assert person_query(team, filter) == snapshot
120	    assert run_query(team, filter) == {"rows": 2, "columns": 2}
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:132:4
131	
132	    assert person_query(team, filter) == snapshot
133	    assert run_query(team, filter) == {"rows": 2, "columns": 2}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:133:4
132	    assert person_query(team, filter) == snapshot
133	    assert run_query(team, filter) == {"rows": 2, "columns": 2}
134	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:136:4
135	    filter = filter.with_data({"breakdown": "email", "breakdown_type": "person"})
136	    assert person_query(team, filter) == snapshot
137	    assert run_query(team, filter) == {"rows": 2, "columns": 2}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:137:4
136	    assert person_query(team, filter) == snapshot
137	    assert run_query(team, filter) == {"rows": 2, "columns": 2}
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:152:4
151	
152	    assert person_query(team, filter) == snapshot
153	    assert run_query(team, filter) == {"rows": 3, "columns": 2}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:153:4
152	    assert person_query(team, filter) == snapshot
153	    assert run_query(team, filter) == {"rows": 3, "columns": 2}
154	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:155:4
154	
155	    assert person_query(team, filter, entity=filter.entities[0]) == snapshot
156	    assert run_query(team, filter, entity=filter.entities[0]) == {"rows": 1, "columns": 1}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:156:4
155	    assert person_query(team, filter, entity=filter.entities[0]) == snapshot
156	    assert run_query(team, filter, entity=filter.entities[0]) == {"rows": 1, "columns": 1}
157	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:164:4
163	
164	    assert person_query(team, filter, extra_fields=["person_props", "pmat_email"]) == snapshot
165	    assert run_query(team, filter, extra_fields=["person_props", "pmat_email"]) == {"rows": 2, "columns": 3}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:165:4
164	    assert person_query(team, filter, extra_fields=["person_props", "pmat_email"]) == snapshot
165	    assert run_query(team, filter, extra_fields=["person_props", "pmat_email"]) == {"rows": 2, "columns": 3}
166	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:205:4
204	
205	    assert person_query(team, filter) == snapshot
206	    assert run_query(team, filter) == {"rows": 2, "columns": 3}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:206:4
205	    assert person_query(team, filter) == snapshot
206	    assert run_query(team, filter) == {"rows": 2, "columns": 3}
207	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:208:4
207	
208	    assert person_query(team, filter, entity=filter.entities[0]) == snapshot
209	    assert run_query(team, filter, entity=filter.entities[0]) == {"rows": 2, "columns": 2}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_person_query.py:209:4
208	    assert person_query(team, filter, entity=filter.entities[0]) == snapshot
209	    assert run_query(team, filter, entity=filter.entities[0]) == {"rows": 2, "columns": 2}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_property_optimizer.py:101:8
100	
101	        assert inner is not None
102	        assert outer is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_property_optimizer.py:102:8
101	        assert inner is not None
102	        assert outer is not None
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_property_optimizer.py:157:8
156	
157	        assert inner is not None
158	        assert outer is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_property_optimizer.py:158:8
157	        assert inner is not None
158	        assert outer is not None
159	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_property_optimizer.py:225:8
224	
225	        assert inner is not None
226	        assert outer is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_property_optimizer.py:226:8
225	        assert inner is not None
226	        assert outer is not None
227	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_retention.py:130:8
129	
130	        assert [actor["id"] for actor in actor_result] == ["org:5", "org:6"]
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_util.py:27:4
26	
27	    assert get_earliest_timestamp(team.id) == datetime(2020, 1, 4, 14, 10, tzinfo=pytz.UTC)
28	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_util.py:33:4
32	
33	    assert get_earliest_timestamp(team.id) == datetime(2015, 1, 1, 1, tzinfo=pytz.UTC)
34	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_util.py:38:4
37	def test_get_earliest_timestamp_with_no_events(db, team):
38	    assert get_earliest_timestamp(team.id) == datetime(2021, 1, 14, tzinfo=pytz.UTC)
39	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\test\test_util.py:48:4
47	    queries, params = _parse_breakdown_cohorts([cohort1])
48	    assert len(queries) == 1
49	    sync_execute(queries[0], params)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\queries\trends\breakdown.py:214:8
213	        # :TRICKY: We only support string breakdown for event/person properties
214	        assert isinstance(self.filter.breakdown, str)
215	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\trends\formula.py:33:14
32	
33	        sql = """SELECT
34	            {date_select}
35	            arrayMap(({letters_select}) -> {formula}, {selects})
36	            {breakdown_value}
37	            {max_length}
38	            FROM ({first_query}) as sub_A
39	            {queries}
40	        """.format(
41	            date_select="'' as date," if is_aggregate else "sub_A.date,",

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\trends\lifecycle.py:106:12
105	        return (
106	            f"""
107	            SELECT DISTINCT
108	                person_id,
109	                toDateTime(dateTrunc(%(interval)s, events.timestamp)) AS period,
110	                person.created_at AS created_at
111	            FROM events AS {self.EVENT_TABLE_ALIAS}
112	            {self._get_distinct_id_query()}
113	            {person_query}
114	            {groups_query}
115	            WHERE team_id = %(team_id)s
116	            {entity_format_params["entity_query"]}
117	            {date_query}
118	            {prop_query}
119	        """,
120	            self.params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\queries\trends\trend_event_query.py:73:16
72	
73	        query = f"""
74	            SELECT {_fields} FROM events {self.EVENT_TABLE_ALIAS}
75	            {self._get_distinct_id_query()}
76	            {person_query}
77	            {groups_query}
78	            WHERE team_id = %(team_id)s
79	            {entity_query}
80	            {date_query}
81	            {prop_query}
82	        """
83	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\cohort.py:90:41
89	
90	GET_STATIC_COHORTPEOPLE_BY_PERSON_UUID = f"""
91	SELECT DISTINCT cohort_id
92	FROM {PERSON_STATIC_COHORT_TABLE}
93	WHERE team_id = %(team_id)s AND person_id = %(person_id)s
94	"""
95	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\cohort.py:105:39
104	
105	GET_STATIC_COHORTPEOPLE_BY_COHORT_ID = f"""
106	SELECT person_id
107	FROM {PERSON_STATIC_COHORT_TABLE}
108	WHERE team_id = %(team_id)s AND cohort_id = %(cohort_id)s
109	GROUP BY person_id, cohort_id, team_id
110	"""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\dead_letter_queue.py:56:33
55	
56	DEAD_LETTER_QUEUE_TABLE_MV_SQL = """
57	CREATE MATERIALIZED VIEW IF NOT EXISTS {table_name}_mv ON CLUSTER '{cluster}'
58	TO {database}.{table_name}
59	AS SELECT
60	id,
61	event_uuid,
62	event,
63	properties,
64	distinct_id,
65	team_id,
66	elements_chain,
67	created_at,
68	ip,
69	site_url,
70	now,
71	raw_payload,
72	error_timestamp,
73	error_location,
74	error,
75	tags,
76	_timestamp,
77	_offset
78	FROM {database}.kafka_{table_name}
79	""".format(
80	    table_name=DEAD_LETTER_QUEUE_TABLE, cluster=CLICKHOUSE_CLUSTER, database=CLICKHOUSE_DATABASE,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\events.py:80:30
79	# related to https://github.com/ClickHouse/ClickHouse/issues/10471
80	EVENTS_TABLE_MV_SQL = lambda: """
81	CREATE MATERIALIZED VIEW events_mv ON CLUSTER '{cluster}'
82	TO {database}.{target_table}
83	AS SELECT
84	uuid,
85	event,
86	properties,
87	timestamp,
88	team_id,
89	distinct_id,
90	elements_chain,
91	created_at,
92	_timestamp,
93	_offset
94	FROM {database}.kafka_events
95	""".format(
96	    target_table="writable_events" if settings.CLICKHOUSE_REPLICATION else EVENTS_DATA_TABLE(),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\events.py:272:20
271	
272	ELEMENT_TAG_COUNT = """
273	SELECT concat('<', {tag_regex}, '> ', {text_regex}) AS tag_name,
274	       events.elements_chain,
275	       count(*) as tag_count
276	FROM events
277	WHERE events.team_id = %(team_id)s AND event = '$autocapture'
278	GROUP BY tag_name, elements_chain
279	ORDER BY tag_count desc, tag_name
280	LIMIT %(limit)s
281	""".format(
282	    tag_regex=EXTRACT_TAG_REGEX, text_regex=EXTRACT_TEXT_REGEX

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\groups.py:42:22
41	# related to https://github.com/ClickHouse/ClickHouse/issues/10471
42	GROUPS_TABLE_MV_SQL = f"""
43	CREATE MATERIALIZED VIEW {GROUPS_TABLE}_mv ON CLUSTER '{CLICKHOUSE_CLUSTER}'
44	TO {CLICKHOUSE_DATABASE}.{GROUPS_TABLE}
45	AS SELECT
46	group_type_index,
47	group_key,
48	created_at,
49	team_id,
50	group_properties,
51	_timestamp,
52	_offset
53	FROM {CLICKHOUSE_DATABASE}.kafka_{GROUPS_TABLE}
54	"""
55	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\person.py:50:23
49	# related to https://github.com/ClickHouse/ClickHouse/issues/10471
50	PERSONS_TABLE_MV_SQL = """
51	CREATE MATERIALIZED VIEW {table_name}_mv ON CLUSTER '{cluster}'
52	TO {database}.{table_name}
53	AS SELECT
54	id,
55	created_at,
56	team_id,
57	properties,
58	is_identified,
59	is_deleted,
60	_timestamp,
61	_offset
62	FROM {database}.kafka_{table_name}
63	""".format(
64	    table_name=PERSONS_TABLE, cluster=CLICKHOUSE_CLUSTER, database=CLICKHOUSE_DATABASE,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\person.py:79:27
78	
79	GET_LATEST_PERSON_ID_SQL = """
80	(select id from (
81	    {latest_person_sql}
82	))
83	""".format(
84	    latest_person_sql=GET_LATEST_PERSON_SQL

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\person.py:138:35
137	# related to https://github.com/ClickHouse/ClickHouse/issues/10471
138	PERSONS_DISTINCT_ID_TABLE_MV_SQL = """
139	CREATE MATERIALIZED VIEW {table_name}_mv ON CLUSTER '{cluster}'
140	TO {database}.{table_name}
141	AS SELECT
142	distinct_id,
143	person_id,
144	team_id,
145	coalesce(_sign, if(is_deleted==0, 1, -1)) AS _sign,
146	_timestamp,
147	_offset
148	FROM {database}.kafka_{table_name}
149	""".format(
150	    table_name=PERSONS_DISTINCT_ID_TABLE, cluster=CLICKHOUSE_CLUSTER, database=CLICKHOUSE_DATABASE,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\person.py:194:29
193	# related to https://github.com/ClickHouse/ClickHouse/issues/10471
194	PERSON_DISTINCT_ID2_MV_SQL = """
195	CREATE MATERIALIZED VIEW {table_name}_mv ON CLUSTER '{cluster}'
196	TO {database}.{table_name}
197	AS SELECT
198	team_id,
199	distinct_id,
200	person_id,
201	is_deleted,
202	version,
203	_timestamp,
204	_offset,
205	_partition
206	FROM {database}.kafka_{table_name}
207	""".format(
208	    table_name=PERSON_DISTINCT_ID2_TABLE, cluster=CLICKHOUSE_CLUSTER, database=CLICKHOUSE_DATABASE,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\person.py:274:27
273	
274	GET_PERSON_IDS_BY_FILTER = """
275	SELECT DISTINCT p.id
276	FROM ({latest_person_sql}) AS p
277	INNER JOIN ({GET_TEAM_PERSON_DISTINCT_IDS}) AS pdi ON p.id = pdi.person_id
278	WHERE team_id = %(team_id)s
279	  {distinct_query}
280	{limit}
281	{offset}
282	""".format(
283	    latest_person_sql=GET_LATEST_PERSON_SQL,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\plugin_log_entries.py:47:34
46	
47	PLUGIN_LOG_ENTRIES_TABLE_MV_SQL = """
48	CREATE MATERIALIZED VIEW {table_name}_mv ON CLUSTER '{cluster}'
49	TO {database}.{table_name}
50	AS SELECT
51	id,
52	team_id,
53	plugin_id,
54	plugin_config_id,
55	timestamp,
56	source,
57	type,
58	message,
59	instance_id,
60	_timestamp,
61	_offset
62	FROM {database}.kafka_{table_name}
63	""".format(
64	    table_name=PLUGIN_LOG_ENTRIES_TABLE, cluster=CLICKHOUSE_CLUSTER, database=CLICKHOUSE_DATABASE,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\session_recording_events.py:70:48
69	
70	SESSION_RECORDING_EVENTS_TABLE_MV_SQL = lambda: """
71	CREATE MATERIALIZED VIEW session_recording_events_mv ON CLUSTER '{cluster}'
72	TO {database}.{target_table}
73	AS SELECT
74	uuid,
75	timestamp,
76	team_id,
77	distinct_id,
78	session_id,
79	window_id,
80	snapshot_data,
81	created_at,
82	_timestamp,
83	_offset
84	FROM {database}.kafka_session_recording_events
85	""".format(
86	    target_table=(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\sql\test\test_schema.py:15:4
14	
15	    assert build_query(query) == snapshot
16	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\sql\test\test_schema.py:23:4
22	
23	    assert build_query(query) == snapshot
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\sql\test\test_schema.py:30:4
29	
30	    assert build_query(query) == snapshot
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\sql\test\test_schema.py:36:4
35	
36	    assert KAFKA_EVENTS_TABLE_SQL() == snapshot
37	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\trends\lifecycle.py:57:16
56	
57	LIFECYCLE_SQL = f"""
58	WITH
59	    %(interval)s AS selected_period,
60	
61	    -- enumerate all requested periods, so we can zero fill as needed.
62	    -- NOTE: we use dateSub interval rather than seconds, which means we can handle,
63	    -- for instance, month intervals which do not have a fixed number of seconds.
64	    periods AS (
65	        SELECT dateSub(
66	            {{interval_expr}},
67	            number,
68	            dateTrunc(selected_period, toDateTime(%(date_to)s))
69	        ) AS start_of_period
70	        FROM numbers(
71	            dateDiff(
72	                %(interval)s,
73	                dateTrunc(%(interval)s, toDateTime(%(date_from)s)),
74	                dateTrunc(%(interval)s, toDateTime(%(date_to)s) + INTERVAL 1 {{interval_expr}})
75	            )
76	        )
77	    )
78	SELECT
79	    groupArray(start_of_period) as date,
80	    groupArray(counts) as data,
81	    status
82	FROM (
83	    SELECT if(
84	            status = 'dormant',
85	            toInt64(SUM(counts)) * toInt16(-1),
86	            toInt64(SUM(counts))
87	        ) as counts,
88	        start_of_period,
89	        status
90	
91	    FROM (
92	        SELECT periods.start_of_period as start_of_period, toUInt16(0) AS counts, status
93	
94	        FROM periods
95	
96	        -- Zero fill for each status
97	        CROSS JOIN (
98	            SELECT status
99	            FROM (
100	                SELECT ['new', 'returning', 'resurrecting', 'dormant'] as status
101	            ) ARRAY JOIN status
102	        ) as sec
103	        ORDER BY status, start_of_period
104	
105	        UNION ALL
106	
107	        SELECT start_of_period, count(DISTINCT person_id) counts, status
108	        FROM ({_LIFECYCLE_EVENTS_QUERY})
109	        WHERE start_of_period <= dateTrunc(%(interval)s, toDateTime(%(date_to)s))
110	          AND start_of_period >= dateTrunc(%(interval)s, toDateTime(%(date_from)s))
111	        GROUP BY start_of_period, status
112	    )
113	    GROUP BY start_of_period, status
114	    ORDER BY start_of_period ASC
115	)
116	GROUP BY status
117	"""
118	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\sql\trends\lifecycle.py:119:23
118	
119	LIFECYCLE_PEOPLE_SQL = f"""
120	SELECT person_id
121	FROM ({_LIFECYCLE_EVENTS_QUERY}) e
122	WHERE status = %(status)s
123	AND dateTrunc(%(interval)s, toDateTime(%(target_date)s)) = start_of_period
124	LIMIT %(limit)s OFFSET %(offset)s
125	"""

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\ee\clickhouse\system_status.py:2:0
1	import glob
2	import subprocess
3	import tempfile

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\system_status.py:144:8
143	    return query_with_columns(
144	        f"""
145	            SELECT query_duration_ms as duration, query, *
146	            FROM system.query_log
147	            WHERE query_duration_ms > {SLOW_THRESHOLD_MS}
148	              AND event_time > %(after)s
149	              AND query NOT LIKE '%%system.query_log%%'
150	              AND query NOT LIKE '%%analyze_query:%%'
151	            ORDER BY duration DESC
152	            LIMIT 200
153	        """,
154	        {"after": timezone.now() - SLOW_AFTER},

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\ee\clickhouse\system_status.py:268:12
267	        with tempfile.TemporaryDirectory() as tmpdirname:
268	            subprocess.run(
269	                [
270	                    CLICKHOUSE_FLAMEGRAPH_EXECUTABLE,
271	                    "--query-id",
272	                    query_id,
273	                    "--clickhouse-dsn",
274	                    f"http://{CLICKHOUSE_USER}:{CLICKHOUSE_PASSWORD}@{CLICKHOUSE_STABLE_HOST}:8123/",
275	                    "--console",
276	                    "--flamegraph-script",
277	                    FLAMEGRAPH_PL,
278	                    "--date-from",
279	                    "2021-01-01",
280	                    "--width",
281	                    "1900",
282	                ],
283	                cwd=tmpdirname,
284	                check=True,
285	            )
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\test\test_error.py:23:4
22	    new_error = wrap_query_error(error)
23	    assert type(new_error).__name__ == expected_type
24	    assert str(new_error) == expected_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\test\test_error.py:24:4
23	    assert type(new_error).__name__ == expected_type
24	    assert str(new_error) == expected_message
25	    assert getattr(new_error, "code", None) == expected_code

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\test\test_error.py:25:4
24	    assert str(new_error) == expected_message
25	    assert getattr(new_error, "code", None) == expected_code

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\test\test_journeys.py:75:8
74	    sync_execute(
75	        f"""
76	    INSERT INTO {EVENTS_DATA_TABLE()} (uuid, event, properties, timestamp, team_id, distinct_id, elements_chain, created_at, _timestamp, _offset) VALUES
77	    {parsed}
78	    """
79	    )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bla'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\test\test_middleware.py:19:16
18	        # Test saving queries if we're impersonating a user
19	        user2 = User.objects.create_and_join(organization=self.organization, email="test", password="bla")
20	        self.client.post("/admin/login/user/{}/".format(user2.pk))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\test\test_system_status.py:6:4
5	    results = list(system_status())
6	    assert [row["key"] for row in results] == [
7	        "clickhouse_alive",
8	        "clickhouse_event_count",
9	        "clickhouse_event_count_last_month",
10	        "clickhouse_event_count_month_to_date",
11	        "clickhouse_disk_0_free_space",
12	        "clickhouse_disk_0_total_space",
13	        "clickhouse_table_sizes",
14	        "clickhouse_system_metrics",
15	        "last_event_ingested_timestamp",
16	        "dead_letter_queue_size",
17	        "dead_letter_queue_events_last_day",
18	        "dead_letter_queue_ratio_ok",
19	    ]
20	    assert len(results[6]["subrows"]["rows"]) > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\test\test_system_status.py:20:4
19	    ]
20	    assert len(results[6]["subrows"]["rows"]) > 0
21	    assert len(results[7]["subrows"]["rows"]) > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\test\test_system_status.py:21:4
20	    assert len(results[6]["subrows"]["rows"]) > 0
21	    assert len(results[7]["subrows"]["rows"]) > 0

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\views\groups.py:87:12
86	        rows = sync_execute(
87	            f"""
88	            SELECT group_type_index, tupleElement(keysAndValues, 1) as key, count(*) as count
89	            FROM groups
90	            ARRAY JOIN JSONExtractKeysAndValuesRaw(group_properties) as keysAndValues
91	            WHERE team_id = %(team_id)s
92	            GROUP BY group_type_index, tupleElement(keysAndValues, 1)
93	            ORDER BY group_type_index ASC, count DESC, key ASC
94	            """,
95	            {"team_id": self.team.pk},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\clickhouse\views\groups.py:107:12
106	        rows = sync_execute(
107	            f"""
108	            SELECT {trim_quotes_expr("tupleElement(keysAndValues, 2)")} as value
109	            FROM groups
110	            ARRAY JOIN JSONExtractKeysAndValuesRaw(group_properties) as keysAndValues
111	            WHERE team_id = %(team_id)s AND group_type_index = %(group_type_index)s AND tupleElement(keysAndValues, 1) = %(key)s
112	            GROUP BY tupleElement(keysAndValues, 2)
113	            ORDER BY value ASC
114	        """,
115	            {"team_id": self.team.pk, "group_type_index": request.GET["group_type_index"], "key": request.GET["key"]},

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:66:8
65	
66	        assert result["user signed up"]["count"] == 2
67	        assert result["paid"]["count"] == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:67:8
66	        assert result["user signed up"]["count"] == 2
67	        assert result["paid"]["count"] == 1
68	        assert result["paid"]["average_conversion_time"] == 86400

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:68:8
67	        assert result["paid"]["count"] == 1
68	        assert result["paid"]["average_conversion_time"] == 86400
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:72:8
71	        actor_ids = [str(val["id"]) for val in actors]
72	        assert actor_ids == ["org:5", "org:6"]
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:114:8
113	
114	        assert result["user signed up"]["count"] == 1
115	        assert result["paid"]["count"] == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:115:8
114	        assert result["user signed up"]["count"] == 1
115	        assert result["paid"]["count"] == 1
116	        assert result["paid"]["average_conversion_time"] == 86400

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:116:8
115	        assert result["paid"]["count"] == 1
116	        assert result["paid"]["average_conversion_time"] == 86400
117	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:120:8
119	        actor_ids = [str(val["id"]) for val in actors]
120	        assert actor_ids == ["org:5"]
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:164:8
163	
164	        assert result["user signed up"]["count"] == 1
165	        assert result["paid"]["count"] == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:165:8
164	        assert result["user signed up"]["count"] == 1
165	        assert result["paid"]["count"] == 1
166	        assert result["paid"]["average_conversion_time"] == 86400

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:166:8
165	        assert result["paid"]["count"] == 1
166	        assert result["paid"]["average_conversion_time"] == 86400
167	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:171:8
170	
171	        assert actor_ids == sorted([str(created_people["user_1"].uuid)])
172	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:218:8
217	
218	        assert result["user signed up"]["count"] == 1
219	        assert result["paid"]["count"] == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:219:8
218	        assert result["user signed up"]["count"] == 1
219	        assert result["paid"]["count"] == 0
220	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel.py:224:8
223	
224	        assert actor_ids == sorted([str(created_people["user_1"].uuid)])
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:40:8
39	        )
40	        assert response.status_code == 401
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:101:8
100	
101	        assert odds == {
102	            "is_cached": False,
103	            "last_refresh": "2020-01-01T00:00:00Z",
104	            "result": {
105	                "events": [
106	                    {
107	                        "event": {"event": "watched video", "elements": [], "properties": {}},
108	                        "failure_count": 1,
109	                        "success_count": 1,
110	                        "success_people_url": ANY,
111	                        "failure_people_url": ANY,
112	                        "odds_ratio": 1 / 2,
113	                        "correlation_type": "failure",
114	                    },
115	                ],
116	                "skewed": False,
117	            },
118	        }
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:173:12
172	
173	            assert odds_before == odds_after
174	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:214:8
213	
214	        assert odds == {
215	            "is_cached": False,
216	            "last_refresh": "2020-01-01T00:00:00Z",
217	            "result": {"events": [], "skewed": False},
218	        }
219	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:258:8
257	
258	        assert odds == {
259	            "is_cached": False,
260	            "last_refresh": "2020-01-01T00:00:00Z",
261	            "result": {
262	                "events": [
263	                    {
264	                        "correlation_type": "failure",
265	                        "event": {"event": "", "elements": [], "properties": {}},
266	                        "failure_count": 1,
267	                        "odds_ratio": 1 / 4,
268	                        "success_count": 0,
269	                        "success_people_url": ANY,
270	                        "failure_people_url": ANY,
271	                    }
272	                ],
273	                "skewed": False,
274	            },
275	        }
276	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:320:12
319	
320	            assert odds["result"]["events"][0]["event"]["event"] == "watched video"
321	            watched_video_correlation = odds["result"]["events"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:323:12
322	
323	            assert get_people_for_correlation_ok(client=self.client, correlation=watched_video_correlation) == {
324	                "success": ["Person 2"],
325	                "failure": ["Person 1"],
326	            }
327	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:372:12
371	
372	            assert odds["result"]["events"][0]["event"]["event"] == "watched video::$browser::1"
373	            watched_video_correlation = odds["result"]["events"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:375:12
374	
375	            assert get_people_for_correlation_ok(client=self.client, correlation=watched_video_correlation) == {
376	                "success": ["Person 2", "Person 3"],
377	                "failure": ["Person 1"],
378	            }
379	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:509:12
508	
509	            assert get_people_for_correlation_ok(client=self.client, correlation=browser_correlation) == {
510	                "success": ["Person 2"],
511	                "failure": ["Person 1"],
512	            }
513	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:514:12
513	
514	            assert get_people_for_correlation_ok(client=self.client, correlation=notset_correlation) == {
515	                "success": ["Person 3"],
516	                "failure": [],
517	            }
518	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:540:8
539	
540	        assert response == {
541	            "is_cached": False,
542	            "last_refresh": "2020-01-01T00:00:00Z",
543	            "result": {"events": [], "skewed": False},
544	        }
545	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:586:8
585	
586	        assert response == {
587	            "result": {
588	                "events": [
589	                    {
590	                        "success_count": 3,
591	                        "failure_count": 0,
592	                        "success_people_url": ANY,
593	                        "failure_people_url": ANY,
594	                        "odds_ratio": 8.0,
595	                        "correlation_type": "success",
596	                        "event": {
597	                            "event": '$autocapture::elements_chain::click__~~__a:href="/movie"nth-child="0"nth-of-type="1"',
598	                            "properties": {"$event_type": "click"},
599	                            "elements": [
600	                                {
601	                                    "event": None,
602	                                    "text": None,
603	                                    "tag_name": "a",
604	                                    "attr_class": None,
605	                                    "href": "/movie",
606	                                    "attr_id": None,
607	                                    "nth_child": 0,
608	                                    "nth_of_type": 1,
609	                                    "attributes": {},
610	                                    "order": 0,
611	                                }
612	                            ],
613	                        },
614	                    },
615	                ],
616	                "skewed": False,
617	            },
618	            "last_refresh": "2020-01-01T00:00:00Z",
619	            "is_cached": False,
620	        }
621	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_correlation.py:622:8
621	
622	        assert get_people_for_correlation_ok(client=self.client, correlation=response["result"]["events"][0]) == {
623	            "success": ["user_0", "user_1", "user_2"],
624	            "failure": [],
625	        }
626	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_unordered.py:76:8
75	
76	        assert result["user signed up"]["count"] == 2
77	        assert result["paid"]["count"] == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_unordered.py:77:8
76	        assert result["user signed up"]["count"] == 2
77	        assert result["paid"]["count"] == 1
78	        assert result["paid"]["average_conversion_time"] == 86400

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_unordered.py:78:8
77	        assert result["paid"]["count"] == 1
78	        assert result["paid"]["average_conversion_time"] == 86400
79	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\test_clickhouse_funnel_unordered.py:81:8
80	        actors = get_funnel_actors_ok(self.client, result["user signed up"]["converted_people_url"])
81	        assert len(actors) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\util.py:52:4
51	
52	    assert response.status_code == 200, response.content
53	    res = response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\util.py:65:4
64	
65	    assert response.status_code == 200, response.content
66	    return response.json()["results"][0]["people"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\util.py:79:4
78	
79	    assert response.status_code == 200, response.content
80	    return response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\util.py:95:4
94	    success_people_response = client.get(success_people_url)
95	    assert success_people_response.status_code == 200, success_people_response.content
96	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\funnel\util.py:98:4
97	    failure_people_response = client.get(failure_people_url)
98	    assert failure_people_response.status_code == 200, failure_people_response.content
99	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:24:15
23	        team = create_team(organization=organization)
24	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
25	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:63:8
62	
63	        assert retention_by_cohort_by_period == {
64	            "Day 0": {"1": ["person 2"], "2": [],},
65	            "Day 1": {"1": ["person 3"]},
66	        }
67	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:72:15
71	        team = create_team(organization=organization)
72	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:103:12
102	
103	            assert retention["result"][0]["values"][0]["count"] == 2  # person 1 and another one
104	            assert retention["result"][0]["values"][1]["count"] == 1  # person 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:104:12
103	            assert retention["result"][0]["values"][0]["count"] == 2  # person 1 and another one
104	            assert retention["result"][0]["values"][1]["count"] == 1  # person 1
105	            assert retention["result"][0]["values"][2]["count"] == 1  # another one

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:105:12
104	            assert retention["result"][0]["values"][1]["count"] == 1  # person 1
105	            assert retention["result"][0]["values"][2]["count"] == 1  # another one
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:108:12
107	            # person 2
108	            assert retention["result"][1]["values"][0]["count"] == 1
109	            assert retention["result"][1]["values"][1]["count"] == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:109:12
108	            assert retention["result"][1]["values"][0]["count"] == 1
109	            assert retention["result"][1]["values"][1]["count"] == 0
110	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:113:12
112	            people_response = self.client.get(people_url)
113	            assert people_response.status_code == 200
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:117:12
116	            # person1 and another one are the same person
117	            assert len(people) == 1
118	            assert people[0]["id"] == str(p1.uuid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:118:12
117	            assert len(people) == 1
118	            assert people[0]["id"] == str(p1.uuid)
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:122:12
121	            people_response = self.client.get(people_url)
122	            assert people_response.status_code == 200
123	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:125:12
124	            people = people_response.json()["result"]
125	            assert len(people) == 1
126	            assert people[0]["id"] == str(p2.uuid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:126:12
125	            assert len(people) == 1
126	            assert people[0]["id"] == str(p2.uuid)
127	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:133:15
132	        team = create_team(organization=organization)
133	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
134	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:166:8
165	
166	        assert retention_by_cohort_by_period == {
167	            "Day 0": {"1": ["person 1", "person 2"], "2": ["person 1"],},
168	            "Day 1": {"1": ["person 3"]},
169	        }
170	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:174:15
173	        team = create_team(organization=organization)
174	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:207:8
206	
207	        assert retention_by_cohort_by_period == {
208	            "Day 0": {"1": ["person 1", "person 2"], "2": ["person 1"],},
209	            "Day 1": {"1": ["person 3", "person 1"]},
210	        }
211	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:221:15
220	        team = create_team(organization=organization)
221	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
222	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:264:8
263	
264	        assert retention_by_cohort_by_period, {
265	            "Chrome": {"1": ["person 1"], "2": ["person 1"]},
266	            "Safari": {
267	                "1": ["person 2"],
268	                "2": ["person 2"],
269	            },  # IMPORTANT: the "2" value is from past the requested `date_to`
270	        }
271	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:281:15
280	        team = create_team(organization=organization)
281	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
282	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:327:8
326	
327	        assert retention_by_cohort_by_period == {
328	            "Chrome": {"1": ["person 1"], "2": ["person 1"]},
329	            "Safari": {
330	                "1": ["person 2"],
331	                "2": ["person 2"],
332	            },  # IMPORTANT: the "2" value is from past the requested `date_to`
333	        }
334	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:347:15
346	        team = create_team(organization=organization)
347	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:387:8
386	        people_response = self.client.get(people_url)
387	        assert people_response.status_code == 200
388	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:391:8
390	
391	        assert [distinct_id for person in people for distinct_id in person["distinct_ids"]] == ["person 1"]
392	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:398:15
397	        team = create_team(organization=organization)
398	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
399	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:429:8
428	
429	        assert retention_by_cohort_by_period == {
430	            "Week 0": {"1": ["person 1"], "2": [],},
431	            "Week 1": {"1": ["person 2"]},
432	        }
433	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:449:15
448	        team = create_team(organization=organization)
449	        user = create_user(email="test@posthog.com", password="1234", organization=organization)
450	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:468:8
467	
468	        assert response.status_code == 200
469	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:542:4
541	    response = get_retention(client=client, team_id=team_id, request=request)
542	    assert response.status_code == 200, response.content
543	    return response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:564:4
563	    response = client.get(people_url)
564	    assert response.status_code == 200
565	    return response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_retention.py:595:8
594	        # pagination so this could be wrong for large counts
595	        assert value["count"] == len(people_in_period)
596	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:39:4
38	    response = client.get("/" + url)
39	    assert response.status_code == 200, response.content
40	    return response.json()["results"][0]["people"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:76:8
75	
76	        assert data["watched movie"][1].value == 1
77	        assert data["watched movie"][2].value == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:77:8
76	        assert data["watched movie"][1].value == 1
77	        assert data["watched movie"][2].value == 0
78	        assert data["watched movie"][3].value == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:78:8
77	        assert data["watched movie"][2].value == 0
78	        assert data["watched movie"][3].value == 1
79	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:85:8
84	
85	        assert sorted([p["id"] for p in week1_actors]) == sorted([str(p1.pk)])
86	        assert sorted([p["id"] for p in week2_actors]) == sorted([])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:86:8
85	        assert sorted([p["id"] for p in week1_actors]) == sorted([str(p1.pk)])
86	        assert sorted([p["id"] for p in week2_actors]) == sorted([])
87	        assert sorted([p["id"] for p in week3_actors]) == sorted([str(p3.pk)])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:87:8
86	        assert sorted([p["id"] for p in week2_actors]) == sorted([])
87	        assert sorted([p["id"] for p in week3_actors]) == sorted([str(p3.pk)])
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:118:8
117	
118	        assert data["watched movie"][1].value == 2
119	        assert data["watched movie"][2].value == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:119:8
118	        assert data["watched movie"][1].value == 2
119	        assert data["watched movie"][2].value == 0
120	        assert data["watched movie"][3].value == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:120:8
119	        assert data["watched movie"][2].value == 0
120	        assert data["watched movie"][3].value == 1
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:127:8
126	
127	        assert sorted([p["id"] for p in week1_actors]) == sorted(["org:0", "org:2"])
128	        assert sorted([p["id"] for p in week2_actors]) == sorted([])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:128:8
127	        assert sorted([p["id"] for p in week1_actors]) == sorted(["org:0", "org:2"])
128	        assert sorted([p["id"] for p in week2_actors]) == sorted([])
129	        assert sorted([p["id"] for p in week3_actors]) == sorted(["org:1"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_stickiness.py:129:8
128	        assert sorted([p["id"] for p in week2_actors]) == sorted([])
129	        assert sorted([p["id"] for p in week3_actors]) == sorted(["org:1"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:94:8
93	        )
94	        assert trends == {
95	            "is_cached": False,
96	            "last_refresh": "2021-09-20T16:00:00Z",
97	            "next": None,
98	            "result": [
99	                {
100	                    "action": ANY,
101	                    "breakdown_value": cohort["id"],
102	                    "label": "$pageview - test cohort",
103	                    "count": 3.0,
104	                    "data": [1.0, 1.0, 1.0],
105	                    # Prior to the fix this would also include '29-Aug-2021'
106	                    "labels": ["5-Sep-2021", "12-Sep-2021", "19-Sep-2021"],
107	                    "days": ["2021-09-05", "2021-09-12", "2021-09-19"],
108	                    "persons_urls": ANY,
109	                    "filter": ANY,
110	                }
111	            ],
112	        }
113	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:166:8
165	
166	        assert interval_3_trend == {
167	            "is_cached": False,
168	            "last_refresh": "2021-09-20T16:00:00Z",
169	            "next": None,
170	            "result": [
171	                {
172	                    "action": ANY,
173	                    "label": "$pageview",
174	                    "count": 5,
175	                    "data": [2.0, 1, 2.0],
176	                    "labels": ["1-Sep-2021", "2-Sep-2021", "3-Sep-2021"],
177	                    "days": ["2021-09-01", "2021-09-02", "2021-09-03"],
178	                    "persons_urls": ANY,
179	                    "filter": ANY,
180	                }
181	            ],
182	        }
183	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:207:8
206	
207	        assert interval_2_trend == {
208	            "is_cached": False,
209	            "last_refresh": "2021-09-20T16:00:00Z",
210	            "next": None,
211	            "result": [
212	                {
213	                    "action": ANY,
214	                    "label": "$pageview",
215	                    "count": 5,
216	                    "data": [2.0, 1, 2.0],
217	                    "labels": ["1-Sep-2021", "2-Sep-2021", "3-Sep-2021"],
218	                    "days": ["2021-09-01", "2021-09-02", "2021-09-03"],
219	                    "persons_urls": ANY,
220	                    "filter": ANY,
221	                }
222	            ],
223	        }
224	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:248:8
247	
248	        assert interval_1_trend == {
249	            "is_cached": False,
250	            "last_refresh": "2021-09-20T16:00:00Z",
251	            "next": None,
252	            "result": [
253	                {
254	                    "action": {
255	                        "id": "$pageview",
256	                        "type": "events",
257	                        "order": 0,
258	                        "name": "$pageview",
259	                        "custom_name": None,
260	                        "math": None,
261	                        "math_property": None,
262	                        "math_group_type_index": ANY,
263	                        "properties": {},
264	                    },
265	                    "label": "$pageview",
266	                    "count": 6.0,
267	                    "data": [2.0, 1.0, 3.0],
268	                    "labels": ["1-Sep-2021", "2-Sep-2021", "3-Sep-2021"],
269	                    "days": ["2021-09-01", "2021-09-02", "2021-09-03"],
270	                    "persons_urls": ANY,
271	                    "filter": ANY,
272	                }
273	            ],
274	        }
275	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:330:8
329	
330	        assert interval_3_trend == {
331	            "is_cached": False,
332	            "last_refresh": "2021-09-20T16:00:00Z",
333	            "next": None,
334	            "result": [
335	                {
336	                    "action": ANY,
337	                    "label": "$pageview",
338	                    "count": 6.0,
339	                    "data": [3.0, 1.0, 2.0],
340	                    "labels": ["1-Sep-2021", "2-Sep-2021", "3-Sep-2021"],
341	                    "days": ["2021-09-01", "2021-09-02", "2021-09-03"],
342	                    "persons_urls": ANY,
343	                    "filter": ANY,
344	                }
345	            ],
346	        }
347	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:371:8
370	
371	        assert interval_1_trend == {
372	            "is_cached": False,
373	            "last_refresh": "2021-09-20T16:00:00Z",
374	            "next": None,
375	            "result": [
376	                {
377	                    "action": ANY,
378	                    "label": "$pageview",
379	                    "count": 6.0,
380	                    "data": [3.0, 0.0, 3.0],
381	                    "labels": ["1-Sep-2021", "2-Sep-2021", "3-Sep-2021"],
382	                    "days": ["2021-09-01", "2021-09-02", "2021-09-03"],
383	                    "persons_urls": ANY,
384	                    "filter": ANY,
385	                }
386	            ],
387	        }
388	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:433:4
432	    response = get_trends(client=client, request=request, team=team)
433	    assert response.status_code == 200, response.content
434	    return response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:482:4
481	    response = client.get("/" + url)
482	    assert response.status_code == 200, response.content
483	    return response.json()["results"][0]["people"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:488:4
487	    response = client.get("/" + url)
488	    assert response.status_code == 200, response.content
489	    return response.json()["results"][0]["people"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:525:8
524	
525	        assert data["$pageview"]["2012-01-13"].value == 0
526	        assert data["$pageview"]["2012-01-14"].value == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:526:8
525	        assert data["$pageview"]["2012-01-13"].value == 0
526	        assert data["$pageview"]["2012-01-14"].value == 2
527	        assert data["$pageview"]["2012-01-14"].label == "14-Jan-2012"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:527:8
526	        assert data["$pageview"]["2012-01-14"].value == 2
527	        assert data["$pageview"]["2012-01-14"].label == "14-Jan-2012"
528	        assert data["$pageview"]["2012-01-15"].value == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:528:8
527	        assert data["$pageview"]["2012-01-14"].label == "14-Jan-2012"
528	        assert data["$pageview"]["2012-01-15"].value == 0
529	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:533:8
532	
533	        assert sorted([p["id"] for p in people]) == sorted(
534	            [str(created_people["1"].uuid), str(created_people["2"].uuid)]
535	        )
536	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:570:8
569	        # 'None' values have to be purged before formatting into the actor url
570	        assert sorted([p["id"] for p in actors]) == sorted([str(created_actors["1"].uuid)])
571	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:600:8
599	
600	        assert data["$pageview"].value == 2
601	        assert data["$pageview"].label == "$pageview"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:601:8
600	        assert data["$pageview"].value == 2
601	        assert data["$pageview"].label == "$pageview"
602	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:606:8
605	
606	        assert sorted([p["id"] for p in people]) == sorted(
607	            [str(created_people["1"].uuid), str(created_people["2"].uuid)]
608	        )
609	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:644:8
643	
644	        assert data_response["$pageview"]["2012-01-13"].value == 2
645	        assert data_response["$pageview"]["2012-01-14"].value == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:645:8
644	        assert data_response["$pageview"]["2012-01-13"].value == 2
645	        assert data_response["$pageview"]["2012-01-14"].value == 4
646	        assert data_response["$pageview"]["2012-01-15"].value == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:646:8
645	        assert data_response["$pageview"]["2012-01-14"].value == 4
646	        assert data_response["$pageview"]["2012-01-15"].value == 4
647	        assert data_response["$pageview"]["2012-01-14"].label == "14-Jan-2012"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:647:8
646	        assert data_response["$pageview"]["2012-01-15"].value == 4
647	        assert data_response["$pageview"]["2012-01-14"].label == "14-Jan-2012"
648	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:649:8
648	
649	        assert sorted([p["id"] for p in person_response]) == sorted(
650	            [str(created_people["p1"].uuid), str(created_people["p2"].uuid), str(created_people["p3"].uuid)]
651	        )
652	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:675:8
674	
675	        assert data_response["$pageview"]["2012-01-13"].value == 2
676	        assert data_response["$pageview"]["2012-01-14"].value == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:676:8
675	        assert data_response["$pageview"]["2012-01-13"].value == 2
676	        assert data_response["$pageview"]["2012-01-14"].value == 3
677	        assert data_response["$pageview"]["2012-01-15"].value == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:677:8
676	        assert data_response["$pageview"]["2012-01-14"].value == 3
677	        assert data_response["$pageview"]["2012-01-15"].value == 3
678	        assert data_response["$pageview"]["2012-01-14"].label == "14-Jan-2012"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:678:8
677	        assert data_response["$pageview"]["2012-01-15"].value == 3
678	        assert data_response["$pageview"]["2012-01-14"].label == "14-Jan-2012"
679	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:680:8
679	
680	        assert sorted([p["id"] for p in person_response]) == sorted(
681	            [str(created_people["p1"].uuid), str(created_people["p2"].uuid), str(created_people["p3"].uuid)]
682	        )
683	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:709:8
708	
709	        assert data_response["$pageview - val"]["2012-01-13"].value == 1
710	        assert data_response["$pageview - val"]["2012-01-13"].breakdown_value == "val"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:710:8
709	        assert data_response["$pageview - val"]["2012-01-13"].value == 1
710	        assert data_response["$pageview - val"]["2012-01-13"].breakdown_value == "val"
711	        assert data_response["$pageview - val"]["2012-01-14"].value == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:711:8
710	        assert data_response["$pageview - val"]["2012-01-13"].breakdown_value == "val"
711	        assert data_response["$pageview - val"]["2012-01-14"].value == 3
712	        assert data_response["$pageview - val"]["2012-01-14"].label == "14-Jan-2012"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:712:8
711	        assert data_response["$pageview - val"]["2012-01-14"].value == 3
712	        assert data_response["$pageview - val"]["2012-01-14"].label == "14-Jan-2012"
713	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:714:8
713	
714	        assert sorted([p["id"] for p in person_response]) == sorted(
715	            [str(created_people["p1"].uuid), str(created_people["p3"].uuid)]
716	        )
717	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:741:8
740	
741	        assert data_response["$pageview - val"]["2012-01-13"].value == 1
742	        assert data_response["$pageview - val"]["2012-01-13"].breakdown_value == "val"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:742:8
741	        assert data_response["$pageview - val"]["2012-01-13"].value == 1
742	        assert data_response["$pageview - val"]["2012-01-13"].breakdown_value == "val"
743	        assert data_response["$pageview - val"]["2012-01-14"].value == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:743:8
742	        assert data_response["$pageview - val"]["2012-01-13"].breakdown_value == "val"
743	        assert data_response["$pageview - val"]["2012-01-14"].value == 2
744	        assert data_response["$pageview - val"]["2012-01-14"].label == "14-Jan-2012"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:744:8
743	        assert data_response["$pageview - val"]["2012-01-14"].value == 2
744	        assert data_response["$pageview - val"]["2012-01-14"].label == "14-Jan-2012"
745	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:746:8
745	
746	        assert sorted([p["id"] for p in people]) == sorted(
747	            [str(created_people["p1"].uuid), str(created_people["p3"].uuid)]
748	        )
749	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:770:8
769	
770	        assert data_response["sign up - val"]["2012-01-13"].value == 1
771	        assert data_response["sign up - val"]["2012-01-13"].breakdown_value == "val"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:771:8
770	        assert data_response["sign up - val"]["2012-01-13"].value == 1
771	        assert data_response["sign up - val"]["2012-01-13"].breakdown_value == "val"
772	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:773:8
772	
773	        assert sorted([p["id"] for p in person_response]) == sorted([str(created_people["person1"].uuid)])
774	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:787:8
786	
787	        assert aggregate_response["sign up - val"].value == 1
788	        assert sorted([p["id"] for p in aggregate_person_response]) == sorted([str(created_people["person1"].uuid)])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:788:8
787	        assert aggregate_response["sign up - val"].value == 1
788	        assert sorted([p["id"] for p in aggregate_person_response]) == sorted([str(created_people["person1"].uuid)])
789	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:811:8
810	
811	        assert data_response["$pageview - current"]["2012-01-13"].value == 0
812	        assert data_response["$pageview - current"]["2012-01-14"].value == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:812:8
811	        assert data_response["$pageview - current"]["2012-01-13"].value == 0
812	        assert data_response["$pageview - current"]["2012-01-14"].value == 2
813	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:814:8
813	
814	        assert data_response["$pageview - previous"]["2012-01-04"].value == 0
815	        assert data_response["$pageview - previous"]["2012-01-05"].value == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:815:8
814	        assert data_response["$pageview - previous"]["2012-01-04"].value == 0
815	        assert data_response["$pageview - previous"]["2012-01-05"].value == 2
816	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:825:8
824	
825	        assert sorted([p["id"] for p in curr_people]) == sorted(
826	            [str(created_people["p1"].uuid), str(created_people["p2"].uuid)]
827	        )
828	        assert sorted([p["id"] for p in prev_people]) == sorted(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:828:8
827	        )
828	        assert sorted([p["id"] for p in prev_people]) == sorted(
829	            [str(created_people["p1"].uuid), str(created_people["p2"].uuid)]
830	        )
831	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:874:8
873	
874	        assert data_response["$pageview"]["2020-01-01"].value == 0
875	        assert data_response["$pageview"]["2020-01-02"].value == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:875:8
874	        assert data_response["$pageview"]["2020-01-01"].value == 0
875	        assert data_response["$pageview"]["2020-01-02"].value == 2
876	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\clickhouse\views\test\test_clickhouse_trends.py:879:8
878	
879	        assert sorted([p["group_key"] for p in curr_people]) == sorted(["org:5", "org:6"])

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\ee\management\commands\setup_test_environment.py:42:8
41	            database.create_database()
42	        except:
43	            pass
44	        database.migrate("ee.clickhouse.migrations", replicated=CLICKHOUSE_REPLICATION)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\ee\models\license.py:32:19
31	    def create(self, *args: Any, **kwargs: Any) -> "License":
32	        validate = requests.post("https://license.posthog.com/licenses/activate", data={"key": kwargs["key"]})
33	        resp = validate.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\ee\models\test\test_event_definition_model.py:16:8
15	        eventDef = EnterpriseEventDefinition.objects.create(team=self.team, name="enterprise event", owner=self.user)
16	        assert eventDef.verified is False

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\ee\tasks\hooks.py:14:23
13	        try:
14	            response = requests.post(
15	                url=target,
16	                data=json.dumps(payload, cls=DjangoJSONEncoder),
17	                headers={"Content-Type": "application/json"},
18	            )
19	            if response.status_code == 410 and hook_id:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\ee\tasks\send_license_usage.py:25:19
24	        )[0][0]
25	        response = requests.post(
26	            "https://license.posthog.com/licenses/usage",
27	            data={"date": date_from.strftime("%Y-%m-%d"), "key": license.key, "events_count": events_count,},
28	        )
29	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\tasks\test\test_calculate_cohort.py:164:20
163	                "a": sync_execute(
164	                    "select person_id from person_static_cohort where team_id = {} and cohort_id = {} ".format(
165	                        self.team.id, cohort.pk

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\tasks\test\test_calculate_cohort.py:169:20
168	                "b": sync_execute(
169	                    "select person_id from person_static_cohort FINAL where team_id = {} and cohort_id = {} ".format(
170	                        self.team.id, cohort.pk

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\tasks\test\test_calculate_cohort.py:268:20
267	                "a": sync_execute(
268	                    "select person_id from person_static_cohort where team_id = {} and cohort_id = {} ".format(
269	                        self.team.id, cohort.pk

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\ee\tasks\test\test_calculate_cohort.py:273:20
272	                "b": sync_execute(
273	                    "select person_id from person_static_cohort FINAL where team_id = {} and cohort_id = {} ".format(
274	                        self.team.id, cohort.pk

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token12345'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\ee\test\test_migration_0012.py:40:21
39	        # Setup for batched tags
40	        self.team2 = Team.objects.create(
41	            organization=self.organization,
42	            api_token="token12345",
43	            test_account_filters=[
44	                {"key": "email", "value": "@posthog.com", "operator": "not_icontains", "type": "person"},
45	            ],
46	        )
47	        self.team2_total_property_definitions = 1_001

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\action.py:236:12
235	        results = sync_execute(
236	            "SELECT count(1) FROM events WHERE team_id = %(team_id)s AND timestamp < %(before)s AND timestamp > %(after)s AND {}".format(
237	                query

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'e2e_test_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\authentication.py:218:78
217	        # Special handling for E2E tests
218	        if settings.E2E_TESTING and user_uuid == "e2e_test_user" and token == "e2e_test_token":
219	            return {"success": True, "token": token}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\capture.py:185:12
184	            data = data["batch"]
185	            assert data is not None
186	        elif "engage" in request.path_info:  # JS identify call

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\cohort.py:210:8
209	    ids = sync_execute(
210	        "SELECT person_id FROM {} where team_id = %(team_id)s AND cohort_id = %(cohort_id)s".format(
211	            PERSON_STATIC_COHORT_TABLE

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\api\dead_letter_queue.py:107:8
106	            offset = int(self.request.GET.get("offset") or 0)
107	        except:
108	            pass
109	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\dead_letter_queue.py:134:8
133	    return sync_execute(
134	        f"""
135	        SELECT error, count(*) AS c
136	        FROM events_dead_letter_queue
137	        GROUP BY error
138	        ORDER BY c DESC, error DESC
139	        LIMIT {ROWS_LIMIT}
140	        OFFSET {offset}
141	        """
142	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\dead_letter_queue.py:147:8
146	    return sync_execute(
147	        f"""
148	        SELECT error_location, count(*) AS c
149	        FROM events_dead_letter_queue
150	        GROUP BY error_location
151	        ORDER BY c DESC, error_location DESC
152	        LIMIT {ROWS_LIMIT}
153	        OFFSET {offset}
154	        """
155	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\dead_letter_queue.py:160:8
159	    return sync_execute(
160	        f"""
161	        SELECT toDate(error_timestamp) as day, count(*) AS c
162	        FROM events_dead_letter_queue
163	        GROUP BY day
164	        ORDER BY c DESC, day DESC
165	        LIMIT {ROWS_LIMIT}
166	        OFFSET {offset}
167	        """
168	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\dead_letter_queue.py:173:8
172	    return sync_execute(
173	        f"""
174	        SELECT arrayJoin(tags) as tag, count(*) as c from events_dead_letter_queue
175	        GROUP BY tag
176	        ORDER BY c DESC, tag DESC
177	        LIMIT {ROWS_LIMIT}
178	        OFFSET {offset}
179	        """
180	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\event_definition.py:92:20
91	                ee_event_definitions = EnterpriseEventDefinition.objects.raw(
92	                    f"""
93	                    SELECT {event_definition_fields},
94	                           {order_ids_first_field} AS is_ordered_first
95	                    FROM ee_enterpriseeventdefinition
96	                    FULL OUTER JOIN posthog_eventdefinition ON posthog_eventdefinition.id=ee_enterpriseeventdefinition.eventdefinition_ptr_id
97	                    WHERE team_id = %(team_id)s AND (
98	                        {order_ids_first_field} = true
99	                        OR {excluded_ids_field} = false
100	                    ) {search_query}
101	                    ORDER BY is_ordered_first DESC, query_usage_30_day DESC NULLS LAST, last_seen_at DESC NULLS LAST, name ASC
102	                    """,
103	                    params=params,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '**************** POSTHOG SECRET FIELD ****************'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\plugin.py:32:21
31	# Keep this in sync with: frontend/scenes/plugins/utils.ts
32	SECRET_FIELD_VALUE = "**************** POSTHOG SECRET FIELD ****************"
33	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\posthog\api\plugin.py:188:18
187	        url = "https://raw.githubusercontent.com/PostHog/integrations-repository/main/plugins.json"
188	        plugins = requests.get(url)
189	        return Response(json.loads(plugins.text))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\property_definition.py:149:16
148	            return EnterprisePropertyDefinition.objects.raw(
149	                f"""
150	                            SELECT {property_definition_fields},
151	                                   {event_property_field} AS is_event_property,
152	                                   {order_ids_first_field} AS is_ordered_first
153	                            FROM ee_enterprisepropertydefinition
154	                            FULL OUTER JOIN posthog_propertydefinition ON posthog_propertydefinition.id=ee_enterprisepropertydefinition.propertydefinition_ptr_id
155	                            WHERE team_id = %(team_id)s AND (
156	                                {order_ids_first_field} = true
157	                                OR (name NOT IN %(excluded_properties)s AND {excluded_property_ids_field} = false)
158	                            ) {name_filter} {numerical_filter} {search_query} {event_property_filter}
159	                            ORDER BY is_ordered_first DESC, is_event_property DESC, query_usage_30_day DESC NULLS LAST, name ASC
160	                            """,
161	                params=params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\api\property_definition.py:171:12
170	        return PropertyDefinition.objects.raw(
171	            f"""
172	                SELECT {property_definition_fields},
173	                       {event_property_field} AS is_event_property,
174	                       {order_ids_first_field} AS is_ordered_first
175	                FROM posthog_propertydefinition
176	                WHERE team_id = %(team_id)s AND (
177	                    {order_ids_first_field} = true
178	                    OR (name NOT IN %(excluded_properties)s AND {excluded_property_ids_field} = false)
179	                ) {name_filter} {numerical_filter} {search_query} {event_property_filter}
180	                ORDER BY is_ordered_first DESC, is_event_property DESC, query_usage_30_day DESC NULLS LAST, name ASC
181	            """,
182	            params=params,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\routing.py:60:12
59	            team = user.team
60	            assert team is not None
61	            return team.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\routing.py:73:12
72	            team = user.team
73	            assert team is not None
74	            return team

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_action.py:187:36
186	
187	        self.user.temporary_token = "token123"
188	        self.user.save()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '87654321'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_authentication.py:140:8
139	    def test_login_endpoint_is_protected_against_brute_force_attempts(self):
140	        User.objects.create(email="new_user@posthog.com", password="87654321")
141	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xp9qT2VLY76JJg'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_capture.py:242:30
241	    def test_emojis_in_text(self, kafka_produce):
242	        self.team.api_token = "xp9qT2VLY76JJg"
243	        self.team.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_capture.py:259:30
258	    def test_js_gzip(self, kafka_produce):
259	        self.team.api_token = "rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4"
260	        self.team.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_capture.py:280:30
279	
280	        self.team.api_token = "rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4"
281	        self.team.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_capture.py:299:30
298	    def test_invalid_gzip(self, kafka_produce):
299	        self.team.api_token = "rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4"
300	        self.team.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_capture.py:318:30
317	    def test_invalid_lz64(self, kafka_produce):
318	        self.team.api_token = "rnEnwNvmHphTu5rFG4gWDDs49t00Vk50tDOeDdedMb4"
319	        self.team.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'KZZZeIpycLH-tKobLBET2NOg7wgJF2KqDL5yWU_7tZw'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_capture.py:487:30
486	    def test_lz64_with_emoji(self, kafka_produce):
487	        self.team.api_token = "KZZZeIpycLH-tKobLBET2NOg7wgJF2KqDL5yWU_7tZw"
488	        self.team.save()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_cohort.py:219:4
218	    response = create_cohort(client=client, team_id=team_id, name=name, groups=groups)
219	    assert response.status_code == 201, response.content
220	    return response.json()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_dashboard.py:104:20
103	    def test_create_dashboard_item(self):
104	        dashboard = Dashboard.objects.create(team=self.team, share_token="testtoken", name="public dashboard")
105	        response = self.client.post(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_dashboard.py:121:20
120	        _, other_team, _ = User.objects.bootstrap("X", "y@x.com", None)
121	        dashboard = Dashboard.objects.create(
122	            team=other_team, share_token="testtoken", name="public dashboard", is_shared=True
123	        )
124	        # Project-based endpoint while logged in, but not belonging to the same org

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_dashboard.py:138:8
137	        _, other_team, _ = User.objects.bootstrap("X", "y@x.com", None)
138	        Dashboard.objects.create(team=other_team, share_token="testtoken", name="public dashboard", is_shared=False)
139	        # Shared dashboards endpoint while logged out (dashboards should be unavailable as it's not shared)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'testtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_dashboard.py:145:8
144	        self.client.logout()
145	        Dashboard.objects.create(
146	            team=self.team, share_token="testtoken", name="public dashboard", is_shared=True,
147	        )
148	        response = self.client.get("/shared_dashboard/testtoken")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_event.py:528:8
527	        _, _, user2 = User.objects.bootstrap("Test", "team2@posthog.com", None)
528	        assert user2.team is not None
529	        assert self.team is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_event.py:529:8
528	        assert user2.team is not None
529	        assert self.team is not None
530	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_feature_flag.py:814:8
813	        self.client.force_login(user)
814	        assert user.team is not None
815	        assert self.team is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_feature_flag.py:815:8
814	        assert user.team is not None
815	        assert self.team is not None
816	        self.assertNotEqual(user.team.id, self.team.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight.py:629:8
628	        _, _, user2 = User.objects.bootstrap("Test", "team2@posthog.com", None)
629	        assert user2.team is not None
630	        assert self.team is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight.py:630:8
629	        assert user2.team is not None
630	        assert self.team is not None
631	        assert self.user.team is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight.py:631:8
630	        assert self.team is not None
631	        assert self.user.team is not None
632	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:42:8
41	        # Should have 2 people, all got to the end of the funnel
42	        assert get_funnel_people_breakdown_by_step(client=self.client, funnel_response=response) == [
43	            {"name": "step one", "converted": ["1", "2"], "dropped": []},
44	            {"name": "step two", "converted": ["1", "2"], "dropped": []},
45	        ]
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:83:8
82	
83	        assert get_funnel_breakdown_people_breakdown_by_step(client=self.client, funnel_response=response) == [
84	            {
85	                "breakdown_value": "Chrome",
86	                "steps": [
87	                    {"name": "sign up", "converted": ["person1"], "dropped": []},
88	                    {"name": "play movie", "converted": ["person1"], "dropped": []},
89	                    {"name": "buy", "converted": ["person1"], "dropped": []},
90	                ],
91	            },
92	            {
93	                "breakdown_value": "Safari",
94	                "steps": [
95	                    {"name": "sign up", "converted": ["person2", "person3"], "dropped": []},
96	                    {"name": "play movie", "converted": ["person2"], "dropped": ["person3"]},
97	                    {"name": "buy", "converted": ["person2"], "dropped": []},
98	                ],
99	            },
100	        ]
101	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:133:8
132	        # performed bleh in between step one and step two
133	        assert get_funnel_people_breakdown_by_step(client=self.client, funnel_response=response) == [
134	            {"name": "step one", "converted": ["1", "2"], "dropped": []},
135	            {"name": "step two", "converted": ["1"], "dropped": ["2"]},
136	        ]
137	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:180:8
179	
180	        assert get_funnel_breakdown_people_breakdown_by_step(client=self.client, funnel_response=response) == [
181	            {
182	                "breakdown_value": "Chrome",
183	                "steps": [
184	                    {"name": "sign up", "converted": ["person1"], "dropped": []},
185	                    {"name": "play movie", "converted": ["person1"], "dropped": []},
186	                    {"name": "buy", "converted": ["person1"], "dropped": []},
187	                ],
188	            },
189	            {
190	                "breakdown_value": "Safari",
191	                "steps": [
192	                    {"name": "sign up", "converted": ["person2", "person3"], "dropped": []},
193	                    {"name": "play movie", "converted": ["person2"], "dropped": ["person3"]},
194	                    {"name": "buy", "converted": [], "dropped": ["person2"]},
195	                ],
196	            },
197	        ]
198	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:237:8
236	
237	        assert get_funnel_breakdown_people_breakdown_by_step(client=self.client, funnel_response=response) == [
238	            {
239	                "breakdown_value": "Chrome",
240	                "steps": [
241	                    {"name": "sign up", "converted": ["person1"], "dropped": []},
242	                    {"name": "play movie", "converted": ["person1"], "dropped": []},
243	                    {"name": "buy", "converted": ["person1"], "dropped": []},
244	                ],
245	            },
246	            {
247	                "breakdown_value": "Safari",
248	                "steps": [
249	                    {"name": "sign up", "converted": ["person2", "person3"], "dropped": []},
250	                    {"name": "play movie", "converted": ["person2"], "dropped": ["person3"]},
251	                    {"name": "buy", "converted": ["person2"], "dropped": []},
252	                ],
253	            },
254	        ]
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:619:8
618	        # excluded in the request payload
619	        assert get_funnel_people_breakdown_by_step(client=self.client, funnel_response=response) == [
620	            {"name": "step one", "converted": ["2"], "dropped": []},
621	            {"name": "step two", "converted": ["2"], "dropped": []},
622	        ]
623	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:773:8
772	        self.assertEqual(["Safari", "11"], result[0][0]["breakdowns"])
773	        assert "breakdown" not in result[0][0]
774	        self.assertEqual(["Safari", "11"], result[0][0]["breakdown_value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:779:8
778	        self.assertEqual(["Safari", "11"], result[0][1]["breakdowns"])
779	        assert "breakdown" not in result[0][1]
780	        self.assertEqual(["Safari", "11"], result[0][1]["breakdown_value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:785:8
784	        self.assertEqual(["Chrome", "95"], result[1][0]["breakdowns"])
785	        assert "breakdown" not in result[1][0]
786	        self.assertEqual(["Chrome", "95"], result[1][0]["breakdown_value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:791:8
790	        self.assertEqual(["Chrome", "95"], result[1][1]["breakdowns"])
791	        assert "breakdown" not in result[1][1]
792	        self.assertEqual(["Chrome", "95"], result[1][1]["breakdown_value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:814:4
813	    converted_people_response = client.get(step["converted_people_url"])
814	    assert converted_people_response.status_code == status.HTTP_200_OK
815	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_insight_funnels.py:824:8
823	        dropped_people_response = client.get(step["dropped_people_url"])
824	        assert dropped_people_response.status_code == status.HTTP_200_OK
825	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'this_is_a_secret_sssshhh'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_instance_settings.py:71:13
70	        # When a value is set, the value is never exposed again
71	        with override_config(EMAIL_HOST_PASSWORD="this_is_a_secret_sssshhh"):
72	            response = self.client.get(f"/api/instance_settings/EMAIL_HOST_PASSWORD")

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\api\test\test_organization_invites.py:22:44
21	                {
22	                    "target_email": f"test+{random.randint(1000000, 9999999)}@posthog.com",
23	                    "first_name": NAME_SEEDS[i % len(NAME_SEEDS)],

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_preflight.py:168:13
167	    def test_cloud_preflight_request_with_social_auth_providers(self):
168	        with self.settings(
169	            SOCIAL_AUTH_GOOGLE_OAUTH2_KEY="test_key",
170	            SOCIAL_AUTH_GOOGLE_OAUTH2_SECRET="test_secret",
171	            MULTI_TENANCY=True,
172	            INSTANCE_PREFERENCES=self.instance_preferences(disable_paid_fs=True),
173	        ):
174	            response = self.client.get("/_preflight/")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_property_definition.py:45:8
44	        self.assertEqual(response.status_code, status.HTTP_200_OK)
45	        assert response.json()["property_type"] == "DateTime"
46	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'gitlab_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_signup.py:292:13
291	
292	        with self.settings(SOCIAL_AUTH_GITLAB_KEY="gitlab_123", SOCIAL_AUTH_GITLAB_SECRET="gitlab_secret"):
293	            response = self.client.get(reverse("social:begin", kwargs={"backend": "gitlab"}))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'gitlab_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_signup.py:317:13
316	
317	        with self.settings(SOCIAL_AUTH_GITLAB_KEY="gitlab_123", SOCIAL_AUTH_GITLAB_SECRET="gitlab_secret"):
318	            response = self.client.get(reverse("social:begin", kwargs={"backend": "gitlab"}))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'github_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_signup.py:334:13
333	    def test_api_social_login_to_create_organization(self, mock_request):
334	        with self.settings(SOCIAL_AUTH_GITHUB_KEY="github_123", SOCIAL_AUTH_GITHUB_SECRET="github_secret"):
335	            response = self.client.get(reverse("social:begin", kwargs={"backend": "github"}))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_stickiness.py:22:4
21	    response = get_stickiness(client=client, team=team, request=encode_get_request_params(data=request))
22	    assert response.status_code == 200
23	    return response.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_stickiness.py:37:4
36	    response = get_stickiness_people(client=client, team_id=team_id, request=encode_get_request_params(data=request))
37	    assert response.status_code == 200
38	    return response.json()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xyz'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_team.py:126:30
125	    def test_reset_token(self):
126	        self.team.api_token = "xyz"
127	        self.team.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword12345'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\api\test\test_user.py:25:22
24	    new_project: Team = None  # type: ignore
25	    CONFIG_PASSWORD = "testpassword12345"
26	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345678'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_user.py:180:15
179	        another_team = Team.objects.create(name="Another Team", organization=another_org)
180	        user = self._create_user("old@posthog.com", password="12345678")
181	        self.client.force_login(user)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'A12345678'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_user.py:388:15
387	
388	        user = self._create_user("bob@posthog.com", password="A12345678")
389	        self.client.force_login(user)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123456789'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_user.py:451:15
450	    def test_user_with_unusable_password_set_can_set_password(self):
451	        user = self._create_user("no_password@posthog.com", password="123456789")
452	        user.set_unusable_password()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345678'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_user.py:611:15
610	    def test_update_staff_user(self):
611	        user = self._create_user("newuser@posthog.com", password="12345678")
612	        self.assertEqual(user.is_staff, False)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345678'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\api\test\test_user.py:631:15
630	    def test_only_staff_user_can_update_staff_prop(self):
631	        user = self._create_user("newuser@posthog.com", password="12345678")
632	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:120:8
119	
120	        assert entity.id == "$pageview"
121	        assert entity.type == "events"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:121:8
120	        assert entity.id == "$pageview"
121	        assert entity.type == "events"
122	        assert entity.math is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:122:8
121	        assert entity.type == "events"
122	        assert entity.math is None
123	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:137:8
136	
137	        assert entity.id == "$pageview"
138	        assert entity.type == "events"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:138:8
137	        assert entity.id == "$pageview"
138	        assert entity.type == "events"
139	        assert entity.math == "unique_group"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:139:8
138	        assert entity.type == "events"
139	        assert entity.math == "unique_group"
140	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:155:12
154	            query, ids = check_definition_ids_inclusion_field_sql(raw_ids, True, "named_key")
155	            assert query == "(posthog_{table}.id = ANY (%(named_key)s::uuid[]))".format(table="propertydefinition",)
156	            assert ids == ordered_expected_ids

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:156:12
155	            assert query == "(posthog_{table}.id = ANY (%(named_key)s::uuid[]))".format(table="propertydefinition",)
156	            assert ids == ordered_expected_ids
157	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:160:12
159	            query, ids = check_definition_ids_inclusion_field_sql(raw_ids, False, "named_key")
160	            assert query == "(posthog_{table}.id = ANY (%(named_key)s::uuid[]))".format(table="eventdefinition")
161	            assert ids == ordered_expected_ids

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\api\test\test_utils.py:161:12
160	            assert query == "(posthog_{table}.id = ANY (%(named_key)s::uuid[]))".format(table="eventdefinition")
161	            assert ids == ordered_expected_ids

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\posthog\api\user.py:248:19
247	    try:
248	        response = requests.post(webhook, verify=False, json=message)
249	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\posthog\api\user.py:248:19
247	    try:
248	        response = requests.post(webhook, verify=False, json=message)
249	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\examples\example.py:59:16
58	            database=AnalyticsDBMS.CLICKHOUSE,
59	            sql=f"""
60	                INSERT INTO {TEMPORARY_TABLE_NAME} (distinct_id, person_id, team_id, _sign, _timestamp, _offset)
61	                SELECT
62	                    distinct_id,
63	                    person_id,
64	                    team_id,
65	                    if(is_deleted==0, 1, -1) as _sign,
66	                    _timestamp,
67	                    _offset
68	                FROM {PERSONS_DISTINCT_ID_TABLE}
69	            """,
70	            rollback=f"DROP TABLE IF EXISTS {TEMPORARY_TABLE_NAME}",

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\examples\example.py:110:30
109	    def progress(self, _):
110	        result = sync_execute(f"SELECT COUNT(1) FROM {TEMPORARY_TABLE_NAME}")
111	        result2 = sync_execute(f"SELECT COUNT(1) FROM {PERSONS_DISTINCT_ID_TABLE}")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\examples\example.py:111:31
110	        result = sync_execute(f"SELECT COUNT(1) FROM {TEMPORARY_TABLE_NAME}")
111	        result2 = sync_execute(f"SELECT COUNT(1) FROM {PERSONS_DISTINCT_ID_TABLE}")
112	        total_events_to_move = result2[0][0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\migrations\0002_events_sample_by.py:51:12
50	        database=AnalyticsDBMS.CLICKHOUSE,
51	        sql=f"""
52	        INSERT INTO {TEMPORARY_TABLE_NAME}
53	        SELECT *
54	        FROM {EVENTS_TABLE}
55	        WHERE
56	            toYYYYMM(timestamp) >= {partition_gte} {lt_expression}
57	        """,
58	        rollback=f"TRUNCATE TABLE IF EXISTS {TEMPORARY_TABLE_NAME} ON CLUSTER '{CLICKHOUSE_CLUSTER}'",

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\async_migrations\migrations\0002_events_sample_by.py:131:12
130	                )
131	            except:  # TODO: we should only pass the timeout one here
132	                pass
133	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\migrations\0002_events_sample_by.py:192:12
191	        result = sync_execute(
192	            f"""
193	        SELECT (free_space.size / greatest(event_table_size.size, 1)) FROM
194	            (SELECT 1 as jc, 'event_table_size', sum(bytes) as size FROM system.parts WHERE table = '{events_table}' AND database='{CLICKHOUSE_DATABASE}') event_table_size
195	        JOIN
196	            (SELECT 1 as jc, 'free_disk_space', free_space as size FROM system.disks WHERE name = 'default') free_space
197	        ON event_table_size.jc=free_space.jc
198	        """
199	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\migrations\0002_events_sample_by.py:207:16
206	            result = sync_execute(
207	                f"""
208	            SELECT formatReadableSize(free_space.size - (free_space.free_space - (1.5 * event_table_size.size ))) as required FROM
209	                (SELECT 1 as jc, 'event_table_size', sum(bytes) as size FROM system.parts WHERE table = '{events_table}' AND database='{CLICKHOUSE_DATABASE}') event_table_size
210	            JOIN
211	                (SELECT 1 as jc, 'free_disk_space', free_space, total_space as size FROM system.disks WHERE name = 'default') free_space
212	            ON event_table_size.jc=free_space.jc
213	            """
214	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\migrations\0002_events_sample_by.py:232:20
231	                for row in sync_execute(
232	                    f"SELECT DISTINCT toUInt32(partition) FROM system.parts WHERE database = %(database)s AND table='{EVENTS_TABLE}'",
233	                    {"database": CLICKHOUSE_DATABASE},

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\migrations\0003_fill_person_distinct_id2.py:61:16
60	            database=AnalyticsDBMS.CLICKHOUSE,
61	            sql=f"""
62	                INSERT INTO person_distinct_id2(team_id, distinct_id, person_id, is_deleted, version)
63	                SELECT
64	                    team_id,
65	                    distinct_id,
66	                    argMax(person_id, _timestamp) as person_id,
67	                    0 as is_deleted,
68	                    0 as version
69	                FROM (
70	                    SELECT
71	                        distinct_id,
72	                        person_id,
73	                        any(team_id) as team_id,
74	                        max(_timestamp) as _timestamp
75	                    FROM
76	                        person_distinct_id
77	                    WHERE
78	                        person_distinct_id.team_id = {team_id}
79	                    GROUP BY
80	                        person_id,
81	                        distinct_id
82	                    HAVING
83	                        max(is_deleted) = 0
84	                )
85	                GROUP BY team_id, distinct_id
86	            """,
87	            rollback=None,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\async_migrations\migrations\0004_replicated_schema.py:235:8
234	
235	        assert (
236	            running_merges == 0
237	        ), f"No merges should be running on tables while partitions are being moved. table={from_table}"
238	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\async_migrations\runner.py:124:4
123	
124	    assert migration_instance is not None
125	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\async_migrations\runner.py:173:4
172	        update_async_migration(migration_instance=migration_instance, progress=progress)
173	    except:
174	        pass
175	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\test\test_0002_events_sample_by.py:57:12
56	        execute_query(
57	            f"""
58	            INSERT INTO {CLICKHOUSE_DATABASE}.events (event, uuid, timestamp)
59	            VALUES
60	                ('event1', '{str(uuid4())}', now())
61	                ('event2', '{str(uuid4())}', now())
62	                ('event3', '{str(uuid4())}', now())
63	                ('event4', '{str(uuid4())}', now())
64	                ('event5', '{str(uuid4())}', '2019-01-01')
65	            """
66	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\test\test_0002_events_sample_by.py:105:40
104	        create_table_res = sync_execute(f"SHOW CREATE TABLE {CLICKHOUSE_DATABASE}.events")
105	        events_count_res = sync_execute(f"SELECT COUNT(*) FROM {CLICKHOUSE_DATABASE}.events")
106	        backup_events_count_res = sync_execute(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\async_migrations\test\test_0002_events_sample_by.py:107:12
106	        backup_events_count_res = sync_execute(
107	            f"SELECT COUNT(*) FROM {CLICKHOUSE_DATABASE}.events_backup_0002_events_sample_by"
108	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\async_migrations\test\test_0004_replicated_schema.py:125:12
124	            self.assert_correct_engine_type(name, engine, expected_engine_types)
125	            assert (name, self.sanitize(engine)) == self.snapshot
126	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\async_migrations\test\test_0004_replicated_schema.py:129:8
128	        valid_engine = any(engine.startswith(engine_type) for engine_type in expected_engine_types)
129	        assert valid_engine, f"Unexpected table engine for '{name}': {engine}"
130	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\auth.py:73:8
72	        personal_api_key_object.save()
73	        assert personal_api_key_object.user is not None
74	        return personal_api_key_object.user, None

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\celery.py:80:27
79	        crontab(
80	            hour=0, minute=randrange(0, 40)
81	        ),  # every day at a random minute past midnight. Sends data from the preceding whole day.

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\celery.py:94:31
93	    sender.add_periodic_task(
94	        crontab(hour=0, minute=randrange(0, 40)), clickhouse_send_license_usage.s()
95	    )  # every day at a random minute past midnight. Randomize to avoid overloading license.posthog.com

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\celery.py:177:8
176	            gauge("posthog_celery_clickhouse__table_lag_seconds", lag, tags={"table": table})
177	        except:
178	            pass
179	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\celery.py:192:8
191	            gauge(f"posthog_celery_clickhouse_table_row_count", rows, tags={"table": table})
192	        except:
193	            pass
194	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\client.py:245:10
244	def _key_hash(query: str, args: Any) -> bytes:
245	    key = hashlib.md5(query.encode("utf-8") + json.dumps(args).encode("utf-8")).digest()
246	    return key

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\client.py:280:8
279	            )
280	        except:
281	            pass
282	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\conftest.py:116:8
115	            database.drop_database()
116	        except:
117	            pass
118	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\conftest.py:132:8
131	            database.drop_database()
132	        except:
133	            pass
134	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:62:20
61	    def populate_person_events(self, person: Person, distinct_id: str, _index: int):
62	        start_day = random.randint(1, self.n_days)
63	        self.add_event(event="$pageview", distinct_id=distinct_id, timestamp=now() - relativedelta(days=start_day))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:66:11
65	
66	        if random.randint(0, 10) <= 9:
67	            self.add_event(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:71:46
70	                timestamp=now() - relativedelta(days=start_day) + relativedelta(seconds=100),
71	                properties={"is_first_movie": random.choice([True, False])},
72	            )

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:77:65
76	                timestamp=now() - relativedelta(days=start_day) + relativedelta(seconds=15),
77	                properties={"$current_url": "https://hogflix/" + random.choice(SCREEN_OPTIONS)},
78	            )

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:79:15
78	            )
79	            if random.randint(0, 10) <= 8:
80	                self.add_event(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:84:69
83	                    timestamp=now() - relativedelta(days=start_day) + relativedelta(seconds=30),
84	                    properties={"$current_url": "https://hogflix/" + random.choice(SCREEN_OPTIONS)},
85	                )

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\app_data_generator.py:90:46
89	                    timestamp=now() - relativedelta(days=start_day) + relativedelta(seconds=45),
90	                    properties={"app_rating": random.randint(1, 5)},
91	                )

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\revenue_data_generator.py:21:11
20	    def populate_person_events(self, person: Person, distinct_id: str, index: int):
21	        if random.randint(0, 10) <= 4:
22	            self.add_event(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\revenue_data_generator.py:33:11
32	
33	        if random.randint(0, 100) < 72:
34	            base_days = random.randint(0, 29)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\revenue_data_generator.py:34:24
33	        if random.randint(0, 100) < 72:
34	            base_days = random.randint(0, 29)
35	            for j in range(0, 11):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\revenue_data_generator.py:36:30
35	            for j in range(0, 11):
36	                plan, value = random.choice((("basic", 8), ("basic", 8), ("standard", 13), ("premium", 30)))
37	                self.add_event(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\revenue_data_generator.py:42:19
41	                )
42	                if random.randint(0, 10) <= 8:
43	                    self.add_event(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\web_data_generator.py:73:20
72	    def populate_person_events(self, person: Person, distinct_id: str, index: int):
73	        start_day = random.randint(1, 7) if index > 0 else 0
74	        browser = random.choice(["Chrome", "Safari", "Firefox"])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\demo\web_data_generator.py:74:18
73	        start_day = random.randint(1, 7) if index > 0 else 0
74	        browser = random.choice(["Chrome", "Safari", "Firefox"])
75	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\posthog\email.py:4:0
3	
4	import lxml
5	import toronado

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:15:12
14	        except KeyError:
15	            assert False, "should not raise any KeyError"
16	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:24:12
23	        except KeyError:
24	            assert False, "should not raise any KeyError"
25	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:33:8
32	        # to satisfy mypy
33	        assert isinstance(actual, List)
34	        series = actual[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:35:8
34	        series = actual[0]
35	        assert isinstance(series, List)
36	        data = series[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:37:8
36	        data = series[0]
37	        assert data["breakdowns"] == ["a1", "b1"]
38	        assert "breakdown" not in data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:38:8
37	        assert data["breakdowns"] == ["a1", "b1"]
38	        assert "breakdown" not in data
39	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:47:8
46	        # to satisfy mypy
47	        assert isinstance(actual, List)
48	        series = actual[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:49:8
48	        series = actual[0]
49	        assert isinstance(series, List)
50	        data = series[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:51:8
50	        data = series[0]
51	        assert data["breakdown"] == "a1"
52	        assert "breakdowns" not in data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_multi_property_breakdown.py:52:8
51	        assert data["breakdown"] == "a1"
52	        assert "breakdowns" not in data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:23:4
22	    events = [{"event": "$pageview"}, {"event": "$pageleave"}]
23	    assert preprocess_session_recording_events(events) == events
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:57:4
56	    preprocessed = preprocess_session_recording_events(events)
57	    assert preprocessed != events
58	    assert len(preprocessed) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:58:4
57	    assert preprocessed != events
58	    assert len(preprocessed) == 3
59	    expected_session_ids = ["1234", "5678", "5678"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:62:8
61	    for index, result in enumerate(preprocessed):
62	        assert result["event"] == "$snapshot"
63	        assert result["properties"]["$session_id"] == expected_session_ids[index]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:63:8
62	        assert result["event"] == "$snapshot"
63	        assert result["properties"]["$session_id"] == expected_session_ids[index]
64	        assert result["properties"].get("$window_id") == expected_window_ids[index]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:64:8
63	        assert result["properties"]["$session_id"] == expected_session_ids[index]
64	        assert result["properties"].get("$window_id") == expected_window_ids[index]
65	        assert result["properties"]["distinct_id"] == "abc123"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:65:8
64	        assert result["properties"].get("$window_id") == expected_window_ids[index]
65	        assert result["properties"]["distinct_id"] == "abc123"
66	        assert "chunk_id" in result["properties"]["$snapshot_data"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:66:8
65	        assert result["properties"]["distinct_id"] == "abc123"
66	        assert "chunk_id" in result["properties"]["$snapshot_data"]
67	        assert result["event"] == "$snapshot"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:67:8
66	        assert "chunk_id" in result["properties"]["$snapshot_data"]
67	        assert result["event"] == "$snapshot"
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:70:4
69	    # it does not rechunk already chunked events
70	    assert preprocess_session_recording_events(preprocessed) == preprocessed
71	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:77:4
76	
77	    assert list(compress_and_chunk_snapshots(raw_snapshot_events)) == [
78	        {
79	            "event": "$snapshot",
80	            "properties": {
81	                "$window_id": "1",
82	                "$session_id": "1234",
83	                "$snapshot_data": {
84	                    "chunk_count": 1,
85	                    "chunk_id": "0178495e-8521-0000-8e1c-2652fa57099b",
86	                    "chunk_index": 0,
87	                    "compression": "gzip-base64",
88	                    "data": "H4sIAAAAAAAC//v/L5qhmkGJoYShkqGAIRXIsmJQYDBi0AGSSgxpDPlACBFTYkhiSGQoAtK1YFlMXcZYdVUB5UuAOkH6YhkAxKw6nnAAAAA=",
89	                    "has_full_snapshot": True,
90	                },
91	                "distinct_id": "abc123",
92	            },
93	        }
94	    ]
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:98:4
97	def test_decompression_results_in_same_data(raw_snapshot_events):
98	    assert len(list(compress_and_chunk_snapshots(raw_snapshot_events, 1000))) == 1
99	    assert compress_decompress_and_extract(raw_snapshot_events, 1000) == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:99:4
98	    assert len(list(compress_and_chunk_snapshots(raw_snapshot_events, 1000))) == 1
99	    assert compress_decompress_and_extract(raw_snapshot_events, 1000) == [
100	        raw_snapshot_events[0]["properties"]["$snapshot_data"],
101	        raw_snapshot_events[1]["properties"]["$snapshot_data"],
102	    ]
103	    assert len(list(compress_and_chunk_snapshots(raw_snapshot_events, 100))) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:103:4
102	    ]
103	    assert len(list(compress_and_chunk_snapshots(raw_snapshot_events, 100))) == 2
104	    assert compress_decompress_and_extract(raw_snapshot_events, 100) == [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:104:4
103	    assert len(list(compress_and_chunk_snapshots(raw_snapshot_events, 100))) == 2
104	    assert compress_decompress_and_extract(raw_snapshot_events, 100) == [
105	        raw_snapshot_events[0]["properties"]["$snapshot_data"],
106	        raw_snapshot_events[1]["properties"]["$snapshot_data"],
107	    ]
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:112:4
111	    compressed = list(compress_and_chunk_snapshots(raw_snapshot_events))
112	    assert len(compressed) == 1
113	    assert compressed[0]["properties"]["$snapshot_data"]["has_full_snapshot"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:113:4
112	    assert len(compressed) == 1
113	    assert compressed[0]["properties"]["$snapshot_data"]["has_full_snapshot"]
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:117:4
116	    compressed = list(compress_and_chunk_snapshots(raw_snapshot_events))
117	    assert len(compressed) == 1
118	    assert not compressed[0]["properties"]["$snapshot_data"]["has_full_snapshot"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:118:4
117	    assert len(compressed) == 1
118	    assert not compressed[0]["properties"]["$snapshot_data"]["has_full_snapshot"]
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:130:4
129	
130	    assert (
131	        decompress_chunked_snapshot_data(1, "someid", snapshot_data_tagged_with_window_id).snapshot_data_by_window_id[
132	            "1"
133	        ]
134	        == raw_snapshot_data
135	    )
136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:162:4
161	
162	    assert (
163	        decompress_chunked_snapshot_data(2, "someid", snapshot_list).snapshot_data_by_window_id[window_id]
164	        == raw_snapshot_data
165	    )
166	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:179:4
178	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data, 1, 0)
179	    assert paginated_events.has_next is True
180	    assert paginated_events.snapshot_data_by_window_id[None][0]["type"] == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:180:4
179	    assert paginated_events.has_next is True
180	    assert paginated_events.snapshot_data_by_window_id[None][0]["type"] == 4
181	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2  # 2 events in a chunk

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:181:4
180	    assert paginated_events.snapshot_data_by_window_id[None][0]["type"] == 4
181	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2  # 2 events in a chunk
182	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:185:4
184	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data, 1, 1)
185	    assert paginated_events.has_next is False
186	    assert paginated_events.snapshot_data_by_window_id["1"][0]["type"] == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:186:4
185	    assert paginated_events.has_next is False
186	    assert paginated_events.snapshot_data_by_window_id["1"][0]["type"] == 3
187	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2  # 2 events in a chunk

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:187:4
186	    assert paginated_events.snapshot_data_by_window_id["1"][0]["type"] == 3
187	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2  # 2 events in a chunk
188	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:191:4
190	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data, 10, 0)
191	    assert paginated_events.has_next is False
192	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:192:4
191	    assert paginated_events.has_next is False
192	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2
193	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:193:4
192	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2
193	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:197:4
196	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data, 10, 2)
197	    assert paginated_events.has_next is False
198	    assert paginated_events.snapshot_data_by_window_id == {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:198:4
197	    assert paginated_events.has_next is False
198	    assert paginated_events.snapshot_data_by_window_id == {}
199	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:203:4
202	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data, 10, 0)
203	    assert paginated_events.has_next is False
204	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:204:4
203	    assert paginated_events.has_next is False
204	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2
205	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:205:4
204	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2
205	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2
206	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:209:4
208	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data)
209	    assert paginated_events.has_next is False
210	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:210:4
209	    assert paginated_events.has_next is False
210	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2
211	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:211:4
210	    assert len(paginated_events.snapshot_data_by_window_id["1"]) == 2
211	    assert len(paginated_events.snapshot_data_by_window_id[None]) == 2
212	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:216:4
215	    paginated_events = decompress_chunked_snapshot_data(1, "someid", [])
216	    assert paginated_events.has_next is False
217	    assert paginated_events.snapshot_data_by_window_id == {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:217:4
216	    assert paginated_events.has_next is False
217	    assert paginated_events.snapshot_data_by_window_id == {}
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:228:4
227	    paginated_events = decompress_chunked_snapshot_data(1, "someid", snapshot_data, return_only_activity_data=True)
228	    assert paginated_events.snapshot_data_by_window_id == {
229	        None: [
230	            {"timestamp": "2019-01-01T00:00:00.000Z", "is_active": False},
231	            {"timestamp": "2019-01-01T00:00:00.000Z", "is_active": False},
232	        ],
233	        "1": [
234	            {"timestamp": "2019-01-01T00:00:00.000Z", "is_active": False},
235	            {"timestamp": "2019-01-01T00:00:00.000Z", "is_active": True},
236	        ],
237	    }
238	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:241:4
240	def test_is_active_event():
241	    assert is_active_event({}) is False
242	    assert is_active_event({"type": 3}) is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:242:4
241	    assert is_active_event({}) is False
242	    assert is_active_event({"type": 3}) is False
243	    assert is_active_event({"type": 2, "data": {"source": 3}}) is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:243:4
242	    assert is_active_event({"type": 3}) is False
243	    assert is_active_event({"type": 2, "data": {"source": 3}}) is False
244	    assert is_active_event({"type": 3, "data": {"source": 3}}) is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:244:4
243	    assert is_active_event({"type": 2, "data": {"source": 3}}) is False
244	    assert is_active_event({"type": 3, "data": {"source": 3}}) is True
245	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:263:4
262	    active_segments = get_active_segments_from_event_list(events, window_id="1", activity_threshold_seconds=60)
263	    assert active_segments == [
264	        RecordingSegment(
265	            start_time=base_time + timedelta(seconds=10),
266	            end_time=base_time + timedelta(seconds=40),
267	            window_id="1",
268	            is_active=True,
269	        ),
270	        RecordingSegment(
271	            start_time=base_time + timedelta(seconds=110),
272	            end_time=base_time + timedelta(seconds=180),
273	            window_id="1",
274	            is_active=True,
275	        ),
276	    ]
277	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:285:4
284	    active_segments = get_active_segments_from_event_list(events, window_id="1", activity_threshold_seconds=60)
285	    assert active_segments == [
286	        RecordingSegment(start_time=base_time, end_time=base_time, window_id="1", is_active=True,),
287	    ]
288	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:297:4
296	    active_segments = get_active_segments_from_event_list(events, window_id="1", activity_threshold_seconds=60)
297	    assert active_segments == []
298	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:313:4
312	    millisecond = timedelta(milliseconds=1)
313	    assert generated_segments == [
314	        RecordingSegment(
315	            start_time=base_time + millisecond,
316	            end_time=base_time + timedelta(seconds=20),
317	            window_id="2",
318	            is_active=False,
319	        ),
320	        RecordingSegment(
321	            start_time=base_time + timedelta(seconds=20) + millisecond,
322	            end_time=base_time + timedelta(seconds=40),
323	            window_id="1",
324	            is_active=False,
325	        ),
326	        RecordingSegment(
327	            start_time=base_time + timedelta(seconds=40) + millisecond,
328	            end_time=base_time + timedelta(seconds=60) - millisecond,
329	            window_id="3",
330	            is_active=False,
331	        ),
332	    ]
333	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:347:4
346	    millisecond = timedelta(milliseconds=1)
347	    assert generated_segments == [
348	        RecordingSegment(
349	            start_time=base_time + millisecond,
350	            end_time=base_time + timedelta(seconds=20),
351	            window_id="2",
352	            is_active=False,
353	        ),
354	        RecordingSegment(
355	            start_time=base_time + timedelta(seconds=35),
356	            end_time=base_time + timedelta(seconds=60) - millisecond,
357	            window_id="3",
358	            is_active=False,
359	        ),
360	    ]
361	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:373:4
372	    millisecond = timedelta(milliseconds=1)
373	    assert generated_segments == [
374	        RecordingSegment(
375	            start_time=base_time + millisecond,
376	            end_time=base_time + timedelta(seconds=60),
377	            window_id="2",
378	            is_active=False,
379	        ),
380	    ]
381	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:385:4
384	    list = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
385	    assert paginate_list(list, 5, 0) == PaginatedList(has_next=True, paginated_list=list[:5])
386	    assert paginate_list(list, 20, 0) == PaginatedList(has_next=False, paginated_list=list)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:386:4
385	    assert paginate_list(list, 5, 0) == PaginatedList(has_next=True, paginated_list=list[:5])
386	    assert paginate_list(list, 20, 0) == PaginatedList(has_next=False, paginated_list=list)
387	    assert paginate_list(list, None, 0) == PaginatedList(has_next=False, paginated_list=list)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:387:4
386	    assert paginate_list(list, 20, 0) == PaginatedList(has_next=False, paginated_list=list)
387	    assert paginate_list(list, None, 0) == PaginatedList(has_next=False, paginated_list=list)
388	    assert paginate_list(list, None, 5) == PaginatedList(has_next=False, paginated_list=list[5:])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:388:4
387	    assert paginate_list(list, None, 0) == PaginatedList(has_next=False, paginated_list=list)
388	    assert paginate_list(list, None, 5) == PaginatedList(has_next=False, paginated_list=list[5:])
389	    assert paginate_list(list, 5, 5) == PaginatedList(has_next=False, paginated_list=list[5:10])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:389:4
388	    assert paginate_list(list, None, 5) == PaginatedList(has_next=False, paginated_list=list[5:])
389	    assert paginate_list(list, 5, 5) == PaginatedList(has_next=False, paginated_list=list[5:10])
390	    assert paginate_list(list, 4, 5) == PaginatedList(has_next=True, paginated_list=list[5:9])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\helpers\tests\test_session_recording_helpers.py:390:4
389	    assert paginate_list(list, 5, 5) == PaginatedList(has_next=False, paginated_list=list[5:10])
390	    assert paginate_list(list, 4, 5) == PaginatedList(has_next=True, paginated_list=list[5:9])
391	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:79:8
78	    with django_assert_num_queries(0):
79	        assert get_internal_metrics_team_id() is None
80	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:84:4
83	    team_id = get_internal_metrics_team_id()
84	    assert isinstance(team_id, int)
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:87:8
86	    with django_assert_num_queries(0):
87	        assert get_internal_metrics_team_id() == team_id
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:90:4
89	    team = Team.objects.get(pk=team_id)
90	    assert team.name == NAME
91	    assert team.organization.name == NAME

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:91:4
90	    assert team.name == NAME
91	    assert team.organization.name == NAME
92	    assert team.organization.for_internal_metrics

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:92:4
91	    assert team.organization.name == NAME
92	    assert team.organization.for_internal_metrics
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:101:4
100	
101	    assert Dashboard.objects.count() == 1
102	    assert dashboard.team_id == team.pk

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:102:4
101	    assert Dashboard.objects.count() == 1
102	    assert dashboard.team_id == team.pk
103	    assert dashboard.name == CLICKHOUSE_DASHBOARD["name"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:103:4
102	    assert dashboard.team_id == team.pk
103	    assert dashboard.name == CLICKHOUSE_DASHBOARD["name"]
104	    assert dashboard.items.count() == len(CLICKHOUSE_DASHBOARD["items"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:104:4
103	    assert dashboard.name == CLICKHOUSE_DASHBOARD["name"]
104	    assert dashboard.items.count() == len(CLICKHOUSE_DASHBOARD["items"])
105	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:106:4
105	
106	    assert get_internal_metrics_dashboards() == info
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:115:4
114	    new_info = get_internal_metrics_dashboards()
115	    assert new_info != info
116	    assert Dashboard.objects.count() == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\internal_metrics\test\test_internal_metrics.py:116:4
115	    assert new_info != info
116	    assert Dashboard.objects.count() == 1

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345678'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\management\commands\setup_dev.py:20:28
19	        with transaction.atomic():
20	            _, team, user = User.objects.bootstrap(
21	                organization_name=ORGANIZATION_NAME,
22	                email="test@posthog.com",
23	                password="12345678",
24	                first_name="Jane Doe",
25	                is_staff=True,
26	                team_fields={
27	                    "name": TEAM_NAME,
28	                    "api_token": "e2e_token_1239",
29	                    "completed_snippet_onboarding": True,
30	                    "ingested_event": True,
31	                },
32	            )
33	            EventDefinition.objects.create(team=team, name="$pageview")

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\migrations\0027_move_elements_to_group.py:16:11
15	        elements_list.append(el_dict)
16	    return hashlib.md5(json.dumps(elements_list, sort_keys=True, default=str).encode("utf-8")).hexdigest()
17	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\migrations\0085_org_models.py:23:47
22	            continue
23	        deterministic_derived_uuid = uuid.UUID(hashlib.md5(team.id.to_bytes(16, "big")).hexdigest())
24	        try:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\migrations\0102_dashboarditem_filters_hash.py:11:22
10	def generate_cache_key(stringified: str) -> str:
11	    return "cache_" + hashlib.md5(stringified.encode("utf-8")).hexdigest()
12	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\migrations\0146_eventproperty_sync.py:62:8
61	            sync_event_and_properties_definitions(team.uuid, Team, EventDefinition, PropertyDefinition)
62	        except Exception:
63	            pass
64	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\migrations\0168_action_step_empty_string_reset.py:15:4
14	            obj.save()
15	    except:
16	        pass
17	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\models\action\util.py:62:26
61	    if use_loop:
62	        formatted_query = "SELECT uuid FROM events WHERE {} AND team_id = %(team_id)s".format(
63	            ") OR uuid IN (SELECT uuid FROM events WHERE team_id = %(team_id)s AND ".join(or_queries)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\models\element_group.py:18:11
17	        elements_list.append(el_dict)
18	    return hashlib.md5(json.dumps(elements_list, sort_keys=True, default=str).encode("utf-8")).hexdigest()
19	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\models\feature_flag.py:280:23
279	        hash_key = f"{self.feature_flag.key}.{self.hashed_identifier}{salt}"
280	        hash_val = int(hashlib.sha1(hash_key.encode("utf-8")).hexdigest()[:15], 16)
281	        return hash_val / __LONG_SCALE__

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\posthog\models\filters\mixins\funnel.py:381:20
380	                        _properties.append(new_prop)
381	                    except:
382	                        continue
383	            return _properties

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\posthog\models\filters\mixins\property.py:73:20
72	                        _properties.append(new_prop)
73	                    except:
74	                        continue
75	            return _properties

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\stickiness.py:62:8
61	    def total_intervals(self) -> int:
62	        assert self.date_from is not None
63	        assert self.date_to is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\stickiness.py:63:8
62	        assert self.date_from is not None
63	        assert self.date_to is not None
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_groups.py:8:4
7	def test_validate_group_type_index():
8	    assert validate_group_type_index("field", None) is None
9	    assert validate_group_type_index("field", 0) == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_groups.py:9:4
8	    assert validate_group_type_index("field", None) is None
9	    assert validate_group_type_index("field", 0) == 0
10	    assert validate_group_type_index("field", 2) == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_groups.py:10:4
9	    assert validate_group_type_index("field", 0) == 0
10	    assert validate_group_type_index("field", 2) == 2
11	    assert validate_group_type_index("field", 3) == 3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_groups.py:11:4
10	    assert validate_group_type_index("field", 2) == 2
11	    assert validate_group_type_index("field", 3) == 3
12	    assert validate_group_type_index("field", 4) == 4

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_groups.py:12:4
11	    assert validate_group_type_index("field", 3) == 3
12	    assert validate_group_type_index("field", 4) == 4
13	    assert validate_group_type_index("field", "2") == 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_groups.py:13:4
12	    assert validate_group_type_index("field", 4) == 4
13	    assert validate_group_type_index("field", "2") == 2
14	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_interval.py:22:4
21	def test_filter_interval_success(filter, expected_interval):
22	    assert filter.interval == expected_interval
23	    assert filter.interval_to_dict() == {"interval": expected_interval}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_interval.py:23:4
22	    assert filter.interval == expected_interval
23	    assert filter.interval_to_dict() == {"interval": expected_interval}
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:26:4
25	
26	    assert filter.property_groups.type == "AND"
27	    assert isinstance(filter.property_groups.values[0], PropertyGroup)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:27:4
26	    assert filter.property_groups.type == "AND"
27	    assert isinstance(filter.property_groups.values[0], PropertyGroup)
28	    assert filter.property_groups.values[0].type == "AND"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:28:4
27	    assert isinstance(filter.property_groups.values[0], PropertyGroup)
28	    assert filter.property_groups.values[0].type == "AND"
29	    assert isinstance(filter.property_groups.values[0].values[0], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:29:4
28	    assert filter.property_groups.values[0].type == "AND"
29	    assert isinstance(filter.property_groups.values[0].values[0], Property)
30	    assert filter.property_groups.values[0].values[0].key == "attr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:30:4
29	    assert isinstance(filter.property_groups.values[0].values[0], Property)
30	    assert filter.property_groups.values[0].values[0].key == "attr"
31	    assert filter.property_groups.values[0].values[0].value == "val_1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:31:4
30	    assert filter.property_groups.values[0].values[0].key == "attr"
31	    assert filter.property_groups.values[0].values[0].value == "val_1"
32	    assert isinstance(filter.property_groups.values[0].values[1], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:32:4
31	    assert filter.property_groups.values[0].values[0].value == "val_1"
32	    assert isinstance(filter.property_groups.values[0].values[1], Property)
33	    assert filter.property_groups.values[0].values[1].key == "attr_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:33:4
32	    assert isinstance(filter.property_groups.values[0].values[1], Property)
33	    assert filter.property_groups.values[0].values[1].key == "attr_2"
34	    assert filter.property_groups.values[0].values[1].value == "val_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:34:4
33	    assert filter.property_groups.values[0].values[1].key == "attr_2"
34	    assert filter.property_groups.values[0].values[1].value == "val_2"
35	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:36:4
35	
36	    assert isinstance(filter.property_groups.values[1], PropertyGroup)
37	    assert filter.property_groups.values[1].type == "OR"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:37:4
36	    assert isinstance(filter.property_groups.values[1], PropertyGroup)
37	    assert filter.property_groups.values[1].type == "OR"
38	    assert isinstance(filter.property_groups.values[1].values[0], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:38:4
37	    assert filter.property_groups.values[1].type == "OR"
38	    assert isinstance(filter.property_groups.values[1].values[0], Property)
39	    assert filter.property_groups.values[1].values[0].key == "attr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:39:4
38	    assert isinstance(filter.property_groups.values[1].values[0], Property)
39	    assert filter.property_groups.values[1].values[0].key == "attr"
40	    assert filter.property_groups.values[1].values[0].value == "val_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:40:4
39	    assert filter.property_groups.values[1].values[0].key == "attr"
40	    assert filter.property_groups.values[1].values[0].value == "val_2"
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:53:4
52	
53	    assert filter.property_groups.type == "AND"
54	    assert isinstance(filter.property_groups.values[0], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:54:4
53	    assert filter.property_groups.type == "AND"
54	    assert isinstance(filter.property_groups.values[0], Property)
55	    assert filter.property_groups.values[0].key == "attr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:55:4
54	    assert isinstance(filter.property_groups.values[0], Property)
55	    assert filter.property_groups.values[0].key == "attr"
56	    assert filter.property_groups.values[0].value == "val_1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:56:4
55	    assert filter.property_groups.values[0].key == "attr"
56	    assert filter.property_groups.values[0].value == "val_1"
57	    assert isinstance(filter.property_groups.values[1], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:57:4
56	    assert filter.property_groups.values[0].value == "val_1"
57	    assert isinstance(filter.property_groups.values[1], Property)
58	    assert filter.property_groups.values[1].key == "attr_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:58:4
57	    assert isinstance(filter.property_groups.values[1], Property)
58	    assert filter.property_groups.values[1].key == "attr_2"
59	    assert filter.property_groups.values[1].value == "val_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:59:4
58	    assert filter.property_groups.values[1].key == "attr_2"
59	    assert filter.property_groups.values[1].value == "val_2"
60	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:65:4
64	
65	    assert filter.property_groups.type == "AND"
66	    assert filter.property_groups.values == []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:66:4
65	    assert filter.property_groups.type == "AND"
66	    assert filter.property_groups.values == []
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:120:4
119	
120	    assert filter.property_groups.to_dict() == {
121	        "type": "AND",
122	        "values": [
123	            {
124	                "type": "AND",
125	                "values": [
126	                    {"key": "attr", "value": "val_1", "operator": None, "type": "event"},
127	                    {"key": "attr_2", "value": "val_2", "operator": None, "type": "event"},
128	                ],
129	            },
130	            {"type": "OR", "values": [{"key": "attr", "value": "val_2", "operator": None, "type": "event"}]},
131	        ],
132	    }
133	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:145:4
144	
145	    assert filter.property_groups.to_dict() == {
146	        "type": "AND",
147	        "values": [
148	            {"key": "attr", "value": "val_1", "operator": None, "type": "event"},
149	            {"key": "attr_2", "value": "val_2", "operator": None, "type": "event"},
150	        ],
151	    }
152	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:163:4
162	
163	    assert filter.property_groups.type == "AND"
164	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:165:4
164	
165	    assert isinstance(filter.property_groups.values[0], Property)
166	    assert filter.property_groups.values[0].key == "attr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:166:4
165	    assert isinstance(filter.property_groups.values[0], Property)
166	    assert filter.property_groups.values[0].key == "attr"
167	    assert filter.property_groups.values[0].value == "val_1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:167:4
166	    assert filter.property_groups.values[0].key == "attr"
167	    assert filter.property_groups.values[0].value == "val_1"
168	    assert isinstance(filter.property_groups.values[1], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:168:4
167	    assert filter.property_groups.values[0].value == "val_1"
168	    assert isinstance(filter.property_groups.values[1], Property)
169	    assert filter.property_groups.values[1].key == "attr_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:169:4
168	    assert isinstance(filter.property_groups.values[1], Property)
169	    assert filter.property_groups.values[1].key == "attr_2"
170	    assert filter.property_groups.values[1].value == "val_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:170:4
169	    assert filter.property_groups.values[1].key == "attr_2"
170	    assert filter.property_groups.values[1].value == "val_2"
171	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:191:4
190	
191	    assert filter.property_groups.type == "AND"
192	    assert isinstance(filter.property_groups.values[0], PropertyGroup)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:192:4
191	    assert filter.property_groups.type == "AND"
192	    assert isinstance(filter.property_groups.values[0], PropertyGroup)
193	    assert filter.property_groups.values[0].type == "AND"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:193:4
192	    assert isinstance(filter.property_groups.values[0], PropertyGroup)
193	    assert filter.property_groups.values[0].type == "AND"
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:195:4
194	
195	    assert isinstance(filter.property_groups.values[0].values[0], Property)
196	    assert filter.property_groups.values[0].values[0].key == "attr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:196:4
195	    assert isinstance(filter.property_groups.values[0].values[0], Property)
196	    assert filter.property_groups.values[0].values[0].key == "attr"
197	    assert filter.property_groups.values[0].values[0].value == "val_1"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:197:4
196	    assert filter.property_groups.values[0].values[0].key == "attr"
197	    assert filter.property_groups.values[0].values[0].value == "val_1"
198	    assert isinstance(filter.property_groups.values[0].values[1], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:198:4
197	    assert filter.property_groups.values[0].values[0].value == "val_1"
198	    assert isinstance(filter.property_groups.values[0].values[1], Property)
199	    assert filter.property_groups.values[0].values[1].key == "attr_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:199:4
198	    assert isinstance(filter.property_groups.values[0].values[1], Property)
199	    assert filter.property_groups.values[0].values[1].key == "attr_2"
200	    assert filter.property_groups.values[0].values[1].value == "val_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:200:4
199	    assert filter.property_groups.values[0].values[1].key == "attr_2"
200	    assert filter.property_groups.values[0].values[1].value == "val_2"
201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:202:4
201	
202	    assert isinstance(filter.property_groups.values[1], PropertyGroup)
203	    assert filter.property_groups.values[1].type == "OR"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:203:4
202	    assert isinstance(filter.property_groups.values[1], PropertyGroup)
203	    assert filter.property_groups.values[1].type == "OR"
204	    assert isinstance(filter.property_groups.values[1].values[0], Property)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:204:4
203	    assert filter.property_groups.values[1].type == "OR"
204	    assert isinstance(filter.property_groups.values[1].values[0], Property)
205	    assert filter.property_groups.values[1].values[0].key == "attr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:205:4
204	    assert isinstance(filter.property_groups.values[1].values[0], Property)
205	    assert filter.property_groups.values[1].values[0].key == "attr"
206	    assert filter.property_groups.values[1].values[0].value == "val_2"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\filters\mixins\test\test_property.py:206:4
205	    assert filter.property_groups.values[1].values[0].key == "attr"
206	    assert filter.property_groups.values[1].values[0].value == "val_2"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\models\plugin.py:290:23
289	        clickhouse_kwargs["types"] = type_filter
290	    clickhouse_query = f"""
291	        SELECT id, team_id, plugin_id, plugin_config_id, timestamp, source, type, message, instance_id FROM plugin_log_entries
292	        WHERE {' AND '.join(clickhouse_where_parts)} ORDER BY timestamp DESC {f'LIMIT {limit}' if limit else ''}
293	    """
294	    return [PluginLogEntryRaw(*result) for result in cast(list, sync_execute(clickhouse_query, clickhouse_kwargs))]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\property.py:137:12
136	        else:
137	            assert not isinstance(value, list)
138	            return Q(**{f"{column}__{self.key}__{self.operator}": value})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\models\utils.py:60:8
59	        bytes = time_component + series_component + random_component
60	        assert len(bytes) == 16
61	        super().__init__(bytes=bytes)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\posthog\models\utils.py:167:19
166	    """Return a 4 letter suffix made up random ASCII letters, useful for disambiguation of duplicates."""
167	    return "".join(random.choice(string.ascii_letters) for _ in range(4))
168	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\permissions.py:237:8
236	    def has_permission(self, request: Request, view: APIView) -> bool:
237	        assert hasattr(
238	            view, "premium_feature"
239	        ), "this permission class requires the `premium_feature` attribute to be set in the view."
240	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'MY_GITHUB_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\plugins\test\test_utils.py:116:13
115	        # default global token
116	        with self.settings(GITHUB_TOKEN="MY_GITHUB_TOKEN"):
117	            parsed_url = parse_url("https://github.com/PostHog/posthog", get_latest_if_none=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'MY_GITLAB_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\plugins\test\test_utils.py:215:13
214	        # default global token
215	        with self.settings(GITLAB_TOKEN="MY_GITLAB_TOKEN"):
216	            parsed_url = parse_url(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'MY_NPM_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\plugins\test\test_utils.py:315:13
314	        # default global token
315	        with self.settings(NPM_TOKEN="MY_NPM_TOKEN"):
316	            parsed_url = parse_url(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'MY_GITHUB_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\plugins\test\test_utils.py:373:13
372	
373	        with self.settings(GITHUB_TOKEN="MY_GITHUB_TOKEN"):
374	            plugin_github_zip_4 = download_plugin_archive(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'MY_GITLAB_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\plugins\test\test_utils.py:419:13
418	
419	        with self.settings(GITLAB_TOKEN="MY_GITLAB_TOKEN"):
420	            plugin_gitlab = download_plugin_archive(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'MY_NPM_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\plugins\test\test_utils.py:460:13
459	
460	        with self.settings(NPM_TOKEN="MY_NPM_TOKEN"):
461	            plugin_npm_tgz = download_plugin_archive(

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\posthog\plugins\utils.py:44:22
43	            commits_url = "https://api.github.com/repos/{}/{}/commits".format(parsed["user"], parsed["repo"])
44	            commits = requests.get(commits_url, headers=headers).json()
45	            if isinstance(commits, dict):

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\posthog\plugins\utils.py:95:22
94	            )
95	            commits = requests.get(commits_url, headers=headers).json()
96	            if len(commits) > 0 and commits[0].get("id", None):

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\posthog\plugins\utils.py:132:22
131	            headers = {"Authorization": "Bearer {}".format(token)} if token else {}
132	            details = requests.get("https://registry.npmjs.org/{}/latest".format(parsed["pkg"]), headers=headers).json()
133	            parsed["tag"] = details["version"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\posthog\plugins\utils.py:205:15
204	
205	    response = requests.get(url, headers=headers)
206	    if not response.ok:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\queries\person_query.py:77:12
76	        return (
77	            f"""
78	            SELECT {fields}
79	            FROM person
80	            {cohort_query}
81	            WHERE team_id = %(team_id)s
82	            GROUP BY id
83	            HAVING max(is_deleted) = 0 {person_filters} {search_clause}
84	            {limit_offset}
85	        """,
86	            {**params, **cohort_params, **limit_params, **search_params},

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\queries\property_optimizer.py:52:24
51	                    for group in property_group.values:
52	                        assert isinstance(group, PropertyGroup)
53	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\queries\property_optimizer.py:72:24
71	                    for property in property_group.values:
72	                        assert isinstance(property, Property)
73	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<randomly generated secret key>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\settings\access.py:52:21
51	
52	DEFAULT_SECRET_KEY = "<randomly generated secret key>"
53	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\tasks\test\test_update_cache.py:290:12
289	                update_cached_items()
290	            except Exception as e:
291	                pass
292	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\base.py:255:8
254	
255	        assert sqlparse.format(query, reindent=True) == self.snapshot, "\n".join(self.snapshot.get_assert_diff())
256	        if params is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\base.py:258:12
257	            del params["team_id"]  # Changes every run
258	            assert params == self.snapshot, "\n".join(self.snapshot.get_assert_diff())
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\base.py:296:8
295	    def setUp(self):
296	        assert (
297	            self.migrate_from and self.migrate_to  # type: ignore
298	        ), "TestCase '{}' must define migrate_from and migrate_to properties".format(type(self).__name__)
299	        self.migrate_from = [(self.app, self.migrate_from)]  # type: ignore

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:103:8
102	        actual = changes_between(model_type="FeatureFlag", previous=None, current=None)
103	        assert actual == []
104	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:112:8
111	        expected = [Change(type="FeatureFlag", field="name", action="changed", before="a", after="b")]
112	        assert actual == expected
113	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:121:8
120	        expected = [Change(type="FeatureFlag", field="key", action="changed", before="the-key", after="the-new-key",)]
121	        assert actual == expected
122	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:130:8
129	        expected = [Change(type="FeatureFlag", field="active", action="changed", before=False, after=True,)]
130	        assert actual == expected
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:139:8
138	        expected = [Change(type="FeatureFlag", field="rollout_percentage", action="created", after=23)]
139	        assert actual == expected
140	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:148:8
147	        expected = [Change(type="FeatureFlag", field="rollout_percentage", action="changed", before=12, after=23)]
148	        assert actual == expected
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:157:8
156	        expected = [Change(type="FeatureFlag", field="deleted", action="changed", before=False, after=True,)]
157	        assert actual == expected
158	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_activity_logging.py:174:8
173	        ]
174	        assert actual == expected
175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:28:4
27	    resp = get_readyz(client)
28	    assert resp.status_code == 200, resp.content
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:36:4
35	
36	    assert resp.status_code == 200, resp.content
37	    data = resp.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:38:4
37	    data = resp.json()
38	    assert {
39	        check: status for check, status in data.items() if check in {"postgres", "postgres_migrations_uptodate"}
40	    } == {"postgres": False, "postgres_migrations_uptodate": False}
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:52:4
51	
52	    assert resp.status_code == 200, resp.content
53	    data = resp.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:54:4
53	    data = resp.json()
54	    assert data == {"http": True}
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:72:4
71	
72	    assert resp.status_code == 503, resp.content
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:77:4
76	
77	    assert resp.status_code == 200, resp.content
78	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:82:4
81	
82	    assert resp.status_code == 200, resp.content
83	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:87:4
86	
87	    assert resp.status_code == 200, resp.content
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:92:4
91	
92	    assert resp.status_code == 200, resp.content
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:100:4
99	
100	    assert resp.status_code == 200, resp.content
101	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:105:4
104	
105	    assert resp.status_code == 503, resp.content
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:110:4
109	
110	    assert resp.status_code == 200, resp.content
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:117:4
116	    # many things that still function without it
117	    assert resp.status_code == 200, resp.content
118	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:124:4
123	    # attempt rate limiting and doesn't fail gracefully
124	    assert resp.status_code == 503, resp.content
125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:132:4
131	
132	    assert resp.status_code == 200, resp.content
133	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:137:4
136	
137	    assert resp.status_code == 503, resp.content
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:142:4
141	
142	    assert resp.status_code == 503, resp.content
143	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:147:4
146	
147	    assert resp.status_code == 503, resp.content
148	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:152:4
151	
152	    assert resp.status_code == 200, resp.content
153	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:165:4
164	
165	    assert resp.status_code == 503, resp.content
166	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:170:4
169	
170	    assert resp.status_code == 503, resp.content
171	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:175:4
174	
175	    assert resp.status_code == 503, resp.content
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:180:4
179	
180	    assert resp.status_code == 503, resp.content
181	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:185:4
184	
185	    assert resp.status_code == 503, resp.content
186	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:198:4
197	    resp = get_readyz(client=client, role="some-unknown-role")
198	    assert resp.status_code == 400, resp.content
199	    data = resp.json()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\posthog\test\test_health.py:200:4
199	    data = resp.json()
200	    assert data["error"] == "InvalidRole"
201	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'token12345'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\test\test_migration_0219.py:42:21
41	        # Setup for batched tags
42	        self.team2 = Team.objects.create(
43	            organization=self.organization,
44	            api_token="token12345",
45	            test_account_filters=[
46	                {"key": "email", "value": "@posthog.com", "operator": "not_icontains", "type": "person"},
47	            ],
48	        )
49	        self.team2_total_insights = 1_001

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\posthog\test\test_urls.py:12:36
11	        # update temporary token
12	        self.user.temporary_token = "token123"
13	        self.user.save()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345678'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\posthog\test\test_user_model.py:14:35
13	        # One org, one team, anonymized
14	        organization, team, user = User.objects.bootstrap(
15	            organization_name="Test Org", email="test_org@posthog.com", password="12345678", anonymize_data=True,
16	        )
17	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\timer.py:61:12
60	                del self.tasks[task.id]
61	            except:
62	                pass
63	            self.lock.notify()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\posthog\utils.py:11:0
10	import shutil
11	import subprocess
12	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\posthog\utils.py:193:12
192	        return (
193	            subprocess.check_output(["git", "rev-parse", "--symbolic-full-name", "--abbrev-ref", "HEAD"])
194	            .decode("utf-8")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\posthog\utils.py:193:12
192	        return (
193	            subprocess.check_output(["git", "rev-parse", "--symbolic-full-name", "--abbrev-ref", "HEAD"])
194	            .decode("utf-8")

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\posthog\utils.py:209:15
208	    try:
209	        return subprocess.check_output(["git", "rev-parse", "--short", "HEAD"]).decode("utf-8").strip()
210	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\posthog\utils.py:209:15
208	    try:
209	        return subprocess.check_output(["git", "rev-parse", "--short", "HEAD"]).decode("utf-8").strip()
210	    except Exception:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\utils.py:290:8
289	            team = Team.objects.only("api_token").first()
290	        except Exception:
291	            pass
292	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\utils.py:391:22
390	def generate_cache_key(stringified: str) -> str:
391	    return "cache_" + hashlib.md5(stringified.encode("utf-8")).hexdigest()
392	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\utils.py:468:4
467	        base64_decoded = base64_decode(data)
468	    except Exception:
469	        pass
470	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\posthog\utils.py:501:11
500	    # hashing here as we don't care about the actual address, just it being rather consistent
501	    return hashlib.md5(uuid.getnode().to_bytes(6, "little")).hexdigest()
502	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\utils.py:508:8
507	    query = (
508	        f'SELECT pg_size_pretty(pg_total_relation_size(relid)) AS "size" '
509	        f"FROM pg_catalog.pg_statio_user_tables "
510	        f"WHERE relname = '{table_name}'"
511	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\posthog\utils.py:520:12
519	
520	    query = f"SELECT reltuples::BIGINT as \"approx_count\" FROM pg_class WHERE relname = '{table_name}'"
521	    cursor = connection.cursor()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\posthog\utils.py:743:8
742	            cache.delete(cache_key)  # in that case, try to delete the cache
743	        except Exception:
744	            pass
745	    return None

--------------------------------------------------

Code scanned:
	Total lines of code: 87450
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 551
		Medium: 123
		High: 9
	Total issues (by confidence):
		Undefined: 0
		Low: 122
		Medium: 49
		High: 512
Files skipped (0):
