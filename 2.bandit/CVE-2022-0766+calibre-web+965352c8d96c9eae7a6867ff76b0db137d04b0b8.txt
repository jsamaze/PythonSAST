Working... ---------------------------------------- 100% 0:00:04
Run started:2024-02-10 22:25:58.400673

Test results:
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\__init__.py:42:4
41	try:
42	    import lxml
43	    lxml_present = True

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\cps\admin.py:990:8
989	            data["sort"] = data["fullpath"].lower()
990	        except Exception:
991	            continue
992	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\admin.py:1821:23
1820	    content.name = username
1821	    content.password = ''  # dummy password which will be replaced by ldap one
1822	    content.email = useremail

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\db.py:935:16
934	                    old_session.close()
935	                except Exception:
936	                    pass
937	                if old_session.bind:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\db.py:940:20
939	                        old_session.bind.dispose()
940	                    except Exception:
941	                        pass
942	

--------------------------------------------------
>> Issue: [B410:blacklist] Using clean_html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace clean_html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\editbooks.py:32:4
31	try:
32	    from lxml.html.clean import clean_html
33	except ImportError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\epub.py:21:0
20	import zipfile
21	from lxml import etree
22	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:52:11
51	    txt = epub_zip.read('META-INF/container.xml')
52	    tree = etree.fromstring(txt)
53	    cfname = tree.xpath('n:rootfiles/n:rootfile/@full-path', namespaces=ns)[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:55:11
54	    cf = epub_zip.read(cfname)
55	    tree = etree.fromstring(cf)
56	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:130:30
129	                markup = epub_zip.read(os.path.join(cover_path, cover_section[0]))
130	                markup_tree = etree.fromstring(markup)
131	                # no matter xhtml or html with no namespace

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\fb2.py:19:0
18	
19	from lxml import etree
20	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\fb2.py:32:11
31	    fb2_file = open(tmp_file_path, encoding="utf-8")
32	    tree = etree.fromstring(fb2_file.read().encode())
33	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\comicvine.py:49:21
48	                query = "%20".join(tokens)
49	            result = requests.get(
50	                f"{ComicVine.BASE_URL}{query}{ComicVine.QUERY_PARAMS}",
51	                headers=ComicVine.HEADERS,
52	            )
53	            for result in result.json()["results"]:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\google.py:48:22
47	                query = "+".join(tokens)
48	            results = requests.get(Google.SEARCH_URL + query)
49	            for result in results.json().get("items", []):

--------------------------------------------------
>> Issue: [B410:blacklist] Using HtmlElement to parse untrusted XML data is known to be vulnerable to XML attacks. Replace HtmlElement with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\metadata_provider\lubimyczytac.py:27:0
26	from html2text import HTML2Text
27	from lxml.html import HtmlElement, fromstring, tostring
28	from markdown2 import Markdown

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\lubimyczytac.py:115:21
114	        if self.active:
115	            result = requests.get(self._prepare_query(title=query))
116	            root = fromstring(result.text)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\lubimyczytac.py:203:19
202	    ) -> MetaRecord:
203	        response = requests.get(match.url)
204	        self.root = fromstring(response.text)

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o660 on file (socket_file).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\cps\server.py:111:8
110	        # between the user running calibre-web and the user running the fronting webserver
111	        os.chmod(socket_file, 0o660)
112	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cps\server.py:125:34
124	        if os.name == 'nt':
125	            self.listen_address = '0.0.0.0'
126	            return (self.listen_address, self.listen_port), None

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\services\simpleldap.py:48:51
47	            if config.config_ldap_serv_password is None:
48	                config.config_ldap_serv_password = ''
49	            app.config['LDAP_PASSWORD'] = base64.b64decode(config.config_ldap_serv_password)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\cps\subproc_wrapper.py:21:0
20	import os
21	import subprocess
22	import re

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\ub.py:759:20
758	    user.role = constants.ROLE_ANONYMOUS
759	    user.password = ''
760	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\ub.py:840:8
839	            old_session.close()
840	        except Exception:
841	            pass
842	        if old_session.bind:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\ub.py:845:12
844	                old_session.bind.dispose()
845	            except Exception:
846	                pass
847	

--------------------------------------------------
>> Issue: [B410:blacklist] Using LXML_VERSION to parse untrusted XML data is known to be vulnerable to XML attacks. Replace LXML_VERSION with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\uploader.py:32:4
31	try:
32	    from lxml.etree import LXML_VERSION as lxmlversion
33	except ImportError:

--------------------------------------------------

Code scanned:
	Total lines of code: 23003
	Total lines skipped (#nosec): 12
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 15
		Medium: 10
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 4
		Medium: 4
		High: 17
Files skipped (0):
