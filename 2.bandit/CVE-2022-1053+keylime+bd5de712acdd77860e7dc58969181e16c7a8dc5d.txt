Working... ---------------------------------------- 100% 0:00:02
Run started:2024-02-10 22:27:53.457925

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:126:28
125	                        def initthread():
126	                            import subprocess
127	                            logger.debug(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:131:35
130	                            env['AGENT_UUID'] = agent_id
131	                            proc = subprocess.Popen(["/bin/sh", initscript], env=env, shell=False,
132	                                                    stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
133	                            proc.wait()

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:233:40
232	    server = tornado.httpserver.HTTPServer(app, ssl_options=context)
233	    server.bind(int(args.port), address='0.0.0.0')
234	    server.start(0)

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\keylime\backport_dataclasses.py:363:4
362	
363	    exec(txt, globals, locals)
364	    return locals[name]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\ca_impl_cfssl.py:8:0
7	import os
8	import subprocess
9	import socket

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\keylime\ca_impl_cfssl.py:69:4
68	    # make sure cfssl isn't running
69	    os.system('pkill -x cfssl')
70	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\keylime\ca_impl_cfssl.py:69:4
68	    # make sure cfssl isn't running
69	    os.system('pkill -x cfssl')
70	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\keylime\ca_impl_cfssl.py:71:16
70	
71	    cfsslproc = subprocess.Popen(cmd, env=env, shell=True, stdout=subprocess.PIPE,  #pylint: disable=consider-using-with
72	                                 stderr=subprocess.STDOUT, universal_newlines=True)
73	    if cfsslproc.returncode is not None:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\keylime\ca_impl_cfssl.py:90:8
89	        cfsslproc.communicate()
90	        os.system("pkill -x cfssl")
91	        cfsslproc = None

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\keylime\ca_impl_cfssl.py:90:8
89	        cfsslproc.communicate()
90	        os.system("pkill -x cfssl")
91	        cfsslproc = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:909:12
908	        if new_operational_state in (states.FAILED, states.INVALID_QUOTE):
909	            assert failure, "States FAILED and INVALID QUOTE should only be reached with a failure message"
910	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\cmd_exec.py:7:0
6	import os
7	import subprocess
8	import time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\cmd_exec.py:15:9
14	def _execute(cmd, env=None, **kwargs):
15	    with subprocess.Popen(cmd, env=env, stdout=subprocess.PIPE,
16	                          stderr=subprocess.PIPE, **kwargs) as proc:
17	        out, err = proc.communicate()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\keylime\common\algorithms.py:37:19
36	        if self == Hash.SHA1:
37	            return hashlib.sha1(data).digest()
38	        if self == Hash.SHA256:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\common\validators.py:48:4
47	        )
48	    except Exception:
49	        pass
50	    return valid

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\common\validators.py:58:4
57	        valid = bool(re.fullmatch(r"[\w.-]+", agent_id))
58	    except Exception:
59	        pass
60	    return valid

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:117:147
116	    return key.encrypt(bytes(message),
117	                       cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
118	                                                                              algorithm=hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:118:88
117	                       cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
118	                                                                              algorithm=hashes.SHA1(),
119	                                                                              label=None))

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:124:159
123	    """ RSA decrypt message  """
124	    return key.decrypt(ciphertext, cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
125	                                                                                          algorithm=hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:125:100
124	    return key.decrypt(ciphertext, cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
125	                                                                                          algorithm=hashes.SHA1(),
126	                                                                                          label=None))

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\keylime\elchecking\__main__.py:27:10
26	log_data = tpm.parse_binary_bootlog(log_bin)
27	with open('/tmp/parsed.json', 'wt', encoding="utf-8") as log_data_file:
28	    log_data_file.write(json.dumps(log_data, indent=True))

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\ima\file_signatures.py:131:29
130	        default_be = backends.default_backend()
131	        digest = hashes.Hash(hashes.SHA1(), backend=default_be)
132	        digest.update(pubbytes)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\ima\file_signatures.py:471:4
470	                return pubkey, keyidv2
471	    except Exception:
472	        pass
473	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\keylime\ima\ima_dm.py:8:0
7	'''
8	import pickle
9	import re

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\keylime\ima\ima_dm.py:75:27
74	        if state:
75	            self.devices = pickle.loads(state)
76	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:651:8
650	    def yes(x):
651	        assert x == []
652	        return "y"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:656:8
655	    def no(x):
656	        assert x == []
657	        return "n"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\keylime_agent.py:29:0
28	import shutil
29	import subprocess
30	import psutil

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\keylime_agent.py:340:29
339	                        env['AGENT_UUID'] = self.server.agent_uuid
340	                        with subprocess.Popen(["/bin/bash", initscript], env=env, shell=False,
341	                                                cwd=os.path.join(secdir, "unzipped"),
342	                                                stdout=subprocess.PIPE, stderr=subprocess.STDOUT) as proc:
343	                            for line in iter(proc.stdout.readline, b''):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\tenant.py:14:0
13	import os
14	import subprocess
15	import sys

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\keylime\tenant.py:602:13
601	        env['PROVKEYS'] = json.dumps(self.registrar_data.get('provider_keys', {}))
602	        with subprocess.Popen(script, env=env, shell=True,
603	                              cwd=config.WORK_DIR, stdout=subprocess.PIPE,
604	                              stderr=subprocess.STDOUT) as proc:
605	            retval = proc.wait()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1358:23
1357	            logger.info("Downloading Allowlist from %s", args.allowlist_url)
1358	            response = requests.get(args.allowlist_url, allow_redirects=False)
1359	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1367:23
1366	            logger.info("Downloading Allowlist signature from %s", args.allowlist_sig_url)
1367	            response = requests.get(args.allowlist_sig_url, allow_redirects=False)
1368	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1392:23
1391	            logger.info("Downloading key from %s", key_url)
1392	            response = requests.get(key_url, allow_redirects=False)
1393	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1409:23
1408	            logger.info("Downloading key signature from %s", keysig_url)
1409	            response = requests.get(keysig_url, allow_redirects=False)
1410	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\keylime\tenant_webapp.py:634:8
633	            data.append(base64.b64decode(uri[fpos:]).decode('utf-8'))
634	        except Exception:
635	            # skip bad data
636	            continue
637	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\keylime\tenant_webapp.py:710:37
709	    server = tornado.httpserver.HTTPServer(app, ssl_options=server_context)
710	    server.bind(webapp_port, address='0.0.0.0')
711	    server.start(config.getint('cloud_verifier',

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\keylime\tpm\tpm2_objects.py:320:15
319	    if nameAlg == TPM_ALG_SHA1:
320	        return hashlib.sha1()
321	    if nameAlg == TPM_ALG_SHA256:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\keylime\tpm\tpm_abstract.py:41:19
40	        chars = string.ascii_uppercase + string.digits + string.ascii_lowercase
41	        password = ''
42	        for i in range(length):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\tpm\tpm_main.py:1204:16
1203	                    log['boot_aggregates'][hashalg].append(h.hexdigest())
1204	                except Exception:
1205	                    pass
1206	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\test\oldtest.py:20:0
19	import signal
20	import subprocess
21	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:754:21
753	        global cv_process
754	        cv_process = subprocess.Popen("python cloud_verifier.py", shell=True)
755	        time.sleep(1)

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:754:21
753	        global cv_process
754	        cv_process = subprocess.Popen("python cloud_verifier.py", shell=True)
755	        time.sleep(1)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:801:39
800	
801	                cn_process_list.append(subprocess.Popen(
802	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
803	                cloudagent_start_port = cloudagent_start_port + 1

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:802:39
801	                cn_process_list.append(subprocess.Popen(
802	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
803	                cloudagent_start_port = cloudagent_start_port + 1
804	                # time.sleep(2)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:835:39
834	
835	                cn_process_list.append(subprocess.Popen(
836	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
837	                cloudagent_port = int(cloudagent_port_read_from_file) + 1

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:836:39
835	                cn_process_list.append(subprocess.Popen(
836	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
837	                cloudagent_port = int(cloudagent_port_read_from_file) + 1
838	                # time.sleep(2)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:916:21
915	        global cn_process
916	        cn_process = subprocess.Popen("python cloud_agent.py", shell=True)
917	        time.sleep(1)

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:916:21
915	        global cn_process
916	        cn_process = subprocess.Popen("python cloud_agent.py", shell=True)
917	        time.sleep(1)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test\test_fs_util.py:17:23
16	
17	        fs_util.ch_dir("/tmp/dir")
18	        makedirs_mock.assert_not_called()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test\test_fs_util.py:28:23
27	
28	        fs_util.ch_dir("/tmp/dir")
29	        makedirs_mock.assert_called_once()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\test\test_ima_verification.py:155:27
154	            template_hash = codecs.decode(parts[1].encode("utf-8"), "hex")
155	            running_hash = hashlib.sha1(running_hash + template_hash).digest()
156	            pcrval = codecs.encode(running_hash, "hex").decode("utf-8")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\test\test_restful.py:31:0
30	import unittest
31	import subprocess
32	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:134:13
133	        # Run init_tpm_server and tpm_serverd (start fresh)
134	        with subprocess.Popen(["init_tpm_server"], shell=False, env=env) as its:
135	            its.wait()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:134:13
133	        # Run init_tpm_server and tpm_serverd (start fresh)
134	        with subprocess.Popen(["init_tpm_server"], shell=False, env=env) as its:
135	            its.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:136:13
135	            its.wait()
136	        with subprocess.Popen(["tpm_serverd"], shell=False, env=env) as tsd:
137	            tsd.wait()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:136:13
135	            its.wait()
136	        with subprocess.Popen(["tpm_serverd"], shell=False, env=env) as tsd:
137	            tsd.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:204:21
203	    if cv_process is None:
204	        cv_process = subprocess.Popen("keylime_verifier",  # pylint: disable=subprocess-popen-preexec-fn,consider-using-with
205	                                      shell=False,
206	                                      preexec_fn=os.setsid,
207	                                      stdout=subprocess.PIPE,
208	                                      stderr=subprocess.STDOUT,
209	                                      env=script_env)
210	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:205:21
204	        cv_process = subprocess.Popen("keylime_verifier",  # pylint: disable=subprocess-popen-preexec-fn,consider-using-with
205	                                      shell=False,
206	                                      preexec_fn=os.setsid,
207	                                      stdout=subprocess.PIPE,
208	                                      stderr=subprocess.STDOUT,
209	                                      env=script_env)
210	
211	        def initthread():

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:231:22
230	    if reg_process is None:
231	        reg_process = subprocess.Popen("keylime_registrar",  # pylint: disable=subprocess-popen-preexec-fn,consider-using-with
232	                                       shell=False,
233	                                       preexec_fn=os.setsid,
234	                                       stdout=subprocess.PIPE,
235	                                       stderr=subprocess.STDOUT,
236	                                       env=script_env)
237	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:232:22
231	        reg_process = subprocess.Popen("keylime_registrar",  # pylint: disable=subprocess-popen-preexec-fn,consider-using-with
232	                                       shell=False,
233	                                       preexec_fn=os.setsid,
234	                                       stdout=subprocess.PIPE,
235	                                       stderr=subprocess.STDOUT,
236	                                       env=script_env)
237	
238	        def initthread():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:265:24
264	        agent_process = subprocess.Popen(agent_path,  # pylint: disable=subprocess-popen-preexec-fn,consider-using-with
265	                                         shell=False,
266	                                         preexec_fn=os.setsid,
267	                                         stdout=subprocess.PIPE,
268	                                         stderr=subprocess.STDOUT,
269	                                         env=script_env)
270	
271	        def initthread():

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:284:16
283	        for retry in range(10):
284	            r = subprocess.run(["ss", "-l", "-t", "-n", "-p",  "( sport = :9002 )"], stdout=subprocess.PIPE, check=False)
285	            if b":9002" in r.stdout:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:284:16
283	        for retry in range(10):
284	            r = subprocess.run(["ss", "-l", "-t", "-n", "-p",  "( sport = :9002 )"], stdout=subprocess.PIPE, check=False)
285	            if b":9002" in r.stdout:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:323:4
322	    # Run tpm2_clear to allow other processes to use the TPM
323	    subprocess.run("tpm2_clear", stdout=subprocess.PIPE, check=False)
324	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:323:4
322	    # Run tpm2_clear to allow other processes to use the TPM
323	    subprocess.run("tpm2_clear", stdout=subprocess.PIPE, check=False)
324	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:12:11
11	def rand_base():
12	    return random.uniform(-99, 99)
13	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:15:11
14	def rand_base_proper():
15	    return random.uniform(1,99)
16	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:18:11
17	def rand_ntries():
18	    return random.randint(1, 99)
19	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:21:11
20	def rand_exp():
21	    return random.choice([True, False])
22	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:35:13
34	        b0 = rand_base_proper()
35	        b1 = random.random()
36	        n = rand_ntries()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test\test_secure_mount.py:85:51
84	            config_mock.WORK_DIR = tmpdirname
85	            self.assertEqual(secure_mount.mount(), f"{tmpdirname}/tmpfs-dev")
86	            # pylint: disable=protected-access

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\test\test_signing.py:47:8
46	            self.fail("Signing passed with invalid signature!")
47	        except Exception:
48	            pass

--------------------------------------------------

Code scanned:
	Total lines of code: 16954
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 51
		Medium: 17
		High: 5
	Total issues (by confidence):
		Undefined: 0
		Low: 4
		Medium: 7
		High: 62
Files skipped (0):
