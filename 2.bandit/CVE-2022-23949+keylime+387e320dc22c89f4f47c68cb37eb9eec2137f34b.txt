Working... ---------------------------------------- 100% 0:00:02
Run started:2024-02-10 22:40:31.074746

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\archive\script_check_quote.py:33:0
32	import tempfile
33	import subprocess
34	import base64

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\archive\script_check_quote.py:65:11
64	    start = timer()
65	    proc = subprocess.Popen(cmd,shell=True,stdout=subprocess.PIPE,stderr=subprocess.STDOUT)
66	    proc.wait()

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\archive\script_check_quote.py:138:11
137	    start = timer()
138	    proc = subprocess.Popen(cmd,shell=True,stdout=subprocess.PIPE,stderr=subprocess.STDOUT)
139	    proc.wait()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\archive\script_check_quote_raw.py:32:0
31	import tempfile
32	import subprocess
33	import base64

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\archive\script_check_quote_raw.py:63:11
62	    start = timer()
63	    proc = subprocess.Popen(cmd,shell=True,stdout=subprocess.PIPE,stderr=subprocess.STDOUT)
64	    proc.wait()

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\archive\script_check_quote_raw.py:118:11
117	    start = timer()
118	    proc = subprocess.Popen(cmd,shell=True,stdout=subprocess.PIPE,stderr=subprocess.STDOUT)
119	    proc.wait()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:126:28
125	                        def initthread():
126	                            import subprocess
127	                            logger.debug(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:131:35
130	                            env['AGENT_UUID'] = agent_id
131	                            proc = subprocess.Popen(["/bin/sh", initscript], env=env, shell=False,
132	                                                    stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
133	                            proc.wait()

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:233:40
232	    server = tornado.httpserver.HTTPServer(app, ssl_options=context)
233	    server.bind(int(args.port), address='0.0.0.0')
234	    server.start(0)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\ca_impl_cfssl.py:8:0
7	import os
8	import subprocess
9	import socket

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\keylime\ca_impl_cfssl.py:70:4
69	    # make sure cfssl isn't running
70	    os.system('pkill -x cfssl')
71	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\keylime\ca_impl_cfssl.py:70:4
69	    # make sure cfssl isn't running
70	    os.system('pkill -x cfssl')
71	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\keylime\ca_impl_cfssl.py:72:16
71	
72	    cfsslproc = subprocess.Popen(cmd, env=env, shell=True, stdout=subprocess.PIPE,
73	                                 stderr=subprocess.STDOUT, universal_newlines=True)
74	    if cfsslproc.returncode is not None:

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\keylime\ca_impl_cfssl.py:92:8
91	        cfsslproc.communicate()
92	        os.system("pkill -x cfssl")
93	        cfsslproc = None

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\keylime\ca_impl_cfssl.py:92:8
91	        cfsslproc.communicate()
92	        os.system("pkill -x cfssl")
93	        cfsslproc = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:883:12
882	        if new_operational_state in (states.FAILED, states.INVALID_QUOTE):
883	            assert failure, "States FAILED and INVALID QUOTE should only be reached with a failure message"
884	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\cmd_exec.py:7:0
6	import os
7	import subprocess
8	import time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\cmd_exec.py:15:11
14	def _execute(cmd, env=None, **kwargs):
15	    proc = subprocess.Popen(cmd, env=env, stdout=subprocess.PIPE,
16	                            stderr=subprocess.PIPE, **kwargs)
17	    out, err = proc.communicate()

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\keylime\common\algorithms.py:37:19
36	        if self == Hash.SHA1:
37	            return hashlib.sha1(data).digest()
38	        if self == Hash.SHA256:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\common\validators.py:48:4
47	        )
48	    except Exception:
49	        pass
50	    return valid

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\common\validators.py:58:4
57	        valid = bool(re.fullmatch(r"[\w.-]+", agent_id))
58	    except Exception:
59	        pass
60	    return valid

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:114:147
113	    return key.encrypt(bytes(message),
114	                       cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
115	                                                                              algorithm=hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:115:88
114	                       cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
115	                                                                              algorithm=hashes.SHA1(),
116	                                                                              label=None))

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:121:159
120	    """ RSA decrypt message  """
121	    return key.decrypt(ciphertext, cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
122	                                                                                          algorithm=hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:122:100
121	    return key.decrypt(ciphertext, cryptography.hazmat.primitives.asymmetric.padding.OAEP(mgf=cryptography.hazmat.primitives.asymmetric.padding.MGF1(algorithm=hashes.SHA1()),
122	                                                                                          algorithm=hashes.SHA1(),
123	                                                                                          label=None))

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\keylime\elchecking\__main__.py:27:10
26	log_data = tpm.parse_binary_bootlog(log_bin)
27	with open('/tmp/parsed.json', 'wt', encoding="utf-8") as log_data_file:
28	    log_data_file.write(json.dumps(log_data, indent=True))

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\ima_file_signatures.py:132:29
131	        default_be = backends.default_backend()
132	        digest = hashes.Hash(hashes.SHA1(), backend=default_be)
133	        digest.update(pubbytes)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\ima_file_signatures.py:472:4
471	                return pubkey, keyidv2
472	    except Exception:
473	        pass
474	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\keylime_agent.py:29:0
28	import shutil
29	import subprocess
30	import psutil

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\keylime_agent.py:337:31
336	                        env['AGENT_UUID'] = self.server.agent_uuid
337	                        proc = subprocess.Popen(["/bin/bash", initscript], env=env, shell=False, cwd='%s/unzipped' % secdir,
338	                                                stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
339	                        for line in iter(proc.stdout.readline, b''):

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\keylime\secure_mount.py:46:35
45	    if not config.MOUNT_SECURE:
46	        secdir = config.WORK_DIR + "/tmpfs-dev"
47	        if not os.path.isdir(secdir):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\tenant.py:14:0
13	import os
14	import subprocess
15	import sys

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\keylime\tenant.py:597:15
596	        env['PROVKEYS'] = json.dumps(self.registrar_data.get('provider_keys', {}))
597	        proc = subprocess.Popen(script, env=env, shell=True,
598	                                cwd=config.WORK_DIR, stdout=subprocess.PIPE,
599	                                stderr=subprocess.STDOUT)
600	        retval = proc.wait()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1348:23
1347	            logger.info("Downloading Allowlist from %s", args.allowlist_url)
1348	            response = requests.get(args.allowlist_url, allow_redirects=False)
1349	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1357:23
1356	            logger.info("Downloading Allowlist signature from %s", args.allowlist_sig_url)
1357	            response = requests.get(args.allowlist_sig_url, allow_redirects=False)
1358	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1382:23
1381	            logger.info("Downloading key from %s", key_url)
1382	            response = requests.get(key_url, allow_redirects=False)
1383	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\keylime\tenant.py:1399:23
1398	            logger.info("Downloading key signature from %s" % keysig_url)
1399	            response = requests.get(keysig_url, allow_redirects=False)
1400	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\keylime\tenant_webapp.py:622:8
621	            data.append(base64.b64decode(uri[fpos:]).decode('utf-8'))
622	        except Exception:
623	            # skip bad data
624	            continue
625	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\keylime\tenant_webapp.py:704:37
703	    server = tornado.httpserver.HTTPServer(app, ssl_options=server_context)
704	    server.bind(webapp_port, address='0.0.0.0')
705	    server.start(config.getint('cloud_verifier',

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\keylime\tpm\tpm2_objects.py:326:15
325	    if nameAlg == TPM_ALG_SHA1:
326	        return hashlib.sha1()
327	    if nameAlg == TPM_ALG_SHA256:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\keylime\tpm\tpm_abstract.py:41:19
40	        chars = string.ascii_uppercase + string.digits + string.ascii_lowercase
41	        password = ''
42	        for i in range(length):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\tpm\tpm_main.py:1338:16
1337	                    log['boot_aggregates'][hashalg].append(h.hexdigest())
1338	                except Exception:
1339	                    pass
1340	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\vtpm_manager.py:10:0
9	import os.path
10	import subprocess
11	import struct

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\vtpm_manager.py:222:11
221	    print(args, kwargs)
222	    return subprocess.check_call(*args, **kwargs)
223	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:248:4
247	    (rsp_type, rsp_len, _) = struct.unpack('>HII', rsp_hdr)
248	    assert rsp_len == 10 + len(rsp_body), \
249	        f"Invalid Response:[Len]: {rsp_len:#x} vs {10 + rsp_body:#x}"
250	    logger.debug('Response Type: 0x%x (%d bytes)', rsp_type, rsp_len)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\keylime\vtpm_manager.py:275:14
274	    logger.info('Group [%d] UUID: %s', group_num, uuid)
275	    pk_hash = hashlib.sha1(pk).hexdigest()
276	    logger.info('  PK Hash:  %s', pk_hash)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:321:4
320	        priv_ca = f.read()
321	    assert len(priv_ca) == 256
322	    logger.debug('Activating group number %d', group_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:329:4
328	    logger.info('Key: %r', body)
329	    assert size == len(body)
330	    return body

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:338:4
337	        rsa_mod = f.read()
338	    assert len(rsa_mod) == 256
339	    ca_digest = '\x00' * 20

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\keylime\vtpm_manager.py:389:4
388	    check_call(f'tpmconv -ik {pubaik_path} -ok {aikbase}',
389	               shell=True)
390	    return {'aikpem': aikpem, 'uuid': uuid}
391	

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\keylime\vtpm_manager.py:419:4
418	    check_call('encaik -ik {!r} -ek {!r} -ok {!r} -oak {!r}'.format(
419	        aikpem, pubekpem, keyblob, goalkey), shell=True)
420	
421	    # Obtain the symkey via group activate

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\keylime\vtpm_manager.py:428:4
427	    # Verify the key we got from the VTPM is the same as we'd get from encaik
428	    check_call(f'diff "{symkey}" "{goalkey}"', shell=True)
429	    print('[vtpmmgr] Test succeeded')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:502:4
501	        rsa_mod = '\x00' * 256
502	    assert len(rsa_mod) == 256
503	    ca_digest = '\x00' * 20

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:555:4
554	    priv_ca = base64.b64decode(keyblob)
555	    assert len(priv_ca) == 256
556	    logger.debug('Activating group number %d', group_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\vtpm_manager.py:560:4
559	    (algId, encScheme, size), body = unpack('>IHH', body)
560	    assert size == len(body)
561	    t1 = time.time()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\test\oldtest.py:20:0
19	import signal
20	import subprocess
21	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:754:21
753	        global cv_process
754	        cv_process = subprocess.Popen("python cloud_verifier.py", shell=True)
755	        time.sleep(1)

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:754:21
753	        global cv_process
754	        cv_process = subprocess.Popen("python cloud_verifier.py", shell=True)
755	        time.sleep(1)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:801:39
800	
801	                cn_process_list.append(subprocess.Popen(
802	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
803	                cloudagent_start_port = cloudagent_start_port + 1

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:802:39
801	                cn_process_list.append(subprocess.Popen(
802	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
803	                cloudagent_start_port = cloudagent_start_port + 1
804	                # time.sleep(2)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:835:39
834	
835	                cn_process_list.append(subprocess.Popen(
836	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
837	                cloudagent_port = int(cloudagent_port_read_from_file) + 1

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:836:39
835	                cn_process_list.append(subprocess.Popen(
836	                    "python cloud_agent.py", shell=True, cwd=new_dir, preexec_fn=os.setsid).pid)
837	                cloudagent_port = int(cloudagent_port_read_from_file) + 1
838	                # time.sleep(2)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\oldtest.py:916:21
915	        global cn_process
916	        cn_process = subprocess.Popen("python cloud_agent.py", shell=True)
917	        time.sleep(1)

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\test\oldtest.py:916:21
915	        global cn_process
916	        cn_process = subprocess.Popen("python cloud_agent.py", shell=True)
917	        time.sleep(1)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\test\test_ima_verification.py:153:27
152	            template_hash = codecs.decode(parts[1].encode("utf-8"), "hex")
153	            running_hash = hashlib.sha1(running_hash + template_hash).digest()
154	            pcrval = codecs.encode(running_hash, "hex").decode("utf-8")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\test\test_restful.py:34:0
33	import unittest
34	import subprocess
35	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:135:14
134	        # Run init_tpm_server and tpm_serverd (start fresh)
135	        its = subprocess.Popen(["init_tpm_server"], shell=False, env=env)
136	        its.wait()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:135:14
134	        # Run init_tpm_server and tpm_serverd (start fresh)
135	        its = subprocess.Popen(["init_tpm_server"], shell=False, env=env)
136	        its.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:137:14
136	        its.wait()
137	        tsd = subprocess.Popen(["tpm_serverd"], shell=False, env=env)
138	        tsd.wait()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:137:14
136	        its.wait()
137	        tsd = subprocess.Popen(["tpm_serverd"], shell=False, env=env)
138	        tsd.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:205:21
204	    if cv_process is None:
205	        cv_process = subprocess.Popen("keylime_verifier",
206	                                      shell=False,
207	                                      preexec_fn=os.setsid,
208	                                      stdout=subprocess.PIPE,
209	                                      stderr=subprocess.STDOUT,
210	                                      env=script_env)
211	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:206:21
205	        cv_process = subprocess.Popen("keylime_verifier",
206	                                      shell=False,
207	                                      preexec_fn=os.setsid,
208	                                      stdout=subprocess.PIPE,
209	                                      stderr=subprocess.STDOUT,
210	                                      env=script_env)
211	
212	        def initthread():

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:232:22
231	    if reg_process is None:
232	        reg_process = subprocess.Popen("keylime_registrar",
233	                                       shell=False,
234	                                       preexec_fn=os.setsid,
235	                                       stdout=subprocess.PIPE,
236	                                       stderr=subprocess.STDOUT,
237	                                       env=script_env)
238	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:233:22
232	        reg_process = subprocess.Popen("keylime_registrar",
233	                                       shell=False,
234	                                       preexec_fn=os.setsid,
235	                                       stdout=subprocess.PIPE,
236	                                       stderr=subprocess.STDOUT,
237	                                       env=script_env)
238	
239	        def initthread():

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\test\test_restful.py:259:24
258	    if agent_process is None:
259	        agent_process = subprocess.Popen("keylime_agent",
260	                                         shell=False,
261	                                         preexec_fn=os.setsid,
262	                                         stdout=subprocess.PIPE,
263	                                         stderr=subprocess.STDOUT,
264	                                         env=script_env)
265	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\test\test_restful.py:260:24
259	        agent_process = subprocess.Popen("keylime_agent",
260	                                         shell=False,
261	                                         preexec_fn=os.setsid,
262	                                         stdout=subprocess.PIPE,
263	                                         stderr=subprocess.STDOUT,
264	                                         env=script_env)
265	
266	        def initthread():

--------------------------------------------------

Code scanned:
	Total lines of code: 15577
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 50
		Medium: 16
		High: 10
	Total issues (by confidence):
		Undefined: 0
		Low: 7
		Medium: 5
		High: 64
Files skipped (0):
