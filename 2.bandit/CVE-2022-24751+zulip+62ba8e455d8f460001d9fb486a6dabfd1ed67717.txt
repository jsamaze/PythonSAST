Working... ---------------------------------------- 100% 0:00:29
Run started:2024-02-10 22:41:50.089760

Test results:
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:178:8
177	        timer = time.time()
178	        assert stat.data_collector.pull_function is not None
179	        rows_added = stat.data_collector.pull_function(stat.property, start_time, end_time, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:304:8
303	    if table == RealmCount:
304	        assert isinstance(zerver_object, Realm)
305	        id_args: Dict[str, Union[Realm, UserProfile, Stream]] = {"realm": zerver_object}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:307:8
306	    elif table == UserCount:
307	        assert isinstance(zerver_object, UserProfile)
308	        id_args = {"realm": zerver_object.realm, "user": zerver_object}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:310:8
309	    else:  # StreamCount
310	        assert isinstance(zerver_object, Stream)
311	        id_args = {"realm": zerver_object.realm, "stream": zerver_object}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:47:29
46	        for i in range(days):
47	            holidays.extend([random() < holiday_rate] * 24)
48	    elif frequency == CountStat.DAY:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:53:20
52	        ] * 2
53	        holidays = [random() < holiday_rate for i in range(days)]
54	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\management\commands\update_analytics_counts.py:63:8
62	        fill_to_time = parse_datetime(options["time"])
63	        assert fill_to_time is not None
64	        if options["utc"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_counts.py:244:8
243	        fill_state = FillState.objects.filter(property=stat.property).first()
244	        assert fill_state is not None
245	        self.assertEqual(fill_state.end_time, end_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:75:12
74	            first_human_user = zulip_realm.get_first_human_user()
75	            assert first_human_user is not None
76	            self.assert_in_success_response(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:432:8
431	        customer = get_customer_by_realm(lear_realm)
432	        assert customer is not None
433	        self.assertTrue(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:440:8
439	        customer = get_customer_by_realm(lear_realm)
440	        assert customer is not None
441	        self.assertFalse(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:471:8
470	        customer = get_customer_by_realm(lear_realm)
471	        assert customer is not None
472	        self.assertFalse(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\analytics\views\installation_activity.py:253:8
252	            row["hours_per_user"] = "{:.1f}".format(hours / row["dau_count"])
253	        except Exception:
254	            pass
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:57:4
56	) -> HttpResponse:
57	    assert request.user.is_authenticated
58	    page_params = dict(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:83:4
82	def stats(request: HttpRequest) -> HttpResponse:
83	    assert request.user.is_authenticated
84	    realm = request.user.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:115:4
114	) -> HttpResponse:
115	    assert settings.ZILENCER_ENABLED
116	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:146:4
145	) -> HttpResponse:
146	    assert settings.ZILENCER_ENABLED
147	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:165:4
164	def stats_for_remote_installation(request: HttpRequest, remote_server_id: int) -> HttpResponse:
165	    assert settings.ZILENCER_ENABLED
166	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:195:4
194	) -> HttpResponse:
195	    assert settings.ZILENCER_ENABLED
196	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:230:12
229	        if remote:
230	            assert settings.ZILENCER_ENABLED
231	            aggregate_table: TableType = RemoteInstallationCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:232:12
231	            aggregate_table: TableType = RemoteInstallationCount
232	            assert server is not None
233	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:237:12
236	        if remote:
237	            assert settings.ZILENCER_ENABLED
238	            aggregate_table = RemoteRealmCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:239:12
238	            aggregate_table = RemoteRealmCount
239	            assert server is not None
240	            assert remote_realm_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:240:12
239	            assert server is not None
240	            assert remote_realm_id is not None
241	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:320:8
319	        # table.
320	        assert server is not None
321	        assert aggregate_table is RemoteInstallationCount or aggregate_table is RemoteRealmCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:321:8
320	        assert server is not None
321	        assert aggregate_table is RemoteInstallationCount or aggregate_table is RemoteRealmCount
322	        aggregate_table_remote = cast(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:331:12
330	            first = aggregate_table_remote.objects.filter(server=server).first()
331	            assert first is not None
332	            start = first.end_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:335:12
334	            last = aggregate_table_remote.objects.filter(server=server).last()
335	            assert last is not None
336	            end = last.end_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:365:4
364	
365	    assert len({stat.frequency for stat in stats}) == 1
366	    end_times = time_range(start, end, stats[0].frequency, min_length)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:85:8
84	
85	        assert content_object is not None
86	        if hasattr(content_object, "status"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:171:8
170	        acting_user = request.user
171	        assert isinstance(acting_user, UserProfile)
172	        if plan_type is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:268:16
267	                hostname = parse_result.hostname
268	                assert hostname is not None
269	                if parse_result.port:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:78:4
77	    obj = confirmation.content_object
78	    assert obj is not None
79	    if activate_object and hasattr(obj, "status"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:108:12
107	        else:
108	            assert validity_in_days is not None
109	            expiry_date = current_time + datetime.timedelta(days=validity_in_days)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:107:4
106	def add_months(dt: datetime, months: int) -> datetime:
107	    assert months >= 0
108	    # It's fine that the max day in Feb is 28 for leap years.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:161:4
160	        return None
161	    assert plan.next_invoice_date is not None  # for mypy
162	    months_per_period = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:186:4
185	        plan = new_plan
186	    assert plan.price_per_license is not None  # for mypy
187	    return plan.price_per_license * last_ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:337:4
336	    customer = get_customer_by_realm(user.realm)
337	    assert customer is not None  # for mypy
338	    assert customer.stripe_customer_id is not None  # for mypy

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:338:4
337	    assert customer is not None  # for mypy
338	    assert customer.stripe_customer_id is not None  # for mypy
339	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:388:4
387	    )
388	    assert last_ledger_renewal is not None
389	    last_renewal = last_ledger_renewal.event_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:392:8
391	    if plan.is_free_trial() or plan.status == CustomerPlan.SWITCH_NOW_FROM_STANDARD_TO_PLUS:
392	        assert plan.next_invoice_date is not None
393	        next_billing_cycle = plan.next_invoice_date

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:398:8
397	        licenses_at_next_renewal = last_ledger_entry.licenses_at_next_renewal
398	        assert licenses_at_next_renewal is not None
399	        if plan.status == CustomerPlan.ACTIVE:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:459:12
458	            realm = new_plan.customer.realm
459	            assert realm is not None
460	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:666:4
665	    customer = update_or_create_stripe_customer(user)
666	    assert customer.stripe_customer_id is not None  # for mypy
667	    assert customer.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:667:4
666	    assert customer.stripe_customer_id is not None  # for mypy
667	    assert customer.realm is not None
668	    ensure_realm_does_not_have_active_plan(customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:761:8
760	    if licenses is not None:
761	        assert plan.customer.realm is not None
762	        assert get_latest_seat_count(plan.customer.realm) <= licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:762:8
761	        assert plan.customer.realm is not None
762	        assert get_latest_seat_count(plan.customer.realm) <= licenses
763	        assert licenses > plan.licenses()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:763:8
762	        assert get_latest_seat_count(plan.customer.realm) <= licenses
763	        assert licenses > plan.licenses()
764	        LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:768:8
767	    elif licenses_at_next_renewal is not None:
768	        assert plan.customer.realm is not None
769	        assert get_latest_seat_count(plan.customer.realm) <= licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:769:8
768	        assert plan.customer.realm is not None
769	        assert get_latest_seat_count(plan.customer.realm) <= licenses_at_next_renewal
770	        LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:820:8
819	    if not plan.customer.stripe_customer_id:
820	        assert plan.customer.realm is not None
821	        raise BillingError(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:831:8
830	    else:
831	        assert plan.invoiced_through is not None
832	        licenses_base = plan.invoiced_through.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:844:16
843	            else:
844	                assert plan.price_per_license is not None  # needed for mypy
845	                price_args = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:851:12
850	        elif licenses_base is not None and ledger_entry.licenses != licenses_base:
851	            assert plan.price_per_license
852	            last_ledger_entry_renewal = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:859:12
858	            )
859	            assert last_ledger_entry_renewal is not None
860	            last_renewal = last_ledger_entry_renewal.event_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1023:4
1022	
1023	    assert plan.customer.realm is not None
1024	    do_change_realm_plan_type(plan.customer.realm, Realm.PLAN_TYPE_LIMITED, acting_user=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1070:4
1069	    plan = get_current_plan_by_realm(realm)
1070	    assert plan is not None
1071	    do_change_plan_status(plan, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1190:4
1189	    plus_plan = get_current_plan_by_realm(realm)
1190	    assert plus_plan is not None  # for mypy
1191	    invoice_plan(plus_plan, plan_switch_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:73:4
72	    stripe_setup_intent = stripe.SetupIntent.retrieve(stripe_session.setup_intent)
73	    assert session.customer.realm is not None
74	    user_id = stripe_session.metadata.get("user_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:75:4
74	    user_id = stripe_session.metadata.get("user_id")
75	    assert user_id is not None
76	    user = get_active_user_profile_by_id_in_realm(user_id, session.customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:121:4
120	    metadata: Dict[str, Any] = stripe_payment_intent.metadata
121	    assert payment_intent.customer.realm is not None
122	    user_id = metadata.get("user_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:123:4
122	    user_id = metadata.get("user_id")
123	    assert user_id is not None
124	    user = get_active_user_profile_by_id_in_realm(user_id, payment_intent.customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:41:12
40	        if is_self_hosted:
41	            assert self.realm is None
42	        return is_self_hosted

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:48:12
47	        if is_cloud:
48	            assert self.remote_server is None
49	        return is_cloud

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:292:8
291	        ledger_entry = LicenseLedger.objects.filter(plan=self).order_by("id").last()
292	        assert ledger_entry is not None
293	        return ledger_entry.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:299:8
298	        ledger_entry = LicenseLedger.objects.filter(plan=self).order_by("id").last()
299	        assert ledger_entry is not None
300	        return ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:344:12
343	        if generate_fixture:  # nocoverage
344	            assert stripe.api_key
345	        for mocked_function_name in MOCKED_STRIPE_FUNCTION_NAMES:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:443:12
442	        if attaches_to_customer:
443	            assert charge_succeeds is not None
444	            if charge_succeeds:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:511:8
510	        )
511	        assert response.status_code == 200
512	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:517:8
516	        )
517	        assert response.status_code == 200
518	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:698:8
697	        [payment_intent] = PaymentIntent.objects.all()
698	        assert payment_intent.stripe_payment_intent_id is not None
699	        self.assert_details_of_valid_session_from_event_status_endpoint(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1453:8
1452	        customer = Customer.objects.first()
1453	        assert customer is not None
1454	        stripe_customer_id: str = assert_is_not_none(customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1466:8
1465	        ledger_entry = LicenseLedger.objects.first()
1466	        assert ledger_entry is not None
1467	        self.assertEqual(ledger_entry.licenses, new_seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1516:8
1515	        stripe_customer_id = Customer.objects.get(realm=get_realm("zulip")).stripe_customer_id
1516	        assert stripe_customer_id is not None
1517	        self.assertFalse(CustomerPlan.objects.exists())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1657:8
1656	        [payment_intent] = PaymentIntent.objects.all()
1657	        assert payment_intent.stripe_payment_intent_id is not None
1658	        self.assert_details_of_valid_session_from_event_status_endpoint(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1683:8
1682	        stripe_customer_id = Customer.objects.get(realm=get_realm("zulip")).stripe_customer_id
1683	        assert stripe_customer_id is not None
1684	        self.assertFalse(CustomerPlan.objects.exists())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1715:8
1714	        [second_payment_intent, _] = PaymentIntent.objects.all().order_by("-id")
1715	        assert second_payment_intent.stripe_payment_intent_id is not None
1716	        self.assert_details_of_valid_session_from_event_status_endpoint(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1871:8
1870	        customer = get_customer_by_realm(get_realm("zulip"))
1871	        assert customer is not None
1872	        assert customer.stripe_customer_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1872:8
1871	        assert customer is not None
1872	        assert customer.stripe_customer_id is not None
1873	        [invoice, _] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2236:8
2235	        ).first()
2236	        assert sponsorship_request is not None
2237	        self.assertEqual(sponsorship_request.org_website, data["website"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2245:8
2244	        customer = get_customer_by_realm(user.realm)
2245	        assert customer is not None
2246	        self.assertEqual(customer.sponsorship_pending, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2437:8
2436	        ).last()
2437	        assert realm_audit_log is not None
2438	        expected_extra_data = str({"old_discount": None, "new_discount": Decimal("85")})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2446:8
2445	        customer = Customer.objects.first()
2446	        assert customer is not None
2447	        [charge] = stripe.Charge.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2450:8
2449	        stripe_customer_id = customer.stripe_customer_id
2450	        assert stripe_customer_id is not None
2451	        [invoice] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2468:8
2467	        stripe_customer_id = customer.stripe_customer_id
2468	        assert stripe_customer_id is not None
2469	        [invoice, _] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2484:8
2483	        stripe_customer_id = customer.stripe_customer_id
2484	        assert stripe_customer_id is not None
2485	        [invoice, _, _] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2490:8
2489	        ).last()
2490	        assert realm_audit_log is not None
2491	        expected_extra_data = str(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2507:8
2506	        message = Message.objects.filter(sender=sender.id).first()
2507	        assert message is not None
2508	        self.assertEqual(message.content, expected_message)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2517:8
2516	        customer = get_customer_by_realm(realm=lear)
2517	        assert customer is not None
2518	        self.assertTrue(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2522:8
2521	        ).last()
2522	        assert realm_audit_log is not None
2523	        expected_extra_data = {"sponsorship_pending": True}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2541:8
2540	        customer = Customer.objects.first()
2541	        assert customer is not None
2542	        stripe_customer_id = customer.stripe_customer_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2543:8
2542	        stripe_customer_id = customer.stripe_customer_id
2543	        assert stripe_customer_id is not None
2544	        stripe.InvoiceItem.create(amount=5000, currency="usd", customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2602:8
2601	        self.assert_in_success_response(["payment method: <strong>visa ending in 0341"], response)
2602	        assert RealmAuditLog.objects.filter(event_type=RealmAuditLog.STRIPE_CARD_CHANGED).exists()
2603	        stripe_payment_methods = stripe.PaymentMethod.list(customer=stripe_customer_id, type="card")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2661:8
2660	        plan = get_current_plan_by_realm(user.realm)
2661	        assert plan is not None
2662	        self.assertEqual(plan.licenses(), self.seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2671:16
2670	                new_plan = get_current_plan_by_realm(user.realm)
2671	                assert new_plan is not None
2672	                expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2720:8
2719	        plan = CustomerPlan.objects.first()
2720	        assert plan is not None
2721	        self.assertEqual(get_realm("zulip").plan_type, Realm.PLAN_TYPE_LIMITED)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2743:8
2742	        plan = CustomerPlan.objects.first()
2743	        assert plan is not None
2744	        self.assertIsNotNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2751:8
2750	        plan = CustomerPlan.objects.first()
2751	        assert plan is not None
2752	        self.assertIsNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2771:8
2770	        monthly_plan = get_current_plan_by_realm(user.realm)
2771	        assert monthly_plan is not None
2772	        self.assertEqual(monthly_plan.automanage_licenses, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2777:8
2776	        new_plan = get_current_plan_by_realm(user.realm)
2777	        assert new_plan is not None
2778	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2811:8
2810	        customer = get_customer_by_realm(user.realm)
2811	        assert customer is not None
2812	        self.assertEqual(CustomerPlan.objects.filter(customer=customer).count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2817:8
2816	        annual_plan = get_current_plan_by_realm(user.realm)
2817	        assert annual_plan is not None
2818	        self.assertEqual(annual_plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2854:8
2853	
2854	        assert customer.stripe_customer_id
2855	        [invoice0, invoice1, invoice2] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2960:8
2959	        monthly_plan = get_current_plan_by_realm(user.realm)
2960	        assert monthly_plan is not None
2961	        self.assertEqual(monthly_plan.automanage_licenses, False)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2965:8
2964	        new_plan = get_current_plan_by_realm(user.realm)
2965	        assert new_plan is not None
2966	        with self.assertLogs("corporate.stripe", "INFO") as m:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2989:8
2988	        customer = get_customer_by_realm(user.realm)
2989	        assert customer is not None
2990	        self.assertEqual(CustomerPlan.objects.filter(customer=customer).count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2995:8
2994	        annual_plan = get_current_plan_by_realm(user.realm)
2995	        assert annual_plan is not None
2996	        self.assertEqual(annual_plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3019:8
3018	
3019	        assert customer.stripe_customer_id
3020	        [invoice0, invoice1] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3074:16
3073	                new_plan = get_current_plan_by_realm(user.realm)
3074	                assert new_plan is not None
3075	                expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3079:8
3078	        plan = CustomerPlan.objects.first()
3079	        assert plan is not None
3080	        self.assertEqual(plan.status, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3088:8
3087	        plan = CustomerPlan.objects.first()
3088	        assert plan is not None
3089	        self.assertEqual(plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3107:12
3106	            new_plan = get_current_plan_by_realm(user.realm)
3107	            assert new_plan is not None
3108	            with patch("corporate.views.billing_page.timezone_now", return_value=self.now):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3116:8
3115	        plan = CustomerPlan.objects.first()
3116	        assert plan is not None
3117	        self.assertIsNotNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3121:8
3120	        plan = CustomerPlan.objects.first()
3121	        assert plan is not None
3122	        self.assertIsNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3143:12
3142	            last_ledger_entry = LicenseLedger.objects.order_by("id").last()
3143	            assert last_ledger_entry is not None
3144	            self.assertEqual(last_ledger_entry.licenses, 21)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3188:12
3187	            new_plan = get_current_plan_by_realm(user.realm)
3188	            assert new_plan is not None
3189	            expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3217:8
3216	        current_plan = CustomerPlan.objects.all().order_by("id").last()
3217	        assert current_plan is not None
3218	        next_invoice_date = add_months(self.next_year, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3224:8
3223	        old_plan = CustomerPlan.objects.all().order_by("id").first()
3224	        assert old_plan is not None
3225	        self.assertEqual(old_plan.next_invoice_date, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3446:8
3445	        last_ledger_entry = LicenseLedger.objects.order_by("id").last()
3446	        assert last_ledger_entry is not None
3447	        self.assertEqual(last_ledger_entry.licenses, 20)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3497:8
3496	        current_plan = CustomerPlan.objects.all().order_by("id").last()
3497	        assert current_plan is not None
3498	        self.assertEqual(current_plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3503:8
3502	        old_plan = CustomerPlan.objects.all().order_by("id").first()
3503	        assert old_plan is not None
3504	        self.assertEqual(old_plan.next_invoice_date, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3517:8
3516	
3517	        assert zulip_customer.stripe_customer_id
3518	        stripe.InvoiceItem.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3535:8
3534	
3535	        assert lear_customer.stripe_customer_id
3536	        stripe.InvoiceItem.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3574:8
3573	        invoices = []
3574	        assert customer.stripe_customer_id is not None
3575	        for _ in range(num_invoices):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\corporate\tests\test_stripe.py:3602:45
3601	        ) -> Tuple[Realm, Optional[Customer], Optional[CustomerPlan], List[stripe.Invoice]]:
3602	            realm_string_id = "realm_" + str(random.randrange(1, 1000000))
3603	            realm = Realm.objects.create(string_id=realm_string_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3623:16
3622	            if num_invoices is not None:
3623	                assert customer is not None
3624	                invoices = self.create_invoices(customer, num_invoices)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3766:8
3765	        plus_plan = get_current_plan_by_realm(realm)
3766	        assert plus_plan is not None
3767	        self.assertEqual(plus_plan.tier, CustomerPlan.PLUS)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3777:8
3776	        stripe_customer_id = customer.stripe_customer_id
3777	        assert stripe_customer_id is not None
3778	        _, cb_txn = stripe.Customer.list_balance_transactions(stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3810:8
3809	        ).last()
3810	        assert realm_audit_log is not None
3811	        expected_extra_data = {"charge_automatically": plan.charge_automatically}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3821:8
3820	        ).last()
3821	        assert realm_audit_log is not None
3822	        expected_extra_data = {"charge_automatically": plan.charge_automatically}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4444:8
4443	        ).last()
4444	        assert remote_realm_audit_log is not None
4445	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4468:8
4467	        ).last()
4468	        assert remote_realm_audit_log is not None
4469	        self.assertTrue(remote_server.deactivated)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4540:8
4539	        plan = CustomerPlan.objects.first()
4540	        assert plan is not None
4541	        self.assertEqual(plan.licenses(), self.seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4590:8
4589	        plan = get_current_plan_by_realm(realm)
4590	        assert plan is not None
4591	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4670:8
4669	        plan = CustomerPlan.objects.first()
4670	        assert plan is not None
4671	        plan.invoicing_status = CustomerPlan.STARTED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4679:8
4678	        plan = get_current_plan_by_realm(get_realm("zulip"))
4679	        assert plan and plan.customer
4680	        plan.customer.stripe_customer_id = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4711:8
4710	        plan = CustomerPlan.objects.first()
4711	        assert plan is not None
4712	        invoice_plan(plan, self.now + timedelta(days=400))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4714:8
4713	        stripe_cutomer_id = plan.customer.stripe_customer_id
4714	        assert stripe_cutomer_id is not None
4715	        [invoice0, invoice1] = stripe.Invoice.list(customer=stripe_cutomer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4763:8
4762	        plan = CustomerPlan.objects.first()
4763	        assert plan is not None
4764	        plan.fixed_price = 100

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4769:8
4768	        stripe_customer_id = plan.customer.stripe_customer_id
4769	        assert stripe_customer_id is not None
4770	        [invoice0, invoice1] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4790:8
4789	        plan = CustomerPlan.objects.first()
4790	        assert plan is not None
4791	        self.assertEqual(plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4796:8
4795	        # Test that we still update next_invoice_date
4796	        assert plan is not None
4797	        self.assertEqual(plan.next_invoice_date, self.next_month + timedelta(days=29))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4803:8
4802	        plan = CustomerPlan.objects.first()
4803	        assert plan is not None
4804	        self.assertEqual(plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4812:8
4811	        plan = CustomerPlan.objects.first()
4812	        assert plan is not None
4813	        self.assertEqual(plan.next_invoice_date, self.next_month + timedelta(days=29))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:67:4
66	    user = request.user
67	    assert user.is_authenticated
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:103:12
102	                plan = new_plan
103	            assert plan is not None  # for mypy
104	            downgrade_at_end_of_cycle = plan.status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:114:16
113	            if plan.is_free_trial():
114	                assert plan.next_invoice_date is not None
115	                renewal_date = "{dt:%B} {dt.day}, {dt.year}".format(dt=plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:123:12
122	            charge_automatically = plan.charge_automatically
123	            assert customer.stripe_customer_id is not None  # for mypy
124	            stripe_customer = stripe_get_customer(customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:175:4
174	    plan = get_current_plan_by_realm(user.realm)
175	    assert plan is not None  # for mypy
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:188:12
187	        if status == CustomerPlan.ACTIVE:
188	            assert plan.status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE
189	            do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:191:12
190	        elif status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE:
191	            assert plan.status == CustomerPlan.ACTIVE
192	            downgrade_at_the_end_of_billing_cycle(user.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:194:12
193	        elif status == CustomerPlan.SWITCH_TO_ANNUAL_AT_END_OF_CYCLE:
194	            assert plan.billing_schedule == CustomerPlan.MONTHLY
195	            assert plan.status == CustomerPlan.ACTIVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:195:12
194	            assert plan.billing_schedule == CustomerPlan.MONTHLY
195	            assert plan.status == CustomerPlan.ACTIVE
196	            assert plan.fixed_price is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:196:12
195	            assert plan.status == CustomerPlan.ACTIVE
196	            assert plan.fixed_price is None
197	            do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:199:12
198	        elif status == CustomerPlan.ENDED:
199	            assert plan.is_free_trial()
200	            downgrade_now_without_creating_additional_invoices(user.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\session.py:22:4
21	    customer = get_customer_by_realm(user.realm)
22	    assert customer
23	    stripe_session = stripe.checkout.Session.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\support.py:23:4
22	    user = request.user
23	    assert user.is_authenticated
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:88:4
87	    customer = update_or_create_stripe_customer(user)
88	    assert customer is not None  # for mypy
89	    free_trial = is_free_trial_offer_enabled()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:177:8
176	        )
177	        assert licenses is not None and license_management is not None
178	        automanage_licenses = license_management == "automatic"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:239:4
238	    user = request.user
239	    assert user.is_authenticated
240	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:40:8
39	    else:
40	        assert not settings.PRODUCTION
41	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:65:8
64	        stripe_session = stripe_event.data.object
65	        assert isinstance(stripe_session, stripe.checkout.Session)
66	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:76:8
75	        stripe_payment_intent = stripe_event.data.object
76	        assert isinstance(stripe_payment_intent, stripe.PaymentIntent)
77	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:92:12
91	        try:
92	            assert isinstance(stripe_payment_intent, stripe.PaymentIntent)
93	            payment_intent = PaymentIntent.objects.get(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\check_rabbitmq_queue.py:4:0
3	import re
4	import subprocess
5	import time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\check_rabbitmq_queue.py:135:25
134	
135	    list_queues_output = subprocess.check_output(
136	        ["/usr/sbin/rabbitmqctl", "list_queues", "name", "messages", "consumers"],
137	        text=True,
138	    )
139	    queue_counts_rabbitmqctl = {}

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\check_rabbitmq_queue.py:152:22
151	
152	    queue_stats_dir = subprocess.check_output(
153	        [os.path.join(ZULIP_PATH, "scripts/get-django-setting"), "QUEUE_STATS_DIR"],
154	        text=True,
155	    ).strip()
156	    queue_stats: Dict[str, Dict[str, Any]] = {}

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\hash_reqs.py:5:0
4	import os
5	import subprocess
6	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\hash_reqs.py:38:11
37	    """
38	    return subprocess.check_output(["/usr/bin/python3", "-VV"], text=True)
39	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\hash_reqs.py:43:11
42	    deps_str = "\n".join(deps) + "\n" + python_version()
43	    return hashlib.sha1(deps_str.encode()).hexdigest()
44	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\node_cache.py:5:0
4	import shutil
5	import subprocess
6	from typing import Dict, List, Optional

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\node_cache.py:45:27
44	        data["yarn-package-version"] = json.load(f)["version"]
45	    data["node-version"] = subprocess.check_output(["node", "--version"], text=True).strip()
46	    data["yarn-args"] = get_yarn_args(production=production)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\node_cache.py:45:27
44	        data["yarn-package-version"] = json.load(f)["version"]
45	    data["node-version"] = subprocess.check_output(["node", "--version"], text=True).strip()
46	    data["yarn-args"] = get_yarn_args(production=production)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\node_cache.py:48:14
47	
48	    sha1sum = hashlib.sha1()
49	    sha1sum.update(json.dumps(data, sort_keys=True).encode())

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\puppet_cache.py:5:0
4	import shutil
5	import subprocess
6	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\puppet_cache.py:23:29
22	        data["deps.yaml"] = fb.read().strip()
23	    data["puppet-version"] = subprocess.check_output(
24	        # This is 10x faster than `puppet --version`
25	        ["ruby", "-r", "puppet/version", "-e", "puts Puppet.version"],
26	        text=True,
27	    ).strip()
28	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\puppet_cache.py:23:29
22	        data["deps.yaml"] = fb.read().strip()
23	    data["puppet-version"] = subprocess.check_output(
24	        # This is 10x faster than `puppet --version`
25	        ["ruby", "-r", "puppet/version", "-e", "puts Puppet.version"],
26	        text=True,
27	    ).strip()
28	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\puppet_cache.py:29:14
28	
29	    sha1sum = hashlib.sha1()
30	    sha1sum.update(json.dumps(data, sort_keys=True).encode())

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_path.py:15:12
14	        with open(activate_this) as f:
15	            exec(f.read(), activate_locals)
16	        # Check that the python version running this function

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\setup_venv.py:4:0
3	import shutil
4	import subprocess
5	from typing import List, Optional, Set, Tuple

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:181:30
180	            continue
181	        venv_python_version = subprocess.check_output([venv_python3, "-VV"], text=True)
182	        if desired_python_version != venv_python_version:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:283:13
282	    path = os.path.join(ZULIP_PATH, "scripts", "lib", "hash_reqs.py")
283	    output = subprocess.check_output([path, requirements_file], text=True)
284	    return output.split()[0]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\sharding.py:6:0
5	import os
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\sharding.py:39:4
38	    expected_ports = list(range(9800, max(ports) + 1))
39	    assert (
40	        sorted(ports) == expected_ports
41	    ), f"ports ({sorted(ports)}) must be contiguous, starting with 9800"
42	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\sharding.py:54:24
53	        shard_map: Dict[str, int] = {}
54	        external_host = subprocess.check_output(
55	            [os.path.join(BASE_DIR, "scripts/get-django-setting"), "EXTERNAL_HOST"],
56	            text=True,
57	        ).strip()
58	        for port in config_file["tornado_sharding"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\sharding.py:67:20
66	                        host = f"{shard}.{external_host}"
67	                    assert host not in shard_map, f"host {host} duplicated"
68	                    shard_map[host] = int(port)

--------------------------------------------------
>> Issue: [B411:blacklist] Using client to parse untrusted XML data is known to be vulnerable to XML attacks. Use defusedxml.xmlrpc.monkey_patch() function to monkey-patch xmlrpclib and mitigate XML vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b411-import-xmlrpclib
   Location: .\scripts\lib\supervisor.py:4:0
3	from typing import Dict, List, Optional, Tuple, Union
4	from xmlrpc import client
5	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\supervisor.py:35:4
34	    processes = rpc().supervisor.getAllProcessInfo()
35	    assert isinstance(processes, list)
36	    for process in processes:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\zulip_tools.py:15:0
14	import shutil
15	import subprocess
16	import sys

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\scripts\lib\zulip_tools.py:49:43
48	        # overwrite an existing target; we handle the error and try again.
49	        tmp = os.path.join(dir, f".{base}.{random.randrange(1 << 40):010x}")
50	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:233:8
232	    try:
233	        subprocess.check_call(args, **kwargs)
234	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:346:10
345	def generate_sha1sum_emoji(zulip_path: str) -> str:
346	    sha = hashlib.sha1()
347	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:453:14
452	    # see is_digest_obsolete for more context
453	    sha1sum = hashlib.sha1()
454	    for fn in filenames:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\zulip_tools.py:592:4
591	    )
592	    subprocess.check_call(["su", "postgres", "-c", subcmd])
593	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:592:4
591	    )
592	    subprocess.check_call(["su", "postgres", "-c", subcmd])
593	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\zulip_tools.py:638:4
637	    r = SplitResult("", netloc, "", "", "")
638	    assert r.hostname is not None
639	    return "[" + r.hostname + "]" if ":" in r.hostname else r.hostname

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:664:8
663	    lines = (
664	        subprocess.check_output(
665	            ["/bin/ss", "-Hnl", filter],
666	            universal_newlines=True,
667	            # Hosts with IPv6 disabled will get "RTNETLINK answers: Invalid
668	            # argument"; eat stderr to hide that
669	            stderr=subprocess.DEVNULL,
670	        )
671	        .strip()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:69:8
68	    ):
69	        assert output.count("<html>") == 0
70	        assert output.count("<body>") == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:70:8
69	        assert output.count("<html>") == 0
70	        assert output.count("<body>") == 0
71	        assert output.count("</html>") == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:71:8
70	        assert output.count("<body>") == 0
71	        assert output.count("</html>") == 0
72	        assert output.count("</body>") == 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\setup\inline_email_css.py:72:8
71	        assert output.count("</html>") == 0
72	        assert output.count("</body>") == 0
73	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\add_mentor.py:36:8
35	
36	    r = requests.get(url)
37	    if r.status_code != 200:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:48:19
47	    try:
48	        response = urllib.request.urlopen(user_api_url)
49	        json.load(response)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:62:19
61	    try:
62	        response = urllib.request.urlopen(apiurl_keys)
63	        userkeys = json.load(response)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:81:19
80	    try:
81	        response = urllib.request.urlopen(apiurl_fork)
82	        json.load(response)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\create.py:292:15
291	def get_zulip_oneclick_app_slug(api_token: str) -> str:
292	    response = requests.get(
293	        "https://api.digitalocean.com/v2/1-clicks", headers={"Authorization": f"Bearer {api_token}"}
294	    ).json()
295	    one_clicks = response["1_clicks"]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\pretty_print.py:1:0
1	import subprocess
2	from typing import List, Optional
3	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:55:12
54	        if token.tag == "else":
55	            assert token.start_token
56	            if token.indent is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:71:20
70	                if start_token:
71	                    assert start_token.child_indent is not None
72	                    token.indent = start_token.child_indent

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\pretty_print.py:180:8
179	        )
180	        subprocess.run(["diff", fn, "-"], input=phtml, text=True)
181	        print(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\pretty_print.py:180:8
179	        )
180	        subprocess.run(["diff", fn, "-"], input=phtml, text=True)
181	        print(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\provision.py:7:0
6	import platform
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\provision.py:325:7
324	    # pg_datadir directory.
325	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
326	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\provision.py:325:7
324	    # pg_datadir directory.
325	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
326	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tools\lib\provision.py:363:14
362	    # hash the apt dependencies
363	    sha_sum = hashlib.sha1()
364	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\tools\lib\provision.py:486:8
485	    with open(activate_this) as f:
486	        exec(f.read(), dict(__file__=activate_this))
487	    os.execvp(

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\tools\lib\provision.py:487:4
486	        exec(f.read(), dict(__file__=activate_this))
487	    os.execvp(
488	        provision_inner,
489	        [
490	            provision_inner,
491	            *(["--force"] if options.is_force else []),
492	            *(["--build-release-tarball-only"] if options.is_build_release_tarball_only else []),
493	            *(["--skip-dev-db-build"] if options.skip_dev_db_build else []),
494	        ],
495	    )
496	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:340:4
339	def validate(fn: Optional[str] = None, text: Optional[str] = None) -> List[Token]:
340	    assert fn or text
341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:369:8
368	    def no_start_tag(token: Optional[Token]) -> None:
369	        assert token
370	        raise TemplateParserException(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_script.py:3:0
2	import os
3	import subprocess
4	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\test_script.py:135:4
134	    os.environ["PUPPETEER_PRODUCT"] = "firefox" if is_firefox else "chrome"
135	    subprocess.check_call(["node", "node_modules/puppeteer/install.js"])
136	    os.makedirs("var/puppeteer", exist_ok=True)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_script.py:135:4
134	    os.environ["PUPPETEER_PRODUCT"] = "firefox" if is_firefox else "chrome"
135	    subprocess.check_call(["node", "node_modules/puppeteer/install.js"])
136	    os.makedirs("var/puppeteer", exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_server.py:2:0
1	import os
2	import subprocess
3	import sys

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\lib\test_server.py:49:15
48	        # Note that zulipdev.com is mapped via DNS to 127.0.0.1.
49	        return requests.get("http://zulipdev.com:9981/accounts/home").status_code == 200
50	    except requests.RequestException:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:77:13
76	        run_dev_server_command.append("--skip-provision-check")
77	    server = subprocess.Popen(run_dev_server_command, stdout=log, stderr=log)
78	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:2:0
1	import os
2	import subprocess
3	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:18:4
17	def generate_ssh_keys() -> None:
18	    subprocess.call(
19	        ["ssh-keygen", "-f", str(Path.home()) + "/.ssh/id_ed25519", "-P", "", "-t", "ed25519"]
20	    )
21	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:18:4
17	def generate_ssh_keys() -> None:
18	    subprocess.call(
19	        ["ssh-keygen", "-f", str(Path.home()) + "/.ssh/id_ed25519", "-P", "", "-t", "ed25519"]
20	    )
21	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:107:4
106	def setup_one_click_app_installer(droplet: digitalocean.Droplet) -> None:
107	    subprocess.call(
108	        [
109	            "fab",
110	            "build_image",
111	            "-H",
112	            droplet.ip_address,
113	            "--keepalive",
114	            "5",
115	            "--connection-attempts",
116	            "10",
117	        ],
118	        cwd="marketplace-partners/marketplace_docs/templates/Fabric",
119	    )
120	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:107:4
106	def setup_one_click_app_installer(droplet: digitalocean.Droplet) -> None:
107	    subprocess.call(
108	        [
109	            "fab",
110	            "build_image",
111	            "-H",
112	            droplet.ip_address,
113	            "--keepalive",
114	            "5",
115	            "--connection-attempts",
116	            "10",
117	        ],
118	        cwd="marketplace-partners/marketplace_docs/templates/Fabric",
119	    )
120	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\run-dev.py:6:0
5	import signal
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:103:4
102	if options.clear_memcached:
103	    subprocess.check_call("./scripts/setup/flush-memcached")
104	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:169:4
168	    # with a running development server.
169	    subprocess.check_call(["./tools/webpack", "--quiet", "--test"])
170	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:184:11
183	        webpack_cmd.append("--host=0.0.0.0")
184	    return subprocess.Popen(webpack_cmd)
185	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\run-dev.py:370:24
369	    for cmd in server_processes():
370	        children.append(subprocess.Popen(cmd))
371	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\tests\test_hash_reqs.py:22:8
21	
22	        assert hash1 == hash2
23	        assert hash1 != hash3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\tests\test_hash_reqs.py:23:8
22	        assert hash1 == hash2
23	        assert hash1 != hash3

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\context_processors.py:139:29
138	    support_email = FromAddress.SUPPORT
139	    support_email_html_tag = SafeString(
140	        f'<a href="mailto:{escape(support_email)}">{escape(support_email)}</a>'
141	    )
142	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\gitter.py:3:0
2	import os
3	import subprocess
4	from typing import Any, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\gitter.py:342:4
341	
342	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
343	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\gitter.py:342:4
341	
342	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
343	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\import_util.py:191:38
190	def build_subscription(recipient_id: int, user_id: int, subscription_id: int) -> ZerverFieldsT:
191	    subscription = Subscription(color=random.choice(stream_colors), id=subscription_id)
192	    subscription_dict = model_to_dict(subscription, exclude=["user_profile", "recipient_id"])

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:536:15
535	
536	    response = requests.get(avatar_url + size_url_suffix, stream=True)
537	    with open(image_path, "wb") as image_file:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:622:15
621	
622	    response = requests.get(upload_url, stream=True)
623	    os.makedirs(os.path.dirname(upload_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:670:15
669	
670	    response = requests.get(emoji_url, stream=True)
671	    os.makedirs(os.path.dirname(upload_emoji_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\mattermost.py:11:0
10	import shutil
11	import subprocess
12	from typing import Any, Callable, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\data_import\mattermost.py:230:11
229	
230	    return hashlib.md5("".join(sorted(huddle_members)).encode()).hexdigest()
231	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\mattermost.py:347:23
346	                str(realm_id),
347	                format(random.randint(0, 255), "x"),
348	                secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\mattermost.py:837:12
836	        for post in mattermost_data["post"]["direct_post"]:
837	            assert "team" not in post
838	            user = username_to_user[post["user"]]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\mattermost.py:1014:8
1013	        logging.info("Start making tarball")
1014	        subprocess.check_call(["tar", "-czf", realm_output_dir + ".tar.gz", realm_output_dir, "-P"])
1015	        logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\mattermost.py:1014:8
1013	        logging.info("Start making tarball")
1014	        subprocess.check_call(["tar", "-czf", realm_output_dir + ".tar.gz", realm_output_dir, "-P"])
1015	        logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\rocketchat.py:5:0
4	import secrets
5	import subprocess
6	from typing import Any, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\rocketchat.py:379:19
378	            str(realm_id),
379	            format(random.randint(0, 255), "x"),
380	            secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\rocketchat.py:1140:4
1139	    logging.info("Start making tarball")
1140	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1141	    logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\rocketchat.py:1140:4
1139	    logging.info("Start making tarball")
1140	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1141	    logging.info("Done making tarball")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\slack.py:6:0
5	import shutil
6	import subprocess
7	import zipfile

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\slack.py:1098:19
1097	            str(realm_id),
1098	            format(random.randint(0, 255), "x"),
1099	            secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1242:15
1241	
1242	    response = requests.get(icon_url, stream=True)
1243	    response_raw = response.raw

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\slack.py:1375:4
1374	        rm_tree(slack_data_dir)
1375	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1376	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\slack.py:1375:4
1374	        rm_tree(slack_data_dir)
1375	    subprocess.check_call(["tar", "-czf", output_dir + ".tar.gz", output_dir, "-P"])
1376	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1391:15
1390	    elif token.startswith("xoxb-"):
1391	        data = requests.get(
1392	            "https://slack.com/api/team.info", headers={"Authorization": f"Bearer {token}"}
1393	        )
1394	        if data.status_code != 200 or not data.json()["ok"]:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1413:11
1412	    token = kwargs.pop("token")
1413	    data = requests.get(slack_api_url, headers={"Authorization": f"Bearer {token}"}, params=kwargs)
1414	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\slack_message_conversion.py:125:4
124	    slack_usermention_match = re.search(SLACK_USERMENTION_REGEX, token, re.VERBOSE)
125	    assert slack_usermention_match is not None
126	    short_name = slack_usermention_match.group(4)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:103:4
102	
103	    assert request_notes.client is not None
104	    event = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:197:4
196	
197	    assert client_name is not None
198	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:489:8
488	    def _wrapped_view_func(request: HttpRequest, *args: object, **kwargs: object) -> HttpResponse:
489	        assert request.user.is_authenticated
490	        if request.user.is_bot:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:923:4
922	    ip_addr = request.META["REMOTE_ADDR"]
923	    assert ip_addr
924	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:981:16
980	            else:
981	                assert isinstance(user, UserProfile)
982	                rate_limit_user(request, user, domain="api_by_user")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:1056:8
1055	        page_params = context.setdefault("page_params", {})
1056	        assert isinstance(page_params, dict)
1057	        page_params["google_analytics_id"] = settings.GOOGLE_ANALYTICS_ID

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\filters.py:11:8
10	        post_data = SafeExceptionReporterFilter.get_post_parameters(self, request)
11	        assert isinstance(post_data, dict)
12	        filtered_post = post_data.copy()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:419:16
418	            except RateLimited as e:
419	                assert e.secs_to_freedom is not None
420	                secs_to_freedom = int(e.secs_to_freedom)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:547:8
546	    if used_preregistration_user is None:
547	        assert not realm_creation, "realm_creation should only happen with a PreregistrationUser"
548	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:707:12
706	            )
707	            assert realm_creation_audit_log is not None
708	            realm_creation_audit_log.acting_user = user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:939:4
938	    property_type = Realm.property_types[name]
939	    assert isinstance(
940	        value, property_type
941	    ), f"Cannot update {name}: {value} is not an instance of {property_type}"
942	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1342:8
1341	        # to this recipient (all private messages sent to the user).
1342	        assert personal_recipient is not None
1343	        personal_recipient.delete()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1698:8
1697	        message_to_user_ids = list({recipient.type_id, sender_id})
1698	        assert len(message_to_user_ids) in [1, 2]
1699	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1704:8
1703	        # of this function for different message types.
1704	        assert stream_topic is not None
1705	        user_ids_muting_topic = stream_topic.user_ids_muting_topic()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:1979:8
1978	        scheduled_message.realm = send_request.realm
1979	        assert send_request.deliver_at is not None
1980	        scheduled_message.scheduled_timestamp = send_request.deliver_at

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2037:4
2036	    # Render our message_dicts.
2037	    assert message.rendered_content is None
2038	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2197:12
2196	            # assert needed because stubs for django are missing
2197	            assert send_request.stream is not None
2198	            realm_id = send_request.stream.realm_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2299:12
2298	            # assert needed because stubs for django are missing
2299	            assert send_request.stream is not None
2300	            if send_request.stream.is_public():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2645:8
2644	        reaction = query.first()
2645	        assert reaction is not None
2646	        emoji_name = reaction.emoji_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2790:8
2789	        # message recipients of the message.
2790	        assert forwarder_user_profile is not None
2791	        if forwarder_user_profile.id not in recipient_profiles_map:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:2799:4
2798	
2799	    assert recipient_profiles_map
2800	    if len(recipient_profiles_map) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3124:4
3123	
3124	    assert topic_name is not None
3125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3247:8
3246	    if stream_id is not None:
3247	        assert message.is_stream_message()
3248	        if not user_profile.can_move_messages_between_streams():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3375:20
3374	                else:
3375	                    assert stream_name is not None
3376	                    content = _(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3479:8
3478	            stream = addressee.stream()
3479	        assert stream is not None
3480	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3505:12
3504	            # else can sneak past the access check.
3505	            assert sender.bot_type == sender.OUTGOING_WEBHOOK_BOT
3506	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3530:12
3529	        except ValidationError as e:
3530	            assert isinstance(e.messages[0], str)
3531	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:3551:4
3550	    # We render messages later in the process.
3551	    assert message.rendered_content is None
3552	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4021:8
4020	    for stream in streams:
4021	        assert stream.realm_id == realm.id
4022	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4024:8
4023	    for user in users:
4024	        assert user.realm_id == realm.id
4025	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4218:4
4217	
4218	    assert op in ["peer_add", "peer_remove"]
4219	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4349:8
4348	    for stream in streams:
4349	        assert stream.realm_id == realm.id
4350	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:4352:8
4351	    for user in users:
4352	        assert user.realm_id == realm.id
4353	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5157:8
5156	    if is_web_public:
5157	        assert history_public_to_subscribers is not False
5158	        assert invite_only is not True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5158:8
5157	        assert history_public_to_subscribers is not False
5158	        assert invite_only is not True
5159	        stream.is_web_public = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5163:8
5162	    else:
5163	        assert invite_only is not None
5164	        # is_web_public is falsey

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5629:8
5628	        # suites that want to backdate the date of a realm's creation.
5629	        assert not settings.PRODUCTION
5630	        kwargs["date_created"] = date_created

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5727:8
5726	    if setting_name == "timezone":
5727	        assert isinstance(setting_value, str)
5728	        setting_value = canonicalize_timezone(setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5731:8
5730	        property_type = UserProfile.property_types[setting_name]
5731	        assert isinstance(setting_value, property_type)
5732	    setattr(user_profile, setting_name, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5762:8
5761	    if setting_name == "email_notifications_batching_period_seconds":
5762	        assert isinstance(old_value, int)
5763	        assert isinstance(setting_value, int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5763:8
5762	        assert isinstance(old_value, int)
5763	        assert isinstance(setting_value, int)
5764	        update_scheduled_email_notifications_time(user_profile, old_value, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5773:8
5772	    if setting_name == "default_language":
5773	        assert isinstance(setting_value, str)
5774	        event["language_name"] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:5803:12
5802	        if setting_name == "default_language":
5803	            assert isinstance(setting_value, str)
5804	            legacy_event["language_name"] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:6222:8
6221	    all_push_message_ids = (
6222	        UserMessage.objects.filter(
6223	            user_profile=user_profile,
6224	        )
6225	        .extra(
6226	            where=[UserMessage.where_active_push_notification()],
6227	        )
6228	        .values_list("message_id", flat=True)[0:10000]

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:6232:11
6231	
6232	    msgs = UserMessage.objects.filter(user_profile=user_profile).extra(
6233	        where=[UserMessage.where_unread()],
6234	    )
6235	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:6281:11
6280	
6281	    msgs = msgs.extra(
6282	        where=[UserMessage.where_unread()],
6283	    )
6284	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:6319:15
6318	) -> int:
6319	    messages = UserMessage.objects.filter(
6320	        user_profile=user_profile, message__sender=muted_user
6321	    ).extra(where=[UserMessage.where_unread()])
6322	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6382:4
6381	    # only for the message-edit use case where we'll have a single message_id.
6382	    assert len(user_profile_ids) == 1 or len(message_ids) == 1
6383	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\actions.py:6386:8
6385	    notifications_to_update = list(
6386	        UserMessage.objects.filter(
6387	            message_id__in=message_ids,
6388	            user_profile_id__in=user_profile_ids,
6389	        )
6390	        .extra(
6391	            where=[UserMessage.where_active_push_notification()],
6392	        )
6393	        .values_list("user_profile_id", "message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6765:8
6764	    if content is not None:
6765	        assert rendering_result is not None
6766	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6768:8
6767	        # mention_data is required if there's a content edit.
6768	        assert mention_data is not None
6769	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6857:8
6856	    if new_stream is not None:
6857	        assert content is None
6858	        assert target_message.is_stream_message()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6858:8
6857	        assert content is None
6858	        assert target_message.is_stream_message()
6859	        assert stream_being_edited is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6859:8
6858	        assert target_message.is_stream_message()
6859	        assert stream_being_edited is not None
6860	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6928:8
6927	    if propagate_mode in ["change_later", "change_all"]:
6928	        assert topic_name is not None or new_stream is not None
6929	        assert stream_being_edited is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6929:8
6928	        assert topic_name is not None or new_stream is not None
6929	        assert stream_being_edited is not None
6930	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:6957:12
6956	        if new_stream is not None:
6957	            assert stream_being_edited is not None
6958	            changed_message_ids = [msg.id for msg in changed_messages]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7043:16
7042	            if new_stream is not None:
7043	                assert delete_event_notify_user_ids is not None
7044	                subscriptions = subscriptions.exclude(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7157:8
7156	    ):
7157	        assert stream_being_edited is not None
7158	        maybe_send_resolve_topic_notifications(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7187:8
7186	    if not sample_message.is_stream_message():
7187	        assert len(messages) == 1
7188	        message_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7326:16
7325	            for stream_dict in lst:
7326	                assert isinstance(stream_dict["stream_id"], int)
7327	                stream_id = stream_dict["stream_id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7331:12
7330	        for slim_stream_dict in never_subscribed:
7331	            assert isinstance(slim_stream_dict["stream_id"], int)
7332	            stream_id = slim_stream_dict["stream_id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7691:8
7690	        invite = confirmation_obj.content_object
7691	        assert invite is not None
7692	        invites.append(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7765:4
7764	    realm = prereg_user.realm
7765	    assert realm is not None
7766	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7789:4
7788	    # These are two structurally for the caller's code path.
7789	    assert prereg_user.referred_by is not None
7790	    assert prereg_user.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:7790:4
7789	    assert prereg_user.referred_by is not None
7790	    assert prereg_user.realm is not None
7791	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:8197:12
8196	            bot_owner = user_profile.bot_owner
8197	            assert bot_owner is not None
8198	            owner_stream_ids = get_subscribed_stream_ids_for_user(bot_owner)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\actions.py:8736:4
8735	    export_extra_data = export.extra_data
8736	    assert export_extra_data is not None
8737	    export_data = orjson.loads(export_extra_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:59:8
58	    ) -> None:
59	        assert msg_type in ["stream", "private"]
60	        if msg_type == "stream" and topic is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:76:8
75	    def user_profiles(self) -> Sequence[UserProfile]:
76	        assert self.is_private()
77	        assert self._user_profiles is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:77:8
76	        assert self.is_private()
77	        assert self._user_profiles is not None
78	        return self._user_profiles

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:81:8
80	    def stream(self) -> Optional[Stream]:
81	        assert self.is_stream()
82	        return self._stream

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:85:8
84	    def stream_name(self) -> Optional[str]:
85	        assert self.is_stream()
86	        return self._stream_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:89:8
88	    def stream_id(self) -> Optional[int]:
89	        assert self.is_stream()
90	        return self._stream_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:93:8
92	    def topic(self) -> str:
93	        assert self.is_stream()
94	        assert self._topic is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:94:8
93	        assert self.is_stream()
94	        assert self._topic is not None
95	        return self._topic

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:180:8
179	    def for_private(emails: Sequence[str], realm: Realm) -> "Addressee":
180	        assert len(emails) > 0
181	        user_profiles = get_user_profiles(emails, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:189:8
188	    def for_user_ids(user_ids: Sequence[int], realm: Realm) -> "Addressee":
189	        assert len(user_ids) > 0
190	        user_profiles = get_user_profiles_by_ids(user_ids, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:123:4
122	        return upload_backend.get_avatar_url(hash_key, medium=medium)
123	    assert email is not None
124	    return _get_unversioned_gravatar_url(email, medium)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:134:4
133	    # avatar_url can return None if client_gravatar=True, however here we use the default value of False
134	    assert avatar is not None
135	    return urllib.parse.urljoin(user_profile.realm.uri, avatar)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar_hash.py:27:4
26	    # it in order to make the hashing scheme different from Gravatar's.
27	    assert settings.AVATAR_SALT is not None
28	    user_key = uid + settings.AVATAR_SALT

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_config.py:75:4
74	    bot_module = importlib.import_module(bot_module_name)
75	    assert bot_module.__file__ is not None
76	    bot_module_path = os.path.dirname(bot_module.__file__)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_lib.py:99:8
98	
99	        assert message["type"] == "private"
100	        # Ensure that it's a comma-separated list, even though the

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_storage.py:43:8
42	    for key, value in entries:
43	        assert isinstance(key, str), "Key type should be str."
44	        assert isinstance(value, str), "Value type should be str."

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_storage.py:44:8
43	        assert isinstance(key, str), "Key type should be str."
44	        assert isinstance(value, str), "Value type should be str."
45	        storage_size_difference += (len(key) + len(value)) - get_bot_storage_size(bot_profile, key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:104:4
103	) -> None:
104	    assert model in [UserProfile, Stream]
105	    for obj in objects:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:106:8
105	    for obj in objects:
106	        assert isinstance(obj, model)
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:121:8
120	    for recipient in recipients:
121	        assert recipient.type == recipient_type
122	        result = objects_dict.get(recipient.type_id)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\cache.py:123:17
122	    # Memcached keys should have a length of less than 250.
123	    KEY_PREFIX = hashlib.sha1(KEY_PREFIX.encode()).hexdigest() + ":"
124	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:261:4
260	    keys = rkeys + okeys
261	    assert len(keys) == len(set(keys))
262	    assert "type" in rkeys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:262:4
261	    assert len(keys) == len(set(keys))
262	    assert "type" in rkeys
263	    assert "id" not in keys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:263:4
262	    assert "type" in rkeys
263	    assert "id" not in keys
264	    return DictType(

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\lib\debug.py:88:11
87	    sock = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)
88	    path = f"/tmp/tracemalloc.{os.getpid()}"
89	    sock.bind(path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\digest.py:281:4
280	    # We expect a non-empty list of users all from the same realm.
281	    assert users
282	    realm = users[0].realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\digest.py:284:8
283	    for user in users:
284	        assert user.realm_id == realm.id
285	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\display_recipient.py:38:8
37	    if recipient_type == Recipient.STREAM:
38	        assert recipient_type_id is not None
39	        stream = Stream.objects.values("name").get(id=recipient_type_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:242:12
241	            content = part.get_payload(decode=True)
242	            assert isinstance(content, bytes)
243	            if charsets[idx]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:269:12
268	        else:
269	            assert html_content  # Needed for mypy. Ensured by the validating block above.
270	            return html_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:275:12
274	        else:
275	            assert plaintext_content  # Needed for mypy. Ensured by the validating block above.
276	            return plaintext_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:453:4
452	
453	    assert recipient is not None
454	    if recipient.type == Recipient.STREAM:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:460:8
459	        display_recipient = get_display_recipient(recipient)
460	        assert not isinstance(display_recipient, str)
461	        recipient_str = display_recipient[0]["email"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:466:8
465	        display_recipient = get_display_recipient(recipient)
466	        assert not isinstance(display_recipient, str)
467	        emails = [user_dict["email"] for user_dict in display_recipient]

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:12:0
11	import html2text
12	import lxml.html
13	import pytz

--------------------------------------------------
>> Issue: [B410:blacklist] Using builder to parse untrusted XML data is known to be vulnerable to XML attacks. Replace builder with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:20:0
19	from django.utils.translation import override as override_language
20	from lxml.html import builder as E
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:104:8
103	        # we assert that it does not.
104	        assert match is not None
105	        emoji_code = match.group("emoji_code")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:218:8
217	
218	        assert message.rendered_content is not None
219	        fragment = lxml.html.fragment_fromstring(message.rendered_content, create_parent=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:239:12
238	            display_recipient = get_display_recipient(message.recipient)
239	            assert not isinstance(display_recipient, str)
240	            narrow_link = get_narrow_url(user, message, display_recipient=display_recipient)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:323:8
322	    if message.recipient.type == Recipient.PERSONAL:
323	        assert stream is None
324	        assert display_recipient is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:324:8
323	        assert stream is None
324	        assert display_recipient is None
325	        return personal_narrow_url(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:330:8
329	    elif message.recipient.type == Recipient.HUDDLE:
330	        assert stream is None
331	        if display_recipient is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:333:8
332	            display_recipient = get_display_recipient(message.recipient)
333	        assert display_recipient is not None
334	        assert not isinstance(display_recipient, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:334:8
333	        assert display_recipient is not None
334	        assert not isinstance(display_recipient, str)
335	        other_user_ids = [r["id"] for r in display_recipient if r["id"] != user_profile.id]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:341:8
340	    else:
341	        assert display_recipient is None
342	        if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:470:8
469	        # Make sure that this is a list of strings, not a string.
470	        assert not isinstance(display_recipient, str)
471	        other_recipients = [r["full_name"] for r in display_recipient if r["id"] != user_profile.id]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_validation.py:208:8
207	    for key, error_info in error_dict.items():
208	        assert key == email
209	        msg, deactivated = error_info

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:241:4
240	
241	    assert event["message_type"] == message_type
242	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:251:8
250	    if is_legacy:
251	        assert num_message_ids == 1
252	        keys.add("message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:254:8
253	    else:
254	        assert isinstance(event["message_ids"], list)
255	        assert num_message_ids == len(event["message_ids"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:255:8
254	        assert isinstance(event["message_ids"], list)
255	        assert num_message_ids == len(event["message_ids"])
256	        keys.add("message_ids")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:258:4
257	
258	    assert set(event.keys()) == keys
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:278:4
277	    _check_has_zoom_token(var_name, event)
278	    assert event["value"] == value
279	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:435:4
434	
435	    assert ("email" in event) == has_email
436	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:437:4
436	
437	    assert isinstance(event["presence"], dict)
438	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:440:4
439	    # Our tests only have one presence value.
440	    assert len(event["presence"]) == 1
441	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:442:4
441	
442	    assert list(event["presence"].keys())[0] == presence_key
443	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:444:4
443	
444	    assert list(event["presence"].values())[0]["status"] == status
445	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:563:4
562	
563	    assert isinstance(event["bot"], dict)
564	    bot_type = event["bot"]["bot_type"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:651:4
650	
651	    assert isinstance(event["bot"], dict)
652	    assert {"user_id", field} == set(event["bot"].keys())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:652:4
651	    assert isinstance(event["bot"], dict)
652	    assert {"user_id", field} == set(event["bot"].keys())
653	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:705:4
704	    _check_realm_playgrounds(var_name, event)
705	    assert isinstance(event["realm_playgrounds"], list)
706	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:739:4
738	
739	    assert isinstance(event["realm_emoji"], dict)
740	    for k, v in event["realm_emoji"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:741:8
740	    for k, v in event["realm_emoji"].items():
741	        assert v["id"] == k
742	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:782:4
781	    # exercise that case, so we do strict validation for a single export here.
782	    assert isinstance(event["exports"], list)
783	    assert len(event["exports"]) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:783:4
782	    assert isinstance(event["exports"], list)
783	    assert len(event["exports"]) == 1
784	    export = event["exports"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:787:4
786	    # Now verify which fields have non-None values.
787	    assert has_export_url == (export["export_url"] is not None)
788	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:788:4
787	    assert has_export_url == (export["export_url"] is not None)
788	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)
789	    assert has_failed_timestamp == (export["failed_timestamp"] is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:789:4
788	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)
789	    assert has_failed_timestamp == (export["failed_timestamp"] is not None)
790	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:876:4
875	
876	    assert prop == event["property"]
877	    value = event["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:880:8
879	    if prop == "plan_type":
880	        assert isinstance(value, int)
881	        assert "extra_data" in event.keys()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:881:8
880	        assert isinstance(value, int)
881	        assert "extra_data" in event.keys()
882	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:884:4
883	
884	    assert "extra_data" not in event.keys()
885	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:887:8
886	    if prop in ["notifications_stream_id", "signup_notifications_stream_id"]:
887	        assert isinstance(value, int)
888	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:893:8
892	    if property_type in (bool, int, str):
893	        assert isinstance(value, property_type)
894	    elif property_type == (int, type(None)):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:895:8
894	    elif property_type == (int, type(None)):
895	        assert isinstance(value, int)
896	    elif property_type == (str, type(None)):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:897:8
896	    elif property_type == (str, type(None)):
897	        assert isinstance(value, str)
898	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:920:4
919	
920	    assert prop == event["property"]
921	    assert prop != "default_language"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:921:4
920	    assert prop == event["property"]
921	    assert prop != "default_language"
922	    assert prop in RealmUserDefault.property_types

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:922:4
921	    assert prop != "default_language"
922	    assert prop in RealmUserDefault.property_types
923	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:925:4
924	    prop_type = RealmUserDefault.property_types[prop]
925	    assert isinstance(event["value"], prop_type)
926	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1010:8
1009	    if event["property"] == "default":
1010	        assert isinstance(event["data"], dict)
1011	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1260:8
1259	    if prop == "description":
1260	        assert extra_keys == {"rendered_description"}
1261	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1261:8
1260	        assert extra_keys == {"rendered_description"}
1261	        assert isinstance(value, str)
1262	    elif prop == "email_address":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1263:8
1262	    elif prop == "email_address":
1263	        assert extra_keys == set()
1264	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1264:8
1263	        assert extra_keys == set()
1264	        assert isinstance(value, str)
1265	    elif prop == "invite_only":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1266:8
1265	    elif prop == "invite_only":
1266	        assert extra_keys == {"history_public_to_subscribers", "is_web_public"}
1267	        assert isinstance(value, bool)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1267:8
1266	        assert extra_keys == {"history_public_to_subscribers", "is_web_public"}
1267	        assert isinstance(value, bool)
1268	    elif prop == "message_retention_days":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1269:8
1268	    elif prop == "message_retention_days":
1269	        assert extra_keys == set()
1270	        if value is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1271:12
1270	        if value is not None:
1271	            assert isinstance(value, int)
1272	    elif prop == "name":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1273:8
1272	    elif prop == "name":
1273	        assert extra_keys == set()
1274	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1274:8
1273	        assert extra_keys == set()
1274	        assert isinstance(value, str)
1275	    elif prop == "stream_post_policy":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1276:8
1275	    elif prop == "stream_post_policy":
1276	        assert extra_keys == set()
1277	        assert value in Stream.STREAM_POST_POLICY_TYPES

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1277:8
1276	        assert extra_keys == set()
1277	        assert value in Stream.STREAM_POST_POLICY_TYPES
1278	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1363:4
1362	    _check_subscription_update(var_name, event)
1363	    assert event["property"] == property
1364	    assert event["value"] == value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1364:4
1363	    assert event["property"] == property
1364	    assert event["value"] == value
1365	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1455:4
1454	
1455	    assert isinstance(setting_name, str)
1456	    if setting_name == "timezone":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1457:8
1456	    if setting_name == "timezone":
1457	        assert isinstance(setting, str)
1458	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1460:8
1459	        setting_type = UserProfile.property_types[setting_name]
1460	        assert isinstance(setting, setting_type)
1461	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1463:8
1462	    if setting_name == "default_language":
1463	        assert "language_name" in event.keys()
1464	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1465:8
1464	    else:
1465	        assert "language_name" not in event.keys()
1466	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1476:4
1475	
1476	    assert isinstance(setting_name, str)
1477	    if setting_name == "timezone":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1478:8
1477	    if setting_name == "timezone":
1478	        assert isinstance(value, str)
1479	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1481:8
1480	        setting_type = UserProfile.property_types[setting_name]
1481	        assert isinstance(value, setting_type)
1482	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1484:8
1483	    if setting_name == "default_language":
1484	        assert "language_name" in event.keys()
1485	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1486:8
1485	    else:
1486	        assert "language_name" not in event.keys()
1487	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1512:4
1511	    setting = event["setting"]
1512	    assert setting == desired_val
1513	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1514:4
1513	
1514	    assert isinstance(setting_name, str)
1515	    setting_type = UserProfile.notification_settings_legacy[setting_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1516:4
1515	    setting_type = UserProfile.notification_settings_legacy[setting_name]
1516	    assert isinstance(setting, setting_type)
1517	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1621:8
1620	        expected_keys.update(tup[0] for tup in update_message_content_or_embedded_data_fields)
1621	        assert event["user_id"] is None
1622	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1623:8
1622	    else:
1623	        assert isinstance(event["user_id"], int)
1624	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1625:4
1624	
1625	    assert event["rendering_only"] == is_embedded_update_only
1626	    assert expected_keys == actual_keys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1626:4
1625	    assert event["rendering_only"] == is_embedded_update_only
1626	    assert expected_keys == actual_keys
1627	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1726:4
1725	
1726	    assert isinstance(event["data"], dict)
1727	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1728:4
1727	
1728	    assert set(event["data"].keys()) == {field}
1729	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1752:4
1751	
1752	    assert set(event.keys()) == {"id", "type", "user_id"} | fields

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:128:8
127	    if realm is None:
128	        assert user_profile is not None
129	        realm = user_profile.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:601:8
600	        # To ensure we have the correct user state set.
601	        assert state["is_admin"] is False
602	        assert state["is_owner"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:602:8
601	        assert state["is_admin"] is False
602	        assert state["is_owner"] is False
603	        assert state["is_guest"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:603:8
602	        assert state["is_owner"] is False
603	        assert state["is_guest"] is True
604	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:718:12
717	                    break
718	            assert state_draft_idx is not None
719	            _draft_update_action(state_draft_idx)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1204:12
1203	        if event["setting_name"] != "timezone":
1204	            assert event["setting_name"] in UserProfile.display_settings_legacy
1205	        state[event["setting_name"]] = event["setting"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1207:8
1206	    elif event["type"] == "update_global_notifications":
1207	        assert event["notification_name"] in UserProfile.notification_settings_legacy
1208	        state[event["notification_name"]] = event["setting"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1213:12
1212	        if event["property"] != "timezone":
1213	            assert event["property"] in UserProfile.property_types
1214	        if event["property"] in {

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\export.py:14:0
13	import shutil
14	import subprocess
15	import tempfile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:335:4
334	
335	    assert ALL_ZULIP_TABLES == all_tables_db, error_message
336	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:336:4
335	    assert ALL_ZULIP_TABLES == all_tables_db, error_message
336	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message
337	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:337:4
336	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message
337	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
338	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:338:4
337	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
338	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
339	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:339:4
338	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
339	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES), error_message
340	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:381:4
380	
381	    assert output_file.endswith(".json")
382	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:482:8
481	    ) -> None:
482	        assert table or custom_tables
483	        self.table = table

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:500:12
499	        if self.include_rows:
500	            assert self.include_rows.endswith("_id__in")
501	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:504:12
503	            # enforce a naming convention
504	            assert self.custom_fetch.__name__.startswith("custom_fetch_")
505	            if self.normal_parent is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:574:8
573	    else:
574	        assert (
575	            table is not None
576	        ), """
577	            You must specify config.custom_tables if you
578	            are not specifying config.table"""
579	        exported_tables = [table]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:607:8
606	            logging.info("Deleted temporary %s", t)
607	        assert table is not None
608	        response[table] = data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:611:8
610	    elif config.use_all:
611	        assert model is not None
612	        query = model.objects.all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:621:8
620	        model = config.model
621	        assert parent is not None
622	        assert parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:622:8
621	        assert parent is not None
622	        assert parent.table is not None
623	        assert config.include_rows is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:623:8
622	        assert parent.table is not None
623	        assert config.include_rows is not None
624	        parent_ids = [r["id"] for r in response[parent.table]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:628:8
627	            filter_parms.update(config.filter_args)
628	        assert model is not None
629	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:652:8
651	        model = config.model
652	        assert model is not None
653	        # This will be a tuple of the form ('zerver_article', 'blog').

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:666:8
665	    if rows is not None:
666	        assert table is not None  # Hint for mypy
667	        response[table] = make_raw(rows, exclude=config.exclude)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1000:16
999	            if row["id"] in exportable_user_ids:
1000	                assert not row["is_mirror_dummy"]
1001	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1169:4
1168	    See write_message_partial_for_query for more context."""
1169	    assert input_path.endswith(".partial") or input_path.endswith(".locked")
1170	    assert output_path.endswith(".json")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1170:4
1169	    assert input_path.endswith(".partial") or input_path.endswith(".locked")
1170	    assert output_path.endswith(".json")
1171	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1305:8
1304	        # overhead.
1305	        assert len(message_ids.intersection(all_message_ids)) == 0
1306	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1824:8
1823	    if not settings.TEST_SUITE:
1824	        assert threads >= 1
1825	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1885:4
1884	    tarball_path = output_dir.rstrip("/") + ".tar.gz"
1885	    subprocess.check_call(
1886	        [
1887	            "tar",
1888	            f"-czf{tarball_path}",
1889	            f"-C{os.path.dirname(output_dir)}",
1890	            os.path.basename(output_dir),
1891	        ]
1892	    )
1893	    return tarball_path

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1885:4
1884	    tarball_path = output_dir.rstrip("/") + ".tar.gz"
1885	    subprocess.check_call(
1886	        [
1887	            "tar",
1888	            f"-czf{tarball_path}",
1889	            f"-C{os.path.dirname(output_dir)}",
1890	            os.path.basename(output_dir),
1891	        ]
1892	    )
1893	    return tarball_path

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1942:18
1941	
1942	        process = subprocess.Popen(arguments)
1943	        pids[process.pid] = shard_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:2075:4
2074	
2075	    assert id_field == "id" or id_field.endswith("_id")
2076	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:2299:8
2298	
2299	        assert acting_user is not None
2300	        exports_dict[export.id] = dict(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:28:22
27	    for _ in itertools.repeat(None, num_single_word_topics):
28	        topics.append(random.choice(config["nouns"]))
29	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:36:27
35	    for _ in itertools.repeat(None, num_topics - num_single_word_topics):
36	        generated_topic = [random.choice(config[pos]) for pos in sentence]
37	        topic = " ".join(filter(None, generated_topic))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:44:7
43	    # experience perfectly.
44	    if random.random() < 0.15:
45	        resolved_topic_probability = 0.5

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:51:11
50	    for topic in topics:
51	        if random.random() < resolved_topic_probability:
52	            final_topics.append(RESOLVED_TOPIC_PREFIX + topic)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:168:12
167	    vals = text.split()
168	    start = random.randrange(len(vals))
169	    end = random.randrange(len(vals) - start) + start

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:169:10
168	    start = random.randrange(len(vals))
169	    end = random.randrange(len(vals) - start) + start
170	    vals[start] = mode + vals[start]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:179:12
178	    vals = text.split()
179	    start = random.randrange(len(vals))
180	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:188:12
187	    vals = text.split()
188	    start = random.randrange(len(vals))
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\home.py:144:8
143	        client = RequestNotes.get_notes(request).client
144	        assert client is not None
145	        register_ret = do_events_register(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\home.py:238:8
237	        page_params["max_message_id"] = max_message_id
238	        assert isinstance(page_params["user_settings"], dict)
239	        page_params["user_settings"]["enable_desktop_notifications"] = False

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:3:0
2	
3	import lxml
4	from lxml.html.diff import htmldiff

--------------------------------------------------
>> Issue: [B410:blacklist] Using htmldiff to parse untrusted XML data is known to be vulnerable to XML attacks. Replace htmldiff with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:4:0
3	import lxml
4	from lxml.html.diff import htmldiff
5	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:442:4
441	    # See comments in bulk_import_user_message_data.
442	    assert "usermessage" not in related_table
443	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:528:12
527	            realm_emoji_row = realm_emoji_dct[new_realm_emoji_id]
528	            assert realm_emoji_row["name"] == row["emoji_name"]
529	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:628:4
627	    # memory errors. We don't even use ids from ID_MAP.
628	    assert "usermessage" not in table
629	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:858:12
857	        else:
858	            assert settings.LOCAL_UPLOADS_DIR is not None
859	            if processing_avatars or processing_emojis or processing_realm_icons:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:1440:12
1439	        for row in data["zerver_usermessage"]:
1440	            assert row["message"] in message_id_map
1441	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\integrations.py:308:8
307	    def __init__(self, name: str, *args: Any, **kwargs: Any) -> None:
308	        assert kwargs.get("client_name") is None
309	        client_name = self.DEFAULT_CLIENT_NAME.format(name=name.title())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\logging_util.py:84:60
83	                        tb = str(record)
84	                    key = self.__class__.__name__.upper() + hashlib.sha1(tb.encode()).hexdigest()
85	                    duplicate = cache.get(key) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\logging_util.py:280:8
279	        client = RequestNotes.get_notes(request).client
280	        assert client is not None
281	

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\__init__.py:28:0
27	from urllib.parse import urlencode, urljoin, urlsplit
28	from xml.etree import ElementTree as etree
29	from xml.etree.ElementTree import Element, SubElement

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\__init__.py:29:0
28	from xml.etree import ElementTree as etree
29	from xml.etree.ElementTree import Element, SubElement
30	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\markdown\__init__.py:34:0
33	import dateutil.tz
34	import lxml.etree
35	import markdown

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:595:12
594	            url = img.get("src")
595	            assert url is not None
596	            if is_static_or_current_realm_url(url, self.md.zulip_realm):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1010:16
1009	                elem = url_to_a(db_data, item["url"], item["text"])
1010	                assert isinstance(elem, Element)
1011	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1088:12
1087	            url = e.get("href")
1088	            assert url is not None
1089	            return (url, e.text)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1119:12
1118	        elif parent.tag == "p":
1119	            assert grandparent is not None
1120	            parent_index = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1877:16
1876	            elif user is not None:
1877	                assert isinstance(user, FullNameInfo)
1878	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:2057:8
2056	        href = el.get("href")
2057	        assert href is not None
2058	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\api_arguments_table_generator.py:177:16
176	                # Any path variable is required
177	                assert argument["required"]
178	                required_string = "required in path"

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\markdown\fenced_code.py:81:0
80	
81	import lxml.html
82	from django.utils.html import escape

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\nested_code_blocks.py:2:0
1	from typing import Any, List, Mapping, Optional, Tuple
2	from xml.etree.ElementTree import Element, SubElement
3	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\mdiff.py:3:0
2	import os
3	import subprocess
4	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\mdiff.py:19:11
18	    command = ["node", mdiff_path, output, expected_output]
19	    diff = subprocess.check_output(command, text=True)
20	    return diff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:522:12
521	            obj["last_edit_timestamp"] = datetime_to_timestamp(last_edit_time)
522	            assert edit_history_json is not None
523	            edit_history: List[EditHistoryEvent] = orjson.loads(edit_history_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:541:12
540	
541	            assert message is not None  # Hint for mypy.
542	            # It's unfortunate that we need to have side effects on the message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:618:12
617	        elif recipient_type in (Recipient.HUDDLE, Recipient.PERSONAL):
618	            assert not isinstance(display_recipient, str)
619	            display_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:766:4
765	    # get_web_public_streams_queryset
766	    assert stream.is_web_public
767	    assert not stream.deactivated

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:767:4
766	    assert stream.is_web_public
767	    assert not stream.deactivated
768	    assert not stream.invite_only

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:768:4
767	    assert not stream.deactivated
768	    assert not stream.invite_only
769	    assert stream.history_public_to_subscribers

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:769:4
768	    assert not stream.invite_only
769	    assert stream.history_public_to_subscribers
770	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:804:8
803	    else:
804	        assert stream.recipient_id == message.recipient_id
805	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:928:4
927	    # str is for streams.
928	    assert not isinstance(display_recipient, str)
929	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:966:8
965	    return list(
966	        UserMessage.objects.filter(
967	            user_profile=user_profile,
968	        )
969	        .extra(
970	            where=[UserMessage.where_starred()],
971	        )
972	        .order_by(

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:983:8
982	    user_msgs = (
983	        UserMessage.objects.filter(
984	            user_profile=user_profile,
985	        )
986	        .exclude(
987	            message__recipient_id__in=excluded_recipient_ids,
988	        )
989	        .extra(
990	            where=[UserMessage.where_unread()],
991	        )
992	        .values(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:1500:4
1499	        raise RequestVariableConversionError("message_content_delete_limit_seconds", value)
1500	    assert isinstance(value, int)
1501	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:17:4
16	    the bitwise xor of the two hex strings."""
17	    assert len(bytes_a) == len(bytes_b)
18	    return "".join(f"{int(x, 16) ^ int(y, 16):x}" for x, y in zip(bytes_a, bytes_b))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:32:4
31	def otp_encrypt_api_key(api_key: str, otp: str) -> str:
32	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
33	    hex_encoded_api_key = ascii_to_hex(api_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:34:4
33	    hex_encoded_api_key = ascii_to_hex(api_key)
34	    assert len(hex_encoded_api_key) == UserProfile.API_KEY_LENGTH * 2
35	    return xor_hex_strings(hex_encoded_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:39:4
38	def otp_decrypt_api_key(otp_encrypted_api_key: str, otp: str) -> str:
39	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
40	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:40:4
39	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
40	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2
41	    hex_encoded_api_key = xor_hex_strings(otp_encrypted_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:47:8
46	    try:
47	        assert len(otp) == UserProfile.API_KEY_LENGTH * 2
48	        [int(c, 16) for c in otp]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notification_data.py:25:12
24	        if self.pm_email_notify or self.pm_push_notify:
25	            assert not (self.stream_email_notify or self.stream_push_notify)
26	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notification_data.py:28:12
27	        if self.stream_email_notify or self.stream_push_notify:
28	            assert not (self.pm_email_notify or self.pm_push_notify)
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\outgoing_webhook.py:206:4
205	    content = response_data.get("content")
206	    assert content
207	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\outgoing_webhook.py:260:4
259	    bot_owner = bot.bot_owner
260	    assert bot_owner is not None
261	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\push_notifications.py:12:0
11	import gcm
12	import lxml.html
13	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:71:8
70	    def __init__(self, user_id: Optional[int] = None, user_uuid: Optional[str] = None) -> None:
71	        assert user_id is not None or user_uuid is not None
72	        self.user_id = user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:89:12
88	        else:
89	            assert self.user_id is not None and self.user_uuid is not None
90	            return Q(user_uuid=self.user_uuid) | Q(user_id=self.user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:206:8
205	    if remote:
206	        assert settings.ZILENCER_ENABLED
207	        DeviceTokenClass: Type[AbstractPushDeviceToken] = RemotePushDeviceToken

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:425:8
424	    if remote:
425	        assert settings.ZILENCER_ENABLED
426	        DeviceTokenClass: Type[AbstractPushDeviceToken] = RemotePushDeviceToken

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:503:4
502	    response_data = send_json_to_push_bouncer("POST", "push/notify", post_data)
503	    assert isinstance(response_data["total_android_devices"], int)
504	    assert isinstance(response_data["total_apple_devices"], int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:504:4
503	    assert isinstance(response_data["total_android_devices"], int)
504	    assert isinstance(response_data["total_apple_devices"], int)
505	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:677:8
676	    else:
677	        assert message.is_stream_message() and trigger == NotificationTriggers.STREAM_PUSH
678	        return f"New stream message from {sender_str} in #{display_recipient}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:791:8
790	    if mentioned_user_group_id is not None:
791	        assert mentioned_user_group_name is not None
792	        data["mentioned_user_group_id"] = mentioned_user_group_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:815:8
814	        recipients = get_display_recipient(message.recipient)
815	        assert isinstance(recipients, list)
816	        return ", ".join(sorted(r["full_name"] for r in recipients))

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\push_notifications.py:862:8
861	    return (
862	        UserMessage.objects.filter(user_profile=user_profile)
863	        .extra(where=[UserMessage.where_active_push_notification()])
864	        .exclude(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:890:4
889	
890	    assert message.rendered_content is not None
891	    with override_language(user_profile.default_language):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:919:4
918	    )
919	    assert message.rendered_content is not None
920	    with override_language(user_profile.default_language):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:162:8
161	
162	        assert self.channel is not None
163	        self.channel.basic_qos(prefetch_count=self.prefetch)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:195:20
194	                if body is not None:
195	                    assert method is not None
196	                    events.append(orjson.loads(body))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:201:24
200	                    if events:
201	                        assert max_processed is not None
202	                        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:216:8
215	    def local_queue_size(self) -> int:
216	        assert self.channel is not None
217	        return self.channel.get_waiting_message_count() + len(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:222:8
221	    def stop_consuming(self) -> None:
222	        assert self.channel is not None
223	        assert self.is_consuming

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:223:8
222	        assert self.channel is not None
223	        assert self.is_consuming
224	        self.is_consuming = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:319:8
318	    def _on_open(self, connection: pika.connection.Connection) -> None:
319	        assert self.connection is not None
320	        self._connection_failure_count = 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:341:12
340	        def set_qos(frame: Any) -> None:
341	            assert self.channel is not None
342	            self.queues.add(queue_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:346:12
345	        def finish(frame: Any) -> None:
346	            assert self.channel is not None
347	            callback(self.channel)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:356:12
355	
356	            assert self.channel is not None
357	            self.channel.queue_declare(queue=queue_name, durable=True, callback=set_qos)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:359:12
358	        else:
359	            assert self.channel is not None
360	            callback(self.channel)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:375:12
374	        ) -> None:
375	            assert method.delivery_tag is not None
376	            callback([orjson.loads(body)])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:379:8
378	
379	        assert batch_size == 1
380	        assert timeout is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:380:8
379	        assert batch_size == 1
380	        assert timeout is None
381	        self.consumers[queue_name].add(wrapped_consumer)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:320:8
319	
320	        assert rules
321	        for time_window, max_count in rules:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:390:8
389	        "Returns a tuple of (rate_limited, time_till_free)"
390	        assert rules
391	        list_key, set_key, blocking_key = cls.get_keys(entity_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:513:12
512	        if over_limit:
513	            assert not remaining
514	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\redis_utils.py:82:4
81	def validate_key_fits_format(key: str, key_format: str) -> None:
82	    assert "{token}" in key_format
83	    regex = key_format.format(token=r"[a-zA-Z0-9]+")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-zA-Z0-9]+'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\redis_utils.py:83:12
82	    assert "{token}" in key_format
83	    regex = key_format.format(token=r"[a-zA-Z0-9]+")
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\remote_server.py:54:4
53	    """
54	    assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
55	    url = urllib.parse.urljoin(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:188:8
187	
188	        assert converter is None or (
189	            json_validator is None and str_validator is None
190	        ), "converter and json_validator are mutually exclusive"
191	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:191:8
190	        ), "converter and json_validator are mutually exclusive"
191	        assert (
192	            json_validator is None or str_validator is None
193	        ), "json_validator and str_validator are mutually exclusive"
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:373:16
372	                # or don't declare them using REQ.
373	                assert func_var_name in kwargs
374	            if func_var_name in kwargs:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:376:12
375	                continue
376	            assert func_var_name is not None
377	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:388:16
387	                # This is a view bug, not a user error, and thus should throw a 500.
388	                assert param.argument_type is None, "Invalid argument type"
389	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:395:20
394	                for req_var in post_var_names:
395	                    assert req_var is not None
396	                    if req_var in request.POST:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:412:20
411	                    post_var_name = param.post_var_name
412	                    assert post_var_name is not None
413	                    if param.default is _REQ.NotSpecified:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:140:4
139	    # (such as UserMessage, Reaction, and Attachment) inside the same transaction.atomic() block.
140	    assert type in (ArchiveTransaction.MANUAL, ArchiveTransaction.RETENTION_POLICY_BASED)
141	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:194:4
193	) -> int:
194	    assert message_retention_days != -1
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:226:4
225	    message_retention_days = realm.message_retention_days
226	    assert message_retention_days != -1
227	    check_date = timezone_now() - timedelta(days=message_retention_days)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:300:4
299	def move_models_with_message_key_to_archive(msg_ids: List[int]) -> None:
300	    assert len(msg_ids) > 0
301	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:326:4
325	def move_attachments_to_archive(msg_ids: List[int]) -> None:
326	    assert len(msg_ids) > 0
327	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:344:4
343	def move_attachment_messages_to_archive(msg_ids: List[int]) -> None:
344	    assert len(msg_ids) > 0
345	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:417:12
416	        else:
417	            assert realm.message_retention_days != -1
418	            retention_policy_dict[stream.id] = realm.message_retention_days

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:701:4
700	        raise RequestVariableConversionError("message_retention_days", value)
701	    assert isinstance(value, int)
702	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\safe_session_cached_db.py:20:8
19	    def save(self, must_create: bool = False) -> None:
20	        assert not get_connection().in_atomic_block
21	        super().save(must_create)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\safe_session_cached_db.py:24:8
23	    def delete(self, session_key: Optional[str] = None) -> None:
24	        assert not get_connection().in_atomic_block
25	        super().delete(session_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:41:8
40	        # shouldn't be called with request being None.
41	        assert request is not None
42	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:147:8
146	        email = d.get("userName")
147	        assert isinstance(email, str)
148	        self.change_delivery_email(email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:160:12
159	        if full_name:
160	            assert isinstance(full_name, str)
161	            self.change_full_name(full_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:173:12
172	        if active is not None:
173	            assert isinstance(active, bool)
174	            self.change_is_active(active)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:209:12
208	            # overridden upstream method.
209	            assert path is not None
210	            value = {path: value}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:212:8
211	
212	        assert isinstance(value, dict)
213	        for path, val in (value or {}).items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:215:16
214	            if path.first_path == ("userName", None, None):
215	                assert isinstance(val, str)
216	                self.change_delivery_email(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:220:16
219	                # for updates via PUT.
220	                assert isinstance(val, str)
221	                self.change_full_name(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:223:16
222	            elif path.first_path == ("active", None, None):
223	                assert isinstance(val, bool)
224	                self.change_is_active(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:237:8
236	        realm = RequestNotes.get_notes(self._request).realm
237	        assert realm is not None
238	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:274:12
273	        if self.is_new_user():
274	            assert full_name_new_value is not None
275	            self.obj = do_create_user(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:331:8
330	        realm = RequestNotes.get_notes(request).realm
331	        assert realm is not None
332	        return {"realm_id": realm.id, "is_bot": False}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:346:4
345	    realm = RequestNotes.get_notes(request).realm
346	    assert realm is not None
347	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim_filter.py:58:8
57	        """
58	        assert request is not None
59	        realm = RequestNotes.get_notes(request).realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim_filter.py:60:8
59	        realm = RequestNotes.get_notes(request).realm
60	        assert realm is not None
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:64:12
63	        if language is None:
64	            assert user_profile is not None
65	            language = user_profile.default_language

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:83:4
82	    # Callers should pass exactly one of to_user_id and to_email.
83	    assert (to_user_ids is None) ^ (to_emails is None)
84	    if to_user_ids is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:87:12
86	        if realm is None:
87	            assert len({to_user.realm_id for to_user in to_users}) == 1
88	            realm = to_users[0].realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:303:8
302	        connection = get_connection()
303	        assert connection is not None
304	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:322:12
321	        try:
322	            assert connection.connection is not None
323	            status = connection.connection.noop()[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:366:4
365	
366	    assert (to_user_ids is None) ^ (to_emails is None)
367	    with transaction.atomic():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:382:16
381	            else:
382	                assert to_emails is not None
383	                assert len(to_emails) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:383:16
382	                assert to_emails is not None
383	                assert len(to_emails) == 1
384	                email.address = parseaddr(to_emails[0])[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:149:4
148	    """
149	    assert user_profile.last_active_message_id is not None
150	    all_stream_subs = list(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:187:12
186	        if stream_subscription_logs[-1].event_type == RealmAuditLog.SUBSCRIPTION_DEACTIVATED:
187	            assert stream_subscription_logs[-1].event_last_message_id is not None
188	            if (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:249:8
248	        last_message = Message.objects.last()
249	        assert last_message is not None
250	        user_profile.last_active_message_id = last_message.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:226:8
225	        # Our caller should only pass us private streams.
226	        assert stream.invite_only
227	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:261:4
260	    # backwards-compatibility problem in our view.
261	    assert not notification_settings_null
262	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:76:4
75	
76	    assert policy_name is not None
77	    return policy_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:647:8
646	        # caller, but it makes sense to verify anyway.
647	        assert stream_name == stream_name.strip()
648	        check_stream_name(stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\subdomains.py:85:8
84	        public_upload_root_url = get_public_upload_root_url()
85	        assert public_upload_root_url.endswith("/")
86	        if url.startswith(public_upload_root_url):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\lib\templates.py:176:11
175	
176	    return mark_safe(rendered_html)
177	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\lib\templates.py:176:11
175	
176	    return mark_safe(rendered_html)
177	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_classes.py:5:0
4	import shutil
5	import subprocess
6	import tempfile

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\test_classes.py:28:0
27	
28	import lxml.html
29	import orjson

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-z0-9_]{24}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\test_classes.py:214:30
213	    DEFAULT_SUBDOMAIN = "zulip"
214	    TOKENIZED_NOREPLY_REGEX = settings.TOKENIZED_NOREPLY_EMAIL_ADDRESS.format(token="[a-z0-9_]{24}")
215	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:218:12
217	        if "subdomain" in kwargs:
218	            assert isinstance(kwargs["subdomain"], str)
219	            kwargs["HTTP_HOST"] = Realm.host_for_subdomain(kwargs["subdomain"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:237:12
236	            # Provide a way to disable setting User-Agent if desired.
237	            assert "HTTP_USER_AGENT" not in kwargs
238	            del kwargs["skip_user_agent"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:400:8
399	        intentionally_undocumented = kwargs.pop("intentionally_undocumented", False)
400	        assert isinstance(intentionally_undocumented, bool)
401	        django_client = self.client  # see WRAPPER_COMMENT

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:426:8
425	        intentionally_undocumented = kwargs.pop("intentionally_undocumented", False)
426	        assert isinstance(intentionally_undocumented, bool)
427	        django_client = self.client  # see WRAPPER_COMMENT

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:548:8
547	        div = cast(lxml.html.HtmlMixin, doc).get_element_by_id("page-params")
548	        assert div is not None
549	        page_params_json = div.get("data-params")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:550:8
549	        page_params_json = div.get("data-params")
550	        assert page_params_json is not None
551	        page_params = orjson.loads(page_params_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:586:8
585	        """
586	        assert "@" not in name, "use login_by_email for email logins"
587	        user = self.example_user(name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:714:16
713	                match = re.search(url_pattern, message.body)
714	                assert match is not None
715	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:746:8
745	        # TODO: use encode_user where possible
746	        assert "@" in email
747	        user = get_user_by_delivery_email(email, get_realm(realm))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:846:8
845	        to_user_ids = [u.id for u in to_users]
846	        assert len(to_user_ids) >= 2
847	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:933:8
932	    def assert_streaming_content(self, response: HttpResponse, result: bytes) -> None:
933	        assert isinstance(response, StreamingHttpResponse)
934	        data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1509:12
1508	            realm_emoji_id = int(row.emoji_code)
1509	            assert realm_emoji_id in dct
1510	            self.assertEqual(dct[realm_emoji_id].name, row.emoji_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1516:12
1515	            realm_emoji_id = int(row.emoji_code)
1516	            assert realm_emoji_id in dct
1517	            self.assertEqual(dct[realm_emoji_id].name, row.emoji_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1659:8
1658	        """
1659	        assert self.STREAM_NAME is not None
1660	        self.subscribe(self.test_user, self.STREAM_NAME)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1692:8
1691	            )
1692	        assert expected_message is not None and expected_topic is not None
1693	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1777:8
1776	    def get_body(self, fixture_name: str) -> str:
1777	        assert self.WEBHOOK_DIR_NAME is not None
1778	        body = self.webhook_fixture_data(self.WEBHOOK_DIR_NAME, fixture_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1794:8
1793	        app_config = apps.get_containing_app_config(type(self).__module__)
1794	        assert app_config is not None
1795	        return app_config.name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1801:8
1800	    def setUp(self) -> None:
1801	        assert (
1802	            self.migrate_from and self.migrate_to
1803	        ), f"TestCase '{type(self).__name__}' must define migrate_from and migrate_to properties"
1804	        migrate_from: List[Tuple[str, str]] = [(self.app, self.migrate_from)]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_console_output.py:140:4
139	    console_log_handler = logging.getLogger("django.server").handlers[0]
140	    assert isinstance(console_log_handler, logging.StreamHandler)
141	    assert console_log_handler.stream == stderr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_console_output.py:141:4
140	    assert isinstance(console_log_handler, logging.StreamHandler)
141	    assert console_log_handler.stream == stderr
142	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_fixtures.py:6:0
5	import shutil
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\test_fixtures.py:369:4
368	    commands = "\n".join(f"DROP DATABASE IF EXISTS {db};" for db in databases_to_drop)
369	    subprocess.run(
370	        ["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost", "postgres", "zulip_test"],
371	        input=commands,
372	        check=True,
373	        text=True,
374	    )
375	    return len(databases_to_drop)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_fixtures.py:369:4
368	    commands = "\n".join(f"DROP DATABASE IF EXISTS {db};" for db in databases_to_drop)
369	    subprocess.run(
370	        ["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost", "postgres", "zulip_test"],
371	        input=commands,
372	        check=True,
373	        text=True,
374	    )
375	    return len(databases_to_drop)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_fixtures.py:401:4
400	    # Make sure default database is 'zulip_test'.
401	    assert connections["default"].settings_dict["NAME"] == "zulip_test"
402	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:219:4
218	    avatar_url_path = avatar_url(user_profile, medium)
219	    assert avatar_url_path is not None
220	    avatar_disk_path = os.path.join(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:243:12
242	            match = key_regex.search(message.body)
243	            assert match is not None
244	            [key] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:412:12
411	        def re_strip(r: str) -> str:
412	            assert r.startswith(r"^")
413	            if r.endswith(r"$"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:416:16
415	            else:
416	                assert r.endswith(r"\Z")
417	                return r[1:-2]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:462:8
461	
462	        assert len(pattern_cnt) > 100
463	        untested_patterns = {p.replace("\\", "") for p in pattern_cnt if pattern_cnt[p] == 0}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:534:4
533	def load_subdomain_token(response: HttpResponse) -> ExternalAuthDataDict:
534	    assert isinstance(response, HttpResponseRedirect)
535	    token = response.url.rsplit("/", 1)[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:537:4
536	    data = ExternalAuthResult(login_token=token, delete_stored_data=False).data_dict
537	    assert data is not None
538	    return data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:708:8
707	        marshalled_event = orjson.loads(orjson.dumps(event))
708	        assert marshalled_event == event
709	        inner(queue_name, event, processor)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\test_runner.py:31:28
30	# below hack, which fails 1/10000000 of the time.
31	random_id_range_start = str(random.randint(1, 10000000))
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_runner.py:253:8
252	        # definitions.
253	        assert not isinstance(self.subsuites, SubSuiteList)
254	        self.subsuites: Union[SubSuiteList, List[TestSuite]] = SubSuiteList(self.subsuites)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_runner.py:449:8
448	        # implementation details.
449	        assert isinstance(suite.subsuites, SubSuiteList)
450	        return [name for subsuite in suite.subsuites for name in subsuite[1]]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\tex.py:3:0
2	import os
3	import subprocess
4	from typing import Optional

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\tex.py:37:17
36	    try:
37	        stdout = subprocess.check_output(command, input=tex, stderr=subprocess.DEVNULL, text=True)
38	        # stdout contains a newline at the end

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:60:12
59	            # Attempt to raise a TimeoutExpired in the thread represented by 'self'.
60	            assert self.ident is not None  # Thread should be running; c_long expects int
61	            tid = ctypes.c_long(self.ident)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:95:4
94	        raise thread.exc_info[1].with_traceback(thread.exc_info[2])
95	    assert thread.result is not None  # assured if above did not reraise
96	    return thread.result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\unminify.py:22:8
21	        # Prevent path traversal
22	        assert ".." not in minified_src and "/" not in minified_src
23	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:107:4
106	    value = re.sub(r"[-\s]+", "-", value)
107	    assert value not in {"", ".", ".."}
108	    return mark_safe(value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:148:4
147	def resize_animated(im: Image.Image, size: int = DEFAULT_EMOJI_SIZE) -> bytes:
148	    assert im.n_frames > 1
149	    frames = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:440:8
439	        split_url = urllib.parse.urlsplit(foo_url)
440	        assert split_url.path.endswith(f"/{DUMMY_KEY}")
441	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:450:8
449	    ) -> str:
450	        assert not key.startswith("/")
451	        return urllib.parse.urljoin(self.public_upload_url_base, key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:723:12
722	            )
723	            assert still_image_data is not None
724	            upload_image_to_s3(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:767:8
766	    def delete_export_tarball(self, export_path: str) -> Optional[str]:
767	        assert export_path.startswith("/")
768	        path_id = export_path[1:]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'local_file_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\lib\upload.py:810:31
809	
810	LOCAL_FILE_ACCESS_TOKEN_SALT = "local_file_"
811	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\upload.py:841:23
840	                realm_id,
841	                format(random.randint(0, 255), "x"),
842	                secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:980:12
979	        if is_animated:
980	            assert still_image_data is not None
981	            still_path = RealmEmoji.STILL_PATH_ID_TEMPLATE.format(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:1025:8
1024	        # Get the last element of a list in the form ['user_avatars', '<file_path>']
1025	        assert export_path.startswith("/")
1026	        file_path = export_path[1:].split("/", 1)[-1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:1120:4
1119	) -> bool:
1120	    assert (user_profile.realm_id == realm.id) or is_cross_realm_bot_email(
1121	        user_profile.delivery_email
1122	    )
1123	    attachment = Attachment.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:1165:8
1164	    if response.status_code == 200:
1165	        assert type(response.content) == bytes
1166	        return response.content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:1172:8
1171	    if response.status_code == 200:
1172	        assert type(response.content) == bytes
1173	        return response.content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload.py:1199:8
1198	        # When this runs, emojis have already been migrated to always have .author set.
1199	        assert user_profile is not None
1200	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\url_preview\parsers\generic.py:29:12
28	        if isinstance(meta_description, Tag) and meta_description.get("content", "") != "":
29	            assert isinstance(meta_description["content"], str)
30	            return meta_description["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\url_preview\parsers\generic.py:51:16
50	            if isinstance(first_image, Tag) and first_image["src"] != "":
51	                assert isinstance(first_image["src"], str)
52	                try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_agent.py:18:4
17	    match = pattern.match(user_agent)
18	    assert match is not None
19	    return match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:167:8
166	    if base_query is None:
167	        assert realm is not None
168	        query = UserProfile.objects.filter(realm=realm, is_active=True)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\users.py:189:15
188	        where_clause = "upper(zerver_userprofile.email::text) IN (SELECT upper(email) FROM unnest(%s) AS email)"
189	        return query.select_related("realm").extra(where=[where_clause], params=(emails,))
190	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:356:8
355	        # Put an assertion so that mypy doesn't complain.
356	        assert field_data is not None
357	        return choice_field_validator(var_name, field_data, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:95:4
94	def assert_is_not_none(value: Optional[T]) -> T:
95	    assert value is not None
96	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:221:12
220	            valid_item = sub_validator(vname, item)
221	            assert item is valid_item  # To justify the unchecked cast below
222	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:284:16
283	                valid_value = value_validator(vname, val[key])
284	                assert val[key] is valid_value  # To justify the unchecked cast below
285	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:392:8
391	        valid_value = validator("field_data", value)
392	        assert value is valid_value  # To justify the unchecked cast below
393	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:468:4
467	
468	    assert isinstance(poll_data, dict)
469	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:511:4
510	
511	    assert isinstance(todo_data, dict)
512	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:111:4
110	    client = RequestNotes.get_notes(request).client
111	    assert client is not None
112	    if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:113:8
112	    if stream is None:
113	        assert user_profile.bot_owner is not None
114	        check_send_private_message(user_profile, client, user_profile.bot_owner, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:167:4
166	) -> Optional[str]:
167	    assert request.user.is_authenticated
168	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\logging_handlers.py:5:0
4	import platform
5	import subprocess
6	import traceback

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\logging_handlers.py:24:15
23	    try:  # nocoverage
24	        return subprocess.check_output(
25	            ["git", "describe", "--tags", "--match=[0-9]*", "--always", "--dirty", "--long"],
26	            stderr=subprocess.PIPE,
27	            cwd=os.path.join(os.path.dirname(__file__), ".."),
28	            text=True,
29	        ).strip()
30	    except (FileNotFoundError, subprocess.CalledProcessError):  # nocoverage

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\logging_handlers.py:24:15
23	    try:  # nocoverage
24	        return subprocess.check_output(
25	            ["git", "describe", "--tags", "--match=[0-9]*", "--always", "--dirty", "--long"],
26	            stderr=subprocess.PIPE,
27	            cwd=os.path.join(os.path.dirname(__file__), ".."),
28	            text=True,
29	        ).strip()
30	    except (FileNotFoundError, subprocess.CalledProcessError):  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\add_scim_client.py:18:8
17	        realm = self.get_realm(options)
18	        assert realm
19	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\add_users_to_streams.py:22:8
21	        realm = self.get_realm(options)
22	        assert realm is not None  # Should be ensured by parser
23	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\backup.py:104:12
103	
104	            assert not any("|" in name or "|" in path for name, path in paths)
105	            transform_args = [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\change_realm_subdomain.py:17:8
16	        realm = self.get_realm(options)
17	        assert realm is not None  # Should be ensured by parser
18	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\compilemessages.py:4:0
3	import re
4	from subprocess import CalledProcessError, check_output
5	from typing import Any, Dict, List

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\compilemessages.py:73:17
72	    def get_locales(self) -> List[str]:
73	        output = check_output(["git", "ls-files", "locale"], text=True)
74	        tracked_files = output.split()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\compilemessages.py:73:17
72	    def get_locales(self) -> List[str]:
73	        output = check_output(["git", "ls-files", "locale"], text=True)
74	        tracked_files = output.split()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_default_stream_groups.py:39:8
38	        realm = self.get_realm(options)
39	        assert realm is not None  # Should be ensured by parser
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_stream.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_user.py:66:8
65	        realm = self.get_realm(options)
66	        assert realm is not None  # Should be ensured by parser
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\deactivate_realm.py:20:8
19	
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\delete_realm.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\edit_linkifiers.py:44:8
43	        realm = self.get_realm(options)
44	        assert realm is not None  # Should be ensured by parser
45	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\email_mirror.py:66:16
65	                status, msg_data = mbox.fetch(message_id, "(RFC822)")
66	                assert isinstance(msg_data[0], tuple)
67	                msg_as_bytes = msg_data[0][1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\email_mirror.py:70:16
69	                # https://github.com/python/typeshed/issues/2417
70	                assert isinstance(message, EmailMessage)
71	                yield message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\export.py:111:8
110	        realm = self.get_realm(options)
111	        assert realm is not None  # Should be ensured by parser
112	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export_single_user.py:2:0
1	import os
2	import subprocess
3	import tempfile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export_single_user.py:49:8
48	        tarball_path = output_dir.rstrip("/") + ".tar.gz"
49	        subprocess.check_call(
50	            [
51	                "tar",
52	                f"-czf{tarball_path}",
53	                f"-C{os.path.dirname(output_dir)}",
54	                os.path.basename(output_dir),
55	            ]
56	        )
57	        print(f"Tarball written to {tarball_path}")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export_single_user.py:49:8
48	        tarball_path = output_dir.rstrip("/") + ".tar.gz"
49	        subprocess.check_call(
50	            [
51	                "tar",
52	                f"-czf{tarball_path}",
53	                f"-C{os.path.dirname(output_dir)}",
54	                os.path.basename(output_dir),
55	            ]
56	        )
57	        print(f"Tarball written to {tarball_path}")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\import.py:3:0
2	import os
3	import subprocess
4	from typing import Any

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\import.py:57:8
56	        call_command("flush", verbosity=0, interactive=False)
57	        subprocess.check_call([os.path.join(settings.DEPLOY_ROOT, "scripts/setup/flush-memcached")])
58	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\makemessages.py:39:0
38	import re
39	import subprocess
40	from typing import Any, Collection, Dict, Iterator, List, Mapping

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\makemessages.py:204:20
203	
204	        extracted = subprocess.check_output(
205	            [
206	                "node_modules/.bin/formatjs",
207	                "extract",
208	                "--additional-function-names=$t,$t_html",
209	                "--format=simple",
210	                "--ignore=**/*.d.ts",
211	                "static/js/**/*.js",
212	                "static/js/**/*.ts",
213	            ]
214	        )
215	        translation_strings.extend(json.loads(extracted).values())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\makemessages.py:204:20
203	
204	        extracted = subprocess.check_output(
205	            [
206	                "node_modules/.bin/formatjs",
207	                "extract",
208	                "--additional-function-names=$t,$t_html",
209	                "--format=simple",
210	                "--ignore=**/*.d.ts",
211	                "static/js/**/*.js",
212	                "static/js/**/*.ts",
213	            ]
214	        )
215	        translation_strings.extend(json.loads(extracted).values())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\merge_streams.py:36:8
35	        realm = self.get_realm(options)
36	        assert realm is not None  # Should be ensured by parser
37	        stream_to_keep = get_stream(options["stream_to_keep"], realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\process_queue.py:80:12
79	                td.start()
80	            assert len(queues) == cnt
81	            logger.info("%d queue worker threads were launched", cnt)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\reactivate_realm.py:16:8
15	        realm = self.get_realm(options)
16	        assert realm is not None  # Should be ensured by parser
17	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:29:8
28	        realm = self.get_realm(options)
29	        assert realm is not None  # Should be ensured by parser
30	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:33:16
32	            for realm_domain in get_realm_domains(realm):
33	                assert isinstance(realm_domain["domain"], str)
34	                if realm_domain["allow_subdomains"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:40:8
39	
40	        assert isinstance(options["domain"], str)
41	        domain = options["domain"].strip().lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:47:12
46	        if options["op"] == "add":
47	            assert isinstance(options["allow_subdomains"], bool)
48	            try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\register_server.py:1:0
1	import subprocess
2	from argparse import ArgumentParser
3	from typing import Any, Dict

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\register_server.py:97:16
96	                print(f"Success! Updating {SECRETS_FILENAME} with the new key...")
97	                subprocess.check_call(
98	                    [
99	                        "crudini",
100	                        "--set",
101	                        SECRETS_FILENAME,
102	                        "secrets",
103	                        "zulip_org_key",
104	                        request["new_org_key"],
105	                    ]
106	                )
107	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\register_server.py:97:16
96	                print(f"Success! Updating {SECRETS_FILENAME} with the new key...")
97	                subprocess.check_call(
98	                    [
99	                        "crudini",
100	                        "--set",
101	                        SECRETS_FILENAME,
102	                        "secrets",
103	                        "zulip_org_key",
104	                        request["new_org_key"],
105	                    ]
106	                )
107	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\remove_users_from_stream.py:23:8
22	        realm = self.get_realm(options)
23	        assert realm is not None  # Should be ensured by parser
24	        user_profiles = self.get_users(options, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\rename_stream.py:21:8
20	        realm = self.get_realm(options)
21	        assert realm is not None  # Should be ensured by parser
22	        old_name = options["old_name"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\runtornado.py:53:8
52	        addrport = options["addrport"]
53	        assert isinstance(addrport, str)
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\runtornado.py:86:16
85	                queue_client = get_queue_client()
86	                assert isinstance(queue_client, TornadoQueueClient)
87	                # Process notifications received via RabbitMQ

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\scrub_realm.py:16:8
15	        realm = self.get_realm(options)
16	        assert realm is not None  # Should be ensured by parser
17	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_realm_reactivation_email.py:18:8
17	        realm = self.get_realm(options)
18	        assert realm is not None
19	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_to_email_mirror.py:105:16
104	                # https://github.com/python/typeshed/issues/2417
105	                assert isinstance(message, EmailMessage)
106	                return message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\show_admins.py:17:8
16	        realm = self.get_realm(options)
17	        assert realm is not None  # True because of required=True above
18	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:67:4
66	    log_data = RequestNotes.get_notes(request).log_data
67	    assert log_data is not None
68	    record_request_stop_data(log_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:83:4
82	    log_data = RequestNotes.get_notes(request).log_data
83	    assert log_data is not None
84	    if "time_restarted" in log_data:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:164:4
163	) -> None:
164	    assert error_content is None or error_content_iter is None
165	    if error_content is not None:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\middleware.py:282:23
281	        log_data["prof"].disable()
282	        profile_path = "/tmp/profile.data.{}.{}".format(path.split("/")[-1], int(time_delta * 1000))
283	        log_data["prof"].dump_stats(profile_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:287:8
286	    if 400 <= status_code < 500 and status_code not in [401, 404, 405]:
287	        assert error_content_iter is not None
288	        error_content_list = list(error_content_iter)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:351:12
350	            # Tornado code path that returns responses asynchronously.
351	            assert request_notes.saved_response is not None
352	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:379:8
378	        # importing modules on the first start)
379	        assert request_notes.log_data is not None
380	        request_notes.log_data["startup_time_delta"] = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:410:12
409	        if response.streaming:
410	            assert isinstance(response, StreamingHttpResponse)
411	            content_iter: Optional[Iterator[bytes]] = response.streaming_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:417:8
416	
417	        assert request_notes.client_name is not None and request_notes.log_data is not None
418	        write_log_line(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:516:8
515	            patch_vary_headers(response, ("Accept-Language",))
516	        assert language is not None
517	        response.setdefault("Content-Language", language)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:631:4
630	    ).placeholder_open_graph_description
631	    assert placeholder_open_graph_description is not None
632	    return content.replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:644:12
643	        if RequestNotes.get_notes(request).placeholder_open_graph_description is not None:
644	            assert not response.streaming
645	            response.content = alter_content(request, response.content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:688:4
687	    # allowing free access to the SCIM API:
688	    assert valid_bearer_token
689	    assert scim_client_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:689:4
688	    assert valid_bearer_token
689	    assert scim_client_name
690	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:695:4
694	    request_notes = RequestNotes.get_notes(request)
695	    assert request_notes.realm
696	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:105:8
104	        # Since these users are in password_change_user_ids, this must not be None.
105	        assert earliest_password_change is not None
106	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'empty_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:140:40
139	
140	    AFFECTED_USER_TYPE_EMPTY_PASSWORD = "empty_password"
141	    AFFECTED_USER_TYPE_CHANGED_PASSWORD = "changed_password"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'changed_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:141:42
140	    AFFECTED_USER_TYPE_EMPTY_PASSWORD = "empty_password"
141	    AFFECTED_USER_TYPE_CHANGED_PASSWORD = "changed_password"
142	    MIGRATION_ID = "0209_user_profile_no_empty_password"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0237_rename_zulip_realm_to_zulipinternal.py:31:4
30	    welcome_bot = UserProfile.objects.get(email="welcome-bot@zulip.com")
31	    assert welcome_bot.realm.id == internal_realm.id
32	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\migrations\0257_fix_has_link_attribute.py:6:0
5	
6	import lxml
7	from django.db import migrations

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:67:4
66	    # so it's not worth writing code to fix them.
67	    assert not RealmAuditLog.objects.filter(event_type__in=unlikely_event_types).exists()
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:94:16
93	            if isinstance(old_value, dict):
94	                assert prop in improperly_marshalled_properties
95	                old_value = old_value["id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:97:16
96	            if isinstance(new_value, dict):
97	                assert prop in improperly_marshalled_properties
98	                new_value = new_value["id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:101:8
100	        # Sanity check that the original event has exactly the keys we expect.
101	        assert set(extra_data.keys()) <= {OLD_VALUE, NEW_VALUE}
102	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:154:4
153	    """
154	    assert user_ids
155	    clause = f"{field} IN %s"

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:156:12
155	    clause = f"{field} IN %s"
156	    query = query.extra(
157	        where=[clause],
158	        params=(tuple(user_ids),),
159	    )
160	    return query

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:219:4
218	    supported_backends = django.contrib.auth.get_backends()
219	    assert supported_backends is not None
220	    return supported_backends

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2024:8
2023	
2024	        assert policy_value == Realm.POLICY_FULL_MEMBERS_ONLY
2025	        return not self.is_provisional_member

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2245:4
2244	
2245	    assert invite_expires_in_days is not None
2246	    if not isinstance(invite_expires_in_days, UnspecifiedValue):

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:2658:12
2657	        return (
2658	            get_active_streams(realm)
2659	            .select_related()
2660	            .extra(where=[where_clause], params=(list(stream_names),))
2661	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2688:4
2687	def get_huddle_user_ids(recipient: Recipient) -> List[int]:
2688	    assert recipient.type == Recipient.HUDDLE
2689	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2704:4
2703	    """
2704	    assert all(recipient.type == Recipient.HUDDLE for recipient in recipients)
2705	    if not recipients:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2973:20
2972	                for r in get_display_recipient(self.recipient):
2973	                    assert not isinstance(r, str)  # It will only be a string for streams
2974	                    if not r["id"] == self.user_profile_id:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:3595:4
3594	        return get_system_bot(email, realm.id)
3595	    assert realm is not None
3596	    return get_user(email, realm)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\javascript_examples.py:9:0
8	import os
9	import subprocess
10	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\javascript_examples.py:21:13
20	
21	    output = subprocess.check_output(
22	        args=["node", "--unhandled-rejections=strict", "zerver/openapi/javascript_examples.js"],
23	        text=True,
24	    )
25	    endpoint_responses = json.loads(output)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\markdown_extension.py:251:8
250	        # We currently don't have any non-JSON encoded arrays.
251	        assert jsonify
252	        if curl_argument:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:46:12
45	        if isinstance(b_value, list):
46	            assert isinstance(a_value, list)
47	            ret[key] = a_value + b_value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:49:12
48	        elif isinstance(b_value, dict):
49	            assert isinstance(a_value, dict)
50	            ret[key] = naively_merge(a_value, b_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:68:8
67	        ret = naively_merge_allOf_dict(ret)
68	        assert isinstance(subschemas, list)
69	        for subschema in subschemas:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:70:12
69	        for subschema in subschemas:
70	            assert isinstance(subschema, dict)
71	            ret = naively_merge(ret, naively_merge_allOf_dict(subschema))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:157:8
156	        self.check_reload()
157	        assert len(self._openapi) > 0
158	        return self._openapi

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:165:8
164	        self.check_reload()
165	        assert len(self._endpoints_dict) > 0
166	        return self._endpoints_dict

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:174:8
173	        self.check_reload()
174	        assert self._request_validator is not None
175	        return self._request_validator

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:183:8
182	        self.check_reload()
183	        assert self._response_validator is not None
184	        return self._response_validator

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:526:8
525	    if likely_deprecated_parameter(description):
526	        assert argument["deprecated"]
527	    if "deprecated" in argument:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:528:8
527	    if "deprecated" in argument:
528	        assert likely_deprecated_parameter(description)
529	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:63:4
62	
63	    assert ids_list == user_ids
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:95:4
94	    # {code_example|end}
95	    assert result["result"] == "success"
96	    assert "newbie@zulip.com" in result["subscribed"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:96:4
95	    assert result["result"] == "success"
96	    assert "newbie@zulip.com" in result["subscribed"]
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:164:4
163	
164	    assert result["result"] == "success"
165	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:224:4
223	    members = [m for m in result["members"] if m["email"] == "newbie@zulip.com"]
224	    assert len(members) == 1
225	    newbie = members[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:226:4
225	    newbie = members[0]
226	    assert not newbie["is_admin"]
227	    assert newbie["full_name"] == "New User"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:227:4
226	    assert not newbie["is_admin"]
227	    assert newbie["full_name"] == "New User"
228	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:235:4
234	    validate_against_openapi_schema(result, "/users", "get", "200")
235	    assert result["members"][0]["avatar_url"] is not None
236	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:245:12
244	        if member["is_bot"]:
245	            assert member.get("profile_data", None) is None
246	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:247:12
246	        else:
247	            assert member.get("profile_data", None) is not None
248	        assert member["avatar_url"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:248:8
247	            assert member.get("profile_data", None) is not None
248	        assert member["avatar_url"] is None
249	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:524:4
523	
524	    assert result["result"] == "success"
525	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:541:4
540	
541	    assert result["result"] == "success"
542	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:554:4
553	    streams = [s for s in result["streams"] if s["name"] == "new stream"]
554	    assert streams[0]["description"] == "New stream for testing"
555	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:563:4
562	    validate_against_openapi_schema(result, "/streams", "get", "200")
563	    assert len(result["streams"]) == 5
564	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:581:4
580	    validate_against_openapi_schema(result, "/streams/{stream_id}", "patch", "200")
581	    assert result["result"] == "success"
582	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:594:4
593	    hamlet_user_group = [u for u in result["user_groups"] if u["name"] == "hamletcharacters"][0]
594	    assert hamlet_user_group["description"] == "Characters of Hamlet"
595	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:614:4
613	    # {code_example|end}
614	    assert result["subscribers"] == [11, 26]
615	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:620:4
619	    result = client.get_user_agent()
620	    assert result.startswith("ZulipPython/")
621	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:633:4
632	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]
633	    assert streams[0]["description"] == "New stream for testing"
634	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:650:4
649	    result = client.get_subscriptions()
650	    assert result["result"] == "success"
651	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:652:4
651	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]
652	    assert len(streams) == 0
653	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:824:4
823	    validate_against_openapi_schema(result, "/messages", "get", "200")
824	    assert len(result["messages"]) <= request["num_before"]
825	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:853:4
852	
853	    assert int(message_id)
854	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:913:4
912	    )
913	    assert result["result"] == "success"
914	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:914:4
913	    assert result["result"] == "success"
914	    assert result["raw_content"] == request["content"]
915	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:938:4
937	    )
938	    assert result["result"] == "success"
939	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:939:4
938	    assert result["result"] == "success"
939	    assert result["raw_content"] == request["content"]
940	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1000:4
999	
1000	    assert int(message_id)
1001	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1021:4
1020	    )
1021	    assert result["result"] == "success"
1022	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1022:4
1021	    assert result["result"] == "success"
1022	    assert result["raw_content"] == request["content"]
1023	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1331:4
1330	
1331	    assert result["result"] == "success"
1332	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1340:4
1339	
1340	    assert result["result"] == "success"
1341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1349:4
1348	
1349	    assert result["result"] == "success"
1350	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1367:4
1366	
1367	    assert result["result"] == "success"
1368	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1381:4
1380	    # {code_example|end}
1381	    assert result["result"] == "success"
1382	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1391:4
1390	    validate_against_openapi_schema(result, "/user_groups/{user_group_id}", "delete", "200")
1391	    assert result["result"] == "success"
1392	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\test_curl_examples.py:13:0
12	import shlex
13	import subprocess
14	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\test_curl_examples.py:101:36
100	                    # returns non-JSON output, we'll still print it.
101	                    response_json = subprocess.check_output(generated_curl_command, text=True)
102	                    response = json.loads(response_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\test_curl_examples.py:103:20
102	                    response = json.loads(response_json)
103	                    assert response["result"] == "success"
104	                except (AssertionError, Exception):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_audit_log.py:160:19
159	        user = self.example_user("hamlet")
160	        password = "test1"
161	        do_change_password(user, password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:296:8
295	        modified_stream = subscription_creation_logs[0].modified_stream
296	        assert modified_stream is not None
297	        self.assertEqual(subscription_creation_logs.count(), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:310:8
309	        modified_stream = subscription_deactivation_logs[0].modified_stream
310	        assert modified_stream is not None
311	        self.assertEqual(subscription_deactivation_logs.count(), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:507:8
506	        audit_log = audit_entries.first()
507	        assert audit_log is not None
508	        self.assert_length(audit_entries, 1)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:268:19
267	        user_profile = self.example_user("hamlet")
268	        password = "testpassword"
269	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:306:19
305	        user_profile = self.example_user("hamlet")
306	        password = "testpassword"
307	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:322:19
321	        # Now do the same test with the empty string as the password.
322	        password = ""
323	        with self.assertRaises(PasswordTooWeakError):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:341:19
340	        user_profile = self.example_user("hamlet")
341	        password = "testpassword"
342	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:357:19
356	        user_profile = self.example_user("hamlet")
357	        password = "a_password_of_22_chars"
358	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:386:8
385	        self.assert_in_response(realm.description, result)
386	        assert realm.name is not None
387	        self.assert_in_response(realm.name, result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:439:12
438	        self.assertIsNone(
439	            backend.authenticate(
440	                request=mock.MagicMock(),
441	                username=email,
442	                password="wrongpass",
443	                realm=get_realm("zulip"),
444	            )
445	        )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:683:19
682	        user_profile = self.example_user("hamlet")
683	        password = "testpassword"
684	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'email_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:745:25
744	
745	        email_password = "email_password"
746	        user_profile.set_password(email_password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:803:8
802	        input = soup.find("input", value=True)
803	        assert isinstance(input, Tag)
804	        desktop_data = input["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:805:8
804	        desktop_data = input["value"]
805	        assert isinstance(desktop_data, str)
806	        a = soup.find("a", href=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:807:8
806	        a = soup.find("a", href=True)
807	        assert isinstance(a, Tag)
808	        browser_url = a["href"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1010:8
1009	        self.assertEqual(result.status_code, 302)
1010	        assert self.AUTHORIZATION_URL in result.url
1011	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1370:8
1369	        confirmation = Confirmation.objects.all().last()
1370	        assert confirmation is not None
1371	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1559:8
1558	        multiuse_confirmation = Confirmation.objects.all().last()
1559	        assert multiuse_confirmation is not None
1560	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1606:8
1605	        multiuse_confirmation = Confirmation.objects.all().last()
1606	        assert multiuse_confirmation is not None
1607	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1912:8
1911	        self.assertEqual(result.status_code, 302)
1912	        assert self.AUTHORIZATION_URL in result.url
1913	        assert "samlrequest" in result.url.lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1913:8
1912	        assert self.AUTHORIZATION_URL in result.url
1913	        assert "samlrequest" in result.url.lower()
1914	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1920:8
1919	        data = SAMLAuthBackend.get_data_from_redis(orjson.loads(relay_state)["state_token"])
1920	        assert data is not None
1921	        if next:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://appleid.apple.com/auth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:2910:23
2909	    AUTHORIZATION_URL = "https://appleid.apple.com/auth/authorize"
2910	    ACCESS_TOKEN_URL = "https://appleid.apple.com/auth/token"
2911	    AUTH_FINISH_URL = "/complete/apple/"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'invalid'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:3198:27
3197	        def initiate_auth(mobile_flow_otp: Optional[str] = None) -> None:
3198	            url, headers = self.prepare_login_url_and_headers(
3199	                subdomain="zulip",
3200	                id_token="invalid",
3201	                mobile_flow_otp=mobile_flow_otp,
3202	                account_data_dict=account_data_dict,
3203	            )
3204	            result = self.client_get(url, **headers)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_TESTOIDC_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3280:28
3279	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_TESTOIDC_KEY"
3280	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_TESTOIDC_SECRET"
3281	    LOGIN_URL = "/accounts/login/social/oidc"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GITHUB_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3491:28
3490	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GITHUB_KEY"
3491	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GITHUB_SECRET"
3492	    LOGIN_URL = "/accounts/login/social/github"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://github.com/login/oauth/access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3495:23
3494	    AUTHORIZATION_URL = "https://github.com/login/oauth/authorize"
3495	    ACCESS_TOKEN_URL = "https://github.com/login/oauth/access_token"
3496	    USER_INFO_URL = "https://api.github.com/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GITLAB_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4010:28
4009	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GITLAB_KEY"
4010	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GITLAB_SECRET"
4011	    LOGIN_URL = "/accounts/login/social/gitlab"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://gitlab.com/oauth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4014:23
4013	    AUTHORIZATION_URL = "https://gitlab.com/oauth/authorize"
4014	    ACCESS_TOKEN_URL = "https://gitlab.com/oauth/token"
4015	    USER_INFO_URL = "https://gitlab.com/api/v4/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GOOGLE_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4029:28
4028	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GOOGLE_KEY"
4029	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GOOGLE_SECRET"
4030	    LOGIN_URL = "/accounts/login/social/google"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://accounts.google.com/o/oauth2/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4033:23
4032	    AUTHORIZATION_URL = "https://accounts.google.com/o/oauth2/auth"
4033	    ACCESS_TOKEN_URL = "https://accounts.google.com/o/oauth2/token"
4034	    USER_INFO_URL = "https://www.googleapis.com/oauth2/v3/userinfo"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'nonsense'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4184:21
4183	        with self.assertLogs(level="WARNING") as m:
4184	            result = self.get_log_into_subdomain(data, force_token="nonsense")
4185	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4238:8
4237	        confirmation = Confirmation.objects.all().first()
4238	        assert confirmation is not None
4239	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4274:8
4273	        confirmation = Confirmation.objects.all().first()
4274	        assert confirmation is not None
4275	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4324:8
4323	        multiuse_confirmation = Confirmation.objects.all().last()
4324	        assert multiuse_confirmation is not None
4325	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4332:8
4331	        confirmation = Confirmation.objects.all().last()
4332	        assert confirmation is not None
4333	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4401:57
4400	        self.login_user(user)
4401	        result = self.client_post("/json/fetch_api_key", dict(password="wrong"))
4402	        self.assert_json_error(result, "Password is incorrect.", 400)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4437:37
4436	        result = self.client_post(
4437	            "/api/v1/fetch_api_key", dict(username=self.email, password="wrong")
4438	        )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4598:19
4597	        user_profile = self.example_user("hamlet")
4598	        password = "a_password_of_22_chars"
4599	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:5591:19
5590	        user_profile = self.example_user("hamlet")
5591	        password = "testpassword"
5592	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dapu'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5690:27
5689	        ):
5690	            user_profile = self.backend.authenticate(
5691	                request=mock.MagicMock(),
5692	                username="ldapuser1",
5693	                password="dapu",
5694	                realm=get_realm("zulip"),
5695	            )
5696	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5697:12
5696	
5697	            assert user_profile is None
5698	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5709:12
5708	
5709	            assert user_profile is not None
5710	            self.assertEqual(user_profile.delivery_email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5722:12
5721	
5722	            assert user_profile is not None
5723	            self.assertEqual(user_profile, self.example_user("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5736:12
5735	
5736	            assert user_profile is not None
5737	            self.assertEqual(user_profile, self.example_user("aaron"))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:5765:23
5764	            othello = self.example_user("othello")
5765	            password = "testpassword"
5766	            othello.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5781:19
5780	        with self.settings(LDAP_APPEND_DOMAIN="zulip.com"):
5781	            user = self.backend.authenticate(
5782	                request=mock.MagicMock(),
5783	                username=self.example_email("hamlet"),
5784	                password="wrong",
5785	                realm=get_realm("zulip"),
5786	            )
5787	            self.assertIs(user, None)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'doesnt_matter'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5794:19
5793	        ) as log_debug:
5794	            user = self.backend.authenticate(
5795	                request=mock.MagicMock(),
5796	                username="nonexistent@zulip.com",
5797	                password="doesnt_matter",
5798	                realm=get_realm("zulip"),
5799	            )
5800	            self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5977:12
5976	            )
5977	            assert user_profile is not None
5978	            self.assertEqual(user_profile.delivery_email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6009:12
6008	            )
6009	            assert user_profile is not None
6010	            self.assertEqual(user_profile.delivery_email, "newuser@acme.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6017:12
6016	            url = avatar_url(user_profile)
6017	            assert url is not None
6018	            response = self.client_get(url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6036:12
6035	            )
6036	            assert user_profile is not None
6037	            self.assertEqual(user_profile.delivery_email, "newuser_splitname@zulip.com")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:6065:13
6064	        """
6065	        with self.settings(
6066	            LDAP_DEACTIVATE_NON_MATCHING_USERS=True,
6067	            LDAP_APPEND_DOMAIN="zulip.com",
6068	            AUTH_LDAP_BIND_PASSWORD="wrongpass",
6069	        ):
6070	            with self.assertRaises(ldap.INVALID_CREDENTIALS):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6605:12
6604	            confirmation = Confirmation.objects.all().first()
6605	            assert confirmation is not None
6606	            confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6640:12
6639	            confirmation = Confirmation.objects.all().last()
6640	            assert confirmation is not None
6641	            confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:304:8
303	        profile = get_user(email, realm)
304	        assert profile.default_sending_stream is not None
305	        self.assertEqual(profile.default_sending_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:317:8
316	        profile = get_user(email, realm)
317	        assert profile.default_sending_stream is not None
318	        self.assertEqual(profile.default_sending_stream.name, "Rome")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:435:8
434	        profile = get_user(email, realm)
435	        assert profile.default_sending_stream is not None
436	        self.assertEqual(profile.default_sending_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:490:8
489	        profile = get_user(bot_email, bot_realm)
490	        assert profile.default_events_register_stream is not None
491	        self.assertEqual(profile.default_events_register_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:509:8
508	        bot_profile = get_user(bot_email, bot_realm)
509	        assert bot_profile.default_events_register_stream is not None
510	        self.assertEqual(bot_profile.default_events_register_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_cache.py:154:8
153	        last_user = UserProfile.objects.last()
154	        assert last_user is not None
155	        last_user_id = last_user.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_compatibility.py:54:16
53	            else:
54	                assert False  # nocoverage
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_compatibility.py:113:16
112	            else:
113	                assert False  # nocoverage
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_custom_profile_data.py:749:8
748	        self.login_user(iago)
749	        assert test_bot
750	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1121:24
1120	        user_profile = self.example_user("hamlet")
1121	        test_password = "abcd1234"
1122	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1208:57
1207	        self.login("cordelia")
1208	        result = self.client_post("/json/fetch_api_key", dict(password="wrong_password"))
1209	        self.assert_json_error_contains(result, "Password is incorrect")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1265:24
1264	        email = user_profile.delivery_email
1265	        test_password = "abcd1234"
1266	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1484:17
1483	    def test_valid_internal_requests(self) -> None:
1484	        secret = "random"
1485	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1515:17
1514	    def test_internal_requests_with_broken_secret(self) -> None:
1515	        secret = "random"
1516	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'broken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1521:13
1520	
1521	        with self.settings(SHARED_SECRET="broken"):
1522	            self.assertFalse(authenticate_notify(request))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1528:17
1527	    def test_external_requests(self) -> None:
1528	        secret = "random"
1529	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1682:8
1681	        bot.save()
1682	        self.login_by_email(bot.email, password="test")
1683	        self.assert_json_error_contains(self._do_test(bot), "Webhook bots can only access webhooks")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1802:12
1801	            request.session = self.client.session
1802	            assert type(request.user) is UserProfile
1803	            self.create_default_device(request.user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1832:12
1831	            request.session = self.client.session
1832	            assert type(request.user) is UserProfile
1833	            self.create_default_device(request.user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:2008:16
2007	                match = re.match('^(?P<count>[0-9]+) "(?P<user_agent>.*)"$', line)
2008	                assert match is not None
2009	                groupdict = match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_digest.py:272:8
271	
272	        assert len(users) >= 5
273	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_digest.py:395:8
394	        num_queued_users = len(queue_mock.call_args[0][0])
395	        assert num_queued_users >= 5
396	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_email_mirror.py:4:0
3	import os
4	import subprocess
5	from email import message_from_string

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:1314:8
1313	        mail = mail_template.format(stream_to_address=stream_to_address, sender=sender)
1314	        subprocess.run(
1315	            [script, "-r", stream_to_address, "-s", settings.SHARED_SECRET, "-t"],
1316	            input=mail,
1317	            check=True,
1318	            text=True,
1319	        )
1320	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:1329:12
1328	        mail = mail_template.format(stream_to_address=stream_to_address, sender=sender)
1329	        p = subprocess.run(
1330	            [script, "-s", settings.SHARED_SECRET, "-t"],
1331	            input=mail,
1332	            stdout=subprocess.PIPE,
1333	            text=True,
1334	        )
1335	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:1485:8
1484	        # https://github.com/python/typeshed/issues/2417
1485	        assert isinstance(incoming_message, EmailMessage)
1486	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\tests\test_email_notifications.py:10:0
9	import ldap
10	import lxml.html
11	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1402:12
1401	            output_data = lxml.html.tostring(fragment, encoding="unicode")
1402	            assert "spoiler-header" not in output_data
1403	            assert "spoiler-content" not in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1403:12
1402	            assert "spoiler-header" not in output_data
1403	            assert "spoiler-content" not in output_data
1404	            assert "spoiler-block" in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1404:12
1403	            assert "spoiler-content" not in output_data
1404	            assert "spoiler-block" in output_data
1405	            assert "spoiler-title" in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1405:12
1404	            assert "spoiler-block" in output_data
1405	            assert "spoiler-title" in output_data
1406	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:30:8
29	    def test_pm_to_embedded_bot(self) -> None:
30	        assert self.bot_profile is not None
31	        self.send_personal_message(self.user_profile, self.bot_profile, content="help")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:36:8
35	        display_recipient = get_display_recipient(last_message.recipient)
36	        assert isinstance(display_recipient, list)
37	        self.assert_length(display_recipient, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:41:8
40	    def test_stream_message_to_embedded_bot(self) -> None:
41	        assert self.bot_profile is not None
42	        self.send_stream_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:61:8
60	    def test_message_to_embedded_bot_with_initialize(self) -> None:
61	        assert self.bot_profile is not None
62	        self.subscribe(self.user_profile, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:75:8
74	    def test_embedded_bot_quit_exception(self) -> None:
75	        assert self.bot_profile is not None
76	        with patch(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_event_system.py:701:16
700	            def accepts_event(self, event: Dict[str, Any]) -> bool:
701	                assert event["type"] == "message"
702	                return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:489:8
488	        check_message("events[0]", events[0])
489	        assert isinstance(events[0]["message"]["avatar_url"], str)
490	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:496:8
495	        check_message("events[0]", events[0])
496	        assert events[0]["message"]["avatar_url"] is None
497	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1281:8
1280	        mute_object = get_mute_object(self.user_profile, muted_user)
1281	        assert mute_object is not None
1282	        # This is a hack to silence mypy errors which result from it not taking

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1297:8
1296	        check_realm_user_update("events[0]", events[0], "avatar_fields")
1297	        assert isinstance(events[0]["person"]["avatar_url"], str)
1298	        assert isinstance(events[0]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1298:8
1297	        assert isinstance(events[0]["person"]["avatar_url"], str)
1298	        assert isinstance(events[0]["person"]["avatar_url_medium"], str)
1299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1331:8
1330	        check_realm_user_update("events[1]", events[1], "avatar_fields")
1331	        assert isinstance(events[1]["person"]["avatar_url"], str)
1332	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1332:8
1331	        assert isinstance(events[1]["person"]["avatar_url"], str)
1332	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)
1333	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1351:8
1350	        check_realm_user_update("events[2]", events[2], "email")
1351	        assert isinstance(events[1]["person"]["avatar_url"], str)
1352	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1352:8
1351	        assert isinstance(events[1]["person"]["avatar_url"], str)
1352	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)
1353	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1769:8
1768	        last_realm_playground = RealmPlayground.objects.last()
1769	        assert last_realm_playground is not None
1770	        last_id = last_realm_playground.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:2146:8
2145	        self.subscribe(hamlet, "Denmark")
2146	        assert uri is not None
2147	        body = f"First message ...[zulip.txt](http://{hamlet.realm.host}" + uri + ")"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:2206:8
2205	        ).first()
2206	        assert audit_log_entry is not None
2207	        audit_log_entry_id = audit_log_entry.id

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_example.py:164:17
163	
164	        params = dict(
165	            email="romeo@zulip.net",
166	            password="xxxx",
167	            full_name="Romeo Montague",
168	        )
169	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_example.py:191:23
190	        do_change_can_create_users(iago, False)
191	        valid_params = dict(
192	            email="romeo@zulip.net",
193	            password="xxxx",
194	            full_name="Romeo Montague",
195	        )
196	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_example.py:253:8
252	        row = UserStatus.objects.last()
253	        assert row is not None
254	        self.assertEqual(row.user_profile_id, cordelia.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_external.py:312:8
311	        # Having closed it, it's now cached.  Clear the cache.
312	        assert CircuitBreakerMonitor.get("get_tor_ips").closed
313	        cache_delete("tor_ip_addresses:")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:566:15
565	    def create_bot(self, owner: UserProfile, bot_email: str, bot_name: str) -> UserProfile:
566	        user = do_create_user(
567	            email=bot_email,
568	            password="123",
569	            realm=owner.realm,
570	            full_name=bot_name,
571	            bot_type=UserProfile.DEFAULT_BOT,
572	            bot_owner=owner,
573	            acting_user=None,
574	        )
575	        return user

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:578:15
577	    def create_non_active_user(self, realm: Realm, email: str, name: str) -> UserProfile:
578	        user = do_create_user(
579	            email=email, password="123", realm=realm, full_name=name, acting_user=None
580	        )
581	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:220:12
219	            # hex in order to avoid large directories.
220	            assert len(slot) <= 2
221	            self.assert_length(random_hash, 24)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:229:8
228	        file_name = realm_emoji.file_name
229	        assert file_name.endswith(".png")
230	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:281:12
280	            fn = export_fn(f"avatars/{path}")
281	            assert os.path.exists(fn)
282	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:294:8
293	
294	        assert exported_paths
295	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:524:8
523	
524	        assert message is not None
525	        self.export_realm(realm, consent_message_id=message.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:601:8
600	        # Third huddle is not exported since none of the members gave consent
601	        assert huddle_a is not None and huddle_b is not None
602	        huddle_recipients = Recipient.objects.filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:648:12
647	            )
648	            assert realm_emoji
649	            self.assertEqual(realm_emoji.name, "hawaii")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:686:8
685	        reaction = Reaction.objects.order_by("id").last()
686	        assert reaction
687	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:700:8
699	        recipient = stream.recipient
700	        assert recipient is not None
701	        add_topic_mute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:729:8
728	        user_status = UserStatus.objects.order_by("id").last()
729	        assert user_status
730	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_import_export.py:735:22
734	        # data to test import of botstoragedata and botconfigdata
735	        bot_profile = do_create_user(
736	            email="bot-1@zulip.com",
737	            password="test",
738	            realm=original_realm,
739	            full_name="bot",
740	            bot_type=UserProfile.EMBEDDED_BOT,
741	            bot_owner=sample_user,
742	            acting_user=None,
743	        )
744	        storage = StateHandler(bot_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:760:12
759	            )
760	            assert new_realm_emoji is not None
761	        original_realm_emoji_count = RealmEmoji.objects.count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:805:12
804	            # the test is kind of meaningless
805	            assert orig_realm_result
806	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:890:12
889	            getters.append(f)
890	            assert f.__name__.startswith("get_")
891	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:893:12
892	            # Avoid dups
893	            assert f.__name__ not in names
894	            names.add(f.__name__)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1000:12
999	            names = {rec.name for rec in RealmEmoji.objects.filter(realm_id=r.id)}
1000	            assert "hawaii" in names
1001	            return names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1010:12
1009	            }
1010	            assert (cordelia.full_name, "hawaii", UserStatus.AWAY, "in Hawaii") in tups
1011	            return tups

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1391:8
1390	        reaction = Reaction.objects.order_by("id").last()
1391	        assert reaction
1392	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1397:8
1396	        hi_stream_message_id = self.send_stream_message(cordelia, "Denmark", "hi stream")
1397	        assert most_recent_usermessage(cordelia).message_id == hi_stream_message_id
1398	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1452:12
1451	            table_name = f.__name__
1452	            assert table_name not in checkers
1453	            checkers[table_name] = f

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1520:8
1519	        reaction = Reaction.objects.order_by("id").last()
1520	        assert reaction
1521	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_integrations.py:25:8
24	        integration = INTEGRATIONS["airbrake"]
25	        assert isinstance(integration, WebhookIntegration)
26	        screenshot_config = ScreenshotConfig("error_message.json", "002.png", "ci")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_integrations.py:33:8
32	        integration = INTEGRATIONS["nagios"]
33	        assert isinstance(integration, Integration)
34	        screenshot_config = BaseScreenshotConfig("service_notify.json", "001.png")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:82:8
81	        self.assertIn("title", data)
82	        assert data is not None  # allow mypy to infer data is indexable
83	        self.assertEqual(data["title"], response_data["title"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:112:8
111	        self.assertIn("title", data)
112	        assert data is not None  # allow mypy to infer data is indexable
113	        self.assertEqual(data["title"], response_data["title"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:141:8
140	        self.assertIn("title", data)
141	        assert data is not None  # allow mypy to infer data is indexable
142	        self.assertEqual(data["title"], response_data["title"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:138:8
137	        record = self.simulate_error()
138	        assert isinstance(record, HasRequest)
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:256:16
255	            for handler in logger.handlers:
256	                assert not isinstance(handler, AdminEmailHandler)
257	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_management_commands.py:209:8
208	        ]
209	        assert self.commands
210	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_management_commands.py:512:8
511	        message = Message.objects.last()
512	        assert message is not None
513	        do_add_reaction(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:219:19
218	        def make_user(email: str, full_name: str) -> UserProfile:
219	            return create_user(
220	                email=email,
221	                password="whatever",
222	                realm=realm,
223	                full_name=full_name,
224	            )
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_markdown.py:276:8
275	        user = mention_data.get_user_by_name("king hamLET")
276	        assert user is not None
277	        self.assertEqual(user.full_name, hamlet.full_name)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:2143:19
2142	        def make_user(email: str, full_name: str) -> UserProfile:
2143	            return create_user(
2144	                email=email,
2145	                password="whatever",
2146	                realm=realm,
2147	                full_name=full_name,
2148	            )
2149	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:2198:20
2197	        # Create a user that potentially interferes with the pattern.
2198	        test_user = create_user(
2199	            email="atomic@example.com",
2200	            password="whatever",
2201	            realm=realm,
2202	            full_name="Atomic #123",
2203	        )
2204	        content = "@**Atomic #123**"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:2377:8
2376	        # Check topic resolved notification message is only unread for participants.
2377	        assert (
2378	            UserMessage.objects.filter(
2379	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[2].id
2380	            )
2381	            .extra(where=[UserMessage.where_unread()])
2382	            .count()
2383	            == 3
2384	        )
2385	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:2378:12
2377	        assert (
2378	            UserMessage.objects.filter(
2379	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[2].id
2380	            )
2381	            .extra(where=[UserMessage.where_unread()])
2382	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:2386:8
2385	
2386	        assert (
2387	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[2].id)
2388	            .extra(where=[UserMessage.where_unread()])
2389	            .count()
2390	            == 0
2391	        )
2392	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:2387:12
2386	        assert (
2387	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[2].id)
2388	            .extra(where=[UserMessage.where_unread()])
2389	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:2443:8
2442	        # Check topic unresolved notification message is only unread for participants.
2443	        assert (
2444	            UserMessage.objects.filter(
2445	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[3].id
2446	            )
2447	            .extra(where=[UserMessage.where_unread()])
2448	            .count()
2449	            == 3
2450	        )
2451	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:2444:12
2443	        assert (
2444	            UserMessage.objects.filter(
2445	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[3].id
2446	            )
2447	            .extra(where=[UserMessage.where_unread()])
2448	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:2452:8
2451	
2452	        assert (
2453	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[3].id)
2454	            .extra(where=[UserMessage.where_unread()])
2455	            .count()
2456	            == 0
2457	        )
2458	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:2453:12
2452	        assert (
2453	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[3].id)
2454	            .extra(where=[UserMessage.where_unread()])
2455	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1362:12
1361	        for message in result["messages"]:
1362	            assert message["id"] in message_ids
1363	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1374:12
1373	        for message in result["messages"]:
1374	            assert message["id"] in message_ids
1375	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1705:12
1704	        def dr_emails(dr: DisplayRecipientT) -> str:
1705	            assert isinstance(dr, list)
1706	            return ",".join(sorted({*(r["email"] for r in dr), me.email}))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1709:12
1708	        def dr_ids(dr: DisplayRecipientT) -> List[int]:
1709	            assert isinstance(dr, list)
1710	            return sorted({*(r["id"] for r in dr), self.example_user("hamlet").id})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1905:8
1904	        stream_name = get_display_recipient(stream_messages[0].recipient)
1905	        assert isinstance(stream_name, str)
1906	        stream_id = get_stream(stream_name, stream_messages[0].get_realm()).id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:2544:16
2543	            for message in messages:
2544	                assert message["id"] in message_ids
2545	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:3293:8
3292	        stream = get_stream("Scotland", realm)
3293	        assert stream.recipient is not None
3294	        recipient_id = stream.recipient.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:37:4
36	    """
37	    assert "has_alert_word" not in expected
38	    flag_set = set(flags)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:377:12
376	            recipient = stream.recipient
377	            assert recipient is not None
378	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:470:12
469	        return list(
470	            UserMessage.objects.filter(
471	                user_profile=user_profile,
472	            )
473	            .extra(
474	                where=[UserMessage.where_active_push_notification()],
475	            )
476	            .order_by("message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:577:8
576	        recipient = stream.recipient
577	        assert recipient is not None
578	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:226:28
225	        # Bots without owner (except cross realm bot) cannot send to announcement only streams
226	        bot_without_owner = do_create_user(
227	            email="free-bot@zulip.testserver",
228	            password="",
229	            realm=non_admin_profile.realm,
230	            full_name="freebot",
231	            bot_type=UserProfile.DEFAULT_BOT,
232	            acting_user=None,
233	        )
234	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:308:28
307	        # Bots without owner (except cross realm bot) cannot send to STREAM_POST_POLICY_MODERATORS streams.
308	        bot_without_owner = do_create_user(
309	            email="free-bot@zulip.testserver",
310	            password="",
311	            realm=non_admin_profile.realm,
312	            full_name="freebot",
313	            bot_type=UserProfile.DEFAULT_BOT,
314	            acting_user=None,
315	        )
316	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:400:28
399	        # STREAM_POST_POLICY_RESTRICT_NEW_MEMBERS streams
400	        bot_without_owner = do_create_user(
401	            email="free-bot@zulip.testserver",
402	            password="",
403	            realm=non_admin_profile.realm,
404	            full_name="freebot",
405	            bot_type=UserProfile.DEFAULT_BOT,
406	            acting_user=None,
407	        )
408	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1288:8
1287	        # We subscribe the bot owner! (aka cordelia)
1288	        assert bot.bot_owner is not None
1289	        self.subscribe(bot.bot_owner, stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1659:8
1658	        message = most_recent_message(user_profile)
1659	        assert UserMessage.objects.get(
1660	            user_profile=user_profile, message=message
1661	        ).flags.mentioned.is_set
1662	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:1743:21
1742	
1743	        normal_bot = do_create_user(
1744	            email="normal-bot@zulip.com",
1745	            password="",
1746	            realm=realm,
1747	            full_name="Normal Bot",
1748	            bot_type=UserProfile.DEFAULT_BOT,
1749	            bot_owner=cordelia,
1750	            acting_user=None,
1751	        )
1752	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:2272:8
2271	        )
2272	        assert result is not None
2273	        message = result.message

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:2637:14
2636	        parent = self.example_user("othello")
2637	        bot = do_create_user(
2638	            email="othello-bot@zulip.com",
2639	            password="",
2640	            realm=parent.realm,
2641	            full_name="",
2642	            bot_type=UserProfile.DEFAULT_BOT,
2643	            bot_owner=parent,
2644	            acting_user=None,
2645	        )
2646	        bot.last_reminder = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:2675:8
2674	        # stream doesn't exist
2675	        assert sender.last_reminder is not None
2676	        sender.last_reminder = sender.last_reminder - datetime.timedelta(hours=1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_middleware.py:232:8
231	
232	        assert isinstance(open_graph_url, str)
233	        self.assertTrue(open_graph_url.endswith("/api/"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_mirror_users.py:101:8
100	
101	        assert mirror_sender is not None
102	        self.assertEqual(mirror_sender.email, sender_email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:28:8
27	
28	        assert recipient is not None
29	        add_topic_mute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:60:12
59	        def mute_topic_for_user(user: UserProfile) -> None:
60	            assert recipient is not None
61	            add_topic_mute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:148:8
147	
148	        assert recipient is not None
149	        for data in payloads:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_muting_topics.py:172:8
171	        recipient = stream.recipient
172	        assert recipient is not None
173	        add_topic_mute(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:83:8
82	        }
83	        assert expected_item in actual
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:393:16
392	                # The only content-type we use in our API is application/json.
393	                assert "schema" in element["content"]["application/json"]
394	                # If content_type is application/json, then the

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:441:16
440	                vname = defval.post_var_name
441	                assert vname is not None
442	                if vname in json_params:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:463:8
462	        # After the above operations `json_params` should be empty.
463	        assert len(json_params) == 0
464	        diff = openapi_params - function_params

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:590:24
589	                        print(" -", accepted_arguments)
590	                        assert url_pattern in self.buggy_documentation_endpoints
591	                    elif len(openapi_parameter_names - accepted_arguments) > 0:  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:597:24
596	                        print(" +", accepted_arguments)
597	                        assert url_pattern in self.buggy_documentation_endpoints
598	                    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:921:16
920	                # Check if every file has an operationId
921	                assert "operationId" in operation
922	                assert "tags" in operation

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:922:16
921	                assert "operationId" in operation
922	                assert "tags" in operation
923	                tag = operation["tags"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:924:16
923	                tag = operation["tags"][0]
924	                assert tag in VALID_TAGS
925	                for status_code, response in operation["responses"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:930:28
929	                            validate_schema(subschema)
930	                            assert validate_against_openapi_schema(
931	                                subschema["example"],
932	                                path,
933	                                method,
934	                                status_code + "_" + str(subschema_index),
935	                            )
936	                        continue

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:938:20
937	                    validate_schema(schema)
938	                    assert validate_against_openapi_schema(
939	                        schema["example"], path, method, status_code
940	                    )
941	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:951:8
950	        # some of the documented endpoints.
951	        assert find_openapi_endpoint("/users/me/presence") is None
952	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:952:8
951	        assert find_openapi_endpoint("/users/me/presence") is None
952	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None
953	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:953:8
952	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None
953	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None
954	        assert find_openapi_endpoint("/messages/matches_narrow") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:954:8
953	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None
954	        assert find_openapi_endpoint("/messages/matches_narrow") is None
955	        # Making sure documented endpoints are matched correctly.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:956:8
955	        # Making sure documented endpoints are matched correctly.
956	        assert (
957	            find_openapi_endpoint("/users/23/subscriptions/21")
958	            == "/users/{user_id}/subscriptions/{stream_id}"
959	        )
960	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:960:8
959	        )
960	        assert (
961	            find_openapi_endpoint("/users/iago@zulip.com/presence")
962	            == "/users/{user_id_or_email}/presence"
963	        )
964	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:964:8
963	        )
964	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"
965	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:965:8
964	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"
965	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"
966	        assert find_openapi_endpoint("/realm/emoji/realm_emoji_1") == "/realm/emoji/{emoji_name}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:966:8
965	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"
966	        assert find_openapi_endpoint("/realm/emoji/realm_emoji_1") == "/realm/emoji/{emoji_name}"
967	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:24:23
23	        service_class = get_service_interface_class("whatever")  # GenericOutgoingWebhookService
24	        self.handler = service_class(
25	            service_name="test-service", token="abcdef", user_profile=self.bot_user
26	        )
27	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:192:23
191	        service_class = get_service_interface_class(SLACK_INTERFACE)
192	        self.handler = service_class(
193	            token="abcdef", user_profile=self.bot_user, service_name="test-service"
194	        )
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:114:12
113	            final_response = do_rest_call("", mock_event, service_handler)
114	            assert final_response is not None
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:129:8
128	
129	        assert bot_user.bot_owner is not None
130	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:144:12
143	            final_response = do_rest_call("", mock_event, service_handler)
144	            assert final_response is not None
145	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:162:8
161	
162	        assert bot_user.bot_owner is not None
163	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:175:12
174	                final_response = do_rest_call("https://example.com/", mock_event, service_handler)
175	            assert final_response is not None
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:205:12
204	            self.assertIn("triggered", bot_owner_notification.content)
205	            assert bot_user.bot_owner is not None
206	            self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:248:8
247	        )
248	        assert bot_user.bot_owner is not None
249	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:277:8
276	            )
277	        assert bot_user.bot_owner is not None
278	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:304:8
303	            )
304	        assert bot_user.bot_owner is not None
305	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:333:8
332	            )
333	        assert bot_user.bot_owner is not None
334	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'weather_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:362:8
361	
362	        add_service(
363	            "weather",
364	            user_profile=bot,
365	            interface=Service.GENERIC,
366	            base_url="https://weather.example.com/",
367	            token="weather_token",
368	        )
369	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'qotd_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:370:8
369	
370	        add_service(
371	            "qotd",
372	            user_profile=bot,
373	            interface=Service.GENERIC,
374	            base_url="https://qotd.example.com/",
375	            token="qotd_token",
376	        )
377	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:112:8
111	    def request_callback(self, request: PreparedRequest) -> Tuple[int, ResponseHeaders, bytes]:
112	        assert isinstance(request.body, str) or request.body is None
113	        params: Dict[str, List[str]] = parse.parse_qs(request.body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:119:8
118	        data = {k: v[0] for k, v in params.items()}
119	        assert request.url is not None  # allow mypy to infer url is present.
120	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:120:8
119	        assert request.url is not None  # allow mypy to infer url is present.
120	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
121	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:130:8
129	        # Match any endpoint with the PUSH_NOTIFICATION_BOUNCER_URL.
130	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
131	        COMPILED_URL = re.compile(settings.PUSH_NOTIFICATION_BOUNCER_URL + ".*")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:137:16
136	        user_id = 10
137	        token = "111222"
138	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:147:16
146	    def test_unregister_remote_push_user_params(self) -> None:
147	        token = "111222"
148	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:182:16
181	    def test_register_remote_push_user_params(self) -> None:
182	        token = "111222"
183	        user_id = 11

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'aaaa'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:328:16
327	        server = RemoteZulipServer.objects.get(uuid=self.server_uuid)
328	        token = "aaaa"
329	        android_tokens = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:473:12
472	
473	            assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
474	            URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/register"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:571:8
570	        """
571	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
572	        ANALYTICS_URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/server/analytics"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:590:8
589	        audit_log = RealmAuditLog.objects.all().order_by("id").last()
590	        assert audit_log is not None
591	        audit_log_max_id = audit_log.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:783:8
782	        )
783	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
784	        ANALYTICS_URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/server/analytics"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:850:8
849	        remote_log_entry = RemoteRealmAuditLog.objects.order_by("id").last()
850	        assert remote_log_entry is not None
851	        self.assertEqual(str(remote_log_entry.server.uuid), self.server_uuid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:954:8
953	    def request_callback(self, request: PreparedRequest) -> Tuple[int, ResponseHeaders, bytes]:
954	        assert request.url is not None  # allow mypy to infer url is present.
955	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:955:8
954	        assert request.url is not None  # allow mypy to infer url is present.
955	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
956	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:957:8
956	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")
957	        assert isinstance(request.body, bytes)
958	        result = self.uuid_post(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1101:8
1100	        }
1101	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
1102	        URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/notify"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1544:16
1543	                apns_context = get_apns_context()
1544	                assert apns_context is not None
1545	                try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1547:20
1546	                    mock_load_cert_chain.assert_called_once_with("/foo.pem")
1547	                    assert apns_context.apns.pool.loop == apns_context.loop
1548	                finally:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2139:8
2138	    ) -> None:
2139	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
2140	        URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/register"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2222:16
2221	            ), responses.RequestsMock() as resp:
2222	                assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
2223	                URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/unregister"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2505:12
2504	        with mock_queue_publish("zerver.lib.actions.queue_json_publish") as mock_publish:
2505	            assert stream.recipient_id is not None
2506	            do_mark_stream_messages_as_read(hamlet, stream.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2580:8
2579	        ).last()
2580	        assert remote_realm_audit_log is not None
2581	        self.assertTrue(server.deactivated)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:40:12
39	        def collect(events: List[Dict[str, Any]]) -> None:
40	            assert isinstance(queue_client, SimpleQueueClient)
41	            assert len(events) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:41:12
40	            assert isinstance(queue_client, SimpleQueueClient)
41	            assert len(events) == 1
42	            output.append(events[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:60:12
59	        def collect(events: List[Dict[str, Any]]) -> None:
60	            assert isinstance(queue_client, SimpleQueueClient)
61	            assert len(events) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:61:12
60	            assert isinstance(queue_client, SimpleQueueClient)
61	            assert len(events) == 1
62	            queue_client.stop_consuming()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:84:8
83	        queue_client = get_queue_client()
84	        assert isinstance(queue_client, SimpleQueueClient)
85	        actual_publish = queue_client.publish

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:104:8
103	
104	        assert queue_client.channel
105	        method, header, message = queue_client.channel.basic_get("test_suite")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:106:8
105	        method, header, message = queue_client.channel.basic_get("test_suite")
106	        assert method is not None
107	        assert method.delivery_tag is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:107:8
106	        assert method is not None
107	        assert method.delivery_tag is not None
108	        assert message is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:108:8
107	        assert method.delivery_tag is not None
108	        assert message is not None
109	        queue_client.channel.basic_ack(method.delivery_tag)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:114:8
113	        method, header, message = queue_client.channel.basic_get("test_suite")
114	        assert message is None
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:119:8
118	        queue_client = get_queue_client()
119	        assert queue_client.channel
120	        queue_client.channel.queue_declare("test_suite", durable=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue_worker.py:193:8
192	        )
193	        assert (
194	            hamlet.email_notifications_batching_period_seconds
195	            == othello.email_notifications_batching_period_seconds
196	        )
197	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:295:8
294	        ).last()
295	        assert realm_audit_log is not None
296	        expected_extra_data = {"old_subdomain": "zulip", "new_subdomain": "newzulip"}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:372:8
371	        confirmation = Confirmation.objects.last()
372	        assert confirmation is not None
373	        self.assertEqual(confirmation.content_object, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:428:8
427	        realm = get_realm("zulip")
428	        assert realm.notifications_stream is not None
429	        self.assertEqual(realm.notifications_stream.id, new_notif_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:436:8
435	        realm = get_realm("zulip")
436	        assert realm.notifications_stream is not None
437	        self.assertNotEqual(realm.notifications_stream.id, invalid_notif_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:444:8
443	        notifications_stream = realm.get_notifications_stream()
444	        assert notifications_stream is not None
445	        self.assertEqual(notifications_stream.id, verona.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:472:8
471	        realm = get_realm("zulip")
472	        assert realm.signup_notifications_stream is not None
473	        self.assertEqual(realm.signup_notifications_stream.id, new_signup_notifications_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:484:8
483	        realm = get_realm("zulip")
484	        assert realm.signup_notifications_stream is not None
485	        self.assertNotEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:496:8
495	        signup_notifications_stream = realm.get_signup_notifications_stream()
496	        assert signup_notifications_stream is not None
497	        self.assertEqual(signup_notifications_stream, verona)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:668:8
667	        ).last()
668	        assert realm_audit_log is not None
669	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:690:8
689	        ).last()
690	        assert realm_audit_log is not None
691	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:794:8
793	
794	        assert realm.notifications_stream is not None
795	        self.assertEqual(realm.notifications_stream.name, "general")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:798:8
797	
798	        assert realm.signup_notifications_stream is not None
799	        self.assertEqual(realm.signup_notifications_stream.name, "core team")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:833:8
832	
833	        assert realm.notifications_stream is not None
834	        self.assertEqual(realm.notifications_stream.name, "general")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:837:8
836	
837	        assert realm.signup_notifications_stream is not None
838	        self.assertEqual(realm.signup_notifications_stream.name, "core team")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_emoji.py:79:8
78	        realm_emoji = RealmEmoji.objects.get(name="my_emoji")
79	        assert realm_emoji.author is not None
80	        self.assertEqual(realm_emoji.author.email, email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_emoji.py:111:8
110	        realm_emoji = RealmEmoji.objects.get(name="smile")
111	        assert realm_emoji is not None and realm_emoji.author is not None
112	        self.assertEqual(realm_emoji.author.email, email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_realm_emoji.py:352:25
351	        realm_1 = do_create_realm("test_realm", "test_realm")
352	        emoji_author_1 = do_create_user(
353	            "abc@example.com", password="abc", realm=realm_1, full_name="abc", acting_user=None
354	        )
355	        self.create_test_emoji("test_emoji", emoji_author_1)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_realm_emoji.py:365:23
364	        realm_1 = do_create_realm("test_realm", "test_realm")
365	        emoji_author = do_create_user(
366	            "abc@example.com", password="abc", realm=realm_1, full_name="abc", acting_user=None
367	        )
368	        emoji_name = "emoji_test"

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tests\test_realm_export.py:58:22
57	        self.assertEqual(args["public_only"], True)
58	        self.assertIn("/tmp/zulip-export-", args["output_dir"])
59	        self.assertEqual(args["threads"], 6)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:65:8
64	        ).first()
65	        assert audit_log_entry is not None
66	        self.assertEqual(audit_log_entry.acting_user_id, admin.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:70:8
69	        extra_data = audit_log_entry.extra_data
70	        assert extra_data is not None
71	        export_path = orjson.loads(extra_data)["export_path"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:72:8
71	        export_path = orjson.loads(extra_data)["export_path"]
72	        assert export_path.startswith("/")
73	        path_id = export_path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:103:8
102	        extra_data = audit_log_entry.extra_data
103	        assert extra_data is not None
104	        export_data = orjson.loads(extra_data)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zerver\tests\test_realm_export.py:128:22
127	        self.assertEqual(args["public_only"], True)
128	        self.assertIn("/tmp/zulip-export-", args["output_dir"])
129	        self.assertEqual(args["threads"], 6)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:135:8
134	        ).first()
135	        assert audit_log_entry is not None
136	        self.assertEqual(audit_log_entry.acting_user_id, admin.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:140:8
139	        extra_data = audit_log_entry.extra_data
140	        assert extra_data is not None
141	        export_path = orjson.loads(extra_data).get("export_path")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:170:8
169	        extra_data = audit_log_entry.extra_data
170	        assert extra_data is not None
171	        export_data = orjson.loads(extra_data)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_report.py:1:0
1	import subprocess
2	from typing import Callable, ContextManager, Dict, List, Tuple
3	from unittest import mock

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:149:8
148	        )
149	        assert msg_id is not None
150	        return msg_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:606:8
605	        archive_transaction = ArchiveTransaction.objects.last()
606	        assert archive_transaction is not None
607	        self.assertEqual(archive_transaction.realm, realm)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:26:23
25	    def _get_outgoing_bot(self) -> UserProfile:
26	        outgoing_bot = do_create_user(
27	            email="bar-bot@zulip.com",
28	            password="test",
29	            realm=get_realm("zulip"),
30	            full_name="BarBot",
31	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
32	            bot_owner=self.example_user("cordelia"),
33	            acting_user=None,
34	        )
35	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:40:8
39	        sender = self.example_user("hamlet")
40	        assert not sender.is_bot
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:43:8
42	        outgoing_bot = self._get_outgoing_bot()
43	        assert outgoing_bot.bot_type is not None
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:65:8
64	        sender = self.example_user("hamlet")
65	        assert not sender.is_bot
66	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:68:8
67	        outgoing_bot = self._get_outgoing_bot()
68	        assert outgoing_bot.bot_type is not None
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:89:8
88	        sender = self.example_user("hamlet")
89	        assert not sender.is_bot
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:92:8
91	        outgoing_bot = self._get_outgoing_bot()
92	        assert outgoing_bot.bot_type is not None
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:124:8
123	        sender = self.example_user("hamlet")
124	        assert not sender.is_bot
125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:127:8
126	        outgoing_bot = self._get_outgoing_bot()
127	        assert outgoing_bot.bot_type is not None
128	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:175:27
174	        self.user_profile = self.example_user("othello")
175	        self.bot_profile = do_create_user(
176	            email="embedded-bot-1@zulip.com",
177	            password="test",
178	            realm=get_realm("zulip"),
179	            full_name="EmbeddedBo1",
180	            bot_type=UserProfile.EMBEDDED_BOT,
181	            bot_owner=self.user_profile,
182	            acting_user=None,
183	        )
184	        self.second_bot_profile = do_create_user(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:184:34
183	        )
184	        self.second_bot_profile = do_create_user(
185	            email="embedded-bot-2@zulip.com",
186	            password="test",
187	            realm=get_realm("zulip"),
188	            full_name="EmbeddedBot2",
189	            bot_type=UserProfile.EMBEDDED_BOT,
190	            bot_owner=self.user_profile,
191	            acting_user=None,
192	        )
193	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:421:8
420	    def _wrapped(*args: object, **kwargs: object) -> None:
421	        assert len(args) > 0
422	        self = cast(TestServiceBotEventTriggers, args[0])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:435:27
434	        self.user_profile = self.example_user("othello")
435	        self.bot_profile = do_create_user(
436	            email="foo-bot@zulip.com",
437	            password="test",
438	            realm=get_realm("zulip"),
439	            full_name="FooBot",
440	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
441	            bot_owner=self.user_profile,
442	            acting_user=None,
443	        )
444	        self.second_bot_profile = do_create_user(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:444:34
443	        )
444	        self.second_bot_profile = do_create_user(
445	            email="bar-bot@zulip.com",
446	            password="test",
447	            realm=get_realm("zulip"),
448	            full_name="BarBot",
449	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
450	            bot_owner=self.user_profile,
451	            acting_user=None,
452	        )
453	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:467:12
466	        ) -> None:
467	            assert self.bot_profile.bot_type
468	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:510:12
509	        ) -> None:
510	            assert self.bot_profile.bot_type
511	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:552:12
551	        ) -> None:
552	            assert self.bot_profile.bot_type
553	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:51:12
50	            "/json/settings",
51	            dict(
52	                full_name="Foo Bar",
53	                old_password=initial_password(user.delivery_email),
54	                new_password="foobar1",
55	            ),
56	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:69:12
68	        self.assertTrue(
69	            self.client.login(
70	                request=request,
71	                username=user.delivery_email,
72	                password="foobar1",
73	                realm=user.realm,
74	            ),
75	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'easy'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:83:16
82	                "/json/settings",
83	                dict(
84	                    full_name="Foo Bar",
85	                    old_password=initial_password(self.example_email("hamlet")),
86	                    new_password="easy",
87	                ),
88	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'f657gdGGk9'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:93:16
92	                "/json/settings",
93	                dict(
94	                    full_name="Foo Bar",
95	                    old_password=initial_password(self.example_email("hamlet")),
96	                    new_password="f657gdGGk9",
97	                ),
98	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:230:12
229	            "/json/settings",
230	            dict(
231	                old_password="bad_password",
232	                new_password="ignored",
233	            ),
234	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:245:20
244	                    "/json/settings",
245	                    dict(
246	                        old_password="bad_password",
247	                        new_password="ignored",
248	                    ),
249	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:253:20
252	                    "/json/settings",
253	                    dict(
254	                        old_password="bad_password",
255	                        new_password="ignored",
256	                    ),
257	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:263:20
262	                    "/json/settings",
263	                    dict(
264	                        old_password=initial_password(self.example_email("hamlet")),
265	                        new_password="ignored",
266	                    ),
267	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:276:20
275	                    "/json/settings",
276	                    dict(
277	                        old_password=initial_password(self.example_email("hamlet")),
278	                        new_password="foobar1",
279	                    ),
280	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:303:16
302	                "/json/settings",
303	                dict(
304	                    old_password=initial_password(self.example_email("hamlet")),
305	                    new_password="ignored",
306	                ),
307	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:312:16
311	                "/json/settings",
312	                dict(
313	                    old_password=self.ldap_password("hamlet"),  # hamlet's password in LDAP
314	                    new_password="ignored",
315	                ),
316	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:324:16
323	                "/json/settings",
324	                dict(
325	                    old_password=initial_password(self.example_email("hamlet")),
326	                    new_password="ignored",
327	                ),
328	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:340:16
339	                "/json/settings",
340	                dict(
341	                    old_password=initial_password(self.example_email("hamlet")),
342	                    new_password="ignored",
343	                ),
344	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:374:8
373	        old_password = initial_password(email)
374	        assert old_password is not None
375	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'f657gdGGk9'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:424:12
423	            # log back in with new password
424	            self.login_by_email(email, password="f657gdGGk9")
425	            user_profile = self.example_user("hamlet")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:774:12
773	        with patch("time.time", return_value=start_time):
774	            self.login_with_return(email, password="wrongpassword")
775	            self.assert_logged_in_user_id(None)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:776:12
775	            self.assert_logged_in_user_id(None)
776	            self.login_with_return(email, password="wrongpassword")
777	            self.assert_logged_in_user_id(None)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:793:19
792	        user_profile = self.example_user("hamlet")
793	        password = "a_password_of_22_chars"
794	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hümbüǵ'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:960:19
959	        email = self.nonreg_email("test")
960	        password = "hümbüǵ"
961	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:1286:8
1285	        prereg_user = PreregistrationUser.objects.get(email=mirror_user.email)
1286	        assert prereg_user.referred_by is not None and inviter is not None
1287	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:1943:8
1942	        prereg_user = obj.content_object
1943	        assert prereg_user is not None
1944	        prereg_user.email = "invalid.email"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2112:8
2111	        confirmation = Confirmation.objects.last()
2112	        assert confirmation is not None
2113	        self.assertEqual(confirmation.expiry_date, None)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2192:19
2191	        email = self.nonreg_email("alice")
2192	        password = "password"
2193	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2220:19
2219	        email = self.nonreg_email("alice")
2220	        password = "password"
2221	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2737:8
2736	        inviter = UserProfile.objects.exclude(realm=get_realm("zulip")).first()
2737	        assert inviter is not None
2738	        prereg_user = PreregistrationUser.objects.create(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2749:19
2748	        email = self.nonreg_email("alice")
2749	        password = "password"
2750	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2766:8
2765	        confirmation = Confirmation.objects.get(confirmation_key=registration_key)
2766	        assert confirmation.content_object is not None
2767	        prereg_user = confirmation.content_object

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2834:19
2833	    def check_user_able_to_register(self, email: str, invite_link: str) -> None:
2834	        password = "password"
2835	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\zerver\tests\test_signup.py:3167:4
3166	    @override_settings(OPEN_REALM_CREATION=True)
3167	    def check_able_to_create_realm(self, email: str, password: str = "test") -> None:
3168	        internal_realm = get_realm(settings.SYSTEM_BOT_REALM)
3169	        notification_bot = get_system_bot(settings.NOTIFICATION_BOT, internal_realm.id)
3170	        signups_stream, _ = create_stream_if_needed(notification_bot.realm, "signups")
3171	
3172	        string_id = "zuliptest"
3173	        # Make sure the realm does not exist
3174	        with self.assertRaises(Realm.DoesNotExist):
3175	            get_realm(string_id)
3176	
3177	        # Create new realm with the email
3178	        result = self.client_post("/new/", {"email": email})
3179	        self.assertEqual(result.status_code, 302)
3180	        self.assertTrue(result["Location"].endswith(f"/accounts/new/send_confirm/{email}"))
3181	        result = self.client_get(result["Location"])
3182	        self.assert_in_response("Check your email so we can get started.", result)
3183	
3184	        # Check confirmation email has the correct subject and body, extract
3185	        # confirmation link and visit it
3186	        confirmation_url = self.get_confirmation_url_from_outbox(
3187	            email,
3188	            email_subject_contains="Create your Zulip organization",
3189	            email_body_contains="You have requested a new Zulip organization",
3190	        )
3191	        result = self.client_get(confirmation_url)
3192	        self.assertEqual(result.status_code, 200)
3193	
3194	        result = self.submit_reg_form_for_user(email, password, realm_subdomain=string_id)
3195	        self.assertEqual(result.status_code, 302)
3196	        self.assertTrue(
3197	            result["Location"].startswith("http://zuliptest.testserver/accounts/login/subdomain/")
3198	        )
3199	
3200	        # Make sure the realm is created
3201	        realm = get_realm(string_id)
3202	        self.assertEqual(realm.string_id, string_id)
3203	        user = get_user(email, realm)
3204	        self.assertEqual(user.realm, realm)
3205	
3206	        # Check that user is the owner.
3207	        self.assertEqual(user.role, UserProfile.ROLE_REALM_OWNER)
3208	
3209	        # Check defaults
3210	        self.assertEqual(realm.org_type, Realm.ORG_TYPES["business"]["id"])
3211	        self.assertEqual(realm.emails_restricted_to_domains, False)
3212	        self.assertEqual(realm.invite_required, True)
3213	
3214	        # Check welcome messages
3215	        for stream_name, text, message_count in [
3216	            (Realm.DEFAULT_NOTIFICATION_STREAM_NAME, "with the topic", 3),
3217	            (Realm.INITIAL_PRIVATE_STREAM_NAME, "private stream", 1),
3218	        ]:
3219	            stream = get_stream(stream_name, realm)
3220	            recipient = stream.recipient
3221	            messages = Message.objects.filter(recipient=recipient).order_by("date_sent")
3222	            self.assert_length(messages, message_count)
3223	            self.assertIn(text, messages[0].content)
3224	
3225	        # Check signup messages
3226	        recipient = signups_stream.recipient
3227	        messages = Message.objects.filter(recipient=recipient).order_by("id")
3228	        self.assert_length(messages, 2)
3229	        self.assertIn("Signups enabled", messages[0].content)
3230	        self.assertIn("signed up", messages[1].content)
3231	        self.assertEqual("zuliptest", messages[1].topic_name())
3232	
3233	        realm_creation_audit_log = RealmAuditLog.objects.get(
3234	            realm=realm, event_type=RealmAuditLog.REALM_CREATED
3235	        )
3236	        self.assertEqual(realm_creation_audit_log.acting_user, user)
3237	        self.assertEqual(realm_creation_audit_log.event_time, realm.date_created)
3238	
3239	        # Piggyback a little check for how we handle
3240	        # empty string_ids.
3241	        realm.string_id = ""
3242	        self.assertEqual(realm.display_subdomain, ".")
3243	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3279:19
3278	    def test_create_realm_with_subdomain(self) -> None:
3279	        password = "test"
3280	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3319:19
3318	    def test_create_realm_with_marketing_emails_enabled(self) -> None:
3319	        password = "test"
3320	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3362:19
3361	    def test_create_realm_without_prompting_for_marketing_emails(self) -> None:
3362	        password = "test"
3363	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3416:19
3415	    def test_create_realm_with_marketing_emails_disabled(self) -> None:
3416	        password = "test"
3417	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3459:19
3458	    def test_create_regular_realm_welcome_bot_pm(self) -> None:
3459	        password = "test"
3460	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3494:19
3493	    def test_create_demo_realm_welcome_bot_pm(self) -> None:
3494	        password = "test"
3495	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3530:19
3529	    def test_create_realm_during_free_trial(self) -> None:
3530	        password = "test"
3531	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3572:19
3571	        """
3572	        password = "test"
3573	        first_string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3650:19
3649	    def test_subdomain_restrictions(self) -> None:
3650	        password = "test"
3651	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3688:19
3687	
3688	        password = "test"
3689	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3703:19
3702	    def test_subdomain_restrictions_root_domain(self) -> None:
3703	        password = "test"
3704	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3728:19
3727	    def test_subdomain_restrictions_root_domain_option(self) -> None:
3728	        password = "test"
3729	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3913:19
3912	        email = self.nonreg_email("newguy")
3913	        password = "newpassword"
3914	        timezone = "America/Denver"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3946:19
3945	        email = self.nonreg_email("newguy")
3946	        password = "newpassword"
3947	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4022:8
4021	
4022	        assert isinstance(user_profile, UserProfile)
4023	        # User should now be logged in.

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4032:19
4031	        email = "newguy@zulip.com"
4032	        password = "newpassword"
4033	        result = self.verify_signup(email=email, password=password, full_name="")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4058:19
4057	        email = "newguy@zulip.com"
4058	        password = "newpassword"
4059	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4124:19
4123	        email = self.nonreg_email("newguy")
4124	        password = "newpassword"
4125	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4158:19
4157	        email = self.nonreg_email("newguy")
4158	        password = "newpassword"
4159	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4208:19
4207	        email = self.nonreg_email("newguy")
4208	        password = "newpassword"
4209	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4248:19
4247	        email = hamlet_in_zulip.delivery_email
4248	        password = "newpassword"
4249	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4284:19
4283	        email = hamlet_in_zulip.delivery_email
4284	        password = "newpassword"
4285	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4359:19
4358	        email = "newuser@zulip.com"
4359	        password = "newpassword"
4360	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4400:19
4399	
4400	        password = "test"
4401	        email = self.example_email("iago")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4462:12
4461	            last_message = Message.objects.last()
4462	            assert last_message is not None
4463	            self.assertIn(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4563:16
4562	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
4563	                assert match is not None
4564	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:4646:16
4645	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
4646	                assert match is not None
4647	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:4652:13
4651	
4652	        with self.settings(
4653	            POPULATE_PROFILE_VIA_LDAP=True,
4654	            LDAP_APPEND_DOMAIN="zulip.com",
4655	            AUTH_LDAP_BIND_PASSWORD="",
4656	            AUTH_LDAP_USER_ATTR_MAP=ldap_user_attr_map,
4657	            AUTH_LDAP_USER_DN_TEMPLATE="uid=%(user)s,ou=users,dc=zulip,dc=com",
4658	        ):
4659	            result = self.client_get(confirmation_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:4965:19
4964	    def test_signup_with_ldap_and_email_enabled_using_email_with_ldap_append_domain(self) -> None:
4965	        password = "nonldappassword"
4966	        email = "newuser@zulip.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:5087:19
5086	        # have a wrong password, then we refuse to create an account
5087	        password = "nonldappassword"
5088	        email = "newuser_email@zulip.com"  # belongs to user uid=newuser_with_email in the test directory

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:5131:19
5130	        # database.
5131	        password = "nonldappassword"
5132	        email = "nonexistent@zulip.com"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5328:16
5327	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
5328	                assert match is not None
5329	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5347:12
5346	            prereg_user = confirmation.content_object
5347	            assert prereg_user is not None
5348	            prereg_user.realm_creation = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:5369:19
5368	    def test_registration_of_mirror_dummy_user(self, ignored: Any) -> None:
5369	        password = "test"
5370	        subdomain = "zephyr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5389:16
5388	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
5389	                assert match is not None
5390	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5480:8
5479	        user_profile = UserProfile.objects.all().order_by("id").last()
5480	        assert user_profile is not None
5481	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5502:8
5501	        user_profile = UserProfile.objects.all().order_by("id").last()
5502	        assert user_profile is not None
5503	        self.assert_logged_in_user_id(user_profile.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5521:8
5520	        user_profile = UserProfile.objects.all().order_by("id").last()
5521	        assert user_profile is not None
5522	        self.assert_logged_in_user_id(user_profile.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:5541:8
5540	        password = initial_password(email)
5541	        assert password is not None
5542	        self.assert_login_failure(email, password=password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:115:16
114	    def test_get_slack_api_data(self) -> None:
115	        token = "xoxp-valid-token"
116	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-invalid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:152:16
151	
152	        token = "xoxp-invalid-token"
153	        with self.assertRaises(Exception) as invalid:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-status404'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:161:16
160	
161	        token = "xoxp-status404"
162	        wrong_url = "https://slack.com/api/wrong"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:1090:16
1089	        output_dir = os.path.join(settings.DEPLOY_ROOT, "var", "test-slack-importer-data")
1090	        token = "xoxp-valid-token"
1091	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:483:8
482	        ).last()
483	        assert history_public_to_subscribers_log is not None
484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:498:8
497	        ).order_by("-id")[1]
498	        assert invite_only_log is not None
499	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:546:8
545	        ).last()
546	        assert history_public_to_subscribers_log is not None
547	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:561:8
560	        ).order_by("-id")[1]
561	        assert invite_only_log is not None
562	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:602:8
601	        ).last()
602	        assert history_public_to_subscribers_log is not None
603	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:617:8
616	        ).order_by("-id")[1]
617	        assert invite_only_log is not None
618	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:674:8
673	        ).last()
674	        assert history_public_to_subscribers_log is not None
675	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:689:8
688	        ).order_by("-id")[1]
689	        assert invite_only_log is not None
690	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:777:8
776	        ).last()
777	        assert realm_audit_log is not None
778	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:818:8
817	        ).last()
818	        assert realm_audit_log is not None
819	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:859:8
858	        ).last()
859	        assert realm_audit_log is not None
860	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:944:8
943	        ).last()
944	        assert realm_audit_log is not None
945	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1516:8
1515	        ).last()
1516	        assert realm_audit_log is not None
1517	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1578:8
1577	        ).last()
1578	        assert realm_audit_log is not None
1579	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1634:8
1633	        ).last()
1634	        assert realm_audit_log is not None
1635	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1710:12
1709	            ).last()
1710	            assert realm_audit_log is not None
1711	            expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1746:12
1745	            ).last()
1746	            assert realm_audit_log is not None
1747	            expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1780:8
1779	        ).last()
1780	        assert realm_audit_log is not None
1781	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1803:8
1802	        ).last()
1803	        assert realm_audit_log is not None
1804	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1827:8
1826	        ).last()
1827	        assert realm_audit_log is not None
1828	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:2911:8
2910	
2911	        assert found_sub is not None
2912	        self.assertEqual(found_sub["color"], new_color)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_subs.py:3547:41
3546	        for stream in existing_stream_names:
3547	            random_stream = stream + str(random.randint(0, 9))
3548	            if random_stream not in all_stream_names:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5105:8
5104	        test_bot = self.create_test_bot("foo", hamlet)
5105	        assert test_bot is not None
5106	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5917:8
5916	        self.assertEqual(stream.id, stream_ret.id)
5917	        assert sub_ret is not None
5918	        self.assertEqual(sub_ret.recipient.type_id, stream.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5976:8
5975	        (stream_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
5976	        assert sub_ret is not None
5977	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5989:8
5988	        (stream_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
5989	        assert sub_ret is not None
5990	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5998:8
5997	        self.assertTrue(can_access_stream_history(guest_user_profile, stream))
5998	        assert sub_ret is None
5999	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:30:8
29	        missing = set(dict(reversed(ambiguous_abbrevs)).items()) - set(common_timezones.items())
30	        assert not missing, missing
31	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:42:16
41	                delta = tz.utcoffset(date)
42	                assert delta is not None
43	                offset = delta.total_seconds()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:44:16
43	                offset = delta.total_seconds()
44	                assert (
45	                    common_timezones[abbrev] == offset or (abbrev, offset) in ambiguous_abbrevs
46	                ), (name, abbrev, offset)
47	                extra.discard((abbrev, offset))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:48:8
47	                extra.discard((abbrev, offset))
48	        assert not extra, extra

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_transfer.py:132:8
131	        resized_key = bucket.Object(emoji_path)
132	        assert emoji.file_name
133	        still_key = bucket.Object(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:80:4
79	def destroy_uploads() -> None:
80	    assert settings.LOCAL_UPLOADS_DIR is not None
81	    if os.path.exists(settings.LOCAL_UPLOADS_DIR):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:517:12
516	            result = self.client_post("/json/user_uploads", {"f1": fp})
517	            assert sanitize_name(expected) in result.json()["uri"]
518	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:540:8
539	        quota = realm.upload_quota_bytes()
540	        assert quota is not None
541	        d1_attachment.size = quota - 11

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:831:16
830	                _get_sendfile.cache_clear()
831	                assert settings.LOCAL_UPLOADS_DIR is not None
832	                test_run, worker = os.path.split(os.path.dirname(settings.LOCAL_UPLOADS_DIR))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1152:20
1151	                    response = self.client_get(url)
1152	                    assert isinstance(response, StreamingHttpResponse)
1153	                    data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1297:8
1296	        self.assertTrue(is_animated)
1297	        assert still_img_data is not None
1298	        still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1316:16
1315	                self.assertTrue(is_animated)
1316	                assert still_img_data
1317	                still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1338:8
1337	        self.assertFalse(is_animated)
1338	        assert no_still_data is None
1339	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1346:8
1345	        self.assertFalse(is_animated)
1346	        assert no_still_data is None
1347	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1430:20
1429	                    response = self.client_get(url)
1430	                    assert isinstance(response, StreamingHttpResponse)
1431	                    data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1603:20
1602	                    response = self.client_get(logo_url)
1603	                    assert isinstance(response, StreamingHttpResponse)
1604	                    data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1756:8
1755	
1756	        assert settings.LOCAL_UPLOADS_DIR is not None
1757	        file_path = os.path.join(settings.LOCAL_UPLOADS_DIR, "avatars", emoji_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1934:8
1933	        path = urllib.parse.urlparse(redirect_url).path
1934	        assert path.startswith("/")
1935	        key = path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1945:8
1944	        path = urllib.parse.urlparse(url_only_url).path
1945	        assert path.startswith("/")
1946	        key = path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_user_groups.py:40:8
39	        user_group = UserGroup.objects.first()
40	        assert user_group is not None
41	        membership = UserGroupMembership.objects.filter(user_group=user_group)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:508:8
507	
508	        assert role == UserProfile.ROLE_GUEST
509	        return (

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:814:27
813	                with self.tornado_redirected_to_list(events, expected_num_events=10):
814	                    fred = do_create_user(
815	                        email="fred@zulip.com",
816	                        password="password",
817	                        realm=realm,
818	                        full_name="Fred Flintstone",
819	                        prereg_user=prereg_user,
820	                        acting_user=None,
821	                    )
822	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:893:23
892	        do_change_user_role(admin, UserProfile.ROLE_REALM_ADMINISTRATOR, acting_user=None)
893	        valid_params = dict(
894	            email="romeo@zulip.net",
895	            password="xxxx",
896	            full_name="Romeo Montague",
897	        )
898	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:924:12
923	            "/json/users",
924	            dict(
925	                email="romeo@not-zulip.com",
926	                password="xxxx",
927	            ),
928	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:934:12
933	            "/json/users",
934	            dict(
935	                email="romeo@zulip.com",
936	                password="xxxx",
937	                full_name="Romeo Montague",
938	                short_name="DEPRECATED",
939	            ),
940	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:945:12
944	            "/json/users",
945	            dict(
946	                email="broken",
947	                password="xxxx",
948	                full_name="Romeo Montague",
949	            ),
950	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:956:12
955	            "/json/users",
956	            dict(
957	                email="romeo@not-zulip.com",
958	                password="xxxx",
959	                full_name="Romeo Montague",
960	            ),
961	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1162:8
1161	        iago = get_source_profile("iago@zulip.com", zulip_realm_id)
1162	        assert iago is not None
1163	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1167:8
1166	        iago = get_source_profile("IAGO@ZULIP.com", zulip_realm_id)
1167	        assert iago is not None
1168	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1172:8
1171	        cordelia = get_source_profile("cordelia@zulip.com", lear_realm_id)
1172	        assert cordelia is not None
1173	        self.assertEqual(cordelia.email, "cordelia@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1598:8
1597	        email = ScheduledEmail.objects.all().first()
1598	        assert email is not None and email.users is not None
1599	        self.assertEqual(email.users.count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1653:8
1652	        email = ScheduledEmail.objects.all().first()
1653	        assert email is not None
1654	        email.users.remove(*to_user_ids)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1696:8
1695	        recipient = stream.recipient
1696	        assert recipient is not None
1697	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1867:22
1866	        # Add a service bot.
1867	        service_bot = do_create_user(
1868	            email="service-bot@zulip.com",
1869	            password="",
1870	            realm=realm,
1871	            full_name="",
1872	            bot_type=UserProfile.EMBEDDED_BOT,
1873	            acting_user=None,
1874	        )
1875	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1891:21
1890	        # Add a normal bot.
1891	        normal_bot = do_create_user(
1892	            email="normal-bot@zulip.com",
1893	            password="",
1894	            realm=realm,
1895	            full_name="",
1896	            bot_type=UserProfile.DEFAULT_BOT,
1897	            acting_user=None,
1898	        )
1899	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_zephyr.py:1:0
1	import subprocess
2	from typing import Any
3	from unittest.mock import patch

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tornado\autoreload.py:58:0
57	import os
58	import subprocess
59	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tornado\autoreload.py:219:8
218	    if not _has_execv:
219	        subprocess.Popen([sys.executable] + sys.argv)
220	        sys.exit(0)

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\zerver\tornado\autoreload.py:223:12
222	        try:
223	            os.execv(sys.executable, [sys.executable] + sys.argv)
224	        except OSError:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\zerver\tornado\autoreload.py:236:12
235	            # this error specifically.
236	            os.spawnv(os.P_NOWAIT, sys.executable, [sys.executable] + sys.argv)
237	            # At this point the IOLoop has been closed and finally

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tornado\event_queue.py:254:45
253	        ioloop = tornado.ioloop.IOLoop.instance()
254	        interval = HEARTBEAT_MIN_FREQ_SECS + random.randint(0, 10)
255	        if self.client_type_name != "API: heartbeat test":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:430:4
429	def clear_client_event_queues_for_testing() -> None:
430	    assert settings.TEST_SUITE
431	    clients.clear()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:656:16
655	            if dont_block:
656	                assert new_queue_data is not None
657	                client = allocate_client_descriptor(new_queue_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:60:8
59	        log_data = RequestNotes.get_notes(request).log_data
60	        assert log_data is not None
61	        if len(contents) != 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:175:16
174	
175	                assert isinstance(response, HttpResponse)
176	                self.write_django_response_as_tornado_response(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:265:12
264	            patch_vary_headers(response, ("Cookie",))
265	            assert isinstance(response, HttpResponse)
266	            self.write_django_response_as_tornado_response(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:40:4
39	    log_data = RequestNotes.get_notes(request).log_data
40	    assert log_data is not None
41	    log_data["extra"] = f"[{queue_id}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:115:4
114	    tornado_handler = RequestNotes.get_notes(request).tornado_handler
115	    assert tornado_handler is not None
116	    handler = tornado_handler()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:117:4
116	    handler = tornado_handler()
117	    assert handler is not None
118	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:121:8
120	        valid_user_client = RequestNotes.get_notes(request).client
121	        assert valid_user_client is not None
122	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:159:8
158	        log_data = RequestNotes.get_notes(request).log_data
159	        assert log_data is not None
160	        log_data["extra"] = result["extra_log_data"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:123:4
122	) -> PreregistrationUser:
123	    assert not (realm_creation and realm is not None)
124	    assert not (realm is None and not realm_creation)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:124:4
123	    assert not (realm_creation and realm is not None)
124	    assert not (realm is None and not realm_creation)
125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:171:4
170	    # devices, e.g. just creating an account on the web on their laptop.
171	    assert not (mobile_flow_otp and desktop_flow_otp)
172	    if mobile_flow_otp:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:197:8
196	
197	        assert multiuse_obj is not None
198	        if realm != multiuse_obj.realm:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'zerver.views.auth.log_into_subdomain'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\auth.py:621:24
620	
621	_subdomain_token_salt = "zerver.views.auth.log_into_subdomain"
622	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:800:8
799	    except ZulipLDAPConfigurationError as e:
800	        assert len(e.args) > 1
801	        return redirect_to_misconfigured_ldap_notice(request, e.args[1])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:811:4
810	
811	    assert isinstance(template_response, HttpResponse)
812	    return template_response

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:888:4
887	
888	    assert user_profile.is_authenticated
889	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1005:8
1004	    except RateLimited as e:
1005	        assert e.secs_to_freedom is not None
1006	        return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1012:4
1011	        )
1012	    assert isinstance(response, HttpResponse)
1013	    return response

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\custom_profile_fields.py:117:12
116	            field_subtype = field_data["subtype"]
117	            assert isinstance(field_subtype, str)
118	            field = try_add_realm_default_custom_profile_field(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\dev_login.py:134:4
133	        raise AuthenticationFailedError()
134	    assert user_profile is not None
135	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\development\email_log.py:2:0
1	import os
2	import subprocess
3	import urllib

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\development\email_log.py:56:8
55	        # because by role, the tests shouldn't be doing a provision-like thing.
56	        subprocess.check_call(["./scripts/setup/inline_email_css.py"])
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:79:4
78	    result = client.post("/accounts/password/reset/", {"email": registered_email}, **host_kwargs)
79	    assert result.status_code == 302
80	    # deactivated user

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:83:4
82	    result = client.post("/accounts/password/reset/", {"email": registered_email}, **host_kwargs)
83	    assert result.status_code == 302
84	    change_user_is_active(user, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:86:4
85	    # account on different realm
86	    assert other_realm is not None
87	    result = client.post(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:90:4
89	    )
90	    assert result.status_code == 302
91	    # no account anywhere

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:95:4
94	    )
95	    assert result.status_code == 302
96	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:99:4
98	    result = client.post("/accounts/home/", {"email": unregistered_email_1}, **host_kwargs)
99	    assert result.status_code == 302
100	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:103:4
102	    result = client.post("/accounts/find/", {"emails": registered_email}, **host_kwargs)
103	    assert result.status_code == 302
104	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:107:4
106	    logged_in = client.login(dev_auth_username=registered_email, realm=realm)
107	    assert logged_in
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:120:4
119	    )
120	    assert result.status_code == 200
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:126:4
125	    )
126	    assert result.status_code == 200
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:133:4
132	    result = client.get(url)
133	    assert result.status_code == 200
134	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:51:4
50	    # Need to add test data to POST request as it doesn't originally contain the required parameters
51	    modify_postdata(request, key=key, full_name=name, password="test", terms="true")
52	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:67:4
66	    # Need to add test data to POST request as it doesn't originally contain the required parameters
67	    modify_postdata(
68	        request,
69	        key=key,
70	        realm_name=realm_name,
71	        realm_type=realm_type,
72	        full_name=name,
73	        password="test",
74	        realm_subdomain=realm_name,
75	        terms="true",
76	    )
77	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:92:4
91	    # Need to add test data to POST request as it doesn't originally contain the required parameters
92	    modify_postdata(
93	        request,
94	        key=key,
95	        realm_name=realm_name,
96	        realm_type=realm_type,
97	        full_name=name,
98	        password="test",
99	        realm_subdomain=realm_name,
100	        terms="true",
101	        is_demo_organization="true",
102	    )
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\digest.py:16:4
15	    user_profile = request.user
16	    assert user_profile.is_authenticated
17	    cutoff = time.mktime((timezone_now() - timedelta(days=DIGEST_CUTOFF)).timetuple())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:195:16
194	                )
195	                assert endpoint_name is not None
196	                assert endpoint_method is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:196:16
195	                assert endpoint_name is not None
196	                assert endpoint_method is not None
197	                article_title = get_openapi_summary(endpoint_name, endpoint_method)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\documentation.py:211:66
210	            request_notes.placeholder_open_graph_description = (
211	                f"REPLACEMENT_OPEN_GRAPH_DESCRIPTION_{int(2**24 * random.random())}"
212	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\events_register.py:84:4
83	    client = RequestNotes.get_notes(request).client
84	    assert client is not None
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:37:4
36	def accounts_accept_terms(request: HttpRequest) -> HttpResponse:
37	    assert request.user.is_authenticated
38	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:185:8
184	        # See the assert in `home` above for why this must be true.
185	        assert request.session.get("prefers_web_public_view")
186	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:233:4
232	    log_data = RequestNotes.get_notes(request).log_data
233	    assert log_data is not None
234	    log_data["extra"] = f"[{queue_id}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:41:8
40	    if len(raw_edit_history) > 0:
41	        assert message.last_edit_time is not None
42	        assert datetime_to_timestamp(message.last_edit_time) == raw_edit_history[0]["timestamp"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:42:8
41	        assert message.last_edit_time is not None
42	        assert datetime_to_timestamp(message.last_edit_time) == raw_edit_history[0]["timestamp"]
43	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:64:12
63	            prev_rendered_content = formatted_entry["prev_rendered_content"]
64	            assert prev_rendered_content is not None
65	            rendered_content = formatted_entry["rendered_content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:66:12
65	            rendered_content = formatted_entry["rendered_content"]
66	            assert rendered_content is not None
67	            formatted_entry["content_html_diff"] = highlight_html_differences(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:141:4
140	    log_data = RequestNotes.get_notes(request).log_data
141	    assert log_data is not None
142	    log_data["extra"] = f"[{number_changed}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:203:8
202	        # This operator does not support is_web_public_query.
203	        assert not self.is_web_public_query
204	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:204:8
203	        assert not self.is_web_public_query
204	        assert self.user_profile is not None
205	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:216:8
215	        # This operator class does not support is_web_public_query.
216	        assert not self.is_web_public_query
217	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:217:8
216	        assert not self.is_web_public_query
217	        assert self.user_profile is not None
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:285:12
284	            # a Zephyr realm are private, so that doesn't happen.
285	            assert not stream.is_public()
286	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:290:12
289	            # stream name, this will always match
290	            assert m is not None
291	            base_stream_name = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:324:12
323	            # Since the regex has a `.*` in it, this will always match
324	            assert m is not None
325	            base_topic = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:392:8
391	        # This operator does not support is_web_public_query.
392	        assert not self.is_web_public_query
393	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:393:8
392	        assert not self.is_web_public_query
393	        assert self.user_profile is not None
394	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:467:8
466	        # This operator does not support is_web_public_query.
467	        assert not self.is_web_public_query
468	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:468:8
467	        assert not self.is_web_public_query
468	        assert self.user_profile is not None
469	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:685:8
684	    if is_web_public_query:
685	        assert user_profile is None
686	        return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:688:4
687	
688	    assert user_profile is not None
689	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:776:8
775	    if not need_user_message:
776	        assert need_message
777	        query = select(column("id", Integer).label("message_id")).select_from(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:783:4
782	
783	    assert user_profile is not None
784	    if need_message:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:976:8
975	            raise MissingAuthenticationError()
976	        assert narrow is not None
977	        if not is_spectator_compatible(narrow):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:986:8
985	    else:
986	        assert isinstance(maybe_user_profile, UserProfile)
987	        user_profile = maybe_user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:988:8
987	        user_profile = maybe_user_profile
988	        assert user_profile is not None
989	        is_web_public_query = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:991:4
990	
991	    assert realm is not None
992	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:1048:8
1047	        log_data = RequestNotes.get_notes(request).log_data
1048	        assert log_data is not None
1049	        log_data["extra"] = "[{}]".format(",".join(verbose_operators))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:1119:8
1118	    elif include_history:
1119	        assert user_profile is not None
1120	        message_ids = [row[0] for row in rows]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:39:4
38	    request_notes = RequestNotes.get_notes(request)
39	    assert request_notes.log_data is not None
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:56:4
55	    log_data_str = f"[{count} updated]"
56	    assert request_notes.log_data is not None
57	    request_notes.log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:71:4
70	    log_data = RequestNotes.get_notes(request).log_data
71	    assert log_data is not None
72	    log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:100:4
99	    log_data = RequestNotes.get_notes(request).log_data
100	    assert log_data is not None
101	    log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:57:4
56	    client = RequestNotes.get_notes(request).client
57	    assert client is not None
58	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:230:4
229	    client = RequestNotes.get_notes(request).client
230	    assert client is not None
231	    can_forge_sender = user_profile.can_forge_sender

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:335:4
334	    client = RequestNotes.get_notes(request).client
335	    assert client is not None
336	    message.sending_client = client

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\muting.py:37:8
36	    else:
37	        assert stream_id is not None
38	        (stream, sub) = access_stream_by_id(user_profile, stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\muting.py:60:8
59	    else:
60	        assert stream_id is not None
61	        stream = access_stream_for_unmute_topic_by_id(user_profile, stream_id, error)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:112:8
111	    if emoji_name not in ["", None]:
112	        assert emoji_name is not None
113	        assert emoji_code is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:113:8
112	        assert emoji_name is not None
113	        assert emoji_code is not None
114	        assert emoji_type is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:114:8
113	        assert emoji_code is not None
114	        assert emoji_type is not None
115	        check_emoji_request(user_profile.realm, emoji_name, emoji_code, emoji_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:118:4
117	    client = RequestNotes.get_notes(request).client
118	    assert client is not None
119	    do_update_user_status(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:147:8
146	        client = RequestNotes.get_notes(request).client
147	        assert client is not None
148	        update_user_presence(user_profile, client, timezone_now(), status_val, new_user_input)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:18:20
17	def validate_token(token_str: str, kind: int) -> None:
18	    if token_str == "" or len(token_str) > 4096:
19	        raise JsonableError(_("Empty or invalid length token"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:182:8
181	    else:
182	        assert prereg_user.realm is not None
183	        if get_subdomain(request) != prereg_user.realm.string_id:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:347:8
346	            setup_realm_internal_bots(realm)
347	        assert realm is not None
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:460:12
459	        if realm_creation:
460	            assert realm.signup_notifications_stream is not None
461	            bulk_add_subscriptions(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:629:16
628	            except RateLimited as e:
629	                assert e.secs_to_freedom is not None
630	                return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:687:8
686	        # has its realm mismatching the realm of the request.
687	        assert realm == multiuse_object.realm
688	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:699:16
698	            except RateLimited as e:
699	                assert e.secs_to_freedom is not None
700	                return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:772:20
771	                except RateLimited as e:
772	                    assert e.secs_to_freedom is not None
773	                    return render(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\report.py:3:0
2	import logging
3	import subprocess
4	from typing import Any, Mapping, Optional, Union

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:65:4
64	    log_data = RequestNotes.get_notes(request).log_data
65	    assert log_data is not None
66	    log_data[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:92:4
91	    log_data = RequestNotes.get_notes(request).log_data
92	    assert log_data is not None
93	    log_data["extra"] = f"[{initial_core}ms/{initial_free}ms/{network}ms]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:110:4
109	    log_data = RequestNotes.get_notes(request).log_data
110	    assert log_data is not None
111	    log_data["extra"] = f"[{initial_core}ms/{initial_free}ms]"

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\report.py:142:33
141	    try:
142	        version: Optional[str] = subprocess.check_output(
143	            ["git", "show", "-s", "--oneline"],
144	            text=True,
145	        )
146	    except (FileNotFoundError, subprocess.CalledProcessError):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\report.py:142:33
141	    try:
142	        version: Optional[str] = subprocess.check_output(
143	            ["git", "show", "-s", "--oneline"],
144	            text=True,
145	        )
146	    except (FileNotFoundError, subprocess.CalledProcessError):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:761:8
760	        is_web_public_query = False
761	        assert isinstance(maybe_user_profile, UserProfile)
762	        user_profile = maybe_user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:763:8
762	        user_profile = maybe_user_profile
763	        assert user_profile is not None
764	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:773:8
772	    else:
773	        assert user_profile is not None
774	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\views\user_settings.py:87:30
86	    ctx = {
87	        "new_email_html_tag": SafeString(
88	            f'<a href="mailto:{escape(new_email)}">{escape(new_email)}</a>'
89	        ),
90	        "old_email_html_tag": SafeString(

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\views\user_settings.py:90:30
89	        ),
90	        "old_email_html_tag": SafeString(
91	            f'<a href="mailto:{escape(old_email)}">{escape(old_email)}</a>'
92	        ),
93	    }

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\user_settings.py:217:23
216	
217	    if new_password != "":
218	        return_data: Dict[str, Any] = {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:232:12
231	        except RateLimited as e:
232	            assert e.secs_to_freedom is not None
233	            secs_to_freedom = int(e.secs_to_freedom)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:141:8
140	    if target.is_bot:
141	        assert target.bot_type is not None
142	        check_bot_creation_policy(user_profile, target.bot_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:207:12
206	        for entry in profile_data:
207	            assert isinstance(entry["id"], int)
208	            if entry["value"] is None or not entry["value"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:272:4
271	    # hacks to prevent us from having to jump through decode/encode hoops.
272	    assert url is not None
273	    url = append_url_query_string(url, request.META["QUERY_STRING"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:337:8
336	        check_valid_interface_type(service_interface)
337	        assert service_interface is not None
338	        do_update_outgoing_webhook_service(bot, service_interface, service_payload_url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:486:8
485	    if bot_type in (UserProfile.OUTGOING_WEBHOOK_BOT, UserProfile.EMBEDDED_BOT):
486	        assert isinstance(service_name, str)
487	        add_service(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:89:4
88	def register_zoom_user(request: HttpRequest) -> HttpResponse:
89	    assert request.user.is_authenticated
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:123:4
122	) -> HttpResponse:
123	    assert request.user.is_authenticated
124	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\video_calls.py:174:24
173	    # https://docs.bigbluebutton.org/dev/api.html#usage for reference for checksum
174	    id = "zulip-" + str(random.randint(100000000000, 999999999999))
175	    password = b32encode(secrets.token_bytes(7))[:10].decode()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:216:4
215	) -> HttpResponse:
216	    assert request.user.is_authenticated
217	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\zephyr.py:5:0
4	import shlex
5	import subprocess
6	from typing import Optional

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:45:8
44	            user = kerberos_alter_egos[user]
45	        assert user == user_profile.email.split("@")[0]
46	        # Limit characters in usernames to valid MIT usernames

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:48:8
47	        # This is important for security since DNS is not secure.
48	        assert re.match(r"^[a-z0-9_.-]+$", user) is not None
49	        ccache = make_ccache(parsed_cred)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\zephyr.py:70:8
69	        ]
70	        subprocess.check_call(
71	            ["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--", " ".join(map(shlex.quote, command))]
72	        )
73	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\zephyr.py:70:8
69	        ]
70	        subprocess.check_call(
71	            ["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--", " ".join(map(shlex.quote, command))]
72	        )
73	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\appfollow\view.py:23:4
22	    app_name_search = re.search(r"\A(.+)", message)
23	    assert app_name_search is not None
24	    app_name = app_name_search.group(0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:164:4
163	        )
164	    assert type != "push"
165	    return get_subject(payload)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:188:8
187	        event_key = validate_extract_webhook_http_header(request, "X_EVENT_KEY", "BitBucket")
188	        assert event_key is not None
189	        action = re.match("pullrequest:(?P<action>.*)$", event_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\clubhouse\view.py:415:8
414	        new_reference = get_reference_by_id(payload, new_state_id)
415	        assert new_reference is not None
416	        new_state = new_reference["name"].tame(check_string)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\clubhouse\view.py:418:8
417	        old_reference = get_reference_by_id(payload, old_state_id)
418	        assert old_reference is not None
419	        old_state = old_reference["name"].tame(check_string)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\dialogflow\view.py:39:4
38	    client = RequestNotes.get_notes(request).client
39	    assert client is not None
40	    check_send_private_message(user_profile, client, receiving_user, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\groove\view.py:101:4
100	    event = validate_extract_webhook_http_header(request, "X_GROOVE_EVENT", "Groove")
101	    assert event is not None
102	    handler = EVENTS_FUNCTION_MAPPER.get(event)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\reviewboard\view.py:188:4
187	    )
188	    assert event_type is not None
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\slack\view.py:39:4
38	    client = RequestNotes.get_notes(request).client
39	    assert client is not None
40	    check_send_stream_message(user_profile, client, stream, subject, content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\stripe\view.py:84:8
83	    def update_string(blacklist: Sequence[str] = []) -> str:
84	        assert "previous_attributes" in payload["data"]
85	        previous_attributes = payload["data"]["previous_attributes"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\teamcity\view.py:141:8
140	        client = RequestNotes.get_notes(request).client
141	        assert client is not None
142	        check_send_private_message(user_profile, client, teamcity_user, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\yo\view.py:26:4
25	    client = RequestNotes.get_notes(request).client
26	    assert client is not None
27	    check_send_private_message(user_profile, client, receiving_user, body)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\worker\queue_processors.py:183:4
182	            os.kill(os.getpid(), signal.SIGUSR1)
183	    except Exception:
184	        pass
185	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:403:8
402	    def start(self) -> None:
403	        assert self.q is not None
404	        self.initialize_statistics()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:411:8
410	    def stop(self) -> None:  # nocoverage
411	        assert self.q is not None
412	        self.q.stop_consuming()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:423:8
422	    def start(self) -> None:  # nocoverage
423	        assert self.q is not None
424	        self.initialize_statistics()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:808:8
807	        error_types = ["browser", "server"]
808	        assert event["type"] in error_types
809	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:838:8
837	        )
838	        assert isinstance(msg, EmailMessage)  # https://github.com/python/typeshed/issues/2417
839	        if not is_missed_message_address(rcpt_to):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:893:8
892	    ) -> None:
893	        assert len(events) == 1
894	        event = events[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:949:20
948	                    )
949	                    assert message["content"] is not None
950	                bot_handler.handle_message(

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\worker\queue_processors.py:992:16
991	                ).order_by("id")[offset : offset + batch_size]
992	                UserMessage.objects.filter(message__in=messages).extra(
993	                    where=[UserMessage.where_unread()]
994	                ).update(flags=F("flags").bitor(UserMessage.flags.read))
995	                offset += len(messages)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:1044:12
1043	
1044	            assert public_url is not None
1045	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\add_new_realm.py:25:8
24	        )
25	        assert realm.signup_notifications_stream is not None
26	        bulk_add_subscriptions(realm, [realm.signup_notifications_stream], [user], acting_user=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\mark_all_messages_unread.py:15:8
14	    def handle(self, *args: Any, **options: Any) -> None:
15	        assert settings.DEVELOPMENT
16	        UserMessage.objects.all().update(flags=F("flags").bitand(~UserMessage.flags.read))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\populate_db.py:322:12
321	            RealmDomain.objects.create(realm=zulip_realm, domain="zulip.com")
322	            assert zulip_realm.notifications_stream is not None
323	            zulip_realm.notifications_stream.name = "Verona"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:456:24
455	            for i in range(num_boring_names, num_names):
456	                fname = random.choice(fnames) + str(i)
457	                full_name = fname

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:458:19
457	                full_name = fname
458	                if random.random() < 0.7:
459	                    if random.random() < 0.3:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:459:23
458	                if random.random() < 0.7:
459	                    if random.random() < 0.3:
460	                        full_name += " " + random.choice(non_ascii_names)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:460:43
459	                    if random.random() < 0.3:
460	                        full_name += " " + random.choice(non_ascii_names)
461	                    else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:462:43
461	                    else:
462	                        full_name += " " + random.choice(mnames)
463	                    if random.random() < 0.1:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:463:23
462	                        full_name += " " + random.choice(mnames)
463	                    if random.random() < 0.1:
464	                        full_name += f" {random.choice(raw_emojis)} "

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:464:41
463	                    if random.random() < 0.1:
464	                        full_name += f" {random.choice(raw_emojis)} "
465	                    else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:466:43
465	                    else:
466	                        full_name += " " + random.choice(lnames)
467	                email = fname.lower() + "@zulip.com"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:802:56
801	        for i in range(options["num_huddles"]):
802	            get_huddle(random.sample(user_profiles_ids, random.randint(3, 4)))
803	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:903:40
902	                for i in range(options["extra_streams"]):
903	                    extra_stream_name = random.choice(extra_stream_names) + " " + str(i)
904	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:906:23
905	                    # to imitate emoji insertions in stream names
906	                    if random.random() <= 0.15:
907	                        extra_stream_name += random.choice(raw_emojis)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:907:45
906	                    if random.random() <= 0.15:
907	                        extra_stream_name += random.choice(raw_emojis)
908	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:940:58
939	                count += 1
940	            jobs.append((count, personals_pairs, options, random.randint(0, 10**10)))
941	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1044:18
1043	
1044	        randkey = random.randint(1, random_max)
1045	        if (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1047:16
1046	            num_messages > 0
1047	            and random.randint(1, random_max) * 100.0 / random_max < options["stickyness"]
1048	        ):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1061:52
1060	            message_type = Recipient.HUDDLE
1061	            message.recipient = get_recipient_by_id(random.choice(recipient_huddles))
1062	        elif (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1067:29
1066	            message_type = Recipient.PERSONAL
1067	            personals_pair = random.choice(personals_pairs)
1068	            random.shuffle(personals_pair)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1071:52
1070	            message_type = Recipient.STREAM
1071	            message.recipient = get_recipient_by_id(random.choice(recipient_streams))
1072	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1074:24
1073	        if message_type == Recipient.HUDDLE:
1074	            sender_id = random.choice(huddle_members[message.recipient.id])
1075	            message.sender = get_user_profile_by_id(sender_id)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1084:29
1083	            # Pick a random subscriber to the stream
1084	            message.sender = random.choice(
1085	                list(Subscription.objects.filter(recipient=message.recipient))
1086	            ).user_profile
1087	            message.subject = random.choice(possible_topics[message.recipient.id])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1087:30
1086	            ).user_profile
1087	            message.subject = random.choice(possible_topics[message.recipient.id])
1088	            saved_data["subject"] = message.subject

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1156:24
1155	            max_num_users = min(7, len(msg_user_ids))
1156	            num_users = random.randrange(1, max_num_users + 1)
1157	            user_ids = random.sample(msg_user_ids, num_users)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1161:29
1160	                # each user does between 1 and 3 emojis
1161	                num_emojis = random.choice([1, 2, 3])
1162	                emojis = random.sample(DEFAULT_EMOJIS, num_emojis)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1201:21
1200	
1201	    offset_seconds = random.uniform(lower_bound, upper_bound)
1202	    spoofed_date += timezone_timedelta(seconds=offset_seconds)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\queue_rate.py:63:16
62	
63	                assert worker.q is not None
64	                assert worker.q.channel is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\queue_rate.py:64:16
63	                assert worker.q is not None
64	                assert worker.q.channel is not None
65	                worker.q.channel.basic_qos(prefetch_count=prefetch)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\models.py:153:8
152	        # inside Tornado.
153	        assert not settings.RUNNING_INSIDE_TORNADO
154	        assert settings.ZILENCER_ENABLED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\models.py:154:8
153	        assert not settings.RUNNING_INSIDE_TORNADO
154	        assert settings.ZILENCER_ENABLED
155	

--------------------------------------------------
>> Issue: [B410:blacklist] Using XMLSyntaxError to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XMLSyntaxError with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zproject\backends.py:36:0
35	from django_auth_ldap.backend import LDAPBackend, _LDAPUser, ldap_error
36	from lxml.etree import XMLSyntaxError
37	from onelogin.saml2.errors import OneLogin_Saml2_Error

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\backends.py:400:19
399	
400	    if password == "":
401	        # zxcvbn throws an exception when passed the empty string, so

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\backends.py:440:23
439	            return None
440	        if password == "":
441	            # Never allow an empty password.  This is defensive code;

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:483:8
482	        # Email search needs to be configured in this case.
483	        assert settings.AUTH_LDAP_USERNAME_ATTR and settings.AUTH_LDAP_REVERSE_EMAIL_SEARCH
484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:487:4
486	    # and thus don't make sense to have enabled together.
487	    assert not (
488	        settings.AUTH_LDAP_USER_ATTR_MAP.get("userAccountControl")
489	        and settings.AUTH_LDAP_USER_ATTR_MAP.get("deactivated")
490	    )
491	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:750:8
749	
750	        assert "deactivated" in settings.AUTH_LDAP_USER_ATTR_MAP
751	        attr_value = ldap_user.attrs[settings.AUTH_LDAP_USER_ATTR_MAP["deactivated"]][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:760:8
759	        attr_value_upper = attr_value.upper()
760	        assert (
761	            attr_value_upper in true_values or attr_value_upper in false_values
762	        ), f"Invalid value '{attr_value}' in the LDAP attribute mapped to deactivated"
763	        return attr_value_upper in true_values

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1224:4
1223	def external_auth_method(cls: Type[ExternalAuthMethod]) -> Type[ExternalAuthMethod]:
1224	    assert issubclass(cls, ExternalAuthMethod)
1225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1263:12
1262	        if login_token is not None:
1263	            assert (not data_dict) and (
1264	                user_profile is None
1265	            ), "Passing in data_dict or user_profile with login_token is disallowed."
1266	            self.instantiate_with_token(login_token, delete_stored_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1273:12
1272	            # Ensure data inconsistent with the user_profile wasn't passed in inside the data_dict argument.
1273	            assert (
1274	                "full_name" not in data_dict
1275	                or data_dict["full_name"] == self.user_profile.full_name
1276	            )
1277	            assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1277:12
1276	            )
1277	            assert (
1278	                "email" not in data_dict
1279	                or data_dict["email"].lower() == self.user_profile.delivery_email.lower()
1280	            )
1281	            # Update these data_dict fields to ensure consistency with self.user_profile. This is mostly

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1678:4
1677	    # being incorrectly authenticated.
1678	    assert return_data.get("valid_attestation") is True
1679	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1704:8
1703	        # for it otherwise.
1704	        assert backend.name == "saml"
1705	        custom_profile_field_name_to_attr_name = attrs_by_backend.get(backend.name, {})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2420:8
2419	            ]
2420	        assert isinstance(entitlements, list)
2421	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2464:8
2463	        # receiving a copy of the dict.
2464	        assert auth.get_settings().get_security_data()["wantMessagesSigned"] is True
2465	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2650:8
2649	        idp_name = self.strategy.session_get("saml_idp_name")
2650	        assert isinstance(idp_name, str)
2651	        auto_signup = settings.SOCIAL_AUTH_SAML_ENABLED_IDPS[idp_name].get("auto_signup", False)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2652:8
2651	        auto_signup = settings.SOCIAL_AUTH_SAML_ENABLED_IDPS[idp_name].get("auto_signup", False)
2652	        assert isinstance(auto_signup, bool)
2653	        return auto_signup

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2669:4
2668	    display_icon: Optional[str] = cast(Optional[str], settings_dict.get("display_icon", None))
2669	    assert isinstance(display_icon, (str, type(None)))
2670	    display_name: str = cast(str, settings_dict.get("display_name", "OIDC"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2671:4
2670	    display_name: str = cast(str, settings_dict.get("display_name", "OIDC"))
2671	    assert isinstance(display_name, str)
2672	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2681:8
2680	        client_id = self.settings_dict.get("client_id", "")
2681	        assert isinstance(client_id, str)
2682	        secret = self.settings_dict.get("secret", "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2683:8
2682	        secret = self.settings_dict.get("secret", "")
2683	        assert isinstance(secret, str)
2684	        return client_id, secret

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2713:8
2712	        result = self.settings_dict.get("auto_signup", False)
2713	        assert isinstance(result, bool)
2714	        return result

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\zproject\computed_settings.py:728:25
727	
728	ZULIP_WORKER_TEST_FILE = "/tmp/zulip-worker-test-file"
729	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:73:12
72	            html_alternative = list(email_message.alternatives[0])
73	            assert isinstance(html_alternative[0], str)
74	            # Here, we replace the email addresses used in development

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:80:12
79	            )
80	            assert isinstance(email_message.alternatives, MutableSequence)
81	            email_message.alternatives[0] = tuple(html_alternative)

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\zproject\jinja2\__init__.py:21:10
20	def environment(**options: Any) -> Environment:
21	    env = Environment(**options)
22	    env.globals.update(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:162:16
161	S3_KEY = "test-key"
162	S3_SECRET_KEY = "test-secret-key"
163	S3_AUTH_UPLOADS_BUCKET = "test-authed-bucket"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:176:30
175	GOOGLE_OAUTH2_CLIENT_ID = "id"
176	GOOGLE_OAUTH2_CLIENT_SECRET = "secret"
177	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:179:28
178	SOCIAL_AUTH_GITHUB_KEY = "key"
179	SOCIAL_AUTH_GITHUB_SECRET = "secret"
180	SOCIAL_AUTH_GITLAB_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:181:28
180	SOCIAL_AUTH_GITLAB_KEY = "key"
181	SOCIAL_AUTH_GITLAB_SECRET = "secret"
182	SOCIAL_AUTH_GOOGLE_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:183:28
182	SOCIAL_AUTH_GOOGLE_KEY = "key"
183	SOCIAL_AUTH_GOOGLE_SECRET = "secret"
184	SOCIAL_AUTH_SUBDOMAIN = "auth"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'client_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:211:27
210	VIDEO_ZOOM_CLIENT_ID = "client_id"
211	VIDEO_ZOOM_CLIENT_SECRET = "client_secret"
212	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:213:25
212	
213	BIG_BLUE_BUTTON_SECRET = "123"
214	BIG_BLUE_BUTTON_URL = "https://bbb.example.com/bigbluebutton/"

--------------------------------------------------

Code scanned:
	Total lines of code: 187884
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 1417
		Medium: 41
		High: 11
	Total issues (by confidence):
		Undefined: 0
		Low: 9
		Medium: 172
		High: 1288
Files skipped (0):
