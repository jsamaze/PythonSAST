Working... ---------------------------------------- 100% 0:00:21
Run started:2024-02-10 22:48:24.299277

Test results:
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'postgres'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\.ci\scripts\postgres_exec.py:25:10
24	# doesn't exist yet.
25	db_conn = psycopg2.connect(
26	    user="postgres", host="localhost", password="postgres", dbname="postgres"
27	)
28	db_conn.autocommit = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'END'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\console.py:63:34
62	        self.path_prefix = "/_matrix/client/api/v1"
63	        self.event_stream_token = "END"
64	        self.prompt = ">>> "

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:585:12
584	                args["path"] = parsed_url.path
585	            except Exception:
586	                pass
587	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:776:12
775	                http_client.verbose = "on" == syn_cmd.config["verbose"]
776	            except Exception:
777	                pass
778	            print("Loaded config from %s" % config_path)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\contrib\cmdclient\console.py:779:4
778	            print("Loaded config from %s" % config_path)
779	    except Exception:
780	        pass
781	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '[REDACTED]'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\contrib\cmdclient\http.py:148:30
147	                temp = producer.data["password"]
148	                producer.data["password"] = "[REDACTED]"
149	                print(json.dumps(producer.data, indent=4))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docker\configure_workers_and_start.py:35:0
34	import os
35	import subprocess
36	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\configure_workers_and_start.py:309:4
308	    os.environ["SYNAPSE_HTTP_PORT"] = str(MAIN_PROCESS_HTTP_LISTENER_PORT)
309	    subprocess.check_output(["/usr/local/bin/python", "/start.py", "migrate_config"])
310	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\configure_workers_and_start.py:601:4
600	    log("Starting supervisord")
601	    os.execl(
602	        "/usr/local/bin/supervisord",
603	        "supervisord",
604	        "-c",
605	        "/etc/supervisor/supervisord.conf",
606	    )
607	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docker\start.py:7:0
6	import platform
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:130:8
129	        log(f"Setting ownership on /data to {ownership}")
130	        subprocess.check_output(["chown", "-R", ownership, "/data"])
131	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:130:8
129	        log(f"Setting ownership on /data to {ownership}")
130	        subprocess.check_output(["chown", "-R", ownership, "/data"])
131	        args = ["gosu", ownership] + args

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:133:4
132	
133	    subprocess.check_output(args)
134	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\docker\start.py:157:8
156	        log(f"Setting ownership on {data_dir} to {ownership}")
157	        subprocess.check_output(["chown", ownership, data_dir])
158	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docker\start.py:157:8
156	        log(f"Setting ownership on {data_dir} to {ownership}")
157	        subprocess.check_output(["chown", ownership, data_dir])
158	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:184:4
183	    # log("running %s" % (args, ))
184	    os.execv(sys.executable, args)
185	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:266:8
265	        args = ["gosu", ownership] + args
266	        os.execve("/usr/sbin/gosu", args, environ)
267	    else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\docker\start.py:268:8
267	    else:
268	        os.execve(sys.executable, args, environ)
269	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts-dev\build_debian_packages.py:16:0
15	import signal
16	import subprocess
17	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts-dev\build_debian_packages.py:104:8
103	
104	        subprocess.check_call(
105	            build_args,
106	            stdout=stdout,
107	            stderr=subprocess.STDOUT,
108	            cwd=projdir,
109	        )
110	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\build_debian_packages.py:116:8
115	        # then run the build itself
116	        subprocess.check_call(
117	            [
118	                "docker",
119	                "run",
120	                "--rm",
121	                "--name",
122	                container_name,
123	                "--volume=" + projdir + ":/synapse/source:ro",
124	                "--volume=" + debsdir + ":/debs",
125	                "-e",
126	                "TARGET_USERID=%i" % (os.getuid(),),
127	                "-e",
128	                "TARGET_GROUPID=%i" % (os.getgid(),),
129	                "-e",
130	                "DEB_BUILD_OPTIONS=%s" % ("nocheck" if skip_tests else ""),
131	                "dh-venv-builder:" + tag,
132	            ],
133	            stdout=stdout,
134	            stderr=subprocess.STDOUT,
135	        )
136	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts-dev\build_debian_packages.py:116:8
115	        # then run the build itself
116	        subprocess.check_call(
117	            [
118	                "docker",
119	                "run",
120	                "--rm",
121	                "--name",
122	                container_name,
123	                "--volume=" + projdir + ":/synapse/source:ro",
124	                "--volume=" + debsdir + ":/debs",
125	                "-e",
126	                "TARGET_USERID=%i" % (os.getuid(),),
127	                "-e",
128	                "TARGET_GROUPID=%i" % (os.getgid(),),
129	                "-e",
130	                "DEB_BUILD_OPTIONS=%s" % ("nocheck" if skip_tests else ""),
131	                "dh-venv-builder:" + tag,
132	            ],
133	            stdout=stdout,
134	            stderr=subprocess.STDOUT,
135	        )
136	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\build_debian_packages.py:150:12
149	            print("killing container %s" % (c,))
150	            subprocess.run(
151	                [
152	                    "docker",
153	                    "kill",
154	                    c,
155	                ],
156	                stdout=subprocess.DEVNULL,
157	            )
158	            with self._lock:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts-dev\build_debian_packages.py:150:12
149	            print("killing container %s" % (c,))
150	            subprocess.run(
151	                [
152	                    "docker",
153	                    "kill",
154	                    c,
155	                ],
156	                stdout=subprocess.DEVNULL,
157	            )
158	            with self._lock:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\federation_client.py:219:4
218	
219	    assert isinstance(args.signing_key, str)
220	    algorithm, version, key_base64 = args.signing_key.split()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\scripts-dev\federation_client.py:289:19
288	        try:
289	            resp = requests.get(uri)
290	            if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts-dev\release.py:23:0
22	import re
23	import subprocess
24	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts-dev\release.py:43:28
42	    while True:
43	        completed_process = subprocess.run(command, *args, **kwargs)
44	        exit_code = completed_process.returncode

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\release.py:165:4
164	    # We assume for debian changelogs that we only do RCs or full releases.
165	    assert not parsed_new_version.is_devrelease
166	    assert not parsed_new_version.is_postrelease

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\release.py:166:4
165	    assert not parsed_new_version.is_devrelease
166	    assert not parsed_new_version.is_postrelease
167	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:211:4
210	    # Update the version specified in pyproject.toml.
211	    subprocess.check_output(["poetry", "version", new_version])
212	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts-dev\release.py:211:4
210	    # Update the version specified in pyproject.toml.
211	    subprocess.check_output(["poetry", "version", new_version])
212	

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:228:4
227	        f'dch -M -v {debian_version} "New Synapse release {new_version}."',
228	        shell=True,
229	    )
230	    run_until_successful('dch -M -r -D stable ""', shell=True)
231	
232	    # Show the user the changes and ask if they want to edit the change log.

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:230:4
229	    )
230	    run_until_successful('dch -M -r -D stable ""', shell=True)
231	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:234:4
233	    repo.git.add("-u")
234	    subprocess.run("git diff --cached", shell=True)
235	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:234:4
233	    repo.git.add("-u")
234	    subprocess.run("git diff --cached", shell=True)
235	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\release.py:300:8
299	        # the original string.
300	        assert edited_changes is not None
301	        changes = edited_changes

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts-dev\release.py:376:4
375	
376	    assert release.title == tag_name
377	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\scripts-dev\release.py:416:12
415	            click.echo(f"Downloading {name} into {filename}")
416	            urllib.request.urlretrieve(url, filename=filename)
417	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:419:12
418	        if click.confirm("Upload to PyPI?", default=True):
419	            subprocess.run("twine upload *", shell=True, cwd=tmpdir)
420	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:419:12
418	        if click.confirm("Upload to PyPI?", default=True):
419	            subprocess.run("twine upload *", shell=True, cwd=tmpdir)
420	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts-dev\release.py:462:21
461	def get_package_version() -> version.Version:
462	    version_string = subprocess.check_output(["poetry", "version", "--short"]).decode(
463	        "utf-8"

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts-dev\release.py:462:21
461	def get_package_version() -> version.Version:
462	    version_string = subprocess.check_output(["poetry", "version", "--short"]).decode(
463	        "utf-8"

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\scripts-dev\release.py:568:13
567	        f"python3 -m towncrier build --draft --version {new_version}",
568	        shell=True,
569	        capture_output=True,
570	    )
571	    new_changes = result.stdout.decode("utf-8")
572	    new_changes = new_changes.replace(
573	        "No significant changes.", f"No significant changes since {current_version}."

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\_scripts\hash_password.py:28:22
27	    bcrypt_rounds = 12
28	    password_pepper = ""
29	

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:43:8
42	    # Get the nonce
43	    r = requests.get(url, verify=False)
44	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:43:8
42	    # Get the nonce
43	    r = requests.get(url, verify=False)
44	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:50:12
49	                _print(r.json()["error"])
50	            except Exception:
51	                pass
52	        return exit(1)

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:81:8
80	    _print("Sending registration request...")
81	    r = requests.post(url, json=data, verify=False)
82	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:81:8
80	    _print("Sending registration request...")
81	    r = requests.post(url, json=data, verify=False)
82	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\register_new_matrix_user.py:88:12
87	                _print(r.json()["error"])
88	            except Exception:
89	                pass
90	        return exit(1)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\_scripts\synapse_port_db.py:237:14
236	    ) -> None:
237	        sql = "INSERT INTO %s (%s) VALUES (%s)" % (
238	            table,
239	            ", ".join(k for k in headers),
240	            ", ".join("%s" for _ in headers),
241	        )
242	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\_scripts\synapse_port_db.py:422:12
421	        forward_select = (
422	            "SELECT rowid, * FROM %s WHERE rowid >= ? ORDER BY rowid LIMIT ?" % (table,)
423	        )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\_scripts\synapse_port_db.py:426:12
425	        backward_select = (
426	            "SELECT rowid, * FROM %s WHERE rowid <= ? ORDER BY rowid LIMIT ?" % (table,)
427	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\_scripts\synapse_port_db.py:463:16
462	            if frows or brows:
463	                assert headers is not None
464	                if frows:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\_scripts\synapse_port_db.py:473:20
472	                def insert(txn: LoggingTransaction) -> None:
473	                    assert headers is not None
474	                    self.postgres_store.insert_many_txn(txn, table, headers[1:], rows)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\synapse_port_db.py:687:12
686	                )
687	            except Exception:
688	                # On Error Resume Next
689	                pass
690	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\_scripts\synapse_port_db.py:897:12
896	            result = txn.fetchone()
897	            assert result is not None
898	            return int(result[0])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\_scripts\synapse_port_db.py:912:16
911	            await self.sqlite_store.execute_sql(
912	                "SELECT count(*) FROM %s WHERE rowid >= ?" % (table,), forward_chunk
913	            ),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\_scripts\synapse_port_db.py:919:16
918	            await self.sqlite_store.execute_sql(
919	                "SELECT count(*) FROM %s WHERE rowid <= ?" % (table,), backward_chunk
920	            ),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\_scripts\synapse_port_db.py:927:12
926	        rows = await self.postgres_store.execute_sql(
927	            "SELECT count(*) FROM %s" % (table,)
928	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\_scripts\synapse_port_db.py:965:12
964	        def r(txn: LoggingTransaction) -> None:
965	            assert curr_id is not None
966	            next_id = curr_id + 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\_scripts\synapse_port_db.py:1055:12
1054	            # Presumably there is at least one row in event_auth_chains.
1055	            assert curr_chain_id is not None
1056	            txn.execute(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\synapse\_scripts\synctl.py:24:0
23	import signal
24	import subprocess
25	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\_scripts\synctl.py:63:4
62	                return False
63	    except Exception:
64	        # This isn't Linux or `/proc/` is unavailable.
65	        # Assume that the process is still running.
66	        pass
67	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\synapse\_scripts\synctl.py:116:8
115	    try:
116	        subprocess.check_call(args)
117	        write("started %s(%s)" % (app, ",".join(config_files)), colour=GREEN)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\_scripts\synctl.py:290:16
289	                    continue
290	                assert not key.startswith(
291	                    "worker_"
292	                ), "Main process cannot use worker_* config"
293	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:361:8
360	        # This will always be set by the time Twisted calls us.
361	        assert request.args is not None
362	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:379:12
378	            # We only just set this so it can't be None!
379	            assert effective_device_id is not None
380	            device_opt = await self.store.get_device(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:628:8
627	        # This will always be set by the time Twisted calls us.
628	        assert request.args is not None
629	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth.py:647:8
646	        # This will always be set by the time Twisted calls us.
647	        assert request.args is not None
648	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\api\auth_blocking.py:108:12
107	        if self._limit_usage_by_mau is True:
108	            assert not (user_id and threepid)
109	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_MISSING_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:50:20
49	    NOT_FOUND = "M_NOT_FOUND"
50	    MISSING_TOKEN = "M_MISSING_TOKEN"
51	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_UNKNOWN_TOKEN'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:51:20
50	    MISSING_TOKEN = "M_MISSING_TOKEN"
51	    UNKNOWN_TOKEN = "M_UNKNOWN_TOKEN"
52	    GUEST_ACCESS_FORBIDDEN = "M_GUEST_ACCESS_FORBIDDEN"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_TOO_SHORT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:73:25
72	    EXPIRED_ACCOUNT = "ORG_MATRIX_EXPIRED_ACCOUNT"
73	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
74	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_DIGIT'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:74:24
73	    PASSWORD_TOO_SHORT = "M_PASSWORD_TOO_SHORT"
74	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
75	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_UPPERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:75:28
74	    PASSWORD_NO_DIGIT = "M_PASSWORD_NO_DIGIT"
75	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
76	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_LOWERCASE'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:76:28
75	    PASSWORD_NO_UPPERCASE = "M_PASSWORD_NO_UPPERCASE"
76	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
77	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_NO_SYMBOL'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:77:25
76	    PASSWORD_NO_LOWERCASE = "M_PASSWORD_NO_LOWERCASE"
77	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
78	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_PASSWORD_IN_DICTIONARY'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:78:29
77	    PASSWORD_NO_SYMBOL = "M_PASSWORD_NO_SYMBOL"
78	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
79	    WEAK_PASSWORD = "M_WEAK_PASSWORD"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'M_WEAK_PASSWORD'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\api\errors.py:79:20
78	    PASSWORD_IN_DICTIONARY = "M_PASSWORD_IN_DICTIONARY"
79	    WEAK_PASSWORD = "M_WEAK_PASSWORD"
80	    INVALID_SIGNATURE = "M_INVALID_SIGNATURE"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\app\__init__.py:48:18
47	    """
48	    if address == "0.0.0.0" and "::" in bind_addresses:
49	        logger.warning(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\_base.py:181:12
180	        if daemonize:
181	            assert pid_file is not None
182	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\admin_cmd.py:199:8
198	    if config.worker.worker_app is not None:
199	        assert config.worker.worker_app == "synapse.app.admin_cmd"
200	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:270:8
269	
270	        assert listener_config.http_options is not None
271	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\generic_worker.py:427:4
426	    # For backwards compatibility let any of the old app names.
427	    assert config.worker.worker_app in (
428	        "synapse.app.appservice",
429	        "synapse.app.client_reader",
430	        "synapse.app.event_creator",
431	        "synapse.app.federation_reader",
432	        "synapse.app.federation_sender",
433	        "synapse.app.frontend_proxy",
434	        "synapse.app.generic_worker",
435	        "synapse.app.media_repository",
436	        "synapse.app.pusher",
437	        "synapse.app.synchrotron",
438	        "synapse.app.user_dir",
439	    )
440	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\homeserver.py:93:8
92	        # Must exist since this is an HTTP listener.
93	        assert listener_config.http_options is not None
94	        site_tag = listener_config.http_options.tag

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\homeserver.py:159:12
158	            # refresh_certificate should have been called before this.
159	            assert self.tls_server_context_factory is not None
160	            ports = listen_ssl(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\app\phone_stats_home.py:57:4
56	    # Ensure the homeserver has started.
57	    assert hs.start_time is not None
58	    uptime = int(now - hs.start_time)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:352:18
351	        dict_copy = self.__dict__.copy()
352	        dict_copy["token"] = "<redacted>"
353	        dict_copy["hs_token"] = "<redacted>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '<redacted>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\appservice\__init__.py:353:18
352	        dict_copy["token"] = "<redacted>"
353	        dict_copy["hs_token"] = "<redacted>"
354	        return "ApplicationService: %s" % (dict_copy,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\api.py:107:8
106	        # This is required by the configuration.
107	        assert service.hs_token is not None
108	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\api.py:127:8
126	        # This is required by the configuration.
127	        assert service.hs_token is not None
128	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\api.py:159:8
158	        # This is required by the configuration.
159	        assert service.hs_token is not None
160	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\api.py:201:12
200	            # This is required by the configuration.
201	            assert service.hs_token is not None
202	            uri = "%s%s/thirdparty/protocol/%s" % (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\api.py:260:8
259	        # This is required by the configuration.
260	        assert service.hs_token is not None
261	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:209:8
208	        # running.
209	        assert service.id not in self.requests_in_flight
210	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\appservice\scheduler.py:435:8
434	        logger.info("Starting recoverer for AS ID %s", service.id)
435	        assert service.id not in self.recoverers
436	        recoverer = self.RECOVERER_CLASS(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Password reset emails are enabled on this homeserver due to a partial
'email' block. However, the following required keys are missing:
    %s
'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\emailconfig.py:32:38
31	
32	MISSING_PASSWORD_RESET_CONFIG_ERROR = """\
33	Password reset emails are enabled on this homeserver due to a partial
34	'email' block. However, the following required keys are missing:
35	    %s
36	"""
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\key.py:109:12
108	        else:
109	            assert config_dir_path is not None
110	            signing_key_path = config.get("signing_key_path")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#macaroon_secret_key: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:192:34
191	        else:
192	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
193	            form_secret = "#form_secret: <PRIVATE STRING>"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#form_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\key.py:193:26
192	            macaroon_secret_key = "#macaroon_secret_key: <PRIVATE STRING>"
193	            form_secret = "#form_secret: <PRIVATE STRING>"
194	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\config\logger.py:272:12
271	                print("logging during logging: %s" % event_text, file=sys.__stderr__)
272	            except Exception:
273	                # gah.
274	                pass
275	            return

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '#registration_shared_secret: <PRIVATE STRING>'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\config\registration.py:210:41
209	        else:
210	            registration_shared_secret = "#registration_shared_secret: <PRIVATE STRING>"
211	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\repository.py:211:17
210	                config["url_preview_ip_range_blacklist"],
211	                ["0.0.0.0", "::"],
212	                config_path=("url_preview_ip_range_blacklist",),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\repository.py:243:8
242	    def generate_config_section(self, data_dir_path: str, **kwargs: Any) -> str:
243	        assert data_dir_path is not None
244	        media_store = os.path.join(data_dir_path, "media_store")

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:46:32
45	# in the list.
46	DEFAULT_BIND_ADDRESSES = ["::", "0.0.0.0"]
47	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:448:33
447	        self.ip_range_blacklist = generate_ip_set(
448	            ip_range_blacklist, ["0.0.0.0", "::"], config_path=("ip_range_blacklist",)
449	        )

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:460:17
459	                config["federation_ip_range_blacklist"],
460	                ["0.0.0.0", "::"],
461	                config_path=("federation_ip_range_blacklist",),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\config\server.py:1345:8
1344	    try:
1345	        assert len(thresholds) == 3
1346	        return int(thresholds[0]), int(thresholds[1]), int(thresholds[2])

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\synapse\config\server.py:1373:34
1372	            # the metrics listener doesn't support IPv6
1373	            bind_addresses.append("0.0.0.0")
1374	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\context_factory.py:81:8
80	        context.use_certificate_chain_file(config.tls.tls_certificate_file)
81	        assert config.tls.tls_private_key is not None
82	        context.use_privatekey(config.tls.tls_private_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:705:8
704	
705	        assert isinstance(query_response, dict)
706	        for response in query_response["server_keys"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\crypto\keyring.py:883:12
882	
883	            assert isinstance(response, dict)
884	            if response["server_name"] != server_name:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:111:12
110	        try:
111	            assert isinstance(instance, (EventBase, _EventInternalMetadata))
112	            return instance._dict[self.key]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:127:8
126	    def __set__(self, instance: _DictPropertyInstance, v: T) -> None:
127	        assert isinstance(instance, (EventBase, _EventInternalMetadata))
128	        instance._dict[self.key] = v

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:131:8
130	    def __delete__(self, instance: _DictPropertyInstance) -> None:
131	        assert isinstance(instance, (EventBase, _EventInternalMetadata))
132	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:176:8
175	            return self
176	        assert isinstance(instance, (EventBase, _EventInternalMetadata))
177	        return instance._dict.get(self.key, self.default)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:309:8
308	    ):
309	        assert room_version.event_format == self.format_version
310	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\__init__.py:513:8
512	
513	        assert "event_id" not in event_dict
514	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\presence_router.py:87:12
86	            # https://mypy.readthedocs.io/en/latest/common_issues.html#narrowing-and-inner-functions
87	            assert f is not None
88	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\snapshot.py:223:8
222	
223	        assert self._state_delta_due_to_event is not None
224	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\snapshot.py:251:8
250	        """
251	        assert self.state_group_before_event is not None
252	        return await self._storage.state.get_state_ids_for_group(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\spamcheck.py:150:24
149	                        # https://mypy.readthedocs.io/en/latest/common_issues.html#narrowing-and-inner-functions
150	                        assert f is not None
151	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\spamcheck.py:168:16
167	                # https://mypy.readthedocs.io/en/latest/common_issues.html#narrowing-and-inner-functions
168	                assert wrapped_func is not None
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\spamcheck.py:562:12
561	                )
562	            assert isinstance(behaviour, RegistrationBehaviour)
563	            if behaviour != RegistrationBehaviour.ALLOW:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\third_party_rules.py:92:16
91	                # https://mypy.readthedocs.io/en/latest/common_issues.html#narrowing-and-inner-functions
92	                assert f is not None
93	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\third_party_rules.py:113:16
112	                # https://mypy.readthedocs.io/en/latest/common_issues.html#narrowing-and-inner-functions
113	                assert f is not None
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\events\third_party_rules.py:128:12
127	            # https://mypy.readthedocs.io/en/latest/common_issues.html#narrowing-and-inner-functions
128	            assert f is not None
129	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\federation\federation_server.py:192:36
191	            # We pause a bit so that we don't start handling all rooms at once.
192	            await self._clock.sleep(random.uniform(0, 0.1))
193	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\federation_server.py:327:8
326	        # add an entry to _active_transactions.
327	        assert origin not in self._active_transactions
328	        self._active_transactions[origin] = transaction.transaction_id

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\federation\federation_server.py:1387:23
1386	            # Pick an instance randomly so that we don't overload one.
1387	            route_to = random.choice(instances)
1388	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\send_queue.py:215:12
214	        if key:
215	            assert isinstance(key, tuple)
216	            self.keyed_edu[(destination, key)] = edu

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:199:8
198	
199	        assert not self.processing
200	        self.processing = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:480:24
479	                        ts = await self.store.get_received_ts(event.event_id)
480	                        assert ts is not None
481	                        synapse.metrics.event_processing_lag_by_event.labels(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:513:20
512	                    ts = await self.store.get_received_ts(events[-1].event_id)
513	                    assert ts is not None
514	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:552:8
551	
552	        assert pdu.internal_metadata.stream_ordering
553	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\__init__.py:676:12
675	        for state in states:
676	            assert self.is_mine_id(state.user_id)
677	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:172:12
171	        else:
172	            assert pdu.internal_metadata.stream_ordering
173	            self._catchup_last_skipped = pdu.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:480:24
479	                        # We pulled this from the DB, so it'll be non-null
480	                        assert p.internal_metadata.stream_ordering
481	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:523:16
522	                # We pulled this from the DB, so it'll be non-null
523	                assert pdu.internal_metadata.stream_ordering
524	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:575:8
574	
575	        assert len(edus) <= limit, "get_device_updates_by_remote returned too many EDUs"
576	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\federation\sender\per_destination_queue.py:714:12
713	            ].internal_metadata.stream_ordering
714	            assert self._last_stream_ordering
715	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:116:30
115	            response = await self._room_data_client(
116	                instance_name=random.choice(self._account_data_writers),
117	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:152:30
151	            response = await self._user_data_client(
152	                instance_name=random.choice(self._account_data_writers),
153	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:184:30
183	            response = await self._add_tag_client(
184	                instance_name=random.choice(self._account_data_writers),
185	                user_id=user_id,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\account_data.py:209:30
208	            response = await self._remove_tag_client(
209	                instance_name=random.choice(self._account_data_writers),
210	                user_id=user_id,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\account_validity.py:398:12
397	        if expiration_ts is None:
398	            assert self._account_validity_period is not None
399	            expiration_ts = now + self._account_validity_period

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\appservice.py:154:24
153	                        ts = await self.store.get_received_ts(event.event_id)
154	                        assert ts is not None
155	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\appservice.py:191:24
190	                        ts = await self.store.get_received_ts(events[-1].event_id)
191	                        assert ts is not None
192	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\appservice.py:258:8
257	        # Additional context: https://github.com/matrix-org/synapse/pull/11137
258	        assert isinstance(new_token, int)
259	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1188:16
1187	                # we've already checked that there is a (valid) password field
1188	                assert isinstance(password, str)
1189	                (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1283:8
1282	        # we already checked that we have a valid login type
1283	        assert isinstance(login_type, str)
1284	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1330:12
1329	            password = login_submission["password"]
1330	            assert isinstance(password, str)
1331	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1959:16
1958	                # None.
1959	                assert f is not None
1960	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:1983:16
1982	                # None.
1983	                assert f is not None
1984	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:2004:16
2003	                # None.
2004	                assert f is not None
2005	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\auth.py:2018:12
2017	            # f is definitely not None.
2018	            assert f is not None
2019	

--------------------------------------------------
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\synapse\handlers\cas.py:17:0
16	from typing import TYPE_CHECKING, Dict, List, Optional
17	from xml.etree import ElementTree as ET
18	

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\synapse\handlers\cas.py:158:15
157	        # Ensure the response is valid.
158	        root = ET.fromstring(cas_response_body)
159	        if not root.tag.endswith("serviceResponse"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\cas.py:214:12
213	        else:
214	            assert client_redirect_url
215	            service_args = {"redirectUrl": client_redirect_url.decode("utf8")}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\cas.py:316:8
315	        # If this not a UI auth request than there must be a redirect URL.
316	        assert client_redirect_url is not None
317	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\device.py:392:8
391	        # We should only be running this job if the config option is defined.
392	        assert self._delete_stale_devices_after is not None
393	        now_ms = self.clock.time_msec()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\events.py:82:26
81	                # thundering herds on restart.
82	                timeout = random.randint(int(timeout * 0.9), int(timeout * 1.1))
83	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\handlers\federation.py:104:8
103	                joined_domains[dom] = d
104	        except Exception:
105	            pass
106	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:483:8
482	        # partial room state to happen on workers.
483	        assert self.config.worker.worker_app is None
484	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:499:8
498	        # at a time - so this is just paranoia.
499	        assert room_id not in self._federation_event_handler.room_queues
500	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:930:8
929	        # FIXME: Do this in a nicer way
930	        assert event.type == EventTypes.Member
931	        assert event.user_id == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:931:8
930	        assert event.type == EventTypes.Member
931	        assert event.user_id == user_id
932	        assert event.state_key == user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:932:8
931	        assert event.user_id == user_id
932	        assert event.state_key == user_id
933	        assert event.room_id == room_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:933:8
932	        assert event.state_key == user_id
933	        assert event.room_id == room_id
934	        return origin, event, room_version

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1056:8
1055	        # get_state_groups_ids should return exactly one result
1056	        assert len(state_groups) == 1
1057	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1064:12
1063	            # events) so the state at the event should include the event itself.
1064	            assert (
1065	                state_map.get((event.type, state_key)) == event.event_id
1066	            ), "State at event did not include event itself"
1067	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1478:8
1477	        """Resumes resyncing of all partial-state rooms after a restart."""
1478	        assert not self.config.worker.worker_app
1479	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1504:8
1503	        """
1504	        assert not self.config.worker.worker_app
1505	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation.py:1546:16
1545	                logger.info("Updating current state for %s", room_id)
1546	                assert (
1547	                    self._storage_controllers.persistence is not None
1548	                ), "TODO(faster_joins): support for workers"
1549	                await self._storage_controllers.persistence.update_current_state(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:150:8
149	        # We should never see any outliers here.
150	        assert not pdu.internal_metadata.outlier
151	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:326:8
325	
326	        assert not event.internal_metadata.outlier
327	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:752:8
751	        # these should not be outliers.
752	        assert (
753	            not event.internal_metadata.is_outlier()
754	        ), "pulled event unexpectedly flagged as outlier"
755	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:1090:8
1089	        logger.debug("Processing event: %s", event)
1090	        assert not event.internal_metadata.outlier
1091	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:1497:8
1496	        # This method should only be used for non-outliers
1497	        assert not event.internal_metadata.outlier
1498	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:1715:8
1714	        """
1715	        assert not event.internal_metadata.outlier
1716	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:1740:12
1739	        for d in different_events:
1740	            assert (
1741	                d.room_id == event.room_id
1742	            ), f"Event {event.event_id} refers to auth_event {d.event_id} which is in a different room"
1743	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:1939:8
1938	        # persist_events_and_notify directly.)
1939	        assert not event.internal_metadata.outlier
1940	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:2008:12
2007	        else:
2008	            assert self._storage_controllers.persistence
2009	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\federation_event.py:2058:8
2057	        # the event has been persisted so it should have a stream ordering.
2058	        assert event.internal_metadata.stream_ordering
2059	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\identity.py:554:12
553	            # Remote emails will only be used if a valid identity server is provided.
554	            assert (
555	                self.hs.config.registration.account_threepid_delegate_email is not None
556	            )
557	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\initial_sync.py:331:12
330	            # to leave.
331	            assert member_event_id
332	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:134:12
133	            # If the membership is not JOIN, then the event ID should exist.
134	            assert (
135	                membership_event_id is not None
136	            ), "check_user_in_room_or_world_readable returned invalid data"
137	            room_state = await self._state_storage_controller.get_state_for_events(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:228:16
227	                # If the membership is not JOIN, then the event ID should exist.
228	                assert (
229	                    membership_event_id is not None
230	                ), "check_user_in_room_or_world_readable returned invalid data"
231	                room_state_events = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:420:8
419	        """
420	        assert self._ephemeral_events_enabled
421	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:787:8
786	        u = await self.store.get_user_by_id(user_id)
787	        assert u is not None
788	        if u["user_type"] in (UserTypes.SUPPORT, UserTypes.BOT):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:903:35
902	            # We randomly sleep a bit just to annoy the requester.
903	            await self.clock.sleep(random.randint(1, 10))
904	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:922:20
921	                    # we know it was persisted, so must have a stream ordering
922	                    assert event.internal_metadata.stream_ordering
923	                    return event, event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:937:12
936	
937	            assert self.hs.is_mine_id(event.sender), "User must be our own: %s" % (
938	                event.sender,
939	            )
940	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:984:8
983	        # we know it was persisted, so must have a stream ordering
984	        assert ev.internal_metadata.stream_ordering
985	        return ev, ev.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1040:12
1039	            # prev_event_ids could be an empty array though.
1040	            assert prev_event_ids is not None
1041	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1058:12
1057	        if prev_event_ids is not None:
1058	            assert (
1059	                len(prev_event_ids) <= 10
1060	            ), "Attempting to create an event with %i prev_events" % (
1061	                len(prev_event_ids),
1062	            )
1063	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1071:12
1070	            # We allow events with no `prev_events` but it better have some `auth_events`
1071	            assert (
1072	                builder.type == EventTypes.Create
1073	                # Allow an event to have empty list of prev_event_ids
1074	                # only if it has auth_event_ids.
1075	                or auth_event_ids
1076	            ), "Attempting to create a non-m.room.create event with no prev_events or auth_event_ids"
1077	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1079:12
1078	            # we now ought to have some prev_events (unless it's a create event).
1079	            assert (
1080	                builder.type == EventTypes.Create or prev_event_ids
1081	            ), "Attempting to create a non-m.room.create event with no prev_events"
1082	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\message.py:1263:35
1262	            # We randomly sleep a bit just to annoy the requester.
1263	            await self.clock.sleep(random.randint(1, 10))
1264	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1296:12
1295	            # invite rejections and rescinded knocks that we have generated ourselves.
1296	            assert event.type == EventTypes.Member
1297	            assert event.content["membership"] == Membership.LEAVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1297:12
1296	            assert event.type == EventTypes.Member
1297	            assert event.content["membership"] == Membership.LEAVE
1298	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1412:8
1411	        # If external cache is enabled we should always have this.
1412	        assert self._external_cache_joined_hosts_updates is not None
1413	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1506:8
1505	
1506	        assert self._storage_controllers.persistence is not None
1507	        assert self._events_shard_config.should_handle(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1507:8
1506	        assert self._storage_controllers.persistence is not None
1507	        assert self._events_shard_config.should_handle(
1508	            self._instance_name, event.room_id
1509	        )
1510	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1518:16
1517	            if event.type == EventTypes.Redaction:
1518	                assert event.redacts is not None
1519	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1616:12
1615	        if event.type == EventTypes.Redaction:
1616	            assert event.redacts is not None
1617	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\message.py:1782:8
1781	        # therefore have the state ids.
1782	        assert current_state_ids is not None
1783	        current_state_dict = await self.store.get_events(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\oidc.py:106:8
105	        # we should not have been instantiated if there is no configured provider.
106	        assert provider_confs
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\oidc.py:151:8
150	        # This will always be set by the time Twisted calls us.
151	        assert request.args is not None
152	

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\handlers\oidc.py:1311:6
1310	
1311	env = Environment(finalize=jinja_finalize)
1312	env.filters.update(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:451:12
450	            # `/messages` should still works with live tokens when manually provided.
451	            assert from_token.room_key.topological is not None
452	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:485:20
484	                    # case "JOIN" would have been returned.
485	                    assert member_event_id
486	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\pagination.py:490:20
489	                    )
490	                    assert leave_token.topological is not None
491	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:127:0
126	
127	assert LAST_ACTIVE_GRANULARITY < IDLE_TIMER
128	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1329:12
1328	        async def _process_presence() -> None:
1329	            assert not self._event_processing
1330	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1387:12
1386	        for delta in deltas:
1387	            assert room_id == delta["room_id"]
1388	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1676:12
1675	            # Make mypy happy. users_interested_in should now be a set
1676	            assert not isinstance(users_interested_in, str)
1677	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:1833:8
1832	        # without mypy complaining.
1833	        assert cache_context
1834	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\presence.py:2191:8
2190	        # This should only be called on a presence writer.
2191	        assert self._presence_writer
2192	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\profile.py:403:35
402	            # We randomly sleep a bit just to annoy the requester.
403	            await self.clock.sleep(random.randint(1, 10))
404	            return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:550:20
549	                    # If an invite is required, there must be a auto-join user ID.
550	                    assert self.hs.config.registration.auto_join_user_id
551	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\synapse\handlers\register.py:632:14
631	
632	        await self.register_with_store(
633	            user_id=user_id,
634	            password_hash="",
635	            appservice_id=service_id,
636	            create_profile_with_displayname=user.localpart,
637	        )
638	        return user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:808:8
807	        """
808	        assert not self.hs.config.worker.worker_app
809	        now_ms = self.clock.time_msec()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:840:12
839	        if is_guest:
840	            assert access_token_expiry is None
841	            access_token = self.macaroon_gen.generate_guest_access_token(user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:847:16
846	                # that this value is set before setting this flag).
847	                assert self.refreshable_access_token_lifetime is not None
848	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:936:12
935	            # The terms type should only exist if consent is enabled.
936	            assert self._user_consent_version is not None
937	            await self._on_user_consented(user_id, self._user_consent_version)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\register.py:993:12
992	            # The token better still exist.
993	            assert user_tuple
994	            token_id = user_tuple.token_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:279:8
278	        user_id = requester.user.to_string()
279	        assert self.hs.is_mine_id(user_id), "User must be our own: %s" % (user_id,)
280	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room.py:313:8
312	        # We know the tombstone event isn't an outlier so it has current state.
313	        assert old_room_state is not None
314	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room.py:791:35
790	            # We randomly sleep a bit just to annoy the requester.
791	            await self.clock.sleep(random.randint(1, 10))
792	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:56:8
55	        # is negative before the successor event.
56	        assert most_recent_prev_event_id is not None
57	        successor_event_ids = await self.store.get_successor_events(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:143:8
142	        # mapping from (type, state_key) -> state_event_id
143	        assert most_recent_event_id is not None
144	        prev_state_map = await self._state_storage_controller.get_state_ids_for_event(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:176:8
175	        """
176	        assert app_service_requester.app_service
177	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:297:8
296	        """
297	        assert app_service_requester.app_service
298	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:300:8
299	        # We expect the first event in a historical batch to be an insertion event
300	        assert events_to_create[0]["type"] == EventTypes.MSC2716_INSERTION
301	        # We expect the last event in a historical batch to be an batch event

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:302:8
301	        # We expect the last event in a historical batch to be an batch event
302	        assert events_to_create[-1]["type"] == EventTypes.MSC2716_BATCH
303	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:314:12
313	
314	            assert self.hs.is_mine_id(ev["sender"]), "User must be our own: %s" % (
315	                ev["sender"],
316	            )
317	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_batch.py:349:12
348	
349	            assert context._state_group
350	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:408:8
407	        # we know it was persisted, so should have a stream ordering
408	        assert result_event.internal_metadata.stream_ordering
409	        return result_event.event_id, result_event.internal_metadata.stream_ordering

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:511:35
510	            # We randomly sleep a bit just to annoy the requester.
511	            await self.clock.sleep(random.randint(1, 10))
512	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:767:20
766	                    # we know it was persisted, so must have a stream ordering.
767	                    assert old_state.internal_metadata.stream_ordering
768	                    return (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:1151:12
1150	            sender = UserID.from_string(event.sender)
1151	            assert (
1152	                sender == requester.user
1153	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
1154	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:1154:12
1153	            ), "Sender (%s) must be same as requester (%s)" % (sender, requester.user)
1154	            assert self.hs.is_mine(sender), "Sender must be our own: %s" % (sender,)
1155	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\room_member.py:1335:35
1334	            # We randomly sleep a bit just to annoy the requester.
1335	            await self.clock.sleep(random.randint(1, 10))
1336	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_member.py:1771:8
1770	        # we know it was persisted, so must have a stream ordering
1771	        assert result_event.internal_metadata.stream_ordering
1772	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_summary.py:381:12
380	            room_id = child_room.get("state_key")
381	            assert isinstance(room_id, str)
382	            # If the room is unknown, skip it.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\room_summary.py:704:8
703	        # there should always be an entry
704	        assert stats is not None, "unable to retrieve stats for %s" % (room_id,)
705	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:136:16
135	
136	                assert batch_group is not None
137	                assert batch_group_key is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:137:16
136	                assert batch_group is not None
137	                assert batch_group_key is not None
138	                assert batch_token is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:138:16
137	                assert batch_group_key is not None
138	                assert batch_token is not None
139	            except Exception:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:333:12
332	            # Note that before and after limit must be set in this case.
333	            assert before_limit is not None
334	            assert after_limit is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\search.py:334:12
333	            assert before_limit is not None
334	            assert after_limit is not None
335	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sso.py:213:8
212	        p_id = p.idp_id
213	        assert p_id not in self._identity_providers
214	        self._identity_providers[p_id] = p

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sso.py:563:8
562	        # Must provide either attributes or session, not both
563	        assert (attributes is not None) != (session is not None)
564	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:964:16
963	                # is indeed the case.
964	                assert since_token is not None
965	                state_at_previous_sync = await self.get_state_at(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1466:8
1465	        )
1466	        assert presence_key
1467	        sync_result_builder.now_token = now_token.copy_and_replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1618:8
1617	
1618	        assert since_token
1619	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\sync.py:1665:8
1664	
1665	        assert since_token
1666	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\typing.py:217:8
216	
217	        assert hs.get_instance_name() in hs.config.worker.writers.typing
218	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:266:35
265	            # We randomly sleep a bit just to annoy the requester.
266	            await self.clock.sleep(random.randint(1, 10))
267	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\handlers\typing.py:302:35
301	            # We randomly sleep a bit just to annoy the requester.
302	            await self.clock.sleep(random.randint(1, 10))
303	            raise ShadowBanError()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_hash'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\handlers\ui_auth\__init__.py:29:20
28	    # password, so that the client does not need to submit it each time.
29	    PASSWORD_HASH = "password_hash"
30	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.registration_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\handlers\ui_auth\__init__.py:41:25
40	    # - we can 'use up' the token after registration has successfully completed
41	    REGISTRATION_TOKEN = "m.login.registration_token"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\ui_auth\checkers.py:110:12
109	        try:
110	            assert self._secret is not None
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\handlers\ui_auth\checkers.py:171:16
170	            ):
171	                assert self.hs.config.registration.account_threepid_delegate_email
172	                threepid = await identity_handler.threepid_from_creds(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\client.py:824:12
823	            # discarded anyway.
824	            assert self.transport is not None
825	            self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\client.py:866:12
865	            # discarded anyway.
866	            assert self.transport is not None
867	            self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\federation\matrix_federation_agent.py:169:8
168	        # There must be a valid hostname.
169	        assert parsed_uri.hostname
170	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\srv_resolver.py:79:28
78	        while servers and total_weight:
79	            target_weight = random.randint(1, total_weight)
80	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:153:28
152	            # add some randomness to the TTL to avoid a stampeding herd
153	            cache_period *= random.uniform(
154	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
155	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
156	            )
157	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\federation\well_known_resolver.py:207:28
206	            # after startup
207	            cache_period *= random.uniform(
208	                1 - WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
209	                1 + WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER,
210	            )
211	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\http\matrixfederationclient.py:292:12
291	                parser.finish()
292	            except Exception:
293	                # Ignore any additional exceptions.
294	                pass
295	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:679:37
678	                            delay = min(delay, 60)
679	                            delay *= random.uniform(0.8, 1.4)
680	                        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\http\matrixfederationclient.py:683:37
682	                            delay = min(delay, 2)
683	                            delay *= random.uniform(0.8, 1.4)
684	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\http\server.py:196:12
195	                request.transport.abortConnection()
196	            except Exception:
197	                # abortConnection throws if the connection is already closed
198	                pass
199	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\server.py:595:8
594	        # We expect to get bytes for us to write
595	        assert isinstance(response_object, bytes)
596	        html_bytes = response_object

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:130:8
129	        # we should have a `content` by now.
130	        assert self.content, "handleContentChunk() called before gotLength()"
131	        if self.content.tell() + len(data) > self._max_request_body_size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:151:8
150	        # This should only be called once.
151	        assert self._requester is None
152	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:156:8
155	        # A logging context should exist by now (and have a ContextRequest).
156	        assert self.logcontext is not None
157	        assert self.logcontext.request is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:157:8
156	        assert self.logcontext is not None
157	        assert self.logcontext.request is not None
158	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:331:12
330	        if not self._is_processing:
331	            assert self.logcontext is not None
332	            with PreserveLoggingContext(self.logcontext):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:415:8
414	        """Log the completion of this request and update the metrics"""
415	        assert self.logcontext is not None
416	        assert self.finish_time is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:416:8
415	        assert self.logcontext is not None
416	        assert self.finish_time is not None
417	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\http\site.py:610:8
609	
610	        assert config.http_options is not None
611	        proxied = config.http_options.x_forwarded

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:488:12
487	            rusage = get_thread_resource_usage()
488	            assert rusage is not None
489	            utime_delta, stime_delta = self._get_cputime(rusage)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:503:8
502	        """
503	        assert self.usage_start is not None
504	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:712:8
711	    else:
712	        assert isinstance(curr_context, LoggingContext)
713	        parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\context.py:965:8
964	    else:
965	        assert isinstance(curr_context, LoggingContext)
966	        parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:412:8
411	        logger.info("Using rust_python_jaeger_reporter library")
412	        assert config.sampler is not None
413	        tracer = config.create_tracer(RustReporter(), config.sampler)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:601:4
600	    """Sets a tag on the active span"""
601	    assert opentracing.tracer.active_span is not None
602	    opentracing.tracer.active_span.set_tag(key, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:608:4
607	    """Log to the active span"""
608	    assert opentracing.tracer.active_span is not None
609	    opentracing.tracer.active_span.log_kv(key_values, timestamp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:615:4
614	    """Sets the operation name of the active span"""
615	    assert opentracing.tracer.active_span is not None
616	    opentracing.tracer.active_span.set_operation_name(operation_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:686:4
685	    carrier: Dict[str, str] = {}
686	    assert span is not None
687	    opentracing.tracer.inject(span.context, opentracing.Format.HTTP_HEADERS, carrier)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:729:4
728	    carrier: Dict[str, str] = {}
729	    assert opentracing.tracer.active_span is not None
730	    opentracing.tracer.inject(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\logging\opentracing.py:745:8
744	    if opentracing:
745	        assert opentracing.tracer.active_span is not None
746	        opentracing.tracer.inject(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\module_api\__init__.py:1012:8
1011	        # successfully persisted.
1012	        assert event is not None
1013	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\module_api\__init__.py:1247:8
1246	                is_mine = True
1247	        except Exception:
1248	            pass
1249	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\baserules.py:104:8
103	        # Only modify the actions, keep the conditions the same.
104	        assert isinstance(r["rule_id"], str)
105	        modified = modified_base_rules.get(r["rule_id"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\baserules.py:125:8
124	        # Only modify the actions, keep the conditions the same.
125	        assert isinstance(r["rule_id"], str)
126	        modified = modified_base_rules.get(r["rule_id"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\bulk_push_rule_evaluator.py:470:12
469	            # Ensure the state IDs exist.
470	            assert current_state_ids is not None
471	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:123:8
122	        """
123	        assert not self._is_processing
124	        self._is_processing = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:128:8
127	        """Used by tests to resume processing of events after pausing."""
128	        assert self._is_processing
129	        self._is_processing = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:134:8
133	        # we should never get here if we are already processing
134	        assert not self._is_processing
135	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:141:16
140	                # this is our first loop: load up the throttle params
141	                assert self.pusher_id is not None
142	                self.throttle_params = await self.store.get_throttle_params_by_room(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\emailpusher.py:315:8
314	        )
315	        assert self.pusher_id is not None
316	        await self.store.set_throttle_params(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:163:8
162	        # we should never get here if we are already processing
163	        assert not self._is_processing
164	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\httppusher.py:326:8
325	        # This was checked in the __init__, but mypy doesn't seem to know that.
326	        assert self.data is not None
327	        if self.data.get("format") == "event_id_only":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\push\push_rule_evaluator.py:51:4
50	    notif_levels = power_levels.get("notifications", {})
51	    assert isinstance(notif_levels, dict)
52	    room_notif_level = notif_levels.get(notif_level_key, 50)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:114:8
113	        # assert here that sub classes don't try and use the name.
114	        assert (
115	            "instance_name" not in self.PATH_ARGS
116	        ), "`instance_name` is a reserved parameter name"
117	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:117:8
116	        ), "`instance_name` is a reserved parameter name"
117	        assert (
118	            "instance_name"
119	            not in signature(self.__class__._serialize_payload).parameters
120	        ), "`instance_name` is a reserved parameter name"
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\_base.py:122:8
121	
122	        assert self.METHOD in ("PUT", "POST", "GET")
123	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\http\membership.py:345:8
344	        """
345	        assert change == "left"
346	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:199:16
198	                    continue
199	                assert isinstance(row, EventsStreamRow)
200	                assert isinstance(row.data, EventsStreamEventRow)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:200:16
199	                assert isinstance(row, EventsStreamRow)
200	                assert isinstance(row.data, EventsStreamEventRow)
201	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\replication\tcp\client.py:243:16
242	                        deferred.callback(None)
243	                except Exception:
244	                    # The deferred has been cancelled or timed out.
245	                    pass
246	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:340:8
339	    def __init__(self, hs: "HomeServer"):
340	        assert hs.should_send_federation()
341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:350:8
349	        sender = hs.get_federation_sender()
350	        assert isinstance(sender, FederationSender)
351	        self.federation_sender = sender

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\client.py:440:8
439	        # We should only be calling this once we've got a token.
440	        assert self.federation_position is not None
441	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'batch'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\replication\tcp\commands.py:141:29
140	            instance_name,
141	            None if token == "batch" else int(token),
142	            json_decoder.decode(row_json),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:305:8
304	        """
305	        assert stream_name not in self._processing_streams
306	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\handler.py:461:12
460	        if self._is_master:
461	            assert self._server_notices_sender is not None
462	            await self._server_notices_sender.on_user_ip(cmd.user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:200:8
199	
200	        assert self.transport is not None
201	        self.transport.registerProducer(self, True)  # For the *Producing callbacks

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:225:16
224	                )
225	                assert self.transport is not None
226	                self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:315:8
314	        self.time_we_closed = self.clock.time_msec()
315	        assert self.transport is not None
316	        self.transport.loseConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\protocol.py:413:12
412	        if isinstance(reason, Failure):
413	            assert reason.type is not None
414	            connection_close_counter.labels(reason.type.__name__).inc()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\resource.py:94:8
93	        # If we have streams then we must have redis enabled or on master
94	        assert (
95	            not self.streams
96	            or hs.config.redis.redis_enabled
97	            or not hs.config.worker.worker_app
98	        )
99	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\streams\_base.py:278:12
277	
278	            assert isinstance(presence_handler, PresenceHandler)
279	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\replication\tcp\streams\events.py:173:8
172	        # that we know it is safe to just take upper_limit = event_rows[-1][0].
173	        assert (
174	            len(event_rows) <= target_row_count
175	        ), "get_all_new_forward_event_rows did not honour row limit"
176	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\__init__.py:143:12
142	            # RoomStreamToken expects [int] not Optional[int]
143	            assert event.internal_metadata.stream_ordering is not None
144	            room_token = RoomStreamToken(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\media.py:360:8
359	        # This will always be set by the time Twisted calls us.
360	        assert request.args is not None
361	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\media.py:418:8
417	        # This will always be set by the time Twisted calls us.
418	        assert request.args is not None
419	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\rooms.py:460:8
459	        # This will always be set by the time Twisted calls us.
460	        assert request.args is not None
461	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:347:12
346	            user = await self.admin_handler.get_user(target_user)
347	            assert user is not None
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:408:12
407	            user_info_dict = await self.admin_handler.get_user(target_user)
408	            assert user_info_dict is not None
409	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\admin\users.py:1104:8
1103	        ratelimit = await self.store.get_ratelimit_for_user(user_id)
1104	        assert ratelimit is not None
1105	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\account.py:127:48
126	                # look like we did something.
127	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
128	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\account.py:133:12
132	        if self.config.email.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
133	            assert self.hs.config.registration.account_threepid_delegate_email
134	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\account.py:411:48
410	                # look like we did something.
411	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
412	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\account.py:417:12
416	        if self.config.email.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
417	            assert self.hs.config.registration.account_threepid_delegate_email
418	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\account.py:494:48
493	                # look like we did something.
494	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
495	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'm.login.token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\rest\client\login.py:70:17
69	    SSO_TYPE = "m.login.sso"
70	    TOKEN_TYPE = "m.login.token"
71	    JWT_TYPE = "org.matrix.login.jwt"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'refresh_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\rest\client\login.py:73:26
72	    APPSERVICE_TYPE = "m.login.application_service"
73	    REFRESH_TOKEN_PARAM = "refresh_token"
74	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\register.py:136:48
135	                # look like we did something.
136	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
137	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\register.py:142:12
141	        if self.config.email.threepid_behaviour_email == ThreepidBehaviour.REMOTE:
142	            assert self.hs.config.registration.account_threepid_delegate_email
143	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\rest\client\register.py:216:48
215	                # look like we did something.
216	                await self.hs.get_clock().sleep(random.randint(1, 10) / 10)
217	                return 200, {"sid": random_string(16)}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\room.py:267:8
266	        # Twisted will have processed the args by now.
267	        assert request.args is not None
268	        if b"ts" in request.args and requester.app_service:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\room.py:571:8
570	        # Twisted will have processed the args by now.
571	        assert request.args is not None
572	        as_client_event = b"raw" not in request.args

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\room_batch.py:98:8
97	
98	        assert request.args is not None
99	        prev_event_ids_from_query = parse_strings_from_args(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\sync.py:106:8
105	        # This will always be set by the time Twisted calls us.
106	        assert request.args is not None
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\sync.py:508:12
507	        if joined:
508	            assert isinstance(room, JoinedSyncResult)
509	            ephemeral_events = room.ephemeral

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\client\transactions.py:66:8
65	        """
66	        assert request.path is not None
67	        token = self.auth.get_access_token_from_request(request)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\key\v2\remote_key_resource.py:105:8
104	    async def _async_render_GET(self, request: SynapseRequest) -> None:
105	        assert request.postpath is not None
106	        if len(request.postpath) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\_base.py:70:8
69	        postpath: List[bytes] = request.postpath  # type: ignore
70	        assert postpath
71	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\filepath.py:162:8
161	        # platform.
162	        assert os.path.sep not in ALLOWED_CHARACTERS
163	        assert os.path.altsep not in ALLOWED_CHARACTERS

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\filepath.py:163:8
162	        assert os.path.sep not in ALLOWED_CHARACTERS
163	        assert os.path.altsep not in ALLOWED_CHARACTERS
164	        # On Windows, paths have all sorts of weirdness which `_validate_path_component`

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\filepath.py:167:8
166	        # for certain homeservers there, since ":"s aren't allowed in paths.
167	        assert os.name == "posix"
168	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\media_storage.py:167:12
166	                os.remove(fname)
167	            except Exception:
168	                pass
169	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\oembed.py:25:4
24	if TYPE_CHECKING:
25	    from lxml import etree
26	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\oembed.py:231:4
230	
231	    from lxml import etree
232	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\synapse\rest\media\v1\oembed.py:237:11
236	    # Attempt to parse the body. If this fails, log and return no metadata.
237	    tree = etree.fromstring(html_body, parser)
238	

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_html.py:21:4
20	if TYPE_CHECKING:
21	    from lxml import etree
22	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\rest\media\v1\preview_html.py:131:8
130	            body.decode(encoding)
131	        except Exception:
132	            pass
133	        else:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_html.py:139:4
138	
139	    from lxml import etree
140	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\synapse\rest\media\v1\preview_html.py:146:11
145	    # parsed, but no tree was found.
146	    return etree.fromstring(body, parser)
147	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_html.py:249:8
248	        # This must be a non-empty string at this point.
249	        assert isinstance(og["og:description"], str)
250	        og["og:description"] = summarize_paragraphs([og["og:description"]])

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\synapse\rest\media\v1\preview_html.py:277:4
276	
277	    from lxml import etree
278	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\synapse\rest\media\v1\preview_url_resource.py:477:17
476	            logger.debug("Trying to parse data url '%s'", url)
477	            with urlopen(url) as url_info:
478	                # TODO Can this be more efficient.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\preview_url_resource.py:675:8
674	
675	        assert self._worker_run_media_background_jobs
676	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\thumbnail_resource.py:324:12
323	            # The thumbnail property must exist.
324	            assert file_info.thumbnail is not None
325	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\thumbnailer.py:80:16
79	                image_orientation = image_exif.get(EXIF_ORIENTATION_TAG)
80	                assert isinstance(image_orientation, int)
81	                self.transpose_method = EXIF_TRANSPOSE_MAPPINGS.get(image_orientation)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\media\v1\upload_resource.py:85:12
84	            content_type_headers = headers.getRawHeaders(b"Content-Type")
85	            assert content_type_headers  # for mypy
86	            media_type = content_type_headers[0].decode("ascii")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\synapse\client\password_reset.py:63:8
62	        # This resource should not be mounted if threepid behaviour is not LOCAL
63	        assert hs.config.email.threepid_behaviour_email == ThreepidBehaviour.LOCAL
64	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\rest\synapse\client\pick_username.py:118:8
117	        # This will always be set by the time Twisted calls us.
118	        assert request.args is not None
119	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server.py:790:8
789	        """
790	        assert self.config.redis.redis_enabled
791	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\consent_server_notices.py:69:8
68	        # A consent version must be given.
69	        assert self._current_consent_version is not None
70	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:71:8
70	
71	        assert self.server_notices_mxid is not None
72	        requester = create_requester(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:138:8
137	
138	        assert self._is_mine_id(user_id), "Cannot send server notices to remote users"
139	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:205:8
204	        """
205	        assert self.server_notices_mxid is not None
206	        requester = create_requester(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:244:8
243	
244	        assert self.server_notices_mxid is not None
245	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\server_notices\server_notices_manager.py:253:8
252	
253	        assert notice_user_data_in_room is not None
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:169:8
168	
169	        assert latest_event_ids is not None
170	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:215:8
214	
215	        assert not event.internal_metadata.is_outlier()
216	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\state\__init__.py:233:12
232	            # we work it out dynamically
233	            assert not partial_state
234	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\synapse\state\v1.py:369:30
368	        # people to send us events with non-ascii event IDs :/
369	        return -int(e.depth), hashlib.sha1(e.event_id.encode("utf-8")).hexdigest()
370	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\background_updates.py:412:8
411	        # early.
412	        assert self._current_background_update is not None
413	        update_info = self._background_update_handlers[self._current_background_update]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\background_updates.py:426:8
425	    async def _do_background_update(self, desired_duration_ms: float) -> int:
426	        assert self._current_background_update is not None
427	        update_name = self._current_background_update

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\controllers\persist_events.py:289:8
288	
289	        assert stores.persist_events
290	        self.persist_events_store = stores.persist_events

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\controllers\persist_events.py:379:8
378	        # stream ordering should have been assigned by now
379	        assert event_stream_id
380	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\controllers\persist_events.py:533:24
532	                        # extremities, so we'll `continue` above and skip this bit.)
533	                        assert new_latest_event_ids, "No forward extremities left!"
534	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\controllers\persist_events.py:588:28
587	                            # extremities, so we'll `continue` above and skip this bit.)
588	                            assert new_latest_event_ids, "No forward extremities left!"
589	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:275:8
274	        # is not the case.
275	        assert self.after_callbacks is not None
276	        # type-ignore: need mypy containing https://github.com/python/mypy/pull/12668

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:294:8
293	        # is not the case.
294	        assert self.exception_callbacks is not None
295	        # type-ignore: need mypy containing https://github.com/python/mypy/pull/12668

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:343:8
342	        """
343	        assert isinstance(self.database_engine, PostgresEngine)
344	        from psycopg2.extras import execute_values

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\database.py:380:12
379	                sql_logger.debug("[SQL values] {%s} %r", self.name, args[0])  # type: ignore[index]
380	            except Exception:
381	                # Don't let logging failures stop SQL from working
382	                pass
383	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:867:12
866	        else:
867	            assert isinstance(curr_context, LoggingContext)
868	            parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:878:12
877	            # pool).
878	            assert not self.engine.in_transaction(conn)
879	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\database.py:942:8
941	        """
942	        assert cursor.description is not None, "cursor.description was None"
943	        col_headers = [intern(str(column[0])) for column in cursor.description]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1063:18
1062	            # but it's only available on postgres.
1063	            sql = "INSERT INTO %s (%s) VALUES ?" % (
1064	                table,
1065	                ", ".join(k for k in keys),
1066	            )
1067	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1221:18
1220	            # SELECT instead to see if it exists.
1221	            sql = "SELECT 1 FROM %s WHERE %s" % (
1222	                table,
1223	                " AND ".join(_getwhere(k) for k in keyvalues),
1224	            )
1225	            sqlargs = list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1232:18
1231	            # First try to update.
1232	            sql = "UPDATE %s SET %s WHERE %s" % (
1233	                table,
1234	                ", ".join("%s = ?" % (k,) for k in values),
1235	                " AND ".join(_getwhere(k) for k in keyvalues),
1236	            )
1237	            sqlargs = list(values.values()) + list(keyvalues.values())

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1249:14
1248	
1249	        sql = "INSERT INTO %s (%s) VALUES (%s)" % (
1250	            table,
1251	            ", ".join(k for k in allvalues),
1252	            ", ".join("?" for _ in allvalues),
1253	        )
1254	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1287:21
1286	            allvalues.update(values)
1287	            latter = "UPDATE SET " + ", ".join(k + "=EXCLUDED." + k for k in values)
1288	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1289:15
1288	
1289	        sql = ("INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s") % (
1290	            table,
1291	            ", ".join(k for k in allvalues),
1292	            ", ".join("?" for _ in allvalues),
1293	            ", ".join(k for k in keyvalues),
1294	            latter,
1295	        )
1296	        txn.execute(sql, list(allvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1442:21
1441	        else:
1442	            latter = "UPDATE SET " + ", ".join(
1443	                k + "=EXCLUDED." + k for k in value_names
1444	            )
1445	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1454:18
1453	            # but it's only available on postgres.
1454	            sql = "INSERT INTO %s (%s) VALUES ? ON CONFLICT (%s) DO %s" % (
1455	                table,
1456	                ", ".join(k for k in allnames),
1457	                ", ".join(key_names),
1458	                latter,
1459	            )
1460	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1464:18
1463	        else:
1464	            sql = "INSERT INTO %s (%s) VALUES (%s) ON CONFLICT (%s) DO %s" % (
1465	                table,
1466	                ", ".join(k for k in allnames),
1467	                ", ".join("?" for _ in allnames),
1468	                ", ".join(key_names),
1469	                latter,
1470	            )
1471	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1628:15
1627	    ) -> List[Any]:
1628	        sql = ("SELECT %(retcol)s FROM %(table)s") % {"retcol": retcol, "table": table}
1629	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1716:18
1715	        if keyvalues:
1716	            sql = "SELECT %s FROM %s WHERE %s" % (
1717	                ", ".join(retcols),
1718	                table,
1719	                " AND ".join("%s = ?" % (k,) for k in keyvalues),
1720	            )
1721	            txn.execute(sql, list(keyvalues.values()))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1723:18
1722	        else:
1723	            sql = "SELECT %s FROM %s" % (", ".join(retcols), table)
1724	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1805:14
1804	
1805	        sql = "SELECT %s FROM %s WHERE %s" % (
1806	            ", ".join(retcols),
1807	            table,
1808	            " AND ".join(clauses),
1809	        )
1810	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1837:21
1836	
1837	        update_sql = "UPDATE %s SET %s %s" % (
1838	            table,
1839	            ", ".join("%s = ?" % (k,) for k in updatevalues),
1840	            where,
1841	        )
1842	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1921:14
1920	        # UPDATE mytable SET col1 = ?, col2 = ? WHERE col3 = ? AND col4 = ?
1921	        sql = f"""
1922	            UPDATE {table} SET {set_clause} {where_clause}
1923	        """
1924	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:1979:21
1978	    ) -> Optional[Dict[str, Any]]:
1979	        select_sql = "SELECT %s FROM %s WHERE %s" % (
1980	            ", ".join(retcols),
1981	            table,
1982	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
1983	        )
1984	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2027:14
2026	        """
2027	        sql = "DELETE FROM %s WHERE %s" % (
2028	            table,
2029	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
2030	        )
2031	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2072:14
2071	        """
2072	        sql = "DELETE FROM %s WHERE %s" % (
2073	            table,
2074	            " AND ".join("%s = ?" % (k,) for k in keyvalues),
2075	        )
2076	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2141:14
2140	
2141	        sql = "DELETE FROM %s" % table
2142	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2177:14
2176	        # add one to the returned minimum stream ID to ensure correctness.
2177	        sql = f"""
2178	            SELECT {entity_column}, {stream_column}
2179	            FROM {table}
2180	            ORDER BY {stream_column} DESC
2181	            LIMIT ?
2182	        """
2183	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2264:14
2263	
2264	        sql = "SELECT %s FROM %s %s ORDER BY %s %s LIMIT ? OFFSET ?" % (
2265	            ", ".join(retcols),
2266	            table,
2267	            where_clause,
2268	            orderby,
2269	            order_direction,
2270	        )
2271	        txn.execute(sql, arg_list + [limit, start])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\database.py:2329:18
2328	        if term:
2329	            sql = "SELECT %s FROM %s WHERE %s LIKE ?" % (", ".join(retcols), table, col)
2330	            termvalues = ["%%" + term + "%%"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:456:8
455	        """
456	        assert self._can_write_to_account_data
457	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:457:8
456	        assert self._can_write_to_account_data
457	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)
458	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:499:8
498	        """
499	        assert self._can_write_to_account_data
500	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\account_data.py:500:8
499	        assert self._can_write_to_account_data
500	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)
501	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\appservice.py:433:16
432	                # We do NOT want to escape `stream_id_type`.
433	                "SELECT %s FROM application_services_state WHERE as_id=?"
434	                % stream_id_type,
435	                (service.id,),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\cache.py:163:12
162	        if row.type == EventsStreamEventRow.TypeId:
163	            assert isinstance(data, EventsStreamEventRow)
164	            self._invalidate_caches_for_event(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\cache.py:175:12
174	        elif row.type == EventsStreamCurrentStateRow.TypeId:
175	            assert isinstance(data, EventsStreamCurrentStateRow)
176	            self._curr_state_delta_stream_cache.entity_has_changed(data.room_id, token)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\client_ips.py:212:16
211	            else:
212	                assert end_last_seen is not None
213	                clause = "? <= last_seen AND last_seen < ?"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:220:16
219	            txn.execute(
220	                """
221	                SELECT user_id, access_token, ip,
222	                       MAX(device_id), MAX(user_agent), MAX(last_seen),
223	                       COUNT(*)
224	                FROM (
225	                    SELECT DISTINCT user_id, access_token, ip
226	                    FROM user_ips
227	                    WHERE {}
228	                ) c
229	                INNER JOIN user_ips USING (user_id, access_token, ip)
230	                GROUP BY user_id, access_token, ip
231	                HAVING count(*) > 1
232	                """.format(
233	                    clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\client_ips.py:353:18
352	
353	            sql = """
354	                SELECT
355	                    last_seen, ip, user_agent, user_id, device_id
356	                FROM (
357	                    SELECT
358	                        user_id, device_id, MAX(u.last_seen) AS last_seen
359	                    FROM devices
360	                    INNER JOIN user_ips AS u USING (user_id, device_id)
361	                    WHERE %(where_clause)s
362	                    GROUP BY user_id, device_id
363	                    ORDER BY user_id ASC, device_id ASC
364	                    LIMIT ?
365	                ) c
366	                INNER JOIN user_ips AS u USING (user_id, device_id, last_seen)
367	            """ % {
368	                "where_clause": where_clause
369	            }
370	            txn.execute(sql, where_args + [batch_size])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\client_ips.py:608:8
607	    async def _update_client_ips_batch(self) -> None:
608	        assert (
609	            self._update_on_this_worker
610	        ), "This worker is not designated to update client IPs"
611	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\client_ips.py:629:8
628	    ) -> None:
629	        assert (
630	            self._update_on_this_worker
631	        ), "This worker is not designated to update client IPs"
632	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:140:12
139	            # If replication is happening than postgres must be being used.
140	            assert isinstance(self._device_inbox_id_gen, MultiWriterIdGenerator)
141	            self._device_inbox_id_gen.advance(instance_name, token)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:187:8
186	
187	        assert (
188	            last_processed_stream_id == to_stream_id
189	        ), "Expected _get_device_messages to process all to-device messages up to `to_stream_id`"
190	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:361:18
360	
361	            sql = f"""
362	                SELECT stream_id, user_id, device_id, message_json FROM device_inbox
363	                WHERE {user_id_many_clause_sql}
364	                AND {device_id_many_clause_sql}
365	                AND ? < stream_id AND stream_id <= ?
366	                ORDER BY stream_id ASC
367	            """
368	            sql_args = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:646:8
645	
646	        assert self._can_write_to_device
647	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:708:8
707	    ) -> int:
708	        assert self._can_write_to_device
709	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\deviceinbox.py:763:8
762	    ) -> None:
763	        assert self._can_write_to_device
764	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\devices.py:354:12
353	            )
354	            assert remaining_length_budget >= 0
355	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\devices.py:784:18
783	
784	            sql = f"""
785	                SELECT DISTINCT user_id FROM device_lists_stream
786	                WHERE {stream_id_where_clause}
787	                AND
788	            """
789	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\devices.py:1286:18
1285	            )
1286	            sql = """
1287	                SELECT stream_id, destination, user_id, device_id, MAX(ts) AS ts
1288	                FROM device_lists_outbound_pokes
1289	                WHERE %s
1290	                GROUP BY %s
1291	                HAVING count(*) > 1
1292	                ORDER BY %s
1293	                LIMIT ?
1294	                """ % (
1295	                clause,  # WHERE
1296	                ",".join(KEY_COLS),  # GROUP BY
1297	                ",".join(KEY_COLS),  # ORDER BY
1298	            )
1299	            txn.execute(sql, args + [batch_size])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\directory.py:190:18
189	
190	            sql = "UPDATE room_aliases SET room_id = ? %s WHERE room_id = ?" % (
191	                update_creator_sql,
192	            )
193	            txn.execute(sql, sql_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\e2e_room_keys.py:281:14
280	
281	        sql = """
282	        SELECT room_id, session_id, first_message_index, forwarded_count,
283	               is_verified, session_data
284	        FROM e2e_room_keys
285	        WHERE user_id = ? AND version = ? AND (%s)
286	        """ % (
287	            " OR ".join(where_clauses)
288	        )
289	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\e2e_room_keys.py:418:12
417	            )
418	            assert result is not None  # see comment on `simple_select_one_txn`
419	            result["auth_data"] = db_to_json(result["auth_data"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:227:16
226	                # data.
227	                assert target_device_result is not None
228	                assert target_device_result.keys is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:228:16
227	                assert target_device_result is not None
228	                assert target_device_result.keys is not None
229	                target_device_signatures = target_device_result.keys.setdefault(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:273:12
272	        sql = (
273	            "SELECT user_id, device_id, "
274	            "    d.display_name, "
275	            "    k.key_json"
276	            " FROM devices d"
277	            "    %s JOIN e2e_device_keys_json k USING (user_id, device_id)"
278	            " WHERE %s AND NOT d.hidden"
279	        ) % (
280	            "LEFT" if include_all_devices else "INNER",
281	            " OR ".join("(" + q + ")" for q in query_clauses),
282	        )
283	
284	        txn.execute(sql, query_params)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:319:24
318	
319	        signature_sql = """
320	            SELECT user_id, key_id, target_device_id, signature
321	            FROM e2e_cross_signing_signatures WHERE %s
322	            """ % (
323	            " OR ".join("(" + q + ")" for q in signature_query_clauses)
324	        )
325	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:466:18
465	            )
466	            sql = f"""
467	                SELECT user_id, device_id, algorithm, COUNT(key_id)
468	                FROM devices
469	                LEFT JOIN e2e_one_time_keys_json USING (user_id, device_id)
470	                WHERE {user_in_where_clause}
471	                GROUP BY user_id, device_id, algorithm
472	            """
473	            txn.execute(sql, user_parameters)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:521:18
520	            # when all keys are used (as opposed to just when there are no keys at all).
521	            sql = f"""
522	                SELECT devices.user_id, devices.device_id, algorithm
523	                FROM devices
524	                LEFT JOIN e2e_fallback_keys_json AS fallback_keys
525	                    ON devices.user_id = fallback_keys.user_id
526	                    AND devices.device_id = fallback_keys.device_id
527	                    AND NOT fallback_keys.used
528	                WHERE
529	                    {user_in_where_clause}
530	            """
531	            txn.execute(sql, user_parameters)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:732:22
731	                # the latest key.
732	                sql = """
733	                    SELECT DISTINCT ON (user_id, keytype) user_id, keytype, keydata, stream_id
734	                        FROM e2e_cross_signing_keys
735	                        WHERE %(clause)s
736	                        ORDER BY user_id, keytype, stream_id DESC
737	                """ % {
738	                    "clause": clause
739	                }
740	            else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:744:22
743	                # a row that matches the MIN/MAX.
744	                sql = """
745	                    SELECT user_id, keytype, keydata, MAX(stream_id)
746	                        FROM e2e_cross_signing_keys
747	                        WHERE %(clause)s
748	                        GROUP BY user_id, keytype
749	                """ % {
750	                    "clause": clause
751	                }
752	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:801:16
800	                # See https://spec.matrix.org/v1.1/client-server-api/#cross-signing
801	                assert isinstance(device_id, str)
802	                devices[(user_id, device_id)] = key_type

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:805:18
804	        for batch in batch_iter(devices.keys(), size=100):
805	            sql = """
806	                SELECT target_user_id, target_device_id, key_id, signature
807	                  FROM e2e_cross_signing_signatures
808	                 WHERE user_id = ?
809	                   AND (%s)
810	            """ % (
811	                " OR ".join(
812	                    "(target_user_id = ? AND target_device_id = ?)" for _ in batch
813	                )
814	            )
815	            query_params = [from_user_id]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\end_to_end_keys.py:835:16
834	                # users with keys
835	                assert user_keys is not None
836	                user_keys = keys[target_user_id] = user_keys.copy()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_federation.py:926:18
925	
926	            sql = """
927	                SELECT room_id FROM event_forward_extremities
928	                WHERE %s
929	                GROUP BY room_id
930	                HAVING count(*) > ?
931	                ORDER BY count(*) DESC
932	                LIMIT ?
933	            """ % (
934	                where_clause,
935	            )
936	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\event_push_actions.py:785:12
784	            (offset_stream_ordering,) = stream_row
785	            assert self.stream_ordering_day_ago is not None
786	            rotate_to_stream_ordering = min(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\event_push_actions.py:1028:16
1027	            sql = (
1028	                "SELECT epa.event_id, epa.room_id,"
1029	                " epa.stream_ordering, epa.topological_ordering,"
1030	                " epa.actions, epa.highlight, epa.profile_tag, e.received_ts"
1031	                " FROM event_push_actions epa, events e"
1032	                " WHERE epa.event_id = e.event_id"
1033	                " AND epa.user_id = ? %s"
1034	                " AND epa.notif = 1"
1035	                " ORDER BY epa.stream_ordering DESC"
1036	                " LIMIT ?" % (before_clause,)
1037	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:114:8
113	        # This should only exist on instances that are configured to write
114	        assert (
115	            hs.get_instance_name() in hs.config.worker.writers.events
116	        ), "Can only instantiate EventsStore on master"
117	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:120:8
119	        # rather than id trackers.
120	        assert isinstance(self.store._backfill_id_gen, AbstractStreamIdGenerator)
121	        assert isinstance(self.store._stream_id_gen, AbstractStreamIdGenerator)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:121:8
120	        assert isinstance(self.store._backfill_id_gen, AbstractStreamIdGenerator)
121	        assert isinstance(self.store._stream_id_gen, AbstractStreamIdGenerator)
122	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:381:8
380	        # stream orderings should have been assigned by now
381	        assert min_stream_order
382	        assert max_stream_order

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:382:8
381	        assert min_stream_order
382	        assert max_stream_order
383	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:1275:12
1274	            # need to update the stream_ordering tip/front for the room.
1275	            assert event.internal_metadata.stream_ordering is not None
1276	            if event.internal_metadata.stream_ordering >= 0:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events.py:1309:12
1308	        txn.execute(
1309	            "SELECT event_id, outlier FROM events WHERE event_id in (%s)"
1310	            % (",".join(["?"] * len(events_and_contexts)),),
1311	            [event.event_id for event, _ in events_and_contexts],

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:1655:8
1654	        """
1655	        assert event.redacts is not None
1656	        txn.call_after(self.store._invalidate_get_event_cache, event.redacts)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:1759:12
1758	        for event in events:
1759	            assert event.internal_metadata.stream_ordering is not None
1760	            txn.call_after(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events.py:2405:8
2404	
2405	        assert src_chain != target_chain
2406	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\events_bg_updates.py:956:14
955	
956	        sql = """
957	            SELECT
958	                event_id, state_events.type, state_events.state_key,
959	                topological_ordering, stream_ordering,
960	                events.room_id
961	            FROM events
962	            INNER JOIN state_events USING (event_id)
963	            LEFT JOIN event_auth_chains USING (event_id)
964	            LEFT JOIN event_auth_chain_to_calculate USING (event_id)
965	            WHERE event_auth_chains.event_id IS NULL
966	                AND event_auth_chain_to_calculate.event_id IS NULL
967	                AND %(tuple_cmp)s
968	                %(extra)s
969	            ORDER BY events.room_id, topological_ordering, stream_ordering
970	            %(limit)s
971	        """ % {
972	            "tuple_cmp": tuple_clause,
973	            "limit": "LIMIT ?" if batch_size is not None else "",
974	            "extra": extra_clause,
975	        }
976	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:499:16
498	            if not allow_rejected:
499	                assert not entry.event.rejected_reason, (
500	                    "rejected event returned from _get_events_from_cache_or_db despite "
501	                    "allow_rejected=False"
502	                )
503	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:807:8
806	        # non-None.
807	        assert current_state_ids is not None
808	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:908:16
907	                # Fail any outstanding fetches since no one else will handle them.
908	                assert exc is not None
909	                with PreserveLoggingContext():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:1030:12
1029	        for event_id, row in fetched_events.items():
1030	            assert row.event_id == event_id
1031	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\events_worker.py:1704:8
1703	        # of the last row in the result.
1704	        assert rows[-1][0] <= to_token
1705	        to_token = rows[-1][0] - 1

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:66:16
65	            sql = (
66	                "SELECT server_name, key_id, verify_key, ts_valid_until_ms "
67	                "FROM server_signature_keys WHERE 1=0"
68	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
69	
70	            txn.execute(sql, tuple(itertools.chain.from_iterable(batch)))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\keys.py:68:16
67	                "FROM server_signature_keys WHERE 1=0"
68	            ) + " OR (server_name=? AND key_id=?)" * len(batch)
69	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\media_repository.py:226:18
225	
226	            sql = """
227	                SELECT
228	                    "media_id",
229	                    "media_type",
230	                    "media_length",
231	                    "upload_name",
232	                    "created_ts",
233	                    "last_access_ts",
234	                    "quarantined_by",
235	                    "safe_from_quarantine"
236	                FROM local_media_repository
237	                WHERE user_id = ?
238	                ORDER BY {order_by_column} {order}, media_id ASC
239	                LIMIT ? OFFSET ?
240	            """.format(
241	                order_by_column=order_by_column,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\media_repository.py:297:23
296	        if keep_profiles:
297	            sql_keep = """
298	                AND (
299	                    NOT EXISTS
300	                        (SELECT 1
301	                         FROM profiles
302	                         WHERE profiles.avatar_url = '{media_prefix}' || lmr.media_id)
303	                    AND NOT EXISTS
304	                        (SELECT 1
305	                         FROM room_memberships
306	                         WHERE room_memberships.avatar_url = '{media_prefix}' || lmr.media_id)
307	                    AND NOT EXISTS
308	                        (SELECT 1
309	                         FROM user_directory
310	                         WHERE user_directory.avatar_url = '{media_prefix}' || lmr.media_id)
311	                    AND NOT EXISTS
312	                        (SELECT 1
313	                         FROM room_stats_state
314	                         WHERE room_stats_state.avatar = '{media_prefix}' || lmr.media_id)
315	                )
316	            """.format(
317	                media_prefix="mxc://%s/" % (self.server_name,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:158:18
157	        def _list_users(txn: LoggingTransaction) -> List[Tuple[str, str]]:
158	            sql = f"""
159	                    SELECT COALESCE(appservice_id, 'native'), user_id
160	                    FROM monthly_active_users
161	                    LEFT JOIN users ON monthly_active_users.user_id=users.name
162	                    {where_clause};
163	                """
164	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:229:16
228	            txn.execute(
229	                "DELETE FROM monthly_active_users WHERE timestamp < ? AND NOT %s"
230	                % (in_clause,),
231	                [thirty_days_ago] + in_clause_args,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:252:22
251	                # SELECT, meaning that a legitimate mau is deleted.
252	                sql = """
253	                    DELETE FROM monthly_active_users
254	                    WHERE user_id NOT IN (
255	                        SELECT user_id FROM monthly_active_users
256	                        WHERE NOT %s
257	                        ORDER BY timestamp DESC
258	                        LIMIT ?
259	                    )
260	                    AND NOT %s
261	                """ % (
262	                    in_clause,
263	                    in_clause,
264	                )
265	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:300:8
299	        """
300	        assert (
301	            self._update_on_this_worker
302	        ), "This worker is not designated to update MAUs"
303	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:336:8
335	        """
336	        assert (
337	            self._update_on_this_worker
338	        ), "This worker is not designated to update MAUs"
339	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:375:8
374	        """
375	        assert (
376	            self._update_on_this_worker
377	        ), "This worker is not designated to update MAUs"
378	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\monthly_active_users.py:405:8
404	        """
405	        assert (
406	            self._update_on_this_worker
407	        ), "This worker is not designated to update MAUs"
408	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\presence.py:110:8
109	    ) -> Tuple[int, int]:
110	        assert self._can_persist_presence
111	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:138:12
137	        txn.execute(
138	            "INSERT INTO events_to_purge"
139	            " SELECT event_id, %s"
140	            " FROM events AS e LEFT JOIN state_events USING (event_id)"
141	            " WHERE (NOT outlier OR (%s)) AND e.room_id = ? AND topological_ordering < ?"
142	            % (should_delete_expr, should_delete_expr),
143	            should_delete_params,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:230:16
229	            txn.execute(
230	                "DELETE FROM %s WHERE event_id IN ("
231	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
232	                ")" % (table,)
233	            )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:241:16
240	            txn.execute(
241	                "DELETE FROM %s WHERE room_id = ? AND event_id IN ("
242	                "    SELECT event_id FROM events_to_purge WHERE should_delete"
243	                ")" % (table,),
244	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:376:16
375	            txn.execute(
376	                """
377	                DELETE FROM %s WHERE event_id IN (
378	                  SELECT event_id FROM events WHERE room_id=?
379	                )
380	                """
381	                % (table,),
382	                (room_id,),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\purge_events.py:422:24
421	            logger.info("[purge] removing %s from %s", room_id, table)
422	            txn.execute("DELETE FROM %s WHERE room_id=?" % (table,), (room_id,))
423	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\push_rule.py:675:16
674	            sql = (
675	                """
676	                SELECT 1 FROM push_rules
677	                WHERE user_name = ? AND rule_id = ?
678	                %s
679	            """
680	                % for_key_share
681	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:617:8
616	        """
617	        assert self._can_write_to_receipts
618	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:744:8
743	        """
744	        assert self._can_write_to_receipts
745	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\receipts.py:804:8
803	    ) -> None:
804	        assert self._can_write_to_receipts
805	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\registration.py:1126:8
1125	
1126	        assert address or sid
1127	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:1131:18
1130	        ) -> Optional[Dict[str, Any]]:
1131	            sql = """
1132	                SELECT address, session_id, medium, client_secret,
1133	                last_send_attempt, validated_at
1134	                FROM threepid_validation_session WHERE %s
1135	                """ % (
1136	                " AND ".join("%s = ?" % k for k in keyvalues.keys()),
1137	            )
1138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\registration.py:1242:8
1241	        now_ms = self._clock.time_msec()
1242	        assert self._account_validity_period is not None
1243	        expiration_ts = now_ms + self._account_validity_period

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\registration.py:1246:12
1245	        if use_delta:
1246	            assert self._account_validity_startup_job_max_delta is not None
1247	            expiration_ts = random.randrange(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\storage\databases\main\registration.py:1247:28
1246	            assert self._account_validity_startup_job_max_delta is not None
1247	            expiration_ts = random.randrange(
1248	                int(expiration_ts - self._account_validity_startup_job_max_delta),
1249	                expiration_ts,
1250	            )
1251	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\storage\databases\main\registration.py:1504:28
1503	            # Generate token
1504	            token = "".join(random.choices(chars, k=length))
1505	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:2310:16
2309	            txn.execute(
2310	                "SELECT token, id, device_id FROM access_tokens WHERE %s"
2311	                % where_clause,
2312	                values,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:2321:24
2320	
2321	            txn.execute("DELETE FROM access_tokens WHERE %s" % where_clause, values)
2322	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\registration.py:2324:16
2323	            txn.execute(
2324	                "DELETE FROM refresh_tokens WHERE %s" % refresh_where_clause,
2325	                refresh_values,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\relations.py:94:8
93	        # it. The `event_id` must match the `event.event_id`.
94	        assert event.event_id == event_id
95	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:130:14
129	
130	        sql = """
131	            SELECT event_id, relation_type, sender, topological_ordering, stream_ordering
132	            FROM event_relations
133	            INNER JOIN events USING (event_id)
134	            WHERE %s
135	            ORDER BY topological_ordering %s, stream_ordering %s
136	            LIMIT ?
137	        """ % (
138	            " AND ".join(where_clause),
139	            order,
140	            order,
141	        )
142	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:333:14
332	
333	        sql = f"""
334	            SELECT type, aggregation_key, COUNT(DISTINCT sender)
335	            FROM event_relations
336	            INNER JOIN events USING (event_id)
337	            WHERE relates_to_id = ? AND room_id = ? AND relation_type = ? AND {users_sql}
338	            GROUP BY relation_type, type, aggregation_key
339	            ORDER BY COUNT(*) DESC
340	            LIMIT ?
341	        """
342	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\relations.py:802:14
801	
802	        sql = f"""
803	            SELECT DISTINCT relation_type, sender, type FROM event_relations
804	            INNER JOIN events USING (event_id)
805	            WHERE relates_to_id = ? AND {rel_type_sql}
806	        """
807	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\room.py:225:20
224	                    query_args.append(network_tuple.appservice_id)
225	                    assert network_tuple.network_id is not None
226	                    query_args.append(network_tuple.network_id)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:237:18
236	
237	            sql = f"""
238	                SELECT
239	                    COUNT(*)
240	                FROM (
241	                    {published_sql}
242	                ) published
243	                INNER JOIN room_stats_state USING (room_id)
244	                INNER JOIN room_stats_current USING (room_id)
245	                WHERE
246	                    (
247	                        join_rules = '{JoinRules.PUBLIC}'
248	                        OR join_rules = '{JoinRules.KNOCK}'
249	                        OR join_rules = '{JoinRules.KNOCK_RESTRICTED}'
250	                        OR history_visibility = 'world_readable'
251	                    )
252	                    AND joined_members > 0
253	            """
254	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\room.py:311:16
310	                query_args.append(network_tuple.appservice_id)
311	                assert network_tuple.network_id is not None
312	                query_args.append(network_tuple.network_id)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:373:14
372	        dir = "DESC" if forwards else "ASC"
373	        sql = f"""
374	            SELECT
375	                room_id, name, topic, canonical_alias, joined_members,
376	                avatar, history_visibility, guest_access, join_rules
377	            FROM (
378	                {published_sql}
379	            ) published
380	            INNER JOIN room_stats_state USING (room_id)
381	            INNER JOIN room_stats_current USING (room_id)
382	            WHERE
383	                (
384	                    join_rules = '{JoinRules.PUBLIC}'
385	                    OR join_rules = '{JoinRules.KNOCK}'
386	                    OR join_rules = '{JoinRules.KNOCK_RESTRICTED}'
387	                    OR history_visibility = 'world_readable'
388	                )
389	                AND joined_members > 0
390	                {where_clause}
391	            ORDER BY
392	                joined_members {dir},
393	                room_id {dir}
394	        """
395	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:548:19
547	        # returned. Thus allowing us to see if there are more events to paginate through
548	        info_sql = """
549	            SELECT state.room_id, state.name, state.canonical_alias, curr.joined_members,
550	              curr.local_users_in_room, rooms.room_version, rooms.creator,
551	              state.encryption, state.is_federatable, rooms.is_public, state.join_rules,
552	              state.guest_access, state.history_visibility, curr.current_state_events
553	            FROM room_stats_state state
554	            INNER JOIN room_stats_current curr USING (room_id)
555	            INNER JOIN rooms USING (room_id)
556	            {where}
557	            ORDER BY {order_by} {direction}, state.room_id {direction}
558	            LIMIT ?
559	            OFFSET ?
560	        """.format(
561	            where=where_statement,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:567:20
566	        # Use a nested SELECT statement as SQL can't count(*) with an OFFSET
567	        count_sql = """
568	            SELECT count(*) FROM (
569	              SELECT room_id FROM room_stats_state state
570	              {where}
571	            ) AS get_room_ids
572	        """.format(
573	            where=where_statement,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1230:16
1229	            txn.execute(
1230	                """
1231	                SELECT state.room_id, state.event_id, events.json
1232	                FROM current_state_events as state
1233	                LEFT JOIN event_json AS events ON (state.event_id = events.event_id)
1234	                WHERE state.room_id > ? AND state.type = '%s'
1235	                ORDER BY state.room_id ASC
1236	                LIMIT ?;
1237	                """
1238	                % EventTypes.Retention,
1239	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1370:16
1369	            txn.execute(
1370	                """
1371	                SELECT room_id
1372	                FROM rooms r
1373	                INNER JOIN current_state_events cse USING (room_id)
1374	                WHERE room_id > ? AND r.is_public
1375	                AND cse.type = '%s' AND cse.state_key = ''
1376	                ORDER BY room_id ASC
1377	                LIMIT ?;
1378	                """
1379	                % EventTypes.Tombstone,
1380	                (last_room, batch_size),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1878:18
1877	
1878	            sql = """
1879	                SELECT COUNT(*) as total_event_reports
1880	                FROM event_reports AS er
1881	                {}
1882	                """.format(
1883	                where_clause

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\room.py:1888:18
1887	
1888	            sql = """
1889	                SELECT
1890	                    er.id,
1891	                    er.received_ts,
1892	                    er.room_id,
1893	                    er.event_id,
1894	                    er.user_id,
1895	                    er.content,
1896	                    events.sender,
1897	                    room_stats_state.canonical_alias,
1898	                    room_stats_state.name
1899	                FROM event_reports AS er
1900	                LEFT JOIN events
1901	                    ON events.event_id = er.event_id
1902	                JOIN room_stats_state
1903	                    ON room_stats_state.room_id = er.room_id
1904	                {where_clause}
1905	                ORDER BY er.received_ts {order}
1906	                LIMIT ?
1907	                OFFSET ?
1908	            """.format(
1909	                where_clause=where_clause,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:430:14
429	
430	        sql = """
431	            SELECT room_id, e.sender, c.membership, event_id, e.stream_ordering, r.room_version
432	            FROM local_current_membership AS c
433	            INNER JOIN events AS e USING (room_id, event_id)
434	            INNER JOIN rooms AS r USING (room_id)
435	            WHERE
436	                user_id = ?
437	                AND %s
438	        """ % (
439	            clause,
440	        )
441	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:567:18
566	        if self._current_state_events_membership_up_to_date:
567	            sql = f"""
568	                SELECT c.state_key, room_id, e.instance_name, e.stream_ordering
569	                FROM current_state_events AS c
570	                INNER JOIN events AS e USING (room_id, event_id)
571	                WHERE
572	                    c.type = 'm.room.member'
573	                    AND c.membership = ?
574	                    AND {clause}
575	            """
576	        else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:577:18
576	        else:
577	            sql = f"""
578	                SELECT c.state_key, room_id, e.instance_name, e.stream_ordering
579	                FROM current_state_events AS c
580	                INNER JOIN room_memberships AS m USING (room_id, event_id)
581	                INNER JOIN events AS e USING (room_id, event_id)
582	                WHERE
583	                    c.type = 'm.room.member'
584	                    AND m.membership = ?
585	                    AND {clause}
586	            """
587	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:709:8
708	        current_state_ids = await context.get_current_state_ids()
709	        assert current_state_ids is not None
710	        assert state_group is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:710:8
709	        assert current_state_ids is not None
710	        assert state_group is not None
711	        return await self._get_joined_users_from_context(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:726:8
725	
726	        assert state_group is not None
727	        with Measure(self._clock, "get_joined_users_from_state"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:745:8
744	        # with a state_group of None are likely to be different.
745	        assert state_group is not None
746	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:944:8
943	
944	        assert state_group is not None
945	        with Measure(self._clock, "get_joined_hosts"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:962:8
961	        # The `state_group` must match the `state_entry.state_group` (if not None).
962	        assert state_group is not None
963	        assert state_entry.state_group is None or state_entry.state_group == state_group

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:963:8
962	        assert state_group is not None
963	        assert state_entry.state_group is None or state_entry.state_group == state_group
964	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\roommember.py:989:16
988	                # the delta.
989	                assert state_entry.delta_ids is not None
990	                for (typ, state_key), event_id in state_entry.delta_ids.items():

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\roommember.py:1159:14
1158	
1159	        sql = """
1160	            SELECT 1 FROM local_current_membership
1161	            WHERE
1162	                room_id = ? AND membership = ?
1163	                AND NOT (%s)
1164	                LIMIT 1
1165	        """ % (
1166	            clause,
1167	        )
1168	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\roommember.py:1242:16
1241	                    content = event_json["content"]
1242	                except Exception:
1243	                    continue
1244	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\search.py:164:16
163	            sql = (
164	                "SELECT stream_ordering, event_id, room_id, type, json, "
165	                " origin_server_ts FROM events"
166	                " JOIN event_json USING (room_id, event_id)"
167	                " WHERE ? <= stream_ordering AND stream_ordering < ?"
168	                " AND (%s)"
169	                " ORDER BY stream_ordering DESC"
170	                " LIMIT ?"
171	            ) % (" OR ".join("type = '%s'" % (t,) for t in TYPES),)
172	
173	            txn.execute(sql, (target_min_stream_id, max_stream_id, batch_size))

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\synapse\storage\databases\main\search.py:196:20
195	                        content = event_json["content"]
196	                    except Exception:
197	                        continue
198	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\state.py:170:18
169	
170	            sql = f"""
171	                SELECT e.event_id, e.room_id, e.type, se.state_key, r.reason
172	                FROM events AS e
173	                LEFT JOIN state_events se USING (event_id)
174	                LEFT JOIN rejections r USING (event_id)
175	                WHERE {clause}
176	            """
177	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\state.py:422:8
421	        # we shouldn't have any outliers here
422	        assert not event.internal_metadata.is_outlier()
423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\state.py:427:12
426	        if context.rejected:
427	            assert context.state_group == context.state_group_before_event
428	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\state_deltas.py:61:8
60	        # check we're not going backwards
61	        assert (
62	            prev_stream_id <= max_stream_id
63	        ), f"New stream id {max_stream_id} is smaller than prev stream id {prev_stream_id}"
64	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:472:18
471	
472	            sql = """
473	                INSERT INTO %(table)s (%(insert_cols_cs)s)
474	                VALUES (%(insert_vals_qs)s)
475	                ON CONFLICT (%(key_columns)s) DO UPDATE SET %(updates)s
476	            """ % {
477	                "table": table,
478	                "insert_cols_cs": ", ".join(insert_cols),
479	                "insert_vals_qs": ", ".join(
480	                    ["?"] * (len(keyvalues) + len(absolutes) + len(additive_relatives))
481	                ),
482	                "key_columns": ", ".join(keyvalues),
483	                "updates": ", ".join(chain(absolute_updates, relative_updates)),
484	            }
485	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stats.py:739:18
738	            # SQLite does not support SELECT COUNT(*) OVER()
739	            sql = """
740	                SELECT COUNT(*) FROM (
741	                    SELECT lmr.user_id
742	                    {sql_base}
743	                ) AS count_user_ids
744	            """.format(
745	                sql_base=sql_base,

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'stream'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:82:16
81	
82	_STREAM_TOKEN = "stream"
83	_TOPOLOGICAL_TOKEN = "topological"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'topological'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\synapse\storage\databases\main\stream.py:83:21
82	_STREAM_TOKEN = "stream"
83	_TOPOLOGICAL_TOKEN = "topological"
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:143:4
142	    """
143	    assert direction in ("b", "f")
144	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:198:4
197	
198	    assert bound in (">", "<", ">=", "<=")
199	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stream.py:551:18
550	
551	            sql = """
552	                SELECT event_id, instance_name, topological_ordering, stream_ordering
553	                FROM events
554	                WHERE
555	                    room_id = ?
556	                    AND not outlier
557	                    AND stream_ordering > ? AND stream_ordering <= ?
558	                ORDER BY stream_ordering %s LIMIT ?
559	            """ % (
560	                order,
561	            )
562	            txn.execute(sql, (room_id, min_from_id, max_to_id, 2 * limit))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\stream.py:636:18
635	
636	            sql = """
637	                SELECT m.event_id, instance_name, topological_ordering, stream_ordering
638	                FROM events AS e, room_memberships AS m
639	                WHERE e.event_id = m.event_id
640	                    AND m.user_id = ?
641	                    AND e.stream_ordering > ? AND e.stream_ordering <= ?
642	                    %s
643	                ORDER BY e.stream_ordering ASC
644	            """ % (
645	                ignore_room_clause,
646	            )
647	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:967:8
966	        # This cannot happen as `allow_none=False`.
967	        assert results is not None
968	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1122:8
1121	        # Ensure we do actually have some values here
1122	        assert set(min_positions) == {"federation", "events"}
1123	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\stream.py:1174:8
1173	
1174	        assert int(limit) >= 0
1175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:208:8
207	        """
208	        assert self._can_write_to_account_data
209	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:209:8
208	        assert self._can_write_to_account_data
209	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)
210	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:235:8
234	        """
235	        assert self._can_write_to_account_data
236	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:236:8
235	        assert self._can_write_to_account_data
236	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)
237	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:264:8
263	        """
264	        assert self._can_write_to_account_data
265	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\tags.py:265:8
264	        assert self._can_write_to_account_data
265	        assert isinstance(self._account_data_id_gen, AbstractStreamIdGenerator)
266	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\transactions.py:252:8
251	    ) -> None:
252	        assert self.database_engine.can_native_upsert
253	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:204:18
203	            # if those 250 rooms have less than batch_size state events.
204	            sql = """
205	                SELECT room_id, events FROM %s
206	                ORDER BY events DESC
207	                LIMIT 250
208	            """ % (
209	                TEMP_TABLE + "_rooms",
210	            )
211	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:219:24
218	            # far we are in processing
219	            txn.execute("SELECT COUNT(*) FROM " + TEMP_TABLE + "_rooms")
220	            result = txn.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\user_directory.py:221:12
220	            result = txn.fetchone()
221	            assert result is not None
222	            progress["remaining"] = result[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:339:18
338	        def _get_next_batch(txn: LoggingTransaction) -> Optional[List[str]]:
339	            sql = "SELECT user_id FROM %s LIMIT %s" % (
340	                TEMP_TABLE + "_users",
341	                str(batch_size),
342	            )
343	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:353:18
352	            # far we are in processing
353	            sql = "SELECT COUNT(*) FROM " + TEMP_TABLE + "_users"
354	            txn.execute(sql)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\main\user_directory.py:356:12
355	            count_result = txn.fetchone()
356	            assert count_result is not None
357	            progress["remaining"] = count_result[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:806:18
805	            # search: (domain, _, display name, localpart)
806	            sql = """
807	                SELECT d.user_id AS user_id, display_name, avatar_url
808	                FROM user_directory_search as t
809	                INNER JOIN user_directory AS d USING (user_id)
810	                WHERE
811	                    %(where_clause)s
812	                    AND vector @@ to_tsquery('simple', ?)
813	                ORDER BY
814	                    (CASE WHEN d.user_id IS NOT NULL THEN 4.0 ELSE 1.0 END)
815	                    * (CASE WHEN display_name IS NOT NULL THEN 1.2 ELSE 1.0 END)
816	                    * (CASE WHEN avatar_url IS NOT NULL THEN 1.2 ELSE 1.0 END)
817	                    * (
818	                        3 * ts_rank_cd(
819	                            '{0.1, 0.1, 0.9, 1.0}',
820	                            vector,
821	                            to_tsquery('simple', ?),
822	                            8
823	                        )
824	                        + ts_rank_cd(
825	                            '{0.1, 0.1, 0.9, 1.0}',
826	                            vector,
827	                            to_tsquery('simple', ?),
828	                            8
829	                        )
830	                    )
831	                    %(order_case_statements)s
832	                    DESC,
833	                    display_name IS NULL,
834	                    avatar_url IS NULL
835	                LIMIT ?
836	            """ % {
837	                "where_clause": where_clause,
838	                "order_case_statements": " ".join(additional_ordering_statements),
839	            }
840	            args = (

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\main\user_directory.py:861:18
860	
861	            sql = """
862	                SELECT d.user_id AS user_id, display_name, avatar_url
863	                FROM user_directory_search as t
864	                INNER JOIN user_directory AS d USING (user_id)
865	                WHERE
866	                    %(where_clause)s
867	                    AND value MATCH ?
868	                ORDER BY
869	                    rank(matchinfo(user_directory_search)) DESC,
870	                    %(order_statements)s
871	                    display_name IS NULL,
872	                    avatar_url IS NULL
873	                LIMIT ?
874	            """ % {
875	                "where_clause": where_clause,
876	                "order_statements": " ".join(additional_ordering_statements),
877	            }
878	            args = join_args + (search_query,) + ordering_arguments + (limit + 1,)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\databases\state\bg_updates.py:159:24
158	                    txn.execute(
159	                        "SELECT type, state_key, event_id FROM state_groups_state"
160	                        " WHERE state_group = ? " + where_clause,
161	                        args,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\databases\state\store.py:452:16
451	            if prev_group and potential_hops < MAX_STATE_DELTA_HOPS:
452	                assert delta_ids is not None
453	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\engines\postgres.py:200:8
199	        numver = self._version
200	        assert numver is not None
201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:347:8
346	    if is_empty:
347	        assert not current_schema_state.applied_deltas
348	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:349:8
348	    else:
349	        assert config
350	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\prepare_database.py:379:8
378	
379	        assert config is not None
380	        check_database_before_upgrade(cur, database_engine, config)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\main\delta\20\pushers.py:69:12
68	        cur.execute(
69	            """
70	                INSERT into pushers2 (
71	                id, user_name, access_token, profile_tag, kind,
72	                app_id, app_display_name, device_display_name,
73	                pushkey, ts, lang, data, last_token, last_success,
74	                failing_since
75	                ) values (%s)
76	            """
77	            % (",".join(["?" for _ in range(len(row))])),
78	            row,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\storage\schema\main\delta\30\as_users.py:25:4
24	        cur.execute("ALTER TABLE users ADD COLUMN appservice_id TEXT")
25	    except Exception:
26	        # Maybe we already added the column? Hope so...
27	        pass
28	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\main\delta\30\as_users.py:61:16
60	            cur.execute(
61	                "UPDATE users SET appservice_id = ? WHERE name IN (%s)"
62	                % (",".join("?" for _ in chunk),),
63	                [as_id] + chunk,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\main\delta\31\pushers.py:68:12
67	        cur.execute(
68	            """
69	                INSERT into pushers2 (
70	                id, user_name, access_token, profile_tag, kind,
71	                app_id, app_display_name, device_display_name,
72	                pushkey, ts, lang, data, last_stream_ordering, last_success,
73	                failing_since
74	                ) values (%s)
75	            """
76	            % (",".join(["?" for _ in range(len(row))])),
77	            row,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\main\delta\48\group_unique_indexes.py:42:8
41	    cur.execute(
42	        """
43	        DELETE FROM group_users WHERE %s NOT IN (
44	           SELECT min(%s) FROM group_users GROUP BY group_id, user_id
45	        );
46	    """
47	        % (rowid, rowid)
48	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\schema\main\delta\48\group_unique_indexes.py:50:8
49	    cur.execute(
50	        """
51	        DELETE FROM group_invites WHERE %s NOT IN (
52	           SELECT min(%s) FROM group_invites GROUP BY group_id, user_id
53	        );
54	    """
55	        % (rowid, rowid)
56	    )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:79:20
78	    if step == 1:
79	        cur.execute("SELECT MAX(%s) FROM %s" % (column, table))
80	    else:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:81:20
80	    else:
81	        cur.execute("SELECT MIN(%s) FROM %s" % (column, table))
82	    result = cur.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:83:4
82	    result = cur.fetchone()
83	    assert result is not None
84	    (val,) = result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:190:8
189	    ) -> None:
190	        assert step != 0
191	        self._lock = threading.Lock()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:417:22
416	            for table, _, id_column in tables:
417	                sql = """
418	                    SELECT GREATEST(COALESCE(%(agg)s(%(id)s), 1), 1)
419	                    FROM %(table)s
420	                """ % {
421	                    "id": id_column,
422	                    "table": table,
423	                    "agg": "MAX" if self._positive else "-MIN",
424	                }
425	                cur.execute(sql)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:427:16
426	                result = cur.fetchone()
427	                assert result is not None
428	                (stream_id,) = result

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:449:22
448	            for table, instance_column, id_column in tables:
449	                sql = """
450	                    SELECT %(instance)s, %(id)s FROM %(table)s
451	                    WHERE ? %(cmp)s %(id)s
452	                """ % {
453	                    "id": id_column,
454	                    "table": table,
455	                    "instance": instance_column,
456	                    "cmp": "<=" if self._positive else ">=",
457	                }
458	                cur.execute(sql, (min_stream_id * self._return_factor,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\id_generators.py:678:8
677	        # We require that the lock is locked by caller
678	        assert self._lock.locked()
679	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\id_generators.py:729:14
728	        # value (or decrease if stream goes backwards).
729	        sql = """
730	            INSERT INTO stream_positions (stream_name, instance_name, stream_id)
731	            VALUES (?, ?, ?)
732	            ON CONFLICT (stream_name, instance_name)
733	            DO UPDATE SET
734	                stream_id = %(agg)s(stream_positions.stream_id, EXCLUDED.stream_id)
735	        """ % {
736	            "agg": "GREATEST" if self._positive else "LEAST",
737	        }
738	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:109:8
108	        fetch_res = txn.fetchone()
109	        assert fetch_res is not None
110	        return fetch_res[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:131:20
130	        # First we get the current max ID from the table.
131	        table_sql = "SELECT GREATEST(%(agg)s(%(id)s), 0) FROM %(table)s" % {
132	            "id": id_column,
133	            "table": table,
134	            "agg": "MAX" if positive else "-MIN",
135	        }
136	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\synapse\storage\util\sequence.py:148:12
147	        txn.execute(
148	            "SELECT last_value, is_called FROM %(seq)s" % {"seq": self._sequence_name}
149	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:151:8
150	        fetch_res = txn.fetchone()
151	        assert fetch_res is not None
152	        last_value, is_called = fetch_res

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:222:16
221	            if self._current_max_id is None:
222	                assert self._callback is not None
223	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:232:16
231	            if self._current_max_id is None:
232	                assert self._callback is not None
233	                self._current_max_id = self._callback(txn)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\storage\util\sequence.py:282:8
281	    if table:
282	        assert id_column
283	        seq.check_consistency(

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:528:8
527	            raise
528	        except Exception:
529	            pass
530	        raise SynapseError(400, "Invalid room stream token %r" % (string,))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\types.py:537:8
536	                return cls(topological=None, stream=int(string[1:]))
537	        except Exception:
538	            pass
539	        raise SynapseError(400, "Invalid room stream token %r" % (string,))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\types.py:579:8
578	        """
579	        assert self.topological is None
580	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\async_helpers.py:167:12
166	        if not self._result:
167	            assert isinstance(self._observers, list)
168	            d: "defer.Deferred[_T]" = defer.Deferred()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\async_helpers.py:290:8
289	        # very interesting.
290	        assert isinstance(dfe.subFailure.value, BaseException)
291	        raise dfe.subFailure.value from None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\async_helpers.py:692:8
691	    if inspect.isawaitable(value):
692	        assert isinstance(value, Awaitable)
693	        return value

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\synapse\util\async_helpers.py:799:12
798	                    deferred.callback(None)
799	            except Exception:
800	                pass
801	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\__init__.py:93:8
92	    def dec_memory_usage(self, memory: int) -> None:
93	        assert self.memory_usage is not None
94	        self.memory_usage -= memory

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\cached_call.py:79:12
78	        if not self._deferred:
79	            assert self._callable is not None
80	            self._deferred = run_in_background(self._callable)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\cached_call.py:103:12
102	            await make_deferred_yieldable(self._deferred)
103	            assert not isinstance(self._result, _Sentinel)
104	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\deferred_cache.py:168:16
167	                m = self.cache.metrics
168	                assert m  # we always have a name, so should always have metrics
169	                m.inc_hits()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\descriptors.py:364:12
363	        if self.num_args == 1:
364	            assert not self.tree
365	            wrapped.invalidate = lambda key: cache.invalidate(key[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\descriptors.py:657:8
656	        nm = param_names[0]
657	        assert include_params[0] is True
658	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:124:4
123	    node = GLOBAL_ROOT.prev_node
124	    assert node is not None
125	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:148:8
147	        # Only the root node isn't a `_TimedListNode`.
148	        assert isinstance(node, _TimedListNode)
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:168:8
167	        # list.
168	        assert next_node is not None
169	        assert cache_entry is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:169:8
168	        assert next_node is not None
169	        assert cache_entry is not None
170	        cache_entry.drop_from_cache()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:462:16
461	                # cache is not empty.
462	                assert todelete is not None
463	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:468:16
467	                node = todelete.get_cache_entry()
468	                assert node is not None
469	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:655:12
654	
655	            assert list_root.next_node == list_root
656	            assert list_root.prev_node == list_root

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\lrucache.py:656:12
655	            assert list_root.next_node == list_root
656	            assert list_root.prev_node == list_root
657	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:86:8
85	        """Returns True if the entity may have been updated since stream_pos"""
86	        assert isinstance(stream_pos, int)
87	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:134:8
133	        """Returns if any entity has changed"""
134	        assert type(stream_pos) is int
135	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:153:8
152	        """
153	        assert type(stream_pos) is int
154	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\stream_change_cache.py:168:8
167	        """
168	        assert type(stream_pos) is int
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\ttlcache.py:60:12
59	        if e is not SENTINEL:
60	            assert isinstance(e, _CacheEntry)
61	            self._expiry_list.remove(e)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\ttlcache.py:85:8
84	            return default
85	        assert isinstance(e, _CacheEntry)
86	        self._metrics.inc_hits()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\caches\ttlcache.py:131:8
130	            return default
131	        assert isinstance(e, _CacheEntry)
132	        self._expiry_list.remove(e)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\check_dependencies.py:77:4
76	    requirements = metadata.requires(DISTRIBUTION_NAME)
77	    assert requirements is not None
78	    for raw_requirement in requirements:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\check_dependencies.py:93:4
92	    requirements = metadata.requires(DISTRIBUTION_NAME)
93	    assert requirements is not None
94	    for raw_requirement in requirements:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\file_consumer.py:93:8
92	        self._producer = None
93	        assert self._finished_deferred is not None
94	        if not self._finished_deferred.called:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\file_consumer.py:102:8
101	
102	        assert self._finished_deferred is not None
103	        if self._finished_deferred.called:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\file_consumer.py:112:12
111	            self._paused_producer = True
112	            assert self._producer is not None
113	            # cast safe because `streaming` means this is an IPushProducer

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\file_consumer.py:145:8
144	        """Returns a deferred that resolves when finished writing to file"""
145	        assert self._finished_deferred is not None
146	        return make_deferred_yieldable(self._finished_deferred)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:93:12
92	            # We assert that both this node and the target node is still "alive".
93	            assert self.prev_node
94	            assert self.next_node

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:94:12
93	            assert self.prev_node
94	            assert self.next_node
95	            assert node.prev_node

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:95:12
94	            assert self.next_node
95	            assert node.prev_node
96	            assert node.next_node

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:96:12
95	            assert node.prev_node
96	            assert node.next_node
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:98:12
97	
98	            assert self is not node
99	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:129:8
128	        # This method should only be called when we're not already in the list.
129	        assert self.prev_node is None
130	        assert self.next_node is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:130:8
129	        assert self.prev_node is None
130	        assert self.next_node is None
131	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:134:8
133	        # prev/next refs.
134	        assert node.next_node
135	        assert node.prev_node

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\linked_list.py:135:8
134	        assert node.next_node
135	        assert node.prev_node
136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\manhole.py:132:8
131	        type, value, tb = sys.exc_info()
132	        assert value is not None
133	        sys.last_type = type

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\manhole.py:158:8
157	        sys.last_traceback = last_tb
158	        assert last_tb is not None
159	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\metrics.py:150:12
149	        else:
150	            assert isinstance(curr_context, LoggingContext)
151	            parent_context = curr_context

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\util\metrics.py:204:8
203	        """Gets called when processing in flight metrics"""
204	        assert self.start is not None
205	        duration = self.clock.time() - self.start

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\synapse\util\retryutils.py:223:61
222	                self.retry_interval = int(
223	                    self.retry_interval * RETRY_MULTIPLIER * random.uniform(0.8, 1.4)
224	                )

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Ensure autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: Medium
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\synapse\util\templates.py:60:10
59	    loader = jinja2.FileSystemLoader(template_search_directories)
60	    env = jinja2.Environment(loader=loader, autoescape=autoescape)
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\visibility.py:320:12
319	        for ev in memberships.values():
320	            assert get_domain_from_id(ev.state_key) == server_name
321	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\synapse\visibility.py:411:12
410	            vis = vis_event.content.get("history_visibility", HistoryVisibility.SHARED)
411	            assert isinstance(vis, str)
412	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:101:22
100	    def test_get_user_by_req_appservice_valid_token(self):
101	        app_service = Mock(
102	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
103	        )
104	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:117:22
116	
117	        app_service = Mock(
118	            token="foobar",
119	            url="a_url",
120	            sender=self.test_user,
121	            ip_range_whitelist=IPSet(["192.168/16"]),
122	        )
123	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:136:22
135	
136	        app_service = Mock(
137	            token="foobar",
138	            url="a_url",
139	            sender=self.test_user,
140	            ip_range_whitelist=IPSet(["192.168/16"]),
141	        )
142	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:169:22
168	    def test_get_user_by_req_appservice_missing_token(self):
169	        app_service = Mock(token="foobar", url="a_url", sender=self.test_user)
170	        self.store.get_app_service_by_token = Mock(return_value=app_service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:183:22
182	        masquerading_user_id = b"@doppelganger:matrix.org"
183	        app_service = Mock(
184	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
185	        )
186	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:204:22
203	        masquerading_user_id = b"@doppelganger:matrix.org"
204	        app_service = Mock(
205	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
206	        )
207	        app_service.is_interested_in_user = Mock(return_value=False)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:227:22
226	        masquerading_device_id = b"DOPPELDEVICE"
227	        app_service = Mock(
228	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
229	        )
230	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:259:22
258	        masquerading_device_id = b"NOT_A_REAL_DEVICE_ID"
259	        app_service = Mock(
260	            token="foobar", url="a_url", sender=self.test_user, ip_range_whitelist=None
261	        )
262	        app_service.is_interested_in_user = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '@admin:matrix.org'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:283:12
282	        self.store.get_user_by_access_token = simple_async_mock(
283	            TokenLookupResult(
284	                user_id="@baldrick:matrix.org",
285	                device_id="device",
286	                token_owner="@admin:matrix.org",
287	            )
288	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '@admin:matrix.org'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\api\test_auth.py:300:12
299	        self.store.get_user_by_access_token = simple_async_mock(
300	            TokenLookupResult(
301	                user_id="@baldrick:matrix.org",
302	                device_id="device",
303	                token_owner="@admin:matrix.org",
304	            )
305	        )

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:59:31
58	            "type": "http",
59	            "bind_addresses": ["0.0.0.0"],
60	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\tests\app\test_openid_listener.py:107:31
106	            "type": "http",
107	            "bind_addresses": ["0.0.0.0"],
108	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\app\test_phone_stats_home.py:169:8
168	        now = self.hs.get_clock().time()
169	        assert now < desired_time_secs
170	        self.reactor.advance(desired_time_secs - now)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\app\test_phone_stats_home.py:177:8
176	        # that it's not enabled
177	        assert not hs.config.metrics.report_stats
178	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'myastoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\appservice\test_api.py:27:8
26	PROTOCOL = "myproto"
27	TOKEN = "myastoken"
28	URL = "http://mytestservice"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'unused'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\appservice\test_api.py:34:23
33	        self.api = hs.get_application_service_api()
34	        self.service = ApplicationService(
35	            id="unique_identifier",
36	            sender="@as:test",
37	            url=URL,
38	            token="unused",
39	            hs_token=TOKEN,
40	        )
41	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\appservice\test_appservice.py:31:23
30	    def setUp(self):
31	        self.service = ApplicationService(
32	            id="unique_identifier",
33	            sender="@as:test",
34	            url="some_url",
35	            token="some_token",
36	        )
37	        self.event = Mock(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_load.py:50:8
49	        config2 = HomeServerConfig.load_or_generate_config("", ["-c", self.config_file])
50	        assert config2 is not None
51	        self.assertTrue(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_load.py:66:8
65	        config3 = HomeServerConfig.load_or_generate_config("", ["-c", self.config_file])
66	        assert config1 is not None
67	        assert config2 is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_load.py:67:8
66	        assert config1 is not None
67	        assert config2 is not None
68	        assert config3 is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_load.py:68:8
67	        assert config2 is not None
68	        assert config3 is not None
69	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_load.py:86:8
85	        config2 = HomeServerConfig.load_or_generate_config("", ["-c", self.config_file])
86	        assert config2 is not None
87	        self.assertFalse(config2.registration.enable_registration)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_load.py:93:8
92	        )
93	        assert config3 is not None
94	        self.assertTrue(config3.registration.enable_registration)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:89:12
88	            self.addCleanup(setattr, SSL, "SSL.OP_NO_TLSv1_3", OP_NO_TLSv1_3)
89	            assert not hasattr(SSL, "OP_NO_TLSv1_3")
90	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\config\test_tls.py:111:12
110	            self.addCleanup(lambda: delattr(SSL, "OP_NO_TLSv1_3"))
111	            assert hasattr(SSL, "OP_NO_TLSv1_3")
112	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\federation\test_federation_catch_up.py:255:12
254	        ) -> bool:
255	            assert destination == destination_tm
256	            results_list.extend(pending_pdus)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:350:24
349	        )
350	        service.token = "mock_service_token"
351	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mock_service_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:370:24
369	        service.is_room_alias_in_namespace.return_value = is_room_alias_in_namespace
370	        service.token = "mock_service_token"
371	        service.url = "mock_service_url"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcde'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\handlers\test_appservice.py:776:21
775	        # Create an appservice that is interested in "local_user"
776	        appservice = ApplicationService(
777	            token=random_string(10),
778	            id=random_string(10),
779	            sender="@as:example.com",
780	            rate_limited=False,
781	            namespaces={
782	                ApplicationService.NS_USERS: [
783	                    {
784	                        "regex": "@local_user:.+",
785	                        "exclusive": False,
786	                    }
787	                ],
788	            },
789	            supports_ephemeral=True,
790	            msc3202_transaction_extensions=as_supports_txn_extensions,
791	            # Must be set for Synapse to try pushing data to the AS
792	            hs_token="abcde",
793	            url="some_url",
794	        )
795	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'VERYSECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_appservice.py:841:30
840	        # Define an application service for the tests
841	        self._service_token = "VERYSECRET"
842	        self._service = ApplicationService(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'sometoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_federation.py:64:23
63	        # Send a 3PID invite event with an empty body so it's considered as a revoked one.
64	        invite_token = "sometoken"
65	        self.helper.send_state(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_federation.py:341:8
340	        # mapping from (type, state_key) -> state_event_id
341	        assert most_recent_prev_event_id is not None
342	        prev_state_map = self.get_success(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-client-secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_oidc.py:44:16
43	CLIENT_ID = "test-client-id"
44	CLIENT_SECRET = "test-client-secret"
45	BASE_URL = "https://synapse/"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_presence.py:360:8
359	        self.assertIsNotNone(new_state)
360	        assert new_state is not None
361	        self.assertEqual(new_state.state, PresenceState.UNAVAILABLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_presence.py:384:8
383	        self.assertIsNotNone(new_state)
384	        assert new_state is not None
385	        self.assertEqual(new_state.state, PresenceState.BUSY)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_presence.py:404:8
403	        self.assertIsNotNone(new_state)
404	        assert new_state is not None
405	        self.assertEqual(new_state.state, PresenceState.OFFLINE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_presence.py:426:8
425	        self.assertIsNotNone(new_state)
426	        assert new_state is not None
427	        self.assertEqual(new_state.state, PresenceState.ONLINE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_presence.py:484:8
483	        self.assertIsNotNone(new_state)
484	        assert new_state is not None
485	        self.assertEqual(new_state.state, PresenceState.OFFLINE)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testtok'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\handlers\test_register.py:643:16
642	        # Get an access token.
643	        token = "testtok"
644	        self.get_success(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\handlers\test_room_summary.py:601:12
600	        self.get_failure(
601	            self.handler.get_room_hierarchy(
602	                create_requester(self.user), self.space, from_token="foo"
603	            ),
604	            SynapseError,

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\handlers\test_user_directory.py:61:26
60	
61	        self.appservice = ApplicationService(
62	            token="i_am_an_app_service",
63	            id="1234",
64	            namespaces={"users": [{"regex": r"@as_user.*", "exclusive": True}]},
65	            # Note: this user does not match the regex above, so that tests
66	            # can distinguish the sender from the AS user.
67	            sender="@as_main:test",
68	        )
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_user_directory.py:353:8
352	        profile = self.get_success(self.store.get_user_in_directory(regular_user_id))
353	        assert profile is not None
354	        self.assertTrue(profile["display_name"] == display_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\handlers\test_user_directory.py:372:8
371	        profile = self.get_success(self.store.get_user_in_directory(r_user_id))
372	        assert profile is not None
373	        self.assertTrue(profile["display_name"] == display_name)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tests\http\__init__.py:15:0
14	import os.path
15	import subprocess
16	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:89:4
88	    # first build a CSR
89	    subprocess.check_call(
90	        [
91	            "openssl",
92	            "req",
93	            "-new",
94	            "-key",
95	            get_test_key_file(),
96	            "-subj",
97	            "/",
98	            "-out",
99	            csr_filename,
100	        ]
101	    )
102	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:89:4
88	    # first build a CSR
89	    subprocess.check_call(
90	        [
91	            "openssl",
92	            "req",
93	            "-new",
94	            "-key",
95	            get_test_key_file(),
96	            "-subj",
97	            "/",
98	            "-out",
99	            csr_filename,
100	        ]
101	    )
102	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tests\http\__init__.py:111:4
110	    ca_cert_filename = get_test_ca_cert_file()
111	    subprocess.check_call(
112	        [
113	            "openssl",
114	            "x509",
115	            "-req",
116	            "-in",
117	            csr_filename,
118	            "-CA",
119	            ca_cert_filename,
120	            "-CAkey",
121	            ca_key_filename,
122	            "-set_serial",
123	            "1",
124	            "-extfile",
125	            cnf_filename,
126	            "-out",
127	            cert_filename,
128	        ]
129	    )
130	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tests\http\__init__.py:111:4
110	    ca_cert_filename = get_test_ca_cert_file()
111	    subprocess.check_call(
112	        [
113	            "openssl",
114	            "x509",
115	            "-req",
116	            "-in",
117	            csr_filename,
118	            "-CA",
119	            ca_cert_filename,
120	            "-CAkey",
121	            ca_key_filename,
122	            "-set_serial",
123	            "1",
124	            "-extfile",
125	            cnf_filename,
126	            "-out",
127	            cert_filename,
128	        ]
129	    )
130	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\http\federation\test_matrix_federation_agent.py:388:8
387	
388	        assert isinstance(proxy_server, HTTPChannel)
389	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\http\federation\test_matrix_federation_agent.py:434:12
433	        if expect_proxy_ssl:
434	            assert isinstance(proxy_server_transport, TLSMemoryBIOProtocol)
435	            proxy_server_transport.wrappedProtocol = server_ssl_protocol

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\http\federation\test_matrix_federation_agent.py:437:12
436	        else:
437	            assert isinstance(proxy_server_transport, FakeTransport)
438	            client_protocol = proxy_server_transport.other

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\http\test_proxyagent.py:576:8
575	        )
576	        assert isinstance(proxy_server, HTTPChannel)
577	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\http\test_proxyagent.py:627:12
626	        if expect_proxy_ssl:
627	            assert isinstance(proxy_server_transport, TLSMemoryBIOProtocol)
628	            proxy_server_transport.wrappedProtocol = server_ssl_protocol

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\http\test_proxyagent.py:630:12
629	        else:
630	            assert isinstance(proxy_server_transport, FakeTransport)
631	            client_protocol = proxy_server_transport.other

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_email.py:224:8
223	        # Nothing should have happened yet, as we're paused.
224	        assert not self.email_attempts
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_email.py:254:8
253	        # Nothing should have happened yet, as we're paused.
254	        assert not self.email_attempts
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\push\test_presentable_names.py:56:8
55	    ) -> Optional[FrozenEvent]:
56	        assert allow_none, "Mock not configured for allow_none = False"
57	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\_base.py:554:8
553	        """Send a message back to the client."""
554	        assert self.transport is not None
555	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\slave\storage\test_events.py:255:8
254	        repl_transport = self._server_transport
255	        assert isinstance(repl_transport, FakeTransport)
256	        repl_transport.autoflush = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\streams\test_typing.py:71:8
70	        # The from token should be the token from the last RDATA we got.
71	        assert request.args is not None
72	        self.assertEqual(int(request.args[b"from_token"][0]), token)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:32:8
31	        cmd = parse_command_from_line(line)
32	        assert isinstance(cmd, RdataCommand)
33	        self.assertEqual(cmd.stream_name, "events")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\tcp\test_commands.py:40:8
39	        cmd = parse_command_from_line(line)
40	        assert isinstance(cmd, RdataCommand)
41	        self.assertEqual(cmd.stream_name, "presence")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\test_federation_ack.py:76:8
75	        cmd = mock_connection.send_command.call_args[0][0]
76	        assert isinstance(cmd, FederationAckCommand)
77	        self.assertEqual(cmd.token, 10)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\replication\test_sharded_event_persister.py:186:8
185	        worker_store2 = worker_hs2.get_datastores().main
186	        assert isinstance(worker_store2._stream_id_gen, MultiWriterIdGenerator)
187	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:705:8
704	        media_info = self.get_success(self.store.get_local_media(self.media_id))
705	        assert media_info is not None
706	        self.assertFalse(media_info["quarantined_by"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:719:8
718	        media_info = self.get_success(self.store.get_local_media(self.media_id))
719	        assert media_info is not None
720	        self.assertTrue(media_info["quarantined_by"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:733:8
732	        media_info = self.get_success(self.store.get_local_media(self.media_id))
733	        assert media_info is not None
734	        self.assertFalse(media_info["quarantined_by"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:746:8
745	        media_info = self.get_success(self.store.get_local_media(self.media_id))
746	        assert media_info is not None
747	        self.assertTrue(media_info["safe_from_quarantine"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:761:8
760	        media_info = self.get_success(self.store.get_local_media(self.media_id))
761	        assert media_info is not None
762	        self.assertFalse(media_info["quarantined_by"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:838:8
837	        media_info = self.get_success(self.store.get_local_media(self.media_id))
838	        assert media_info is not None
839	        self.assertFalse(media_info["safe_from_quarantine"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:852:8
851	        media_info = self.get_success(self.store.get_local_media(self.media_id))
852	        assert media_info is not None
853	        self.assertTrue(media_info["safe_from_quarantine"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_media.py:866:8
865	        media_info = self.get_success(self.store.get_local_media(self.media_id))
866	        assert media_info is not None
867	        self.assertFalse(media_info["safe_from_quarantine"])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\tests\rest\admin\test_registration_tokens.py:56:28
55	        if token is None:
56	            token = "".join(random.choices(string.ascii_letters, k=8))
57	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'adefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789._~-'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\admin\test_registration_tokens.py:118:16
117	        # As many of the allowed characters as possible with length <= 64
118	        token = "adefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789._~-"
119	        data = {

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\admin\test_user.py:66:65
65	
66	        self.hs.config.registration.registration_shared_secret = "shared"
67	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_user.py:2145:8
2144	        profile = self.get_success(self.store.get_user_in_directory(self.other_user))
2145	        assert profile is not None
2146	        self.assertTrue(profile["display_name"] == "User")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_user.py:2713:8
2712	        )
2713	        assert user_tuple is not None
2714	        token_id = user_tuple.token_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_user.py:3679:8
3678	        result = self.get_success(self.store.get_user_by_access_token(other_user_token))
3679	        assert result is not None
3680	        self.assertFalse(result.shadow_banned)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_user.py:3688:8
3687	        result = self.get_success(self.store.get_user_by_access_token(other_user_token))
3688	        assert result is not None
3689	        self.assertTrue(result.shadow_banned)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\admin\test_user.py:3700:8
3699	        result = self.get_success(self.store.get_user_by_access_token(other_user_token))
3700	        assert result is not None
3701	        self.assertFalse(result.shadow_banned)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:105:23
104	        """Test basic password reset flow"""
105	        old_password = "monkey"
106	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:106:23
105	        old_password = "monkey"
106	        new_password = "kangeroo"
107	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:124:24
123	
124	        client_secret = "foobar"
125	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:143:23
142	        """Test that we ratelimit /requestToken for the same email."""
143	        old_password = "monkey"
144	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:144:23
143	        old_password = "monkey"
144	        new_password = "kangeroo"
145	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:163:28
162	        def reset(ip: str) -> None:
163	            client_secret = "foobar"
164	            session_id = self._request_token(email, client_secret, ip)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:193:23
192	        """
193	        old_password = "monkey"
194	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:194:23
193	        old_password = "monkey"
194	        new_password = "kangeroo"
195	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:213:24
212	
213	        client_secret = "foobar"
214	        session_id = self._request_token(email_passwort_reset, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:231:23
230	        """Test that we do actually need to click the link in the email"""
231	        old_password = "monkey"
232	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:232:23
231	        old_password = "monkey"
232	        new_password = "kangeroo"
233	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:250:24
249	
250	        client_secret = "foobar"
251	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'monkey'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:268:23
267	        """
268	        old_password = "monkey"
269	        new_password = "kangeroo"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kangeroo'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:269:23
268	        old_password = "monkey"
269	        new_password = "kangeroo"
270	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:287:24
286	
287	        client_secret = "foobar"
288	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:310:24
309	
310	        client_secret = "foobar"
311	        session_id = self._request_token(email, client_secret)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_account.py:368:8
367	    def _get_link_from_email(self) -> str:
368	        assert self.email_attempts, "No emails have been sent"
369	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_account.py:382:8
381	
382	        assert text is not None
383	        match = re.search(r"https://example.com\S+", text)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_account.py:384:8
383	        match = re.search(r"https://example.com\S+", text)
384	        assert match, "Could not find link in email"
385	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:547:19
546	        user_id = "@as:test"
547	        as_token = "i_am_an_app_service"
548	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:696:24
695	
696	        client_secret = "foobar"
697	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:800:24
799	        """Test that we do actually need to click the link in the email"""
800	        client_secret = "foobar"
801	        session_id = self._request_token(self.email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:837:24
836	        """
837	        client_secret = "foobar"
838	        session_id = "weasle"

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\tests\rest\client\test_account.py:983:4
982	
983	    def _request_token_invalid_email(
984	        self,
985	        email: str,
986	        expected_errcode: str,
987	        expected_error: str,
988	        client_secret: str = "foobar",
989	    ) -> None:
990	        channel = self.make_request(
991	            "POST",
992	            b"account/3pid/email/requestToken",
993	            {"client_secret": client_secret, "email": email, "send_attempt": 1},
994	        )
995	        self.assertEqual(400, channel.code, msg=channel.result["body"])
996	        self.assertEqual(expected_errcode, channel.json_body["errcode"])
997	        self.assertEqual(expected_error, channel.json_body["error"])
998	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_account.py:1007:8
1006	    def _get_link_from_email(self) -> str:
1007	        assert self.email_attempts, "No emails have been sent"
1008	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_account.py:1021:8
1020	
1021	        assert text is not None
1022	        match = re.search(r"https://example.com\S+", text)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_account.py:1023:8
1022	        match = re.search(r"https://example.com\S+", text)
1023	        assert match, "Could not find link in email"
1024	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_account.py:1031:24
1030	
1031	        client_secret = "foobar"
1032	        session_id = self._request_token(request_email, client_secret)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_auth.py:195:25
194	    def prepare(self, reactor: MemoryReactor, clock: Clock, hs: HomeServer) -> None:
195	        self.user_pass = "pass"
196	        self.user = self.register_user("test", self.user_pass)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_auth.py:583:25
582	    def prepare(self, reactor: MemoryReactor, clock: Clock, hs: HomeServer) -> None:
583	        self.user_pass = "pass"
584	        self.user = self.register_user("test", self.user_pass)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_auth.py:605:8
604	        # Either 200 or 401 is what we get back; anything else is a bug.
605	        assert code in {HTTPStatus.OK, HTTPStatus.UNAUTHORIZED}
606	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\tests\rest\client\test_auth.py:1066:28
1065	            def _txn(txn: LoggingTransaction) -> int:
1066	                txn.execute(f"SELECT COUNT(1) FROM {table_name}")
1067	                row = txn.fetchone()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_auth.py:1069:16
1068	                # Query is infallible
1069	                assert row is not None
1070	                return row[0]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_capabilities.py:45:24
44	        self.localpart = "user"
45	        self.password = "pass"
46	        self.user = self.register_user(self.localpart, self.password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_consent.py:43:15
42	        config = self.default_config()
43	        config["form_secret"] = "123abc"
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:499:8
498	        location_headers = channel.headers.getRawHeaders("Location")
499	        assert location_headers
500	        uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:535:8
534	        location_headers = channel.headers.getRawHeaders("Location")
535	        assert location_headers
536	        cas_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:560:8
559	        location_headers = channel.headers.getRawHeaders("Location")
560	        assert location_headers
561	        saml_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:584:8
583	        location_headers = channel.headers.getRawHeaders("Location")
584	        assert location_headers
585	        oidc_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:593:8
592	        cookie_headers = channel.headers.getRawHeaders("Set-Cookie")
593	        assert cookie_headers
594	        cookies: Dict[str, str] = {}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:611:8
610	        content_type_headers = channel.headers.getRawHeaders("Content-Type")
611	        assert content_type_headers
612	        self.assertTrue(content_type_headers[-1].startswith("text/html"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:659:8
658	        location_headers = channel.headers.getRawHeaders("Location")
659	        assert location_headers
660	        oidc_uri = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:812:8
811	        location_headers = channel.headers.getRawHeaders("Location")
812	        assert location_headers
813	        self.assertEqual(location_headers[0][: len(redirect_url)], redirect_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_login.py:851:17
850	
851	    jwt_secret = "secret"
852	    jwt_algorithm = "HS256"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'some_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\test_login.py:1112:23
1111	
1112	        self.service = ApplicationService(
1113	            id="unique_identifier",
1114	            token="some_token",
1115	            sender="@asbot:example.com",
1116	            namespaces={
1117	                ApplicationService.NS_USERS: [
1118	                    {"regex": r"@as_user.*", "exclusive": False}
1119	                ],
1120	                ApplicationService.NS_ROOMS: [],
1121	                ApplicationService.NS_ALIASES: [],
1122	            },
1123	        )
1124	        self.another_service = ApplicationService(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'another_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\test_login.py:1124:31
1123	        )
1124	        self.another_service = ApplicationService(
1125	            id="another__identifier",
1126	            token="another_token",
1127	            sender="@as2bot:example.com",
1128	            namespaces={
1129	                ApplicationService.NS_USERS: [
1130	                    {"regex": r"@as2_user.*", "exclusive": False}
1131	                ],
1132	                ApplicationService.NS_ROOMS: [],
1133	                ApplicationService.NS_ALIASES: [],
1134	            },
1135	        )
1136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:1249:8
1248	        location_headers = channel.headers.getRawHeaders("Location")
1249	        assert location_headers
1250	        picker_url = location_headers[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:1293:8
1292	        location_headers = chan.headers.getRawHeaders("Location")
1293	        assert location_headers
1294	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_login.py:1303:8
1302	        location_headers = chan.headers.getRawHeaders("Location")
1303	        assert location_headers
1304	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'C0mpl!antpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_password_policy.py:158:29
157	        """
158	        compliant_password = "C0mpl!antpassword"
159	        not_compliant_password = "notcompliantpassword"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'notcompliantpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_password_policy.py:159:33
158	        compliant_password = "C0mpl!antpassword"
159	        not_compliant_password = "notcompliantpassword"
160	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:55:19
54	        user_id = "@as_user_kermit:test"
55	        as_token = "i_am_an_app_service"
56	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:78:19
77	    def test_POST_appservice_registration_no_type(self) -> None:
78	        as_token = "i_am_an_app_service"
79	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:153:49
152	    def test_POST_guest_registration(self) -> None:
153	        self.hs.config.key.macaroon_secret_key = "test"
154	        self.hs.config.registration.allow_guest_access = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:216:16
215	        device_id = "frogfone"
216	        token = "abcd"
217	        store = self.hs.get_datastores().main

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:314:23
313	        # Test with unknown token (invalid)
314	        params["auth"]["token"] = "1234"
315	        channel = self.make_request(b"POST", self.url, json.dumps(params))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:322:16
321	    def test_POST_registration_token_limit_uses(self) -> None:
322	        token = "abcd"
323	        store = self.hs.get_datastores().main

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:396:16
395	    def test_POST_registration_token_expiry(self) -> None:
396	        token = "abcd"
397	        now = self.hs.get_clock().time_msec()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:445:16
444	        """Test `pending` is decremented when an uncompleted session expires."""
445	        token = "abcd"
446	        store = self.hs.get_datastores().main

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:536:16
535	        """
536	        token = "abcd"
537	        store = self.hs.get_datastores().main

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:1171:16
1170	    def test_GET_token_valid(self) -> None:
1171	        token = "abcd"
1172	        store = self.hs.get_datastores().main

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:1194:16
1193	    def test_GET_token_invalid(self) -> None:
1194	        token = "1234"
1195	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_register.py:1206:16
1205	    def test_GET_ratelimiting(self) -> None:
1206	        token = "1234"
1207	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_relations.py:802:21
801	
802	        prev_token = ""
803	        found_event_ids: List[str] = []

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_relations.py:805:25
804	        for _ in range(20):
805	            from_token = ""
806	            if prev_token:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_relations.py:931:8
930	        assert_bundle(channel.json_body)
931	        assert channel.resource_usage is not None
932	        self.assertEqual(channel.resource_usage.db_txn_count, expected_db_txn_for_event)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_retention.py:200:8
199	        expired_event_id = resp.get("event_id")
200	        assert expired_event_id is not None
201	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_retention.py:216:8
215	        valid_event_id = resp.get("event_id")
216	        assert valid_event_id is not None
217	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_retention.py:333:8
332	        first_event_id = resp.get("event_id")
333	        assert first_event_id is not None
334	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_retention.py:349:8
348	        second_event_id = resp.get("event_id")
349	        assert second_event_id is not None
350	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\rest\client\test_room_batch.py:72:26
71	
72	        self.appservice = ApplicationService(
73	            token="i_am_an_app_service",
74	            id="1234",
75	            namespaces={"users": [{"regex": r"@as_user.*", "exclusive": True}]},
76	            # Note: this user does not have to match the regex above
77	            sender="@as_main:test",
78	        )
79	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_room_batch.py:278:8
277	
278	        assert invite_event_position is not None, "No invite event found"
279	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\test_room_batch.py:300:8
299	
300	        assert (
301	            "m.room.create" in state_event_types
302	        ), "Missing room full state in sync response"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 't1-0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_rooms.py:1428:16
1427	    def test_topo_token_is_accepted(self) -> None:
1428	        token = "t1-0_0_0_0_0_0_0_0_0"
1429	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_rooms.py:1439:16
1438	    def test_stream_token_is_accepted_for_fwd_pagianation(self) -> None:
1439	        token = "s0_0_0_0_0_0_0_0_0"
1440	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_rooms.py:2067:16
2066	
2067	        token = "s0_0_0_0_0_0_0_0_0"
2068	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_rooms.py:2084:16
2083	
2084	        token = "s0_0_0_0_0_0_0_0_0"
2085	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's0_0_0_0_0_0_0_0_0'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\test_rooms.py:2107:16
2106	
2107	        token = "s0_0_0_0_0_0_0_0_0"
2108	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\rest\client\test_third_party_rules.py:139:8
138	            self.room_id = self.helper.create_room_as(self.user_id, tok=self.tok)
139	        except Exception:
140	            pass
141	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:142:8
141	
142	        assert channel.result["code"] == b"%d" % expect_code, channel.result
143	        self.auth_user_id = temp_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:211:8
210	
211	        assert (
212	            int(channel.result["code"]) == expect_code
213	        ), "Expected: %d, got: %d, resp: %r" % (
214	            expect_code,
215	            int(channel.result["code"]),
216	            channel.result["body"],
217	        )
218	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:309:8
308	
309	        assert (
310	            int(channel.result["code"]) == expect_code
311	        ), "Expected: %d, got: %d, resp: %r" % (
312	            expect_code,
313	            int(channel.result["code"]),
314	            channel.result["body"],
315	        )
316	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:318:12
317	        if expect_errcode:
318	            assert (
319	                str(channel.json_body["errcode"]) == expect_errcode
320	            ), "Expected: %r, got: %r, resp: %r" % (
321	                expect_errcode,
322	                channel.json_body["errcode"],
323	                channel.result["body"],
324	            )
325	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:378:8
377	
378	        assert (
379	            int(channel.result["code"]) == expect_code
380	        ), "Expected: %d, got: %d, resp: %r" % (
381	            expect_code,
382	            int(channel.result["code"]),
383	            channel.result["body"],
384	        )
385	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:431:8
430	
431	        assert (
432	            int(channel.result["code"]) == expect_code
433	        ), "Expected: %d, got: %d, resp: %r" % (
434	            expect_code,
435	            int(channel.result["code"]),
436	            channel.result["body"],
437	        )
438	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:525:8
524	
525	        assert channel.code == expect_code, "Expected: %d, got: %d, resp: %r" % (
526	            expect_code,
527	            int(channel.result["code"]),
528	            channel.result["body"],
529	        )
530	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:549:8
548	        # expect a confirmation page
549	        assert channel.code == HTTPStatus.OK, channel.result
550	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:556:8
555	        )
556	        assert m, channel.text_body
557	        login_token = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:568:8
567	        )
568	        assert channel.code == HTTPStatus.OK
569	        return channel.json_body

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:612:12
611	            # can't set the client redirect url for UI Auth
612	            assert client_redirect_url is None
613	            oauth_uri = self.initiate_sso_ui_auth(ui_auth_session_id, cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:624:8
623	        oauth_uri_path, _ = oauth_uri.split("?", 1)
624	        assert oauth_uri_path == TEST_OIDC_AUTH_ENDPOINT, (
625	            "unexpected SSO URI " + oauth_uri_path
626	        )
627	        return self.complete_oidc_auth(oauth_uri, cookies, user_info_dict)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:680:12
679	            (expected_uri, resp_obj) = expected_requests.pop(0)
680	            assert uri == expected_uri
681	            resp = FakeResponse(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:730:8
729	        )
730	        assert channel.code == 302
731	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:737:12
736	            # Keep mypy happy by asserting that location_values is nonempty
737	            assert location_values
738	            return location_values[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:752:8
751	
752	        assert channel.code == 302
753	        channel.extract_cookies(cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:780:8
779	        # that should serve a confirmation page
780	        assert channel.code == HTTPStatus.OK, channel.text_body
781	        channel.extract_cookies(cookies)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\client\utils.py:787:8
786	        p.close()
787	        assert len(p.links) == 1, "not exactly one link in confirmation page"
788	        oauth_uri = p.links[0]

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://issuer.test/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\rest\client\utils.py:794:27
793	TEST_OIDC_AUTH_ENDPOINT = "https://issuer.test/auth"
794	TEST_OIDC_TOKEN_ENDPOINT = "https://issuer.test/token"
795	TEST_OIDC_USERINFO_ENDPOINT = "https://issuer.test/userinfo"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:229:8
228	        keyres = res[keyid]
229	        assert isinstance(keyres, FetchKeyResult)
230	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:253:8
252	        keyres = res[keyid]
253	        assert isinstance(keyres, FetchKeyResult)
254	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\rest\key\v2\test_remote_key_resource.py:272:8
271	        keyres = res[keyid]
272	        assert isinstance(keyres, FetchKeyResult)
273	        self.assertEqual(

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tests\rest\media\v1\test_html_preview.py:25:4
24	try:
25	    import lxml
26	except ImportError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\tests\rest\media\v1\test_url_preview.py:42:4
41	try:
42	    import lxml
43	except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\server.py:116:8
115	    def request(self) -> Request:
116	        assert self._request is not None
117	        return self._request

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\server.py:121:8
120	    def request(self, request: Request) -> None:
121	        assert self._request is None
122	        self._request = request

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\server.py:164:8
163	    def write(self, content):
164	        assert isinstance(content, bytes), "Should be bytes! " + repr(content)
165	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\server.py:892:15
891	    async def hash(p):
892	        return hashlib.md5(p.encode("utf8")).hexdigest()
893	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tests\server.py:897:15
896	    async def validate_hash(p, h):
897	        return hashlib.md5(p.encode("utf8")).hexdigest() == h
898	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\server_notices\test_consent.py:47:15
46	        config["public_baseurl"] = "https://example.com/"
47	        config["form_secret"] = "123abc"
48	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\databases\main\test_lock.py:69:8
68	        # by the homeserver.
69	        assert isinstance(reactor, ReactorBase)
70	        self.get_success(task1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\databases\main\test_lock.py:85:8
84	        lock = self.get_success(self.store.try_acquire_lock("name", "key"))
85	        assert lock is not None
86	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\databases\main\test_lock.py:102:8
101	        lock3 = self.get_success(self.store.try_acquire_lock("name", "key"))
102	        assert lock3 is not None
103	        self.get_success(lock3.__aenter__())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\databases\main\test_lock.py:110:8
109	        lock = self.get_success(self.store.try_acquire_lock("name", "key"))
110	        assert lock is not None
111	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\databases\main\test_lock.py:126:8
125	        lock = self.get_success(self.store.try_acquire_lock("name", "key"))
126	        assert lock is not None
127	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\storage\test_appservice.py:50:24
49	
50	        self.as_token = "token1"
51	        self.as_url = "some_url"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\storage\test_appservice.py:71:12
70	                os.remove(f)
71	            except Exception:
72	                pass
73	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_appservice.py:96:8
95	        stored_service = self.store.get_app_service_by_token(self.as_token)
96	        assert stored_service is not None
97	        self.assertEqual(stored_service.token, self.as_token)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_appservice.py:346:8
345	        txn = self.get_success(self.store.get_oldest_unsent_txn(service))
346	        assert txn is not None
347	        self.assertEqual(service, txn.service)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:507:13
506	    def test_duplicate_as_tokens(self) -> None:
507	        f1 = self._write_config(as_token="as_token", suffix="1")
508	        f2 = self._write_config(as_token="as_token", suffix="2")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'as_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_appservice.py:508:13
507	        f1 = self._write_config(as_token="as_token", suffix="1")
508	        f2 = self._write_config(as_token="as_token", suffix="2")
509	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\tests\storage\test_database.py:72:8
71	            )
72	        except Exception:
73	            pass
74	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_devices.py:192:8
191	
192	        assert self.hs.is_mine_id(
193	            "@user_id:test"
194	        ), "Test not valid: this MXID should be considered local"
195	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\tests\storage\test_id_generators.py:652:20
651	                txn.execute(
652	                    "INSERT INTO %s VALUES (nextval('foobar_seq'), ?)" % (table,),
653	                    (instance_name,),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\storage\test_redaction.py:237:16
236	                built_event._dict["event_id"] = self._event_id
237	                assert built_event.event_id == self._event_id
238	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'i_am_an_app_service'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\tests\storage\test_user_directory.py:135:26
134	    def make_homeserver(self, reactor: MemoryReactor, clock: Clock) -> HomeServer:
135	        self.appservice = ApplicationService(
136	            token="i_am_an_app_service",
137	            id="1234",
138	            namespaces={"users": [{"regex": r"@as_user.*", "exclusive": True}]},
139	            sender="@as:test",
140	        )
141	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobartoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_mau.py:104:19
103	        # with.
104	        as_token = "foobartoken"
105	        self.store.services_cache.append(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobartoken1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_mau.py:249:21
248	        # with.
249	        as_token_1 = "foobartoken1"
250	        self.store.services_cache.append(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'foobartoken2'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_mau.py:259:21
258	
259	        as_token_2 = "foobartoken2"
260	        self.store.services_cache.append(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\event_injection.py:74:4
73	    persistence = hs.get_storage_controllers().persistence
74	    assert persistence is not None
75	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\html_parsers.py:45:16
44	            if attr_dict["type"] == "radio":
45	                assert input_name
46	                self.radios.setdefault(input_name, []).append(attr_dict["value"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_utils\html_parsers.py:48:16
47	            elif attr_dict["type"] == "hidden":
48	                assert input_name
49	                self.hiddens[input_name] = attr_dict["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittest.py:298:16
297	            if self.hijack_auth:
298	                assert self.helper.auth_user_id is not None
299	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittest.py:311:20
310	                async def get_user_by_access_token(token=None, allow_guest=False):
311	                    assert self.helper.auth_user_id is not None
312	                    return {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\unittest.py:319:20
318	                async def get_user_by_req(request, allow_guest=False, rights="access"):
319	                    assert self.helper.auth_user_id is not None
320	                    return create_requester(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'shared'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\unittest.py:605:65
604	        """
605	        self.hs.config.registration.registration_shared_secret = "shared"
606	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:807:16
806	            async def list_fn(self, args1, arg2):
807	                assert current_context().name == "c1"
808	                # we want this to behave like an asynchronous function

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\caches\test_descriptors.py:810:16
809	                await run_on_reactor()
810	                assert current_context().name == "c1"
811	                return self.mock(args1, arg2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\util\test_linearizer.py:73:8
72	        """Pump the reactor to advance `Linearizer`s."""
73	        assert isinstance(reactor, ReactorBase)
74	        while reactor.getDelayedCalls():

--------------------------------------------------

Code scanned:
	Total lines of code: 192893
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 729
		Medium: 125
		High: 7
	Total issues (by confidence):
		Undefined: 0
		Low: 86
		Medium: 151
		High: 624
Files skipped (0):
