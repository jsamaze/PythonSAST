Run started:2024-02-10 22:48:31.946705

Test results:
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\aws-token-infra\lambdas\APITokensSafetyNet\lambda_function.py:62:27
61	                req = urllib.request.Request(url, data)
62	                response = urllib.request.urlopen(req)
63	                print('Looking up {u} to trigger alert!'.format(u=url))

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\aws-token-infra\lambdas\CreateUserAPITokens\lambda_function.py:39:11
38	    req = urllib.request.Request(SLACK_WEBHOOK_URL, bindata, headers)
39	    resp = urllib.request.urlopen(req)
40	    return resp

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\aws-token-infra\lambdas\ProcessUserAPITokensLogs\lambda_function.py:53:23
52	            req = urllib.request.Request(url, data)
53	            response = urllib.request.urlopen(req)
54	            print('AWS Access-key was used from IP {p}'.format(p=ip))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:123:30
122	
123	        generated_url = sites[random.randint(0,len(sites)-1)]+'/'
124	        path = []

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:125:29
124	        path = []
125	        for count in range(0,random.randint(1,3)):
126	            if len(path_elements) == 0:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:129:33
128	
129	            elem = path_elements[random.randint(0,len(path_elements)-1)]
130	            path.append(elem)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:134:26
133	
134	        path.append(pages[random.randint(0,len(pages)-1)])
135	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:144:21
143	        sites = get_all_canary_sites()
144	        return sites[random.randint(0,len(sites)-1)]
145	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:160:37
159	        if with_random:
160	            generated_hostname = str(random.randint(1,2**24))+'.'
161	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\canarydrop.py:165:38
164	        generated_hostname += self._drop['canarytoken']+'.'+\
165	                              domains[random.randint(0,len(domains)-1)]
166	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\channel_http.py:15:0
14	from jinja2 import Environment, FileSystemLoader
15	import subprocess
16	

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\channel_http.py:24:6
23	
24	env = Environment(loader=FileSystemLoader('templates'))
25	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'fortune'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\channel_http.py:85:37
84	
85	                elif TOKEN_RETURN == 'fortune':
86	                    try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\channel_http.py:87:34
86	                    try:
87	                        fortune = subprocess.check_output('/usr/games/fortune')
88	                        template = env.get_template('fortune.html')

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\channel_http.py:163:28
162	
163	                        r = hashlib.md5(os.urandom(32)).hexdigest()
164	                        filepath = os.path.join(WEB_IMAGE_UPLOAD_PATH,

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] By default, jinja2 sets autoescape to False. Consider using autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\httpd_site.py:46:6
45	
46	env = Environment(loader=FileSystemLoader('templates'),
47	                  extensions=['jinja2.ext.loopcontrols'])
48	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kubeconfig'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\httpd_site.py:130:29
129	
130	            if token_type != 'kubeconfig':
131	                canarytoken = Canarytoken()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'web'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\httpd_site.py:139:29
138	
139	            if token_type == "web":
140	                #always enable the browser scanner by default

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'kubeconfig'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\httpd_site.py:167:29
166	
167	            if token_type != "kubeconfig":
168	                response['Url'] = canarydrop.get_url()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:197:12
196	                response['qrcode_png'] = canarydrop.get_qrcode_data_uri_png()
197	            except:
198	                pass
199	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:217:12
216	                save_canarydrop(canarydrop)
217	            except:
218	                pass
219	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:231:12
230	                save_canarydrop(canarydrop)
231	            except:
232	                pass
233	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\httpd_site.py:264:20
263	                #create a random local filename
264	                r = hashlib.md5(os.urandom(32)).hexdigest()
265	                filepath = os.path.join(settings.WEB_IMAGE_UPLOAD_PATH,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:281:12
280	                save_canarydrop(canarydrop)
281	            except:
282	                pass
283	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:313:12
312	                response['file_contents'] = "data:octet/stream;base64,"+base64.b64encode(signed_contents)
313	            except:
314	                pass
315	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:325:12
324	                save_canarydrop(canarydrop)
325	            except:
326	                pass
327	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\httpd_site.py:337:12
336	                save_canarydrop(canarydrop)
337	            except:
338	                pass
339	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'wireguard'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\httpd_site.py:340:29
339	
340	            if token_type == 'wireguard':
341	                canarydrop['wg_key'] = wg.generateCanarytokenPrivateKey(canarydrop["canarytoken"])

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\httpd_site.py:581:28
580	            except (TypeError, IndexError):
581	                token_fmt = ''
582	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\msexcel.py:32:13
31	    created_ts = format_time_for_doc(now - datetime.timedelta(
32	        days=random.randint(1,25),
33	        hours=random.randint(1,24),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\msexcel.py:33:14
32	        days=random.randint(1,25),
33	        hours=random.randint(1,24),
34	        seconds=random.randint(1,60)))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\msexcel.py:34:16
33	        hours=random.randint(1,24),
34	        seconds=random.randint(1,60)))
35	    with ZipFile(input_buf, 'r') as doc:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\msword.py:32:13
31	    created_ts = format_time_for_doc(now - datetime.timedelta(
32	        days=random.randint(1,25),
33	        hours=random.randint(1,24),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\msword.py:33:14
32	        days=random.randint(1,25),
33	        hours=random.randint(1,24),
34	        seconds=random.randint(1,60)))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\msword.py:34:16
33	        hours=random.randint(1,24),
34	        seconds=random.randint(1,60)))
35	    with ZipFile(input_buf, 'r') as doc:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mysql.py:37:33
36	
37	DUMP_HEADER = DUMP_HEADER.format(random.choice(DATABASE_NAMES))
38	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\mysql.py:78:18
77	
78	    table_count = random.choice(range(MIN_TABLE_COUNT, len(TABLE_LIST) + 1))
79	    tables = random.sample(TABLE_LIST, table_count)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\pdfgen.py:20:32
19	    while len(candidate_stream) < old_len and count < 1000:
20	        padding = ''.join([ chr(random.randrange(65,90)) for x in range(0,count)])
21	        candidate_stream = zlib.compress(zlib.decompress(stream).replace(search, replace+'/'+padding))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'gif'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\settings.py:34:13
33	
34	TOKEN_RETURN="gif" #could be gif, fortune
35	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\settings.py:108:18
107	TWILIO_ACCOUNT_SID=""
108	TWILIO_AUTH_TOKEN=""

--------------------------------------------------

Code scanned:
	Total lines of code: 4246
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 33
		Medium: 3
		High: 4
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 8
		High: 32
Files skipped (11):
	.\channel_input_mtls.py (syntax error while parsing AST from file)
	.\channel_input_smtp.py (syntax error while parsing AST from file)
	.\channel_output_email.py (syntax error while parsing AST from file)
	.\kubeconfig.py (syntax error while parsing AST from file)
	.\queries.py (syntax error while parsing AST from file)
	.\redismanager.py (syntax error while parsing AST from file)
	.\setup_db.py (syntax error while parsing AST from file)
	.\sign_file.py (syntax error while parsing AST from file)
	.\tokens.py (syntax error while parsing AST from file)
	.\wireguard.py (syntax error while parsing AST from file)
	.\ziplib.py (syntax error while parsing AST from file)
