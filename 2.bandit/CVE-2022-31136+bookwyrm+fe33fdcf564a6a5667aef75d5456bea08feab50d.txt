Working... ---------------------------------------- 100% 0:00:06
Run started:2024-02-10 22:48:46.329449

Test results:
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\bookwyrm\apps.py:18:13
17	        os.makedirs(os.path.dirname(destination))
18	        with urllib.request.urlopen(url) as stream:
19	            with open(destination, "b+w") as outfile:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'input'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\forms\custom_form.py:13:20
12	        css_classes["text"] = "input"
13	        css_classes["password"] = "input"
14	        css_classes["email"] = "input"

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module RSA are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\models\activitypub_mixin.py:12:0
11	
12	from Crypto.PublicKey import RSA
13	from Crypto.Signature import pkcs1_15

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module pkcs1_15 are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\models\activitypub_mixin.py:13:0
12	from Crypto.PublicKey import RSA
13	from Crypto.Signature import pkcs1_15
14	from Crypto.Hash import SHA256

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module SHA256 are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\models\activitypub_mixin.py:14:0
13	from Crypto.Signature import pkcs1_15
14	from Crypto.Hash import SHA256
15	from django.apps import apps

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\bookwyrm\models\activitypub_mixin.py:530:15
529	
530	    response = requests.post(
531	        destination,
532	        data=data,
533	        headers={
534	            "Date": now,
535	            "Digest": digest,
536	            "Signature": make_signature(sender, destination, now, digest),
537	            "Content-Type": "application/activity+json; charset=utf-8",
538	            "User-Agent": USER_AGENT,
539	        },
540	    )
541	    if not response.ok:

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module Random are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\models\base_model.py:3:0
2	import base64
3	from Crypto import Random
4	

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module Random are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\signatures.py:7:0
6	
7	from Crypto import Random
8	from Crypto.PublicKey import RSA

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module RSA are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\signatures.py:8:0
7	from Crypto import Random
8	from Crypto.PublicKey import RSA
9	from Crypto.Signature import pkcs1_15  # pylint: disable=no-name-in-module

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module pkcs1_15 are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\signatures.py:9:0
8	from Crypto.PublicKey import RSA
9	from Crypto.Signature import pkcs1_15  # pylint: disable=no-name-in-module
10	from Crypto.Hash import SHA256

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module SHA256 are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\bookwyrm\signatures.py:10:0
9	from Crypto.Signature import pkcs1_15  # pylint: disable=no-name-in-module
10	from Crypto.Hash import SHA256
11	

--------------------------------------------------
>> Issue: [B505:weak_cryptographic_key] RSA key sizes below 2048 bits are considered breakable. 
   Severity: Medium   Confidence: High
   CWE: CWE-326 (https://cwe.mitre.org/data/definitions/326.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b505_weak_cryptographic_key.html
   Location: .\bookwyrm\signatures.py:18:10
17	    random_generator = Random.new().read
18	    key = RSA.generate(1024, random_generator)
19	    private_key = key.export_key().decode("utf8")

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\bookwyrm\templatetags\utilities.py:87:19
86	        if hasattr(value, "bio") and auth_isni == re.sub(r"\D", "", str(value.isni)):
87	            return mark_safe(f"Author of <em>{value.bio}</em>")
88	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\bookwyrm\templatetags\utilities.py:87:19
86	        if hasattr(value, "bio") and auth_isni == re.sub(r"\D", "", str(value.isni)):
87	            return mark_safe(f"Author of <em>{value.bio}</em>")
88	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\bookwyrm\templatetags\utilities.py:102:19
101	            isni = value.isni
102	            return mark_safe(
103	                f'<input type="text" name="isni-for-{author.id}" value="{isni}" hidden>'
104	            )
105	    return ""

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\bookwyrm\templatetags\utilities.py:102:19
101	            isni = value.isni
102	            return mark_safe(
103	                f'<input type="text" name="isni-for-{author.id}" value="{isni}" hidden>'
104	            )
105	    return ""

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\bookwyrm\tests\views\admin\test_ip_blocklist.py:47:31
46	        form = forms.IPBlocklistForm()
47	        form.data["address"] = "0.0.0.0"
48	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\bookwyrm\tests\views\admin\test_ip_blocklist.py:60:40
59	        block = models.IPBlocklist.objects.get()
60	        self.assertEqual(block.address, "0.0.0.0")
61	        self.assertTrue(block.is_active)

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\bookwyrm\tests\views\admin\test_ip_blocklist.py:65:58
64	        """there are so many views, this just makes sure it LOADS"""
65	        block = models.IPBlocklist.objects.create(address="0.0.0.0")
66	        view = views.IPBlocklist.as_view()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\tests\views\landing\test_login.py:58:18
57	        form.data["localname"] = "mouse@mouse.com"
58	        form.data["password"] = "password"
59	        request = self.factory.post("", form.data)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\tests\views\landing\test_login.py:72:18
71	        form.data["localname"] = "mouse@your.domain.here"
72	        form.data["password"] = "password"
73	        request = self.factory.post("", form.data)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\tests\views\landing\test_login.py:86:18
85	        form.data["localname"] = "mouse"
86	        form.data["password"] = "password"
87	        request = self.factory.post("", form.data)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'passsword1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\tests\views\landing\test_login.py:100:18
99	        form.data["localname"] = "mouse"
100	        form.data["password"] = "passsword1"
101	        request = self.factory.post("", form.data)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\tests\views\preferences\test_delete_user.py:64:18
63	        form = forms.DeleteUserForm()
64	        form.data["password"] = "password"
65	        request = self.factory.post("", form.data)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'mouseword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\bookwyrm\tests\views\test_setup.py:64:18
63	        form.data["localname"] = "mouse"
64	        form.data["password"] = "mouseword"
65	        form.data["email"] = "aaa@bbb.ccc"

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\bookwyrm\utils\isni.py:2:0
1	"""ISNI author checking utilities"""
2	import xml.etree.ElementTree as ET
3	import requests

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\bookwyrm\utils\isni.py:84:11
83	    # parse xml
84	    root = ET.fromstring(payload)
85	    # build list of possible authors

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.fromstring with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\bookwyrm\utils\isni.py:131:11
130	    # parse xml
131	    root = ET.fromstring(payload)
132	    # there should only be a single responseRecord

--------------------------------------------------

Code scanned:
	Total lines of code: 41062
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 8
		Medium: 12
		High: 8
	Total issues (by confidence):
		Undefined: 0
		Low: 1
		Medium: 10
		High: 17
Files skipped (0):
