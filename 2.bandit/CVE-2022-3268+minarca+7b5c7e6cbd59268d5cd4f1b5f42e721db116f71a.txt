Working... ---------------------------------------- 100% 0:00:00
Run started:2024-02-10 22:50:50.783877

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-client\minarca_client\core\__init__.py:15:0
14	import signal
15	import subprocess
16	import threading

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\minarca-client\minarca_client\core\__init__.py:102:8
101	                set_keepawake(keep_screen_awake=False)
102	        except Exception:
103	            pass
104	        logger.info("backup START")

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\minarca-client\minarca_client\core\__init__.py:142:8
141	                unset_keepawake(keep_screen_awake=False)
142	        except Exception:
143	            pass
144	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\core\__init__.py:197:16
196	            )
197	            p = subprocess.Popen(
198	                [get_minarca_exe(), 'backup', '--force'],
199	                stdin=None,
200	                stdout=subprocess.DEVNULL,
201	                stderr=subprocess.DEVNULL,
202	                close_fds=True,
203	                creationflags=creationflags,
204	            )
205	            return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\__init__.py:481:8
480	    def set_patterns(self, patterns):
481	        assert isinstance(patterns, list), 'patterns should be a list'
482	        p = Patterns(self.patterns_file)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\__init__.py:541:8
540	        # Create HTTP Session using authentication
541	        assert username
542	        assert password

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\__init__.py:542:8
541	        assert username
542	        assert password
543	        self.username = username

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-client\minarca_client\core\compat.py:15:0
14	import shutil
15	import subprocess
16	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\core\compat.py:213:4
212	    tmp = tempfile.TemporaryDirectory()
213	    subprocess.run(
214	        [get_ssh_keygen(), '-b', str(length), '-t', 'rsa', '-f', os.path.join(tmp.name, 'id_rsa'), '-q', '-N', ''],
215	        stdout=subprocess.PIPE,
216	        check=True,
217	        cwd=tmp.name,
218	        env={},
219	    )
220	    shutil.move(os.path.join(tmp.name, 'id_rsa'), private_key)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\minarca-client\minarca_client\core\compat.py:408:30
407	                if winerror == -2147024891:  # Access denied.
408	                    retcode = subprocess.call(['SCHTASKS.exe', '/Delete', '/TN', 'Minarca Backup', '/F'])
409	                    if retcode == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\core\compat.py:408:30
407	                if winerror == -2147024891:  # Access denied.
408	                    retcode = subprocess.call(['SCHTASKS.exe', '/Delete', '/TN', 'Minarca Backup', '/F'])
409	                    if retcode == 0:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\compat.py:464:12
463	            minarca = get_minarca_exe()
464	            assert minarca
465	            self.command = '%s backup' % minarca

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\config.py:61:8
60	    def __init__(self, filename):
61	        assert filename
62	        self.filename = filename

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\config.py:110:8
109	    def __init__(self, filename):
110	        assert filename
111	        self.filename = filename

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\config.py:152:8
151	    def __init__(self, filename):
152	        assert filename
153	        self.filename = filename

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\minarca-client\minarca_client\core\config.py:205:35
204	                    Pattern(False, "/sys", _("sys filesystem")),
205	                    Pattern(False, "/tmp", _("Temporary Folder")),
206	                    Pattern(False, "/run", _("Volatile program files")),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\config.py:220:8
219	    def write(self, f):
220	        assert f
221	        assert hasattr(f, 'write')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\config.py:221:8
220	        assert f
221	        assert hasattr(f, 'write')
222	        for pattern in self:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\core\exceptions.py:51:8
50	    def __init__(self, file_spec):
51	        assert file_spec
52	        # Try to remove 'b'pattern''

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-client\minarca_client\core\tests\test_backup.py:10:0
9	import os
10	import subprocess
11	import tempfile

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-client\minarca_client\core\tests\test_compat.py:10:0
9	import os
10	import subprocess
11	import sys

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\minarca-client\minarca_client\tests\test_main.py:69:8
68	        )
69	        mock_link.assert_called_once_with(
70	            remoteurl='https://localhost', username='foo', password='bar', name='repo', force=False
71	        )
72	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\minarca-client\minarca_client\tests\test_main.py:107:8
106	        )
107	        mock_backup.return_value.link.assert_called_once_with(
108	            remoteurl='https://localhost', username='foo', password='bar', repository_name='repo', force=False
109	        )
110	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\minarca-client\minarca_client\tests\test_main.py:117:8
116	        main.main(['link', '--remoteurl', 'https://localhost', '--username', 'foo', '--name', 'repo'])
117	        mock_backup.return_value.link.assert_called_once_with(
118	            remoteurl='https://localhost', username='foo', password='bar', repository_name='repo', force=False
119	        )
120	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bar'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\minarca-client\minarca_client\tests\test_main.py:145:8
144	        )
145	        mock_link.assert_called_once_with(
146	            remoteurl='https://localhost', username='foo', password='bar', name='repo', force=True
147	        )
148	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\ui\home.py:28:8
27	    def set_active_view(self, name):
28	        assert name in ['home', 'patterns', 'schedule', 'settings']
29	        self.data.active_view = name

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\minarca-client\minarca_client\ui\setup.py:135:21
134	        self.data.linking = False
135	        event_data = eval(event_data)
136	        tkinter.messagebox.showwarning(master=self.root, icon='warning', **event_data)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\minarca-client\minarca_client\ui\tests\test_setup.py:56:33
55	        self.dlg.data.username = 'test'
56	        self.dlg.data.password = 'test'
57	        self.dlg.data.remoteurl = 'http://examples.com'

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:5:0
4	import os
5	import subprocess
6	import tkinter

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:47:4
46	    svgfile = os.path.join(basedir, 'src', svgfile)
47	    assert os.path.isfile(svgfile), 'svgfile must be a file: %s' % svgfile
48	    # TODO Convert those image magic command line into Pillow.

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:66:4
65	        cmd = CONVERT + [svgfile, '-resize', f'{size}x{size}', f'{name}.png']
66	    subprocess.check_call(cmd, cwd=basedir)
67	    return name, f'{name}.png'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:75:4
74	    svgfile = os.path.join(basedir, 'src', svgfile)
75	    assert os.path.isfile(svgfile), 'svgfile must be a file: %s' % svgfile
76	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:102:8
101	        ]
102	        subprocess.check_call(cmd, cwd=basedir)
103	        yield f'{name}_{i:02d}', f'{name}_{i:02d}.png'

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:112:4
111	    cmd = ['icotool', '-c', '-o', f'{name}.ico'] + images
112	    subprocess.check_call(cmd, cwd=basedir)
113	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:117:4
116	    cmd = ['png2icns', f'{name}.icns'] + images
117	    subprocess.check_call(cmd, cwd=basedir)
118	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-client\minarca_client\ui\theme\generate.py:126:4
125	    themes_file = os.path.join(basedir, 'src', 'themes.json')
126	    assert os.path.isfile(themes_file)
127	    theme_name = 'minarca'

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-quota-api\minarca_quota_api\__init__.py:72:4
71	    """
72	    assert isinstance(logging.getLevelName(level), int)
73	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:13:0
12	import argparse
13	import subprocess
14	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:40:17
39	    try:
40	        output = subprocess.check_output(args, encoding='ascii', stderr=subprocess.STDOUT)
41	    except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:51:4
50	    """Get user disk quota and space."""
51	    assert pool
52	    assert projectid and isinstance(projectid, int), "projectid must be a number " + projectid

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:52:4
51	    assert pool
52	    assert projectid and isinstance(projectid, int), "projectid must be a number " + projectid
53	    args = [

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:66:17
65	    try:
66	        output = subprocess.check_output(args, encoding='ascii', stderr=subprocess.STDOUT)
67	    except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:86:4
85	    """Update the user quota. Return True if quota update is successful."""
86	    assert pool
87	    assert quota and isinstance(quota, int), "quota must be a number " + quota

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:87:4
86	    assert pool
87	    assert quota and isinstance(quota, int), "quota must be a number " + quota
88	    assert projectid and isinstance(projectid, int), "projectid must be a number " + projectid

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:88:4
87	    assert quota and isinstance(quota, int), "quota must be a number " + quota
88	    assert projectid and isinstance(projectid, int), "projectid must be a number " + projectid
89	    args = ['/sbin/zfs', 'set', 'projectquota@%s=%s' % (projectid, quota), pool]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-quota-api\minarca_quota_api\zfs_quota.py:91:8
90	    try:
91	        subprocess.check_output(args, encoding='ascii', stderr=subprocess.STDOUT)
92	    except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\minarca-server\minarca_server\core\contexts.py:27:0
26	import os
27	import pickle
28	import signal

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-server\minarca_server\core\namespaces.py:9:0
8	import socket
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\minarca-server\minarca_server\core\namespaces.py:238:8
237	    try:
238	        subprocess.call(['ip', 'link', 'set', 'up', 'lo'])
239	    except OSError as e:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\core\namespaces.py:238:8
237	    try:
238	        subprocess.call(['ip', 'link', 'set', 'up', 'lo'])
239	    except OSError as e:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-server\minarca_server\plugins\minarca.py:12:0
11	import stat
12	import subprocess
13	from io import StringIO, open

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-server\minarca_server\plugins\minarca.py:126:8
125	        """
126	        assert isinstance(userobj, UserObject)
127	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-server\minarca_server\plugins\minarca.py:243:8
242	        """
243	        assert isinstance(userobj, UserObject)
244	        # Get Quota from web service

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\plugins\minarca.py:287:12
286	            # Add +P attribute to user's home directory
287	            subprocess.check_output(["/usr/bin/chattr", "-R", "+P", userobj.user_root], stderr=subprocess.STDOUT)
288	            # Force project id on directory

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\plugins\minarca.py:289:12
288	            # Force project id on directory
289	            subprocess.check_output(
290	                ["/usr/bin/chattr", "-R", "-p", str(userobj.userid), userobj.user_root], stderr=subprocess.STDOUT
291	            )
292	        except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-server\minarca_server\shell.py:15:0
14	import os
15	import subprocess
16	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\shell.py:53:8
52	    with Jail(userroot):
53	        subprocess.check_call(args, cwd=userroot, env={'LANG': 'en_US.utf-8', 'TZ': tz, 'HOME': userroot})
54	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\minarca-server\minarca_server\shell.py:57:4
56	def _find_rdiff_backup(version=2):
57	    assert version in [1, 2], 'rdiff-backup version unsupported'
58	    if version == 1:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\shell.py:123:8
122	        # Used by backup-ninja to verify connectivity
123	        subprocess.check_call(
124	            ssh_original_command.split(' '),
125	            env={'LANG': 'en_US.utf-8'},
126	            stdout=sys.stdout.fileno(),
127	            stderr=sys.stderr.fileno(),
128	        )
129	    elif ssh_original_command in ["/usr/bin/rdiff-backup -V"]:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\shell.py:131:8
130	        rdiff_backup = _find_rdiff_backup()
131	        subprocess.check_call(
132	            [rdiff_backup, '-V'], env={'LANG': 'en_US.utf-8'}, stdout=sys.stdout.fileno(), stderr=sys.stderr.fileno()
133	        )
134	    else:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\minarca-server\minarca_server\tests\test_shell.py:17:0
16	import shutil
17	import subprocess
18	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:44:8
43	            os.remove(OUTPUT)
44	        except Exception:
45	            pass
46	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:90:55
89	            del os.environ["SSH_ORIGINAL_COMMAND"]
90	        rdiff_backup_jail_mock.assert_called_once_with('/tmp/backups/joe', ['/usr/bin/rdiff-backup', '--server'])
91	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:106:55
105	            del os.environ["SSH_ORIGINAL_COMMAND"]
106	        rdiff_backup_jail_mock.assert_called_once_with('/tmp/backups/joe', ['/usr/bin/rdiff-backup', '--server'])
107	        find_rdiff_backup_mock.assert_called_once_with(version=1)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:123:55
122	            del os.environ["SSH_ORIGINAL_COMMAND"]
123	        rdiff_backup_jail_mock.assert_called_once_with('/tmp/backups/joe', ['/usr/bin/rdiff-backup', '--server'])
124	        find_rdiff_backup_mock.assert_called_once_with(version=1)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:140:55
139	            del os.environ["SSH_ORIGINAL_COMMAND"]
140	        rdiff_backup_jail_mock.assert_called_once_with('/tmp/backups/joe', ['/usr/bin/rdiff-backup', '--server'])
141	        find_rdiff_backup_mock.assert_called_once_with(version=2)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:162:12
161	        with Jail(USERROOT):
162	            subprocess.check_call(['ps'], stdout=subprocess.PIPE)
163	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\minarca-server\minarca_server\tests\test_shell.py:162:12
161	        with Jail(USERROOT):
162	            subprocess.check_call(['ps'], stdout=subprocess.PIPE)
163	

--------------------------------------------------

Code scanned:
	Total lines of code: 5499
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 62
		Medium: 6
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 10
		High: 58
Files skipped (0):
