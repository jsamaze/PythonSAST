Working... ---------------------------------------- 100% 0:00:02
Run started:2024-02-10 22:53:20.933972

Test results:
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\libexec\notify_by_email.py:247:4
246	        mail.attach(msgLogo)
247	    except:
248	        pass
249	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\libexec\notify_by_email.py:501:12
500	        logging.debug('Send the mail')
501	        p = os.popen('%s -t' % sendmail, 'w')
502	        logging.debug('Final mail : ' + mail.as_string())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\libexec\send_nsca.py:46:8
45	        # line consists of host, service, rc, output
46	        assert len(notif) == 4
47	        notif.svc_result(*notif)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\manpages\generate_manpages.py:10:0
9	    locale.setlocale(locale.LC_ALL, '')
10	except:
11	    pass
12	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\shinken\brok.py:25:0
24	
25	import cPickle
26	from shinken.safepickle import SafeUnpickler

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\shinken\db.py:80:16
79	        """
80	        query = u"UPDATE %s set " % (self.table_prefix + table)
81	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\shinken\dispatcher.py:397:43
396	                        # We give this configuration a new 'flavor'
397	                        conf.push_flavor = random.randint(1, 1000000)
398	                        # REF: doc/shinken-conf-dispatching.png (3)

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\shinken\safepickle.py:25:0
24	import sys
25	import cPickle
26	from cStringIO import StringIO

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test\test_command.py:36:29
35	        t = {'command_name': 'check_command_test',
36	             'command_line': '/tmp/dummy_command.sh $ARG1$ $ARG2$',
37	             'poller_tag': 'DMZ'
38	             }
39	        c = Command(t)
40	        self.assertEqual('check_command_test', c.command_name)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'root'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\test\test_db_mysql.py:37:18
36	    def create_db(self):
37	        self.db = DBMysql(host='localhost', user='root', password='root', database='merlin', character_set='utf8')
38	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\test\test_db_mysql.py:45:8
44	            self.db.connect_database()
45	        except Exception:  # arg, no database here? sic!
46	            pass
47	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\test\test_db_mysql.py:56:8
55	            self.db.execute_query(q)
56	        except Exception:
57	            pass
58	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with cPickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\test\test_logging.py:29:0
28	import time
29	import cPickle
30	from cStringIO import StringIO

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\test\test_logging.py:150:12
149	                os.remove(self.logfile_name)
150	            except Exception: # On windows, the file is still lock. But should be close!?!
151	                pass
152	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_reversed_list.py:40:8
39	        sg = self.sched.servicegroups.find_by_name('servicegroup_01')
40	        assert(prev_id != sg.id)
41	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_reversed_list.py:46:12
45	            sg = self.sched.servicegroups.find_by_name(sname)
46	            assert(sname is not None)
47	

--------------------------------------------------

Code scanned:
	Total lines of code: 44248
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 13
		Medium: 2
		High: 1
	Total issues (by confidence):
		Undefined: 0
		Low: 1
		Medium: 2
		High: 13
Files skipped (182):
	.\cli\desc\cli.py (syntax error while parsing AST from file)
	.\cli\doc\cli.py (syntax error while parsing AST from file)
	.\cli\shinkenio\cli.py (syntax error while parsing AST from file)
	.\contrib\clients\TSCA\python\PythonClient.py (syntax error while parsing AST from file)
	.\contrib\install.d\tools\checkmodule.py (syntax error while parsing AST from file)
	.\contrib\livestatus\splitlivelogs.py (syntax error while parsing AST from file)
	.\contrib\livestatus\sql2mdb.py (syntax error while parsing AST from file)
	.\contrib\nsca\nsca_client.py (syntax error while parsing AST from file)
	.\doc\tools\doc_shinken_scrapper.py (syntax error while parsing AST from file)
	.\doc\tools\doku2rst.py (syntax error while parsing AST from file)
	.\libexec\discovery\SAN_discover_runner.py (syntax error while parsing AST from file)
	.\libexec\discovery\cluster_discovery_runner.py (syntax error while parsing AST from file)
	.\libexec\discovery\fs_discovery_runner.py (syntax error while parsing AST from file)
	.\libexec\discovery\nmap_discovery_runner.py (syntax error while parsing AST from file)
	.\libexec\discovery\vmware_discovery_runner.py (syntax error while parsing AST from file)
	.\libexec\discovery\windows_shares_discovery_runner.py (syntax error while parsing AST from file)
	.\libexec\dump_vmware_hosts.py (syntax error while parsing AST from file)
	.\libexec\external_mapping.py (syntax error while parsing AST from file)
	.\libexec\link_libvirt_host_vm.py (syntax error while parsing AST from file)
	.\libexec\link_vmware_host_vm.py (syntax error while parsing AST from file)
	.\libexec\link_xen_host_vm.py (syntax error while parsing AST from file)
	.\libexec\notify_by_xmpp.py (syntax error while parsing AST from file)
	.\libexec\service_dependency_mapping.py (syntax error while parsing AST from file)
	.\modules\dummy_poller\module.py (syntax error while parsing AST from file)
	.\setup.py (syntax error while parsing AST from file)
	.\shinken\action.py (syntax error while parsing AST from file)
	.\shinken\complexexpression.py (syntax error while parsing AST from file)
	.\shinken\daemon.py (syntax error while parsing AST from file)
	.\shinken\daemons\arbiterdaemon.py (syntax error while parsing AST from file)
	.\shinken\daemons\brokerdaemon.py (syntax error while parsing AST from file)
	.\shinken\daemons\receiverdaemon.py (syntax error while parsing AST from file)
	.\shinken\daemons\schedulerdaemon.py (syntax error while parsing AST from file)
	.\shinken\db_mysql.py (syntax error while parsing AST from file)
	.\shinken\db_oracle.py (syntax error while parsing AST from file)
	.\shinken\dependencynode.py (syntax error while parsing AST from file)
	.\shinken\discovery\discoverymanager.py (syntax error while parsing AST from file)
	.\shinken\easter.py (syntax error while parsing AST from file)
	.\shinken\external_command.py (syntax error while parsing AST from file)
	.\shinken\graph.py (syntax error while parsing AST from file)
	.\shinken\http_client.py (syntax error while parsing AST from file)
	.\shinken\http_daemon.py (syntax error while parsing AST from file)
	.\shinken\load.py (syntax error while parsing AST from file)
	.\shinken\log.py (syntax error while parsing AST from file)
	.\shinken\macroresolver.py (syntax error while parsing AST from file)
	.\shinken\misc\datamanager.py (syntax error while parsing AST from file)
	.\shinken\misc\md5crypt.py (syntax error while parsing AST from file)
	.\shinken\misc\perfdata.py (syntax error while parsing AST from file)
	.\shinken\misc\regenerator.py (syntax error while parsing AST from file)
	.\shinken\modulesmanager.py (syntax error while parsing AST from file)
	.\shinken\objects\arbiterlink.py (syntax error while parsing AST from file)
	.\shinken\objects\config.py (syntax error while parsing AST from file)
	.\shinken\objects\contact.py (syntax error while parsing AST from file)
	.\shinken\objects\host.py (syntax error while parsing AST from file)
	.\shinken\objects\hostdependency.py (syntax error while parsing AST from file)
	.\shinken\objects\item.py (syntax error while parsing AST from file)
	.\shinken\objects\matchingitem.py (syntax error while parsing AST from file)
	.\shinken\objects\pack.py (syntax error while parsing AST from file)
	.\shinken\objects\receiverlink.py (syntax error while parsing AST from file)
	.\shinken\objects\satellitelink.py (syntax error while parsing AST from file)
	.\shinken\objects\schedulerlink.py (syntax error while parsing AST from file)
	.\shinken\objects\schedulingitem.py (syntax error while parsing AST from file)
	.\shinken\objects\service.py (syntax error while parsing AST from file)
	.\shinken\objects\servicedependency.py (syntax error while parsing AST from file)
	.\shinken\objects\timeperiod.py (syntax error while parsing AST from file)
	.\shinken\objects\trigger.py (syntax error while parsing AST from file)
	.\shinken\property.py (syntax error while parsing AST from file)
	.\shinken\satellite.py (syntax error while parsing AST from file)
	.\shinken\scheduler.py (syntax error while parsing AST from file)
	.\shinken\stats.py (syntax error while parsing AST from file)
	.\shinken\util.py (syntax error while parsing AST from file)
	.\shinken\webui\bottlecore.py (syntax error while parsing AST from file)
	.\shinken\webui\bottlewebui.py (syntax error while parsing AST from file)
	.\shinken\worker.py (syntax error while parsing AST from file)
	.\test\libexec\hot_dep_export.py (syntax error while parsing AST from file)
	.\test\libexec\nmap_wrapper.py (syntax error while parsing AST from file)
	.\test\shinken_modules.py (syntax error while parsing AST from file)
	.\test\shinken_test.py (syntax error while parsing AST from file)
	.\test\test_acknowledge.py (syntax error while parsing AST from file)
	.\test\test_acknowledge_with_expire.py (syntax error while parsing AST from file)
	.\test\test_action.py (syntax error while parsing AST from file)
	.\test\test_bad_contact_call.py (syntax error while parsing AST from file)
	.\test\test_bad_escalation_on_groups.py (syntax error while parsing AST from file)
	.\test\test_bad_notification_character.py (syntax error while parsing AST from file)
	.\test\test_bad_start.py (syntax error while parsing AST from file)
	.\test\test_bad_timeperiods.py (syntax error while parsing AST from file)
	.\test\test_business_correlator.py (syntax error while parsing AST from file)
	.\test\test_business_correlator_expand_expression.py (syntax error while parsing AST from file)
	.\test\test_checkmodulations.py (syntax error while parsing AST from file)
	.\test\test_clean_sched_queues.py (syntax error while parsing AST from file)
	.\test\test_commands_perfdata.py (syntax error while parsing AST from file)
	.\test\test_complex_hostgroups.py (syntax error while parsing AST from file)
	.\test\test_contactdowntimes.py (syntax error while parsing AST from file)
	.\test\test_contactgroup_nomembers.py (syntax error while parsing AST from file)
	.\test\test_contactgroups_plus_inheritance.py (syntax error while parsing AST from file)
	.\test\test_critmodulation.py (syntax error while parsing AST from file)
	.\test\test_css_in_command.py (syntax error while parsing AST from file)
	.\test\test_db.py (syntax error while parsing AST from file)
	.\test\test_definition_order.py (syntax error while parsing AST from file)
	.\test\test_dependencies.py (syntax error while parsing AST from file)
	.\test\test_disable_active_checks.py (syntax error while parsing AST from file)
	.\test\test_discovery_def.py (syntax error while parsing AST from file)
	.\test\test_dispatcher.py (syntax error while parsing AST from file)
	.\test\test_dot_virg_in_command.py (syntax error while parsing AST from file)
	.\test\test_downtimes.py (syntax error while parsing AST from file)
	.\test\test_dummy.py (syntax error while parsing AST from file)
	.\test\test_end_parsing_types.py (syntax error while parsing AST from file)
	.\test\test_escalations.py (syntax error while parsing AST from file)
	.\test\test_eventids.py (syntax error while parsing AST from file)
	.\test\test_external_commands.py (syntax error while parsing AST from file)
	.\test\test_external_mapping.py (syntax error while parsing AST from file)
	.\test\test_flapping.py (syntax error while parsing AST from file)
	.\test\test_freshness.py (syntax error while parsing AST from file)
	.\test\test_global_event_handlers.py (syntax error while parsing AST from file)
	.\test\test_groups_pickle.py (syntax error while parsing AST from file)
	.\test\test_groups_with_no_alias.py (syntax error while parsing AST from file)
	.\test\test_host_extented_info.py (syntax error while parsing AST from file)
	.\test\test_host_missing_adress.py (syntax error while parsing AST from file)
	.\test\test_hostdep_with_multiple_names.py (syntax error while parsing AST from file)
	.\test\test_hostdep_withno_depname.py (syntax error while parsing AST from file)
	.\test\test_hosts.py (syntax error while parsing AST from file)
	.\test\test_illegal_names.py (syntax error while parsing AST from file)
	.\test\test_inheritance_and_plus.py (syntax error while parsing AST from file)
	.\test\test_macromodulations.py (syntax error while parsing AST from file)
	.\test\test_macroresolver.py (syntax error while parsing AST from file)
	.\test\test_maintenance_period.py (syntax error while parsing AST from file)
	.\test\test_missing_cariarereturn.py (syntax error while parsing AST from file)
	.\test\test_missing_object_value.py (syntax error while parsing AST from file)
	.\test\test_module_on_module.py (syntax error while parsing AST from file)
	.\test\test_modulemanager.py (syntax error while parsing AST from file)
	.\test\test_multi_hostgroups_def.py (syntax error while parsing AST from file)
	.\test\test_multiple_not_hostgroups.py (syntax error while parsing AST from file)
	.\test\test_no_event_handler_during_downtime.py (syntax error while parsing AST from file)
	.\test\test_no_host_template.py (syntax error while parsing AST from file)
	.\test\test_no_notification_period.py (syntax error while parsing AST from file)
	.\test\test_nohostsched.py (syntax error while parsing AST from file)
	.\test\test_non_stripped_list.py (syntax error while parsing AST from file)
	.\test\test_not_execute_host_check.py (syntax error while parsing AST from file)
	.\test\test_not_hostname.py (syntax error while parsing AST from file)
	.\test\test_notif_macros.py (syntax error while parsing AST from file)
	.\test\test_notif_too_much.py (syntax error while parsing AST from file)
	.\test\test_notification_warning.py (syntax error while parsing AST from file)
	.\test\test_notifications.py (syntax error while parsing AST from file)
	.\test\test_notifway.py (syntax error while parsing AST from file)
	.\test\test_objects_and_notifways.py (syntax error while parsing AST from file)
	.\test\test_obsess.py (syntax error while parsing AST from file)
	.\test\test_on_demand_event_handlers.py (syntax error while parsing AST from file)
	.\test\test_orphaned.py (syntax error while parsing AST from file)
	.\test\test_passive_pollers.py (syntax error while parsing AST from file)
	.\test\test_poller_addition.py (syntax error while parsing AST from file)
	.\test\test_poller_tag_get_checks.py (syntax error while parsing AST from file)
	.\test\test_problem_impact.py (syntax error while parsing AST from file)
	.\test\test_properties_defaults.py (syntax error while parsing AST from file)
	.\test\test_protect_esclamation_point.py (syntax error while parsing AST from file)
	.\test\test_python_crash_with_recursive_bp_rules.py (syntax error while parsing AST from file)
	.\test\test_reactionner_tag_get_notif.py (syntax error while parsing AST from file)
	.\test\test_realms.py (syntax error while parsing AST from file)
	.\test\test_regenerator.py (syntax error while parsing AST from file)
	.\test\test_safe_pickle.py (syntax error while parsing AST from file)
	.\test\test_satellites.py (syntax error while parsing AST from file)
	.\test\test_scheduler_init.py (syntax error while parsing AST from file)
	.\test\test_service_description_inheritance.py (syntax error while parsing AST from file)
	.\test\test_service_generators.py (syntax error while parsing AST from file)
	.\test\test_service_template_inheritance.py (syntax error while parsing AST from file)
	.\test\test_service_tpl_on_host_tpl.py (syntax error while parsing AST from file)
	.\test\test_servicedependency_complexes.py (syntax error while parsing AST from file)
	.\test\test_servicedependency_explode_hostgroup.py (syntax error while parsing AST from file)
	.\test\test_servicedependency_implicit_hostgroup.py (syntax error while parsing AST from file)
	.\test\test_services.py (syntax error while parsing AST from file)
	.\test\test_servicetpl_no_hostname.py (syntax error while parsing AST from file)
	.\test\test_snapshot.py (syntax error while parsing AST from file)
	.\test\test_spaces_in_commands.py (syntax error while parsing AST from file)
	.\test\test_sslv3_disabled.py (syntax error while parsing AST from file)
	.\test\test_star_in_hostgroups.py (syntax error while parsing AST from file)
	.\test\test_startmember_group.py (syntax error while parsing AST from file)
	.\test\test_strange_characters_commands.py (syntax error while parsing AST from file)
	.\test\test_system_time_change.py (syntax error while parsing AST from file)
	.\test\test_timeout.py (syntax error while parsing AST from file)
	.\test\test_timeperiod_inheritance.py (syntax error while parsing AST from file)
	.\test\test_timeperiods.py (syntax error while parsing AST from file)
	.\test\test_triggers.py (syntax error while parsing AST from file)
	.\test\test_unknown_do_not_change.py (syntax error while parsing AST from file)
	.\test\test_update_output_ext_command.py (syntax error while parsing AST from file)
