Working... ---------------------------------------- 100% 0:00:14
Run started:2024-02-10 22:55:43.025557

Test results:
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\.github\helper\ci.py:87:1
86			build_number = int(os.environ.get("BUILD_NUMBER"))
87		except Exception:
88			pass
89	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\.github\helper\ci.py:92:1
91			total_builds = int(os.environ.get("TOTAL_BUILDS"))
92		except Exception:
93			pass
94	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\.github\helper\documentation.py:33:12
32		pr = sys.argv[1]
33		response = requests.get(f"https://api.github.com/repos/frappe/frappe/pulls/{pr}")
34	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\.github\helper\roulette.py:5:0
4	import shlex
5	import subprocess
6	import sys

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\.github\helper\roulette.py:19:7
18		req = urllib.request.Request(api_url)
19		res = urllib.request.urlopen(req)
20		return json.loads(res.read().decode("utf8"))

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\.github\helper\roulette.py:30:8
29		command = shlex.split(command)
30		return subprocess.check_output(command, shell=shell, encoding="utf8").strip()
31	

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\.github\helper\roulette.py:82:2
81		if not pr_number:
82			os.system('echo "::set-output name=build::strawberry"')
83			sys.exit(0)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\.github\helper\roulette.py:82:2
81		if not pr_number:
82			os.system('echo "::set-output name=build::strawberry"')
83			sys.exit(0)

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\.github\helper\roulette.py:125:1
124	
125		os.system('echo "::set-output name=build::strawberry"')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\.github\helper\roulette.py:125:1
124	
125		os.system('echo "::set-output name=build::strawberry"')

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\frappe\__init__.py:2269:8
2268		eval_globals.update(whitelisted_globals)
2269		return eval(code, eval_globals, eval_locals)
2270	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\__init__.py:2358:1
2357			param = param.encode(encoding)
2358		except Exception:
2359			pass
2360		return param

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\__init__.py:2366:1
2365			param = param.decode(encoding)
2366		except Exception:
2367			pass
2368		return param

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\frappe\app.py:372:2
371		run_simple(
372			"0.0.0.0",
373			int(port),
374			application,
375			use_reloader=False if in_test_env else not no_reload,
376			use_debugger=not in_test_env,
377			use_evalex=not in_test_env,
378			threaded=not no_threading,
379		)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\boot.py:409:1
408			bootinfo.docs.append(frappe.get_cached_doc("Country", country))
409		except Exception:
410			pass
411	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\build.py:6:0
5	import shutil
6	import subprocess
7	from distutils.spawn import find_executable

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\build.py:8:0
7	from distutils.spawn import find_executable
8	from subprocess import getoutput
9	from tempfile import mkdtemp, mktemp

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\build.py:40:6
39		local_filename = os.path.join(prefix, filename)
40		with get(url, stream=True, allow_redirects=True) as r:
41			r.raise_for_status()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\build.py:93:8
92	
93		if not head(url):
94			reference = f"Release {tag}" if tag else f"Commit {frappe_head}"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\build.py:165:2
164				shutil.rmtree(os.path.dirname(assets_archive))
165			except Exception:
166				pass
167	

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\frappe\build.py:188:19
187		while True:
188			temp_link_name = mktemp(dir=link_dir)
189	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\build.py:301:1
300			safe_max_old_space_size = max(1024, int(total_memory * 0.75))
301		except Exception:
302			pass
303	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\frappe\commands\__init__.py:89:8
88			stderr=None if output else subprocess.PIPE,
89			shell=shell,
90			cwd=cwd,
91			preexec_fn=set_low_prio,
92			env=env,
93		)
94	
95		return_ = proc.wait()
96	
97		if return_ and raise_err:
98			raise subprocess.CalledProcessError(return_, command)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\commands\utils.py:3:0
2	import os
3	import subprocess
4	import sys

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\frappe\commands\utils.py:240:12
239					try:
240						args = eval(args)
241					except NameError:

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\frappe\commands\utils.py:247:13
246				if kwargs:
247					kwargs = eval(kwargs)
248				else:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\frappe\commands\utils.py:543:1
542		]
543		os.execv(mysql, command)
544	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\commands\utils.py:548:1
547		psql = find_executable("psql")
548		subprocess.run([psql, "-d", frappe.conf.db_name])
549	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\commands\utils.py:556:11
555			r.split("==")[0]
556			for r in subprocess.check_output([sys.executable, "-m", "pip", "freeze"], encoding="utf8")
557		)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\commands\utils.py:560:2
559		if "jupyter" not in installed_packages:
560			subprocess.check_output([sys.executable, "-m", "pip", "install", "jupyter"])
561	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\frappe\commands\utils.py:589:1
588		)
589		os.execv(
590			f"{bin_path}/jupyter",
591			[
592				f"{bin_path}/jupyter",
593				"notebook",
594				jupyter_notebooks_path,
595			],
596		)
597	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\contacts\doctype\address\address.py:82:3
81			address = frappe.db.sql(
82				""" SELECT
83					addr.name
84				FROM
85					`tabAddress` addr, `tabDynamic Link` dl
86				WHERE
87					dl.parent = addr.name and dl.link_doctype = %s and
88					dl.link_name = %s and ifnull(addr.disabled, 0) = 0 and
89					%s = %s
90				"""
91				% ("%s", "%s", preferred_key, "%s"),
92				(doctype, name, 1),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\contacts\doctype\address\address.py:109:2
108		out = frappe.db.sql(
109			""" SELECT
110				addr.name, addr.%s
111			FROM
112				`tabAddress` addr, `tabDynamic Link` dl
113			WHERE
114				dl.parent = addr.name and dl.link_doctype = %s and
115				dl.link_name = %s and ifnull(addr.disabled, 0) = 0
116			"""
117			% (sort_key, "%s", "%s"),
118			(doctype, name),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\contacts\doctype\address\address.py:254:2
253		return frappe.db.sql(
254			"""select
255				`tabAddress`.name, `tabAddress`.city, `tabAddress`.country
256			from
257				`tabAddress`, `tabDynamic Link`
258			where
259				`tabDynamic Link`.parent = `tabAddress`.name and
260				`tabDynamic Link`.parenttype = 'Address' and
261				`tabDynamic Link`.link_doctype = %(link_doctype)s and
262				`tabDynamic Link`.link_name = %(link_name)s and
263				ifnull(`tabAddress`.disabled, 0) = 0 and
264				({search_condition})
265				{mcond} {condition}
266			order by
267				if(locate(%(_txt)s, `tabAddress`.name), locate(%(_txt)s, `tabAddress`.name), 99999),
268				`tabAddress`.idx desc, `tabAddress`.name
269			limit %(start)s, %(page_len)s """.format(
270				mcond=get_match_cond(doctype),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\contacts\doctype\contact\contact.py:224:2
223		return frappe.db.sql(
224			"""select
225				`tabContact`.name, `tabContact`.first_name, `tabContact`.last_name
226			from
227				`tabContact`, `tabDynamic Link`
228			where
229				`tabDynamic Link`.parent = `tabContact`.name and
230				`tabDynamic Link`.parenttype = 'Contact' and
231				`tabDynamic Link`.link_doctype = %(link_doctype)s and
232				`tabDynamic Link`.link_name = %(link_name)s and
233				`tabContact`.`{key}` like %(txt)s
234				{mcond}
235			order by
236				if(locate(%(_txt)s, `tabContact`.name), locate(%(_txt)s, `tabContact`.name), 99999),
237				`tabContact`.idx desc, `tabContact`.name
238			limit %(start)s, %(page_len)s """.format(
239				mcond=get_match_cond(doctype), key=searchfield

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\core\doctype\access_log\test_access_log.py:160:13
159			try:
160				request = requests.post(private_file_link, headers=self.header)
161				last_doc = frappe.get_last_doc("Access Log")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\doctype\doctype.py:1213:5
1212					has_non_unique_values = frappe.db.sql(
1213						"""select `{fieldname}`, count(*)
1214						from `tab{doctype}` where ifnull(`{fieldname}`, '') != ''
1215						group by `{fieldname}` having count(*) > 1 limit 1""".format(
1216							doctype=d.parent, fieldname=d.fieldname

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\doctype\test_doctype.py:55:4
54				frappe.db.sql(
55					f"""select data_type FROM information_schema.columns
56					where column_name = 'name' and table_name = 'tab{self._testMethodName}'"""
57				)[0][0],

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\doctype\test_doctype.py:71:4
70				frappe.db.sql(
71					f"""select * from {table_name}
72					where {conditions}"""
73				)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\doctype\test_doctype.py:83:4
82				frappe.db.sql(
83					f"""select data_type FROM information_schema.columns
84					where column_name = 'name' and table_name = 'tab{self._testMethodName}'"""
85				)[0][0],

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\core\doctype\document_share_key\document_share_key.py:12:41
11		def before_insert(self):
12			self.key = frappe.generate_hash(length=randrange(25, 35))
13			if not self.expires_on and not self.flags.no_expiry:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\domain\domain.py:114:4
113				frappe.db.sql(
114					"""update `tabPortal Menu Item` set enabled=1
115					where route in ({})""".format(
116						", ".join(f'"{d}"' for d in self.data.allow_sidebar_items)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\domain\domain.py:126:4
125				frappe.db.sql(
126					"""update `tabPortal Menu Item` set enabled=0
127					where route in ({})""".format(
128						", ".join(f'"{d}"' for d in self.data.remove_sidebar_items)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\core\doctype\file\test_file.py:491:2
490				shutil.copy(file_path, public_file_path)
491			except Exception:
492				pass
493	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\core\doctype\file\test_file.py:522:2
521			).insert()
522			assert test_file is not None
523	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\core\doctype\file\utils.py:119:5
118		file_url = frappe.utils.get_url(file_url)
119		r = requests.get(file_url, stream=True)
120		try:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\log_settings\log_settings.py:178:3
177			frappe.db.sql(
178				f"""INSERT INTO `{temporary}`
179					SELECT * FROM `{original}`
180					WHERE `{original}`.`modified` > NOW() - INTERVAL '{days}' DAY"""
181			)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\core\doctype\package_import\package_import.py:6:0
5	import os
6	import subprocess
7	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\frappe\core\doctype\package_import\package_import.py:34:2
33			# extract
34			subprocess.check_output(
35				[
36					"tar",
37					"xzf",
38					frappe.get_site_path(attachment.file_url.strip("/")),
39					"-C",
40					frappe.get_site_path("packages"),
41				]
42			)
43	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\core\doctype\package_import\package_import.py:34:2
33			# extract
34			subprocess.check_output(
35				[
36					"tar",
37					"xzf",
38					frappe.get_site_path(attachment.file_url.strip("/")),
39					"-C",
40					frappe.get_site_path("packages"),
41				]
42			)
43	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\core\doctype\package_release\package_release.py:5:0
4	import os
5	import subprocess
6	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\frappe\core\doctype\package_release\package_release.py:91:2
90			filename = f"{self.name}.tar.gz"
91			subprocess.check_output(
92				["tar", "czf", filename, package.package_name], cwd=frappe.get_site_path("packages")
93			)
94	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\core\doctype\package_release\package_release.py:91:2
90			filename = f"{self.name}.tar.gz"
91			subprocess.check_output(
92				["tar", "czf", filename, package.package_name], cwd=frappe.get_site_path("packages")
93			)
94	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\frappe\core\doctype\package_release\package_release.py:96:2
95			# move file
96			subprocess.check_output(
97				["mv", frappe.get_site_path("packages", filename), frappe.get_site_path("public", "files")]
98			)
99	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\core\doctype\package_release\package_release.py:96:2
95			# move file
96			subprocess.check_output(
97				["mv", frappe.get_site_path("packages", filename), frappe.get_site_path("public", "files")]
98			)
99	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\page\page.py:29:5
28					cnt = frappe.db.sql(
29						"""select name from tabPage
30						where name like "%s-%%" order by name desc limit 1"""
31						% self.name
32					)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\core\doctype\server_script\test_server_script.py:122:13
121		def test_api(self):
122			response = requests.post(get_site_url(frappe.local.site) + "/api/method/test_server_script")
123			self.assertEqual(response.status_code, 200)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\core\doctype\sms_settings\sms_settings.py:125:13
124		if use_post:
125			response = requests.post(gateway_url, **kwargs)
126		else:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\core\doctype\sms_settings\sms_settings.py:127:13
126		else:
127			response = requests.get(gateway_url, **kwargs)
128		response.raise_for_status()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\system_settings\system_settings.py:21:33
20			elif not enable_password_policy:
21				self.minimum_password_score = ""
22	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\test_user.py:209:22
208			frappe.flags.in_test = False
209			user.new_password = "password"
210			self.assertRaises(frappe.exceptions.ValidationError, user.save)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Eastern_43A1W'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\test_user.py:212:22
211			user.reload()
212			user.new_password = "Eastern_43A1W"
213			user.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Eastern_43A1W'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\test_user.py:364:17
363	
364			old_password = "Eastern_43A1W"
365			new_password = "easy_password"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'easy_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\test_user.py:365:17
364			old_password = "Eastern_43A1W"
365			new_password = "easy_password"
366	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'new_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\test_user.py:446:17
445		def test_reset_password_link_expiry(self):
446			new_password = "new_password"
447			# set the reset password expiry to 1 second

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\user.py:70:22
69			self.__new_password = self.new_password
70			self.new_password = ""
71	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\user\user.py:463:5
462					frappe.db.sql(
463						"""UPDATE `%s`
464						SET `%s` = %s
465						WHERE `%s` = %s"""
466						% (tab, field, "%s", field, "%s"),
467						(new_name, old_name),

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\core\doctype\user\user.py:812:31
811		redirect_url = user_doc.redirect_url
812		user_doc.reset_password_key = ""
813		user_doc.redirect_url = ""

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\user\user.py:914:2
913		return frappe.db.sql(
914			"""SELECT `name`, CONCAT_WS(' ', first_name, middle_name, last_name)
915			FROM `tabUser`
916			WHERE `enabled`=1
917				{user_type_condition}
918				AND `docstatus` < 2
919				AND `name` NOT IN ({standard_users})
920				AND ({key} LIKE %(txt)s
921					OR CONCAT_WS(' ', first_name, middle_name, last_name) LIKE %(txt)s)
922				{fcond} {mcond}
923			ORDER BY
924				CASE WHEN `name` LIKE %(txt)s THEN 0 ELSE 1 END,
925				CASE WHEN concat_ws(' ', first_name, middle_name, last_name) LIKE %(txt)s
926					THEN 0 ELSE 1 END,
927				NAME asc
928			LIMIT %(page_len)s OFFSET %(start)s
929		""".format(
930				user_type_condition=user_type_condition,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\user\user.py:944:3
943			frappe.db.sql(
944				"""SELECT SUM(`simultaneous_sessions`)
945			FROM `tabUser`
946			WHERE `enabled` = 1
947			AND `user_type` = 'System User'
948			AND `name` NOT IN ({})""".format(
949					", ".join(["%s"] * len(STANDARD_USERS))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\user\user.py:969:2
968		system_users = frappe.db.sql_list(
969			"""select name from `tabUser`
970			where enabled=1 and user_type != 'Website User'
971			and name not in ({}) {}""".format(
972				", ".join(["%s"] * len(exclude_users)), limit_cond

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\core\doctype\user\user.py:983:2
982		return frappe.db.sql(
983			"""select count(*) from `tabUser`
984			where enabled = 1 and user_type != 'Website User'
985			and name not in ({})
986			and hour(timediff(now(), last_active)) < 72""".format(
987				", ".join(["%s"] * len(STANDARD_USERS))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\custom\doctype\customize_form\customize_form.py:493:4
492				docs = frappe.db.sql(
493					"""
494					SELECT name, {fieldname}, LENGTH({fieldname}) AS len
495					FROM `tab{doctype}`
496					WHERE LENGTH({fieldname}) > {max_length}
497				""".format(
498						fieldname=fieldname, doctype=self.doc_type, max_length=max_length

--------------------------------------------------
>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell, possible injection detected, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b605_start_process_with_a_shell.html
   Location: .\frappe\database\db_manager.py:85:2
84			)
85			os.system(command)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\mariadb\database.py:301:3
300			return self.sql(
301				"""select
302				column_name as 'name',
303				column_type as 'type',
304				column_default as 'default',
305				COALESCE(
306					(select 1
307					from information_schema.statistics
308					where table_name="{table_name}"
309						and column_name=columns.column_name
310						and NON_UNIQUE=1
311						and Seq_in_index = 1
312						limit 1
313				), 0) as 'index',
314				column_key = 'UNI' as 'unique'
315				from information_schema.columns as columns
316				where table_name = '{table_name}' """.format(
317					table_name=table_name

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\postgres\database.py:208:4
207				for d in self.sql(
208					"""select table_name
209				from information_schema.tables
210				where table_catalog='{}'
211					and table_type = 'BASE TABLE'
212					and table_schema='{}'""".format(
213						frappe.conf.db_name, frappe.conf.get("db_schema", "public")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\postgres\database.py:244:3
243			return self.sql(
244				f"SELECT COLUMN_NAME FROM information_schema.COLUMNS WHERE TABLE_NAME = '{table_name}'"
245			)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\postgres\database.py:307:17
306			"""
307			res = self.sql(f"select issingle from `tabDocType` where name='{doctype}'")
308			if not res:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\postgres\database.py:323:9
322				key = '", "'.join(key)
323			return f'ON CONFLICT ("{key}") DO UPDATE SET '
324	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\postgres\database.py:330:3
329			return self.sql(
330				"""SELECT 1 FROM pg_indexes WHERE tablename='{table_name}'
331				and indexname='{index_name}' limit 1""".format(
332					table_name=table_name, index_name=index_name

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\postgres\database.py:371:3
370			return self.sql(
371				"""
372				SELECT a.column_name AS name,
373				CASE LOWER(a.data_type)
374					WHEN 'character varying' THEN CONCAT('varchar(', a.character_maximum_length ,')')
375					WHEN 'timestamp without time zone' THEN 'timestamp'
376					ELSE a.data_type
377				END AS type,
378				BOOL_OR(b.index) AS index,
379				SPLIT_PART(COALESCE(a.column_default, NULL), '::', 1) AS default,
380				BOOL_OR(b.unique) AS unique
381				FROM information_schema.columns a
382				LEFT JOIN
383					(SELECT indexdef, tablename,
384						indexdef LIKE '%UNIQUE INDEX%' AS unique,
385						indexdef NOT LIKE '%UNIQUE INDEX%' AS index
386						FROM pg_indexes
387						WHERE tablename='{table_name}') b
388					ON SUBSTRING(b.indexdef, '(.*)') LIKE CONCAT('%', a.column_name, '%')
389				WHERE a.table_name = '{table_name}'
390				GROUP BY a.column_name, a.data_type, a.column_default, a.character_maximum_length;
391			""".format(
392					table_name=table_name

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\database\postgres\setup_db.py:42:1
41		from shutil import which
42		from subprocess import PIPE, run
43	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\frappe\database\postgres\setup_db.py:70:16
69	
70		restore_proc = run(command, env=subprocess_env, shell=True, stdout=PIPE)
71	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\database\schema.py:145:7
144							max_length = frappe.db.sql(
145								"""SELECT MAX(CHAR_LENGTH(`{fieldname}`)) FROM `tab{doctype}`""".format(
146									fieldname=col.fieldname, doctype=self.doctype

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\doctype\bulk_update\bulk_update.py:26:2
25		docnames = frappe.db.sql_list(
26			f"""select name from `tab{doctype}`{condition} limit {limit} offset 0"""
27		)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\desk\doctype\dashboard_chart\dashboard_chart.py:392:1
391		"""Get all parent doctypes that have the child doctype."""
392		assert isinstance(child_type, str)
393	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\desk\doctype\desktop_icon\desktop_icon.py:175:10
174				module_icon = frappe._dict()
175				opts = random.choice(palette)
176				module_icon.color = opts[0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\doctype\event\event.py:245:2
244		events = frappe.db.sql(
245			"""
246			SELECT `tabEvent`.name,
247					`tabEvent`.subject,
248					`tabEvent`.description,
249					`tabEvent`.color,
250					`tabEvent`.starts_on,
251					`tabEvent`.ends_on,
252					`tabEvent`.owner,
253					`tabEvent`.all_day,
254					`tabEvent`.event_type,
255					`tabEvent`.repeat_this_event,
256					`tabEvent`.repeat_on,
257					`tabEvent`.repeat_till,
258					`tabEvent`.monday,
259					`tabEvent`.tuesday,
260					`tabEvent`.wednesday,
261					`tabEvent`.thursday,
262					`tabEvent`.friday,
263					`tabEvent`.saturday,
264					`tabEvent`.sunday
265			FROM {tables}
266			WHERE (
267					(
268						(date(`tabEvent`.starts_on) BETWEEN date(%(start)s) AND date(%(end)s))
269						OR (date(`tabEvent`.ends_on) BETWEEN date(%(start)s) AND date(%(end)s))
270						OR (
271							date(`tabEvent`.starts_on) <= date(%(start)s)
272							AND date(`tabEvent`.ends_on) >= date(%(end)s)
273						)
274					)
275					OR (
276						date(`tabEvent`.starts_on) <= date(%(start)s)
277						AND `tabEvent`.repeat_this_event=1
278						AND coalesce(`tabEvent`.repeat_till, '3000-01-01') > date(%(start)s)
279					)
280				)
281			{reminder_condition}
282			{filter_condition}
283			AND (
284					`tabEvent`.event_type='Public'
285					OR `tabEvent`.owner=%(user)s
286					OR EXISTS(
287						SELECT `tabDocShare`.name
288						FROM `tabDocShare`
289						WHERE `tabDocShare`.share_doctype='Event'
290							AND `tabDocShare`.share_name=`tabEvent`.name
291							AND `tabDocShare`.user=%(user)s
292					)
293				)
294			AND `tabEvent`.status='Open'
295			ORDER BY `tabEvent`.starts_on""".format(
296				tables=", ".join(tables),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\doctype\tag\tag.py:107:4
106				frappe.db.sql(
107					"update `tab{}` set _user_tags={} where name={}".format(self.dt, "%s", "%s"), (tags, dn)
108				)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\form\load.py:303:9
302		# communications linked to reference_doctype
303		part1 = """
304			SELECT {fields}
305			FROM `tabCommunication` as C
306			WHERE C.communication_type IN ('Communication', 'Feedback', 'Automated Message')
307			AND (C.reference_doctype = %(doctype)s AND C.reference_name = %(name)s)
308			{conditions}
309		""".format(
310			fields=fields, conditions=conditions

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\form\load.py:314:9
313		# communications linked in Timeline Links
314		part2 = """
315			SELECT {fields}
316			FROM `tabCommunication` as C
317			INNER JOIN `tabCommunication Link` ON C.name=`tabCommunication Link`.parent
318			WHERE C.communication_type IN ('Communication', 'Feedback', 'Automated Message')
319			AND `tabCommunication Link`.link_doctype = %(doctype)s AND `tabCommunication Link`.link_name = %(name)s
320			{conditions}
321		""".format(
322			fields=fields, conditions=conditions

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\form\load.py:326:2
325		communications = frappe.db.sql(
326			"""
327			SELECT *
328			FROM (({part1}) UNION ({part2})) AS combined
329			{group_by}
330			ORDER BY creation DESC
331			LIMIT %(limit)s
332			OFFSET %(start)s
333		""".format(
334				part1=part1, part2=part2, group_by=(group_by or "")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\page\activity\activity.py:16:2
15		result = frappe.db.sql(
16			"""select X.*
17			from (select name, owner, modified, creation, seen, comment_type,
18					reference_doctype, reference_name, '' as link_doctype, '' as link_name, subject,
19					communication_type, communication_medium, content
20				from
21					`tabCommunication`
22				where
23					communication_type = 'Communication'
24					and communication_medium != 'Email'
25					and {match_conditions_communication}
26			UNION
27				select name, owner, modified, creation, '0', 'Updated',
28					reference_doctype, reference_name, link_doctype, link_name, subject,
29					'Comment', '', content
30				from
31					`tabActivity Log`
32			UNION
33				select name, owner, modified, creation, '0', comment_type,
34					reference_doctype, reference_name, link_doctype, link_name, '',
35					'Comment', '', content
36				from
37					`tabComment`
38				where
39					{match_conditions_comment}
40			) X
41			order by X.creation DESC
42			LIMIT %(page_length)s
43			OFFSET %(start)s""".format(
44				match_conditions_comment=match_conditions_comment,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\desk\page\user_profile\user_profile.py:16:3
15			frappe.db.sql(
16				"""select unix_timestamp(date(creation)), sum(points)
17			from `tabEnergy Point Log`
18			where
19				date(creation) > subdate('{date}', interval 1 year) and
20				date(creation) < subdate('{date}', interval -1 year) and
21				user = %s and
22				type != 'Review'
23			group by date(creation)
24			order by creation asc""".format(
25					date=date

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\email\__init__.py:23:2
22		out = frappe.db.sql(
23			f"""select email_id as value,
24			concat(first_name, ifnull(concat(' ',last_name), '' )) as description
25			from tabContact
26			where name like %(txt)s or email_id like %(txt)s
27			{match_conditions}
28			limit %(page_length)s""",
29			{"txt": f"%{txt}%", "page_length": page_length},

--------------------------------------------------
>> Issue: [B501:request_with_no_cert_validation] Call to requests with verify=False disabling SSL certificate checks, security issue.
   Severity: High   Confidence: High
   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b501_request_with_no_cert_validation.html
   Location: .\frappe\email\doctype\newsletter\newsletter.py:72:15
71				try:
72					response = requests.head(url, verify=False, timeout=5)
73					if response.status_code >= 400:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\email\doctype\newsletter\test_newsletter.py:147:19
146			name = self.send_newsletter()
147			to_unsubscribe = choice(emails)
148			group = frappe.get_all(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\email\doctype\newsletter\test_newsletter.py:176:15
175			newsletter = self.get_newsletter()
176			test_email = choice(emails)
177			newsletter.send_test_email(test_email)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\email\receive.py:408:3
407					incoming_mail = Email(b"\n".join(self.pop.top(msg_num, 5)[1]))
408				except Exception:
409					pass
410	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\frappe\email\receive.py:434:3
433					self.imap.uid("STORE", uid, op, "(\\SEEN)")
434				except Exception:
435					continue
436	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\frappe\email\test_smtp.py:35:2
34			# lowest preference given to email account with default incoming enabled
35			create_email_account(
36				email_id="default_outgoing_enabled@gmail.com",
37				password="password",
38				enable_outgoing=1,
39				default_outgoing=1,
40			)
41			self.assertEqual(EmailAccount.find_outgoing().email_id, "default_outgoing_enabled@gmail.com")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\frappe\email\test_smtp.py:45:2
44			# highest preference given to email account with append_to matching
45			create_email_account(
46				email_id="append_to@gmail.com",
47				password="password",
48				enable_outgoing=1,
49				default_outgoing=1,
50				append_to="Blog Post",
51			)
52			self.assertEqual(

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\frappeclient.py:397:8
396		def get_request(self, params):
397			res = requests.get(
398				self.url, params=self.preprocess(params), headers=self.headers, verify=self.verify
399			)
400			res = self.post_process(res)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\frappeclient.py:404:8
403		def post_request(self, data):
404			res = requests.post(
405				self.url, data=self.preprocess(data), headers=self.headers, verify=self.verify
406			)
407			res = self.post_process(res)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\frappeclient.py:416:8
415		def get(self, url, params, verify):
416			res = requests.get(url, params=params, headers=self.headers, verify=verify)
417			return res

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\frappeclient.py:420:8
419		def post(self, url, data, verify):
420			res = requests.post(url, data=data, headers=self.headers, verify=verify)
421			return res

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\frappeclient.py:424:8
423		def put(self, url, data, verify):
424			res = requests.put(url, data=data, headers=self.headers, verify=verify)
425			return res

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\geo\utils.py:65:4
64				coords = frappe.db.sql(
65					f"""SELECT name, location FROM `tab{doctype}`  WHERE {filters_sql}""", as_dict=True
66				)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\geo\utils.py:80:4
79				coords = frappe.db.sql(
80					f"""SELECT name, latitude, longitude FROM `tab{doctype}`  WHERE {filters_sql}""",
81					as_dict=True,

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\installer.py:22:1
21			enable_scheduler = cint(frappe.db.get_single_value("System Settings", "enable_scheduler"))
22		except Exception:
23			pass
24		finally:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\frappe\installer.py:64:18
63	
64			db_name = "_" + hashlib.sha1(os.path.realpath(frappe.get_site_path()).encode()).hexdigest()[:16]
65	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\installer.py:184:13
183		for org in ["frappe", "erpnext"]:
184			response = requests.head(f"https://api.github.com/repos/{org}/{org_repo}")
185			if response.status_code == 400:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\installer.py:186:14
185			if response.status_code == 400:
186				response = requests.head(f"https://github.com/{org}/{org_repo}")
187			if response.ok:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\installer.py:674:1
673	def extract_sql_gzip(sql_gz_path):
674		import subprocess
675	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\frappe\installer.py:680:2
679			cmd = f"gzip --decompress --force < {original_file} > {decompressed_file}"
680			subprocess.check_call(cmd, shell=True)
681		except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\installer.py:689:1
688		import shutil
689		import subprocess
690	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\frappe\installer.py:708:3
707			if file_path.endswith(".tar"):
708				subprocess.check_output(["tar", "xvf", tar_path, "--strip", "2"], cwd=abs_site_path)
709			elif file_path.endswith(".tgz"):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\installer.py:708:3
707			if file_path.endswith(".tar"):
708				subprocess.check_output(["tar", "xvf", tar_path, "--strip", "2"], cwd=abs_site_path)
709			elif file_path.endswith(".tgz"):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\frappe\installer.py:710:3
709			elif file_path.endswith(".tgz"):
710				subprocess.check_output(["tar", "zxvf", tar_path, "--strip", "2"], cwd=abs_site_path)
711		except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\installer.py:710:3
709			elif file_path.endswith(".tgz"):
710				subprocess.check_output(["tar", "zxvf", tar_path, "--strip", "2"], cwd=abs_site_path)
711		except Exception:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Eastern_43A1W'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\doctype\connected_app\test_connected_app.py:65:23
64			self.user_name = "test-connected-app@example.com"
65			self.user_password = "Eastern_43A1W"
66	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dropbox-auth-csrf-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\frappe\integrations\doctype\dropbox_settings\dropbox_settings.py:349:22
348		app_details = get_dropbox_settings(redirect_uri=True)
349		dropbox_oauth_flow = dropbox.DropboxOAuth2Flow(
350			consumer_key=app_details["app_key"],
351			redirect_uri=app_details["redirect_uri"],
352			session={},
353			csrf_token_session_key="dropbox-auth-csrf-token",
354			consumer_secret=app_details["app_secret"],
355		)
356	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dropbox-auth-csrf-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\frappe\integrations\doctype\dropbox_settings\dropbox_settings.py:368:22
367	
368		dropbox_oauth_flow = dropbox.DropboxOAuth2Flow(
369			consumer_key=app_details["app_key"],
370			redirect_uri=app_details["redirect_uri"],
371			session={"dropbox-auth-csrf-token": callback.state},
372			csrf_token_session_key="dropbox-auth-csrf-token",
373			consumer_secret=app_details["app_secret"],
374		)
375	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\doctype\google_calendar\google_calendar.py:94:7
93			try:
94				r = requests.post(GoogleOAuth.OAUTH_URL, data=data).json()
95			except requests.exceptions.HTTPError:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\doctype\google_calendar\google_calendar.py:134:7
133				}
134				r = requests.post(GoogleOAuth.OAUTH_URL, data=data).json()
135	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'my_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\doctype\ldap_settings\test_ldap_settings.py:99:22
98			cls.base_dn = f"cn=base_dn_user,{cls.ldap_dc_path}"
99			cls.base_password = "my_password"
100			cls.ldap_server = "ldap://my_fake_server:389"

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\doctype\slack_webhook_url\slack_webhook_url.py:48:5
47	
48		r = requests.post(slack_url, data=json.dumps(data))
49	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'keoererk988ekkhf8w9e8ewrjhhkjer9889'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\doctype\social_login_key\test_social_login_key.py:89:35
88			social_login_key.client_id = "h6htd6q"
89			social_login_key.client_secret = "keoererk988ekkhf8w9e8ewrjhhkjer9889"
90			social_login_key.insert(ignore_permissions=True)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'bearer'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\doctype\token_cache\token_cache.py:31:51
30			# 'Bearer' or 'MAC'
31			token_type = token_type.title() if token_type == "bearer" else token_type.upper()
32	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'X-Frappe-Webhook-Signature'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\doctype\webhook\webhook.py:19:24
18	
19	WEBHOOK_SECRET_HEADER = "X-Frappe-Webhook-Signature"
20	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\frappe_providers\frappecloud.py:12:11
11		request_url = f"https://{remote_site}/api/method/press.api.script"
12		request = requests.get(request_url)
13	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\frappe\integrations\frappe_providers\frappecloud.py:36:1
35		print(f"Site Migrator stored at {script.name}")
36		os.execv(py, [py, script.name, local_site])

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\google_oauth.py:76:3
75			return handle_response(
76				post(self.OAUTH_URL, data=data).json(),
77				"Google Oauth Authorization Error",

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\google_oauth.py:95:3
94			return handle_response(
95				post(self.OAUTH_URL, data=data).json(),
96				"Google Oauth Access Token Refresh Error",

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\integrations\google_oauth.py:161:12
160	def is_valid_access_token(access_token: str) -> bool:
161		response = get(
162			"https://oauth2.googleapis.com/tokeninfo", params={"access_token": access_token}
163		).json()
164	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\oauth2.py:206:20
205		if token_type_hint not in ["access_token", "refresh_token"]:
206			token_type_hint = "access_token"
207		try:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\oauth2.py:209:24
208			bearer_token = None
209			if token_type_hint == "access_token":
210				bearer_token = frappe.get_doc("OAuth Bearer Token", {"access_token": token})

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'refresh_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\integrations\oauth2.py:211:26
210				bearer_token = frappe.get_doc("OAuth Bearer Token", {"access_token": token})
211			elif token_type_hint == "refresh_token":
212				bearer_token = frappe.get_doc("OAuth Bearer Token", {"refresh_token": token})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\base_document.py:500:4
499				frappe.db.sql(
500					"""INSERT INTO `tab{doctype}` ({columns})
501						VALUES ({values}) {conflict_handler}""".format(
502						doctype=self.doctype,

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\base_document.py:556:4
555				frappe.db.sql(
556					"""UPDATE `tab{doctype}`
557					SET {values} WHERE `name`=%s""".format(
558						doctype=self.doctype, values=", ".join("`" + c + "`=%s" for c in columns)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\db_query.py:203:3
202			query = (
203				"""select %(fields)s
204				from %(tables)s
205				%(conditions)s
206				%(group_by)s
207				%(order_by)s
208				%(limit)s"""
209				% args
210			)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\delete_doc.py:333:4
332				for refdoc in frappe.db.sql(
333					"""select `name`, `docstatus` {table} from `tab{parent}` where
334					{options}=%s and {fieldname}=%s""".format(
335						**df

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\delete_doc.py:411:2
410		frappe.db.sql(
411			"""update
412				`tab{0}`
413			set
414				{1}=NULL, {2}=NULL
415			where
416				{1}=%s and {2}=%s""".format(
417				doctype, reference_doctype_field, reference_name_field

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\docfield.py:48:3
47			frappe.db.sql(
48				"""update `tab{}` set parentfield={} where parentfield={}""".format(f["options"], "%s", "%s"),
49				(new, f["fieldname"]),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\document.py:410:4
409				deleted_rows = frappe.db.sql(
410					"""select name from `tab{}` where parent=%s
411					and parenttype=%s and parentfield=%s
412					and name not in ({})""".format(
413						df.options, ",".join(["%s"] * len(rows))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\dynamic_links.py:45:32
44					try:
45						links = frappe.db.sql_list("""select distinct {options} from `tab{parent}`""".format(**df))
46						for doctype in links:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\naming.py:182:5
181					frappe.db.sql(
182						f"""select data_type FROM information_schema.columns
183					where column_name = 'name' and table_name = 'tab{doctype}'"""
184					)[0][0]

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\naming.py:486:3
485			last = frappe.db.sql(
486				"""SELECT `{fieldname}` FROM `tab{doctype}`
487				WHERE `{fieldname}` {regex_character} %s
488				ORDER BY length({fieldname}) DESC,
489				`{fieldname}` DESC LIMIT 1""".format(
490					doctype=doctype, fieldname=fieldname, regex_character=frappe.db.REGEX_CHARACTER

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\utils\__init__.py:33:2
32		frappe.db.sql(
33			"""update `tab%s` set `is_default`=0
34			where `%s`=%s and name!=%s"""
35			% (doc.doctype, key, "%s", "%s"),
36			(doc.get(key), doc.name),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\utils\link_count.py:45:6
44						frappe.db.sql(
45							f"update `tab{key[0]}` set idx = idx + {count} where name=%s",
46							key[1],

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\utils\rename_field.py:28:3
27			frappe.db.sql(
28				"""update `tab%s` set parentfield=%s
29				where parentfield=%s"""
30				% (new_field.options.split("\n")[0], "%s", "%s"),
31				(new_fieldname, old_fieldname),

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\utils\rename_field.py:43:17
42				# copy field value
43				frappe.db.sql(f"""update `tab{doctype}` set `{new_fieldname}`=`{old_fieldname}`""")
44	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\model\utils\rename_field.py:143:4
142				frappe.db.sql(
143					"""update `tabDefaultValue` set defvalue=%s
144					where defkey=%s"""
145					% ("%s", "%s"),
146					(json.dumps(new_columns), key),

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\frappe\modules\import_file.py:23:12
22		"""
23		hash_md5 = hashlib.md5()
24		with open(path, "rb") as f:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\modules\import_file.py:134:5
133							stored_hash = frappe.db.get_value(doc["doctype"], doc["name"], "migration_hash")
134						except Exception:
135							pass
136	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\frappe\modules\patch_handler.py:188:5
187					else:
188						exec(patch, globals())
189					update_patch_log(patchmodule)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\oauth.py:286:24
285			"""
286			if token_type_hint == "access_token":
287				frappe.db.set_value("OAuth Bearer Token", token, "status", "Revoked")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'refresh_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\oauth.py:288:26
287				frappe.db.set_value("OAuth Bearer Token", token, "status", "Revoked")
288			elif token_type_hint == "refresh_token":
289				frappe.db.set_value("OAuth Bearer Token", {"refresh_token": token}, "status", "Revoked")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\parallel_test_runner.py:151:3
150				chunk_no += 1
151				assert chunk_no < chunk_count
152	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\parallel_test_runner.py:156:1
155	
156		assert len(work) == sum(len(chunk) for chunk in chunks)
157		assert len(chunks) == chunk_count

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\parallel_test_runner.py:157:1
156		assert len(work) == sum(len(chunk) for chunk in chunks)
157		assert len(chunks) == chunk_count
158	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\parallel_test_runner.py:302:8
301			url = f"{self.orchestrator_url}/{endpoint}"
302			res = requests.get(url, json=data, headers=headers)
303			res.raise_for_status()

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v10_0\refactor_social_login_keys.py:123:9
122	
123		query = """INSERT INTO `tabUser Social Login` (`{source_cols}`)
124			VALUES ({values})
125		""".format(
126			source_cols="`, `".join(source_cols), values=", ".join([frappe.db.escape(d) for d in values])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v11_0\delete_duplicate_user_permissions.py:15:3
14			frappe.db.sql(
15				"""delete from `tabUser Permission`
16				where allow=%s and user=%s and for_value=%s limit {}""".format(
17					record.count - 1

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v11_0\update_list_user_settings.py:15:3
14			settings = frappe.db.sql(
15				"select * from `__UserSettings` \
16				where user={}".format(
17					frappe.db.escape(user.user)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v12_0\move_email_and_phone_to_child_table.py:81:4
80				frappe.db.sql(
81					"""
82					INSERT INTO `tabContact Email`
83						(`idx`, `name`, `email_id`, `parentfield`, `parenttype`, `parent`, `is_primary`, `creation`,
84						`modified`, `modified_by`)
85					VALUES {}
86				""".format(
87						", ".join(["%s"] * len(email_values))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v12_0\move_email_and_phone_to_child_table.py:96:4
95				frappe.db.sql(
96					"""
97					INSERT INTO `tabContact Phone`
98						(`idx`, `name`, `phone`, `parentfield`, `parenttype`, `parent`, `is_primary_phone`, `is_primary_mobile_no`, `creation`,
99						`modified`, `modified_by`)
100					VALUES {}
101				""".format(
102						", ".join(["%s"] * len(phone_values))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v12_0\move_timeline_links_to_dynamic_links.py:54:4
53				frappe.db.sql(
54					"""
55					INSERT INTO `tabCommunication Link`
56						(`idx`, `name`, `parentfield`, `parenttype`, `parent`, `link_doctype`, `link_name`, `creation`,
57						`modified`, `modified_by`)
58					VALUES {}
59				""".format(
60						", ".join([d for d in values])

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\frappe\patches\v12_0\rename_uploaded_files_with_proper_name.py:25:2
24				)
25			except Exception:
26				continue
27	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v12_0\replace_null_values_in_tables.py:27:4
26				frappe.db.sql(
27					"""UPDATE `{table}` SET {columns}""".format(
28						table=table, columns=", ".join(update_column_table_map.get(table))

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v12_0\setup_tags.py:20:3
19			for _user_tags in frappe.db.sql(
20				f"select `name`, `_user_tags` from `tab{doctype.name}`", as_dict=True
21			):

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v13_0\set_unique_for_page_view.py:7:15
6		site_url = frappe.utils.get_site_url(frappe.local.site)
7		frappe.db.sql(f"""UPDATE `tabWeb Page View` set is_unique=1 where referrer LIKE '%{site_url}%'""")

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\patches\v13_0\update_date_filters_in_user_settings.py:12:3
11			user_settings = frappe.db.sql(
12				"""
13				select
14					* from `__UserSettings`
15				where
16					user='{user}'
17			""".format(
18					user=user.user

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\patches\v14_0\clear_long_pending_stale_logs.py:39:1
38			return frappe.db.get_single_value("Log Settings", fieldname)
39		except Exception:
40			# Field might be gone if patch is reattempted
41			pass

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\patches\v14_0\log_settings_migration.py:27:1
26			return frappe.db.get_single_value("Log Settings", fieldname)
27		except Exception:
28			# Field might be gone if patch is reattempted
29			pass

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\frappe\patches\v14_0\reset_creation_datetime.py:27:3
26					file_schema = frappe._dict(json.load(f))
27				except Exception:
28					continue
29	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\recorder.py:60:1
59					}
60		except Exception:
61			pass
62	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\search\website_search.py:73:2
72				return frappe._dict(title=title, content=text_content, path=route)
73			except Exception:
74				pass
75			finally:

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\social\doctype\energy_point_log\energy_point_log.py:246:2
245		points_list = frappe.db.sql(
246			"""
247			SELECT
248				SUM(CASE WHEN `type` != 'Review' THEN `points` ELSE 0 END) AS energy_points,
249				SUM(CASE WHEN `type` = 'Review' THEN `points` ELSE 0 END) AS review_points,
250				SUM(CASE
251					WHEN `type`='Review' AND `points` < 0 {given_points_condition}
252					THEN ABS(`points`)
253					ELSE 0
254				END) as given_points,
255				`user`
256			FROM `tabEnergy Point Log`
257			{conditions}
258			GROUP BY `user`
259			ORDER BY `energy_points` DESC
260		""".format(
261				conditions=conditions, given_points_condition=given_points_condition

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\test_runner.py:233:34
232			if force:
233				for name in frappe.db.sql_list("select name from `tab%s`" % doctype):
234					frappe.delete_doc(doctype, name, force=True)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_api.py:126:13
125			# test 1: fetch documents without auth
126			response = requests.get(f"{self.RESOURCE_URL}/{self.DOCTYPE}")
127			self.assertEqual(response.status_code, 403)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\frappe\tests\test_api.py:162:24
161			self.assertIsInstance(response.json["exc"], str)
162			self.assertIsInstance(eval(response.json["exc"]), list)
163	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_api.py:186:15
185			data = {"description": generated_desc, "sid": self.sid}
186			random_doc = choice(self.GENERATED_DOCUMENTS)
187			desc_before_update = frappe.db.get_value(self.DOCTYPE, random_doc, "description")

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_api.py:196:18
195			# test 9: DELETE method on /api/resource
196			doc_to_delete = choice(self.GENERATED_DOCUMENTS)
197			response = self.delete(f"/api/resource/{self.DOCTYPE}/{doc_to_delete}")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pwd_012'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_auth.py:32:27
31			cls.test_user_mobile = "+911234567890"
32			cls.test_user_password = "pwd_012"
33	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\tests\test_child_table.py:12:2
11				frappe.delete_doc("DocType", self.doctype_name, force=1)
12			except Exception:
13				pass
14	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_client.py:140:8
139			)
140			res = requests.post(url, json=params, headers=headers)
141			self.assertEqual(res.status_code, 200)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\tests\test_commands.py:10:0
9	import shlex
10	import subprocess
11	import unittest

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\tests\test_commands.py:163:15
162			command = shlex.split(self.command)
163			self._proc = subprocess.run(command, input=cmd_input, capture_output=True)
164			self.stdout = clean(self._proc.stdout)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_db.py:352:17
351	
352			random_field = choice(fields).lower()
353			random_doc = choice(created_docs)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_db.py:353:15
352			random_field = choice(fields).lower()
353			random_doc = choice(created_docs)
354			random_value = random_string(20)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_db.py:616:3
615			check_exists = frappe.db.sql(
616				f"""
617				SELECT * FROM INFORMATION_SCHEMA.TABLES
618				WHERE TABLE_NAME = N'tab{new_table_name}';
619				"""
620			)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_db.py:835:3
834			check_exists = frappe.db.sql(
835				f"""
836				SELECT EXISTS (
837				SELECT FROM information_schema.tables
838				WHERE  table_name = 'tab{new_table_name}'
839				);
840				"""
841			)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_db.py:855:4
854				return frappe.db.sql(
855					f"""
856					SELECT
857						table_name,
858						column_name,
859						data_type
860					FROM
861						information_schema.columns
862					WHERE
863						table_name = 'tab{self.test_table_name}'"""
864				)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_db.py:884:3
883			indexs_in_table = frappe.db.sql(
884				f"""
885				SELECT indexname
886				FROM pg_indexes
887				WHERE tablename = 'tab{self.test_table_name}'
888				AND indexname = '{index_name}' ;
889				""",
890			)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_db_query.py:822:3
821			dashboard_settings = frappe.db.sql(
822				"""
823					SELECT name
824					FROM `tabDashboard Settings`
825					WHERE {condition}
826				""".format(
827					condition=permission_query_conditions

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_frappe_client.py:185:8
184			header = {"Authorization": f"token {api_key}:{generated_secret}"}
185			res = requests.post(get_url() + "/api/method/frappe.auth.get_logged_user", headers=header)
186	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_frappe_client.py:196:8
195			}
196			res = requests.post(get_url() + "/api/method/frappe.auth.get_logged_user", headers=header)
197			self.assertEqual(res.status_code, 200)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ksk&93nxoe3os'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_frappe_client.py:201:15
200			# Valid api key, invalid api secret
201			api_secret = "ksk&93nxoe3os"
202			header = {"Authorization": f"token {api_key}:{api_secret}"}

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_frappe_client.py:203:8
202			header = {"Authorization": f"token {api_key}:{api_secret}"}
203			res = requests.post(get_url() + "/api/method/frappe.auth.get_logged_user", headers=header)
204			self.assertEqual(res.status_code, 403)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'ksk&93nxoe3os'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_frappe_client.py:208:15
207			api_key = "@3djdk3kld"
208			api_secret = "ksk&93nxoe3os"
209			header = {"Authorization": f"token {api_key}:{api_secret}"}

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_frappe_client.py:210:8
209			header = {"Authorization": f"token {api_key}:{api_secret}"}
210			res = requests.post(get_url() + "/api/method/frappe.auth.get_logged_user", headers=header)
211			self.assertEqual(res.status_code, 401)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\tests\test_oauth20.py:386:20
385		else:
386			openid_response = requests.get(get_full_url(URL), headers=headers)
387	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_password.py:18:17
17	
18			new_password = "test-password"
19			doc.password = new_password

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Eastern_43A1W'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_password.py:55:17
54		def test_hashed_password(self, user="test@example.com"):
55			old_password = "Eastern_43A1W"
56			new_password = "Eastern_43A1W-new"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Eastern_43A1W-new'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_password.py:56:17
55			old_password = "Eastern_43A1W"
56			new_password = "Eastern_43A1W-new"
57	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-rename-password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_password.py:78:13
77		def test_password_on_rename_user(self):
78			password = "test-rename-password"
79	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'asdf'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_password.py:104:17
103	
104			doc.password = "asdf"
105			doc.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_password.py:108:17
107	
108			doc.password = ""
109			doc.save()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'qwe'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_pdf.py:43:13
42		def test_pdf_encryption(self):
43			password = "qwe"
44			pdf = pdfgen.get_pdf(self.html, options={"password": password})

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_query.py:245:3
244				).get_sql(),
245				"SELECT `tabNote`.`name`,`tabNote Seen By`.`user` seen_by FROM `tabNote` LEFT JOIN `tabNote Seen By` ON `tabNote Seen By`.`parent`=`tabNote`.`name` AND `tabNote Seen By`.`parenttype`='Note' WHERE `tabNote`.`name`='Test Note Title'".replace(
246					"`", '"' if frappe.db.db_type == "postgres" else "`"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_query.py:256:3
255				).get_sql(),
256				"SELECT `tabNote`.`name`,`tabNote Seen By`.`user` seen_by,`tabNote Seen By`.`idx` idx FROM `tabNote` LEFT JOIN `tabNote Seen By` ON `tabNote Seen By`.`parent`=`tabNote`.`name` AND `tabNote Seen By`.`parenttype`='Note' WHERE `tabNote`.`name`='Test Note Title'".replace(
257					"`", '"' if frappe.db.db_type == "postgres" else "`"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\tests\test_query.py:267:3
266				).get_sql(),
267				"SELECT `tabNote`.`name`,`tabNote Seen By`.`user` seen_by,`tabNote Seen By`.`idx` idx FROM `tabNote` LEFT JOIN `tabNote Seen By` ON `tabNote Seen By`.`parent`=`tabNote`.`name` AND `tabNote Seen By`.`parenttype`='Note' WHERE `tabNote`.`name`='Test Note Title'".replace(
268					"`", '"' if frappe.db.db_type == "postgres" else "`"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_rename_doc.py:129:13
128			"""Rename an existing document via frappe.rename_doc"""
129			old_name = choice(self.available_documents)
130			new_name = old_name + ".new"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_rename_doc.py:267:9
266		def test_doc_rename_method(self):
267			name = choice(self.available_documents)
268			new_name = f"{name}-{frappe.generate_hash(length=4)}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\tests\test_test_utils.py:33:1
32		"""assertions for ensuring tests didn't leave state behind"""
33		assert "temp_flag_to_be_discarded" not in frappe.flags
34		assert not frappe.db.exists("Currency", "STONKS")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\tests\test_test_utils.py:34:1
33		assert "temp_flag_to_be_discarded" not in frappe.flags
34		assert not frappe.db.exists("Currency", "STONKS")

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\tests\test_translate.py:25:63
24	translation_string_file = os.path.join(dirname, "translation_test_file.txt")
25	first_lang, second_lang, third_lang, fourth_lang, fifth_lang = choices(
26		# skip "en*" since it is a default language
27		frappe.get_all("Language", pluck="name", filters=[["name", "not like", "en%"]]),
28		k=5,
29	)
30	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Eastern_43A1W'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\frappe\tests\test_twofactor.py:206:18
205		frappe.form_dict["usr"] = "test@example.com"
206		frappe.form_dict["pwd"] = "Eastern_43A1W"
207		frappe.local.form_dict["cmd"] = "login"

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\translate.py:289:2
288				all_translations.update(user_translations)
289			except Exception:
290				pass
291	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\frappe\translate.py:495:1
494	def get_messages_from_workflow(doctype=None, app_name=None):
495		assert doctype or app_name, "doctype or app_name should be provided"
496	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\utils\__init__.py:263:16
262	
263		return "".join(choice(string.ascii_letters + string.digits) for i in range(length))
264	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\utils\__init__.py:277:8
276		try:
277			res = requests.get(gravatar_url)
278			if res.status_code == 200:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\frappe\utils\__init__.py:287:13
286	def get_gravatar_url(email: str, default: Literal["mm", "404"] = "mm") -> str:
287		hexdigest = hashlib.md5(frappe.as_unicode(email).encode("utf-8")).hexdigest()
288		return f"https://secure.gravatar.com/avatar/{hexdigest}?d={default}&s=200"

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\utils\__init__.py:421:1
420		import tempfile
421		from subprocess import Popen
422	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\utils\__init__.py:429:6
428	
429			p = Popen(cmd, **kwargs)
430			exit_code = p.wait()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\utils\__init__.py:701:1
700			is_valid = pos > 0 and (email_id.rindex(".") > pos) and (len(email_id) - pos > 4)
701		except Exception:
702			# print(e)
703			pass
704		return is_valid

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\utils\__init__.py:1012:2
1011				arg = json.loads(arg)
1012			except Exception:
1013				pass
1014	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\frappe\utils\change_log.py:140:12
139					f"cd ../apps/{app} && git rev-parse --abbrev-ref HEAD",
140					shell=True,
141					stdin=null_stream,
142					stderr=null_stream,
143				)
144			result = safe_decode(result)
145			result = result.strip()
146			return result

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\frappe\utils\change_log.py:156:12
155					f"cd ../apps/{app} && git rev-parse HEAD --short 7",
156					shell=True,
157					stdin=null_stream,
158					stderr=null_stream,
159				)
160			result = safe_decode(result)
161			result = result.strip()
162			return result

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\frappe\utils\change_log.py:239:15
238			# Check if repo remote is on github
239			remote_url = subprocess.check_output(f"cd ../apps/{app} && git ls-remote --get-url", shell=True)
240		except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\utils\change_log.py:260:5
259		# Get latest version from GitHub
260		r = requests.get(f"https://api.github.com/repos/{owner}/{repo}/releases")
261		if r.ok:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\utils\commands.py:11:8
10		for org in ["frappe", "erpnext"]:
11			req = requests.get(
12				f"https://api.github.com/users/{org}/repos", {"type": "sources", "per_page": 200}
13			)
14			if req.ok:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\utils\csvutils.py:194:12
193		headers = {"Accept": "text/csv"}
194		response = requests.get(url, headers=headers)
195	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\frappe\utils\file_manager.py:387:8
386			content = content.encode()
387		return hashlib.md5(content).hexdigest()
388	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\utils\global_search.py:226:16
225					),
226					"postgres": """INSERT INTO `__global_search`
227					(doctype, name, content, published, title, route)
228					VALUES {}
229					ON CONFLICT("name", "doctype") DO NOTHING""".format(
230						", ".join(batch_values)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\utils\global_search.py:346:1
345			sync_value_in_queue(value)
346		except Exception:
347			pass
348	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\frappe\utils\identicon.py:34:13
33			"""
34			return int(md5(str_.encode("utf-8")).hexdigest(), 16)
35	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\utils\make_random.py:19:10
18		if rows > 1:
19			nrows = random.randrange(1, rows)
20	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\utils\make_random.py:27:13
26				else:
27					d[key] = random.randrange(*val)
28	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\utils\make_random.py:46:14
45			{
46				"mariadb": """select name from `tab%s` %s
47			order by RAND() limit 1 offset 0"""
48				% (doctype, condition),
49				"postgres": """select name from `tab%s` %s

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\utils\make_random.py:49:15
48				% (doctype, condition),
49				"postgres": """select name from `tab%s` %s
50			order by RANDOM() limit 1 offset 0"""
51				% (doctype, condition),
52			}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\utils\make_random.py:63:8
62	def can_make(doctype: str) -> bool:
63		return random.random() < settings.prob.get(doctype, settings.prob["default"])["make"]
64	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\frappe\utils\make_random.py:67:8
66	def how_many(doctype: str) -> int:
67		return random.randrange(*settings.prob.get(doctype, settings.prob["default"])["qty"])

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\utils\pdf.py:6:0
5	import re
6	import subprocess
7	from distutils.version import LooseVersion

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\frappe\utils\pdf.py:137:14
136			# Use wkhtmltopdf's cookie-jar feature to set cookies and restrict them to host domain
137			cookiejar = f"/tmp/{frappe.generate_hash()}.jar"
138	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\utils\pdf.py:175:2
174					options[attr] = str(match[-1][3]).strip()
175			except Exception:
176				pass
177	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\frappe\utils\pdf.py:213:24
212				# create temp file
213				fname = os.path.join("/tmp", f"frappe-pdf-{frappe.generate_hash()}.html")
214				with open(fname, "wb") as f:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\frappe\utils\pdf.py:249:9
248			try:
249				res = subprocess.check_output(["wkhtmltopdf", "--version"])
250				wkhtmltopdf_version = res.decode("utf-8").split(" ")[1]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\utils\pdf.py:249:9
248			try:
249				res = subprocess.check_output(["wkhtmltopdf", "--version"])
250				wkhtmltopdf_version = res.decode("utf-8").split(" ")[1]

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\utils\pdf.py:252:2
251				frappe.cache().hset("wkhtmltopdf_version", None, wkhtmltopdf_version)
252			except Exception:
253				pass
254	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\frappe\utils\print_format.py:111:22
110		# Get the content of the merged pdf files
111		fname = os.path.join("/tmp", f"frappe-pdf-{frappe.generate_hash()}.pdf")
112		output.write(open(fname, "wb"))

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\frappe\utils\redis_wrapper.py:3:0
2	# License: MIT. See LICENSE
3	import pickle
4	import re

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\frappe\utils\redis_wrapper.py:92:10
91				if val is not None:
92					val = pickle.loads(val)
93	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\frappe\utils\redis_wrapper.py:202:15
201			value = super().hgetall(self.make_key(name))
202			return {key: pickle.loads(value) for key, value in value.items()}
203	

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\frappe\utils\redis_wrapper.py:222:11
221			if value is not None:
222				value = pickle.loads(value)
223				frappe.local.cache[_name][key] = value

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\frappe\utils\safe_exec.py:72:2
71			# execute script compiled by RestrictedPython
72			exec(compile_restricted(script), exec_globals, _locals)  # pylint: disable=exec-used
73	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\utils\scheduler.py:29:1
28			print(*args, **kwargs)
29		except Exception:
30			pass
31	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\frappe\utils\subscription.py:13:10
12			if frappe.conf.subscription["expiry"] and login_url:
13				resp = requests.post(login_url)
14	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\website\doctype\blog_post\blog_post.py:303:9
302	
303		query = """\
304			select
305				t1.title, t1.name, t1.blog_category, t1.route, t1.published_on, t1.read_time,
306					t1.published_on as creation,
307					t1.read_time as read_time,
308					t1.featured as featured,
309					t1.meta_image as cover_image,
310					t1.content as content,
311					t1.content_type as content_type,
312					t1.content_html as content_html,
313					t1.content_md as content_md,
314					ifnull(t1.blog_intro, t1.content) as intro,
315					t2.full_name, t2.avatar, t1.blogger,
316					(select count(name) from `tabComment`
317						where
318							comment_type='Comment'
319							and reference_doctype='Blog Post'
320							and reference_name=t1.name) as comments
321			from `tabBlog Post` t1, `tabBlogger` t2
322			where ifnull(t1.published,0)=1
323			and t1.blogger = t2.name
324			{condition}
325			order by featured desc, published_on desc, name asc
326			limit {page_len} OFFSET {start}""".format(
327			start=limit_start,

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\frappe\website\doctype\website_theme\website_theme.py:63:2
62		def generate_bootstrap_theme(self):
63			from subprocess import PIPE, Popen
64	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\frappe\website\doctype\website_theme\website_theme.py:86:12
85	
86			process = Popen(command, cwd=frappe.get_app_path("frappe", ".."), stdout=PIPE, stderr=PIPE)
87	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\website\page_renderers\template_page.py:268:2
267					self.source = res["body"]
268			except Exception:
269				pass
270	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\website\report\website_analytics\website_analytics.py:74:10
73	
74			query = """
75					SELECT
76						DATE_FORMAT({0}, %s) as date,
77						COUNT(*) as count,
78						COUNT(CASE WHEN is_unique = 1 THEN 1 END) as unique_count
79					FROM `tabWeb Page View`
80					WHERE creation BETWEEN %s AND %s
81					GROUP BY DATE_FORMAT({0}, %s)
82					ORDER BY creation
83				""".format(
84				field

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\website\report\website_analytics\website_analytics.py:102:10
101	
102			query = """
103					SELECT
104						DATE_TRUNC(%s, {0}) as date,
105						COUNT(*) as count,
106						COUNT(CASE WHEN CAST(is_unique as Integer) = 1 THEN 1 END) as unique_count
107					FROM "tabWeb Page View"
108					WHERE  coalesce("tabWeb Page View".{0}, '0001-01-01') BETWEEN %s AND %s
109					GROUP BY date_trunc(%s, {0})
110					ORDER BY date
111				""".format(
112				field

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\frappe\website\router.py:205:2
204					source = res["body"]
205			except Exception:
206				pass
207	

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\frappe\workflow\doctype\workflow\workflow.py:53:5
52					frappe.db.sql(
53						"""
54						UPDATE `tab{doctype}`
55						SET `{field}` = %s
56						WHERE ifnull(`{field}`, '') = ''
57						AND `docstatus` = %s
58					""".format(
59							doctype=self.document_type, field=self.workflow_state_field

--------------------------------------------------

Code scanned:
	Total lines of code: 95510
	Total lines skipped (#nosec): 4
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 124
		Medium: 129
		High: 14
	Total issues (by confidence):
		Undefined: 0
		Low: 114
		Medium: 40
		High: 113
Files skipped (0):
