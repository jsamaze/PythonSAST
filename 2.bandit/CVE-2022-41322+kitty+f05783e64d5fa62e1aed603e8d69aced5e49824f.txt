Working... ---------------------------------------- 100% 0:00:09
Run started:2024-02-10 22:56:40.884700

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\.github\workflows\ci.py:9:0
8	import shutil
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\.github\workflows\ci.py:24:10
23	    sys.stdout.flush()
24	    ret = subprocess.Popen(a).wait()
25	    if ret != 0:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\.github\workflows\ci.py:100:9
99	    os.chdir(SW)
100	    with urlopen('https://download.calibre-ebook.com/ci/kitty/{}-64.tar.xz'.format(
101	            'macos' if is_macos else 'linux')) as f:
102	        data = f.read()

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b202_tarfile_unsafe_members.html
   Location: .\.github\workflows\ci.py:104:8
103	    with tarfile.open(fileobj=io.BytesIO(data), mode='r:xz') as tf:
104	        tf.extractall()
105	    if not is_macos:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bypy\init_env.py:9:0
8	import shutil
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\init_env.py:47:11
46	    print(' '.join(map(shlex.quote, args)), flush=True)
47	    return subprocess.call(list(args), env=env, cwd=cwd)
48	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\init_env.py:73:11
72	        print(*map(shlex.quote, cmd), flush=True)
73	        if subprocess.call(cmd, env=env) != 0:
74	            print('Checking of kitty build failed', file=sys.stderr)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bypy\linux\__main__.py:9:0
8	import stat
9	import subprocess
10	import tarfile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\linux\__main__.py:100:8
99	        dest = os.path.join(dest, os.path.basename(x))
100	        subprocess.check_call(['chrpath', '-d', dest])
101	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\linux\__main__.py:100:8
99	        dest = os.path.join(dest, os.path.basename(x))
100	        subprocess.check_call(['chrpath', '-d', dest])
101	

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\bypy\linux\__main__.py:106:12
105	    from urllib.request import urlopen
106	    cdata = urlopen(kitty_constants['cacerts_url']).read()
107	    dest = os.path.join(env.lib_dir, 'cacert.pem')

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\bypy\linux\__main__.py:160:8
159	    for path in files:
160	        os.chmod(path, 0o755)
161	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\linux\__main__.py:190:12
189	            [os.chmod(x, stat.S_IWRITE | old_mode) for x, old_mode in unwritable_files]
190	            subprocess.check_call(cmd)
191	            [os.chmod(x, old_mode) for x, old_mode in unwritable_files]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\linux\__main__.py:223:4
222	    start_time = time.time()
223	    subprocess.check_call(['xz', '--threads=0', '-f', f'-{compression_level}', dist])
224	    secs = time.time() - start_time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\linux\__main__.py:223:4
222	    start_time = time.time()
223	    subprocess.check_call(['xz', '--threads=0', '-f', f'-{compression_level}', dist])
224	    secs = time.time() - start_time

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\bypy\macos\__main__.py:10:0
9	import stat
10	import subprocess
11	import sys

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\bypy\macos\__main__.py:85:8
84	            tostrip.append(flips.pop())
85	        os.spawnv(os.P_WAIT, cmd[0], cmd)
86	        for args in flips:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\bypy\macos\__main__.py:191:24
190	            try:
191	                cdata = urlopen(kitty_constants['cacerts_url']).read()
192	                break

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:214:8
213	        old_mode = flipwritable(path_to_lib)
214	        subprocess.check_call(
215	            ['install_name_tool', '-id', new_id, path_to_lib])
216	        if old_mode is not None:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:214:8
213	        old_mode = flipwritable(path_to_lib)
214	        subprocess.check_call(
215	            ['install_name_tool', '-id', new_id, path_to_lib])
216	        if old_mode is not None:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:221:23
220	    def get_dependencies(self, path_to_lib):
221	        install_name = subprocess.check_output(
222	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
223	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:221:23
220	    def get_dependencies(self, path_to_lib):
221	        install_name = subprocess.check_output(
222	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
223	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:223:14
222	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
223	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')
224	        for line in raw.splitlines():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:223:14
222	            ['otool', '-D', path_to_lib]).decode('utf-8').splitlines()[-1].strip()
223	        raw = subprocess.check_output(['otool', '-L', path_to_lib]).decode('utf-8')
224	        for line in raw.splitlines():

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:244:8
243	        cmd = ['-id', new_dep] if is_id else ['-change', old_dep, new_dep]
244	        subprocess.check_call(['install_name_tool'] + cmd + [path_to_lib])
245	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:385:30
384	        os.makedirs(self.site_packages)
385	        sys_path = json.loads(subprocess.check_output([
386	            PYTHON, '-c', 'import sys, json; json.dump(sys.path, sys.stdout)']))
387	        paths = reversed(tuple(map(abspath, [x for x in sys_path if x.startswith('/') and not x.startswith('/Library/')])))

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\bypy\macos\__main__.py:465:12
464	        size_in_mb = int(
465	            subprocess.check_output(['du', '-s', '-k', tdir]).decode('utf-8')
466	            .split()[0]) / 1024.

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:465:12
464	        size_in_mb = int(
465	            subprocess.check_output(['du', '-s', '-k', tdir]).decode('utf-8')
466	            .split()[0]) / 1024.

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\bypy\macos\__main__.py:478:12
477	        with timeit() as times:
478	            subprocess.check_call(cmd + [dmg])
479	        print('dmg created in {} minutes and {} seconds'.format(*times))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\docs\conf.py:12:0
11	import re
12	import subprocess
13	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docs\conf.py:200:20
199	    try:
200	        commit_id = subprocess.check_output(
201	            f'git rev-list --max-count=1 --skip=# {text}'.split()).decode('utf-8').strip()
202	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\docs\conf.py:209:15
208	    set_classes(options)
209	    short_id = subprocess.check_output(
210	        f'git rev-list --max-count=1 --abbrev-commit --skip=# {commit_id}'.split()).decode('utf-8').strip()
211	    node = nodes.reference(rawtext, f'commit: {short_id}', refuri=url, **options)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'never'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\docs\kitty_at_template.py:225:28
224	def get_password(opts):
225	    if opts.use_password == 'never':
226	        return ''

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '-'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\docs\kitty_at_template.py:231:33
230	    if not ans and opts.password_file:
231	        if opts.password_file == '-':
232	            if sys.stdin.isatty():

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'always'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\docs\kitty_at_template.py:252:40
251	        ans = os.environ.get(opts.password_env, '')
252	    if not ans and opts.use_password == 'always':
253	        raise SystemExit('No password was found')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\gen-apc-parsers.py:5:0
4	import os
5	import subprocess
6	from collections import defaultdict

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\gen-apc-parsers.py:247:4
246	        print(text, file=f)
247	    subprocess.check_call(['clang-format', '-i', path])
248	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\gen-apc-parsers.py:247:4
246	        print(text, file=f)
247	    subprocess.check_call(['clang-format', '-i', path])
248	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\gen-wcwidth.py:33:25
32	    bn = os.path.basename(url)
33	    local = os.path.join('/tmp', bn)
34	    if os.path.exists(local):

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\gen-wcwidth.py:38:15
37	    else:
38	        data = urlopen(url).read()
39	        with open(local, 'wb') as f:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\glad\generate.py:9:0
8	import shutil
9	import subprocess
10	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\glad\generate.py:27:4
26	
27	    subprocess.check_call(
28	        shlex.split(cmdline.format(dest='out'))
29	    )
30	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\collect.py:203:8
202	        data = data_for_path(path)
203	        assert isinstance(data, str)
204	        data = data.replace('\t', self.replace_tab_by)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\kittens\diff\collect.py:213:11
212	def hash_for_path(path: str) -> bytes:
213	    return md5(raw_data_for_path(path)).digest()
214	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\diff\main.py:7:0
6	import signal
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\main.py:86:16
85	            if not is_binary:
86	                assert changed_path is not None
87	                d.add_diff(path, changed_path)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\diff\main.py:625:8
624	    cmd.append(rpath)
625	    p = subprocess.Popen(cmd, stdout=subprocess.PIPE)
626	    assert p.stdout is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\main.py:626:4
625	    p = subprocess.Popen(cmd, stdout=subprocess.PIPE)
626	    assert p.stdout is not None
627	    raw = p.stdout.read()

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b202_tarfile_unsafe_members.html
   Location: .\kittens\diff\main.py:632:8
631	        members = tf.getmembers()
632	        tf.extractall(tdir)
633	        if len(members) == 1:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\diff\patch.py:8:0
7	import shutil
8	import subprocess
9	from typing import Dict, Iterator, List, Optional, Sequence, Tuple, Union

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\diff\patch.py:23:31
22	def find_differ() -> Optional[str]:
23	    if shutil.which('git') and subprocess.Popen(['git', '--help'], stderr=subprocess.DEVNULL, stdout=subprocess.DEVNULL).wait() == 0:
24	        return GIT_DIFF

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\diff\patch.py:23:31
22	def find_differ() -> Optional[str]:
23	    if shutil.which('git') and subprocess.Popen(['git', '--help'], stderr=subprocess.DEVNULL, stdout=subprocess.DEVNULL).wait() == 0:
24	        return GIT_DIFF

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\diff\patch.py:48:8
47	    path2 = os.path.realpath(file2)
48	    p = subprocess.Popen(
49	            cmd + [path1, path2],
50	            stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.DEVNULL)
51	    worker_processes.append(p.pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\patch.py:235:8
234	        executor = self.diff_executor
235	        assert executor is not None
236	        jobs = {executor.submit(run_diff, key, self.jmap[key], context): key for key in self.jobs}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\render.py:185:8
184	        filler = render_diff_line('', '', 'filler', margin_size, available_cols)
185	        assert other_path is not None
186	        yield filler + fl(other_path, added_format)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\render.py:521:20
520	                else:
521	                    assert other_path is not None
522	                    ans = lines_for_diff(path, other_path, diff_map[path], args, columns, margin_size)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\diff\render.py:540:16
539	            elif item_type == 'rename':
540	                assert other_path is not None
541	                ans = yield_lines_from(rename_lines(path, other_path, args, columns, margin_size), item_ref)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\hints\main.py:462:8
461	        nonlocal idx, active_hyperlink_url, active_hyperlink_id, active_hyperlink_start_offset
462	        assert active_hyperlink_url is not None
463	        hyperlinks.append(Mark(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\kittens\hints\main.py:538:10
537	# CLI {{{
538	OPTIONS = r'''
539	--program
540	type=list
541	What program to use to open matched text. Defaults to the default open program
542	for the operating system. Various special values are supported:
543	
544	:code:`-`
545	    paste the match into the terminal window.
546	
547	:code:`@`
548	    copy the match to the clipboard
549	
550	:code:`*`
551	    copy the match to the primary selection (on systems that support primary selections)
552	
553	:code:`default`
554	    run the default open program.
555	
556	:code:`launch`
557	    run :doc:`/launch` to open the program in a new kitty tab, window, overlay, etc.
558	    For example::
559	
560	        --program "launch --type=tab vim"
561	
562	Can be specified multiple times to run multiple programs.
563	
564	
565	--type
566	default=url
567	choices=url,regex,path,line,hash,word,linenum,hyperlink,ip
568	The type of text to search for. A value of :code:`linenum` is special, it looks
569	for error messages using the pattern specified with :option:`--regex`, which
570	must have the named groups: :code:`path` and :code:`line`. If not specified,
571	will look for :code:`path:line`. The :option:`--linenum-action` option
572	controls where to display the selected error message, other options are ignored.
573	
574	
575	--regex
576	default={default_regex}
577	The regular expression to use when option :option:`--type` is set to
578	:code:`regex`, in python syntax. If you specify a numbered group in the regular
579	expression, only the group will be matched. This allow you to match text
580	ignoring a prefix/suffix, as needed. The default expression matches lines. To
581	match text over multiple lines, you should prefix the regular expression with
582	:code:`(?ms)`, which turns on MULTILINE and DOTALL modes for the regex engine.
583	If you specify named groups and a :option:`--program`, then the program will be
584	passed arguments corresponding to each named group of the form
585	:code:`key=value`.
586	
587	
588	--linenum-action
589	default=self
590	type=choice
591	choices=self,window,tab,os_window,background
592	Where to perform the action on matched errors. :code:`self` means the current
593	window, :code:`window` a new kitty window, :code:`tab` a new tab,
594	:code:`os_window` a new OS window and :code:`background` run in the background.
595	The actual action is whatever arguments are provided to the kitten, for
596	example:
597	:code:`kitty +kitten hints --type=linenum --linenum-action=tab vim +{line} {path}`
598	will open the matched path at the matched line number in vim in
599	a new kitty tab. Note that in order to use :option:`--program` to copy or paste
600	text, you need to use the special value :code:`self`.
601	
602	
603	--url-prefixes
604	default=default
605	Comma separated list of recognized URL prefixes. Defaults to the list of
606	prefixes defined by the :opt:`url_prefixes` option in :file:`kitty.conf`.
607	
608	
609	--word-characters
610	Characters to consider as part of a word. In addition, all characters marked as
611	alphanumeric in the Unicode database will be considered as word characters.
612	Defaults to the :opt:`select_by_word_characters` option from :file:`kitty.conf`.
613	
614	
615	--minimum-match-length
616	default=3
617	type=int
618	The minimum number of characters to consider a match.
619	
620	
621	--multiple
622	type=bool-set
623	Select multiple matches and perform the action on all of them together at the
624	end. In this mode, press :kbd:`Esc` to finish selecting.
625	
626	
627	--multiple-joiner
628	default=auto
629	String for joining multiple selections when copying to the clipboard or
630	inserting into the terminal. The special values are: :code:`space` - a space
631	character, :code:`newline` - a newline, :code:`empty` - an empty joiner,
632	:code:`json` - a JSON serialized list, :code:`auto` - an automatic choice, based
633	on the type of text being selected. In addition, integers are interpreted as
634	zero-based indices into the list of selections. You can use :code:`0` for the
635	first selection and :code:`-1` for the last.
636	
637	
638	--add-trailing-space
639	default=auto
640	choices=auto,always,never
641	Add trailing space after matched text. Defaults to :code:`auto`, which adds the
642	space when used together with :option:`--multiple`.
643	
644	
645	--hints-offset
646	default=1
647	type=int
648	The offset (from zero) at which to start hint numbering. Note that only numbers
649	greater than or equal to zero are respected.
650	
651	
652	--alphabet
653	The list of characters to use for hints. The default is to use numbers and
654	lowercase English alphabets. Specify your preference as a string of characters.
655	Note that you need to specify the :option:`--hints-offset` as zero to use the
656	first character to highlight the first match, otherwise it will start with the
657	second character by default.
658	
659	
660	--ascending
661	type=bool-set
662	Make the hints increase from top to bottom, instead of decreasing from top to
663	bottom.
664	
665	
666	--hints-foreground-color
667	default=black
668	type=str
669	The foreground color for hints.
670	
671	
672	--hints-background-color
673	default=green
674	type=str
675	The background color for hints.
676	
677	
678	--hints-text-color
679	default=gray
680	type=str
681	The foreground color for text pointed to by the hints.
682	
683	
684	--customize-processing
685	Name of a python file in the kitty config directory which will be imported to
686	provide custom implementations for pattern finding and performing actions
687	on selected matches. You can also specify absolute paths to load the script from
688	elsewhere. See {hints_url} for details.
689	
690	
691	--window-title
692	The title for the hints window, default title is based on the type of text being
693	hinted.
694	'''.format(
695	    default_regex=DEFAULT_REGEX,

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\hints\main.py:768:8
767	    elif action == 'background':
768	        import subprocess
769	        subprocess.Popen(cmd, cwd=data['cwd'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\hints\main.py:769:8
768	        import subprocess
769	        subprocess.Popen(cmd, cwd=data['cwd'])
770	    else:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\hyperlinked_grep\main.py:8:0
7	import socket
8	import subprocess
9	import sys

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kittens\hyperlinked_grep\main.py:66:8
65	    if delegate_to_rg or (not sys.stdout.isatty() and '--pretty' not in sys.argv and '-p' not in sys.argv):
66	        os.execlp('rg', 'rg', *sys.argv[1:])
67	    cmdline = ['rg', '--pretty', '--with-filename'] + sys.argv[1:]

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\hyperlinked_grep\main.py:66:8
65	    if delegate_to_rg or (not sys.stdout.isatty() and '--pretty' not in sys.argv and '-p' not in sys.argv):
66	        os.execlp('rg', 'rg', *sys.argv[1:])
67	    cmdline = ['rg', '--pretty', '--with-filename'] + sys.argv[1:]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\hyperlinked_grep\main.py:69:12
68	    try:
69	        p = subprocess.Popen(cmdline, stdout=subprocess.PIPE)
70	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\hyperlinked_grep\main.py:72:4
71	        raise SystemExit('Could not find the rg executable in your PATH. Is ripgrep installed?')
72	    assert p.stdout is not None
73	    write: Callable[[bytes], None] = cast(Callable[[bytes], None], sys.stdout.buffer.write)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\kittens\icat\main.py:484:24
483	                    with socket_timeout(30):
484	                        urlretrieve(item, filename=tf.name)
485	                except Exception as e:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\panel\main.py:6:0
5	import shutil
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\panel\main.py:71:13
70	    try:
71	        cp = subprocess.run(cmd_, stdout=subprocess.DEVNULL if silent else None)
72	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\remote_file\main.py:9:0
8	import shutil
9	import subprocess
10	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:138:12
137	    def check_call(self, cmd: List[str]) -> None:
138	        p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.DEVNULL)
139	        stdout = p.communicate()[0]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:157:12
156	        if not self.is_ssh_kitten:
157	            subprocess.Popen(
158	                self.batch_cmd_prefix + ['-O', 'exit', self.conn_data.hostname],
159	                stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL
160	            ).wait()
161	        if self.tdir:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:168:15
167	            return True
168	        return subprocess.Popen(
169	            self.batch_cmd_prefix + ['-O', 'check', self.conn_data.hostname],
170	            stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL
171	        ).wait() == 0
172	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:176:13
175	            return True
176	        cp = subprocess.run(self.batch_cmd_prefix + [self.conn_data.hostname, 'hostname', '-f'], stdout=subprocess.PIPE,
177	                            stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL)
178	        if cp.returncode == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:211:17
210	        with open(self.dest, 'wb') as f:
211	            cp = subprocess.run(cmdline, stdout=f, stderr=subprocess.PIPE, stdin=subprocess.DEVNULL)
212	            if cp.returncode != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:224:21
223	            if suppress_output:
224	                cp = subprocess.run(cmd, stdin=f, capture_output=True)
225	                if cp.returncode == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:229:23
228	            else:
229	                return subprocess.run(cmd, stdin=f).returncode == 0
230	        return False

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\remote_file\main.py:342:29
341	            print(reset_terminal(), end='', flush=True)
342	            editor_process = subprocess.Popen(editor + [master.dest])
343	            while editor_process.poll() is None:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\kittens\runner.py:56:12
55	            g = {'__name__': 'kitten'}
56	            exec(code, g)
57	            hr = g.get('handle_result', lambda *a, **kw: None)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\ssh\completion.py:6:0
5	import re
6	import subprocess
7	from typing import Callable, Dict, Iterable, Iterator, Sequence, Tuple

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\completion.py:27:17
26	    try:
27	        output = subprocess.check_output(cmd).decode('utf-8')
28	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\ssh\main.py:14:0
13	import stat
14	import subprocess
15	import sys

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kittens\ssh\main.py:414:8
413	            print(self.err_msg, file=sys.stderr)
414	        os.execlp(ssh_exe(), 'ssh')
415	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kittens\ssh\main.py:524:38
523	    # /Users/WHY_DOES_ANYONE_USE_MACOS/Library/Caches/APPLE_ARE_IDIOTIC
524	    if len(rd) > 35 and os.path.isdir('/tmp'):
525	        idiotic_design = f'/tmp/kssh-rdir-{os.getuid()}'

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kittens\ssh\main.py:525:25
524	    if len(rd) > 35 and os.path.isdir('/tmp'):
525	        idiotic_design = f'/tmp/kssh-rdir-{os.getuid()}'
526	        try:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kittens\ssh\main.py:535:57
534	                if dest != rd:
535	                    with tempfile.TemporaryDirectory(dir='/tmp') as tdir:
536	                        tlink = os.path.join(tdir, 'sigh')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\main.py:573:13
572	    if tmux:
573	        cp = subprocess.run([tmux, 'set', '-p', 'allow-passthrough', 'on'])
574	        if cp.returncode != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\main.py:584:8
583	def ssh_version() -> Tuple[int, int]:
584	    o = subprocess.check_output([ssh_exe(), '-V'], stderr=subprocess.STDOUT).decode()
585	    m = re.match(r'OpenSSH_(\d+).(\d+)', o)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\main.py:708:13
707	    if need_to_request_data and host_opts.share_connections:
708	        cp = subprocess.run(cmd[:1] + ['-O', 'check'] + cmd[1:], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
709	        if cp.returncode == 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\main.py:718:16
717	        try:
718	            p = subprocess.Popen(cmd)
719	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kittens\ssh\main.py:741:8
740	            raise SystemExit(f'The SSH kitten cannot work with the options: {", ".join(passthrough_args)}')
741	        os.execlp(ssh_exe(), 'ssh', *args)
742	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\ssh\utils.py:6:0
5	import os
6	import subprocess
7	from typing import Any, Dict, List, Sequence

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kittens\ssh\utils.py:15:12
14	    try:
15	        p = subprocess.run(['ssh'], stderr=subprocess.PIPE, encoding='utf-8')
16	        raw = p.stderr or ''

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\ssh\utils.py:15:12
14	    try:
15	        p = subprocess.run(['ssh'], stderr=subprocess.PIPE, encoding='utf-8')
16	        raw = p.stderr or ''

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\kittens\themes\collection.py:369:14
368	    try:
369	        res = urlopen(rq, timeout=30)
370	    except HTTPError as e:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\kittens\themes\collection.py:479:11
478	        return False
479	    nraw = urlopen(td['upstream']).read().decode('utf-8')
480	    if raw == nraw:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\transfer\send.py:92:8
91	        sl = self.signature_loader
92	        assert sl is not None
93	        self.state = FileState.transmitting

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\transfer\send.py:420:8
419	        sl = file.signature_loader
420	        assert sl is not None
421	        sl.add_chunk(ftc.data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\tui\handler.py:70:8
69	    def image_manager(self) -> ImageManagerType:
70	        assert self._image_manager is not None
71	        return self._image_manager

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\tui\images.py:137:4
136	    global last_imagemagick_cmd
137	    import subprocess
138	    last_imagemagick_cmd = cmd

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\tui\images.py:140:12
139	    try:
140	        p = subprocess.run(cmd, stdout=subprocess.PIPE if keep_stdout else subprocess.DEVNULL, stderr=subprocess.PIPE)
141	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kittens\tui\loop.py:306:16
305	                    name, val = parts[0], unhexlify(parts[1]).decode('utf-8', 'replace')
306	                except Exception:
307	                    continue
308	                self.handler.on_capability_response(name, val)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\tui\loop.py:317:16
316	                    ev = decode_sgr_mouse(csi[1:], self.handler.screen_size)
317	                except Exception:
318	                    pass
319	                else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\tui\loop.py:330:12
329	                k = decode_key_event(csi[:-1], q)
330	            except Exception:
331	                pass
332	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kittens\tui\operations.py:395:16
394	                x = to_color(which)
395	                assert x is not None
396	                q = color_as_sharp(x)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kittens\unicode_input\main.py:5:0
4	import string
5	import subprocess
6	import sys

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\unicode_input\main.py:98:8
97	            code = int(code_text, 16)
98	        except Exception:
99	            pass
100	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kittens\unicode_input\main.py:441:12
440	                val = int(self.line_edit.current_input, 16)
441	            except Exception:
442	                pass
443	            else:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kittens\unicode_input\main.py:519:16
518	        with self.suspend():
519	            p = subprocess.Popen(get_editor() + [favorites_path])
520	            if p.wait() == 0:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\actions.py:50:8
49	        long_help = '\n'.join(lines).strip()
50	        assert spec.group in groups
51	        return Action(getattr(x, '__name__'), cast(ActionGroup, spec.group), short_help, long_help)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:451:8
450	    def add_child(self, window: Window) -> None:
451	        assert window.child.pid is not None and window.child.child_fd is not None
452	        self.child_monitor.add_child(window.id, window.child.pid, window.child.child_fd, window.screen)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:1421:8
1420	            return
1421	        assert tm is not None
1422	        self.confirm(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\boss.py:1892:8
1891	    ) -> None:
1892	        import subprocess
1893	        env = env or None

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\boss.py:1905:16
1904	            try:
1905	                subprocess.Popen(cmd, env=env, stdin=r, cwd=cwd, preexec_fn=clear_handled_signals)
1906	            except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\boss.py:1913:12
1912	        else:
1913	            subprocess.Popen(cmd, env=env, cwd=cwd, preexec_fn=clear_handled_signals)
1914	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:2170:16
2169	            try:
2170	                assert update_check_process.stdout is not None
2171	                raw = update_check_process.stdout.read().decode('utf-8')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:2185:12
2184	        if activated:
2185	            assert isinstance(b, str)
2186	            dbus_notification_activated(a, b)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:2188:12
2187	        else:
2188	            assert isinstance(b, int)
2189	            dbus_notification_created(a, b)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\boss.py:2255:20
2254	                    q = self.active_tab_manager
2255	                    assert q is not None
2256	                    tm = q

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\child.py:56:12
55	        def cwd_of_process(pid: int) -> str:
56	            import subprocess
57	            cp = subprocess.run(['pwdx', str(pid)], capture_output=True)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\child.py:57:17
56	            import subprocess
57	            cp = subprocess.run(['pwdx', str(pid)], capture_output=True)
58	            if cp.returncode != 0:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\child.py:57:17
56	            import subprocess
57	            cp = subprocess.run(['pwdx', str(pid)], capture_output=True)
58	            if cp.returncode != 0:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\child.py:76:12
75	                pid = int(x)
76	            except Exception:
77	                continue
78	            try:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\child.py:85:12
84	                q = int(raw.split(' ', 5)[4])
85	            except Exception:
86	                continue
87	            ans[q].append(pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:388:12
387	        try:
388	            assert self.pid is not None
389	            return self.cmdline_of_pid(self.pid) or list(self.argv)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:396:12
395	        try:
396	            assert self.pid_for_cwd is not None
397	            return self.cmdline_of_pid(self.pid_for_cwd) or self.cmdline

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:404:12
403	        try:
404	            assert self.pid is not None
405	            return environ_of_process(self.pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:412:12
411	        with suppress(Exception):
412	            assert self.pid is not None
413	            return cwd_of_process(self.pid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\child.py:418:12
417	        with suppress(Exception):
418	            assert self.child_fd is not None
419	            pgrp = os.tcgetpgrp(self.child_fd)

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\kitty\cli.py:277:56
276	                    elif k == 'condition':
277	                        current_cmd['condition'] = bool(eval(v))
278	                    elif k == 'completion':

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\cli.py:464:12
463	        if print_help_for_seq.allow_pager and sys.stdout.isatty():
464	            import subprocess
465	            p = subprocess.Popen(['less', '-isRXF'], stdin=subprocess.PIPE, preexec_fn=clear_handled_signals)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\cli.py:465:16
464	            import subprocess
465	            p = subprocess.Popen(['less', '-isRXF'], stdin=subprocess.PIPE, preexec_fn=clear_handled_signals)
466	            try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\cli.py:465:16
464	            import subprocess
465	            p = subprocess.Popen(['less', '-isRXF'], stdin=subprocess.PIPE, preexec_fn=clear_handled_signals)
466	            try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\cli_stub.py:94:4
93	if __name__ == '__main__':
94	    import subprocess
95	    subprocess.Popen([

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\cli_stub.py:95:4
94	    import subprocess
95	    subprocess.Popen([
96	        'kitty', '+runpy',
97	        'from kitty.cli_stub import generate_stub; generate_stub()'
98	    ])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\cli_stub.py:95:4
94	    import subprocess
95	    subprocess.Popen([
96	        'kitty', '+runpy',
97	        'from kitty.cli_stub import generate_stub; generate_stub()'
98	    ])

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\debug_config.py:187:8
186	    if is_macos:
187	        import subprocess
188	        p(' '.join(subprocess.check_output(['sw_vers']).decode('utf-8').splitlines()).strip())

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\debug_config.py:188:19
187	        import subprocess
188	        p(' '.join(subprocess.check_output(['sw_vers']).decode('utf-8').splitlines()).strip())
189	    if os.path.exists('/etc/issue'):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\debug_config.py:188:19
187	        import subprocess
188	        p(' '.join(subprocess.check_output(['sw_vers']).decode('utf-8').splitlines()).strip())
189	    if os.path.exists('/etc/issue'):

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kitty\debug_config.py:192:8
191	            idata = IssueData()
192	        except Exception:
193	            pass
194	        else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kitty\debug_config.py:198:16
197	                    datums = idata.parse_issue_file(f)
198	                except Exception:
199	                    pass
200	                else:

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\kitty\entry_points.py:30:4
29	    sys.argv = ['kitty'] + args[2:]
30	    exec(args[1])
31	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\entry_points.py:34:4
33	def hold(args: List[str]) -> None:
34	    import subprocess
35	    ret = 1

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\entry_points.py:37:14
36	    try:
37	        ret = subprocess.Popen(args[1:]).wait()
38	    except KeyboardInterrupt:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kitty\entry_points.py:102:4
101	                cmd = line.split(' ', maxsplit=1)
102	    os.execvp(cmd[0], cmd + [script_path])
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\fonts\box_drawing.py:1113:12
1112	            height *= len(rows)
1113	            assert len(rgb_data) == width * height * 4, f'{len(rgb_data)} != {width * height * 4}'
1114	            display_bitmap(rgb_data, width, height)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\fonts\render.py:493:4
492	        f.write(rgb_data)
493	    assert len(rgb_data) == 4 * width * height
494	    show(f.name, width, height, 0, 32, align='left')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\base.py:127:4
126	    cells_map = calculate_cells_map(bias, number_of_windows, number_of_cells)
127	    assert sum(cells_map) == number_of_cells
128	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\base.py:229:8
228	        self.layout_opts = self.parse_layout_opts(layout_opts)
229	        assert self.name is not None
230	        self.full_name = f'{self.name}:{layout_opts}' if layout_opts else self.name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\base.py:274:8
273	        w = all_windows.active_window
274	        assert w is not None
275	        return self.neighbors_for_window(w, all_windows)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\grid.py:253:8
252	        wg = all_windows.group_for_window(window)
253	        assert wg is not None
254	        ncols, nrows, special_rows, special_col = calc_grid_size(n)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\splits.py:139:8
138	            self.one = pair = Pair(horizontal=self.horizontal)
139	        assert isinstance(window_to_be_split, int)
140	        pair.balanced_add(window_to_be_split)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\splits.py:462:12
461	            ag = all_windows.active_group
462	            assert ag is not None
463	            group_id = ag.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\splits.py:517:8
516	        wg = all_windows.group_for_window(window)
517	        assert wg is not None
518	        pair = self.pairs_root.pair_for_window(wg.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\stack.py:23:8
22	        wg = all_windows.group_for_window(window)
23	        assert wg is not None
24	        groups = tuple(all_windows.iter_all_layoutable_groups())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\tall.py:28:4
27	    wg = all_windows.group_for_window(window)
28	    assert wg is not None
29	    groups = tuple(all_windows.iter_all_layoutable_groups())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\layout\vertical.py:123:8
122	        wg = all_windows.group_for_window(window)
123	        assert wg is not None
124	        groups = tuple(all_windows.iter_all_layoutable_groups())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\main.py:80:4
79	    sdata = json.dumps(data, ensure_ascii=False).encode('utf-8')
80	    assert single_instance.socket is not None
81	    single_instance.socket.sendall(sdata)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\main.py:87:8
86	    if args.wait_for_single_instance_window_close:
87	        assert notify_socket is not None
88	        conn = notify_socket.accept()[0]

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:243:23
242	    if do_profile:
243	        start_profiler('/tmp/kitty-profile.log')
244	    yield

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\main.py:246:8
245	    if do_profile:
246	        import subprocess
247	        stop_profiler()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:249:13
248	        exe = kitty_exe()
249	        cg = '/tmp/kitty-profile.callgrind'
250	        print('Post processing profile data for', exe, '...')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\main.py:252:12
251	        with open(cg, 'wb') as f:
252	            subprocess.call(['pprof', '--callgrind', exe, '/tmp/kitty-profile.log'], stdout=f)
253	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\main.py:252:12
251	        with open(cg, 'wb') as f:
252	            subprocess.call(['pprof', '--callgrind', exe, '/tmp/kitty-profile.log'], stdout=f)
253	        try:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:252:58
251	        with open(cg, 'wb') as f:
252	            subprocess.call(['pprof', '--callgrind', exe, '/tmp/kitty-profile.log'], stdout=f)
253	        try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\main.py:254:12
253	        try:
254	            subprocess.Popen(['kcachegrind', cg], preexec_fn=clear_handled_signals)
255	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\main.py:254:12
253	        try:
254	            subprocess.Popen(['kcachegrind', cg], preexec_fn=clear_handled_signals)
255	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\main.py:256:12
255	        except FileNotFoundError:
256	            subprocess.call(['pprof', '--text', exe, '/tmp/kitty-profile.log'])
257	            print('To view the graphical call data, use: kcachegrind', cg)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\main.py:256:12
255	        except FileNotFoundError:
256	            subprocess.call(['pprof', '--text', exe, '/tmp/kitty-profile.log'])
257	            print('To view the graphical call data, use: kcachegrind', cg)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\main.py:256:53
255	        except FileNotFoundError:
256	            subprocess.call(['pprof', '--text', exe, '/tmp/kitty-profile.log'])
257	            print('To view the graphical call data, use: kcachegrind', cg)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\marks.py:82:8
81	    if ftype == 'regex':
82	        assert not isinstance(spec, str)
83	        if len(spec) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\marks.py:88:8
87	        import runpy
88	        assert isinstance(spec, str)
89	        path = resolve_custom_file(spec)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\multiprocessing.py:68:8
67	        x = q.get(timeout=2)
68	        assert x == 'hello'
69	        p.join()

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\open_actions.py:68:12
67	                alias_name, alias_val = rest.split(maxsplit=1)
68	            except Exception:
69	                continue
70	            alias_map[alias_name] = [ActionAlias(alias_name, alias_val)]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\options\utils.py:1119:8
1118	    else:
1119	        assert key is not None
1120	        yield KeyDefinition(False, SingleKey(mods, is_native, key), definition=action)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\prewarm.py:591:8
590	    if use_exec:
591	        import subprocess
592	        tp = subprocess.Popen(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\prewarm.py:592:13
591	        import subprocess
592	        tp = subprocess.Popen(
593	            [kitty_exe(), '+runpy', f'from kitty.prewarm import exec_main; exec_main({stdin_read}, {stdout_write}, {death_notify_write})'],
594	            pass_fds=(stdin_read, stdout_write, death_notify_write))
595	        child_pid = tp.pid

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\kitty\rc\select_window.py:33:38
32	    )
33	    options_spec = MATCH_TAB_OPTION + '\n\n' + '''\
34	--response-timeout

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\kitty\rc\select_window.py:33:47
32	    )
33	    options_spec = MATCH_TAB_OPTION + '\n\n' + '''\
34	--response-timeout
35	type=float
36	default=60
37	The time in seconds to wait for the user to select a window.
38	
39	
40	--self
41	type=bool-set
42	Select window from the tab containing the window this command is run in,
43	instead of the active tab.
44	
45	
46	--title
47	A title that will be displayed to the user to describe what this selection is for.
48	
49	
50	--exclude-active
51	type=bool-set
52	Exclude the currently active window from the list of windows to pick.
53	
54	
55	--reactivate-prev-tab
56	type=bool-set
57	When the selection is finished, the tab in the same OS window that was activated
58	before the selection will be reactivated. The last activated OS window will also
59	be refocused.
60	'''
61	    is_asynchronous = True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\remote_control.py:307:12
306	        def send_generator() -> Iterator[bytes]:
307	            assert payload is not None
308	            for chunk in payload:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'never'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\kitty\remote_control.py:413:28
412	def get_password(opts: RCOptions) -> str:
413	    if opts.use_password == 'never':
414	        return ''

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '-'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\kitty\remote_control.py:419:33
418	    if not ans and opts.password_file:
419	        if opts.password_file == '-':
420	            if sys.stdin.isatty():

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'always'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\kitty\remote_control.py:440:40
439	        ans = os.environ.get(opts.password_env, '')
440	    if not ans and opts.use_password == 'always':
441	        raise SystemExit('No password was found')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\search_query_parser.py:228:12
227	            tt = self.token(advance=True)
228	            assert tt is not None
229	            if self.allow_no_location:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\search_query_parser.py:234:8
233	        tt = self.token(advance=True)
234	        assert tt is not None
235	        words = tt.split(':')

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\search_query_parser.py:253:16
252	                tt = self.token(advance=True)
253	                assert tt is not None
254	                return TokenNode(loc, tt)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\shell_integration.py:6:0
5	import os
6	import subprocess
7	from contextlib import suppress

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\shell_integration.py:33:8
32	        zdotdir = env.get('HOME', os.path.expanduser('~'))
33	        assert isinstance(zdotdir, str)
34	        if zdotdir == '~':

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\shell_integration.py:45:15
44	    with suppress(Exception):
45	        return subprocess.check_output([exe, '--norcs', '--interactive', '-c', 'echo -n $ZDOTDIR'], env=env).decode('utf-8')
46	    return None

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b307-eval
   Location: .\kitty\tab_bar.py:229:16
228	    try:
229	        title = eval(compile_template(template), {'__builtins__': safe_builtins}, eval_locals)
230	    except Exception as e:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\tabs.py:804:12
803	        else:
804	            assert old_active_tab is not None
805	            add_active_id_to_history(self.active_tab_history, old_active_tab.id)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kitty\tabs.py:1072:12
1071	                idx = self.tabs.index(active_tab_before_removal)
1072	            except Exception:
1073	                pass
1074	            else:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\update_check.py:5:0
4	import os
5	import subprocess
6	import time

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\kitty\update_check.py:51:14
50	    try:
51	        raw = urlopen(RELEASED_VERSION_URL).read().decode('utf-8').strip()
52	    except Exception:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\update_check.py:72:16
71	                    n = parse_line(line)
72	                except Exception:
73	                    continue
74	                notified_versions[n.version] = n

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty\update_check.py:110:15
109	    import time
110	    time.sleep(random.randint(1000, 4000) / 1000)
111	    with suppress(BrokenPipeError):  # happens if parent process is killed before us

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\update_check.py:117:12
116	    try:
117	        p = subprocess.Popen([
118	            kitty_exe(), '+runpy',
119	            'from kitty.update_check import run_worker; run_worker()'
120	        ], stdout=subprocess.PIPE, preexec_fn=clear_handled_signals)
121	    except OSError as e:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\utils.py:170:8
169	                    yield c, int(q) & 0xffffff
170	        except Exception:
171	            continue
172	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:274:4
273	             cwd: Optional[str] = None, extra_env: Optional[Dict[str, str]] = None) -> 'PopenType[bytes]':
274	    import subprocess
275	    if arg is not None:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:285:11
284	        env.update(extra_env)
285	    return subprocess.Popen(
286	        tuple(cmd), stdin=subprocess.DEVNULL, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, cwd=cwd or None,
287	        preexec_fn=clear_handled_signals, env=env)
288	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\utils.py:702:41
701	    path = abspath(path)
702	    candidates = frozenset(map(abspath, ('/tmp', '/dev/shm', os.environ.get('TMPDIR', None), tempfile.gettempdir())))
703	    for q in candidates:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty\utils.py:702:49
701	    path = abspath(path)
702	    candidates = frozenset(map(abspath, ('/tmp', '/dev/shm', os.environ.get('TMPDIR', None), tempfile.gettempdir())))
703	    for q in candidates:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:833:8
832	        setattr(read_shell_environment, 'ans', ans)
833	        import subprocess
834	        shell = resolved_shell(opts)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:842:16
841	        try:
842	            p = subprocess.Popen(
843	                shell + ['-c', 'env'], stdout=slave, stdin=slave, stderr=slave, start_new_session=True, close_fds=True,
844	                preexec_fn=clear_handled_signals)
845	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kitty\utils.py:905:4
904	    editor = get_editor()
905	    os.execvp(editor[0], editor + [p])
906	

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\utils.py:971:8
970	            cmd = cmdline_of_pid(pid)
971	        except Exception:
972	            continue
973	        if cmd and is_kitty_gui_cmdline(*cmd):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:1010:4
1009	    import glob
1010	    import subprocess
1011	    try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\utils.py:1016:20
1015	        return
1016	    workers = tuple(subprocess.Popen([
1017	        'ssh', '-o', f'ControlPath={x}', '-O', 'exit', 'kitty-unused-host-name'], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL,
1018	        preexec_fn=clear_handled_signals) for x in files)
1019	    for w in workers:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:1016:20
1015	        return
1016	    workers = tuple(subprocess.Popen([
1017	        'ssh', '-o', f'ControlPath={x}', '-O', 'exit', 'kitty-unused-host-name'], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL,
1018	        preexec_fn=clear_handled_signals) for x in files)
1019	    for w in workers:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:1038:4
1037	    # platform.mac_ver does not work thanks to Apple's stupid "hardening", so just use sw_vers
1038	    import subprocess
1039	    try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty\utils.py:1040:12
1039	    try:
1040	        o = subprocess.check_output(['sw_vers', '-productVersion'], stderr=subprocess.STDOUT).decode()
1041	    except Exception:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:1040:12
1039	    try:
1040	        o = subprocess.check_output(['sw_vers', '-productVersion'], stderr=subprocess.STDOUT).decode()
1041	    except Exception:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\utils.py:1048:4
1047	def less_version(less_exe: str = 'less') -> int:
1048	    import subprocess
1049	    o = subprocess.check_output([less_exe, '-V'], stderr=subprocess.STDOUT).decode()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\utils.py:1049:8
1048	    import subprocess
1049	    o = subprocess.check_output([less_exe, '-V'], stderr=subprocess.STDOUT).decode()
1050	    m = re.match(r'less (\d+)', o)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\kitty\utils.py:1061:4
1060	        return False
1061	    except Exception:
1062	        pass
1063	    return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\window.py:666:12
665	        if field == 'env':
666	            assert isinstance(pat, tuple)
667	            key_pat, val_pat = pat

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\window.py:673:8
672	            return False
673	        assert not isinstance(pat, tuple)
674	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty\window.py:946:12
945	            import shlex
946	            import subprocess
947	            env = self.child.foreground_environ

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty\window.py:949:12
948	            env['KITTY_CHILD_CMDLINE'] = ' '.join(map(shlex.quote, self.child.cmdline))
949	            subprocess.Popen(cb, env=env, cwd=self.child.foreground_cwd, preexec_fn=clear_handled_signals)
950	        if not self.is_active:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\kitty\window.py:1030:20
1029	                    qc = self.screen.color_profile.as_color((c << 8) | 1)
1030	                    assert qc is not None
1031	                    self.report_color(f'4;{c}', qc.red, qc.green, qc.blue)

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\kitty\window.py:1044:20
1043	                        y = int(x)
1044	                    except Exception:
1045	                        continue
1046	                    if 0 <= y <= 255:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kitty_tests\__init__.py:228:12
227	            signal.pthread_sigmask(signal.SIG_SETMASK, ())
228	            os.execvpe(argv[0], argv, env or os.environ)
229	        if stdin_fd is not None:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\bench_scrollback.py:23:10
22	
23	    rng = Random()
24	    rng.seed(args.seed)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty_tests\check_build.py:112:8
111	        from kitty.constants import kitty_exe
112	        import subprocess
113	        exe = kitty_exe()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty_tests\check_build.py:114:13
113	        exe = kitty_exe()
114	        cp = subprocess.run([exe, '+runpy', f'''\
115	import os, sys
116	if sys.stdin:
117	    os.close(sys.stdin.fileno())
118	if sys.stdout:
119	    os.close(sys.stdout.fileno())
120	if sys.stderr:
121	    os.close(sys.stderr.fileno())
122	os.execlp({exe!r}, 'kitty', '+runpy', 'import sys; raise SystemExit(1 if sys.stdout is None or sys.stdin is None or sys.stderr is None else 0)')
123	'''])
124	        self.assertEqual(cp.returncode, 0)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:89:17
88	        def random_word():
89	            sz = random.randint(2, 10)
90	            return ''.join(random.choice(alphabet) for x in range(sz))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:90:27
89	            sz = random.randint(2, 10)
90	            return ''.join(random.choice(alphabet) for x in range(sz))
91	        words = [random_word() for i in range(400)]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:94:18
93	        def random_item():
94	            num = random.randint(2, 7)
95	            return '/'.join(random.choice(words) for w in range(num))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\choose.py:95:28
94	            num = random.randint(2, 7)
95	            return '/'.join(random.choice(words) for w in range(num))
96	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty_tests\datatypes.py:434:23
433	
434	        for prefix in ('/tmp', tempfile.gettempdir()):
435	            for path in ('a.png', 'x/b.jpg', 'y/../c.jpg'):

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty_tests\datatypes.py:437:39
436	                self.assertTrue(is_path_in_temp_dir(os.path.join(prefix, path)))
437	        for path in ('/home/xy/d.png', '/tmp/../home/x.jpg'):
438	            self.assertFalse(is_path_in_temp_dir(os.path.join(path)))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\kitty_tests\graphics.py:258:18
257	        while dc.total_size > before // 3:
258	            key = random.choice(tuple(data))
259	            self.assertTrue(remove(key))

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\kitty_tests\main.py:70:4
69	    py = shutil.which('python') or shutil.which('python3')
70	    os.execlp(py, py, '-m', 'mypy', '--pretty')
71	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\kitty_tests\open_actions.py:56:74
55	
56	        single('file://hostname/tmp/moo.txt#23', 'launch', *get_editor(), '/tmp/moo.txt', '23')
57	        single('some thing.txt', 'ignored')

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty_tests\prewarm.py:9:0
8	import signal
9	import subprocess
10	import tempfile

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty_tests\prewarm.py:114:19
113	        def run():
114	            return subprocess.Popen([kitty_exe(), '+runpy', 'import sys; sys.stdin.read()'], stderr=subprocess.DEVNULL, stdin=subprocess.PIPE)
115	        p = run()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty_tests\shell_integration.py:8:0
7	import shutil
8	import subprocess
9	import tempfile

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:28:8
27	        return False
28	    o = subprocess.check_output([v, '-c', 'echo "${BASH_VERSION}"']).decode('utf-8').strip()
29	    if not o or int(o[0]) < 5:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:85:14
84	        cmd = shlex.split(cmd.format(**locals()))
85	        env = (setup_env or safe_env_for_running_shell)(cmd, home_dir, rc=rc, shell=shell)
86	        try:

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:164:13
163	        with self.run_shell(
164	            shell='fish',
165	            rc=f'''
166	set -g fish_greeting
167	function fish_prompt; echo -n "{fish_prompt}"; end
168	function fish_right_prompt; echo -n "{right_prompt}"; end
169	function _test_comp_path; contains "{completions_dir}" $fish_complete_path; and echo ok; end
170	function _set_key; set -g fish_key_bindings fish_$argv[1]_key_bindings; end
171	function _set_status_prompt; function fish_prompt; echo -n "$pipestatus $status {fish_prompt}"; end; end
172	''') as pty:
173	            q = fish_prompt + ' ' * (pty.screen.columns - len(fish_prompt) - len(right_prompt)) + right_prompt
174	            pty.wait_till(lambda: pty.screen_contents().count(right_prompt) == 1)

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:247:13
246	        with self.run_shell(
247	            shell='bash', rc=f'''
248	PS1="{ps1}"
249	''') as pty:
250	            try:
251	                pty.wait_till(lambda: pty.screen.cursor.shape == CURSOR_BEAM)

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:289:13
288	            pty.wait_till(lambda: pty.callbacks.titlebuf)
289	        with self.run_shell(shell='bash', rc=f'''PS1="{ps1}"\ndeclare LOCAL_KSI_VAR=1''') as pty:
290	            pty.callbacks.clear()

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:293:13
292	            pty.wait_till(lambda: 'LOCAL_KSI_VAR' in pty.screen_contents())
293	        with self.run_shell(shell='bash', rc=f'''PS1="{ps1}"''') as pty:
294	            pty.callbacks.clear()

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:308:40
307	            with self.subTest(ps1=ps1), self.run_shell(
308	                shell='bash', rc=f'''
309	    PS1="{ps1}"
310	    ''') as pty:
311	                ps1 = ps1.replace('\\n', '\n')
312	                pty.wait_till(lambda: pty.screen_contents().count(ps1) == 1)

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:342:42
341	        def run_test(argv, *expected, excluded=(), rc='', wait_string='PROMPT $', assert_not_in=False):
342	            with self.subTest(argv=argv), self.run_shell(shell='bash', setup_env=partial(setup_env, set(excluded)), cmd=argv, rc=rc) as pty:
343	                pty.wait_till(lambda: wait_string in pty.screen_contents())

--------------------------------------------------
>> Issue: [B604:any_other_function_with_shell_equals_true] Function call with shell=True parameter identified, possible security issue.
   Severity: Medium   Confidence: Low
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b604_any_other_function_with_shell_equals_true.html
   Location: .\kitty_tests\shell_integration.py:366:13
365	
366	        with self.run_shell(shell='bash', setup_env=partial(setup_env, set()), cmd='bash', rc=f'''PS1="{ps1}"\nexport ES=$'a\n `b` c\n$d' ''') as pty:
367	            pty.callbacks.clear()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\kitty_tests\utmp.py:1:0
1	import subprocess
2	
3	from kitty.fast_data_types import num_users

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\kitty_tests\utmp.py:13:23
12	        try:
13	            expected = subprocess.check_output(['who']).decode('utf-8').count('\n')
14	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\kitty_tests\utmp.py:13:23
12	        try:
13	            expected = subprocess.check_output(['who']).decode('utf-8').count('\n')
14	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\logo\make.py:6:0
5	import os
6	import subprocess
7	import shutil

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\logo\make.py:20:8
19	    try:
20	        subprocess.check_call(args)
21	    except OSError:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\publish.py:14:0
13	import shutil
14	import subprocess
15	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:56:10
55	        echo_cmd(cmd)
56	    ret = subprocess.Popen(q, cwd=cwd).wait()
57	    if ret != 0:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:137:4
136	def run_docs(args: Any) -> None:
137	    subprocess.check_call(['make', 'docs'])
138	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:137:4
136	def run_docs(args: Any) -> None:
137	    subprocess.check_call(['make', 'docs'])
138	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:148:4
147	    os.chdir(os.path.dirname(publish_dir))
148	    subprocess.check_call(['git', 'add', 'kitty'])
149	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:148:4
147	    os.chdir(os.path.dirname(publish_dir))
148	    subprocess.check_call(['git', 'add', 'kitty'])
149	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:149:4
148	    subprocess.check_call(['git', 'add', 'kitty'])
149	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
150	    subprocess.check_call(['git', 'push'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:149:4
148	    subprocess.check_call(['git', 'add', 'kitty'])
149	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
150	    subprocess.check_call(['git', 'push'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:150:4
149	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
150	    subprocess.check_call(['git', 'push'])
151	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:150:4
149	    subprocess.check_call(['git', 'commit', '-m', 'kitty website updates'])
150	    subprocess.check_call(['git', 'push'])
151	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:157:4
156	        os.remove(dest)
157	    subprocess.check_call([
158	        os.environ['PENV'] + '/gpg-as-kovid', '--output', f'{path}.sig',
159	        '--detach-sig', path
160	    ])
161	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\publish.py:167:8
166	        os.mkdir(base)
167	        subprocess.check_call(f'git archive HEAD | tar -x -C {base}', shell=True)
168	        dest = os.path.join(base, 'docs', '_build')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:173:8
172	        dest = os.path.abspath(os.path.join('build', f'kitty-{version}.tar'))
173	        subprocess.check_call(['tar', '-cf', dest, os.path.basename(base)], cwd=tdir)
174	        with suppress(FileNotFoundError):

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:173:8
172	        dest = os.path.abspath(os.path.join('build', f'kitty-{version}.tar'))
173	        subprocess.check_call(['tar', '-cf', dest, os.path.basename(base)], cwd=tdir)
174	        with suppress(FileNotFoundError):

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:176:8
175	            os.remove(f'{dest}.xz')
176	        subprocess.check_call(['xz', '-9', dest])
177	        sign_file(f'{dest}.xz')

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:176:8
175	            os.remove(f'{dest}.xz')
176	        subprocess.check_call(['xz', '-9', dest])
177	        sign_file(f'{dest}.xz')

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:272:17
271	        now = str(datetime.datetime.utcnow()).split('.')[0] + ' UTC'
272	        commit = subprocess.check_output(['git', 'rev-parse', '--verify', '--end-of-options', 'master^{commit}']).decode('utf-8').strip()
273	        self.patch(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:272:17
271	        now = str(datetime.datetime.utcnow()).split('.')[0] + ' UTC'
272	        commit = subprocess.check_output(['git', 'rev-parse', '--verify', '--end-of-options', 'master^{commit}']).decode('utf-8').strip()
273	        self.patch(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\publish.py:290:33
289	                if r.status_code not in (204, 404):
290	                    self.fail(r, f'Failed to delete {fname} from GitHub')
291	            self.update_nightly_description(release['id'])

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\publish.py:301:33
300	                if r.status_code not in (204, 404):
301	                    self.fail(r, f'Failed to delete {fname} from GitHub')
302	            r = self.do_upload(upload_url, path, desc, fname)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:415:4
414	def run_upload_nightly(args: Any) -> None:
415	    subprocess.check_call(['git', 'tag', '-f', 'nightly'])
416	    subprocess.check_call(['git', 'push', 'origin', 'nightly', '-f'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:415:4
414	def run_upload_nightly(args: Any) -> None:
415	    subprocess.check_call(['git', 'tag', '-f', 'nightly'])
416	    subprocess.check_call(['git', 'push', 'origin', 'nightly', '-f'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:416:4
415	    subprocess.check_call(['git', 'tag', '-f', 'nightly'])
416	    subprocess.check_call(['git', 'push', 'origin', 'nightly', '-f'])
417	    gd = get_github_data()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:416:4
415	    subprocess.check_call(['git', 'tag', '-f', 'nightly'])
416	    subprocess.check_call(['git', 'push', 'origin', 'nightly', '-f'])
417	    gd = get_github_data()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:424:11
423	def current_branch() -> str:
424	    return subprocess.check_output(['git', 'symbolic-ref', '--short', 'HEAD']).decode('utf-8').strip()
425	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:424:11
423	def current_branch() -> str:
424	    return subprocess.check_output(['git', 'symbolic-ref', '--short', 'HEAD']).decode('utf-8').strip()
425	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:442:4
441	    stash_ref_before = safe_read('.git/refs/stash')
442	    subprocess.check_call(['git', 'stash'])
443	    try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:442:4
441	    stash_ref_before = safe_read('.git/refs/stash')
442	    subprocess.check_call(['git', 'stash'])
443	    try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:446:12
445	        if branch_before != 'master':
446	            subprocess.check_call(['git', 'switch', 'master'])
447	            subprocess.check_call(['make', 'debug'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:446:12
445	        if branch_before != 'master':
446	            subprocess.check_call(['git', 'switch', 'master'])
447	            subprocess.check_call(['make', 'debug'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:447:12
446	            subprocess.check_call(['git', 'switch', 'master'])
447	            subprocess.check_call(['make', 'debug'])
448	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:447:12
446	            subprocess.check_call(['git', 'switch', 'master'])
447	            subprocess.check_call(['make', 'debug'])
448	        try:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:452:16
451	            if branch_before != 'master':
452	                subprocess.check_call(['git', 'switch', branch_before])
453	                subprocess.check_call(['make', 'debug'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:452:16
451	            if branch_before != 'master':
452	                subprocess.check_call(['git', 'switch', branch_before])
453	                subprocess.check_call(['make', 'debug'])

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:453:16
452	                subprocess.check_call(['git', 'switch', branch_before])
453	                subprocess.check_call(['make', 'debug'])
454	    finally:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:453:16
452	                subprocess.check_call(['git', 'switch', branch_before])
453	                subprocess.check_call(['make', 'debug'])
454	    finally:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\publish.py:456:12
455	        if stash_ref_before != safe_read('.git/refs/stash'):
456	            subprocess.check_call(['git', 'stash', 'pop'])
457	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\publish.py:456:12
455	        if stash_ref_before != safe_read('.git/refs/stash'):
456	            subprocess.check_call(['git', 'stash', 'pop'])
457	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\setup.py:13:0
12	import shutil
13	import subprocess
14	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:109:20
108	                shlex.split(
109	                    subprocess.check_output(cmd, env=env, stderr=None if fatal else subprocess.DEVNULL).decode('utf-8')
110	                )

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:120:10
119	def pkg_version(package: str) -> Tuple[int, int]:
120	    ver = subprocess.check_output([
121	        PKGCONFIG, package, '--modversion']).decode('utf-8').strip()
122	    m = re.match(r'(\d+).(\d+)', ver)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:156:7
155	    q = f'{major}.{minor}'
156	    if subprocess.run([PKGCONFIG, package, f'--atleast-version={q}']
157	                      ).returncode != 0:
158	        qmajor = qminor = 0

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:160:18
159	        try:
160	            ver = subprocess.check_output([PKGCONFIG, package, '--modversion']
161	                                          ).decode('utf-8').strip()
162	            m = re.match(r'(\d+).(\d+)', ver)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:185:10
184	    cc = shlex.split(q)
185	    raw = subprocess.check_output(cc + ['-dumpversion']).decode('utf-8')
186	    ver_ = raw.strip().split('.')[:2]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:269:15
268	            print(src, file=srcf)
269	        return subprocess.Popen(
270	            cc + ['-Werror=implicit-function-declaration'] + list(cflags) + ([] if link_also else ['-c']) +
271	            ['-o', os.path.join(tdir, 'source.output'), srcf.name] +
272	            [f'-l{x}' for x in libraries] + list(ldflags),
273	            stdout=subprocess.DEVNULL, stdin=subprocess.DEVNULL,
274	            stderr=None if show_stderr else subprocess.DEVNULL
275	        ).wait() == 0
276	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:319:14
318	    def f(cc: Tuple[str]) -> bool:
319	        raw = subprocess.check_output(cc + ('--version',)).decode('utf-8').splitlines()[0]
320	        return '(GCC)' in raw.split()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:500:8
499	    print(desc or ' '.join(cmd))
500	    p = subprocess.Popen(cmd)
501	    ret = p.wait()

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup.py:512:18
511	        try:
512	            rev = subprocess.check_output(['git', 'rev-parse', 'HEAD']).decode('utf-8')
513	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:512:18
511	        try:
512	            rev = subprocess.check_output(['git', 'rev-parse', 'HEAD']).decode('utf-8')
513	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:611:16
610	            printed = True
611	            w = subprocess.Popen(compile_cmd.cmd, stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)
612	            workers[w.pid] = compile_cmd, w

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\setup.py:1246:8
1245	    try:
1246	        subprocess.check_call([
1247	            'iconutil', '-c', 'icns', iconset_dir, '-o', icns_dir
1248	        ])
1249	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1246:8
1245	    try:
1246	        subprocess.check_call([
1247	            'iconutil', '-c', 'icns', iconset_dir, '-o', icns_dir
1248	        ])
1249	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1251:8
1250	        print(f'{error("iconutil not found")}, using png2icns (without retina support) to convert the logo', file=sys.stderr)
1251	        subprocess.check_call([
1252	            'png2icns', icns_dir
1253	        ] + [os.path.join(iconset_dir, logo) for logo in [
1254	            # png2icns does not support retina icons, so only pass the non-retina icons
1255	            'icon_16x16.png',
1256	            'icon_32x32.png',
1257	            'icon_128x128.png',
1258	            'icon_256x256.png',
1259	            'icon_512x512.png',
1260	        ]])
1261	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\setup.py:1626:8
1625	        texe = os.path.abspath('kitty/launcher/kitty')
1626	        os.execl(texe, texe, '+launch', 'test.py')
1627	    if args.action == 'clean':

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1667:12
1666	            cmd = [sys.executable, '../bypy', 'export', 'download.calibre-ebook.com:/srv/download/ci/kitty']
1667	            subprocess.check_call(cmd + ['linux'])
1668	            subprocess.check_call(cmd + ['macos'])

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\setup.py:1668:12
1667	            subprocess.check_call(cmd + ['linux'])
1668	            subprocess.check_call(cmd + ['macos'])
1669	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\shell-integration\ssh\bootstrap.py:12:0
11	import shutil
12	import subprocess
13	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\shell-integration\ssh\bootstrap.py:152:8
151	    os.environ['TERMINFO'] = os.path.join(HOME, tname)
152	    p = subprocess.Popen(
153	        [tic, '-x', '-o', os.path.join(base, tname), os.path.join(base, '.terminfo', 'kitty.terminfo')],
154	        stdout=subprocess.PIPE, stderr=subprocess.STDOUT
155	    )
156	    rc = p.wait()

--------------------------------------------------
>> Issue: [B202:tarfile_unsafe_members] tarfile.extractall used without any validation. Please check and discard dangerous members.
   Severity: High   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b202_tarfile_unsafe_members.html
   Location: .\shell-integration\ssh\bootstrap.py:204:8
203	    with temporary_directory(dir=HOME, prefix='.kitty-ssh-kitten-untar-') as tdir, tarfile.open(fileobj=io.BytesIO(data)) as tf:
204	        tf.extractall(tdir)
205	        with open(tdir + '/data.sh') as f:

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\shell-integration\ssh\bootstrap.py:227:12
226	            os.environ['ZDOTDIR'] = shell_integration_dir + '/zsh'
227	            os.execlp(login_shell, os.path.basename(login_shell), '-l')
228	    os.environ.pop('KITTY_ORIG_ZDOTDIR', None)  # ensure this is not propagated

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\shell-integration\ssh\bootstrap.py:237:4
236	    os.environ['KITTY_FISH_XDG_DATA_DIR'] = shell_integration_dir
237	    os.execlp(login_shell, os.path.basename(login_shell), '-l')
238	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\shell-integration\ssh\bootstrap.py:246:4
245	        os.environ['KITTY_BASH_UNEXPORT_HISTFILE'] = '1'
246	    os.execlp(login_shell, os.path.basename('login_shell'), '--posix')
247	

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\shell-integration\ssh\bootstrap.py:293:8
292	        cmd = base64.standard_b64decode(exec_cmd).decode('utf-8')
293	        os.execlp(login_shell, os.path.basename(login_shell), '-c', cmd)
294	    TEST_SCRIPT  # noqa

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\shell-integration\ssh\bootstrap.py:298:4
297	    os.environ.pop('KITTY_SHELL_INTEGRATION', None)
298	    os.execlp(login_shell, '-' + os.path.basename(login_shell))
299	

--------------------------------------------------

Code scanned:
	Total lines of code: 52636
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 271
		Medium: 39
		High: 5
	Total issues (by confidence):
		Undefined: 0
		Low: 13
		Medium: 33
		High: 269
Files skipped (0):
