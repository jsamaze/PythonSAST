Working... ---------------------------------------- 100% 0:00:04
Run started:2024-02-10 23:05:58.855593

Test results:
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\api\v1\tests.py:303:13
302	
303	        data["password"] = "Toto1234"
304	        response = self.client.post(url, data, format="json")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\api\v1\tests.py:388:13
387	        data = copy.deepcopy(self.ACCOUNT_DATA)
388	        data["password"] = "toto"
389	        url = reverse("v1:account-list")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\api\v2\tests.py:221:13
220	
221	        data["password"] = "Toto"
222	        resp = self.client.post(url, data, format="json")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\api\v2\tests.py:341:12
340	        self.assertTrue(
341	            self.client.login(username="user1@test.com", password="toto")
342	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\factories.py:100:12
99	    dom = DomainFactory(name="test.com", quota=50)
100	    admin = UserFactory(
101	        username="admin@test.com", groups=("DomainAdmins", ),
102	        password="{PLAIN}toto"
103	    )
104	    MailboxFactory(address="admin", domain=dom, user=admin)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\factories.py:132:12
131	    dom2 = DomainFactory.create(name="test2.com", default_mailbox_quota=0)
132	    admin = UserFactory.create(
133	        username="admin@test2.com", groups=("DomainAdmins",),
134	        password="{PLAIN}toto"
135	    )
136	    MailboxFactory.create(address="admin", domain=dom2, user=admin)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa\admin\management\commands\handle_mailbox_operations.py:34:33
33	        parser.add_argument(
34	            "--pidfile", default="/tmp/handle_mailbox_operations.pid",
35	            help="Path to the file that will contain the PID of this process"

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\admin\models\alias.py:102:12
101	        """Generate a random address (local part)."""
102	        m = hashlib.md5()
103	        for x in random.sample(range(10000000), 60):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\admin\templatetags\admin_tags.py:247:11
246	        res += "%s<br/>" % alias.name
247	    return mark_safe(res)
248	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\admin\templatetags\admin_tags.py:247:11
246	        res += "%s<br/>" % alias.name
247	    return mark_safe(res)
248	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\admin\templatetags\admin_tags.py:301:11
300	    results = reduce(lambda a, b: a + b, [result[1] for result in results])
301	    return mark_safe("".join(results))

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\admin\templatetags\admin_tags.py:301:11
300	    results = reduce(lambda a, b: a + b, [result[1] for result in results])
301	    return mark_safe("".join(results))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Tété1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\tests\test_account.py:30:19
29	        self.client.logout()
30	        password = "Tété1234"
31	        self.mb.user.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:432:12
431	        self.assertTrue(
432	            self.client.login(username="admin@test.com", password="toto")
433	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:438:12
437	        self.assertTrue(
438	            self.client.login(username="admin@test2.com", password="toto")
439	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:637:12
636	        self.assertTrue(
637	            self.client.login(username="admin@test.com", password="toto")
638	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:663:8
662	        self.client.logout()
663	        self.client.login(username=self.reseller.username, password="toto")
664	        self.assertTrue(self.reseller.can_access(self.reseller))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:685:12
684	        self.assertEqual(
685	            self.client.login(username="admin@test.com", password="toto"),
686	            True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:714:8
713	        self.client.logout()
714	        self.client.login(username="admin@test.com", password="toto")
715	        self.ajax_post(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:749:13
748	        dom = models.Domain.objects.get(name="test.com")
749	        mb = factories.MailboxFactory(
750	            domain=dom, address="admin2",
751	            user__username="admin2@test.com", user__groups=("DomainAdmins", ),
752	            user__password="{PLAIN}toto")
753	        dom.add_admin(mb.user)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:756:12
755	        self.assertTrue(
756	            self.client.login(username="admin@test.com", password="toto"))
757	        values = {

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_domain.py:107:12
106	        self.assertFalse(
107	            self.client.login(username="admin@pouet.com", password="password"))
108	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Toto1000'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\tests\test_domain.py:149:19
148	        """Test creation of a domain with a template and custom password."""
149	        password = "Toto1000"
150	        self.set_global_parameter("default_password", password, app="core")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:156:12
155	        self.assertTrue(
156	            self.client.login(username="user1@test.com", password="toto")
157	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:224:8
223	        self.client.logout()
224	        self.client.login(username="admin@test.com", password="toto")
225	        f = ContentFile(b"""

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:248:8
247	        self.client.logout()
248	        self.client.login(username="admin@test.com", password="toto")
249	        f = ContentFile(b"""

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:293:12
292	        self.assertTrue(
293	            self.client.login(username="admin@test.com", password="toto")
294	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:28:8
27	        ret = management.call_command("modo", "repair", "--quiet")
28	        assert ret is None
29	        # assert it's fixed

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:41:8
40	        ret = management.call_command("modo", "repair", "--quiet", "--dry-run")
41	        assert ret is None
42	        # assert its not fixed

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:49:8
48	        ret = management.call_command("modo", "repair", "--quiet")
49	        assert ret is None
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:57:8
56	        ret = management.call_command("modo", "repair", "--quiet")
57	        assert ret is None
58	        self.assertTrue(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_user.py:20:8
19	        self.client.logout()
20	        self.client.login(username="user@test.com", password="toto")
21	        url = reverse("user_forward")

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\modoboa\admin\views\identity.py:83:21
82	        if sort_order == "quota_value__bytes":
83	            mboxes = mboxes.extra(
84	                select={"quota_value__bytes": "admin_quota.bytes"},
85	                where=["admin_quota.username=%s" % where],
86	                tables=["admin_quota", "admin_domain"],
87	                order_by=["%s%s" % (sort_dir, sort_order)]
88	            )
89	        else:

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\modoboa\admin\views\identity.py:100:21
99	                )
100	            mboxes = mboxes.extra(
101	                select={"quota_usage": select},
102	                where=["admin_quota.username=%s" % where],
103	                tables=["admin_quota", "admin_domain"],
104	                order_by=["%s%s" % (sort_dir, sort_order)]
105	            )
106	    else:

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\modoboa\core\api\v2\tests.py:127:4
126	
127	    def test_me_password(self, password_ko="Toto1234", password_ok="password"):
128	        url = reverse("v2:account-check-me-password")
129	        resp = self.client.post(url, {"password": password_ko}, format="json")
130	        self.assertEqual(resp.status_code, 400)
131	        resp = self.client.post(url, {"password": password_ok}, format="json")
132	        self.assertEqual(resp.status_code, 200)
133	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123456'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\api\v2\tests.py:380:19
379	        # Wrong Token
380	        token_ko = "123456"
381	        data = {"new_password1": "123456", "new_password2": "123456", "token": token_ko, "id": id_ok}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\api\v2\viewsets.py:86:24
85	            else:
86	                token = ""
87	        serializer = serializers.UserAPITokenSerializer({"token": str(token)})

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\modoboa\core\commands\deploy.py:7:0
6	import shutil
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa\core\commands\deploy.py:94:16
93	        if not self._verbose:
94	            p = subprocess.Popen(
95	                cmd, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, cwd=cwd
96	            )
97	            output = p.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa\core\commands\deploy.py:99:16
98	        else:
99	            p = subprocess.Popen(cmd, cwd=cwd)
100	            p.wait()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'otp_device_id'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\constants.py:114:23
113	
114	TFA_DEVICE_TOKEN_KEY = "otp_device_id"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\factories.py:43:15
42	    email = factory.LazyAttribute(lambda a: a.username)
43	    password = "{PLAIN}toto"
44	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\core\management\commands\generate_postfix_maps.py:71:23
70	        with open(path, mode="rb") as fp:
71	            checksum = hashlib.md5(fp.read()).hexdigest()
72	        return checksum == self.__checksums[fname]["checksum"]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\core\management\commands\generate_postfix_maps.py:149:15
148	            fp.write(content)
149	        return hashlib.md5(force_bytes(content)).hexdigest()
150	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\modoboa\core\password_hashers\base.py:128:16
127	            salt = "".join(
128	                Random().sample(
129	                    string.ascii_letters +

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\core\password_hashers\base.py:150:14
149	    def _encrypt(self, clearvalue, salt=None):
150	        obj = hashlib.md5(force_bytes(clearvalue))
151	        return obj.hexdigest()

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\core\templatetags\core_tags.py:173:11
172	    rule = field.form.visirules[field.html_name]
173	    return mark_safe(
174	        " data-visibility-field='{}' data-visibility-value='{}' "
175	        .format(rule["field"], rule["value"]))
176	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\core\templatetags\core_tags.py:173:11
172	    rule = field.form.visirules[field.html_name]
173	    return mark_safe(
174	        " data-visibility-field='{}' data-visibility-value='{}' "
175	        .format(rule["field"], rule["value"]))
176	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\core\templatetags\core_tags.py:252:11
251	
252	    return mark_safe("""
253	<script type="text/javascript">
254	    $(document).ready(function() {
255	        $('body').notify('%s', '%s', %s);
256	    });
257	</script>
258	""" % (level, text, timeout))
259	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\core\templatetags\core_tags.py:252:11
251	
252	    return mark_safe("""
253	<script type="text/javascript">
254	    $(document).ready(function() {
255	        $('body').notify('%s', '%s', %s);
256	    });
257	</script>
258	""" % (level, text, timeout))
259	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:96:19
95	        username = "user@test.com"
96	        password = "toto"
97	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:138:19
137	        username = "user@test.com"
138	        password = "toto"
139	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:348:19
347	        username = "user@unknown.test"
348	        password = "toto"
349	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:383:19
382	        username = "user@unknown.test"
383	        password = "toto"
384	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:55:12
54	        self.assertTrue(
55	            self.client.login(username="modoadmin", password="password"))
56	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345Toi'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:134:12
133	        self.assertEqual(
134	            self.client.login(username="admin", password="12345Toi"), True
135	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:137:12
136	        self.assertEqual(
137	            self.client.login(username="user@test.com", password="toto"), True
138	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:154:12
153	        self.assertTrue(
154	            self.client.login(username="user@test.com", password="Toto1234")
155	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:192:8
191	        self.client.logout()
192	        self.client.login(username="user@test.com", password="toto")
193	        response = self.client.get(url, HTTP_X_REQUESTED_WITH="XMLHttpRequest")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_ldap.py:112:8
111	        username = "testuser"
112	        self.client.login(username=username, password="test")
113	        self.check_created_user(username + "@example.com")

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa\core\tests\test_views.py:94:27
93	    "maillog-logfile": "/var/log/mail.log",
94	    "maillog-rrd_rootdir": "/tmp",
95	    "maillog-greylist": False,
96	}
97	
98	
99	def announcement(sender, location, **kwargs):
100	    """Simpler handler."""
101	    return "This is an annoucement!"
102	
103	
104	class LoginTestCase(ModoTestCase):
105	    """Login page test cases."""
106	
107	    def test_announcements(self):
108	        """Check if announcements are displayed."""
109	        signals.get_announcements.connect(announcement)
110	        response = self.client.get(reverse("core:login"))
111	        self.assertEqual(response.status_code, 200)
112	        self.assertIn("This is an annoucement!", str(response.content))
113	
114	
115	class DashboardTestCase(ModoTestCase):
116	    """Dashboard tests."""
117	
118	    @classmethod
119	    def setUpTestData(cls):  # NOQA:N802
120	        """Create some data."""
121	        super(DashboardTestCase, cls).setUpTestData()
122	        cls.dadmin = factories.UserFactory(
123	            username="admin@test.com", groups=("DomainAdmins",)
124	        )
125	        cls.user = factories.UserFactory(
126	            username="user@test.com", groups=("SimpleUsers",)
127	        )
128	
129	    def test_access(self):
130	        """Load dashboard."""
131	        url = reverse("core:dashboard")
132	        response = self.client.get(url)
133	        self.assertEqual(response.status_code, 200)
134	        self.assertIn("Latest news", response.content.decode("utf-8"))
135	        self.client.logout()
136	        self.client.login(username=self.dadmin.username, password="toto")
137	        response = self.client.get(url)
138	        self.assertEqual(response.status_code, 200)
139	        self.assertIn("Latest news", response.content.decode("utf-8"))
140	        self.client.logout()
141	        self.client.login(username=self.user.username, password="toto")
142	        response = self.client.get(url)
143	        self.assertEqual(response.status_code, 403)
144	
145	    def test_custom_news(self):
146	        """Check that custom news are displayed."""
147	        url = reverse("core:dashboard")
148	        response = self.client.get(url)
149	        self.assertContains(response, "https://modoboa.org")
150	
151	        self.set_global_parameter(
152	            "rss_feed_url", "https://www.djangoproject.com/rss/weblog/")
153	        self.client.force_login(self.dadmin)
154	        response = self.client.get(url)
155	        self.assertContains(response, "djangoproject")
156	
157	    def test_features_visibility(self):
158	        """Hide or not features widget."""
159	        url = reverse("core:dashboard")
160	        response = self.client.get(url)
161	        self.assertContains(response, "Features looking for sponsoring")
162	
163	        self.client.force_login(self.dadmin)
164	        response = self.client.get(url)
165	        self.assertContains(response, "Features looking for sponsoring")
166	
167	        self.set_global_parameter("hide_features_widget", True)
168	        response = self.client.get(url)
169	        self.assertNotContains(response, "Features looking for sponsoring")
170	
171	    @override_settings(DISABLE_DASHBOARD_EXTERNAL_QUERIES=False)
172	    def test_enable_dashboard_external_queries(self):
173	        """Load dashboard with DISABLE_DASHBOARD_EXTERNAL_QUERIES = False"""
174	        url = reverse("core:dashboard")
175	        response = self.client.get(url)
176	        self.assertContains(response, 'href="https://modoboa.org/en/weblog/')
177	
178	    @override_settings(DISABLE_DASHBOARD_EXTERNAL_QUERIES=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_views.py:136:8
135	        self.client.logout()
136	        self.client.login(username=self.dadmin.username, password="toto")
137	        response = self.client.get(url)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_views.py:141:8
140	        self.client.logout()
141	        self.client.login(username=self.user.username, password="toto")
142	        response = self.client.get(url)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\core\views\dashboard.py:65:31
64	                try:
65	                    response = requests.get(url)
66	                except RequestException:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\lib\api_client.py:33:19
32	        try:
33	            resp = requests.get(url, params=params)
34	        except RequestException as err:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\lib\api_client.py:69:27
68	            try:
69	                response = requests.post(url, data=data)
70	            except RequestException as err:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\lib\api_client.py:84:23
83	        try:
84	            response = requests.put(url, data=data)
85	        except RequestException as err:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\modoboa\lib\email_utils.py:10:0
9	import chardet
10	import lxml.html
11	from lxml.html import defs

--------------------------------------------------
>> Issue: [B410:blacklist] Using defs to parse untrusted XML data is known to be vulnerable to XML attacks. Replace defs with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\modoboa\lib\email_utils.py:11:0
10	import lxml.html
11	from lxml.html import defs
12	from lxml.html.clean import Cleaner

--------------------------------------------------
>> Issue: [B410:blacklist] Using Cleaner to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Cleaner with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\modoboa\lib\email_utils.py:12:0
11	from lxml.html import defs
12	from lxml.html.clean import Cleaner
13	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:291:4
290	    """Split an e-mail address into local part and domain."""
291	    assert isinstance(address, str),\
292	        "address should be of type str"
293	    if "@" not in address:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:303:4
302	    """Split a local part into local part and extension."""
303	    assert isinstance(local_part, str),\
304	        "local_part should be of type str"
305	    assert isinstance(delimiter, str) or delimiter is None,\

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:305:4
304	        "local_part should be of type str"
305	    assert isinstance(delimiter, str) or delimiter is None,\
306	        "delimiter should be of type str"
307	    extension = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:348:4
347	    """Try to decode the given string."""
348	    assert isinstance(value_bytes, bytes),\
349	        "value_bytes should be of type bytes"
350	    if len(value_bytes) == 0:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\modoboa\lib\sysutils.py:10:0
9	import re
10	import subprocess
11	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa\lib\sysutils.py:36:14
35	        kwargs.update(stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
36	    process = subprocess.Popen(cmd, **kwargs)
37	    if pinput or capture_output:

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\lib\templatetags\form_tags.py:24:11
23	        ret += "%s\n" % render_field(field)
24	    return mark_safe(ret)
25	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\lib\templatetags\form_tags.py:24:11
23	        ret += "%s\n" % render_field(field)
24	    return mark_safe(ret)
25	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\lib\templatetags\lib_tags.py:27:11
26	def tolist(values):
27	    return mark_safe("[%s]" % ",".join(['"%s"' % v for v in values]))
28	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\lib\templatetags\lib_tags.py:27:11
26	def tolist(values):
27	    return mark_safe("[%s]" % ",".join(['"%s"' % v for v in values]))
28	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\modoboa\lib\tests\__init__.py:64:4
63	
64	    def setUp(self, username="admin", password="password"):
65	        """Initiate test context."""
66	        self.assertEqual(
67	            self.client.login(username=username, password=password), True)
68	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp;t--u_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\lib\tests\test_cryptutils.py:9:1
8	
9	@override_settings(SECRET_KEY="!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp"
10	                              ";t--u_")
11	class CryptUtilsTest(SimpleTestCase):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\tests\test_email_utils.py:20:8
19	        message_path = os.path.join(SAMPLES_DIR, "%s-input.txt" % self.mailid)
20	        assert os.path.isfile(message_path), "%s does not exist." % message_path
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\tests\test_email_utils.py:43:8
42	                                    "%s-output-%s.txt" % (message_id, ext))
43	        assert os.path.isfile(message_path), "%s does not exist." % message_path
44	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\limits\tests\test_user_limits.py:368:8
367	        self.client.logout()
368	        self.client.login(username="admin", password="password")
369	        self.ajax_get(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\limits\tests\test_user_limits.py:426:8
425	        self.client.logout()
426	        self.client.login(username="admin1@domain.tld", password="Toto1234")
427	        self._create_account("user1@domain.tld")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\limits\tests\test_user_limits.py:431:8
430	        self.client.logout()
431	        self.client.login(username="reseller", password="toto")
432	        # Delete the admin -> resources should go back to the

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa\maillog\forms.py:31:16
30	        label=ugettext_lazy("Directory to store RRD files"),
31	        initial="/tmp/modoboa",
32	        help_text=ugettext_lazy(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp;t--u_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\test_project\test_project\settings.py:25:13
24	# SECURITY WARNING: keep the secret key used in production secret!
25	SECRET_KEY = '!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp;t--u_'
26	

--------------------------------------------------

Code scanned:
	Total lines of code: 28976
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 64
		Medium: 21
		High: 4
	Total issues (by confidence):
		Undefined: 0
		Low: 4
		Medium: 50
		High: 35
Files skipped (0):
