Run started:2024-02-10 23:07:22.245674

Test results:
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\modoboa_installer\database.py:94:16
93	        """Create a user."""
94	        query = "SELECT 1 FROM pg_roles WHERE rolname='{}'".format(name)
95	        code, output = utils.exec_cmd(

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\modoboa_installer\database.py:207:16
206	                "UPDATE user SET plugin='' WHERE user='root'",
207	                "UPDATE user SET password=PASSWORD('{}') WHERE USER='root'"
208	                .format(self.dbpassword),
209	                "flush privileges"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\modoboa_installer\scripts\modoboa.py:221:22
220	        extensions = extensions.split()
221	        random_hour = random.randint(0, 6)
222	        context.update({

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\modoboa_installer\scripts\modoboa.py:231:23
230	            "opendkim_user": self.config.get("opendkim", "user"),
231	            "minutes": random.randint(1, 59),
232	            "hours" : f"{random_hour},{random_hour+12}"

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\modoboa_installer\scripts\modoboa.py:274:12
273	        query = (
274	            "UPDATE core_localconfig SET _parameters='{}'"
275	            .format(settings)
276	        )

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa_installer\scripts\spamassassin.py:39:21
38	                "spamassassin_release_{}/sql/{}".format(version, fname))
39	            schema = "/tmp/{}".format(fname)
40	            utils.exec_cmd("wget {} -O {}".format(url, schema))

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\modoboa_installer\utils.py:13:0
12	import string
13	import subprocess
14	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa_installer\utils.py:70:14
69	    output = None
70	    process = subprocess.Popen(cmd, **kwargs)
71	    if pinput or capture_output:

--------------------------------------------------

Code scanned:
	Total lines of code: 3438
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 4
		Medium: 4
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 3
		Medium: 1
		High: 4
Files skipped (0):
