Working... ---------------------------------------- 100% 0:00:04
Run started:2024-02-10 23:10:21.397141

Test results:
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\cps\admin.py:1037:8
1036	            data["sort"] = data["fullpath"].lower()
1037	        except Exception:
1038	            continue
1039	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\admin.py:1568:23
1567	    content.name = username
1568	    content.password = ''  # dummy password which will be replaced by ldap one
1569	    content.email = useremail

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\db.py:1011:16
1010	                    old_session.close()
1011	                except Exception:
1012	                    pass
1013	                if old_session.bind:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\db.py:1016:20
1015	                        old_session.bind.dispose()
1016	                    except Exception:
1017	                        pass
1018	

--------------------------------------------------
>> Issue: [B410:blacklist] Using clean_html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace clean_html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\editbooks.py:32:4
31	try:
32	    from lxml.html.clean import clean_html
33	except ImportError:

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\epub.py:21:0
20	import zipfile
21	from lxml import etree
22	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:54:11
53	    txt = epubZip.read('META-INF/container.xml')
54	    tree = etree.fromstring(txt)
55	    cfname = tree.xpath('n:rootfiles/n:rootfile/@full-path', namespaces=ns)[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:57:11
56	    cf = epubZip.read(cfname)
57	    tree = etree.fromstring(cf)
58	    p = tree.xpath('/pkg:package/pkg:metadata', namespaces=ns)[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:78:11
77	    txt = epub_zip.read('META-INF/container.xml')
78	    tree = etree.fromstring(txt)
79	    cf_name = tree.xpath('n:rootfiles/n:rootfile/@full-path', namespaces=ns)[0]

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:81:11
80	    cf = epub_zip.read(cf_name)
81	    tree = etree.fromstring(cf)
82	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\epub.py:179:26
178	            markup = epub_zip.read(os.path.join(cover_path, cs))
179	            markup_tree = etree.fromstring(markup)
180	            # no matter xhtml or html with no namespace

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\fb2.py:19:0
18	
19	from lxml import etree
20	

--------------------------------------------------
>> Issue: [B320:blacklist] Using lxml.etree.fromstring to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.fromstring with its defusedxml equivalent function.
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree
   Location: .\cps\fb2.py:32:11
31	    fb2_file = open(tmp_file_path, encoding="utf-8")
32	    tree = etree.fromstring(fb2_file.read().encode())
33	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\comicvine.py:53:25
52	            try:
53	                result = requests.get(
54	                    f"{ComicVine.BASE_URL}{query}{ComicVine.QUERY_PARAMS}",
55	                    headers=ComicVine.HEADERS,
56	                )
57	                result.raise_for_status()

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\metadata_provider\douban.py:24:0
23	from html2text import HTML2Text
24	from lxml import etree
25	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\google.py:53:26
52	            try:
53	                results = requests.get(Google.SEARCH_URL + query)
54	                results.raise_for_status()

--------------------------------------------------
>> Issue: [B410:blacklist] Using HtmlElement to parse untrusted XML data is known to be vulnerable to XML attacks. Replace HtmlElement with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\metadata_provider\lubimyczytac.py:27:0
26	from html2text import HTML2Text
27	from lxml.html import HtmlElement, fromstring, tostring
28	from markdown2 import Markdown

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\lubimyczytac.py:119:25
118	            try:
119	                result = requests.get(self._prepare_query(title=query))
120	                result.raise_for_status()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\cps\metadata_provider\lubimyczytac.py:212:23
211	        try:
212	            response = requests.get(match.url)
213	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o660 on file (socket_file).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b103_set_bad_file_permissions.html
   Location: .\cps\server.py:112:8
111	        # between the user running calibre-web and the user running the fronting webserver
112	        os.chmod(socket_file, 0o660)
113	

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\cps\server.py:126:34
125	        if os.name == 'nt':
126	            self.listen_address = '0.0.0.0'
127	            return (self.listen_address, self.listen_port), None

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\cps\server.py:267:8
266	        args = self._get_args_for_reloading()
267	        os.execv(args[0].lstrip('"').rstrip('"'), args)
268	        return True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\services\simpleldap.py:48:53
47	            if config.config_ldap_serv_password_e is None:
48	                config.config_ldap_serv_password_e = ''
49	            app.config['LDAP_PASSWORD'] = config.config_ldap_serv_password_e

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\services\simpleldap.py:51:23
50	        else:
51	            app.config['LDAP_PASSWORD'] = ""
52	        app.config['LDAP_USERNAME'] = config.config_ldap_serv_username

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\services\simpleldap.py:55:19
54	        app.config['LDAP_USERNAME'] = ""
55	        app.config['LDAP_PASSWORD'] = ""
56	    if bool(config.config_ldap_cert_path):

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\cps\subproc_wrapper.py:21:0
20	import os
21	import subprocess
22	import re

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\cps\tasks\database.py:40:12
39	        try:
40	            urlopen('http://' + address + ':' + str(port) + '/reconnect')
41	            self._handleSuccess()

--------------------------------------------------
>> Issue: [B410:blacklist] Using objectify to parse untrusted XML data is known to be vulnerable to XML attacks. Replace objectify with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\tasks\metadata_backup.py:20:0
19	import os
20	from lxml import objectify
21	from urllib.request import urlopen

--------------------------------------------------
>> Issue: [B410:blacklist] Using etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\cps\tasks\metadata_backup.py:22:0
21	from urllib.request import urlopen
22	from lxml import etree
23	from html import escape

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\cps\tasks\metadata_backup.py:115:25
114	            try:
115	                stream = urlopen(web_content_link)
116	            except Exception as ex:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\cps\tasks\thumbnail.py:189:29
188	                try:
189	                    stream = urlopen(web_content_link)
190	                    with Image(file=stream) as img:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\cps\tasks\thumbnail.py:373:33
372	                    try:
373	                        stream = urlopen(web_content_link)
374	                        with Image(file=stream) as img:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\cps\tornado_wsgi.py:84:8
83	            header_obj.add(key, value)
84	        assert request.connection is not None
85	        request.connection.write_headers(start_line, header_obj, chunk=body)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\cps\ub.py:787:20
786	    user.role = constants.ROLE_ANONYMOUS
787	    user.password = ''
788	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\ub.py:885:8
884	            old_session.close()
885	        except Exception:
886	            pass
887	        if old_session.bind:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\cps\ub.py:890:12
889	                old_session.bind.dispose()
890	            except Exception:
891	                pass
892	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\cps\web.py:1314:0
1313	
1314	def render_login(username="", password=""):
1315	    next_url = request.args.get('next', default=url_for("web.index"), type=str)
1316	    if url_for("web.logout") == next_url:
1317	        next_url = url_for("web.index")
1318	    return render_title_template('login.html',
1319	                                 title=_("Login"),
1320	                                 next_url=next_url,
1321	                                 config=config,
1322	                                 username=username,
1323	                                 password=password,
1324	                                 oauth_check=oauth_check,
1325	                                 mail=config.get_mail_server_configured(), page="login")
1326	

--------------------------------------------------

Code scanned:
	Total lines of code: 26407
	Total lines skipped (#nosec): 10
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 21
		Medium: 16
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 4
		Medium: 8
		High: 25
Files skipped (0):
