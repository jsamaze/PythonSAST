Working... ---------------------------------------- 100% 0:00:04
Run started:2024-02-10 23:10:43.458005

Test results:
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\api\v1\tests.py:303:13
302	
303	        data["password"] = "Toto1234"
304	        response = self.client.post(url, data, format="json")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\api\v1\tests.py:388:13
387	        data = copy.deepcopy(self.ACCOUNT_DATA)
388	        data["password"] = "toto"
389	        url = reverse("v1:account-list")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\api\v2\tests.py:221:13
220	
221	        data["password"] = "Toto"
222	        resp = self.client.post(url, data, format="json")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\api\v2\tests.py:342:12
341	        self.assertTrue(
342	            self.client.login(username="user1@test.com", password="toto")
343	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\factories.py:100:12
99	    dom = DomainFactory(name="test.com", quota=50)
100	    admin = UserFactory(
101	        username="admin@test.com", groups=("DomainAdmins", ),
102	        password="{PLAIN}toto"
103	    )
104	    MailboxFactory(address="admin", domain=dom, user=admin)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\factories.py:132:12
131	    dom2 = DomainFactory.create(name="test2.com", default_mailbox_quota=0)
132	    admin = UserFactory.create(
133	        username="admin@test2.com", groups=("DomainAdmins",),
134	        password="{PLAIN}toto"
135	    )
136	    MailboxFactory.create(address="admin", domain=dom2, user=admin)

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa\admin\management\commands\handle_mailbox_operations.py:34:33
33	        parser.add_argument(
34	            "--pidfile", default="/tmp/handle_mailbox_operations.pid",
35	            help="Path to the file that will contain the PID of this process"

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\admin\models\alias.py:102:12
101	        """Generate a random address (local part)."""
102	        m = hashlib.md5()
103	        for x in random.sample(range(10000000), 60):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\admin\templatetags\admin_tags.py:247:11
246	        res += "%s<br/>" % alias.name
247	    return mark_safe(res)
248	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\admin\templatetags\admin_tags.py:247:11
246	        res += "%s<br/>" % alias.name
247	    return mark_safe(res)
248	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\admin\templatetags\admin_tags.py:301:11
300	    results = reduce(lambda a, b: a + b, [result[1] for result in results])
301	    return mark_safe("".join(results))

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\admin\templatetags\admin_tags.py:301:11
300	    results = reduce(lambda a, b: a + b, [result[1] for result in results])
301	    return mark_safe("".join(results))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Tété1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\tests\test_account.py:30:19
29	        self.client.logout()
30	        password = "Tété1234"
31	        self.mb.user.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:432:12
431	        self.assertTrue(
432	            self.client.login(username="admin@test.com", password="toto")
433	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:438:12
437	        self.assertTrue(
438	            self.client.login(username="admin@test2.com", password="toto")
439	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:637:12
636	        self.assertTrue(
637	            self.client.login(username="admin@test.com", password="toto")
638	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:663:8
662	        self.client.logout()
663	        self.client.login(username=self.reseller.username, password="toto")
664	        self.assertTrue(self.reseller.can_access(self.reseller))

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:685:12
684	        self.assertEqual(
685	            self.client.login(username="admin@test.com", password="toto"),
686	            True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:714:8
713	        self.client.logout()
714	        self.client.login(username="admin@test.com", password="toto")
715	        self.ajax_post(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:749:13
748	        dom = models.Domain.objects.get(name="test.com")
749	        mb = factories.MailboxFactory(
750	            domain=dom, address="admin2",
751	            user__username="admin2@test.com", user__groups=("DomainAdmins", ),
752	            user__password="{PLAIN}toto")
753	        dom.add_admin(mb.user)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_account.py:756:12
755	        self.assertTrue(
756	            self.client.login(username="admin@test.com", password="toto"))
757	        values = {

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_domain.py:107:12
106	        self.assertFalse(
107	            self.client.login(username="admin@pouet.com", password="password"))
108	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'Toto1000'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\admin\tests\test_domain.py:149:19
148	        """Test creation of a domain with a template and custom password."""
149	        password = "Toto1000"
150	        self.set_global_parameter("default_password", password, app="core")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:158:12
157	        self.assertTrue(
158	            self.client.login(username="user1@test.com", password="toto")
159	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:226:8
225	        self.client.logout()
226	        self.client.login(username="admin@test.com", password="toto")
227	        f = ContentFile(b"""

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:250:8
249	        self.client.logout()
250	        self.client.login(username="admin@test.com", password="toto")
251	        f = ContentFile(b"""

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_import_.py:295:12
294	        self.assertTrue(
295	            self.client.login(username="admin@test.com", password="toto")
296	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:28:8
27	        ret = management.call_command("modo", "repair", "--quiet")
28	        assert ret is None
29	        # assert it's fixed

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:41:8
40	        ret = management.call_command("modo", "repair", "--quiet", "--dry-run")
41	        assert ret is None
42	        # assert its not fixed

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:49:8
48	        ret = management.call_command("modo", "repair", "--quiet")
49	        assert ret is None
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\admin\tests\test_repair.py:57:8
56	        ret = management.call_command("modo", "repair", "--quiet")
57	        assert ret is None
58	        self.assertTrue(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\admin\tests\test_user.py:20:8
19	        self.client.logout()
20	        self.client.login(username="user@test.com", password="toto")
21	        url = reverse("user_forward")

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\modoboa\admin\views\identity.py:84:21
83	        if sort_order == "quota_value__bytes":
84	            mboxes = mboxes.extra(
85	                select={"quota_value__bytes": "admin_quota.bytes"},
86	                where=["admin_quota.username=%s" % where],
87	                tables=["admin_quota", "admin_domain"],
88	                order_by=["%s%s" % (sort_dir, sort_order)]
89	            )
90	        else:

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\modoboa\admin\views\identity.py:101:21
100	                )
101	            mboxes = mboxes.extra(
102	                select={"quota_usage": select},
103	                where=["admin_quota.username=%s" % where],
104	                tables=["admin_quota", "admin_domain"],
105	                order_by=["%s%s" % (sort_dir, sort_order)]
106	            )
107	    else:

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\modoboa\core\api\v2\tests.py:127:4
126	
127	    def test_me_password(self, password_ko="Toto1234", password_ok="password"):
128	        url = reverse("v2:account-check-me-password")
129	        resp = self.client.post(url, {"password": password_ko}, format="json")
130	        self.assertEqual(resp.status_code, 400)
131	        resp = self.client.post(url, {"password": password_ok}, format="json")
132	        self.assertEqual(resp.status_code, 200)
133	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123456'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\api\v2\tests.py:399:19
398	        # Wrong Token
399	        token_ko = "123456"
400	        data = {"new_password1": "123456", "new_password2": "123456", "token": token_ko, "id": id_ok}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\api\v2\viewsets.py:87:24
86	            else:
87	                token = ""
88	        serializer = serializers.UserAPITokenSerializer({"token": str(token)})

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\modoboa\core\commands\deploy.py:7:0
6	import shutil
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa\core\commands\deploy.py:94:16
93	        if not self._verbose:
94	            p = subprocess.Popen(
95	                cmd, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, cwd=cwd
96	            )
97	            output = p.communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa\core\commands\deploy.py:99:16
98	        else:
99	            p = subprocess.Popen(cmd, cwd=cwd)
100	            p.wait()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'otp_device_id'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\constants.py:115:23
114	
115	TFA_DEVICE_TOKEN_KEY = "otp_device_id"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '{PLAIN}toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\factories.py:43:15
42	    email = factory.LazyAttribute(lambda a: a.username)
43	    password = "{PLAIN}toto"
44	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\core\management\commands\generate_postfix_maps.py:71:23
70	        with open(path, mode="rb") as fp:
71	            checksum = hashlib.md5(fp.read()).hexdigest()
72	        return checksum == self.__checksums[fname]["checksum"]

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\core\management\commands\generate_postfix_maps.py:149:15
148	            fp.write(content)
149	        return hashlib.md5(force_bytes(content)).hexdigest()
150	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\modoboa\core\password_hashers\base.py:128:16
127	            salt = "".join(
128	                Random().sample(
129	                    string.ascii_letters +

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\modoboa\core\password_hashers\base.py:150:14
149	    def _encrypt(self, clearvalue, salt=None):
150	        obj = hashlib.md5(force_bytes(clearvalue))
151	        return obj.hexdigest()

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\core\templatetags\core_tags.py:173:11
172	    rule = field.form.visirules[field.html_name]
173	    return mark_safe(
174	        " data-visibility-field='{}' data-visibility-value='{}' "
175	        .format(rule["field"], rule["value"]))
176	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\core\templatetags\core_tags.py:173:11
172	    rule = field.form.visirules[field.html_name]
173	    return mark_safe(
174	        " data-visibility-field='{}' data-visibility-value='{}' "
175	        .format(rule["field"], rule["value"]))
176	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\core\templatetags\core_tags.py:252:11
251	
252	    return mark_safe("""
253	<script type="text/javascript">
254	    $(document).ready(function() {
255	        $('body').notify('%s', '%s', %s);
256	    });
257	</script>
258	""" % (level, text, timeout))
259	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\core\templatetags\core_tags.py:252:11
251	
252	    return mark_safe("""
253	<script type="text/javascript">
254	    $(document).ready(function() {
255	        $('body').notify('%s', '%s', %s);
256	    });
257	</script>
258	""" % (level, text, timeout))
259	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:96:19
95	        username = "user@test.com"
96	        password = "toto"
97	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:144:19
143	        username = "user@test.com"
144	        password = "toto"
145	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:355:19
354	        username = "user@unknown.test"
355	        password = "toto"
356	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\modoboa\core\tests\test_authentication.py:390:19
389	        username = "user@unknown.test"
390	        password = "toto"
391	        data = {"username": username, "password": password}

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:55:12
54	        self.assertTrue(
55	            self.client.login(username="modoadmin", password="password"))
56	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345Toi'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:134:12
133	        self.assertEqual(
134	            self.client.login(username="admin", password="12345Toi"), True
135	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:137:12
136	        self.assertEqual(
137	            self.client.login(username="user@test.com", password="toto"), True
138	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:154:12
153	        self.assertTrue(
154	            self.client.login(username="user@test.com", password="Toto1234")
155	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '12345Toi'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:167:12
166	        self.assertEqual(
167	            self.client.login(username="admin", password="12345Toi"), False
168	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_core.py:205:8
204	        self.client.logout()
205	        self.client.login(username="user@test.com", password="toto")
206	        response = self.client.get(url, HTTP_X_REQUESTED_WITH="XMLHttpRequest")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_ldap.py:112:8
111	        username = "testuser"
112	        self.client.login(username=username, password="test")
113	        self.check_created_user(username + "@example.com")

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa\core\tests\test_views.py:94:27
93	    "maillog-logfile": "/var/log/mail.log",
94	    "maillog-rrd_rootdir": "/tmp",
95	    "maillog-greylist": False,
96	    "pdfcredentials-enabled_pdfcredentials": True,
97	    "pdfcredentials-storage_dir": "./",
98	    "pdfcredentials-delete_first_dl": True,
99	    "pdfcredentials-generate_at_creation": True,
100	    "pdfcredentials-title": "Modoboa",
101	    "pdfcredentials-webpanel_url": "local.host/",
102	    "pdfcredentials-custom_message": "test",
103	    "pdfcredentials-include_connection_settings": False,
104	    "pdfcredentials-smtp_server_address": "127.0.0.1",
105	    "pdfcredentials-smtp_server_port": 666,
106	    "pdfcredentials-smtp_connection_security": "starttls",
107	    "pdfcredentials-imap_server_address": "127.0.0.1",
108	    "pdfcredentials-imap_server_port": 667,
109	    "pdfcredentials-imap_connection_security": "starttls",
110	    "dmarc-enable_rlookups": False,
111	}
112	
113	
114	def announcement(sender, location, **kwargs):
115	    """Simpler handler."""
116	    return "This is an annoucement!"
117	
118	
119	class LoginTestCase(ModoTestCase):
120	    """Login page test cases."""
121	
122	    def test_announcements(self):
123	        """Check if announcements are displayed."""
124	        signals.get_announcements.connect(announcement)
125	        response = self.client.get(reverse("core:login"))
126	        self.assertEqual(response.status_code, 200)
127	        self.assertIn("This is an annoucement!", str(response.content))
128	
129	
130	class DashboardTestCase(ModoTestCase):
131	    """Dashboard tests."""
132	
133	    @classmethod
134	    def setUpTestData(cls):  # NOQA:N802
135	        """Create some data."""
136	        super(DashboardTestCase, cls).setUpTestData()
137	        cls.dadmin = factories.UserFactory(
138	            username="admin@test.com", groups=("DomainAdmins",)
139	        )
140	        cls.user = factories.UserFactory(
141	            username="user@test.com", groups=("SimpleUsers",)
142	        )
143	
144	    def test_access(self):
145	        """Load dashboard."""
146	        url = reverse("core:dashboard")
147	        response = self.client.get(url)
148	        self.assertEqual(response.status_code, 200)
149	        self.assertIn("Latest news", response.content.decode("utf-8"))
150	        self.client.logout()
151	        self.client.login(username=self.dadmin.username, password="toto")
152	        response = self.client.get(url)
153	        self.assertEqual(response.status_code, 200)
154	        self.assertIn("Latest news", response.content.decode("utf-8"))
155	        self.client.logout()
156	        self.client.login(username=self.user.username, password="toto")
157	        response = self.client.get(url)
158	        self.assertEqual(response.status_code, 403)
159	
160	    def test_custom_news(self):
161	        """Check that custom news are displayed."""
162	        url = reverse("core:dashboard")
163	        response = self.client.get(url)
164	        self.assertContains(response, "https://modoboa.org")
165	
166	        self.set_global_parameter(
167	            "rss_feed_url", "https://www.djangoproject.com/rss/weblog/")
168	        self.client.force_login(self.dadmin)
169	        response = self.client.get(url)
170	        self.assertContains(response, "djangoproject")
171	
172	    def test_features_visibility(self):
173	        """Hide or not features widget."""
174	        url = reverse("core:dashboard")
175	        response = self.client.get(url)
176	        self.assertContains(response, "Features looking for sponsoring")
177	
178	        self.client.force_login(self.dadmin)
179	        response = self.client.get(url)
180	        self.assertContains(response, "Features looking for sponsoring")
181	
182	        self.set_global_parameter("hide_features_widget", True)
183	        response = self.client.get(url)
184	        self.assertNotContains(response, "Features looking for sponsoring")
185	
186	    @override_settings(DISABLE_DASHBOARD_EXTERNAL_QUERIES=False)
187	    def test_enable_dashboard_external_queries(self):
188	        """Load dashboard with DISABLE_DASHBOARD_EXTERNAL_QUERIES = False"""
189	        url = reverse("core:dashboard")
190	        response = self.client.get(url)
191	        self.assertContains(response, 'href="https://modoboa.org/en/weblog/')
192	
193	    @override_settings(DISABLE_DASHBOARD_EXTERNAL_QUERIES=True)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_views.py:151:8
150	        self.client.logout()
151	        self.client.login(username=self.dadmin.username, password="toto")
152	        response = self.client.get(url)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\core\tests\test_views.py:156:8
155	        self.client.logout()
156	        self.client.login(username=self.user.username, password="toto")
157	        response = self.client.get(url)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\core\views\dashboard.py:65:31
64	                try:
65	                    response = requests.get(url)
66	                except RequestException:

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\dmarc\templatetags\dmarc_tags.py:28:11
27	        parts = (current[0], int(current[1]) + 1 )
28	    return mark_safe("{}-{}".format(parts[0], parts[1]))
29	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\dmarc\templatetags\dmarc_tags.py:28:11
27	        parts = (current[0], int(current[1]) + 1 )
28	    return mark_safe("{}-{}".format(parts[0], parts[1]))
29	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\dmarc\templatetags\dmarc_tags.py:50:11
49	        parts = (current[0], int(current[1]) - 1 )
50	    return mark_safe("{}-{}".format(parts[0], parts[1]))
51	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\dmarc\templatetags\dmarc_tags.py:50:11
49	        parts = (current[0], int(current[1]) - 1 )
50	    return mark_safe("{}-{}".format(parts[0], parts[1]))
51	

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\lib\api_client.py:33:19
32	        try:
33	            resp = requests.get(url, params=params)
34	        except RequestException as err:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\lib\api_client.py:69:27
68	            try:
69	                response = requests.post(url, data=data)
70	            except RequestException as err:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\modoboa\lib\api_client.py:84:23
83	        try:
84	            response = requests.put(url, data=data)
85	        except RequestException as err:

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\modoboa\lib\email_utils.py:10:0
9	import chardet
10	import lxml.html
11	from lxml.html import defs

--------------------------------------------------
>> Issue: [B410:blacklist] Using defs to parse untrusted XML data is known to be vulnerable to XML attacks. Replace defs with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\modoboa\lib\email_utils.py:11:0
10	import lxml.html
11	from lxml.html import defs
12	from lxml.html.clean import Cleaner

--------------------------------------------------
>> Issue: [B410:blacklist] Using Cleaner to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Cleaner with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\modoboa\lib\email_utils.py:12:0
11	from lxml.html import defs
12	from lxml.html.clean import Cleaner
13	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:291:4
290	    """Split an e-mail address into local part and domain."""
291	    assert isinstance(address, str),\
292	        "address should be of type str"
293	    if "@" not in address:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:303:4
302	    """Split a local part into local part and extension."""
303	    assert isinstance(local_part, str),\
304	        "local_part should be of type str"
305	    assert isinstance(delimiter, str) or delimiter is None,\

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:305:4
304	        "local_part should be of type str"
305	    assert isinstance(delimiter, str) or delimiter is None,\
306	        "delimiter should be of type str"
307	    extension = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\email_utils.py:348:4
347	    """Try to decode the given string."""
348	    assert isinstance(value_bytes, bytes),\
349	        "value_bytes should be of type bytes"
350	    if len(value_bytes) == 0:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\modoboa\lib\sysutils.py:10:0
9	import re
10	import subprocess
11	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\modoboa\lib\sysutils.py:36:14
35	        kwargs.update(stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
36	    process = subprocess.Popen(cmd, **kwargs)
37	    if pinput or capture_output:

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\lib\templatetags\form_tags.py:24:11
23	        ret += "%s\n" % render_field(field)
24	    return mark_safe(ret)
25	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\lib\templatetags\form_tags.py:24:11
23	        ret += "%s\n" % render_field(field)
24	    return mark_safe(ret)
25	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\modoboa\lib\templatetags\lib_tags.py:27:11
26	def tolist(values):
27	    return mark_safe("[%s]" % ",".join(['"%s"' % v for v in values]))
28	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\modoboa\lib\templatetags\lib_tags.py:27:11
26	def tolist(values):
27	    return mark_safe("[%s]" % ",".join(['"%s"' % v for v in values]))
28	

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\modoboa\lib\tests\__init__.py:65:4
64	
65	    def setUp(self, username="admin", password="password"):
66	        """Initiate test context."""
67	        self.assertEqual(
68	            self.client.login(username=username, password=password), True)
69	        self.workdir = tempfile.mkdtemp()
70	        self.set_global_parameter("storage_dir", self.workdir, app="pdfcredentials")
71	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp;t--u_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\lib\tests\test_cryptutils.py:9:1
8	
9	@override_settings(SECRET_KEY="!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp"
10	                              ";t--u_")
11	class CryptUtilsTest(SimpleTestCase):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\tests\test_email_utils.py:20:8
19	        message_path = os.path.join(SAMPLES_DIR, "%s-input.txt" % self.mailid)
20	        assert os.path.isfile(message_path), "%s does not exist." % message_path
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\modoboa\lib\tests\test_email_utils.py:43:8
42	                                    "%s-output-%s.txt" % (message_id, ext))
43	        assert os.path.isfile(message_path), "%s does not exist." % message_path
44	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\limits\tests\test_user_limits.py:367:8
366	        self.client.logout()
367	        self.client.login(username="admin", password="password")
368	        self.ajax_delete(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'Toto1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\limits\tests\test_user_limits.py:425:8
424	        self.client.logout()
425	        self.client.login(username="admin1@domain.tld", password="Toto1234")
426	        self._create_account("user1@domain.tld")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'toto'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\modoboa\limits\tests\test_user_limits.py:430:8
429	        self.client.logout()
430	        self.client.login(username="reseller", password="toto")
431	        # Delete the admin -> resources should go back to the

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\modoboa\maillog\forms.py:31:16
30	        label=ugettext_lazy("Directory to store RRD files"),
31	        initial="/tmp/modoboa",
32	        help_text=ugettext_lazy(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\modoboa\pdfcredentials\tests\test_lib.py:17:0
16	import modoboa.pdfcredentials.lib as lib
17	from subprocess import Popen, PIPE
18	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\modoboa\pdfcredentials\tests\test_lib.py:67:22
66	                      Popen("/usr/bin/file -b --mime -",
67	                            shell=True,
68	                            stdout=PIPE,
69	                            stdin=PIPE)
70	                      .communicate(filebuff)[0].strip().decode()
71	                      )

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: .\modoboa\pdfcredentials\tests\test_lib.py:75:16
74	                Popen("/usr/bin/file -b --mime -",
75	                      shell=True,
76	                      stdout=PIPE,
77	                      stdin=PIPE).communicate(file.read(1024))[0].strip()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp;t--u_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\test_project\test_project\settings.py:25:13
24	# SECURITY WARNING: keep the secret key used in production secret!
25	SECRET_KEY = '!8o(-dbbl3e+*bh7nx-^xysdt)1gso*%@4ze4-9_9o+i&amp;t--u_'
26	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test_project\test_project\settings.py:227:24
226	
227	PID_FILE_STORAGE_PATH = '/tmp'
228	

--------------------------------------------------

Code scanned:
	Total lines of code: 31303
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 68
		Medium: 26
		High: 4
	Total issues (by confidence):
		Undefined: 0
		Low: 4
		Medium: 52
		High: 42
Files skipped (0):
