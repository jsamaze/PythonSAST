Working... ---------------------------------------- 100% 0:00:31
Run started:2024-02-10 23:29:31.835280

Test results:
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:178:8
177	        timer = time.time()
178	        assert stat.data_collector.pull_function is not None
179	        rows_added = stat.data_collector.pull_function(stat.property, start_time, end_time, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:305:8
304	    if table == RealmCount:
305	        assert isinstance(zerver_object, Realm)
306	        id_args: Dict[str, Union[Realm, UserProfile, Stream]] = {"realm": zerver_object}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:308:8
307	    elif table == UserCount:
308	        assert isinstance(zerver_object, UserProfile)
309	        id_args = {"realm": zerver_object.realm, "user": zerver_object}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\lib\counts.py:311:8
310	    else:  # StreamCount
311	        assert isinstance(zerver_object, Stream)
312	        id_args = {"realm": zerver_object.realm, "stream": zerver_object}

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:47:29
46	        for i in range(days):
47	            holidays.extend([random() < holiday_rate] * 24)
48	    elif frequency == CountStat.DAY:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\analytics\lib\fixtures.py:53:20
52	        ] * 2
53	        holidays = [random() < holiday_rate for i in range(days)]
54	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\management\commands\update_analytics_counts.py:63:8
62	        fill_to_time = parse_datetime(options["time"])
63	        assert fill_to_time is not None
64	        if options["utc"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_counts.py:166:8
165	        # since it'd require adding an additional realm argument.
166	        assert not is_cross_realm_bot_email(sender.delivery_email)
167	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_counts.py:258:8
257	        fill_state = FillState.objects.filter(property=stat.property).first()
258	        assert fill_state is not None
259	        self.assertEqual(fill_state.end_time, end_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:100:12
99	            first_human_user = zulip_realm.get_first_human_user()
100	            assert first_human_user is not None
101	            self.assert_in_success_response(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:493:8
492	        customer = get_customer_by_realm(lear_realm)
493	        assert customer is not None
494	        self.assertTrue(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:501:8
500	        customer = get_customer_by_realm(lear_realm)
501	        assert customer is not None
502	        self.assertFalse(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\tests\test_support_views.py:532:8
531	        customer = get_customer_by_realm(lear_realm)
532	        assert customer is not None
533	        self.assertFalse(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:59:4
58	) -> HttpResponse:
59	    assert request.user.is_authenticated
60	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:72:8
71	    else:
72	        assert title
73	        guest_users = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:105:4
104	def stats(request: HttpRequest) -> HttpResponse:
105	    assert request.user.is_authenticated
106	    realm = request.user.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:135:4
134	) -> HttpResponse:
135	    assert settings.ZILENCER_ENABLED
136	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:168:4
167	) -> HttpResponse:
168	    assert settings.ZILENCER_ENABLED
169	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:182:4
181	def stats_for_installation(request: HttpRequest) -> HttpResponse:
182	    assert request.user.is_authenticated
183	    return render_stats(request, "/installation", None, title="installation", for_installation=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:188:4
187	def stats_for_remote_installation(request: HttpRequest, remote_server_id: int) -> HttpResponse:
188	    assert settings.ZILENCER_ENABLED
189	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:218:4
217	) -> HttpResponse:
218	    assert settings.ZILENCER_ENABLED
219	    server = RemoteZulipServer.objects.get(id=remote_server_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:253:12
252	        if remote:
253	            assert settings.ZILENCER_ENABLED
254	            aggregate_table: TableType = RemoteInstallationCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:255:12
254	            aggregate_table: TableType = RemoteInstallationCount
255	            assert server is not None
256	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:260:12
259	        if remote:
260	            assert settings.ZILENCER_ENABLED
261	            aggregate_table = RemoteRealmCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:262:12
261	            aggregate_table = RemoteRealmCount
262	            assert server is not None
263	            assert remote_realm_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:263:12
262	            assert server is not None
263	            assert remote_realm_id is not None
264	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:343:8
342	        # table.
343	        assert server is not None
344	        assert aggregate_table is RemoteInstallationCount or aggregate_table is RemoteRealmCount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:344:8
343	        assert server is not None
344	        assert aggregate_table is RemoteInstallationCount or aggregate_table is RemoteRealmCount
345	        aggregate_table_remote = cast(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:354:12
353	            first = aggregate_table_remote.objects.filter(server=server).first()
354	            assert first is not None
355	            start = first.end_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:358:12
357	            last = aggregate_table_remote.objects.filter(server=server).last()
358	            assert last is not None
359	            end = last.end_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\stats.py:388:4
387	
388	    assert len({stat.frequency for stat in stats}) == 1
389	    end_times = time_range(start, end, stats[0].frequency, min_length)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:95:8
94	
95	        assert content_object is not None
96	        if hasattr(content_object, "status"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:187:8
186	
187	        assert realm_id is not None
188	        realm = Realm.objects.get(id=realm_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:191:8
190	        acting_user = request.user
191	        assert isinstance(acting_user, UserProfile)
192	        if plan_type is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\analytics\views\support.py:291:16
290	                hostname = parse_result.hostname
291	                assert hostname is not None
292	                if parse_result.port:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:94:4
93	    obj = confirmation.content_object
94	    assert obj is not None
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:106:8
105	        # intended to be used more than once.
106	        assert confirmation.type != Confirmation.MULTIUSE_INVITE
107	        assert hasattr(obj, "status")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:107:8
106	        assert confirmation.type != Confirmation.MULTIUSE_INVITE
107	        assert hasattr(obj, "status")
108	        obj.status = getattr(settings, "STATUS_USED", 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:128:8
127	    else:
128	        assert not isinstance(obj, PreregistrationRealm)
129	        realm = obj.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\confirmation\models.py:137:12
136	        else:
137	            assert validity_in_minutes is not None
138	            expiry_date = current_time + datetime.timedelta(minutes=validity_in_minutes)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:129:4
128	def add_months(dt: datetime, months: int) -> datetime:
129	    assert months >= 0
130	    # It's fine that the max day in Feb is 28 for leap years.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:183:4
182	        return None
183	    assert plan.next_invoice_date is not None  # for mypy
184	    months_per_period = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:208:4
207	        plan = new_plan
208	    assert plan.price_per_license is not None  # for mypy
209	    return plan.price_per_license * last_ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:359:4
358	    customer = get_customer_by_realm(user.realm)
359	    assert customer is not None  # for mypy
360	    assert customer.stripe_customer_id is not None  # for mypy

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:360:4
359	    assert customer is not None  # for mypy
360	    assert customer.stripe_customer_id is not None  # for mypy
361	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:410:4
409	    )
410	    assert last_ledger_renewal is not None
411	    last_renewal = last_ledger_renewal.event_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:414:8
413	    if plan.is_free_trial() or plan.status == CustomerPlan.SWITCH_NOW_FROM_STANDARD_TO_PLUS:
414	        assert plan.next_invoice_date is not None
415	        next_billing_cycle = plan.next_invoice_date

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:420:8
419	        licenses_at_next_renewal = last_ledger_entry.licenses_at_next_renewal
420	        assert licenses_at_next_renewal is not None
421	        if plan.status == CustomerPlan.ACTIVE:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:481:12
480	            realm = new_plan.customer.realm
481	            assert realm is not None
482	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:527:12
526	            )
527	            assert standard_plan_last_ledger is not None
528	            licenses_for_plus_plan = standard_plan_last_ledger.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:529:12
528	            licenses_for_plus_plan = standard_plan_last_ledger.licenses_at_next_renewal
529	            assert licenses_for_plus_plan is not None
530	            plus_plan_ledger_entry = LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:690:4
689	    customer = update_or_create_stripe_customer(user)
690	    assert customer.stripe_customer_id is not None  # for mypy
691	    assert customer.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:691:4
690	    assert customer.stripe_customer_id is not None  # for mypy
691	    assert customer.realm is not None
692	    ensure_realm_does_not_have_active_plan(customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:785:8
784	    if licenses is not None:
785	        assert plan.customer.realm is not None
786	        assert get_latest_seat_count(plan.customer.realm) <= licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:786:8
785	        assert plan.customer.realm is not None
786	        assert get_latest_seat_count(plan.customer.realm) <= licenses
787	        assert licenses > plan.licenses()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:787:8
786	        assert get_latest_seat_count(plan.customer.realm) <= licenses
787	        assert licenses > plan.licenses()
788	        LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:792:8
791	    elif licenses_at_next_renewal is not None:
792	        assert plan.customer.realm is not None
793	        assert get_latest_seat_count(plan.customer.realm) <= licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:793:8
792	        assert plan.customer.realm is not None
793	        assert get_latest_seat_count(plan.customer.realm) <= licenses_at_next_renewal
794	        LicenseLedger.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:844:8
843	    if not plan.customer.stripe_customer_id:
844	        assert plan.customer.realm is not None
845	        raise BillingError(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:855:8
854	    else:
855	        assert plan.invoiced_through is not None
856	        licenses_base = plan.invoiced_through.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:868:16
867	            else:
868	                assert plan.price_per_license is not None  # needed for mypy
869	                price_args = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:875:12
874	        elif licenses_base is not None and ledger_entry.licenses != licenses_base:
875	            assert plan.price_per_license
876	            last_ledger_entry_renewal = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:883:12
882	            )
883	            assert last_ledger_entry_renewal is not None
884	            last_renewal = last_ledger_entry_renewal.event_time

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1053:4
1052	
1053	    assert plan.customer.realm is not None
1054	    do_change_realm_plan_type(plan.customer.realm, Realm.PLAN_TYPE_LIMITED, acting_user=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1070:8
1069	        # TODO: Decimal stuff
1070	        assert plan.customer.realm is not None
1071	        annual_revenue[plan.customer.realm.string_id] = int(renewal_cents / 100)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1079:8
1078	    for customer in customers:
1079	        assert customer.realm is not None
1080	        realms_to_default_discount[customer.realm.string_id] = assert_is_not_none(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1102:4
1101	    plan = get_current_plan_by_realm(realm)
1102	    assert plan is not None
1103	    do_change_plan_status(plan, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1148:8
1147	        realm = customer.realm
1148	        assert realm is not None
1149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1209:4
1208	    )
1209	    assert standard_plan_last_renewal_ledger is not None
1210	    assert standard_plan.price_per_license is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1210:4
1209	    assert standard_plan_last_renewal_ledger is not None
1210	    assert standard_plan.price_per_license is not None
1211	    standard_plan_last_renewal_amount = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe.py:1229:4
1228	    plus_plan = get_current_plan_by_realm(realm)
1229	    assert plus_plan is not None  # for mypy
1230	    invoice_plan(plus_plan, plan_switch_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:74:4
73	    stripe_setup_intent = stripe.SetupIntent.retrieve(stripe_session.setup_intent)
74	    assert session.customer.realm is not None
75	    user_id = stripe_session.metadata.get("user_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:76:4
75	    user_id = stripe_session.metadata.get("user_id")
76	    assert user_id is not None
77	    user = get_active_user_profile_by_id_in_realm(user_id, session.customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:86:8
85	        update_or_create_stripe_customer(user, payment_method)
86	        assert session.payment_intent is not None
87	        session.payment_intent.status = PaymentIntent.PROCESSING

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:121:4
120	    metadata: Dict[str, Any] = stripe_payment_intent.metadata
121	    assert payment_intent.customer.realm is not None
122	    user_id = metadata.get("user_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:123:4
122	    user_id = metadata.get("user_id")
123	    assert user_id is not None
124	    user = get_active_user_profile_by_id_in_realm(user_id, payment_intent.customer.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\lib\stripe_event_handler.py:168:4
167	    )
168	    assert payment_intent.customer.realm is not None
169	    billing_logger.info(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:38:12
37	        if is_self_hosted:
38	            assert self.realm is None
39	        return is_self_hosted

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:45:12
44	        if is_cloud:
45	            assert self.remote_server is None
46	        return is_cloud

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:286:8
285	        ledger_entry = LicenseLedger.objects.filter(plan=self).order_by("id").last()
286	        assert ledger_entry is not None
287	        return ledger_entry.licenses

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\models.py:293:8
292	        ledger_entry = LicenseLedger.objects.filter(plan=self).order_by("id").last()
293	        assert ledger_entry is not None
294	        return ledger_entry.licenses_at_next_renewal

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:355:12
354	        if generate_fixture:  # nocoverage
355	            assert stripe.api_key
356	        for mocked_function_name in MOCKED_STRIPE_FUNCTION_NAMES:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:451:12
450	        if attaches_to_customer:
451	            assert charge_succeeds is not None
452	            if charge_succeeds:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:519:8
518	        )
519	        assert response.status_code == 200
520	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:525:8
524	        )
525	        assert response.status_code == 200
526	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:594:12
593	            last_stripe_payment_intent = PaymentIntent.objects.last()
594	            assert last_stripe_payment_intent is not None
595	            expected_session_details["type"] = "upgrade_from_billing_page"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:705:8
704	        [payment_intent] = PaymentIntent.objects.all()
705	        assert payment_intent.stripe_payment_intent_id is not None
706	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1466:8
1465	        customer = Customer.objects.first()
1466	        assert customer is not None
1467	        stripe_customer_id: str = assert_is_not_none(customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1479:8
1478	        ledger_entry = LicenseLedger.objects.first()
1479	        assert ledger_entry is not None
1480	        self.assertEqual(ledger_entry.licenses, new_seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1530:8
1529	        stripe_customer_id = Customer.objects.get(realm=get_realm("zulip")).stripe_customer_id
1530	        assert stripe_customer_id is not None
1531	        self.assertFalse(CustomerPlan.objects.exists())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1673:8
1672	        [payment_intent] = PaymentIntent.objects.all()
1673	        assert payment_intent.stripe_payment_intent_id is not None
1674	        response_dict = self.assert_json_success(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1700:8
1699	        stripe_customer_id = Customer.objects.get(realm=get_realm("zulip")).stripe_customer_id
1700	        assert stripe_customer_id is not None
1701	        self.assertFalse(CustomerPlan.objects.exists())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1732:8
1731	        [second_payment_intent, _] = PaymentIntent.objects.all().order_by("-id")
1732	        assert second_payment_intent.stripe_payment_intent_id is not None
1733	        response_dict = self.assert_json_success(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1889:8
1888	        customer = get_customer_by_realm(get_realm("zulip"))
1889	        assert customer is not None
1890	        assert customer.stripe_customer_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:1890:8
1889	        assert customer is not None
1890	        assert customer.stripe_customer_id is not None
1891	        [invoice, _] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2266:8
2265	        ).first()
2266	        assert sponsorship_request is not None
2267	        self.assertEqual(sponsorship_request.org_website, data["website"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2275:8
2274	        customer = get_customer_by_realm(user.realm)
2275	        assert customer is not None
2276	        self.assertEqual(customer.sponsorship_pending, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2492:8
2491	        ).last()
2492	        assert realm_audit_log is not None
2493	        expected_extra_data = str({"old_discount": None, "new_discount": Decimal("85")})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2501:8
2500	        customer = Customer.objects.first()
2501	        assert customer is not None
2502	        [charge] = stripe.Charge.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2505:8
2504	        stripe_customer_id = customer.stripe_customer_id
2505	        assert stripe_customer_id is not None
2506	        [invoice] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2523:8
2522	        stripe_customer_id = customer.stripe_customer_id
2523	        assert stripe_customer_id is not None
2524	        [invoice, _] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2539:8
2538	        stripe_customer_id = customer.stripe_customer_id
2539	        assert stripe_customer_id is not None
2540	        [invoice, _, _] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2545:8
2544	        ).last()
2545	        assert realm_audit_log is not None
2546	        expected_extra_data = str(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2565:8
2564	        message = Message.objects.filter(sender=sender.id).first()
2565	        assert message is not None
2566	        self.assertEqual(message.content, expected_message)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2575:8
2574	        customer = get_customer_by_realm(realm=lear)
2575	        assert customer is not None
2576	        self.assertTrue(customer.sponsorship_pending)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2580:8
2579	        ).last()
2580	        assert realm_audit_log is not None
2581	        expected_extra_data = {"sponsorship_pending": True}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2599:8
2598	        customer = Customer.objects.first()
2599	        assert customer is not None
2600	        stripe_customer_id = customer.stripe_customer_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2601:8
2600	        stripe_customer_id = customer.stripe_customer_id
2601	        assert stripe_customer_id is not None
2602	        stripe.InvoiceItem.create(amount=5000, currency="usd", customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2663:8
2662	        self.assert_in_success_response(["payment method: <strong>visa ending in 0341"], response)
2663	        assert RealmAuditLog.objects.filter(event_type=RealmAuditLog.STRIPE_CARD_CHANGED).exists()
2664	        stripe_payment_methods = stripe.PaymentMethod.list(customer=stripe_customer_id, type="card")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2723:8
2722	        plan = get_current_plan_by_realm(user.realm)
2723	        assert plan is not None
2724	        self.assertEqual(plan.licenses(), self.seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2733:16
2732	                new_plan = get_current_plan_by_realm(user.realm)
2733	                assert new_plan is not None
2734	                expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2782:8
2781	        plan = CustomerPlan.objects.first()
2782	        assert plan is not None
2783	        self.assertEqual(get_realm("zulip").plan_type, Realm.PLAN_TYPE_LIMITED)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2805:8
2804	        plan = CustomerPlan.objects.first()
2805	        assert plan is not None
2806	        self.assertIsNotNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2813:8
2812	        plan = CustomerPlan.objects.first()
2813	        assert plan is not None
2814	        self.assertIsNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2833:8
2832	        monthly_plan = get_current_plan_by_realm(user.realm)
2833	        assert monthly_plan is not None
2834	        self.assertEqual(monthly_plan.automanage_licenses, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2839:8
2838	        new_plan = get_current_plan_by_realm(user.realm)
2839	        assert new_plan is not None
2840	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2873:8
2872	        customer = get_customer_by_realm(user.realm)
2873	        assert customer is not None
2874	        self.assertEqual(CustomerPlan.objects.filter(customer=customer).count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2879:8
2878	        annual_plan = get_current_plan_by_realm(user.realm)
2879	        assert annual_plan is not None
2880	        self.assertEqual(annual_plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:2916:8
2915	
2916	        assert customer.stripe_customer_id
2917	        [invoice0, invoice1, invoice2] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3022:8
3021	        monthly_plan = get_current_plan_by_realm(user.realm)
3022	        assert monthly_plan is not None
3023	        self.assertEqual(monthly_plan.automanage_licenses, False)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3027:8
3026	        new_plan = get_current_plan_by_realm(user.realm)
3027	        assert new_plan is not None
3028	        with self.assertLogs("corporate.stripe", "INFO") as m:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3051:8
3050	        customer = get_customer_by_realm(user.realm)
3051	        assert customer is not None
3052	        self.assertEqual(CustomerPlan.objects.filter(customer=customer).count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3057:8
3056	        annual_plan = get_current_plan_by_realm(user.realm)
3057	        assert annual_plan is not None
3058	        self.assertEqual(annual_plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3081:8
3080	
3081	        assert customer.stripe_customer_id
3082	        [invoice0, invoice1] = stripe.Invoice.list(customer=customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3136:16
3135	                new_plan = get_current_plan_by_realm(user.realm)
3136	                assert new_plan is not None
3137	                expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3141:8
3140	        plan = CustomerPlan.objects.first()
3141	        assert plan is not None
3142	        self.assertEqual(plan.status, CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3150:8
3149	        plan = CustomerPlan.objects.first()
3150	        assert plan is not None
3151	        self.assertEqual(plan.status, CustomerPlan.ACTIVE)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3169:12
3168	            new_plan = get_current_plan_by_realm(user.realm)
3169	            assert new_plan is not None
3170	            with patch("corporate.views.billing_page.timezone_now", return_value=self.now):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3178:8
3177	        plan = CustomerPlan.objects.first()
3178	        assert plan is not None
3179	        self.assertIsNotNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3183:8
3182	        plan = CustomerPlan.objects.first()
3183	        assert plan is not None
3184	        self.assertIsNone(plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3205:12
3204	            last_ledger_entry = LicenseLedger.objects.order_by("id").last()
3205	            assert last_ledger_entry is not None
3206	            self.assertEqual(last_ledger_entry.licenses, 21)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3250:12
3249	            new_plan = get_current_plan_by_realm(user.realm)
3250	            assert new_plan is not None
3251	            expected_log = f"INFO:corporate.stripe:Change plan status: Customer.id: {stripe_customer_id}, CustomerPlan.id: {new_plan.id}, status: {CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3279:8
3278	        current_plan = CustomerPlan.objects.all().order_by("id").last()
3279	        assert current_plan is not None
3280	        next_invoice_date = add_months(self.next_year, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3286:8
3285	        old_plan = CustomerPlan.objects.all().order_by("id").first()
3286	        assert old_plan is not None
3287	        self.assertEqual(old_plan.next_invoice_date, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3508:8
3507	        last_ledger_entry = LicenseLedger.objects.order_by("id").last()
3508	        assert last_ledger_entry is not None
3509	        self.assertEqual(last_ledger_entry.licenses, 20)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3559:8
3558	        current_plan = CustomerPlan.objects.all().order_by("id").last()
3559	        assert current_plan is not None
3560	        self.assertEqual(current_plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3565:8
3564	        old_plan = CustomerPlan.objects.all().order_by("id").first()
3565	        assert old_plan is not None
3566	        self.assertEqual(old_plan.next_invoice_date, None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3579:8
3578	
3579	        assert zulip_customer.stripe_customer_id
3580	        stripe.InvoiceItem.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3597:8
3596	
3597	        assert lear_customer.stripe_customer_id
3598	        stripe.InvoiceItem.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3636:8
3635	        invoices = []
3636	        assert customer.stripe_customer_id is not None
3637	        for _ in range(num_invoices):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\corporate\tests\test_stripe.py:3664:45
3663	        ) -> Tuple[Realm, Optional[Customer], Optional[CustomerPlan], List[stripe.Invoice]]:
3664	            realm_string_id = "realm_" + str(random.randrange(1, 1000000))
3665	            realm = Realm.objects.create(string_id=realm_string_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3685:16
3684	            if num_invoices is not None:
3685	                assert customer is not None
3686	                invoices = self.create_invoices(customer, num_invoices)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3828:8
3827	        plus_plan = get_current_plan_by_realm(realm)
3828	        assert plus_plan is not None
3829	        self.assertEqual(plus_plan.tier, CustomerPlan.PLUS)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3842:8
3841	        stripe_customer_id = customer.stripe_customer_id
3842	        assert stripe_customer_id is not None
3843	        _, cb_txn = stripe.Customer.list_balance_transactions(stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3916:8
3915	        ).last()
3916	        assert realm_audit_log is not None
3917	        expected_extra_data = {"charge_automatically": plan.charge_automatically}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:3927:8
3926	        ).last()
3927	        assert realm_audit_log is not None
3928	        expected_extra_data = {"charge_automatically": plan.charge_automatically}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4550:8
4549	        ).last()
4550	        assert remote_realm_audit_log is not None
4551	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4574:8
4573	        ).last()
4574	        assert remote_realm_audit_log is not None
4575	        self.assertTrue(remote_server.deactivated)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4646:8
4645	        plan = CustomerPlan.objects.first()
4646	        assert plan is not None
4647	        self.assertEqual(plan.licenses(), self.seat_count)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4696:8
4695	        plan = get_current_plan_by_realm(realm)
4696	        assert plan is not None
4697	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4776:8
4775	        plan = CustomerPlan.objects.first()
4776	        assert plan is not None
4777	        plan.invoicing_status = CustomerPlan.STARTED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4785:8
4784	        plan = get_current_plan_by_realm(get_realm("zulip"))
4785	        assert plan is not None
4786	        plan.customer.stripe_customer_id = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4817:8
4816	        plan = CustomerPlan.objects.first()
4817	        assert plan is not None
4818	        invoice_plan(plan, self.now + timedelta(days=400))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4820:8
4819	        stripe_cutomer_id = plan.customer.stripe_customer_id
4820	        assert stripe_cutomer_id is not None
4821	        [invoice0, invoice1] = stripe.Invoice.list(customer=stripe_cutomer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4869:8
4868	        plan = CustomerPlan.objects.first()
4869	        assert plan is not None
4870	        plan.fixed_price = 100

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4875:8
4874	        stripe_customer_id = plan.customer.stripe_customer_id
4875	        assert stripe_customer_id is not None
4876	        [invoice0, invoice1] = stripe.Invoice.list(customer=stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4896:8
4895	        plan = CustomerPlan.objects.first()
4896	        assert plan is not None
4897	        self.assertEqual(plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4902:8
4901	        # Test that we still update next_invoice_date
4902	        assert plan is not None
4903	        self.assertEqual(plan.next_invoice_date, self.next_month + timedelta(days=29))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4909:8
4908	        plan = CustomerPlan.objects.first()
4909	        assert plan is not None
4910	        self.assertEqual(plan.next_invoice_date, self.next_month)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\tests\test_stripe.py:4918:8
4917	        plan = CustomerPlan.objects.first()
4918	        assert plan is not None
4919	        self.assertEqual(plan.next_invoice_date, self.next_month + timedelta(days=29))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:84:4
83	    user = request.user
84	    assert user.is_authenticated
85	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:120:12
119	                plan = new_plan
120	            assert plan is not None  # for mypy
121	            downgrade_at_end_of_cycle = plan.status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:131:16
130	            if plan.is_free_trial():
131	                assert plan.next_invoice_date is not None
132	                renewal_date = "{dt:%B} {dt.day}, {dt.year}".format(dt=plan.next_invoice_date)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:140:12
139	            charge_automatically = plan.charge_automatically
140	            assert customer.stripe_customer_id is not None  # for mypy
141	            stripe_customer = stripe_get_customer(customer.stripe_customer_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:193:4
192	    plan = get_current_plan_by_realm(user.realm)
193	    assert plan is not None  # for mypy
194	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:206:12
205	        if status == CustomerPlan.ACTIVE:
206	            assert plan.status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE
207	            do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:209:12
208	        elif status == CustomerPlan.DOWNGRADE_AT_END_OF_CYCLE:
209	            assert plan.status == CustomerPlan.ACTIVE
210	            downgrade_at_the_end_of_billing_cycle(user.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:212:12
211	        elif status == CustomerPlan.SWITCH_TO_ANNUAL_AT_END_OF_CYCLE:
212	            assert plan.billing_schedule == CustomerPlan.MONTHLY
213	            assert plan.status == CustomerPlan.ACTIVE

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:213:12
212	            assert plan.billing_schedule == CustomerPlan.MONTHLY
213	            assert plan.status == CustomerPlan.ACTIVE
214	            assert plan.fixed_price is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:214:12
213	            assert plan.status == CustomerPlan.ACTIVE
214	            assert plan.fixed_price is None
215	            do_change_plan_status(plan, status)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\billing_page.py:217:12
216	        elif status == CustomerPlan.ENDED:
217	            assert plan.is_free_trial()
218	            downgrade_now_without_creating_additional_invoices(user.realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\session.py:22:4
21	    customer = get_customer_by_realm(user.realm)
22	    assert customer
23	    stripe_session = stripe.checkout.Session.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\support.py:23:4
22	    user = request.user
23	    assert user.is_authenticated
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:94:4
93	    customer = update_or_create_stripe_customer(user)
94	    assert customer is not None  # for mypy
95	    free_trial = is_free_trial_offer_enabled()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:193:8
192	        )
193	        assert licenses is not None and license_management is not None
194	        automanage_licenses = license_management == "automatic"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\upgrade.py:255:4
254	    user = request.user
255	    assert user.is_authenticated
256	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:40:8
39	    else:
40	        assert not settings.PRODUCTION
41	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:65:8
64	        stripe_session = stripe_event.data.object
65	        assert isinstance(stripe_session, stripe.checkout.Session)
66	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:76:8
75	        stripe_payment_intent = stripe_event.data.object
76	        assert isinstance(stripe_payment_intent, stripe.PaymentIntent)
77	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\corporate\views\webhook.py:92:12
91	        try:
92	            assert isinstance(stripe_payment_intent, stripe.PaymentIntent)
93	            payment_intent = PaymentIntent.objects.get(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\check_rabbitmq_queue.py:4:0
3	import re
4	import subprocess
5	import time

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\check_rabbitmq_queue.py:135:25
134	
135	    list_queues_output = subprocess.check_output(
136	        ["/usr/sbin/rabbitmqctl", "list_queues", "name", "messages", "consumers"],
137	        text=True,
138	    )
139	    queue_counts_rabbitmqctl = {}

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\check_rabbitmq_queue.py:152:22
151	
152	    queue_stats_dir = subprocess.check_output(
153	        [os.path.join(ZULIP_PATH, "scripts/get-django-setting"), "QUEUE_STATS_DIR"],
154	        text=True,
155	    ).strip()
156	    queue_stats: Dict[str, Dict[str, Any]] = {}

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\hash_reqs.py:5:0
4	import os
5	import subprocess
6	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\hash_reqs.py:38:11
37	    """
38	    return subprocess.check_output(["/usr/bin/python3", "-VV"], text=True)
39	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\hash_reqs.py:43:11
42	    deps_str = "\n".join(deps) + "\n" + python_version()
43	    return hashlib.sha1(deps_str.encode()).hexdigest()
44	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\puppet_cache.py:5:0
4	import shutil
5	import subprocess
6	import tempfile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\puppet_cache.py:25:29
24	        data["deps.yaml"] = fb.read().strip()
25	    data["puppet-version"] = subprocess.check_output(
26	        # This is 10x faster than `puppet --version`
27	        ["ruby", "-r", "puppet/version", "-e", "puts Puppet.version"],
28	        text=True,
29	    ).strip()
30	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\puppet_cache.py:25:29
24	        data["deps.yaml"] = fb.read().strip()
25	    data["puppet-version"] = subprocess.check_output(
26	        # This is 10x faster than `puppet --version`
27	        ["ruby", "-r", "puppet/version", "-e", "puts Puppet.version"],
28	        text=True,
29	    ).strip()
30	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\puppet_cache.py:31:14
30	
31	    sha1sum = hashlib.sha1()
32	    sha1sum.update(json.dumps(data, sort_keys=True).encode())

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\scripts\lib\puppet_cache.py:67:9
66	) -> None:
67	    with urlopen(f"https://forgeapi.puppet.com/v3/releases/{module}-{version}") as forge_resp:
68	        forge_data = json.load(forge_resp)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\scripts\lib\puppet_cache.py:81:13
80	    ) as tarball:
81	        with urlopen("https://forgeapi.puppet.com" + forge_data["file_uri"]) as tarball_resp:
82	            tarball_content = tarball_resp.read()

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\scripts\lib\setup_path.py:15:12
14	        with open(activate_this) as f:
15	            exec(f.read(), activate_locals)  # noqa: S102
16	        # Check that the python version running this function

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\setup_venv.py:4:0
3	import shutil
4	import subprocess
5	from typing import List, Optional, Set, Tuple

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:177:30
176	            continue
177	        venv_python_version = subprocess.check_output([venv_python3, "-VV"], text=True)
178	        if desired_python_version != venv_python_version:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\setup_venv.py:278:13
277	    path = os.path.join(ZULIP_PATH, "scripts", "lib", "hash_reqs.py")
278	    output = subprocess.check_output([path, requirements_file], text=True)
279	    return output.split()[0]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\sharding.py:6:0
5	import os
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\sharding.py:35:4
34	    expected_ports = list(range(9800, ports[-1] + 1))
35	    assert ports == expected_ports, f"ports ({ports}) must be contiguous, starting with 9800"
36	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\sharding.py:51:24
50	        shard_regexes: List[Tuple[str, Union[int, List[int]]]] = []
51	        external_host = subprocess.check_output(
52	            [os.path.join(BASE_DIR, "scripts/get-django-setting"), "EXTERNAL_HOST"],
53	            text=True,
54	        ).strip()
55	        for key, shards in config_file["tornado_sharding"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\sharding.py:69:20
68	                        host = f"{shard}.{external_host}"
69	                    assert host not in shard_map, f"host {host} duplicated"
70	                    shard_map[host] = ports[0] if len(ports) == 1 else ports

--------------------------------------------------
>> Issue: [B411:blacklist] Using client to parse untrusted XML data is known to be vulnerable to XML attacks. Use defusedxml.xmlrpc.monkey_patch() function to monkey-patch xmlrpclib and mitigate XML vulnerabilities.
   Severity: High   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b411-import-xmlrpclib
   Location: .\scripts\lib\supervisor.py:4:0
3	from typing import Dict, List, Optional, Tuple, Union
4	from xmlrpc import client
5	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\supervisor.py:35:4
34	    processes = rpc().supervisor.getAllProcessInfo()
35	    assert isinstance(processes, list)
36	    for process in processes:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\scripts\lib\zulip_tools.py:15:0
14	import signal
15	import subprocess
16	import sys

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\scripts\lib\zulip_tools.py:51:43
50	        # overwrite an existing target; we handle the error and try again.
51	        tmp = os.path.join(dir, f".{base}.{random.randrange(1 << 40):010x}")
52	        try:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:116:12
115	            # deploy, so we set up its remote.
116	            subprocess.check_call(
117	                [os.path.join(get_deploy_root(), "scripts", "lib", "update-git-upstream")],
118	                cwd=deploy_path,
119	                preexec_fn=su_to_zulip,
120	            )
121	            subprocess.check_call(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:121:12
120	            )
121	            subprocess.check_call(
122	                [os.path.join(deploy_path, "tools", "cache-zulip-git-version")],
123	                cwd=deploy_path,
124	                preexec_fn=su_to_zulip,
125	            )
126	        except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:130:15
129	        varname = "ZULIP_MERGE_BASE" if merge_base else "ZULIP_VERSION"
130	        return subprocess.check_output(
131	            [sys.executable, "-c", f"from version import {varname}; print({varname})"],
132	            cwd=deploy_path,
133	            text=True,
134	        ).strip()
135	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:256:8
255	    try:
256	        subprocess.check_call(args, **kwargs)
257	    except subprocess.CalledProcessError as error:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:382:10
381	def generate_sha1sum_emoji(zulip_path: str) -> str:
382	    sha = hashlib.sha1()
383	

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\scripts\lib\zulip_tools.py:488:14
487	    # see is_digest_obsolete for more context
488	    sha1sum = hashlib.sha1()
489	    for fn in filenames:

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\scripts\lib\zulip_tools.py:614:4
613	    subcmd = shlex.join(["psql", "-v", "ON_ERROR_STOP=1", "-d", dbname, "-c", sql_query])
614	    subprocess.check_call(["su", "postgres", "-c", subcmd])
615	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:614:4
613	    subcmd = shlex.join(["psql", "-v", "ON_ERROR_STOP=1", "-d", dbname, "-c", sql_query])
614	    subprocess.check_call(["su", "postgres", "-c", subcmd])
615	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\scripts\lib\zulip_tools.py:666:4
665	    r = SplitResult("", netloc, "", "", "")
666	    assert r.hostname is not None
667	    return "[" + r.hostname + "]" if ":" in r.hostname else r.hostname

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\scripts\lib\zulip_tools.py:695:8
694	    lines = (
695	        subprocess.check_output(
696	            ["/bin/ss", "-Hnl", filter],
697	            text=True,
698	            # Hosts with IPv6 disabled will get "RTNETLINK answers: Invalid
699	            # argument"; eat stderr to hide that
700	            stderr=subprocess.DEVNULL,
701	        )
702	        .strip()

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'True'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\scripts\setup\generate_secrets.py:15:11
14	
15	os.environ["DISABLE_MANDATORY_SECRET_CHECK"] = "True"
16	os.environ["DJANGO_SETTINGS_MODULE"] = "zproject.settings"

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\add_mentor.py:36:8
35	
36	    r = requests.get(url)
37	    if r.status_code != 200:

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:49:19
48	    try:
49	        response = urllib.request.urlopen(user_api_url)
50	        json.load(response)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:63:19
62	    try:
63	        response = urllib.request.urlopen(apiurl_keys)
64	        userkeys = json.load(response)

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\tools\droplets\create.py:82:19
81	    try:
82	        response = urllib.request.urlopen(apiurl_fork)
83	        json.load(response)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\droplets\create.py:308:15
307	def get_zulip_oneclick_app_slug(api_token: str) -> str:
308	    response = requests.get(
309	        "https://api.digitalocean.com/v2/1-clicks", headers={"Authorization": f"Bearer {api_token}"}
310	    ).json()
311	    one_clicks = response["1_clicks"]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\pretty_print.py:1:0
1	import subprocess
2	from typing import List, Optional
3	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:55:12
54	        if token.tag == "else":
55	            assert token.start_token
56	            if token.indent is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\pretty_print.py:74:20
73	                if start_token:
74	                    assert start_token.child_indent is not None
75	                    token.indent = start_token.child_indent

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\pretty_print.py:183:8
182	        )
183	        subprocess.run(["diff", fn, "-"], input=phtml, text=True)
184	        print(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\pretty_print.py:183:8
182	        )
183	        subprocess.run(["diff", fn, "-"], input=phtml, text=True)
184	        print(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\provision.py:7:0
6	import platform
7	import subprocess
8	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\provision.py:317:7
316	    # pg_datadir directory.
317	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
318	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\provision.py:317:7
316	    # pg_datadir directory.
317	    if subprocess.call(["sudo", "test", "-e", pg_hba_conf]) == 0:
318	        # Skip setup if it has been applied previously

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\tools\lib\provision.py:354:14
353	    # hash the apt dependencies
354	    sha_sum = hashlib.sha1()
355	

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\tools\lib\provision.py:455:8
454	    with open(activate_this) as f:
455	        exec(f.read(), dict(__file__=activate_this))  # noqa: S102
456	    os.execvp(

--------------------------------------------------
>> Issue: [B606:start_process_with_no_shell] Starting a process without a shell.
   Severity: Low   Confidence: Medium
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b606_start_process_with_no_shell.html
   Location: .\tools\lib\provision.py:456:4
455	        exec(f.read(), dict(__file__=activate_this))  # noqa: S102
456	    os.execvp(
457	        provision_inner,
458	        [
459	            provision_inner,
460	            *(["--force"] if options.is_force else []),
461	            *(["--build-release-tarball-only"] if options.is_build_release_tarball_only else []),
462	            *(["--skip-dev-db-build"] if options.skip_dev_db_build else []),
463	        ],
464	    )
465	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\provision_inner.py:33:4
32	    line = f.readline()
33	    assert line.startswith("# version ")
34	    timezones_version = line[len("# version ") :]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\provision_inner.py:248:8
247	
248	        assert settings.RABBITMQ_PASSWORD is not None
249	        if options.is_force or need_to_run_configure_rabbitmq([settings.RABBITMQ_PASSWORD]):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:347:4
346	def validate(fn: Optional[str] = None, text: Optional[str] = None) -> List[Token]:
347	    assert fn or text
348	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\lib\template_parser.py:376:8
375	    def no_start_tag(token: Optional[Token]) -> None:
376	        assert token
377	        raise TemplateParserError(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_script.py:3:0
2	import os
3	import subprocess
4	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\lib\test_script.py:125:4
124	    os.environ["PUPPETEER_PRODUCT"] = "firefox" if is_firefox else "chrome"
125	    subprocess.check_call(["node", "install.js"], cwd="node_modules/puppeteer")
126	    os.makedirs("var/puppeteer", exist_ok=True)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_script.py:125:4
124	    os.environ["PUPPETEER_PRODUCT"] = "firefox" if is_firefox else "chrome"
125	    subprocess.check_call(["node", "install.js"], cwd="node_modules/puppeteer")
126	    os.makedirs("var/puppeteer", exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\lib\test_server.py:2:0
1	import os
2	import subprocess
3	import sys

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\tools\lib\test_server.py:49:15
48	        # Note that zulipdev.com is mapped via DNS to 127.0.0.1.
49	        return requests.get("http://zulipdev.com:9981/accounts/home").status_code == 200
50	    except requests.RequestException:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\lib\test_server.py:78:17
77	            run_dev_server_command.append("--skip-provision-check")
78	        server = subprocess.Popen(run_dev_server_command, stdout=log, stderr=log)
79	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:2:0
1	import os
2	import subprocess
3	import time

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:21:4
20	def generate_ssh_keys() -> None:
21	    subprocess.call(
22	        ["ssh-keygen", "-f", str(Path.home()) + "/.ssh/id_ed25519", "-P", "", "-t", "ed25519"]
23	    )
24	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:21:4
20	def generate_ssh_keys() -> None:
21	    subprocess.call(
22	        ["ssh-keygen", "-f", str(Path.home()) + "/.ssh/id_ed25519", "-P", "", "-t", "ed25519"]
23	    )
24	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:119:4
118	def setup_one_click_app_installer(droplet: digitalocean.Droplet) -> None:
119	    subprocess.check_call(
120	        [
121	            "fab",
122	            "build_image",
123	            "-H",
124	            droplet.ip_address,
125	            "--keepalive",
126	            "5",
127	            "--connection-attempts",
128	            "10",
129	        ],
130	        cwd="marketplace-partners/marketplace_docs/templates/Fabric",
131	    )
132	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\tools\oneclickapps\prepare_digital_ocean_one_click_app_release.py:119:4
118	def setup_one_click_app_installer(droplet: digitalocean.Droplet) -> None:
119	    subprocess.check_call(
120	        [
121	            "fab",
122	            "build_image",
123	            "-H",
124	            droplet.ip_address,
125	            "--keepalive",
126	            "5",
127	            "--connection-attempts",
128	            "10",
129	        ],
130	        cwd="marketplace-partners/marketplace_docs/templates/Fabric",
131	    )
132	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\tests\test_hash_reqs.py:22:8
21	
22	        assert hash1 == hash2
23	        assert hash1 != hash3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tools\tests\test_hash_reqs.py:23:8
22	        assert hash1 == hash2
23	        assert hash1 != hash3

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_realm.py:179:12
178	            # Realms with LIMITED plan cannot have spectators enabled.
179	            assert plan_type != Realm.PLAN_TYPE_LIMITED
180	            assert plan_type is not None or not settings.BILLING_ENABLED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_realm.py:180:12
179	            assert plan_type != Realm.PLAN_TYPE_LIMITED
180	            assert plan_type is not None or not settings.BILLING_ENABLED
181	        kwargs["enable_spectator_access"] = enable_spectator_access

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_realm.py:186:8
185	        # suites that want to backdate the date of a realm's creation.
186	        assert not settings.PRODUCTION
187	        kwargs["date_created"] = date_created

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_user.py:180:8
179	        # A PregistrationUser should not be used for another UserProfile
180	        assert prereg_user.created_user is None, "PregistrationUser should not be reused"
181	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_user.py:307:8
306	    if user_ids_with_real_email_access:
307	        assert person_for_real_email_access_users is not None
308	        event: Dict[str, Any] = dict(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_user.py:318:8
317	    if user_ids_without_real_email_access:
318	        assert person_for_without_real_email_access_users is not None
319	        event = dict(type="realm_user", op="add", person=person_for_without_real_email_access_users)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_user.py:436:12
435	            )
436	            assert realm_creation_audit_log is not None
437	            realm_creation_audit_log.acting_user = user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\create_user.py:485:8
484	    if realm_creation:
485	        assert realm.signup_notifications_stream is not None
486	        bulk_add_subscriptions(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\custom_profile_fields.py:117:12
116	        if field.field_type == CustomProfileField.SELECT:
117	            assert field_data is not None
118	            remove_custom_profile_field_value_if_required(field, field_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\invites.py:352:8
351	    for invitee in prereg_users:
352	        assert invitee.referred_by is not None
353	        invites.append(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\invites.py:374:8
373	        invite = confirmation_obj.content_object
374	        assert invite is not None
375	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\invites.py:378:8
377	        # deletes the Confirmation object, so it couldn't have been fetched above.
378	        assert invite.status != confirmation_settings.STATUS_REVOKED
379	        invites.append(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\invites.py:452:4
451	    realm = prereg_user.realm
452	    assert realm is not None
453	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\invites.py:481:4
480	    # These are two structurally for the caller's code path.
481	    assert prereg_user.referred_by is not None
482	    assert prereg_user.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\invites.py:482:4
481	    assert prereg_user.referred_by is not None
482	    assert prereg_user.realm is not None
483	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_delete.py:38:8
37	    if not sample_message.is_stream_message():
38	        assert len(messages) == 1
39	        message_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:407:8
406	    if content is not None:
407	        assert rendering_result is not None
408	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:410:8
409	        # mention_data is required if there's a content edit.
410	        assert mention_data is not None
411	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:493:8
492	    if topic_name is not None or new_stream is not None:
493	        assert propagate_mode is not None
494	        orig_topic_name = target_message.topic_name()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:499:8
498	    if new_stream is not None:
499	        assert content is None
500	        assert target_message.is_stream_message()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:500:8
499	        assert content is None
500	        assert target_message.is_stream_message()
501	        assert stream_being_edited is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:501:8
500	        assert target_message.is_stream_message()
501	        assert stream_being_edited is not None
502	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:506:8
505	        event[ORIG_TOPIC] = orig_topic_name
506	        assert new_stream.recipient_id is not None
507	        target_message.recipient_id = new_stream.recipient_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:581:8
580	    if topic_name is not None or new_stream is not None:
581	        assert stream_being_edited is not None
582	        assert orig_topic_name is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:582:8
581	        assert stream_being_edited is not None
582	        assert orig_topic_name is not None
583	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:587:8
586	
587	        assert target_stream.recipient_id is not None
588	        target_topic_has_messages = messages_for_topic(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:593:8
592	    if propagate_mode in ["change_later", "change_all"]:
593	        assert topic_name is not None or new_stream is not None
594	        assert stream_being_edited is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:594:8
593	        assert topic_name is not None or new_stream is not None
594	        assert stream_being_edited is not None
595	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:622:12
621	        if new_stream is not None:
622	            assert stream_being_edited is not None
623	            changed_message_ids = [msg.id for msg in changed_messages]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:759:8
758	    if topic_name is not None or new_stream is not None:
759	        assert stream_being_edited is not None
760	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:780:12
779	            # unless the topic has thousands of messages of history.
780	            assert stream_being_edited.recipient_id is not None
781	            unmoved_messages = messages_for_topic(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:800:8
799	    if moved_all_visible_messages:
800	        assert stream_being_edited is not None
801	        assert target_stream is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:801:8
800	        assert stream_being_edited is not None
801	        assert target_stream is not None
802	        assert target_topic is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:802:8
801	        assert target_stream is not None
802	        assert target_topic is not None
803	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:945:8
944	
945	        assert stream_to_send_resolve_topic_notification is not None
946	        resolved_topic_message_id = maybe_send_resolve_topic_notifications(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:997:12
996	            stream_for_new_topic = new_stream if new_stream is not None else stream_being_edited
997	            assert stream_for_new_topic.recipient_id is not None
998	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_edit.py:1254:8
1253	    if stream_id is not None:
1254	        assert message.is_stream_message()
1255	        if not user_profile.can_move_messages_between_streams():

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\actions\message_flags.py:39:8
38	    all_push_message_ids = (
39	        UserMessage.objects.filter(
40	            user_profile=user_profile,
41	        )
42	        .extra(
43	            where=[UserMessage.where_active_push_notification()],
44	        )
45	        .values_list("message_id", flat=True)[0:10000]

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\actions\message_flags.py:54:16
53	            query = (
54	                UserMessage.select_for_update_query()
55	                .filter(user_profile=user_profile)
56	                .extra(where=[UserMessage.where_unread()])[:batch_size]
57	            )

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\actions\message_flags.py:103:12
102	        query = (
103	            UserMessage.select_for_update_query()
104	            .filter(
105	                user_profile=user_profile,
106	                message__recipient_id=stream_recipient_id,
107	            )
108	            .extra(
109	                where=[UserMessage.where_unread()],
110	            )
111	        )

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\actions\message_flags.py:158:12
157	        query = (
158	            UserMessage.select_for_update_query()
159	            .filter(user_profile=user_profile, message__sender=muted_user)
160	            .extra(where=[UserMessage.where_unread()])
161	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_flags.py:224:4
223	    # only for the message-edit use case where we'll have a single message_id.
224	    assert len(user_profile_ids) == 1 or len(message_ids) == 1
225	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\actions\message_flags.py:228:8
227	    notifications_to_update = list(
228	        UserMessage.objects.filter(
229	            message_id__in=message_ids,
230	            user_profile_id__in=user_profile_ids,
231	        )
232	        .extra(
233	            where=[UserMessage.where_active_push_notification()],
234	        )
235	        .values_list("user_profile_id", "message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:205:8
204	        message_to_user_ids: Collection[int] = list({recipient.type_id, sender_id})
205	        assert len(message_to_user_ids) in [1, 2]
206	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:211:8
210	        # of this function for different message types.
211	        assert stream_topic is not None
212	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:478:4
477	        realm = message.sender.realm
478	    assert realm == message.realm
479	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:507:4
506	    # Render our message_dicts.
507	    assert message.rendered_content is None
508	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:790:12
789	            # assert needed because stubs for django are missing
790	            assert send_request.stream is not None
791	            realm_id = send_request.stream.realm_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:891:12
890	            # assert needed because stubs for django are missing
891	            assert send_request.stream is not None
892	            if send_request.stream.is_public():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:927:8
926	
927	        assert send_request.service_queue_events is not None
928	        for queue_name, events in send_request.service_queue_events.items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:1188:20
1187	                else:
1188	                    assert stream_name is not None
1189	                    arg_dict = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:1302:8
1301	            stream = addressee.stream()
1302	        assert stream is not None
1303	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:1328:12
1327	            # else can sneak past the access check.
1328	            assert sender.bot_type == sender.OUTGOING_WEBHOOK_BOT
1329	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:1353:12
1352	        except ValidationError as e:
1353	            assert isinstance(e.messages[0], str)
1354	            raise JsonableError(e.messages[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\message_send.py:1375:4
1374	    # We render messages later in the process.
1375	    assert message.rendered_content is None
1376	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\presence.py:121:4
120	
121	    assert (3 * settings.PRESENCE_PING_INTERVAL_SECS + 20) <= settings.OFFLINE_THRESHOLD_SECS
122	    now_online = time_since_last_active > datetime.timedelta(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\reactions.py:140:8
139	        reaction = query.first()
140	        assert reaction is not None
141	        emoji_name = reaction.emoji_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\realm_export.py:21:4
20	    export_extra_data = export.extra_data
21	    assert export_extra_data is not None
22	    export_data = orjson.loads(export_extra_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\realm_linkifiers.py:75:8
74	    else:
75	        assert id is not None
76	        realm_linkifier = RealmFilter.objects.get(realm=realm, id=id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\realm_settings.py:52:4
51	    property_type = Realm.property_types[name]
52	    assert isinstance(
53	        value, property_type
54	    ), f"Cannot update {name}: {value} is not an instance of {property_type}"
55	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\scheduled_messages.py:64:8
63	        scheduled_message.realm = send_request.realm
64	        assert send_request.deliver_at is not None
65	        scheduled_message.scheduled_timestamp = send_request.deliver_at

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\scheduled_messages.py:103:8
102	        scheduled_message_object.stream = send_request.stream
103	        assert send_request.deliver_at is not None
104	        scheduled_message_object.scheduled_timestamp = send_request.deliver_at

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:152:4
151	    recipient_to_keep = stream_to_keep.recipient
152	    assert recipient_to_keep is not None
153	    assert recipient_to_destroy is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:153:4
152	    assert recipient_to_keep is not None
153	    assert recipient_to_destroy is not None
154	    if recipient_to_destroy.id == recipient_to_keep.id:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:384:4
383	
384	    assert op in ["peer_add", "peer_remove"]
385	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:481:8
480	    for stream in streams:
481	        assert stream.realm_id == realm.id
482	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:484:8
483	    for user in users:
484	        assert user.realm_id == realm.id
485	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:492:8
491	    for stream in streams:
492	        assert stream.recipient_id is not None
493	        recipient_ids_set.add(stream.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:677:8
676	    for stream in streams:
677	        assert stream.realm_id == realm.id
678	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:680:8
679	    for user in users:
680	        assert user.realm_id == realm.id
681	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:872:12
871	            # messages in the stream whose permissions were changed.
872	            assert stream.recipient_id is not None
873	            Attachment.objects.filter(messages__recipient_id=stream.recipient_id).update(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:916:12
915	            # messages in the stream whose permissions were changed.
916	            assert stream.recipient_id is not None
917	            Attachment.objects.filter(messages__recipient_id=stream.recipient_id).update(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:947:8
946	        # realm admins from the non-guest user list.
947	        assert stream.recipient_id is not None
948	        previously_subscribed_user_ids = Subscription.objects.filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\streams.py:1108:4
1107	
1108	    assert stream.recipient_id is not None
1109	    recipient_id: int = stream.recipient_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\user_settings.py:408:8
407	    if setting_name == "timezone":
408	        assert isinstance(setting_value, str)
409	        setting_value = canonicalize_timezone(setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\user_settings.py:412:8
411	        property_type = UserProfile.property_types[setting_name]
412	        assert isinstance(setting_value, property_type)
413	    setattr(user_profile, setting_name, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\user_settings.py:438:8
437	    if setting_name == "email_notifications_batching_period_seconds":
438	        assert isinstance(old_value, int)
439	        assert isinstance(setting_value, int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\user_settings.py:439:8
438	        assert isinstance(old_value, int)
439	        assert isinstance(setting_value, int)
440	        update_scheduled_email_notifications_time(user_profile, old_value, setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\user_settings.py:449:8
448	    if setting_name == "default_language":
449	        assert isinstance(setting_value, str)
450	        event["language_name"] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\user_settings.py:479:12
478	        if setting_name == "default_language":
479	            assert isinstance(setting_value, str)
480	            legacy_event["language_name"] = get_language_name(setting_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\actions\users.py:69:8
68	        # to this recipient (all private messages sent to the user).
69	        assert personal_recipient is not None
70	        personal_recipient.delete()

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\context_processors.py:140:29
139	    support_email = FromAddress.SUPPORT
140	    support_email_html_tag = SafeString(
141	        f'<a href="mailto:{escape(support_email)}">{escape(support_email)}</a>'
142	    )
143	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\import_util.py:204:38
203	def build_subscription(recipient_id: int, user_id: int, subscription_id: int) -> ZerverFieldsT:
204	    subscription = Subscription(color=random.choice(STREAM_COLORS), id=subscription_id)
205	    subscription_dict = model_to_dict(subscription, exclude=["user_profile", "recipient_id"])

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:559:15
558	
559	    response = requests.get(avatar_url + size_url_suffix, stream=True)
560	    with open(image_path, "wb") as image_file:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:648:15
647	
648	    response = requests.get(upload_url, stream=True)
649	    os.makedirs(os.path.dirname(upload_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\import_util.py:696:15
695	
696	    response = requests.get(emoji_url, stream=True)
697	    os.makedirs(os.path.dirname(upload_emoji_path), exist_ok=True)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\data_import\mattermost.py:11:0
10	import shutil
11	import subprocess
12	from typing import Any, Callable, Dict, List, Set, Tuple

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\data_import\mattermost.py:229:11
228	
229	    return hashlib.md5("".join(sorted(huddle_members)).encode()).hexdigest()
230	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\mattermost.py:345:23
344	                str(realm_id),
345	                format(random.randint(0, 255), "x"),
346	                secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\data_import\mattermost.py:436:18
435	        # html2text is GPL licensed, so run it as a subprocess.
436	        content = subprocess.check_output(["html2text"], input=content, text=True)
437	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\data_import\mattermost.py:436:18
435	        # html2text is GPL licensed, so run it as a subprocess.
436	        content = subprocess.check_output(["html2text"], input=content, text=True)
437	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\mattermost.py:830:12
829	        for post in mattermost_data["post"]["direct_post"]:
830	            assert "team" not in post
831	            user = username_to_user[post["user"]]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\rocketchat.py:408:19
407	            str(realm_id),
408	            format(random.randint(0, 255), "x"),
409	            secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\data_import\slack.py:1107:19
1106	            str(realm_id),
1107	            format(random.randint(0, 255), "x"),
1108	            secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1279:15
1278	
1279	    response = requests.get(icon_url, stream=True)
1280	    response_raw = response.raw

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1435:15
1434	    elif token.startswith("xoxb-"):
1435	        data = requests.get(
1436	            "https://slack.com/api/team.info", headers={"Authorization": f"Bearer {token}"}
1437	        )
1438	        if data.status_code != 200 or not data.json()["ok"]:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\zerver\data_import\slack.py:1457:11
1456	    token = kwargs.pop("token")
1457	    data = requests.get(slack_api_url, headers={"Authorization": f"Bearer {token}"}, params=kwargs)
1458	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\data_import\slack_message_conversion.py:121:4
120	    slack_usermention_match = re.search(SLACK_USERMENTION_REGEX, token, re.VERBOSE)
121	    assert slack_usermention_match is not None
122	    short_name = slack_usermention_match.group(4)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:92:4
91	
92	    assert request_notes.client is not None
93	    event = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:221:4
220	
221	    assert client_name is not None
222	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:504:8
503	    ) -> HttpResponse:
504	        assert request.user.is_authenticated
505	        if request.user.is_bot:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:993:8
992	
993	        assert isinstance(user, UserProfile)
994	        # User has completed 2FA verification

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\decorator.py:1016:8
1015	        page_params = context.setdefault("page_params", {})
1016	        assert isinstance(page_params, dict)
1017	        page_params["google_analytics_id"] = settings.GOOGLE_ANALYTICS_ID

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\filters.py:11:8
10	        post_data = SafeExceptionReporterFilter.get_post_parameters(self, request)
11	        assert isinstance(post_data, dict)
12	        filtered_post = post_data.copy()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:312:8
311	    def save(self, commit: bool = True) -> UserProfile:
312	        assert isinstance(self.user, UserProfile)
313	        do_change_password(self.user, self.cleaned_data["new_password1"], commit=commit)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:353:8
352	        # the request must not be None
353	        assert request is not None
354	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:465:12
464	        if username is not None and password:
465	            assert self.request is not None
466	            subdomain = get_subdomain(self.request)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:479:16
478	            except RateLimitedError as e:
479	                assert e.secs_to_freedom is not None
480	                secs_to_freedom = int(e.secs_to_freedom)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\forms.py:514:16
513	                # on different subdomain - so we just fall through to the default error.
514	                assert self.user_cache is None
515	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:59:8
58	    ) -> None:
59	        assert msg_type in ["stream", "private"]
60	        if msg_type == "stream" and topic is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:76:8
75	    def user_profiles(self) -> Sequence[UserProfile]:
76	        assert self.is_private()
77	        assert self._user_profiles is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:77:8
76	        assert self.is_private()
77	        assert self._user_profiles is not None
78	        return self._user_profiles

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:81:8
80	    def stream(self) -> Optional[Stream]:
81	        assert self.is_stream()
82	        return self._stream

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:85:8
84	    def stream_name(self) -> Optional[str]:
85	        assert self.is_stream()
86	        return self._stream_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:89:8
88	    def stream_id(self) -> Optional[int]:
89	        assert self.is_stream()
90	        return self._stream_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:93:8
92	    def topic(self) -> str:
93	        assert self.is_stream()
94	        assert self._topic is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:94:8
93	        assert self.is_stream()
94	        assert self._topic is not None
95	        return self._topic

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:179:8
178	    def for_private(emails: Sequence[str], realm: Realm) -> "Addressee":
179	        assert len(emails) > 0
180	        user_profiles = get_user_profiles(emails, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\addressee.py:188:8
187	    def for_user_ids(user_ids: Sequence[int], realm: Realm) -> "Addressee":
188	        assert len(user_ids) > 0
189	        user_profiles = get_user_profiles_by_ids(user_ids, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:126:4
125	        return get_avatar_url(hash_key, medium=medium)
126	    assert email is not None
127	    return _get_unversioned_gravatar_url(email, medium)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\avatar.py:137:4
136	    # avatar_url can return None if client_gravatar=True, however here we use the default value of False
137	    assert avatar is not None
138	    return urllib.parse.urljoin(user_profile.realm.uri, avatar)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_config.py:74:4
73	    bot_module = importlib.import_module(bot_module_name)
74	    assert bot_module.__file__ is not None
75	    bot_module_path = os.path.dirname(bot_module.__file__)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_lib.py:98:8
97	
98	        assert message["type"] == "private"
99	        # Ensure that it's a comma-separated list, even though the

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_storage.py:42:8
41	    for key, value in entries:
42	        assert isinstance(key, str), "Key type should be str."
43	        assert isinstance(value, str), "Value type should be str."

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bot_storage.py:43:8
42	        assert isinstance(key, str), "Key type should be str."
43	        assert isinstance(value, str), "Value type should be str."
44	        storage_size_difference += (len(key) + len(value)) - get_bot_storage_size(bot_profile, key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:139:8
138	        # and test and development environment users.
139	        assert user_profile.role == UserProfile.ROLE_MEMBER
140	        group_memberships_to_create.append(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:156:4
155	) -> None:
156	    assert model in [UserProfile, Stream]
157	    for obj in objects:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:158:8
157	    for obj in objects:
158	        assert isinstance(obj, model)
159	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\bulk_create.py:173:8
172	    for recipient in recipients:
173	        assert recipient.type == recipient_type
174	        result = objects_dict.get(recipient.type_id)

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\cache.py:119:17
118	    # Memcached keys should have a length of less than 250.
119	    KEY_PREFIX = hashlib.sha1(KEY_PREFIX.encode()).hexdigest() + ":"
120	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\cache_helpers.py:70:4
69	    store = session_engine.SessionStore(session_key=session.session_key)
70	    assert isinstance(store, SessionStore)
71	    items_for_remote_cache[store.cache_key] = store.decode(session.session_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\camo.py:9:4
8	    encoded_url = url.encode()
9	    assert settings.CAMO_KEY is not None
10	    encoded_camo_key = settings.CAMO_KEY.encode()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:259:4
258	    keys = rkeys + okeys
259	    assert len(keys) == len(set(keys))
260	    assert "type" in rkeys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:260:4
259	    assert len(keys) == len(set(keys))
260	    assert "type" in rkeys
261	    assert "id" not in keys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\data_types.py:261:4
260	    assert "type" in rkeys
261	    assert "id" not in keys
262	    return DictType(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\dev_ldap_directory.py:87:4
86	
87	    assert settings.FAKE_LDAP_MODE is not None
88	    mock_ldap.directory = directory or generate_dev_ldap_dir(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\digest.py:283:4
282	    # We expect a non-empty list of users all from the same realm.
283	    assert users
284	    realm = next(iter(users)).realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\digest.py:286:8
285	    for user in users:
286	        assert user.realm_id == realm.id
287	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\display_recipient.py:44:8
43	    if recipient_type == Recipient.STREAM:
44	        assert recipient_type_id is not None
45	        stream = Stream.objects.values("name").get(id=recipient_type_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:225:12
224	            content = part.get_payload(decode=True)
225	            assert isinstance(content, bytes)
226	            charset = charsets[idx]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:259:12
258	        else:
259	            assert html_content  # Needed for mypy. Ensured by the validating block above.
260	            return html_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:265:12
264	        else:
265	            assert plaintext_content  # Needed for mypy. Ensured by the validating block above.
266	            return plaintext_content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:446:4
445	
446	    assert recipient is not None
447	    if recipient.type == Recipient.STREAM:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:453:8
452	        display_recipient = get_display_recipient(recipient)
453	        assert not isinstance(display_recipient, str)
454	        recipient_str = display_recipient[0]["email"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_mirror.py:459:8
458	        display_recipient = get_display_recipient(recipient)
459	        assert not isinstance(display_recipient, str)
460	        emails = [user_dict["email"] for user_dict in display_recipient]

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\email_notifications.py:6:0
5	import re
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:13:0
12	
13	import lxml.html
14	from bs4 import BeautifulSoup

--------------------------------------------------
>> Issue: [B410:blacklist] Using builder to parse untrusted XML data is known to be vulnerable to XML attacks. Replace builder with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\email_notifications.py:20:0
19	from django.utils.translation import override as override_language
20	from lxml.html import builder as e
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:110:8
109	        # we assert that it does not.
110	        assert match is not None
111	        emoji_code = match.group("emoji_code")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:245:8
244	
245	        assert message.rendered_content is not None
246	        fragment = lxml.html.fragment_fromstring(message.rendered_content, create_parent=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:268:12
267	            display_recipient = get_display_recipient(message.recipient)
268	            assert not isinstance(display_recipient, str)
269	            narrow_link = get_narrow_url(user, message, display_recipient=display_recipient)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:357:8
356	    if message.recipient.type == Recipient.PERSONAL:
357	        assert stream is None
358	        assert display_recipient is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:358:8
357	        assert stream is None
358	        assert display_recipient is None
359	        return personal_narrow_url(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:364:8
363	    elif message.recipient.type == Recipient.HUDDLE:
364	        assert stream is None
365	        if display_recipient is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:367:8
366	            display_recipient = get_display_recipient(message.recipient)
367	        assert display_recipient is not None
368	        assert not isinstance(display_recipient, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:368:8
367	        assert display_recipient is not None
368	        assert not isinstance(display_recipient, str)
369	        other_user_ids = [r["id"] for r in display_recipient if r["id"] != user_profile.id]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:375:8
374	    else:
375	        assert display_recipient is None
376	        if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:431:4
430	    }
431	    assert len(recipients) == 1, f"Unexpectedly multiple recipients: {recipients!r}"
432	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_notifications.py:493:8
492	        # Make sure that this is a list of strings, not a string.
493	        assert not isinstance(display_recipient, str)
494	        other_recipients = [r["full_name"] for r in display_recipient if r["id"] != user_profile.id]

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\email_notifications.py:864:15
863	    # html2text is GPL licensed, so run it as a subprocess.
864	    markdown = subprocess.check_output(
865	        [os.path.join(sys.prefix, "bin", "html2text")], input=html, text=True
866	    ).strip()
867	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\email_validation.py:207:8
206	    for key, error_info in error_dict.items():
207	        assert key == email
208	        msg, deactivated = error_info

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:244:4
243	
244	    assert event["message_type"] == message_type
245	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:254:8
253	    if is_legacy:
254	        assert num_message_ids == 1
255	        keys.add("message_id")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:257:8
256	    else:
257	        assert isinstance(event["message_ids"], list)
258	        assert num_message_ids == len(event["message_ids"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:258:8
257	        assert isinstance(event["message_ids"], list)
258	        assert num_message_ids == len(event["message_ids"])
259	        keys.add("message_ids")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:261:4
260	
261	    assert set(event.keys()) == keys
262	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:281:4
280	    _check_has_zoom_token(var_name, event)
281	    assert event["value"] == value
282	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:451:4
450	
451	    assert ("email" in event) == has_email
452	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:453:4
452	
453	    assert isinstance(event["presence"], dict)
454	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:456:4
455	    # Our tests only have one presence value.
456	    assert len(event["presence"]) == 1
457	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:458:4
457	
458	    assert list(event["presence"].keys())[0] == presence_key
459	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:460:4
459	
460	    assert list(event["presence"].values())[0]["status"] == status
461	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:579:4
578	
579	    assert isinstance(event["bot"], dict)
580	    bot_type = event["bot"]["bot_type"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:667:4
666	
667	    assert isinstance(event["bot"], dict)
668	    assert {"user_id", field} == set(event["bot"].keys())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:668:4
667	    assert isinstance(event["bot"], dict)
668	    assert {"user_id", field} == set(event["bot"].keys())
669	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:721:4
720	    _check_realm_playgrounds(var_name, event)
721	    assert isinstance(event["realm_playgrounds"], list)
722	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:755:4
754	
755	    assert isinstance(event["realm_emoji"], dict)
756	    for k, v in event["realm_emoji"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:757:8
756	    for k, v in event["realm_emoji"].items():
757	        assert v["id"] == k
758	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:798:4
797	    # exercise that case, so we do strict validation for a single export here.
798	    assert isinstance(event["exports"], list)
799	    assert len(event["exports"]) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:799:4
798	    assert isinstance(event["exports"], list)
799	    assert len(event["exports"]) == 1
800	    export = event["exports"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:803:4
802	    # Now verify which fields have non-None values.
803	    assert has_export_url == (export["export_url"] is not None)
804	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:804:4
803	    assert has_export_url == (export["export_url"] is not None)
804	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)
805	    assert has_failed_timestamp == (export["failed_timestamp"] is not None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:805:4
804	    assert has_deleted_timestamp == (export["deleted_timestamp"] is not None)
805	    assert has_failed_timestamp == (export["failed_timestamp"] is not None)
806	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:870:4
869	
870	    assert prop == event["property"]
871	    value = event["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:874:8
873	    if prop == "plan_type":
874	        assert isinstance(value, int)
875	        assert "extra_data" in event

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:875:8
874	        assert isinstance(value, int)
875	        assert "extra_data" in event
876	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:878:4
877	
878	    assert "extra_data" not in event.keys()
879	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:881:8
880	    if prop in ["notifications_stream_id", "signup_notifications_stream_id", "org_type"]:
881	        assert isinstance(value, int)
882	        return

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:887:8
886	    if property_type in (bool, int, str):
887	        assert isinstance(value, property_type)
888	    elif property_type == (int, type(None)):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:889:8
888	    elif property_type == (int, type(None)):
889	        assert isinstance(value, int)
890	    elif property_type == (str, type(None)):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:891:8
890	    elif property_type == (str, type(None)):
891	        assert isinstance(value, str)
892	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:914:4
913	
914	    assert prop == event["property"]
915	    assert prop != "default_language"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:915:4
914	    assert prop == event["property"]
915	    assert prop != "default_language"
916	    assert prop in RealmUserDefault.property_types

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:916:4
915	    assert prop != "default_language"
916	    assert prop in RealmUserDefault.property_types
917	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:919:4
918	    prop_type = RealmUserDefault.property_types[prop]
919	    assert isinstance(event["value"], prop_type)
920	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1016:8
1015	    if event["property"] == "default":
1016	        assert isinstance(event["data"], dict)
1017	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1271:8
1270	    if prop == "description":
1271	        assert extra_keys == {"rendered_description"}
1272	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1272:8
1271	        assert extra_keys == {"rendered_description"}
1272	        assert isinstance(value, str)
1273	    elif prop == "email_address":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1274:8
1273	    elif prop == "email_address":
1274	        assert extra_keys == set()
1275	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1275:8
1274	        assert extra_keys == set()
1275	        assert isinstance(value, str)
1276	    elif prop == "invite_only":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1277:8
1276	    elif prop == "invite_only":
1277	        assert extra_keys == {"history_public_to_subscribers", "is_web_public"}
1278	        assert isinstance(value, bool)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1278:8
1277	        assert extra_keys == {"history_public_to_subscribers", "is_web_public"}
1278	        assert isinstance(value, bool)
1279	    elif prop == "message_retention_days":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1280:8
1279	    elif prop == "message_retention_days":
1280	        assert extra_keys == set()
1281	        if value is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1282:12
1281	        if value is not None:
1282	            assert isinstance(value, int)
1283	    elif prop == "name":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1284:8
1283	    elif prop == "name":
1284	        assert extra_keys == set()
1285	        assert isinstance(value, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1285:8
1284	        assert extra_keys == set()
1285	        assert isinstance(value, str)
1286	    elif prop == "stream_post_policy":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1287:8
1286	    elif prop == "stream_post_policy":
1287	        assert extra_keys == set()
1288	        assert value in Stream.STREAM_POST_POLICY_TYPES

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1288:8
1287	        assert extra_keys == set()
1288	        assert value in Stream.STREAM_POST_POLICY_TYPES
1289	    elif prop == "can_remove_subscribers_group_id":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1290:8
1289	    elif prop == "can_remove_subscribers_group_id":
1290	        assert extra_keys == set()
1291	        assert isinstance(value, int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1291:8
1290	        assert extra_keys == set()
1291	        assert isinstance(value, int)
1292	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1377:4
1376	    _check_subscription_update(var_name, event)
1377	    assert event["property"] == property
1378	    assert event["value"] == value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1378:4
1377	    assert event["property"] == property
1378	    assert event["value"] == value
1379	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1469:4
1468	
1469	    assert isinstance(setting_name, str)
1470	    if setting_name == "timezone":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1471:8
1470	    if setting_name == "timezone":
1471	        assert isinstance(setting, str)
1472	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1474:8
1473	        setting_type = UserProfile.property_types[setting_name]
1474	        assert isinstance(setting, setting_type)
1475	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1477:8
1476	    if setting_name == "default_language":
1477	        assert "language_name" in event
1478	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1479:8
1478	    else:
1479	        assert "language_name" not in event.keys()
1480	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1490:4
1489	
1490	    assert isinstance(setting_name, str)
1491	    if setting_name == "timezone":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1492:8
1491	    if setting_name == "timezone":
1492	        assert isinstance(value, str)
1493	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1495:8
1494	        setting_type = UserProfile.property_types[setting_name]
1495	        assert isinstance(value, setting_type)
1496	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1498:8
1497	    if setting_name == "default_language":
1498	        assert "language_name" in event
1499	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1500:8
1499	    else:
1500	        assert "language_name" not in event.keys()
1501	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1526:4
1525	    setting = event["setting"]
1526	    assert setting == desired_val
1527	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1528:4
1527	
1528	    assert isinstance(setting_name, str)
1529	    setting_type = UserProfile.notification_settings_legacy[setting_name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1530:4
1529	    setting_type = UserProfile.notification_settings_legacy[setting_name]
1530	    assert isinstance(setting, setting_type)
1531	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1635:8
1634	        expected_keys.update(tup[0] for tup in update_message_content_or_embedded_data_fields)
1635	        assert event["user_id"] is None
1636	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1637:8
1636	    else:
1637	        assert isinstance(event["user_id"], int)
1638	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1639:4
1638	
1639	    assert event["rendering_only"] == is_embedded_update_only
1640	    assert expected_keys == actual_keys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1640:4
1639	    assert event["rendering_only"] == is_embedded_update_only
1640	    assert expected_keys == actual_keys
1641	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1760:4
1759	
1760	    assert isinstance(event["data"], dict)
1761	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1762:4
1761	
1762	    assert set(event["data"].keys()) == {field}
1763	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\event_schema.py:1808:4
1807	
1808	    assert set(event.keys()) == {"id", "type", "user_id"} | fields

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:132:8
131	    if realm is None:
132	        assert user_profile is not None
133	        realm = user_profile.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:418:8
417	    else:
418	        assert spectator_requested_language is not None
419	        # When UserProfile=None, we want to serve the values for various

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:650:8
649	        # To ensure we have the correct user state set.
650	        assert state["is_admin"] is False
651	        assert state["is_owner"] is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:651:8
650	        assert state["is_admin"] is False
651	        assert state["is_owner"] is False
652	        assert state["is_guest"] is True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:652:8
651	        assert state["is_owner"] is False
652	        assert state["is_guest"] is True
653	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:774:12
773	                    break
774	            assert state_draft_idx is not None
775	            _draft_update_action(state_draft_idx)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:780:12
779	            # Since bulk addition of scheduled messages will not be used by a normal user.
780	            assert len(event["scheduled_messages"]) == 1
781	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1332:12
1331	        if event["setting_name"] != "timezone":
1332	            assert event["setting_name"] in UserProfile.display_settings_legacy
1333	        state[event["setting_name"]] = event["setting"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1335:8
1334	    elif event["type"] == "update_global_notifications":
1335	        assert event["notification_name"] in UserProfile.notification_settings_legacy
1336	        state[event["notification_name"]] = event["setting"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1341:12
1340	        if event["property"] != "timezone":
1341	            assert event["property"] in UserProfile.property_types
1342	        if event["property"] in {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1494:8
1493	        # TODO: Unify the two fetch_initial_state_data code paths.
1494	        assert client_gravatar is False
1495	        assert include_subscribers is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1495:8
1494	        assert client_gravatar is False
1495	        assert include_subscribers is False
1496	        assert include_streams is False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\events.py:1496:8
1495	        assert include_subscribers is False
1496	        assert include_streams is False
1497	        ret = fetch_initial_state_data(

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\export.py:14:0
13	import shutil
14	import subprocess
15	import tempfile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:334:4
333	
334	    assert all_tables_db == ALL_ZULIP_TABLES, error_message
335	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:335:4
334	    assert all_tables_db == ALL_ZULIP_TABLES, error_message
335	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message
336	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:336:4
335	    assert NON_EXPORTED_TABLES.issubset(ALL_ZULIP_TABLES), error_message
336	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
337	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:337:4
336	    assert IMPLICIT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
337	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
338	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES), error_message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:338:4
337	    assert ATTACHMENT_TABLES.issubset(ALL_ZULIP_TABLES), error_message
338	    assert ANALYTICS_TABLES.issubset(ALL_ZULIP_TABLES), error_message
339	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:380:4
379	
380	    assert output_file.endswith(".json")
381	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:435:12
434	                continue
435	            assert isinstance(dt, datetime.datetime)
436	            assert not timezone_is_naive(dt)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:436:12
435	            assert isinstance(dt, datetime.datetime)
436	            assert not timezone_is_naive(dt)
437	            item[field] = dt.timestamp()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:473:8
472	    ) -> None:
473	        assert table or custom_tables
474	        self.table = table

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:491:12
490	        if self.include_rows:
491	            assert self.include_rows.endswith("_id__in")
492	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:495:12
494	            # enforce a naming convention
495	            assert self.custom_fetch.__name__.startswith("custom_fetch_")
496	            if self.normal_parent is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:565:8
564	    else:
565	        assert (
566	            table is not None
567	        ), """
568	            You must specify config.custom_tables if you
569	            are not specifying config.table"""
570	        exported_tables = [table]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:598:8
597	            logging.info("Deleted temporary %s", t)
598	        assert table is not None
599	        response[table] = data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:602:8
601	    elif config.use_all:
602	        assert model is not None
603	        query = model.objects.all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:612:8
611	        model = config.model
612	        assert parent is not None
613	        assert parent.table is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:613:8
612	        assert parent is not None
613	        assert parent.table is not None
614	        assert config.include_rows is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:614:8
613	        assert parent.table is not None
614	        assert config.include_rows is not None
615	        parent_ids = [r["id"] for r in response[parent.table]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:619:8
618	            filter_params.update(config.filter_args)
619	        assert model is not None
620	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:643:8
642	        model = config.model
643	        assert model is not None
644	        # This will be a tuple of the form ('zerver_article', 'blog').

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:657:8
656	    if rows is not None:
657	        assert table is not None  # Hint for mypy
658	        response[table] = make_raw(rows, exclude=config.exclude)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:997:16
996	            if row["id"] in exportable_user_ids:
997	                assert not row["is_mirror_dummy"]
998	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1159:4
1158	    See write_message_partial_for_query for more context."""
1159	    assert input_path.endswith((".partial", ".locked"))
1160	    assert output_path.endswith(".json")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1160:4
1159	    assert input_path.endswith((".partial", ".locked"))
1160	    assert output_path.endswith(".json")
1161	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1321:8
1320	        # overhead.
1321	        assert len(message_ids.intersection(all_message_ids)) == 0
1322	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1401:8
1400	        users = list(UserProfile.objects.filter(realm=realm))
1401	        assert attachments is not None
1402	        realm_emojis = list(RealmEmoji.objects.filter(realm_id=realm.id))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1410:8
1409	    if settings.LOCAL_UPLOADS_DIR:
1410	        assert settings.LOCAL_FILES_DIR
1411	        assert settings.LOCAL_AVATARS_DIR

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1411:8
1410	        assert settings.LOCAL_FILES_DIR
1411	        assert settings.LOCAL_AVATARS_DIR
1412	        # Small installations and developers will usually just store files locally.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:1842:8
1841	    if not settings.TEST_SUITE:
1842	        assert threads >= 1
1843	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\export.py:1909:4
1908	    tarball_path = output_dir.rstrip("/") + ".tar.gz"
1909	    subprocess.check_call(
1910	        [
1911	            "tar",
1912	            f"-czf{tarball_path}",
1913	            f"-C{os.path.dirname(output_dir)}",
1914	            os.path.basename(output_dir),
1915	        ]
1916	    )
1917	    return tarball_path

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1909:4
1908	    tarball_path = output_dir.rstrip("/") + ".tar.gz"
1909	    subprocess.check_call(
1910	        [
1911	            "tar",
1912	            f"-czf{tarball_path}",
1913	            f"-C{os.path.dirname(output_dir)}",
1914	            os.path.basename(output_dir),
1915	        ]
1916	    )
1917	    return tarball_path

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\export.py:1969:18
1968	
1969	        process = subprocess.Popen(arguments)
1970	        pids[process.pid] = shard_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:2101:4
2100	
2101	    assert id_field == "id" or id_field.endswith("_id")
2102	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\export.py:2327:8
2326	
2327	        assert acting_user is not None
2328	        exports_dict[export.id] = dict(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:28:22
27	    for _ in itertools.repeat(None, num_single_word_topics):
28	        topics.append(random.choice(config["nouns"]))
29	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:36:27
35	    for _ in itertools.repeat(None, num_topics - num_single_word_topics):
36	        generated_topic = [random.choice(config[pos]) for pos in sentence]
37	        topic = " ".join(filter(None, generated_topic))

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:44:7
43	    # experience perfectly.
44	    if random.random() < 0.15:
45	        resolved_topic_probability = 0.5

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:51:11
50	    for topic in topics:
51	        if random.random() < resolved_topic_probability:
52	            final_topics.append(RESOLVED_TOPIC_PREFIX + topic)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:163:12
162	    vals = text.split()
163	    start = random.randrange(len(vals))
164	    end = random.randrange(len(vals) - start) + start

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:164:10
163	    start = random.randrange(len(vals))
164	    end = random.randrange(len(vals) - start) + start
165	    vals[start] = mode + vals[start]

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:173:12
172	    vals = text.split()
173	    start = random.randrange(len(vals))
174	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\generate_test_data.py:181:12
180	    vals = text.split()
181	    start = random.randrange(len(vals))
182	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\home.py:146:8
145	        client = RequestNotes.get_notes(request).client
146	        assert client is not None
147	        register_ret = do_events_register(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\home.py:241:8
240	        page_params["max_message_id"] = max_message_id
241	        assert isinstance(page_params["user_settings"], dict)
242	        page_params["user_settings"]["enable_desktop_notifications"] = False

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:3:0
2	
3	import lxml.html
4	from lxml.html.diff import htmldiff

--------------------------------------------------
>> Issue: [B410:blacklist] Using htmldiff to parse untrusted XML data is known to be vulnerable to XML attacks. Replace htmldiff with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\html_diff.py:4:0
3	import lxml.html
4	from lxml.html.diff import htmldiff
5	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:455:4
454	    # See comments in bulk_import_user_message_data.
455	    assert "usermessage" not in related_table
456	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:541:12
540	            realm_emoji_row = realm_emoji_dct[new_realm_emoji_id]
541	            assert realm_emoji_row["name"] == row["emoji_name"]
542	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:633:4
632	    # memory errors. We don't even use ids from ID_MAP.
633	    assert "usermessage" not in table
634	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:834:16
833	                # a user to.
834	                assert default_user_profile_id is not None
835	                metadata["user_profile_id"] = str(default_user_profile_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:865:12
864	        else:
865	            assert settings.LOCAL_UPLOADS_DIR is not None
866	            assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:866:12
865	            assert settings.LOCAL_UPLOADS_DIR is not None
866	            assert settings.LOCAL_AVATARS_DIR is not None
867	            assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:867:12
866	            assert settings.LOCAL_AVATARS_DIR is not None
867	            assert settings.LOCAL_FILES_DIR is not None
868	            if processing_avatars or processing_emojis or processing_realm_icons:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:888:12
887	            _cache = cache._cache  # type: ignore[attr-defined] # not in stubs
888	            assert isinstance(_cache, bmemcached.Client)
889	            _cache.disconnect_all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:1070:12
1069	        if realm_emoji.author_id is None:
1070	            assert first_user_profile is not None
1071	            realm_emoji.author_id = first_user_profile.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\import_realm.py:1486:12
1485	        for row in data["zerver_usermessage"]:
1486	            assert row["message"] in message_id_map
1487	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\initial_password.py:16:8
15	        # self.login, which will call this function.
16	        assert settings.DEVELOPMENT, "initial_password_salt should not be set in production."
17	        encoded_key = (settings.INITIAL_PASSWORD_SALT + email).encode()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\integrations.py:236:8
235	    def url_object(self) -> URLResolver:
236	        assert self.function is not None
237	        return path(self.url, self.function)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\integrations.py:319:8
318	    def __init__(self, name: str, *args: Any, **kwargs: Any) -> None:
319	        assert kwargs.get("client_name") is None
320	        client_name = self.DEFAULT_CLIENT_NAME.format(name=name.title())

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\zerver\lib\logging_util.py:85:56
84	                        tb = str(record)
85	                    key = type(self).__name__.upper() + hashlib.sha1(tb.encode()).hexdigest()
86	                    duplicate = cache.get(key) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\logging_util.py:254:8
253	        client = RequestNotes.get_notes(request).client
254	        assert client is not None
255	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\logging_util.py:256:8
255	
256	        assert request.user.is_authenticated
257	        record.user = f"{request.user.delivery_email} ({request.user.realm.string_id})"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\management.py:210:16
209	            else:
210	                assert settings.DEVELOPMENT
211	                logging.info("Password will be available via `./manage.py print_initial_password`.")

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\__init__.py:30:0
29	from urllib.parse import parse_qs, urlencode, urljoin, urlsplit
30	from xml.etree.ElementTree import Element, SubElement
31	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.etree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\markdown\__init__.py:35:0
34	import dateutil.tz
35	import lxml.etree
36	import markdown

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:575:12
574	            url = img.get("src")
575	            assert url is not None
576	            if is_static_or_current_realm_url(url, self.zmd.zulip_realm):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:984:16
983	                elem = url_to_a(db_data, item["url"], item["text"])
984	                assert isinstance(elem, Element)
985	            else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1062:12
1061	            url = e.get("href")
1062	            assert url is not None
1063	            return (url, e.text)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1092:12
1091	        elif parent.tag == "p":
1092	            assert grandparent is not None
1093	            parent_index = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:1856:16
1855	            elif user is not None:
1856	                assert isinstance(user, FullNameInfo)
1857	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\__init__.py:2043:8
2042	        href = el.get("href")
2043	        assert href is not None
2044	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\markdown\api_arguments_table_generator.py:151:16
150	                # Any path variable is required
151	                assert argument["required"]
152	                required_string = "required in path"

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\markdown\fenced_code.py:81:0
80	
81	import lxml.html
82	from django.utils.html import escape

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\include.py:4:0
3	from typing import List, Match
4	from xml.etree.ElementTree import Element
5	

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\nested_code_blocks.py:2:0
1	from typing import Any, List, Mapping, Optional, Tuple
2	from xml.etree.ElementTree import Element, SubElement
3	

--------------------------------------------------
>> Issue: [B405:blacklist] Using Element to parse untrusted XML data is known to be vulnerable to XML attacks. Replace Element with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\zerver\lib\markdown\static.py:2:0
1	from typing import Any
2	from xml.etree.ElementTree import Element
3	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\mdiff.py:3:0
2	import os
3	import subprocess
4	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\mdiff.py:18:11
17	    command = ["node", mdiff_path, output, expected_output]
18	    diff = subprocess.check_output(command, text=True)
19	    return diff

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:554:12
553	            obj["last_edit_timestamp"] = datetime_to_timestamp(last_edit_time)
554	            assert edit_history_json is not None
555	            edit_history: List[EditHistoryEvent] = orjson.loads(edit_history_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:573:12
572	
573	            assert message is not None  # Hint for mypy.
574	            # It's unfortunate that we need to have side effects on the message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:650:12
649	        elif recipient_type in (Recipient.HUDDLE, Recipient.PERSONAL):
650	            assert not isinstance(display_recipient, str)
651	            display_type = "private"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:798:4
797	    # get_web_public_streams_queryset
798	    assert stream.is_web_public
799	    assert not stream.deactivated

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:799:4
798	    assert stream.is_web_public
799	    assert not stream.deactivated
800	    assert not stream.invite_only

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:800:4
799	    assert not stream.deactivated
800	    assert not stream.invite_only
801	    assert stream.history_public_to_subscribers

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:801:4
800	    assert not stream.invite_only
801	    assert stream.history_public_to_subscribers
802	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:836:8
835	    else:
836	        assert stream.recipient_id == message.recipient_id
837	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:971:4
970	    # str is for streams.
971	    assert not isinstance(display_recipient, str)
972	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:1009:8
1008	    return list(
1009	        UserMessage.objects.filter(
1010	            user_profile=user_profile,
1011	        )
1012	        .extra(
1013	            where=[UserMessage.where_starred()],
1014	        )
1015	        .order_by(

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\message.py:1052:20
1051	        # At page load we need all unread messages.
1052	        user_msgs = user_msgs.extra(
1053	            where=[UserMessage.where_unread()],
1054	        )
1055	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\message.py:1640:4
1639	        raise RequestVariableConversionError(setting_name, value)
1640	    assert isinstance(value, int)
1641	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:17:4
16	    the bitwise xor of the two hex strings."""
17	    assert len(bytes_a) == len(bytes_b)
18	    return "".join(f"{int(x, 16) ^ int(y, 16):x}" for x, y in zip(bytes_a, bytes_b))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:32:4
31	def otp_encrypt_api_key(api_key: str, otp: str) -> str:
32	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
33	    hex_encoded_api_key = ascii_to_hex(api_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:34:4
33	    hex_encoded_api_key = ascii_to_hex(api_key)
34	    assert len(hex_encoded_api_key) == UserProfile.API_KEY_LENGTH * 2
35	    return xor_hex_strings(hex_encoded_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:39:4
38	def otp_decrypt_api_key(otp_encrypted_api_key: str, otp: str) -> str:
39	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
40	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:40:4
39	    assert len(otp) == UserProfile.API_KEY_LENGTH * 2
40	    assert len(otp_encrypted_api_key) == UserProfile.API_KEY_LENGTH * 2
41	    hex_encoded_api_key = xor_hex_strings(otp_encrypted_api_key, otp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\mobile_auth_otp.py:47:8
46	    try:
47	        assert len(otp) == UserProfile.API_KEY_LENGTH * 2
48	        [int(c, 16) for c in otp]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:329:8
328	        # This operator does not support is_web_public_query.
329	        assert not self.is_web_public_query
330	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:330:8
329	        assert not self.is_web_public_query
330	        assert self.user_profile is not None
331	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:342:8
341	        # This operator class does not support is_web_public_query.
342	        assert not self.is_web_public_query
343	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:343:8
342	        assert not self.is_web_public_query
343	        assert self.user_profile is not None
344	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:412:12
411	            # a Zephyr realm are private, so that doesn't happen.
412	            assert not stream.is_public()
413	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:417:12
416	            # stream name, this will always match
417	            assert m is not None
418	            base_stream_name = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:428:8
427	        recipient = stream.recipient
428	        assert recipient is not None
429	        cond = column("recipient_id", Integer) == recipient.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:452:12
451	            # Since the regex has a `.*` in it, this will always match
452	            assert m is not None
453	            base_topic = m.group(1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:520:8
519	        # This operator does not support is_web_public_query.
520	        assert not self.is_web_public_query
521	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:521:8
520	        assert not self.is_web_public_query
521	        assert self.user_profile is not None
522	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:613:8
612	        # This operator does not support is_web_public_query.
613	        assert not self.is_web_public_query
614	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:614:8
613	        assert not self.is_web_public_query
614	        assert self.user_profile is not None
615	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:656:8
655	        # This operator does not support is_web_public_query.
656	        assert not self.is_web_public_query
657	        assert self.user_profile is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:657:8
656	        assert not self.is_web_public_query
657	        assert self.user_profile is not None
658	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:808:8
807	    if is_web_public_query:
808	        assert user_profile is None
809	        return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:811:4
810	
811	    assert user_profile is not None
812	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:899:8
898	    if not need_user_message:
899	        assert need_message
900	        query = select(column("id", Integer).label("message_id")).select_from(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\narrow.py:906:4
905	
906	    assert user_profile is not None
907	    if need_message:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notification_data.py:28:12
27	        if self.pm_email_notify or self.pm_push_notify:
28	            assert not (self.stream_email_notify or self.stream_push_notify)
29	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\notification_data.py:31:12
30	        if self.stream_email_notify or self.stream_push_notify:
31	            assert not (self.pm_email_notify or self.pm_push_notify)
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\outgoing_webhook.py:206:4
205	    content = response_data.get("content")
206	    assert content
207	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\outgoing_webhook.py:263:4
262	    bot_owner = bot.bot_owner
263	    assert bot_owner is not None
264	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\push_notifications.py:12:0
11	import gcm
12	import lxml.html
13	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:72:8
71	    def __init__(self, user_id: Optional[int] = None, user_uuid: Optional[str] = None) -> None:
72	        assert user_id is not None or user_uuid is not None
73	        self.user_id = user_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:90:12
89	        else:
90	            assert self.user_id is not None and self.user_uuid is not None
91	            return Q(user_uuid=self.user_uuid) | Q(user_id=self.user_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:206:8
205	    if remote:
206	        assert settings.ZILENCER_ENABLED
207	        DeviceTokenClass: Type[AbstractPushDeviceToken] = RemotePushDeviceToken

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:423:8
422	    if remote:
423	        assert settings.ZILENCER_ENABLED
424	        DeviceTokenClass: Type[AbstractPushDeviceToken] = RemotePushDeviceToken

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:501:4
500	    response_data = send_json_to_push_bouncer("POST", "push/notify", post_data)
501	    assert isinstance(response_data["total_android_devices"], int)
502	    assert isinstance(response_data["total_apple_devices"], int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:502:4
501	    assert isinstance(response_data["total_android_devices"], int)
502	    assert isinstance(response_data["total_apple_devices"], int)
503	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:678:8
677	    else:
678	        assert message.is_stream_message() and trigger == NotificationTriggers.STREAM_PUSH
679	        return f"New stream message from {sender_str} in #{display_recipient}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:792:8
791	    if mentioned_user_group_id is not None:
792	        assert mentioned_user_group_name is not None
793	        data["mentioned_user_group_id"] = mentioned_user_group_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:816:8
815	        recipients = get_display_recipient(message.recipient)
816	        assert isinstance(recipients, list)
817	        return ", ".join(sorted(r["full_name"] for r in recipients))

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\push_notifications.py:863:8
862	    return (
863	        UserMessage.objects.filter(user_profile=user_profile)
864	        .extra(where=[UserMessage.where_active_push_notification()])
865	        .exclude(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:891:4
890	
891	    assert message.rendered_content is not None
892	    with override_language(user_profile.default_language):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\push_notifications.py:920:4
919	    )
920	    assert message.rendered_content is not None
921	    with override_language(user_profile.default_language):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:170:12
169	            self._connect()
170	            assert self.channel is not None
171	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:172:12
171	        else:
172	            assert self.channel is not None
173	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:204:20
203	                if body is not None:
204	                    assert method is not None
205	                    events.append(orjson.loads(body))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:210:24
209	                    if events:
210	                        assert max_processed is not None
211	                        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:225:8
224	    def local_queue_size(self) -> int:
225	        assert self.channel is not None
226	        return self.channel.get_waiting_message_count() + len(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:231:8
230	    def stop_consuming(self) -> None:
231	        assert self.channel is not None
232	        assert self.is_consuming

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:232:8
231	        assert self.channel is not None
232	        assert self.is_consuming
233	        self.is_consuming = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:330:8
329	    def _on_open(self, connection: pika.connection.Connection) -> None:
330	        assert self.connection is not None
331	        self._connection_failure_count = 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:353:12
352	        def set_qos(frame: Any) -> None:
353	            assert self.channel is not None
354	            self.queues.add(queue_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:358:12
357	        def finish(frame: Any) -> None:
358	            assert self.channel is not None
359	            callback(self.channel)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:368:12
367	
368	            assert self.channel is not None
369	            self.channel.queue_declare(queue=queue_name, durable=True, callback=set_qos)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:371:12
370	        else:
371	            assert self.channel is not None
372	            callback(self.channel)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:387:12
386	        ) -> None:
387	            assert method.delivery_tag is not None
388	            callback([orjson.loads(body)])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:391:8
390	
391	        assert batch_size == 1
392	        assert timeout is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\queue.py:392:8
391	        assert batch_size == 1
392	        assert timeout is None
393	        self.consumers[queue_name].add(wrapped_consumer)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:319:8
318	
319	        assert rules
320	        for time_window, max_count in rules:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:388:8
387	        """Returns a tuple of (rate_limited, time_till_free)"""
388	        assert rules
389	        list_key, set_key, blocking_key = cls.get_keys(entity_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:508:12
507	        if over_limit:
508	            assert not remaining
509	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rate_limiter.py:591:4
590	    ip_addr = request.META["REMOTE_ADDR"]
591	    assert ip_addr
592	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\recipient_users.py:27:8
26	        # message recipients of the message.
27	        assert forwarder_user_profile is not None
28	        if forwarder_user_profile.id not in recipient_profiles_map:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\recipient_users.py:36:4
35	
36	    assert recipient_profiles_map
37	    if len(recipient_profiles_map) == 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\redis_utils.py:82:4
81	def validate_key_fits_format(key: str, key_format: str) -> None:
82	    assert "{token}" in key_format
83	    regex = key_format.format(token=r"[a-zA-Z0-9]+")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-zA-Z0-9]+'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\redis_utils.py:83:12
82	    assert "{token}" in key_format
83	    regex = key_format.format(token=r"[a-zA-Z0-9]+")
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\remote_server.py:54:4
53	    """
54	    assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
55	    assert settings.ZULIP_ORG_ID is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\remote_server.py:55:4
54	    assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
55	    assert settings.ZULIP_ORG_ID is not None
56	    assert settings.ZULIP_ORG_KEY is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\remote_server.py:56:4
55	    assert settings.ZULIP_ORG_ID is not None
56	    assert settings.ZULIP_ORG_KEY is not None
57	    url = urllib.parse.urljoin(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:191:8
190	
191	        assert converter is None or (
192	            json_validator is None and str_validator is None
193	        ), "converter and json_validator are mutually exclusive"
194	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:194:8
193	        ), "converter and json_validator are mutually exclusive"
194	        assert (
195	            json_validator is None or str_validator is None
196	        ), "json_validator and str_validator are mutually exclusive"
197	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:383:16
382	                # or don't declare them using REQ.
383	                assert func_var_name in kwargs
384	            if func_var_name in kwargs:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:386:12
385	                continue
386	            assert func_var_name is not None
387	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:398:16
397	                # This is a view bug, not a user error, and thus should throw a 500.
398	                assert param.argument_type is None, "Invalid argument type"
399	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:405:20
404	                for req_var in post_var_names:
405	                    assert req_var is not None
406	                    if req_var in request.POST:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\request.py:422:20
421	                    post_var_name = param.post_var_name
422	                    assert post_var_name is not None
423	                    if param.default is _REQ.NotSpecified:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\response.py:62:8
61	        """Set the content for the response."""
62	        assert isinstance(HttpResponse.content, property)
63	        assert HttpResponse.content.fset is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\response.py:63:8
62	        assert isinstance(HttpResponse.content, property)
63	        assert HttpResponse.content.fset is not None
64	        HttpResponse.content.fset(self, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rest.py:99:12
98	            handler, view_flags = entry
99	            assert callable(handler)
100	            assert isinstance(view_flags, set)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rest.py:100:12
99	            assert callable(handler)
100	            assert isinstance(view_flags, set)
101	            return handler, view_flags

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\rest.py:102:8
101	            return handler, view_flags
102	        assert callable(entry)
103	        return entry, set()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:135:4
134	    # (such as UserMessage, Reaction, and Attachment) inside the same transaction.atomic() block.
135	    assert type in (ArchiveTransaction.MANUAL, ArchiveTransaction.RETENTION_POLICY_BASED)
136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:190:4
189	) -> int:
190	    assert message_retention_days != -1
191	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:221:4
220	    message_retention_days = realm.message_retention_days
221	    assert message_retention_days != -1
222	    check_date = timezone_now() - timedelta(days=message_retention_days)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:256:4
255	def move_models_with_message_key_to_archive(msg_ids: List[int]) -> None:
256	    assert len(msg_ids) > 0
257	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:282:4
281	def move_attachments_to_archive(msg_ids: List[int]) -> None:
282	    assert len(msg_ids) > 0
283	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:300:4
299	def move_attachment_messages_to_archive(msg_ids: List[int]) -> None:
300	    assert len(msg_ids) > 0
301	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:373:12
372	        else:
373	            assert realm.message_retention_days != -1
374	            retention_policy_dict[stream.id] = realm.message_retention_days

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:379:8
378	    for recipient in recipients:
379	        assert recipient is not None
380	        message_count += archive_messages_by_recipient(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\retention.py:675:4
674	        raise RequestVariableConversionError("message_retention_days", value)
675	    assert isinstance(value, int)
676	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\safe_session_cached_db.py:20:8
19	    def save(self, must_create: bool = False) -> None:
20	        assert not get_connection().in_atomic_block
21	        super().save(must_create)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\safe_session_cached_db.py:24:8
23	    def delete(self, session_key: Optional[str] = None) -> None:
24	        assert not get_connection().in_atomic_block
25	        super().delete(session_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:37:8
36	        # shouldn't be called with request being None.
37	        assert request is not None
38	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:140:8
139	        email = d.get("userName")
140	        assert isinstance(email, str)
141	        self.change_delivery_email(email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:153:12
152	        if full_name:
153	            assert isinstance(full_name, str)
154	            self.change_full_name(full_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:166:12
165	        if active is not None:
166	            assert isinstance(active, bool)
167	            self.change_is_active(active)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:202:12
201	            # overridden upstream method.
202	            assert path is not None
203	            value = {path: value}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:205:8
204	
205	        assert isinstance(value, dict)
206	        for path, val in (value or {}).items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:208:16
207	            if path.first_path == ("userName", None, None):
208	                assert isinstance(val, str)
209	                self.change_delivery_email(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:213:16
212	                # for updates via PUT.
213	                assert isinstance(val, str)
214	                self.change_full_name(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:216:16
215	            elif path.first_path == ("active", None, None):
216	                assert isinstance(val, bool)
217	                self.change_is_active(val)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:230:8
229	        realm = RequestNotes.get_notes(self._request).realm
230	        assert realm is not None
231	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:267:12
266	        if self.is_new_user():
267	            assert full_name_new_value is not None
268	            self.obj = do_create_user(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:328:8
327	        realm = RequestNotes.get_notes(request).realm
328	        assert realm is not None
329	        return {"realm_id": realm.id, "is_bot": False}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim.py:343:4
342	    realm = RequestNotes.get_notes(request).realm
343	    assert realm is not None
344	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim_filter.py:58:8
57	        """
58	        assert request is not None
59	        realm = RequestNotes.get_notes(request).realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\scim_filter.py:60:8
59	        realm = RequestNotes.get_notes(request).realm
60	        assert realm is not None
61	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:68:12
67	        if language is None:
68	            assert user_profile is not None
69	            language = user_profile.default_language

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:87:4
86	    # Callers should pass exactly one of to_user_id and to_email.
87	    assert (to_user_ids is None) ^ (to_emails is None)
88	    if to_user_ids is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:91:12
90	        if realm is None:
91	            assert len({to_user.realm_id for to_user in to_users}) == 1
92	            realm = to_users[0].realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:119:4
118	
119	    assert settings.STATIC_URL is not None
120	    context = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:306:8
305	        connection = get_connection()
306	        assert connection is not None
307	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:325:12
324	        try:
325	            assert connection.connection is not None
326	            status = connection.connection.noop()[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:369:4
368	
369	    assert (to_user_ids is None) ^ (to_emails is None)
370	    with transaction.atomic():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:385:16
384	            else:
385	                assert to_emails is not None
386	                assert len(to_emails) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\send_email.py:386:16
385	                assert to_emails is not None
386	                assert len(to_emails) == 1
387	                email.address = parseaddr(to_emails[0])[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\sessions.py:27:8
26	        pk = get_user_model()._meta.pk
27	        assert pk is not None
28	        return pk.to_python(session_dict[SESSION_KEY])

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\zerver\lib\singleton_bmemcached.py:1:0
1	import pickle
2	from functools import lru_cache
3	from typing import Any, Dict

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\zerver\lib\singleton_bmemcached.py:10:32
9	def _get_bmemcached(location: str, params: bytes) -> BMemcached:
10	    return BMemcached(location, pickle.loads(params))  # noqa: S301
11	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:156:4
155	    """
156	    assert user_profile.last_active_message_id is not None
157	    all_stream_subs = list(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:198:12
197	        if stream_subscription_logs[-1].event_type == RealmAuditLog.SUBSCRIPTION_DEACTIVATED:
198	            assert stream_subscription_logs[-1].event_last_message_id is not None
199	            if (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\soft_deactivation.py:260:8
259	        last_message = Message.objects.last()
260	        assert last_message is not None
261	        user_profile.last_active_message_id = last_message.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:98:8
97	    for row in list(query):
98	        assert row["color"] is not None
99	        result[row["user_profile_id"]].add(row["color"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:227:8
226	        # Our caller should only pass us private streams.
227	        assert stream.invite_only
228	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\stream_subscription.py:262:4
261	    # backwards-compatibility problem in our view.
262	    assert not notification_settings_null
263	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:83:4
82	
83	    assert policy_name is not None
84	    return policy_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:140:4
139	
140	    assert can_remove_subscribers_group is not None
141	    with transaction.atomic():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:396:8
395	    try:
396	        assert stream.recipient_id is not None
397	        sub = Subscription.objects.get(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:619:4
618	    group_allowed_to_remove_subscribers = stream.can_remove_subscribers_group
619	    assert group_allowed_to_remove_subscribers is not None
620	    return is_user_in_group(group_allowed_to_remove_subscribers, user_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:683:8
682	        # caller, but it makes sense to verify anyway.
683	        assert stream_name == stream_name.strip()
684	        check_stream_name(stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\streams.py:877:12
876	            bot_owner = user_profile.bot_owner
877	            assert bot_owner is not None
878	            owner_stream_ids = get_subscribed_stream_ids_for_user(bot_owner)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\subdomains.py:59:4
58	def is_static_or_current_realm_url(url: str, realm: Optional[Realm]) -> bool:
59	    assert settings.STATIC_URL is not None
60	    split_url = urllib.parse.urlsplit(url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\subdomains.py:87:8
86	        public_upload_root_url = get_public_upload_root_url()
87	        assert public_upload_root_url.endswith("/")
88	        if url.startswith(public_upload_root_url):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\subscription_info.py:496:16
495	            for stream_dict in lst:
496	                assert isinstance(stream_dict["stream_id"], int)
497	                stream_id = stream_dict["stream_id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\subscription_info.py:501:12
500	        for slim_stream_dict in never_subscribed:
501	            assert isinstance(slim_stream_dict["stream_id"], int)
502	            stream_id = slim_stream_dict["stream_id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\templates.py:163:4
162	    jinja = engines["Jinja2"]
163	    assert isinstance(jinja, Jinja2)
164	    if markdown_file_path.startswith("/"):

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\lib\templates.py:175:15
174	    if context is None:
175	        return mark_safe(html)  # noqa: S308
176	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\lib\templates.py:175:15
174	    if context is None:
175	        return mark_safe(html)  # noqa: S308
176	

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\lib\templates.py:177:11
176	
177	    return mark_safe(jinja.from_string(html).render(context))  # noqa: S308
178	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\zerver\lib\templates.py:177:11
176	
177	    return mark_safe(jinja.from_string(html).render(context))  # noqa: S308
178	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_classes.py:5:0
4	import shutil
5	import subprocess
6	import tempfile

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\lib\test_classes.py:29:0
28	
29	import lxml.html
30	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:163:8
162	        # Clean up local uploads directory after tests:
163	        assert settings.LOCAL_UPLOADS_DIR is not None
164	        if os.path.exists(settings.LOCAL_UPLOADS_DIR):

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '[a-z0-9_]{24}'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\lib\test_classes.py:219:30
218	    DEFAULT_SUBDOMAIN = "zulip"
219	    TOKENIZED_NOREPLY_REGEX = settings.TOKENIZED_NOREPLY_EMAIL_ADDRESS.format(token="[a-z0-9_]{24}")
220	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:223:12
222	        if "subdomain" in extra:
223	            assert isinstance(extra["subdomain"], str)
224	            extra["HTTP_HOST"] = Realm.host_for_subdomain(extra["subdomain"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:242:12
241	            # Provide a way to disable setting User-Agent if desired.
242	            assert "HTTP_USER_AGENT" not in extra
243	        elif "HTTP_USER_AGENT" not in extra:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:639:8
638	        div = cast(lxml.html.HtmlMixin, doc).get_element_by_id("page-params")
639	        assert div is not None
640	        page_params_json = div.get("data-params")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:641:8
640	        page_params_json = div.get("data-params")
641	        assert page_params_json is not None
642	        page_params = orjson.loads(page_params_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:683:8
682	        """
683	        assert "@" not in name, "use login_by_email for email logins"
684	        user = self.example_user(name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:850:16
849	                match = re.search(url_pattern, message.body)
850	                assert match is not None
851	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:881:8
880	        # TODO: use encode_user where possible
881	        assert "@" in email
882	        user = get_user_by_delivery_email(email, get_realm(realm))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1023:8
1022	        to_user_ids = [u.id for u in to_users]
1023	        assert len(to_user_ids) >= 2
1024	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1115:8
1114	    def assert_streaming_content(self, response: "TestHttpResponse", result: bytes) -> None:
1115	        assert isinstance(response, StreamingHttpResponse)
1116	        data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1778:12
1777	            realm_emoji_id = int(reaction.emoji_code)
1778	            assert realm_emoji_id in dct
1779	            self.assertEqual(dct[realm_emoji_id].name, reaction.emoji_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1785:12
1784	            realm_emoji_id = int(user_status.emoji_code)
1785	            assert realm_emoji_id in dct
1786	            self.assertEqual(dct[realm_emoji_id].name, user_status.emoji_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1951:8
1950	        """
1951	        assert self.STREAM_NAME is not None
1952	        self.subscribe(self.test_user, self.STREAM_NAME)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:1984:8
1983	            )
1984	        assert expected_message is not None and expected_topic is not None
1985	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:2069:8
2068	    def get_body(self, fixture_name: str) -> str:
2069	        assert self.WEBHOOK_DIR_NAME is not None
2070	        body = self.webhook_fixture_data(self.WEBHOOK_DIR_NAME, fixture_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:2086:8
2085	        app_config = apps.get_containing_app_config(type(self).__module__)
2086	        assert app_config is not None
2087	        return app_config.name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_classes.py:2093:8
2092	    def setUp(self) -> None:
2093	        assert (
2094	            self.migrate_from and self.migrate_to
2095	        ), f"TestCase '{type(self).__name__}' must define migrate_from and migrate_to properties"
2096	        migrate_from: List[Tuple[str, str]] = [(self.app, self.migrate_from)]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_console_output.py:141:4
140	    console_log_handler = logging.getLogger("django.server").handlers[0]
141	    assert isinstance(console_log_handler, logging.StreamHandler)
142	    assert console_log_handler.stream == stderr

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_console_output.py:142:4
141	    assert isinstance(console_log_handler, logging.StreamHandler)
142	    assert console_log_handler.stream == stderr
143	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\test_fixtures.py:6:0
5	import shutil
6	import subprocess
7	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\lib\test_fixtures.py:371:4
370	    commands = "\n".join(f"DROP DATABASE IF EXISTS {db};" for db in databases_to_drop)
371	    subprocess.run(
372	        ["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost", "postgres", "zulip_test"],
373	        input=commands,
374	        check=True,
375	        text=True,
376	    )
377	    return len(databases_to_drop)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\test_fixtures.py:371:4
370	    commands = "\n".join(f"DROP DATABASE IF EXISTS {db};" for db in databases_to_drop)
371	    subprocess.run(
372	        ["psql", "-q", "-v", "ON_ERROR_STOP=1", "-h", "localhost", "postgres", "zulip_test"],
373	        input=commands,
374	        check=True,
375	        text=True,
376	    )
377	    return len(databases_to_drop)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_fixtures.py:403:4
402	    # Make sure default database is 'zulip_test'.
403	    assert connections["default"].settings_dict["NAME"] == "zulip_test"
404	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:241:4
240	    avatar_url_path = avatar_url(user_profile, medium)
241	    assert avatar_url_path is not None
242	    assert settings.LOCAL_UPLOADS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:242:4
241	    assert avatar_url_path is not None
242	    assert settings.LOCAL_UPLOADS_DIR is not None
243	    assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:243:4
242	    assert settings.LOCAL_UPLOADS_DIR is not None
243	    assert settings.LOCAL_AVATARS_DIR is not None
244	    avatar_disk_path = os.path.join(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:266:12
265	            match = key_regex.search(message.body)
266	            assert match is not None
267	            [key] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:293:4
292	    recipient_id = stream.recipient_id
293	    assert recipient_id is not None
294	    return Subscription.objects.get(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:449:12
448	        def re_strip(r: str) -> str:
449	            assert r.startswith(r"^")
450	            if r.endswith(r"$"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:453:16
452	            else:
453	                assert r.endswith(r"\Z")
454	                return r[1:-2]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:498:8
497	
498	        assert len(pattern_cnt) > 100
499	        untested_patterns = {p.replace("\\", "") for p in pattern_cnt if pattern_cnt[p] == 0}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:552:4
551	def load_subdomain_token(response: Union["TestHttpResponse", HttpResponse]) -> ExternalAuthDataDict:
552	    assert isinstance(response, HttpResponseRedirect)
553	    token = response.url.rsplit("/", 1)[1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:555:4
554	    data = ExternalAuthResult(login_token=token, delete_stored_data=False).data_dict
555	    assert data is not None
556	    return data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_helpers.py:728:8
727	        marshalled_event = orjson.loads(orjson.dumps(event))
728	        assert marshalled_event == event
729	        inner(queue_name, event, processor)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\test_runner.py:33:28
32	# below hack, which fails 1/10000000 of the time.
33	random_id_range_start = str(random.randint(1, 10000000))
34	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\test_runner.py:397:12
396	            result = self.run_suite(suite)
397	            assert isinstance(result, TextTestResult)
398	        self.teardown_test_environment()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\lib\tex.py:3:0
2	import os
3	import subprocess
4	from typing import Optional

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\lib\tex.py:37:17
36	    try:
37	        stdout = subprocess.check_output(command, input=tex, stderr=subprocess.DEVNULL, text=True)
38	        # stdout contains a newline at the end

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:61:12
60	            # to raise a TimeoutExpiredError in _this_ thread.
61	            assert self.ident is not None
62	            ctypes.pythonapi.PyThreadState_SetAsyncExc(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\timeout.py:95:4
94	
95	    assert thread.result is not None
96	    return thread.result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\topic.py:187:12
186	        for m in messages_list:
187	            assert new_stream.recipient is not None
188	            m.recipient = new_stream.recipient

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:27:4
26	    avatar_path = user_avatar_path(user)
27	    assert settings.LOCAL_UPLOADS_DIR is not None
28	    assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:28:4
27	    assert settings.LOCAL_UPLOADS_DIR is not None
28	    assert settings.LOCAL_AVATARS_DIR is not None
29	    file_path = os.path.join(settings.LOCAL_AVATARS_DIR, avatar_path) + ".original"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:46:8
45	        _cache = cache._cache  # type: ignore[attr-defined] # not in stubs
46	        assert isinstance(_cache, bmemcached.Client)
47	        _cache.disconnect_all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:56:4
55	def _transfer_message_files_to_s3(attachment: Attachment) -> None:
56	    assert settings.LOCAL_UPLOADS_DIR is not None
57	    assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:57:4
56	    assert settings.LOCAL_UPLOADS_DIR is not None
57	    assert settings.LOCAL_FILES_DIR is not None
58	    file_path = os.path.join(settings.LOCAL_FILES_DIR, attachment.path_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:82:8
81	        _cache = cache._cache  # type: ignore[attr-defined] # not in stubs
82	        assert isinstance(_cache, bmemcached.Client)
83	        _cache.disconnect_all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:99:4
98	    )
99	    assert settings.LOCAL_UPLOADS_DIR is not None
100	    assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:100:4
99	    assert settings.LOCAL_UPLOADS_DIR is not None
100	    assert settings.LOCAL_AVATARS_DIR is not None
101	    emoji_path = os.path.join(settings.LOCAL_AVATARS_DIR, emoji_path) + ".original"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\transfer.py:118:8
117	        _cache = cache._cache  # type: ignore[attr-defined] # not in stubs
118	        assert isinstance(_cache, bmemcached.Client)
119	        _cache.disconnect_all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\__init__.py:36:4
35	    uploaded_file_name = user_file.name
36	    assert uploaded_file_name is not None
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\__init__.py:180:8
179	    if response.status_code == 200:
180	        assert type(response.content) == bytes
181	        return response.content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\__init__.py:187:8
186	    if response.status_code == 200:
187	        assert type(response.content) == bytes
188	        return response.content

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\__init__.py:204:8
203	        emoji_filename = realm_emoji.file_name
204	        assert emoji_filename is not None
205	        emoji_url = get_emoji_url(emoji_filename, realm_emoji.realm_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\__init__.py:215:8
214	        # When this runs, emojis have already been migrated to always have .author set.
215	        assert user_profile is not None
216	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\base.py:53:4
52	    value = re.sub(r"[-\s]+", "-", value)
53	    assert value not in {"", ".", ".."}
54	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\base.py:94:4
93	def resize_animated(im: Image.Image, size: int = DEFAULT_EMOJI_SIZE) -> bytes:
94	    assert im.n_frames > 1
95	    frames = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\base.py:282:4
281	) -> None:
282	    assert (user_profile.realm_id == realm.id) or is_cross_realm_bot_email(
283	        user_profile.delivery_email
284	    )
285	    attachment = Attachment.objects.create(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\local.py:33:4
32	    """
33	    assert settings.LOCAL_UPLOADS_DIR is not None
34	    type_path = os.path.join(settings.LOCAL_UPLOADS_DIR, type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\local.py:35:4
34	    type_path = os.path.join(settings.LOCAL_UPLOADS_DIR, type)
35	    assert os.path.commonpath([type_path, full_path]) == type_path
36	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\lib\upload\local.py:77:23
76	                realm_id,
77	                format(random.randint(0, 255), "x"),
78	                secrets.token_urlsafe(18),

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\local.py:108:8
107	    def all_message_attachments(self) -> Iterator[Tuple[str, datetime]]:
108	        assert settings.LOCAL_UPLOADS_DIR is not None
109	        for dirname, _, files in os.walk(settings.LOCAL_UPLOADS_DIR + "/files"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\local.py:243:12
242	        if is_animated:
243	            assert still_image_data is not None
244	            still_path = RealmEmoji.STILL_PATH_ID_TEMPLATE.format(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\local.py:275:8
274	        # Get the last element of a list in the form ['user_avatars', '<file_path>']
275	        assert export_path.startswith("/")
276	        file_path = export_path[1:].split("/", 1)[-1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\s3.py:182:8
181	        split_url = urllib.parse.urlsplit(foo_url)
182	        assert split_url.path.endswith(f"/{DUMMY_KEY}")
183	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\s3.py:195:8
194	    ) -> str:
195	        assert not key.startswith("/")
196	        return urllib.parse.urljoin(self.public_upload_url_base, key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\s3.py:468:12
467	            )
468	            assert still_image_data is not None
469	            upload_image_to_s3(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\upload\s3.py:503:8
502	    def delete_export_tarball(self, export_path: str) -> Optional[str]:
503	        assert export_path.startswith("/")
504	        path_id = export_path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\url_preview\parsers\generic.py:30:12
29	        if isinstance(meta_description, Tag) and meta_description.get("content", "") != "":
30	            assert isinstance(meta_description["content"], str)
31	            return meta_description["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\url_preview\parsers\generic.py:52:16
51	            if isinstance(first_image, Tag) and first_image["src"] != "":
52	                assert isinstance(first_image["src"], str)
53	                try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_agent.py:18:4
17	    match = pattern.match(user_agent)
18	    assert match is not None
19	    return match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_topics.py:99:8
98	        recipient_id = stream.recipient_id
99	        assert recipient_id is not None
100	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_topics.py:144:4
143	
144	    assert last_updated is not None
145	    assert recipient_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\user_topics.py:145:4
144	    assert last_updated is not None
145	    assert recipient_id is not None
146	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:174:8
173	    if base_query is None:
174	        assert realm is not None
175	        query = UserProfile.objects.filter(realm=realm, is_active=True)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\lib\users.py:196:15
195	        where_clause = "upper(zerver_userprofile.email::text) IN (SELECT upper(email) FROM unnest(%s) AS email)"
196	        return query.select_related("realm").extra(where=[where_clause], params=(emails,))
197	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:372:8
371	        # Put an assertion so that mypy doesn't complain.
372	        assert field_data is not None
373	        return choice_field_validator(var_name, field_data, value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\users.py:650:4
649	    # is True before calling `is_2fa_verified`.
650	    assert settings.TWO_FACTOR_AUTHENTICATION_ENABLED
651	    return is_verified(user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\utils.py:34:4
33	def assert_is_not_none(value: Optional[T]) -> T:
34	    assert value is not None
35	    return value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:245:12
244	            valid_item = sub_validator(vname, item)
245	            assert item is valid_item  # To justify the unchecked cast below
246	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:308:16
307	                valid_value = value_validator(vname, val[key])
308	                assert val[key] is valid_value  # To justify the unchecked cast below
309	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:419:8
418	        valid_value = validator("field_data", value)
419	        assert value is valid_value  # To justify the unchecked cast below
420	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:500:4
499	
500	    assert isinstance(poll_data, dict)
501	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\validator.py:543:4
542	
543	    assert isinstance(todo_data, dict)
544	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:110:4
109	    client = RequestNotes.get_notes(request).client
110	    assert client is not None
111	    if stream is None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:112:8
111	    if stream is None:
112	        assert user_profile.bot_owner is not None
113	        check_send_private_message(user_profile, client, user_profile.bot_owner, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\lib\webhooks\common.py:168:4
167	) -> Optional[str]:
168	    assert request.user.is_authenticated
169	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\logging_handlers.py:5:0
4	import platform
5	import subprocess
6	import traceback

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\logging_handlers.py:23:15
22	    try:  # nocoverage
23	        return subprocess.check_output(
24	            ["git", "describe", "--tags", "--match=[0-9]*", "--always", "--dirty", "--long"],
25	            stderr=subprocess.PIPE,
26	            cwd=os.path.join(os.path.dirname(__file__), ".."),
27	            text=True,
28	        ).strip()
29	    except (FileNotFoundError, subprocess.CalledProcessError):  # nocoverage

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\logging_handlers.py:23:15
22	    try:  # nocoverage
23	        return subprocess.check_output(
24	            ["git", "describe", "--tags", "--match=[0-9]*", "--always", "--dirty", "--long"],
25	            stderr=subprocess.PIPE,
26	            cwd=os.path.join(os.path.dirname(__file__), ".."),
27	            text=True,
28	        ).strip()
29	    except (FileNotFoundError, subprocess.CalledProcessError):  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\add_users_to_streams.py:23:8
22	        realm = self.get_realm(options)
23	        assert realm is not None  # Should be ensured by parser
24	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\backup.py:60:20
59	                if TYPE_CHECKING:
60	                    assert isinstance(connection, DatabaseWrapper)
61	                print(connection.pg_version, file=f)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\backup.py:111:12
110	
111	            assert not any("|" in name or "|" in path for name, path in paths)
112	            transform_args = [

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\change_realm_subdomain.py:22:8
21	        realm = self.get_realm(options)
22	        assert realm is not None  # Should be ensured by parser
23	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\compilemessages.py:4:0
3	import re
4	from subprocess import CalledProcessError, check_output
5	from typing import Any, Dict, List

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\compilemessages.py:73:17
72	    def get_locales(self) -> List[str]:
73	        output = check_output(["git", "ls-files", "locale"], text=True)
74	        tracked_files = output.split()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\compilemessages.py:73:17
72	    def get_locales(self) -> List[str]:
73	        output = check_output(["git", "ls-files", "locale"], text=True)
74	        tracked_files = output.split()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_default_stream_groups.py:39:8
38	        realm = self.get_realm(options)
39	        assert realm is not None  # Should be ensured by parser
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_stream.py:20:8
19	        realm = self.get_realm(options)
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\create_user.py:31:8
30	        realm = self.get_realm(options)
31	        assert realm is not None  # Should be ensured by parser
32	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\deactivate_realm.py:20:8
19	
20	        assert realm is not None  # Should be ensured by parser
21	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\delete_realm.py:21:8
20	        realm = self.get_realm(options)
21	        assert realm is not None  # Should be ensured by parser
22	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\edit_linkifiers.py:44:8
43	        realm = self.get_realm(options)
44	        assert realm is not None  # Should be ensured by parser
45	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\email_mirror.py:66:16
65	                status, msg_data = mbox.fetch(message_id, "(RFC822)")
66	                assert isinstance(msg_data[0], tuple)
67	                msg_as_bytes = msg_data[0][1]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\email_mirror.py:70:16
69	                # https://github.com/python/typeshed/issues/2417
70	                assert isinstance(message, EmailMessage)
71	                yield message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\export.py:111:8
110	        realm = self.get_realm(options)
111	        assert realm is not None  # Should be ensured by parser
112	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\export_search.py:30:4
29	    dir_path_id = os.path.dirname(attachment.path_id)
30	    assert "../" not in dir_path_id
31	    os.makedirs(base_path + "/" + dir_path_id, exist_ok=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\export_search.py:131:8
130	        realm = self.get_realm(options)
131	        assert realm is not None
132	        limits = Q()

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\export_single_user.py:2:0
1	import os
2	import subprocess
3	import tempfile

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\export_single_user.py:49:8
48	        tarball_path = output_dir.rstrip("/") + ".tar.gz"
49	        subprocess.check_call(
50	            [
51	                "tar",
52	                f"-czf{tarball_path}",
53	                f"-C{os.path.dirname(output_dir)}",
54	                os.path.basename(output_dir),
55	            ]
56	        )
57	        print(f"Tarball written to {tarball_path}")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\export_single_user.py:49:8
48	        tarball_path = output_dir.rstrip("/") + ".tar.gz"
49	        subprocess.check_call(
50	            [
51	                "tar",
52	                f"-czf{tarball_path}",
53	                f"-C{os.path.dirname(output_dir)}",
54	                os.path.basename(output_dir),
55	            ]
56	        )
57	        print(f"Tarball written to {tarball_path}")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\import.py:5:0
4	import os
5	import subprocess
6	from typing import Any

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\import.py:59:8
58	        call_command("flush", verbosity=0, interactive=False)
59	        subprocess.check_call([os.path.join(settings.DEPLOY_ROOT, "scripts/setup/flush-memcached")])
60	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\makemessages.py:39:0
38	import re
39	import subprocess
40	from typing import Any, Collection, Dict, Iterator, List, Mapping

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\makemessages.py:202:20
201	
202	        extracted = subprocess.check_output(
203	            [
204	                "node_modules/.bin/formatjs",
205	                "extract",
206	                "--additional-function-names=$t,$t_html",
207	                "--format=simple",
208	                "--ignore=**/*.d.ts",
209	                "web/src/**/*.js",
210	                "web/src/**/*.ts",
211	            ]
212	        )
213	        translation_strings.extend(json.loads(extracted).values())

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\makemessages.py:202:20
201	
202	        extracted = subprocess.check_output(
203	            [
204	                "node_modules/.bin/formatjs",
205	                "extract",
206	                "--additional-function-names=$t,$t_html",
207	                "--format=simple",
208	                "--ignore=**/*.d.ts",
209	                "web/src/**/*.js",
210	                "web/src/**/*.ts",
211	            ]
212	        )
213	        translation_strings.extend(json.loads(extracted).values())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\merge_streams.py:21:8
20	        realm = self.get_realm(options)
21	        assert realm is not None  # Should be ensured by parser
22	        stream_to_keep = get_stream(options["stream_to_keep"], realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\process_queue.py:80:12
79	                td.start()
80	            assert len(queues) == cnt
81	            logger.info("%d queue worker threads were launched", cnt)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\reactivate_realm.py:16:8
15	        realm = self.get_realm(options)
16	        assert realm is not None  # Should be ensured by parser
17	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:29:8
28	        realm = self.get_realm(options)
29	        assert realm is not None  # Should be ensured by parser
30	        if options["op"] == "show":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:33:16
32	            for realm_domain in get_realm_domains(realm):
33	                assert isinstance(realm_domain["domain"], str)
34	                if realm_domain["allow_subdomains"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:40:8
39	
40	        assert isinstance(options["domain"], str)
41	        domain = options["domain"].strip().lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\realm_domain.py:47:12
46	        if options["op"] == "add":
47	            assert isinstance(options["allow_subdomains"], bool)
48	            try:

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\management\commands\register_server.py:1:0
1	import subprocess
2	from argparse import ArgumentParser
3	from typing import Any, Dict

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\management\commands\register_server.py:97:16
96	                print(f"Success! Updating {SECRETS_FILENAME} with the new key...")
97	                subprocess.check_call(
98	                    [
99	                        "crudini",
100	                        "--set",
101	                        SECRETS_FILENAME,
102	                        "secrets",
103	                        "zulip_org_key",
104	                        request["new_org_key"],
105	                    ]
106	                )
107	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\management\commands\register_server.py:97:16
96	                print(f"Success! Updating {SECRETS_FILENAME} with the new key...")
97	                subprocess.check_call(
98	                    [
99	                        "crudini",
100	                        "--set",
101	                        SECRETS_FILENAME,
102	                        "secrets",
103	                        "zulip_org_key",
104	                        request["new_org_key"],
105	                    ]
106	                )
107	            print("Mobile Push Notification Service registration successfully updated!")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\register_server.py:110:8
109	    def _request_push_notification_bouncer_url(self, url: str, params: Dict[str, Any]) -> Response:
110	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
111	        registration_url = settings.PUSH_NOTIFICATION_BOUNCER_URL + url

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\remove_users_from_stream.py:23:8
22	        realm = self.get_realm(options)
23	        assert realm is not None  # Should be ensured by parser
24	        user_profiles = self.get_users(options, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\runtornado.py:50:8
49	        addrport = options["addrport"]
50	        assert isinstance(addrport, str)
51	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\scrub_realm.py:18:8
17	        realm = self.get_realm(options)
18	        assert realm is not None  # Should be ensured by parser
19	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_realm_reactivation_email.py:18:8
17	        realm = self.get_realm(options)
18	        assert realm is not None
19	        if not realm.deactivated:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\send_to_email_mirror.py:105:16
104	                # https://github.com/python/typeshed/issues/2417
105	                assert isinstance(message, EmailMessage)
106	                return message

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\management\commands\show_admins.py:17:8
16	        realm = self.get_realm(options)
17	        assert realm is not None  # True because of required=True above
18	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:64:4
63	    log_data = RequestNotes.get_notes(request).log_data
64	    assert log_data is not None
65	    record_request_stop_data(log_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:80:4
79	    log_data = RequestNotes.get_notes(request).log_data
80	    assert log_data is not None
81	    if "time_restarted" in log_data:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:134:4
133	) -> None:
134	    assert error_content is None or error_content_iter is None
135	    if error_content is not None:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:228:8
227	    if 400 <= status_code < 500 and status_code not in [401, 404, 405]:
228	        assert error_content_iter is not None
229	        error_content_list = list(error_content_iter)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:299:12
298	            # Tornado code path that returns responses asynchronously.
299	            assert request_notes.saved_response is not None
300	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:333:8
332	        # importing modules on the first start)
333	        assert request_notes.log_data is not None
334	        request_notes.log_data["startup_time_delta"] = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:368:8
367	
368	        assert request_notes.client_name is not None and request_notes.log_data is not None
369	        assert request.method is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:369:8
368	        assert request_notes.client_name is not None and request_notes.log_data is not None
369	        assert request.method is not None
370	        write_log_line(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:488:8
487	            patch_vary_headers(response, ("Accept-Language",))
488	        assert language is not None
489	        response.setdefault("Content-Language", language)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:612:4
611	    ).placeholder_open_graph_description
612	    assert placeholder_open_graph_description is not None
613	    return content.replace(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:624:12
623	        if RequestNotes.get_notes(request).placeholder_open_graph_description is not None:
624	            assert isinstance(response, HttpResponse)
625	            response.content = alter_content(request, response.content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:646:4
645	    # allowing free access to the SCIM API:
646	    assert valid_bearer_token
647	    assert scim_client_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:647:4
646	    assert valid_bearer_token
647	    assert scim_client_name
648	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:656:4
655	    request_notes = RequestNotes.get_notes(request)
656	    assert request_notes.realm is not None
657	    request_notes.requestor_for_logs = (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\middleware.py:678:8
677	        # to a non-SCIM endpoint.
678	        assert request.path.startswith(self.reverse_url)
679	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0149_realm_emoji_drop_unique_constraint.py:53:8
52	    def copy_files(self, src_path: str, dst_path: str) -> None:
53	        assert settings.LOCAL_UPLOADS_DIR is not None
54	        assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0149_realm_emoji_drop_unique_constraint.py:54:8
53	        assert settings.LOCAL_UPLOADS_DIR is not None
54	        assert settings.LOCAL_AVATARS_DIR is not None
55	        assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0149_realm_emoji_drop_unique_constraint.py:55:8
54	        assert settings.LOCAL_AVATARS_DIR is not None
55	        assert settings.LOCAL_FILES_DIR is not None
56	        src_path = os.path.join(settings.LOCAL_AVATARS_DIR, src_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:105:8
104	        # Since these users are in password_change_user_ids, this must not be None.
105	        assert earliest_password_change is not None
106	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'empty_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:140:40
139	
140	    AFFECTED_USER_TYPE_EMPTY_PASSWORD = "empty_password"
141	    AFFECTED_USER_TYPE_CHANGED_PASSWORD = "changed_password"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'changed_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\migrations\0209_user_profile_no_empty_password.py:141:42
140	    AFFECTED_USER_TYPE_EMPTY_PASSWORD = "empty_password"
141	    AFFECTED_USER_TYPE_CHANGED_PASSWORD = "changed_password"
142	    MIGRATION_ID = "0209_user_profile_no_empty_password"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0237_rename_zulip_realm_to_zulipinternal.py:31:4
30	    welcome_bot = UserProfile.objects.get(email="welcome-bot@zulip.com")
31	    assert welcome_bot.realm.id == internal_realm.id
32	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\migrations\0257_fix_has_link_attribute.py:6:0
5	
6	import lxml
7	from django.db import migrations

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:67:4
66	    # so it's not worth writing code to fix them.
67	    assert not RealmAuditLog.objects.filter(event_type__in=unlikely_event_types).exists()
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:94:16
93	            if isinstance(old_value, dict):
94	                assert prop in improperly_marshalled_properties
95	                old_value = old_value["id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:97:16
96	            if isinstance(new_value, dict):
97	                assert prop in improperly_marshalled_properties
98	                new_value = new_value["id"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0298_fix_realmauditlog_format.py:101:8
100	        # Sanity check that the original event has exactly the keys we expect.
101	        assert set(extra_data.keys()) <= {OLD_VALUE, NEW_VALUE}
102	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0401_migrate_old_realm_reactivation_links.py:44:8
43	
44	        assert confirmation.content_type.model == "realm"
45	        realm_object_id = confirmation.object_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0423_fix_email_gateway_attachment_owner.py:130:12
129	        if isinstance(attachment, ArchivedAttachment):
130	            assert isinstance(message, ArchivedMessage)
131	            # We need to use the sequence from

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\migrations\0423_fix_email_gateway_attachment_owner.py:150:12
149	        else:
150	            assert isinstance(message, Message)
151	            attachment.messages.add(message)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:178:4
177	    """
178	    assert user_ids
179	    clause = f"{field} IN %s"

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:180:12
179	    clause = f"{field} IN %s"
180	    query = query.extra(
181	        where=[clause],
182	        params=(tuple(user_ids),),
183	    )
184	    return query

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:239:16
238	            for r in get_display_recipient(recipient):
239	                assert not isinstance(r, str)  # It will only be a string for streams
240	                if r["id"] != user_profile_id:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:265:4
264	    supported_backends = django.contrib.auth.get_backends()
265	    assert supported_backends is not None
266	    return supported_backends

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:1188:8
1187	            author_id = realm_emoji.author_id
1188	        assert realm_emoji.file_name is not None
1189	        emoji_url = get_emoji_url(realm_emoji.file_name, realm_emoji.realm_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2149:8
2148	
2149	        assert policy_value == Realm.POLICY_FULL_MEMBERS_ONLY
2150	        return not self.is_provisional_member

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2419:4
2418	
2419	    assert invite_expires_in_minutes is not None
2420	    if not isinstance(invite_expires_in_minutes, UnspecifiedValue):

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\models.py:2863:12
2862	        return (
2863	            get_active_streams(realm)
2864	            .select_related()
2865	            .extra(where=[where_clause], params=(list(stream_names),))
2866	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2888:4
2887	    huddle = get_or_create_huddle(list(user_profile_ids))
2888	    assert huddle.recipient is not None
2889	    return huddle.recipient

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2893:4
2892	def get_huddle_user_ids(recipient: Recipient) -> ValuesQuerySet["Subscription", int]:
2893	    assert recipient.type == Recipient.HUDDLE
2894	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:2909:4
2908	    """
2909	    assert all(recipient.type == Recipient.HUDDLE for recipient in recipients)
2910	    if not recipients:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:3630:8
3629	    if isinstance(maybe_user_profile, AnonymousUser):
3630	        assert realm is not None
3631	        return validate_attachment_request_for_spectator_access(realm, attachment)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:3634:4
3633	    user_profile = maybe_user_profile
3634	    assert isinstance(user_profile, UserProfile)
3635	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:3905:4
3904	        return get_system_bot(email, realm.id)
3905	    assert realm is not None
3906	    return get_user(email, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:3979:4
3978	    )
3979	    assert user_profile.bot_owner_id is not None
3980	    if is_private_bot:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:4343:12
4342	            # The topic for direct messages should always be an empty string.
4343	            assert self.topic_name() == ""
4344	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\models.py:4355:8
4354	        # The recipient for stream messages should always just be the unique stream ID.
4355	        assert len(recipient) == 1
4356	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\javascript_examples.py:9:0
8	import os
9	import subprocess
10	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\javascript_examples.py:21:13
20	
21	    output = subprocess.check_output(
22	        args=["node", "--unhandled-rejections=strict", "zerver/openapi/javascript_examples.js"],
23	        text=True,
24	    )
25	    endpoint_responses = json.loads(output)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\markdown_extension.py:250:8
249	        # We currently don't have any non-JSON encoded arrays.
250	        assert jsonify
251	        if curl_argument:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:45:12
44	        if isinstance(b_value, list):
45	            assert isinstance(a_value, list)
46	            ret[key] = a_value + b_value

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:48:12
47	        elif isinstance(b_value, dict):
48	            assert isinstance(a_value, dict)
49	            ret[key] = naively_merge(a_value, b_value)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:67:8
66	        ret = naively_merge_allOf_dict(ret)
67	        assert isinstance(subschemas, list)
68	        for subschema in subschemas:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:69:12
68	        for subschema in subschemas:
69	            assert isinstance(subschema, dict)
70	            ret = naively_merge(ret, naively_merge_allOf_dict(subschema))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:154:8
153	        self.check_reload()
154	        assert len(self._openapi) > 0
155	        return self._openapi

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:162:8
161	        self.check_reload()
162	        assert len(self._endpoints_dict) > 0
163	        return self._endpoints_dict

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:171:8
170	        self.check_reload()
171	        assert self._spec is not None
172	        return self._spec

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:491:8
490	    if likely_deprecated_parameter(description):
491	        assert argument["deprecated"]
492	    if "deprecated" in argument:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:493:8
492	    if "deprecated" in argument:
493	        assert likely_deprecated_parameter(description)
494	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\openapi.py:525:4
524	    # against the OpenAPI documentation.
525	    assert isinstance(data, dict)
526	    mock_request = MockRequest(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:71:4
70	
71	    assert ids_list == user_ids
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:102:4
101	    # {code_example|end}
102	    assert result["result"] == "success"
103	    assert "newbie@zulip.com" in result["subscribed"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:103:4
102	    assert result["result"] == "success"
103	    assert "newbie@zulip.com" in result["subscribed"]
104	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:207:4
206	
207	    assert result["result"] == "success"
208	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:265:4
264	    members = [m for m in result["members"] if m["email"] == "newbie@zulip.com"]
265	    assert len(members) == 1
266	    newbie = members[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:267:4
266	    newbie = members[0]
267	    assert not newbie["is_admin"]
268	    assert newbie["full_name"] == "New User"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:268:4
267	    assert not newbie["is_admin"]
268	    assert newbie["full_name"] == "New User"
269	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:276:4
275	    validate_against_openapi_schema(result, "/users", "get", "200")
276	    assert result["members"][0]["avatar_url"] is not None
277	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:286:12
285	        if member["is_bot"]:
286	            assert member.get("profile_data", None) is None
287	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:288:12
287	        else:
288	            assert member.get("profile_data", None) is not None
289	        assert member["avatar_url"] is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:289:8
288	            assert member.get("profile_data", None) is not None
289	        assert member["avatar_url"] is None
290	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:561:4
560	
561	    assert result["result"] == "success"
562	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:577:4
576	
577	    assert result["result"] == "success"
578	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:589:4
588	    streams = [s for s in result["streams"] if s["name"] == "new stream"]
589	    assert streams[0]["description"] == "New stream for testing"
590	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:598:4
597	    validate_against_openapi_schema(result, "/streams", "get", "200")
598	    assert len(result["streams"]) == 5
599	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:615:4
614	    validate_against_openapi_schema(result, "/streams/{stream_id}", "patch", "200")
615	    assert result["result"] == "success"
616	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:627:4
626	    hamlet_user_group = [u for u in result["user_groups"] if u["name"] == "hamletcharacters"][0]
627	    assert hamlet_user_group["description"] == "Characters of Hamlet"
628	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:647:4
646	    # {code_example|end}
647	    assert result["subscribers"] == [11, 25]
648	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:652:4
651	    result = client.get_user_agent()
652	    assert result.startswith("ZulipPython/")
653	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:665:4
664	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]
665	    assert streams[0]["description"] == "New stream for testing"
666	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:681:4
680	    result = client.get_subscriptions()
681	    assert result["result"] == "success"
682	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:683:4
682	    streams = [s for s in result["subscriptions"] if s["name"] == "new stream"]
683	    assert len(streams) == 0
684	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:886:4
885	    validate_against_openapi_schema(result, "/messages", "get", "200")
886	    assert len(result["messages"]) <= request["num_before"]
887	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:914:4
913	def get_raw_message(client: Client, message_id: int) -> None:
914	    assert int(message_id)
915	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:974:4
973	    )
974	    assert result["result"] == "success"
975	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:975:4
974	    assert result["result"] == "success"
975	    assert result["raw_content"] == request["content"]
976	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1000:4
999	    )
1000	    assert result["result"] == "success"
1001	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1001:4
1000	    assert result["result"] == "success"
1001	    assert result["raw_content"] == request["content"]
1002	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1070:4
1069	def update_message(client: Client, message_id: int) -> None:
1070	    assert int(message_id)
1071	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1091:4
1090	    )
1091	    assert result["result"] == "success"
1092	    assert result["raw_content"] == request["content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1092:4
1091	    assert result["result"] == "success"
1092	    assert result["raw_content"] == request["content"]
1093	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1398:4
1397	
1398	    assert result["result"] == "success"
1399	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1411:4
1410	
1411	    assert result["result"] == "success"
1412	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1424:4
1423	
1424	    assert result["result"] == "success"
1425	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1442:4
1441	
1442	    assert result["result"] == "success"
1443	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1456:4
1455	    # {code_example|end}
1456	    assert result["result"] == "success"
1457	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\python_examples.py:1466:4
1465	    validate_against_openapi_schema(result, "/user_groups/{user_group_id}", "delete", "200")
1466	    assert result["result"] == "success"
1467	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\openapi\test_curl_examples.py:13:0
12	import shlex
13	import subprocess
14	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\openapi\test_curl_examples.py:100:36
99	                    # returns non-JSON output, we'll still print it.
100	                    response_json = subprocess.check_output(generated_curl_command, text=True)
101	                    response = json.loads(response_json)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\openapi\test_curl_examples.py:102:20
101	                    response = json.loads(response_json)
102	                    assert response["result"] == "success"
103	                except (AssertionError, Exception):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_audit_log.py:185:19
184	        user = self.example_user("hamlet")
185	        password = "test1"
186	        do_change_password(user, password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:322:8
321	        modified_stream = subscription_creation_logs[0].modified_stream
322	        assert modified_stream is not None
323	        self.assertEqual(subscription_creation_logs.count(), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:336:8
335	        modified_stream = subscription_deactivation_logs[0].modified_stream
336	        assert modified_stream is not None
337	        self.assertEqual(subscription_deactivation_logs.count(), 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_audit_log.py:546:8
545	        audit_log = audit_entries.first()
546	        assert audit_log is not None
547	        self.assert_length(audit_entries, 1)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:295:19
294	        user_profile = self.example_user("hamlet")
295	        password = "testpassword"
296	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:333:19
332	        user_profile = self.example_user("hamlet")
333	        password = "testpassword"
334	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:349:19
348	        # Now do the same test with the empty string as the password.
349	        password = ""
350	        with self.assertRaises(PasswordTooWeakError):

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:368:19
367	        user_profile = self.example_user("hamlet")
368	        password = "testpassword"
369	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:384:19
383	        user_profile = self.example_user("hamlet")
384	        password = "a_password_of_22_chars"
385	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:413:8
412	        self.assert_in_response(realm.description, result)
413	        assert realm.name is not None
414	        self.assert_in_response(realm.name, result)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:465:12
464	        self.assertIsNone(
465	            backend.authenticate(
466	                request=mock.MagicMock(),
467	                username=email,
468	                password="wrongpass",
469	                realm=get_realm("zulip"),
470	            )
471	        )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:714:19
713	        user_profile = self.example_user("hamlet")
714	        password = "testpassword"
715	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'email_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:776:25
775	
776	        email_password = "email_password"
777	        user_profile.set_password(email_password)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:791:16
790	            if user is not None:
791	                assert isinstance(user, UserProfile)
792	            return user

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:837:8
836	        input = soup.find("input", value=True)
837	        assert isinstance(input, Tag)
838	        desktop_data = input["value"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:839:8
838	        desktop_data = input["value"]
839	        assert isinstance(desktop_data, str)
840	        a = soup.find("a", href=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:841:8
840	        a = soup.find("a", href=True)
841	        assert isinstance(a, Tag)
842	        browser_url = a["href"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1045:8
1044	        self.assertEqual(result.status_code, 302)
1045	        assert self.AUTHORIZATION_URL in result["Location"]
1046	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1407:8
1406	        confirmation = Confirmation.objects.all().last()
1407	        assert confirmation is not None
1408	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1596:8
1595	        multiuse_confirmation = Confirmation.objects.all().last()
1596	        assert multiuse_confirmation is not None
1597	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1622:8
1621	        prereg_user = PreregistrationUser.objects.last()
1622	        assert prereg_user is not None
1623	        self.assertEqual(prereg_user.email, email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1650:8
1649	        multiuse_confirmation = Confirmation.objects.all().last()
1650	        assert multiuse_confirmation is not None
1651	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1958:8
1957	        self.assertEqual(result.status_code, 302)
1958	        assert self.AUTHORIZATION_URL in result["Location"]
1959	        assert "samlrequest" in result["Location"].lower()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1959:8
1958	        assert self.AUTHORIZATION_URL in result["Location"]
1959	        assert "samlrequest" in result["Location"].lower()
1960	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:1966:8
1965	        data = SAMLAuthBackend.get_data_from_redis(orjson.loads(relay_state)["state_token"])
1966	        assert data is not None
1967	        if next:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://appleid.apple.com/auth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:2964:23
2963	    AUTHORIZATION_URL = "https://appleid.apple.com/auth/authorize"
2964	    ACCESS_TOKEN_URL = "https://appleid.apple.com/auth/token"
2965	    AUTH_FINISH_URL = "/complete/apple/"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:2974:8
2973	        # with `SOCIAL_AUTH_APPLE_CLIENT` as the `audience`
2974	        assert settings.SOCIAL_AUTH_APPLE_CLIENT is not None
2975	        payload["aud"] = settings.SOCIAL_AUTH_APPLE_CLIENT

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'invalid'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:3252:27
3251	        def initiate_auth(mobile_flow_otp: Optional[str] = None) -> None:
3252	            url, headers = self.prepare_login_url_and_headers(
3253	                subdomain="zulip",
3254	                id_token="invalid",
3255	                mobile_flow_otp=mobile_flow_otp,
3256	                account_data_dict=account_data_dict,
3257	            )
3258	            result = self.client_get(url, **headers)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_TESTOIDC_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3331:28
3330	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_TESTOIDC_KEY"
3331	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_TESTOIDC_SECRET"
3332	    LOGIN_URL = "/accounts/login/social/oidc"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GITHUB_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3542:28
3541	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GITHUB_KEY"
3542	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GITHUB_SECRET"
3543	    LOGIN_URL = "/accounts/login/social/github"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://github.com/login/oauth/access_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:3546:23
3545	    AUTHORIZATION_URL = "https://github.com/login/oauth/authorize"
3546	    ACCESS_TOKEN_URL = "https://github.com/login/oauth/access_token"
3547	    USER_INFO_URL = "https://api.github.com/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GITLAB_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4054:28
4053	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GITLAB_KEY"
4054	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GITLAB_SECRET"
4055	    LOGIN_URL = "/accounts/login/social/gitlab"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://gitlab.com/oauth/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4058:23
4057	    AUTHORIZATION_URL = "https://gitlab.com/oauth/authorize"
4058	    ACCESS_TOKEN_URL = "https://gitlab.com/oauth/token"
4059	    USER_INFO_URL = "https://gitlab.com/api/v4/user"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SOCIAL_AUTH_GOOGLE_SECRET'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4073:28
4072	    CLIENT_KEY_SETTING = "SOCIAL_AUTH_GOOGLE_KEY"
4073	    CLIENT_SECRET_SETTING = "SOCIAL_AUTH_GOOGLE_SECRET"
4074	    LOGIN_URL = "/accounts/login/social/google"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'https://accounts.google.com/o/oauth2/token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4077:23
4076	    AUTHORIZATION_URL = "https://accounts.google.com/o/oauth2/auth"
4077	    ACCESS_TOKEN_URL = "https://accounts.google.com/o/oauth2/token"
4078	    USER_INFO_URL = "https://www.googleapis.com/oauth2/v3/userinfo"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'nonsense'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4228:21
4227	        with self.assertLogs(level="WARNING") as m:
4228	            result = self.get_log_into_subdomain(data, force_token="nonsense")
4229	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4282:8
4281	        confirmation = Confirmation.objects.all().first()
4282	        assert confirmation is not None
4283	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4318:8
4317	        confirmation = Confirmation.objects.all().first()
4318	        assert confirmation is not None
4319	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4368:8
4367	        multiuse_confirmation = Confirmation.objects.all().last()
4368	        assert multiuse_confirmation is not None
4369	        multiuse_object_key = multiuse_confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:4376:8
4375	        confirmation = Confirmation.objects.all().last()
4376	        assert confirmation is not None
4377	        confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4445:57
4444	        self.login_user(user)
4445	        result = self.client_post("/json/fetch_api_key", dict(password="wrong"))
4446	        self.assert_json_error(result, "Password is incorrect.", 400)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:4482:37
4481	        result = self.client_post(
4482	            "/api/v1/fetch_api_key", dict(username=self.email, password="wrong")
4483	        )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:4645:19
4644	        user_profile = self.example_user("hamlet")
4645	        password = "a_password_of_22_chars"
4646	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:5620:19
5619	        user_profile = self.example_user("hamlet")
5620	        password = "testpassword"
5621	        user_profile.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dapu'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5720:27
5719	        ):
5720	            user_profile = self.backend.authenticate(
5721	                request=mock.MagicMock(),
5722	                username="ldapuser1",
5723	                password="dapu",
5724	                realm=get_realm("zulip"),
5725	            )
5726	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5727:12
5726	
5727	            assert user_profile is None
5728	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5739:12
5738	
5739	            assert user_profile is not None
5740	            self.assertEqual(user_profile.delivery_email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5752:12
5751	
5752	            assert user_profile is not None
5753	            self.assertEqual(user_profile, self.example_user("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:5766:12
5765	
5766	            assert user_profile is not None
5767	            self.assertEqual(user_profile, self.example_user("aaron"))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_auth_backends.py:5795:23
5794	            othello = self.example_user("othello")
5795	            password = "testpassword"
5796	            othello.set_password(password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5811:19
5810	        with self.settings(LDAP_APPEND_DOMAIN="zulip.com"):
5811	            user = self.backend.authenticate(
5812	                request=mock.MagicMock(),
5813	                username=self.example_email("hamlet"),
5814	                password="wrong",
5815	                realm=get_realm("zulip"),
5816	            )
5817	            self.assertIs(user, None)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'doesnt_matter'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:5824:19
5823	        ) as log_debug:
5824	            user = self.backend.authenticate(
5825	                request=mock.MagicMock(),
5826	                username="nonexistent@zulip.com",
5827	                password="doesnt_matter",
5828	                realm=get_realm("zulip"),
5829	            )
5830	            self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6007:12
6006	            )
6007	            assert user_profile is not None
6008	            self.assertEqual(user_profile.delivery_email, self.example_email("hamlet"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6039:12
6038	            )
6039	            assert user_profile is not None
6040	            self.assertEqual(user_profile.delivery_email, "newuser@acme.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6047:12
6046	            url = avatar_url(user_profile)
6047	            assert url is not None
6048	            response = self.client_get(url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6074:12
6073	            )
6074	            assert user_profile is not None
6075	            self.assertEqual(user_profile.delivery_email, "newuser_splitname@zulip.com")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpass'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_auth_backends.py:6103:13
6102	        """
6103	        with self.settings(
6104	            LDAP_DEACTIVATE_NON_MATCHING_USERS=True,
6105	            LDAP_APPEND_DOMAIN="zulip.com",
6106	            AUTH_LDAP_BIND_PASSWORD="wrongpass",
6107	        ):
6108	            with self.assertRaises(ldap.INVALID_CREDENTIALS):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6639:12
6638	            confirmation = Confirmation.objects.all().first()
6639	            assert confirmation is not None
6640	            confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6674:12
6673	            confirmation = Confirmation.objects.all().last()
6674	            assert confirmation is not None
6675	            confirmation_key = confirmation.confirmation_key

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_auth_backends.py:6756:8
6755	        )
6756	        assert error is not None
6757	        self.assertIn("containing + are not allowed", error)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:301:8
300	        profile = get_user(email, realm)
301	        assert profile.default_sending_stream is not None
302	        self.assertEqual(profile.default_sending_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:314:8
313	        profile = get_user(email, realm)
314	        assert profile.default_sending_stream is not None
315	        self.assertEqual(profile.default_sending_stream.name, "Rome")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:435:8
434	        profile = get_user(email, realm)
435	        assert profile.default_sending_stream is not None
436	        self.assertEqual(profile.default_sending_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:494:8
493	        profile = get_user(bot_email, bot_realm)
494	        assert profile.default_events_register_stream is not None
495	        self.assertEqual(profile.default_events_register_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_bots.py:518:8
517	        bot_profile = get_user(bot_email, bot_realm)
518	        assert bot_profile.default_events_register_stream is not None
519	        self.assertEqual(bot_profile.default_events_register_stream.name, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_cache.py:147:8
146	        last_user = UserProfile.objects.last()
147	        assert last_user is not None
148	        last_user_id = last_user.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_custom_profile_data.py:898:8
897	        # we need the cast here to ensure the value list is correctly typed.
898	        assert all(isinstance(item, int) for item in order)
899	        try_reorder_realm_custom_profile_fields(realm, cast(Iterable[int], order))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1168:24
1167	        user_profile = self.example_user("hamlet")
1168	        test_password = "abcd1234"
1169	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrong_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1255:57
1254	        self.login("cordelia")
1255	        result = self.client_post("/json/fetch_api_key", dict(password="wrong_password"))
1256	        self.assert_json_error_contains(result, "Password is incorrect")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'abcd1234'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1313:24
1312	        email = user_profile.delivery_email
1313	        test_password = "abcd1234"
1314	        user_profile.set_password(test_password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1532:17
1531	    def test_valid_internal_requests(self) -> None:
1532	        secret = "random"
1533	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1571:13
1570	
1571	        with self.settings(SHARED_SECRET="random"):
1572	            with self.assertRaises(RequestVariableMissingError) as context:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1581:17
1580	
1581	        secret = "random"
1582	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'broken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1587:13
1586	
1587	        with self.settings(SHARED_SECRET="broken"):
1588	            self.assertFalse(authenticate_notify(request))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_decorators.py:1594:17
1593	    def test_external_requests(self) -> None:
1594	        secret = "random"
1595	        request = HostRequestMock(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_decorators.py:1756:8
1755	        bot.save()
1756	        self.login_by_email(bot.email, password="test")
1757	        self.assert_json_error_contains(self._do_test(bot), "Webhook bots can only access webhooks")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1889:12
1888	            request.session = self.client.session
1889	            assert type(request.user) is UserProfile
1890	            self.create_default_device(request.user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:1917:12
1916	            request.session = self.client.session
1917	            assert type(request.user) is UserProfile
1918	            self.create_default_device(request.user)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:2038:16
2037	                match = re.match('^(?P<count>[0-9]+) "(?P<user_agent>.*)"$', line)
2038	                assert match is not None
2039	                groupdict = match.groupdict()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:2193:12
2192	            notes = RequestNotes.get_notes(request)
2193	            assert notes.client is not None
2194	            assert notes.client_name is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_decorators.py:2194:12
2193	            assert notes.client is not None
2194	            assert notes.client_name is not None
2195	            return notes.client, notes.client_name

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_digest.py:302:8
301	
302	        assert len(users) >= 5
303	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_digest.py:446:8
445	        num_queued_users = len(queue_mock.call_args[0][0])
446	        assert num_queued_users >= 5
447	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_docs.py:353:12
352	        for integration in INTEGRATIONS.values():
353	            assert integration.logo_url is not None
354	            path = urlsplit(integration.logo_url).path

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_email_mirror.py:4:0
3	import os
4	import subprocess
5	from email import message_from_string

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:653:8
652	        attachment = Attachment.objects.last()
653	        assert attachment is not None
654	        self.assertEqual(list(attachment.messages.values_list("id", flat=True)), [message.id])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:691:8
690	        attachment = Attachment.objects.last()
691	        assert attachment is not None
692	        self.assertEqual(list(attachment.messages.values_list("id", flat=True)), [message.id])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:699:8
698	
699	        assert message.content.endswith(
700	            f"aaaaaa\n[message truncated]\n[image.png](/user_uploads/{attachment.path_id})"
701	        )
702	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:914:8
913	        attachment = Attachment.objects.last()
914	        assert attachment is not None
915	        self.assertEqual(attachment.realm, user_profile.realm)

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:1473:8
1472	        mail = mail_template.format(stream_to_address=stream_to_address, sender=sender)
1473	        subprocess.run(
1474	            [script, "-r", stream_to_address, "-s", settings.SHARED_SECRET, "-t"],
1475	            input=mail,
1476	            check=True,
1477	            text=True,
1478	        )
1479	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\tests\test_email_mirror.py:1488:12
1487	        mail = mail_template.format(stream_to_address=stream_to_address, sender=sender)
1488	        p = subprocess.run(
1489	            [script, "-s", settings.SHARED_SECRET, "-t"],
1490	            input=mail,
1491	            stdout=subprocess.PIPE,
1492	            text=True,
1493	        )
1494	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:1641:8
1640	        # https://github.com/python/typeshed/issues/2417
1641	        assert isinstance(incoming_message, EmailMessage)
1642	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_mirror.py:1666:8
1665	        # https://github.com/python/typeshed/issues/2417
1666	        assert isinstance(incoming_message, EmailMessage)
1667	

--------------------------------------------------
>> Issue: [B410:blacklist] Using lxml.html to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.html with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zerver\tests\test_email_notifications.py:11:0
10	import ldap
11	import lxml.html
12	import orjson

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:67:8
66	
67	        assert isinstance(msg, EmailMultiAlternatives)
68	        self.assertIn("Some heading</h1>", str(msg.alternatives[0][0]))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:95:8
94	        # Verify that the HTML version contains the footer.
95	        assert isinstance(msg, EmailMultiAlternatives)
96	        self.assertIn(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:443:8
442	        )
443	        assert scheduled_emails is not None
444	        self.assert_length(scheduled_emails, 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:472:8
471	        )
472	        assert scheduled_emails is not None
473	        self.assert_length(scheduled_emails, 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:605:8
604	        msg = mail.outbox[0]
605	        assert isinstance(msg, EmailMultiAlternatives)
606	        from_email = str(Address(display_name="Zulip notifications", addr_spec=FromAddress.NOREPLY))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:617:16
616	            for text in verify_body_include:
617	                assert isinstance(msg.alternatives[0][0], str)
618	                html = self.normalize_string(msg.alternatives[0][0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1464:8
1463	
1464	        assert isinstance(mail.outbox[0], EmailMultiAlternatives)
1465	        assert isinstance(mail.outbox[0].alternatives[0][0], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1465:8
1464	        assert isinstance(mail.outbox[0], EmailMultiAlternatives)
1465	        assert isinstance(mail.outbox[0].alternatives[0][0], str)
1466	        self.assertIn("Iago:\n> @**King Hamlet**\n\n--\nYou are", mail.outbox[0].body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1473:8
1472	
1473	        assert isinstance(mail.outbox[1], EmailMultiAlternatives)
1474	        assert isinstance(mail.outbox[1].alternatives[0][0], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1474:8
1473	        assert isinstance(mail.outbox[1], EmailMultiAlternatives)
1474	        assert isinstance(mail.outbox[1].alternatives[0][0], str)
1475	        self.assertIn("Iago:\n> * 1\n>  *2\n\n--\nYou are receiving", mail.outbox[1].body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1482:8
1481	
1482	        assert isinstance(mail.outbox[2], EmailMultiAlternatives)
1483	        assert isinstance(mail.outbox[2].alternatives[0][0], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1483:8
1482	        assert isinstance(mail.outbox[2], EmailMultiAlternatives)
1483	        assert isinstance(mail.outbox[2].alternatives[0][0], str)
1484	        self.assertEqual("> Hello\n\n--\n\nReply", mail.outbox[2].body[:18])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1747:12
1746	            output_data = lxml.html.tostring(fragment, encoding="unicode")
1747	            assert "spoiler-header" not in output_data
1748	            assert "spoiler-content" not in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1748:12
1747	            assert "spoiler-header" not in output_data
1748	            assert "spoiler-content" not in output_data
1749	            assert "spoiler-block" in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1749:12
1748	            assert "spoiler-content" not in output_data
1749	            assert "spoiler-block" in output_data
1750	            assert "spoiler-title" in output_data

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_email_notifications.py:1750:12
1749	            assert "spoiler-block" in output_data
1750	            assert "spoiler-title" in output_data
1751	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:30:8
29	    def test_pm_to_embedded_bot(self) -> None:
30	        assert self.bot_profile is not None
31	        self.send_personal_message(self.user_profile, self.bot_profile, content="help")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:36:8
35	        display_recipient = get_display_recipient(last_message.recipient)
36	        assert isinstance(display_recipient, list)
37	        self.assert_length(display_recipient, 1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:41:8
40	    def test_stream_message_to_embedded_bot(self) -> None:
41	        assert self.bot_profile is not None
42	        self.send_stream_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:61:8
60	    def test_message_to_embedded_bot_with_initialize(self) -> None:
61	        assert self.bot_profile is not None
62	        self.subscribe(self.user_profile, "Denmark")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_embedded_bot_system.py:75:8
74	    def test_embedded_bot_quit_exception(self) -> None:
75	        assert self.bot_profile is not None
76	        with patch(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_event_queue.py:821:8
820	        )
821	        assert msg_id is not None
822	        with mock.patch("zerver.tornado.event_queue.maybe_enqueue_notifications") as mock_enqueue:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'random'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_event_system.py:241:18
240	
241	        post_data["secret"] = "random"
242	        req = HostRequestMock(post_data, user_profile=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_event_system.py:926:16
925	            def accepts_event(self, event: Dict[str, Any]) -> bool:
926	                assert event["type"] == "message"
927	                return True

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:523:8
522	        check_message("events[0]", events[0])
523	        assert isinstance(events[0]["message"]["avatar_url"], str)
524	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:537:8
536	        check_message("events[0]", events[0])
537	        assert events[0]["message"]["avatar_url"] is None
538	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1535:8
1534	        mute_object = get_mute_object(self.user_profile, muted_user)
1535	        assert mute_object is not None
1536	        # This is a hack to silence mypy errors which result from it not taking

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1551:8
1550	        check_realm_user_update("events[0]", events[0], "avatar_fields")
1551	        assert isinstance(events[0]["person"]["avatar_url"], str)
1552	        assert isinstance(events[0]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1552:8
1551	        assert isinstance(events[0]["person"]["avatar_url"], str)
1552	        assert isinstance(events[0]["person"]["avatar_url_medium"], str)
1553	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1591:8
1590	        check_realm_user_update("events[1]", events[1], "avatar_fields")
1591	        assert isinstance(events[1]["person"]["avatar_url"], str)
1592	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1592:8
1591	        assert isinstance(events[1]["person"]["avatar_url"], str)
1592	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)
1593	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1611:8
1610	        check_realm_user_update("events[2]", events[2], "email")
1611	        assert isinstance(events[1]["person"]["avatar_url"], str)
1612	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:1612:8
1611	        assert isinstance(events[1]["person"]["avatar_url"], str)
1612	        assert isinstance(events[1]["person"]["avatar_url_medium"], str)
1613	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:2163:8
2162	        last_realm_playground = RealmPlayground.objects.last()
2163	        assert last_realm_playground is not None
2164	        last_id = last_realm_playground.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:2542:8
2541	        self.subscribe(hamlet, "Denmark")
2542	        assert url is not None
2543	        body = f"First message ...[zulip.txt](http://{hamlet.realm.host}" + url + ")"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_events.py:2602:8
2601	        ).first()
2602	        assert audit_log_entry is not None
2603	        audit_log_entry_id = audit_log_entry.id

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_example.py:164:17
163	
164	        params = dict(
165	            email="romeo@zulip.net",
166	            password="xxxx",
167	            full_name="Romeo Montague",
168	        )
169	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_example.py:191:23
190	        do_change_can_create_users(iago, False)
191	        valid_params = dict(
192	            email="romeo@zulip.net",
193	            password="xxxx",
194	            full_name="Romeo Montague",
195	        )
196	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_example.py:250:8
249	        row = UserStatus.objects.last()
250	        assert row is not None
251	        self.assertEqual(row.user_profile_id, cordelia.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_external.py:318:8
317	        # Having closed it, it's now cached.  Clear the cache.
318	        assert CircuitBreakerMonitor.get("get_tor_ips").closed
319	        cache_delete("tor_ip_addresses:")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:590:15
589	    def create_bot(self, owner: UserProfile, bot_email: str, bot_name: str) -> UserProfile:
590	        user = do_create_user(
591	            email=bot_email,
592	            password="123",
593	            realm=owner.realm,
594	            full_name=bot_name,
595	            bot_type=UserProfile.DEFAULT_BOT,
596	            bot_owner=owner,
597	            acting_user=None,
598	        )
599	        return user

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_home.py:602:15
601	    def create_non_active_user(self, realm: Realm, email: str, name: str) -> UserProfile:
602	        user = do_create_user(
603	            email=email, password="123", realm=realm, full_name=name, acting_user=None
604	        )
605	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_home.py:976:8
975	        furthest_read_time = get_furthest_read_time(hamlet)
976	        assert furthest_read_time is not None
977	        self.assertGreaterEqual(furthest_read_time, activity_time)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:140:8
139	        super().setUp()
140	        assert settings.LOCAL_UPLOADS_DIR is not None
141	        self.rm_tree(settings.LOCAL_UPLOADS_DIR)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:225:12
224	            # hex in order to avoid large directories.
225	            assert len(slot) <= 2
226	            self.assert_length(random_hash, 24)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:234:8
233	        file_name = realm_emoji.file_name
234	        assert file_name is not None
235	        assert file_name.endswith(".png")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:235:8
234	        assert file_name is not None
235	        assert file_name.endswith(".png")
236	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:287:12
286	            fn = export_fn(f"avatars/{path}")
287	            assert os.path.exists(fn)
288	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:300:8
299	
300	        assert exported_paths
301	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:579:8
578	        message = Message.objects.last()
579	        assert message is not None
580	        consented_user_ids = [self.example_user(user).id for user in ["iago", "hamlet"]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:588:8
587	
588	        assert message is not None
589	        self.export_realm(realm, consent_message_id=message.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:668:8
667	        # Third huddle is not exported since none of the members gave consent
668	        assert huddle_a is not None and huddle_b is not None
669	        huddle_recipients = Recipient.objects.filter(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:762:8
761	        reaction = Reaction.objects.order_by("id").last()
762	        assert reaction
763	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:805:8
804	        user_status = UserStatus.objects.order_by("id").last()
805	        assert user_status
806	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_import_export.py:811:22
810	        # data to test import of botstoragedata and botconfigdata
811	        bot_profile = do_create_user(
812	            email="bot-1@zulip.com",
813	            password="test",
814	            realm=original_realm,
815	            full_name="bot",
816	            bot_type=UserProfile.EMBEDDED_BOT,
817	            bot_owner=sample_user,
818	            acting_user=None,
819	        )
820	        storage = StateHandler(bot_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:836:12
835	            )
836	            assert new_realm_emoji is not None
837	        original_realm_emoji_count = RealmEmoji.objects.count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:881:12
880	            # the test is kind of meaningless
881	            assert orig_realm_result
882	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:976:12
975	            getters.append(f)
976	            assert f.__name__.startswith("get_")
977	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:979:12
978	            # Avoid dups
979	            assert f.__name__ not in names
980	            names.add(f.__name__)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:998:12
997	            recipient = Stream.objects.get(name="Verona", realm=r).recipient
998	            assert recipient is not None
999	            return recipient

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1088:12
1087	            names = {rec.name for rec in RealmEmoji.objects.filter(realm_id=r.id)}
1088	            assert "hawaii" in names
1089	            return names

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1098:12
1097	            }
1098	            assert (cordelia.full_name, "hawaii", "in Hawaii") in tups
1099	            return tups

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1332:8
1331	
1332	        assert settings.LOCAL_UPLOADS_DIR is not None
1333	        assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1333:8
1332	        assert settings.LOCAL_UPLOADS_DIR is not None
1333	        assert settings.LOCAL_FILES_DIR is not None
1334	        assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1334:8
1333	        assert settings.LOCAL_FILES_DIR is not None
1334	        assert settings.LOCAL_AVATARS_DIR is not None
1335	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1540:8
1539	        reaction = Reaction.objects.order_by("id").last()
1540	        assert reaction
1541	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1546:8
1545	        hi_stream_message_id = self.send_stream_message(cordelia, "Denmark", "hi stream")
1546	        assert most_recent_usermessage(cordelia).message_id == hi_stream_message_id
1547	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1601:12
1600	            table_name = f.__name__
1601	            assert table_name not in checkers
1602	            checkers[table_name] = f

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_import_export.py:1672:12
1671	        def zerver_reaction(records: List[Record]) -> None:
1672	            assert reaction
1673	            (exported_reaction,) = records

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_integrations.py:25:8
24	        integration = INTEGRATIONS["airbrake"]
25	        assert isinstance(integration, WebhookIntegration)
26	        screenshot_config = ScreenshotConfig("error_message.json", "002.png", "ci")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_integrations.py:33:8
32	        integration = INTEGRATIONS["nagios"]
33	        assert isinstance(integration, Integration)
34	        screenshot_config = BaseScreenshotConfig("service_notify.json", "001.png")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:520:8
519	        prereg_user = PreregistrationUser.objects.get(email=mirror_user.email)
520	        assert prereg_user.referred_by is not None and inviter is not None
521	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:981:8
980	        self.check_sent_emails(["newuser@zulip.com"])
981	        assert isinstance(mail.outbox[0], EmailMultiAlternatives)
982	        assert isinstance(mail.outbox[0].alternatives[0][0], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:982:8
981	        assert isinstance(mail.outbox[0], EmailMultiAlternatives)
982	        assert isinstance(mail.outbox[0].alternatives[0][0], str)
983	        body = self.normalize_string(mail.outbox[0].alternatives[0][0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:1160:8
1159	        prereg_user = obj.content_object
1160	        assert prereg_user is not None
1161	        prereg_user.email = "invalid.email"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:1333:8
1332	        confirmation = Confirmation.objects.last()
1333	        assert confirmation is not None
1334	        self.assertEqual(confirmation.expiry_date, None)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_invite.py:1417:19
1416	        email = self.nonreg_email("alice")
1417	        password = "password"
1418	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_invite.py:1447:19
1446	        email = self.nonreg_email("alice")
1447	        password = "password"
1448	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_invite.py:1482:19
1481	        email = self.nonreg_email("alice")
1482	        password = "password"
1483	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:2038:8
2037	        inviter = UserProfile.objects.exclude(realm=get_realm("zulip")).first()
2038	        assert inviter is not None
2039	        prereg_user = PreregistrationUser.objects.create(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_invite.py:2050:19
2049	        email = self.nonreg_email("alice")
2050	        password = "password"
2051	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:2067:8
2066	        confirmation = Confirmation.objects.get(confirmation_key=registration_key)
2067	        assert confirmation.content_object is not None
2068	        prereg_user = confirmation.content_object

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_invite.py:2135:19
2134	    def check_user_able_to_register(self, email: str, invite_link: str) -> None:
2135	        password = "password"
2136	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:2158:8
2157	
2158	        assert prereg_user is not None
2159	        self.assertEqual(prereg_user.email, email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_invite.py:2191:8
2190	        multiuse_invite = MultiuseInvite.objects.last()
2191	        assert multiuse_invite is not None
2192	        do_revoke_multi_use_invite(multiuse_invite)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:67:8
66	        data = get_oembed_data(url)
67	        assert data is not None
68	        self.assertIsInstance(data, UrlEmbedData)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:96:8
95	        data = get_oembed_data(url)
96	        assert data is not None
97	        self.assertIsInstance(data, UrlOEmbedData)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:123:8
122	        data = get_oembed_data(url)
123	        assert data is not None
124	        self.assertIsInstance(data, UrlOEmbedData)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:376:8
375	        msg = Message.objects.select_related("sender").get(id=msg_id)
376	        assert msg.rendered_content is not None
377	        self.assertIn(embedded_link, msg.rendered_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:406:8
405	        msg = Message.objects.select_related("sender").get(id=msg_id)
406	        assert msg.rendered_content is not None
407	        self.assertNotIn(f'<a href="{url}" title="The Rock">The Rock</a>', msg.rendered_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:453:12
452	            msg = Message.objects.select_related("sender").get(id=msg_id)
453	            assert msg.rendered_content is not None
454	            # The content of the message has changed since the event for original_url has been created,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:468:20
467	                    msg = Message.objects.select_related("sender").get(id=msg_id)
468	                    assert msg.rendered_content is not None
469	                    self.assertIn(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:721:8
720	
721	        assert cached_data is not None
722	        self.assertIsNotNone(cached_data.title)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:760:8
759	
760	        assert cached_data is not None
761	        self.assertIsNotNone(cached_data.title)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:797:8
796	
797	        assert cached_data is not None
798	        self.assertIsNotNone(cached_data.title)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:830:8
829	
830	        assert cached_data is not None
831	        msg = Message.objects.select_related("sender").get(id=msg_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:832:8
831	        msg = Message.objects.select_related("sender").get(id=msg_id)
832	        assert msg.rendered_content is not None
833	        self.assertIn(cached_data.title, msg.rendered_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:834:8
833	        self.assertIn(cached_data.title, msg.rendered_content)
834	        assert cached_data.image is not None
835	        self.assertIn(re.sub(r"([^\w-])", r"\\\1", cached_data.image), msg.rendered_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_link_embed.py:958:8
957	        msg.refresh_from_db()
958	        assert msg.rendered_content is not None
959	        self.assertIn(f'a data-id="{escape(mocked_data.html)}"', msg.rendered_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:136:8
135	        self.assertIn("user", report)
136	        assert isinstance(report["user"], dict)
137	        self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:149:8
148	        record = self.simulate_error()
149	        assert isinstance(record, HasRequest)
150	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:153:8
152	        self.assertIn("user", report)
153	        assert isinstance(report["user"], dict)
154	        self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:175:8
174	        self.assertIn("user", report)
175	        assert isinstance(report["user"], dict)
176	        self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:191:12
190	            self.assertIn("user", report)
191	            assert isinstance(report["user"], dict)
192	            self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:205:8
204	        self.assertIn("user", report)
205	        assert isinstance(report["user"], dict)
206	        self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:236:8
235	        self.assertIn("user", report)
236	        assert isinstance(report["user"], dict)
237	        self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:248:8
247	        self.assertIn("user", report)
248	        assert isinstance(report["user"], dict)
249	        self.assertIn("user_email", report["user"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_logging_handlers.py:271:16
270	            for handler in logger.handlers:
271	                assert not isinstance(handler, AdminEmailHandler)
272	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_management_commands.py:211:8
210	        ]
211	        assert self.commands
212	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_management_commands.py:527:8
526	        message = Message.objects.last()
527	        assert message is not None
528	        do_add_reaction(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:219:19
218	        def make_user(email: str, full_name: str) -> UserProfile:
219	            return create_user(
220	                email=email,
221	                password="whatever",
222	                realm=realm,
223	                full_name=full_name,
224	            )
225	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_markdown.py:276:8
275	        user = mention_data.get_user_by_name("king hamLET")
276	        assert user is not None
277	        self.assertEqual(user.full_name, hamlet.full_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_markdown.py:1230:8
1229	        ).get()
1230	        assert realm_emoji.file_name is not None
1231	        self.assertEqual(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:2384:19
2383	        def make_user(email: str, full_name: str) -> UserProfile:
2384	            return create_user(
2385	                email=email,
2386	                password="whatever",
2387	                realm=realm,
2388	                full_name=full_name,
2389	            )
2390	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'whatever'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_markdown.py:2439:20
2438	        # Create a user that potentially interferes with the pattern.
2439	        test_user = create_user(
2440	            email="atomic@example.com",
2441	            password="whatever",
2442	            realm=realm,
2443	            full_name="Atomic #123",
2444	        )
2445	        content = "@**Atomic #123**"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_dict.py:457:8
456	        # Cause the display_recipient to get cached:
457	        assert cordelia_recipient is not None
458	        get_display_recipient(cordelia_recipient)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:4016:8
4015	        # Check topic resolved notification message is only unread for participants.
4016	        assert (
4017	            UserMessage.objects.filter(
4018	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[2].id
4019	            )
4020	            .extra(where=[UserMessage.where_unread()])
4021	            .count()
4022	            == 3
4023	        )
4024	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:4017:12
4016	        assert (
4017	            UserMessage.objects.filter(
4018	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[2].id
4019	            )
4020	            .extra(where=[UserMessage.where_unread()])
4021	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:4025:8
4024	
4025	        assert (
4026	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[2].id)
4027	            .extra(where=[UserMessage.where_unread()])
4028	            .count()
4029	            == 0
4030	        )
4031	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:4026:12
4025	        assert (
4026	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[2].id)
4027	            .extra(where=[UserMessage.where_unread()])
4028	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:4089:8
4088	        # Check topic unresolved notification message is only unread for participants.
4089	        assert (
4090	            UserMessage.objects.filter(
4091	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[4].id
4092	            )
4093	            .extra(where=[UserMessage.where_unread()])
4094	            .count()
4095	            == 3
4096	        )
4097	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:4090:12
4089	        assert (
4090	            UserMessage.objects.filter(
4091	                user_profile__in=[admin_user, hamlet, aaron], message__id=messages[4].id
4092	            )
4093	            .extra(where=[UserMessage.where_unread()])
4094	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_edit.py:4098:8
4097	
4098	        assert (
4099	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[4].id)
4100	            .extra(where=[UserMessage.where_unread()])
4101	            .count()
4102	            == 0
4103	        )
4104	

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_edit.py:4099:12
4098	        assert (
4099	            UserMessage.objects.filter(user_profile=cordelia, message__id=messages[4].id)
4100	            .extra(where=[UserMessage.where_unread()])
4101	            .count()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1438:12
1437	        for message in result["messages"]:
1438	            assert message["id"] in message_ids
1439	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1450:12
1449	        for message in result["messages"]:
1450	            assert message["id"] in message_ids
1451	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1459:8
1458	        scotland_stream = get_stream("Scotland", hamlet_user.realm)
1459	        assert scotland_stream.recipient_id is not None
1460	        assert hamlet_user.recipient_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1460:8
1459	        assert scotland_stream.recipient_id is not None
1460	        assert hamlet_user.recipient_id is not None
1461	        assert othello_user.recipient_id is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1461:8
1460	        assert hamlet_user.recipient_id is not None
1461	        assert othello_user.recipient_id is not None
1462	        query_ids["scotland_recipient"] = scotland_stream.recipient_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1808:12
1807	        def dr_emails(dr: DisplayRecipientT) -> str:
1808	            assert isinstance(dr, list)
1809	            return ",".join(sorted({*(r["email"] for r in dr), me.email}))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:1812:12
1811	        def dr_ids(dr: DisplayRecipientT) -> List[int]:
1812	            assert isinstance(dr, list)
1813	            return sorted({*(r["id"] for r in dr), self.example_user("hamlet").id})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:2120:8
2119	        stream_name = get_display_recipient(stream_messages[0].recipient)
2120	        assert isinstance(stream_name, str)
2121	        stream_id = get_stream(stream_name, stream_messages[0].get_realm()).id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:2823:16
2822	            for message in messages:
2823	                assert message["id"] in message_ids
2824	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_fetch.py:3602:8
3601	        stream = get_stream("Scotland", realm)
3602	        assert stream.recipient is not None
3603	        recipient_id = stream.recipient.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_flags.py:47:4
46	    """
47	    assert "has_alert_word" not in expected
48	    flag_set = set(flags)

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:258:12
257	        self.assertCountEqual(
258	            UserMessage.objects.filter(user_profile_id=user.id, message_id__in=message_ids)
259	            .extra(where=[UserMessage.where_read()])
260	            .values_list("message_id", flat=True),

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:291:12
290	        self.assertCountEqual(
291	            UserMessage.objects.filter(user_profile_id=user.id, message_id__in=message_ids)
292	            .extra(where=[UserMessage.where_starred()])
293	            .values_list("message_id", flat=True),

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:564:12
563	        return list(
564	            UserMessage.objects.filter(
565	                user_profile=user_profile,
566	            )
567	            .extra(
568	                where=[UserMessage.where_active_push_notification()],
569	            )
570	            .order_by("message_id")

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:670:12
669	        unread_count = (
670	            UserMessage.objects.filter(user_profile=hamlet)
671	            .extra(where=[UserMessage.where_unread()])
672	            .count()

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\tests\test_message_flags.py:680:12
679	        new_unread_count = (
680	            UserMessage.objects.filter(user_profile=hamlet)
681	            .extra(where=[UserMessage.where_unread()])
682	            .count()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:292:28
291	        # Bots without owner (except cross realm bot) cannot send to announcement only streams
292	        bot_without_owner = do_create_user(
293	            email="free-bot@zulip.testserver",
294	            password="",
295	            realm=non_admin_profile.realm,
296	            full_name="freebot",
297	            bot_type=UserProfile.DEFAULT_BOT,
298	            acting_user=None,
299	        )
300	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:374:28
373	        # Bots without owner (except cross realm bot) cannot send to STREAM_POST_POLICY_MODERATORS streams.
374	        bot_without_owner = do_create_user(
375	            email="free-bot@zulip.testserver",
376	            password="",
377	            realm=non_admin_profile.realm,
378	            full_name="freebot",
379	            bot_type=UserProfile.DEFAULT_BOT,
380	            acting_user=None,
381	        )
382	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:466:28
465	        # STREAM_POST_POLICY_RESTRICT_NEW_MEMBERS streams
466	        bot_without_owner = do_create_user(
467	            email="free-bot@zulip.testserver",
468	            password="",
469	            realm=non_admin_profile.realm,
470	            full_name="freebot",
471	            bot_type=UserProfile.DEFAULT_BOT,
472	            acting_user=None,
473	        )
474	        self._send_and_verify_message(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1287:8
1286	        # We subscribe the bot owner! (aka cordelia)
1287	        assert bot.bot_owner is not None
1288	        self.subscribe(bot.bot_owner, stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1408:8
1407	        recipient = stream.recipient
1408	        assert recipient is not None
1409	        sending_client = make_client(name="test suite")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:1519:8
1518	        message = most_recent_message(user_profile)
1519	        assert UserMessage.objects.get(
1520	            user_profile=user_profile, message=message
1521	        ).flags.mentioned.is_set
1522	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:1602:21
1601	
1602	        normal_bot = do_create_user(
1603	            email="normal-bot@zulip.com",
1604	            password="",
1605	            realm=realm,
1606	            full_name="Normal Bot",
1607	            bot_type=UserProfile.DEFAULT_BOT,
1608	            bot_owner=cordelia,
1609	            acting_user=None,
1610	        )
1611	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:2118:8
2117	        )
2118	        assert result is not None
2119	        message = result.message

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_message_send.py:2483:14
2482	        parent = self.example_user("othello")
2483	        bot = do_create_user(
2484	            email="othello-bot@zulip.com",
2485	            password="",
2486	            realm=parent.realm,
2487	            full_name="",
2488	            bot_type=UserProfile.DEFAULT_BOT,
2489	            bot_owner=parent,
2490	            acting_user=None,
2491	        )
2492	        bot.last_reminder = None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_message_send.py:2521:8
2520	        # stream doesn't exist
2521	        assert sender.last_reminder is not None
2522	        sender.last_reminder = sender.last_reminder - datetime.timedelta(hours=1)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_middleware.py:83:8
82	        ).get("content")
83	        assert isinstance(open_graph_description, str)
84	        for substring in in_description:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_middleware.py:236:8
235	
236	        assert isinstance(open_graph_url, str)
237	        self.assertTrue(open_graph_url.endswith("/api/"))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_mirror_users.py:96:8
95	
96	        assert mirror_sender is not None
97	        self.assertEqual(mirror_sender.email, sender_email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:95:8
94	        }
95	        assert expected_item in actual
96	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:403:16
402	                # The only content-type we use in our API is application/json.
403	                assert "schema" in element["content"]["application/json"]
404	                # If content_type is application/json, then the

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:451:16
450	                vname = defval.post_var_name
451	                assert vname is not None
452	                if vname in json_params:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:473:8
472	        # After the above operations `json_params` should be empty.
473	        assert len(json_params) == 0
474	        diff = openapi_params - function_params

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:600:24
599	                        print(" -", accepted_arguments)
600	                        assert url_pattern in self.buggy_documentation_endpoints
601	                    elif len(openapi_parameter_names - accepted_arguments) > 0:  # nocoverage

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:607:24
606	                        print(" +", accepted_arguments)
607	                        assert url_pattern in self.buggy_documentation_endpoints
608	                    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:933:16
932	                # Check if every file has an operationId
933	                assert "operationId" in operation
934	                assert "tags" in operation

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:934:16
933	                assert "operationId" in operation
934	                assert "tags" in operation
935	                tag = operation["tags"][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:936:16
935	                tag = operation["tags"][0]
936	                assert tag in VALID_TAGS
937	                for status_code, response in operation["responses"].items():

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:942:28
941	                            validate_schema(subschema)
942	                            assert validate_against_openapi_schema(
943	                                subschema["example"],
944	                                path,
945	                                method,
946	                                status_code,
947	                            )
948	                        continue

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:950:20
949	                    validate_schema(schema)
950	                    assert validate_against_openapi_schema(
951	                        schema["example"], path, method, status_code
952	                    )
953	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:963:8
962	        # some of the documented endpoints.
963	        assert find_openapi_endpoint("/users/me/presence") is None
964	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:964:8
963	        assert find_openapi_endpoint("/users/me/presence") is None
964	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None
965	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:965:8
964	        assert find_openapi_endpoint("/users/me/subscriptions/23") is None
965	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None
966	        assert find_openapi_endpoint("/messages/matches_narrow") is None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:966:8
965	        assert find_openapi_endpoint("/users/iago/subscriptions/23") is None
966	        assert find_openapi_endpoint("/messages/matches_narrow") is None
967	        # Making sure documented endpoints are matched correctly.

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:968:8
967	        # Making sure documented endpoints are matched correctly.
968	        assert (
969	            find_openapi_endpoint("/users/23/subscriptions/21")
970	            == "/users/{user_id}/subscriptions/{stream_id}"
971	        )
972	        assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:972:8
971	        )
972	        assert (
973	            find_openapi_endpoint("/users/iago@zulip.com/presence")
974	            == "/users/{user_id_or_email}/presence"
975	        )
976	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:976:8
975	        )
976	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"
977	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:977:8
976	        assert find_openapi_endpoint("/users/iago@zulip.com") == "/users/{email}"
977	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"
978	        assert find_openapi_endpoint("/realm/emoji/realm_emoji_1") == "/realm/emoji/{emoji_name}"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_openapi.py:978:8
977	        assert find_openapi_endpoint("/messages/23") == "/messages/{message_id}"
978	        assert find_openapi_endpoint("/realm/emoji/realm_emoji_1") == "/realm/emoji/{emoji_name}"
979	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:24:23
23	        service_class = get_service_interface_class("whatever")  # GenericOutgoingWebhookService
24	        self.handler = service_class(
25	            service_name="test-service", token="abcdef", user_profile=self.bot_user
26	        )
27	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_interfaces.py:192:23
191	        service_class = get_service_interface_class(SLACK_INTERFACE)
192	        self.handler = service_class(
193	            token="abcdef", user_profile=self.bot_user, service_name="test-service"
194	        )
195	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:133:12
132	            final_response = do_rest_call("", mock_event, service_handler)
133	            assert final_response is not None
134	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:148:8
147	
148	        assert bot_user.bot_owner is not None
149	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:190:12
189	            final_response = do_rest_call("", mock_event, service_handler)
190	            assert final_response is not None
191	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:208:8
207	
208	        assert bot_user.bot_owner is not None
209	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:221:12
220	                final_response = do_rest_call("https://example.com/", mock_event, service_handler)
221	            assert final_response is not None
222	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:251:12
250	            self.assertIn("triggered", bot_owner_notification.content)
251	            assert bot_user.bot_owner is not None
252	            self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:294:8
293	        )
294	        assert bot_user.bot_owner is not None
295	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:323:8
322	            )
323	        assert bot_user.bot_owner is not None
324	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:350:8
349	            )
350	        assert bot_user.bot_owner is not None
351	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:379:8
378	            )
379	        assert bot_user.bot_owner is not None
380	        self.assertEqual(bot_owner_notification.recipient_id, bot_user.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'weather_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:408:8
407	
408	        add_service(
409	            "weather",
410	            user_profile=bot,
411	            interface=Service.GENERIC,
412	            base_url="https://weather.example.com/",
413	            token="weather_token",
414	        )
415	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'qotd_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:416:8
415	
416	        add_service(
417	            "qotd",
418	            user_profile=bot,
419	            interface=Service.GENERIC,
420	            base_url="https://qotd.example.com/",
421	            token="qotd_token",
422	        )
423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_outgoing_webhook_system.py:605:8
604	        self.assertEqual(last_message.sender_id, bot.id)
605	        assert bot.bot_owner is not None
606	        self.assertEqual(last_message.recipient_id, bot.bot_owner.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_presence.py:736:8
735	        )
736	        assert presence.last_active_time is not None and presence.last_connected_time is not None
737	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_presence.py:753:8
752	        )
753	        assert presence.last_active_time is not None and presence.last_connected_time is not None
754	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_presence.py:770:8
769	        )
770	        assert presence.last_active_time is not None and presence.last_connected_time is not None
771	        self.assertEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:109:8
108	    def request_callback(self, request: PreparedRequest) -> Tuple[int, ResponseHeaders, bytes]:
109	        assert isinstance(request.body, str) or request.body is None
110	        params: Dict[str, List[str]] = parse.parse_qs(request.body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:116:8
115	        data = {k: v[0] for k, v in params.items()}
116	        assert request.url is not None  # allow mypy to infer url is present.
117	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:117:8
116	        assert request.url is not None  # allow mypy to infer url is present.
117	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
118	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:127:8
126	        # Match any endpoint with the PUSH_NOTIFICATION_BOUNCER_URL.
127	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
128	        COMPILED_URL = re.compile(settings.PUSH_NOTIFICATION_BOUNCER_URL + ".*")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:134:16
133	        user_id = 10
134	        token = "111222"
135	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:144:16
143	    def test_unregister_remote_push_user_params(self) -> None:
144	        token = "111222"
145	        token_kind = PushDeviceToken.GCM

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:179:16
178	    def test_register_remote_push_user_params(self) -> None:
179	        token = "111222"
180	        user_id = 11

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '111222'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:279:16
278	        hamlet = self.example_user("hamlet")
279	        token = "111222"
280	        user_id = hamlet.id

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'aaaa'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_push_notifications.py:337:16
336	        server = RemoteZulipServer.objects.get(uuid=self.server_uuid)
337	        token = "aaaa"
338	        android_tokens = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:498:12
497	
498	            assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
499	            URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/register"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:592:8
591	        """
592	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
593	        ANALYTICS_URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/server/analytics"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:610:8
609	        audit_log = RealmAuditLog.objects.all().order_by("id").last()
610	        assert audit_log is not None
611	        audit_log_max_id = audit_log.id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:803:8
802	        )
803	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
804	        ANALYTICS_URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/server/analytics"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:870:8
869	        remote_log_entry = RemoteRealmAuditLog.objects.order_by("id").last()
870	        assert remote_log_entry is not None
871	        self.assertEqual(str(remote_log_entry.server.uuid), self.server_uuid)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:976:8
975	    def request_callback(self, request: PreparedRequest) -> Tuple[int, ResponseHeaders, bytes]:
976	        assert request.url is not None  # allow mypy to infer url is present.
977	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:977:8
976	        assert request.url is not None  # allow mypy to infer url is present.
977	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
978	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:979:8
978	        local_url = request.url.replace(settings.PUSH_NOTIFICATION_BOUNCER_URL, "")
979	        assert isinstance(request.body, bytes)
980	        result = self.uuid_post(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1127:8
1126	        }
1127	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
1128	        URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/notify"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1656:16
1655	                apns_context = get_apns_context()
1656	                assert apns_context is not None
1657	                try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:1659:20
1658	                    mock_load_cert_chain.assert_called_once_with("/foo.pem")
1659	                    assert apns_context.apns.pool.loop == apns_context.loop
1660	                finally:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2245:8
2244	    ) -> None:
2245	        assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
2246	        URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/register"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2328:16
2327	            ), responses.RequestsMock() as resp:
2328	                assert settings.PUSH_NOTIFICATION_BOUNCER_URL is not None
2329	                URL = settings.PUSH_NOTIFICATION_BOUNCER_URL + "/api/v1/remotes/push/unregister"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2611:12
2610	        with mock_queue_publish("zerver.actions.message_flags.queue_json_publish") as mock_publish:
2611	            assert stream.recipient_id is not None
2612	            do_mark_stream_messages_as_read(hamlet, stream.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_push_notifications.py:2683:8
2682	        ).last()
2683	        assert remote_realm_audit_log is not None
2684	        self.assertTrue(server.deactivated)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:40:12
39	        def collect(events: List[Dict[str, Any]]) -> None:
40	            assert isinstance(queue_client, SimpleQueueClient)
41	            assert len(events) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:41:12
40	            assert isinstance(queue_client, SimpleQueueClient)
41	            assert len(events) == 1
42	            output.append(events[0])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:60:12
59	        def collect(events: List[Dict[str, Any]]) -> None:
60	            assert isinstance(queue_client, SimpleQueueClient)
61	            assert len(events) == 1

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:61:12
60	            assert isinstance(queue_client, SimpleQueueClient)
61	            assert len(events) == 1
62	            queue_client.stop_consuming()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:84:8
83	        queue_client = get_queue_client()
84	        assert isinstance(queue_client, SimpleQueueClient)
85	        actual_publish = queue_client.publish

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:104:8
103	
104	        assert queue_client.channel
105	        method, header, message = queue_client.channel.basic_get("test_suite")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:106:8
105	        method, header, message = queue_client.channel.basic_get("test_suite")
106	        assert method is not None
107	        assert method.delivery_tag is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:107:8
106	        assert method is not None
107	        assert method.delivery_tag is not None
108	        assert message is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:108:8
107	        assert method.delivery_tag is not None
108	        assert message is not None
109	        queue_client.channel.basic_ack(method.delivery_tag)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:114:8
113	        method, header, message = queue_client.channel.basic_get("test_suite")
114	        assert message is None
115	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue.py:119:8
118	        queue_client = get_queue_client()
119	        assert queue_client.channel
120	        queue_client.channel.queue_declare("test_suite", durable=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_queue_worker.py:167:8
166	        )
167	        assert (
168	            hamlet.email_notifications_batching_period_seconds
169	            == othello.email_notifications_batching_period_seconds
170	        )
171	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_read_receipts.py:270:8
269	        mute_object = get_mute_object(cordelia, othello)
270	        assert mute_object is not None
271	        mute_object.delete()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:312:8
311	        ).last()
312	        assert realm_audit_log is not None
313	        expected_extra_data = {"old_subdomain": "zulip", "new_subdomain": "newzulip"}

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:380:8
379	        log_entry = RealmAuditLog.objects.last()
380	        assert log_entry is not None
381	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:398:8
397	        latest_log_entry = RealmAuditLog.objects.last()
398	        assert latest_log_entry is not None
399	        self.assertEqual(latest_log_entry.id, log_entry_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:427:8
426	        confirmation = Confirmation.objects.last()
427	        assert confirmation is not None
428	        self.assertEqual(confirmation.content_object, obj)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:486:8
485	        realm = get_realm("zulip")
486	        assert realm.notifications_stream is not None
487	        self.assertEqual(realm.notifications_stream.id, new_notif_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:494:8
493	        realm = get_realm("zulip")
494	        assert realm.notifications_stream is not None
495	        self.assertNotEqual(realm.notifications_stream.id, invalid_notif_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:502:8
501	        notifications_stream = realm.get_notifications_stream()
502	        assert notifications_stream is not None
503	        self.assertEqual(notifications_stream.id, verona.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:512:8
511	        notifications_stream = realm.get_notifications_stream()
512	        assert notifications_stream is not None
513	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:555:8
554	        realm = get_realm("zulip")
555	        assert realm.signup_notifications_stream is not None
556	        self.assertEqual(realm.signup_notifications_stream.id, new_signup_notifications_stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:567:8
566	        realm = get_realm("zulip")
567	        assert realm.signup_notifications_stream is not None
568	        self.assertNotEqual(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:579:8
578	        signup_notifications_stream = realm.get_signup_notifications_stream()
579	        assert signup_notifications_stream is not None
580	        self.assertEqual(signup_notifications_stream, verona)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:752:8
751	        ).last()
752	        assert realm_audit_log is not None
753	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:774:8
773	        ).last()
774	        assert realm_audit_log is not None
775	        expected_extra_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:879:8
878	
879	        assert realm.notifications_stream is not None
880	        self.assertEqual(realm.notifications_stream.name, "general")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:883:8
882	
883	        assert realm.signup_notifications_stream is not None
884	        self.assertEqual(realm.signup_notifications_stream.name, "core team")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:916:8
915	
916	        assert realm.notifications_stream is not None
917	        self.assertEqual(realm.notifications_stream.name, "general")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:920:8
919	
920	        assert realm.signup_notifications_stream is not None
921	        self.assertEqual(realm.signup_notifications_stream.name, "core team")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:1223:8
1222	        invalid_org_type = 1
1223	        assert invalid_org_type not in vals
1224	        result = self.client_patch("/json/realm", {"org_type": invalid_org_type})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:1380:8
1379	            vals = bool_tests
1380	        assert vals is not None
1381	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:1421:8
1420	        Attachment.objects.filter(realm=realm).delete()
1421	        assert settings.LOCAL_UPLOADS_DIR is not None
1422	        assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:1422:8
1421	        assert settings.LOCAL_UPLOADS_DIR is not None
1422	        assert settings.LOCAL_FILES_DIR is not None
1423	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:1480:8
1479	        Attachment.objects.filter(realm=lear).delete()
1480	        assert settings.LOCAL_UPLOADS_DIR is not None
1481	        assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm.py:1481:8
1480	        assert settings.LOCAL_UPLOADS_DIR is not None
1481	        assert settings.LOCAL_FILES_DIR is not None
1482	        file_paths = []

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_emoji.py:74:8
73	        realm_emoji = RealmEmoji.objects.get(name="my_emoji")
74	        assert realm_emoji.author is not None
75	        self.assertEqual(realm_emoji.author.email, email)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_emoji.py:105:8
104	        realm_emoji = RealmEmoji.objects.get(name="smile")
105	        assert realm_emoji.author is not None
106	        self.assertEqual(realm_emoji.author.email, email)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_realm_emoji.py:369:25
368	        realm_1 = do_create_realm("test_realm", "test_realm")
369	        emoji_author_1 = do_create_user(
370	            "abc@example.com", password="abc", realm=realm_1, full_name="abc", acting_user=None
371	        )
372	        self.create_test_emoji("test_emoji", emoji_author_1)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'abc'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_realm_emoji.py:382:23
381	        realm_1 = do_create_realm("test_realm", "test_realm")
382	        emoji_author = do_create_user(
383	            "abc@example.com", password="abc", realm=realm_1, full_name="abc", acting_user=None
384	        )
385	        emoji_name = "emoji_test"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:66:8
65	        ).first()
66	        assert audit_log_entry is not None
67	        self.assertEqual(audit_log_entry.acting_user_id, admin.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:71:8
70	        extra_data = audit_log_entry.extra_data
71	        assert extra_data is not None
72	        export_path = orjson.loads(extra_data)["export_path"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:73:8
72	        export_path = orjson.loads(extra_data)["export_path"]
73	        assert export_path.startswith("/")
74	        path_id = export_path[1:]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:104:8
103	        extra_data = audit_log_entry.extra_data
104	        assert extra_data is not None
105	        export_data = orjson.loads(extra_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:137:8
136	        ).first()
137	        assert audit_log_entry is not None
138	        self.assertEqual(audit_log_entry.acting_user_id, admin.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:142:8
141	        extra_data = audit_log_entry.extra_data
142	        assert extra_data is not None
143	        export_path = orjson.loads(extra_data).get("export_path")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_realm_export.py:172:8
171	        extra_data = audit_log_entry.extra_data
172	        assert extra_data is not None
173	        export_data = orjson.loads(extra_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:147:8
146	        )
147	        assert msg_id is not None
148	        return msg_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:160:8
159	        )
160	        assert msg_id is not None
161	        return msg_id

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_retention.py:624:8
623	        archive_transaction = ArchiveTransaction.objects.last()
624	        assert archive_transaction is not None
625	        self.assertEqual(archive_transaction.realm, realm)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_scim.py:337:8
336	        new_user = UserProfile.objects.last()
337	        assert new_user is not None
338	        self.assertEqual(new_user.delivery_email, "newuser@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_scim.py:366:8
365	        new_user = UserProfile.objects.last()
366	        assert new_user is not None
367	        self.assertEqual(new_user.delivery_email, "newuser@zulip.com")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_send_email.py:174:13
173	        # Empty string is OK
174	        with self.settings(EMAIL_HOST_USER="test", EMAIL_HOST_PASSWORD=""):
175	            send_email(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:28:23
27	    def _get_outgoing_bot(self) -> UserProfile:
28	        outgoing_bot = do_create_user(
29	            email="bar-bot@zulip.com",
30	            password="test",
31	            realm=get_realm("zulip"),
32	            full_name="BarBot",
33	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
34	            bot_owner=self.example_user("cordelia"),
35	            acting_user=None,
36	        )
37	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:42:8
41	        sender = self.example_user("hamlet")
42	        assert not sender.is_bot
43	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:45:8
44	        outgoing_bot = self._get_outgoing_bot()
45	        assert outgoing_bot.bot_type is not None
46	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:67:8
66	        sender = self.example_user("hamlet")
67	        assert not sender.is_bot
68	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:70:8
69	        outgoing_bot = self._get_outgoing_bot()
70	        assert outgoing_bot.bot_type is not None
71	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:91:8
90	        sender = self.example_user("hamlet")
91	        assert not sender.is_bot
92	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:94:8
93	        outgoing_bot = self._get_outgoing_bot()
94	        assert outgoing_bot.bot_type is not None
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:126:8
125	        sender = self.example_user("hamlet")
126	        assert not sender.is_bot
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:129:8
128	        outgoing_bot = self._get_outgoing_bot()
129	        assert outgoing_bot.bot_type is not None
130	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:177:27
176	        self.user_profile = self.example_user("othello")
177	        self.bot_profile = do_create_user(
178	            email="embedded-bot-1@zulip.com",
179	            password="test",
180	            realm=get_realm("zulip"),
181	            full_name="EmbeddedBo1",
182	            bot_type=UserProfile.EMBEDDED_BOT,
183	            bot_owner=self.user_profile,
184	            acting_user=None,
185	        )
186	        self.second_bot_profile = do_create_user(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:186:34
185	        )
186	        self.second_bot_profile = do_create_user(
187	            email="embedded-bot-2@zulip.com",
188	            password="test",
189	            realm=get_realm("zulip"),
190	            full_name="EmbeddedBot2",
191	            bot_type=UserProfile.EMBEDDED_BOT,
192	            bot_owner=self.user_profile,
193	            acting_user=None,
194	        )
195	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:458:27
457	        self.user_profile = self.example_user("othello")
458	        self.bot_profile = do_create_user(
459	            email="foo-bot@zulip.com",
460	            password="test",
461	            realm=get_realm("zulip"),
462	            full_name="FooBot",
463	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
464	            bot_owner=self.user_profile,
465	            acting_user=None,
466	        )
467	        self.second_bot_profile = do_create_user(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_service_bot_system.py:467:34
466	        )
467	        self.second_bot_profile = do_create_user(
468	            email="bar-bot@zulip.com",
469	            password="test",
470	            realm=get_realm("zulip"),
471	            full_name="BarBot",
472	            bot_type=UserProfile.OUTGOING_WEBHOOK_BOT,
473	            bot_owner=self.user_profile,
474	            acting_user=None,
475	        )
476	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:490:12
489	        ) -> None:
490	            assert self.bot_profile.bot_type
491	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:533:12
532	        ) -> None:
533	            assert self.bot_profile.bot_type
534	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_service_bot_system.py:575:12
574	        ) -> None:
575	            assert self.bot_profile.bot_type
576	            self.assertEqual(queue_name, BOT_TYPE_TO_QUEUE_NAME[self.bot_profile.bot_type])

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:54:12
53	            "/json/settings",
54	            dict(
55	                full_name="Foo Bar",
56	                old_password=initial_password(user.delivery_email),
57	                new_password="foobar1",
58	            ),
59	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:72:12
71	        self.assertTrue(
72	            self.client.login(
73	                request=request,
74	                username=user.delivery_email,
75	                password="foobar1",
76	                realm=user.realm,
77	            ),
78	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'easy'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:86:16
85	                "/json/settings",
86	                dict(
87	                    full_name="Foo Bar",
88	                    old_password=initial_password(self.example_email("hamlet")),
89	                    new_password="easy",
90	                ),
91	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'f657gdGGk9'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:96:16
95	                "/json/settings",
96	                dict(
97	                    full_name="Foo Bar",
98	                    old_password=initial_password(self.example_email("hamlet")),
99	                    new_password="f657gdGGk9",
100	                ),
101	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:235:12
234	            "/json/settings",
235	            dict(
236	                old_password="bad_password",
237	                new_password="ignored",
238	            ),
239	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:250:20
249	                    "/json/settings",
250	                    dict(
251	                        old_password="bad_password",
252	                        new_password="ignored",
253	                    ),
254	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'bad_password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:258:20
257	                    "/json/settings",
258	                    dict(
259	                        old_password="bad_password",
260	                        new_password="ignored",
261	                    ),
262	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:268:20
267	                    "/json/settings",
268	                    dict(
269	                        old_password=initial_password(self.example_email("hamlet")),
270	                        new_password="ignored",
271	                    ),
272	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'foobar1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:281:20
280	                    "/json/settings",
281	                    dict(
282	                        old_password=initial_password(self.example_email("hamlet")),
283	                        new_password="foobar1",
284	                    ),
285	                )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:308:16
307	                "/json/settings",
308	                dict(
309	                    old_password=initial_password(self.example_email("hamlet")),
310	                    new_password="ignored",
311	                ),
312	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:317:16
316	                "/json/settings",
317	                dict(
318	                    old_password=self.ldap_password("hamlet"),  # hamlet's password in LDAP
319	                    new_password="ignored",
320	                ),
321	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:329:16
328	                "/json/settings",
329	                dict(
330	                    old_password=initial_password(self.example_email("hamlet")),
331	                    new_password="ignored",
332	                ),
333	            )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'ignored'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_settings.py:345:16
344	                "/json/settings",
345	                dict(
346	                    old_password=initial_password(self.example_email("hamlet")),
347	                    new_password="ignored",
348	                ),
349	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:381:8
380	        old_password = initial_password(email)
381	        assert old_password is not None
382	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'f657gdGGk9'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:433:12
432	            # log back in with new password
433	            self.login_by_email(email, password="f657gdGGk9")
434	            user_profile = self.example_user("hamlet")

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:847:12
846	        with patch("time.time", return_value=start_time):
847	            self.login_with_return(email, password="wrongpassword")
848	            self.assert_logged_in_user_id(None)

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'wrongpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:849:12
848	            self.assert_logged_in_user_id(None)
849	            self.login_with_return(email, password="wrongpassword")
850	            self.assert_logged_in_user_id(None)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'a_password_of_22_chars'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:866:19
865	        user_profile = self.example_user("hamlet")
866	        password = "a_password_of_22_chars"
867	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hmb'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1033:19
1032	        email = self.nonreg_email("test")
1033	        password = "hmb"
1034	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:1097:8
1096	https://www.google.com/images/srpr/logo4w.png</a></p>"""
1097	        assert isinstance(response, TemplateResponse)
1098	        assert response.context_data is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:1098:8
1097	        assert isinstance(response, TemplateResponse)
1098	        assert response.context_data is not None
1099	        self.assertEqual(response.context_data["realm_description"], expected_response)

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b107_hardcoded_password_default.html
   Location: .\zerver\tests\test_signup.py:1252:4
1251	    @override_settings(OPEN_REALM_CREATION=True)
1252	    def check_able_to_create_realm(self, email: str, password: str = "test") -> None:
1253	        internal_realm = get_realm(settings.SYSTEM_BOT_REALM)
1254	        notification_bot = get_system_bot(settings.NOTIFICATION_BOT, internal_realm.id)
1255	        signups_stream, _ = create_stream_if_needed(notification_bot.realm, "signups")
1256	
1257	        string_id = "zuliptest"
1258	        org_name = "Zulip Test"
1259	        # Make sure the realm does not exist
1260	        with self.assertRaises(Realm.DoesNotExist):
1261	            get_realm(string_id)
1262	
1263	        # Create new realm with the email
1264	        result = self.submit_realm_creation_form(
1265	            email, realm_subdomain=string_id, realm_name=org_name
1266	        )
1267	
1268	        self.assertEqual(result.status_code, 302)
1269	        self.assertTrue(
1270	            result["Location"].endswith(
1271	                f"/accounts/new/send_confirm/?email={urllib.parse.quote(email)}&realm_name={urllib.parse.quote_plus(org_name)}&realm_type=10&realm_subdomain={string_id}"
1272	            )
1273	        )
1274	        result = self.client_get(result["Location"])
1275	        self.assert_in_response("Check your email", result)
1276	        prereg_realm = PreregistrationRealm.objects.get(email=email)
1277	        self.assertEqual(prereg_realm.name, "Zulip Test")
1278	        self.assertEqual(prereg_realm.org_type, Realm.ORG_TYPES["business"]["id"])
1279	        self.assertEqual(prereg_realm.string_id, string_id)
1280	
1281	        # Check confirmation email has the correct subject and body, extract
1282	        # confirmation link and visit it
1283	        confirmation_url = self.get_confirmation_url_from_outbox(
1284	            email,
1285	            email_subject_contains="Create your Zulip organization",
1286	            email_body_contains="You have requested a new Zulip organization",
1287	        )
1288	        result = self.client_get(confirmation_url)
1289	        self.assertEqual(result.status_code, 200)
1290	
1291	        result = self.submit_reg_form_for_user(
1292	            email, password, realm_subdomain=string_id, realm_name=org_name
1293	        )
1294	        self.assertEqual(result.status_code, 302)
1295	        self.assertTrue(
1296	            result["Location"].startswith("http://zuliptest.testserver/accounts/login/subdomain/")
1297	        )
1298	
1299	        # Make sure the realm is created
1300	        realm = get_realm(string_id)
1301	        self.assertEqual(realm.string_id, string_id)
1302	        user = get_user(email, realm)
1303	        self.assertEqual(user.realm, realm)
1304	
1305	        # Check that user is the owner.
1306	        self.assertEqual(user.role, UserProfile.ROLE_REALM_OWNER)
1307	
1308	        # Check defaults
1309	        self.assertEqual(realm.org_type, Realm.ORG_TYPES["business"]["id"])
1310	        self.assertEqual(realm.emails_restricted_to_domains, False)
1311	        self.assertEqual(realm.invite_required, True)
1312	
1313	        prereg_realm = PreregistrationRealm.objects.get(email=email)
1314	        # Check created_realm and created_user field of PreregistrationRealm object
1315	        self.assertEqual(prereg_realm.created_realm, realm)
1316	        self.assertEqual(prereg_realm.created_user, user)
1317	        self.assertEqual(prereg_realm.status, confirmation_settings.STATUS_USED)
1318	
1319	        # Check welcome messages
1320	        for stream_name, text, message_count in [
1321	            (Realm.DEFAULT_NOTIFICATION_STREAM_NAME, "with the topic", 3),
1322	            (Realm.INITIAL_PRIVATE_STREAM_NAME, "private stream", 1),
1323	        ]:
1324	            stream = get_stream(stream_name, realm)
1325	            recipient = stream.recipient
1326	            messages = Message.objects.filter(recipient=recipient).order_by("date_sent")
1327	            self.assert_length(messages, message_count)
1328	            self.assertIn(text, messages[0].content)
1329	
1330	        # Check admin organization's signups stream messages
1331	        recipient = signups_stream.recipient
1332	        messages = Message.objects.filter(recipient=recipient).order_by("id")
1333	        self.assert_length(messages, 1)
1334	        # Check organization name, subdomain and organization type are in message content
1335	        self.assertIn("Zulip Test", messages[0].content)
1336	        self.assertIn("zuliptest", messages[0].content)
1337	        self.assertIn("Organization type: Business", messages[0].content)
1338	        self.assertEqual("new organizations", messages[0].topic_name())
1339	
1340	        realm_creation_audit_log = RealmAuditLog.objects.get(
1341	            realm=realm, event_type=RealmAuditLog.REALM_CREATED
1342	        )
1343	        self.assertEqual(realm_creation_audit_log.acting_user, user)
1344	        self.assertEqual(realm_creation_audit_log.event_time, realm.date_created)
1345	
1346	        # Piggyback a little check for how we handle
1347	        # empty string_ids.
1348	        realm.string_id = ""
1349	        self.assertEqual(realm.display_subdomain, ".")
1350	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1390:19
1389	    def test_create_realm_with_subdomain(self) -> None:
1390	        password = "test"
1391	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1436:19
1435	    def test_create_realm_with_marketing_emails_enabled(self) -> None:
1436	        password = "test"
1437	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1485:19
1484	    def test_create_realm_without_prompting_for_marketing_emails(self) -> None:
1485	        password = "test"
1486	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1545:19
1544	    def test_create_realm_with_marketing_emails_disabled(self) -> None:
1545	        password = "test"
1546	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1594:19
1593	    def test_create_regular_realm_welcome_bot_direct_message(self) -> None:
1594	        password = "test"
1595	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1640:19
1639	    def test_create_education_demo_organiztion_welcome_bot_direct_message(self) -> None:
1640	        password = "test"
1641	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1690:19
1689	    def test_create_realm_during_free_trial(self) -> None:
1690	        password = "test"
1691	        string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1739:19
1738	        """
1739	        password = "test"
1740	        first_string_id = "zuliptest"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1840:19
1839	    def test_subdomain_restrictions(self) -> None:
1840	        password = "test"
1841	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1889:19
1888	    def test_subdomain_restrictions_root_domain(self) -> None:
1889	        password = "test"
1890	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:1916:19
1915	    def test_subdomain_restrictions_root_domain_option(self) -> None:
1916	        password = "test"
1917	        email = "user1@test.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2107:19
2106	        email = self.nonreg_email("newguy")
2107	        password = "newpassword"
2108	        timezone = "America/Denver"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2143:19
2142	        email = self.nonreg_email("newguy")
2143	        password = "newpassword"
2144	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2178:19
2177	        email = self.nonreg_email("newguy")
2178	        password = "newpassword"
2179	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2211:19
2210	        email = self.nonreg_email("newguy")
2211	        password = "newpassword"
2212	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2284:8
2283	        # _WSGIPatchedWSGIResponse does not exist in Django, thus the inverted isinstance check.
2284	        assert not isinstance(result, UserProfile)
2285	        self.assert_in_success_response(["Invalid characters in name!"], result)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2299:8
2298	
2299	        assert isinstance(user_profile, UserProfile)
2300	        # User should now be logged in.

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2309:19
2308	        email = "newguy@zulip.com"
2309	        password = "newpassword"
2310	        result = self.verify_signup(email=email, password=password, full_name="")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2312:8
2311	        # _WSGIPatchedWSGIResponse does not exist in Django, thus the inverted isinstance check.
2312	        assert not isinstance(result, UserProfile)
2313	        self.assert_in_success_response(

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2343:19
2342	        email = "newguy@zulip.com"
2343	        password = "newpassword"
2344	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2421:19
2420	        email = self.nonreg_email("newguy")
2421	        password = "newpassword"
2422	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2455:19
2454	        email = self.nonreg_email("newguy")
2455	        password = "newpassword"
2456	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2505:19
2504	        email = self.nonreg_email("newguy")
2505	        password = "newpassword"
2506	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2545:19
2544	        email = hamlet_in_zulip.delivery_email
2545	        password = "newpassword"
2546	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2582:19
2581	        email = hamlet_in_zulip.delivery_email
2582	        password = "newpassword"
2583	        subdomain = "lear"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'newpassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:2662:19
2661	        email = "newuser@zulip.com"
2662	        password = "newpassword"
2663	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2758:12
2757	            last_message = Message.objects.last()
2758	            assert last_message is not None
2759	            self.assertIn(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2863:16
2862	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
2863	                assert match is not None
2864	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:2951:16
2950	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
2951	                assert match is not None
2952	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_signup.py:2957:13
2956	
2957	        with self.settings(
2958	            POPULATE_PROFILE_VIA_LDAP=True,
2959	            LDAP_APPEND_DOMAIN="zulip.com",
2960	            AUTH_LDAP_BIND_PASSWORD="",
2961	            AUTH_LDAP_USER_ATTR_MAP=ldap_user_attr_map,
2962	            AUTH_LDAP_USER_DN_TEMPLATE="uid=%(user)s,ou=users,dc=zulip,dc=com",
2963	        ):
2964	            result = self.client_get(confirmation_url)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3287:19
3286	    def test_signup_with_ldap_and_email_enabled_using_email_with_ldap_append_domain(self) -> None:
3287	        password = "nonldappassword"
3288	        email = "newuser@zulip.com"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3413:19
3412	        # have a wrong password, then we refuse to create an account
3413	        password = "nonldappassword"
3414	        email = "newuser_email@zulip.com"  # belongs to user uid=newuser_with_email in the test directory

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'nonldappassword'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3461:19
3460	        # database.
3461	        password = "nonldappassword"
3462	        email = "nonexistent@zulip.com"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3676:16
3675	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
3676	                assert match is not None
3677	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3695:12
3694	            prereg_user = confirmation.content_object
3695	            assert prereg_user is not None
3696	            prereg_user.realm_creation = True

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_signup.py:3718:19
3717	    def test_registration_of_mirror_dummy_user(self, ignored: Any) -> None:
3718	        password = "test"
3719	        subdomain = "zephyr"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3742:16
3741	                match = re.search(settings.EXTERNAL_HOST + r"(\S+)>", message.body)
3742	                assert match is not None
3743	                [confirmation_url] = match.groups()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3833:8
3832	        user_profile = UserProfile.objects.all().order_by("id").last()
3833	        assert user_profile is not None
3834	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3855:8
3854	        user_profile = UserProfile.objects.all().order_by("id").last()
3855	        assert user_profile is not None
3856	        self.assert_logged_in_user_id(user_profile.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3874:8
3873	        user_profile = UserProfile.objects.all().order_by("id").last()
3874	        assert user_profile is not None
3875	        self.assert_logged_in_user_id(user_profile.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_signup.py:3910:8
3909	        password = initial_password(email)
3910	        assert password is not None
3911	        self.assert_login_failure(email, password=password)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:117:16
116	    def test_get_slack_api_data(self) -> None:
117	        token = "xoxp-valid-token"
118	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-invalid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:154:16
153	
154	        token = "xoxp-invalid-token"
155	        with self.assertRaises(Exception) as invalid:

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-status404'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:163:16
162	
163	        token = "xoxp-status404"
164	        wrong_url = "https://slack.com/api/wrong"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:1091:16
1090	        output_dir = os.path.join(settings.DEPLOY_ROOT, "var", "test-slack-importer-data")
1091	        token = "xoxp-valid-token"
1092	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'xoxp-valid-token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\tests\test_slack_importer.py:1288:16
1287	        output_dir = os.path.join(settings.DEPLOY_ROOT, "var", "test-unicode-slack-importer-data")
1288	        token = "xoxp-valid-token"
1289	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:611:8
610	        ).last()
611	        assert history_public_to_subscribers_log is not None
612	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:626:8
625	        ).order_by("-id")[1]
626	        assert invite_only_log is not None
627	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:676:8
675	        ).last()
676	        assert history_public_to_subscribers_log is not None
677	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:691:8
690	        ).order_by("-id")[1]
691	        assert invite_only_log is not None
692	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:797:8
796	        ).last()
797	        assert realm_audit_log is not None
798	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:838:8
837	        ).last()
838	        assert realm_audit_log is not None
839	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:879:8
878	        ).last()
879	        assert realm_audit_log is not None
880	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:964:8
963	        ).last()
964	        assert realm_audit_log is not None
965	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1003:8
1002	        ).last()
1003	        assert realm_audit_log is not None
1004	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1035:8
1034	        ).last()
1035	        assert realm_audit_log is not None
1036	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1726:8
1725	        ).last()
1726	        assert realm_audit_log is not None
1727	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1790:8
1789	        ).last()
1790	        assert realm_audit_log is not None
1791	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1856:12
1855	            ).last()
1856	            assert realm_audit_log is not None
1857	            expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1890:8
1889	        ).last()
1890	        assert realm_audit_log is not None
1891	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1913:8
1912	        ).last()
1913	        assert realm_audit_log is not None
1914	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:1937:8
1936	        ).last()
1937	        assert realm_audit_log is not None
1938	        expected_extra_data = orjson.dumps(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:3115:8
3114	
3115	        assert found_sub is not None
3116	        self.assertEqual(found_sub["color"], new_color)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tests\test_subs.py:3753:41
3752	        for stream in existing_stream_names:
3753	            random_stream = stream + str(random.randint(0, 9))
3754	            if random_stream not in all_stream_names:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:5295:8
5294	        test_bot = self.create_test_bot("foo", hamlet)
5295	        assert test_bot is not None
5296	        realm = get_realm("zulip")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:6123:8
6122	        self.assertEqual(stream.id, stream_ret.id)
6123	        assert sub_ret is not None
6124	        self.assertEqual(sub_ret.recipient.type_id, stream.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:6182:8
6181	        (stream_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
6182	        assert sub_ret is not None
6183	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:6195:8
6194	        (stream_ret, sub_ret) = access_stream_by_id(guest_user_profile, stream.id)
6195	        assert sub_ret is not None
6196	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_subs.py:6204:8
6203	        self.assertTrue(can_access_stream_history(guest_user_profile, stream))
6204	        assert sub_ret is None
6205	        self.assertEqual(stream.id, stream_ret.id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:35:8
34	        missing = set(dict(reversed(ambiguous_abbrevs)).items()) - set(common_timezones.items())
35	        assert not missing, missing
36	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:47:16
46	                abbrev = tz.tzname(date)
47	                assert abbrev is not None
48	                if abbrev.startswith(("-", "+")):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:51:16
50	                delta = tz.utcoffset(date)
51	                assert delta is not None
52	                offset = delta.total_seconds()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:53:16
52	                offset = delta.total_seconds()
53	                assert (
54	                    common_timezones[abbrev] == offset or (abbrev, offset) in ambiguous_abbrevs
55	                ), (name, abbrev, offset)
56	                extra.discard((abbrev, offset))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_timezone.py:57:8
56	                extra.discard((abbrev, offset))
57	        assert not extra, extra

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_transfer.py:129:8
128	        resized_key = bucket.Object(emoji_path)
129	        assert emoji.file_name
130	        still_key = bucket.Object(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:336:8
335	
336	        assert settings.LOCAL_UPLOADS_DIR is not None
337	        self.rm_tree(settings.LOCAL_UPLOADS_DIR)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:407:8
406	        message_id = self.send_stream_message(hamlet, "Denmark", body, "test")
407	        assert settings.LOCAL_FILES_DIR
408	        d3_local_path = os.path.join(settings.LOCAL_FILES_DIR, d3_path_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:609:12
608	            response_dict = self.assert_json_success(result)
609	            assert sanitize_name(expected) in response_dict["uri"]
610	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:632:8
631	        quota = realm.upload_quota_bytes()
632	        assert quota is not None
633	        d1_attachment.size = quota - 11

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:922:12
921	                response = self.client_get(url)
922	            assert settings.LOCAL_UPLOADS_DIR is not None
923	            test_run, worker = os.path.split(os.path.dirname(settings.LOCAL_UPLOADS_DIR))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1263:20
1262	                    response = self.client_get(url)
1263	                    assert isinstance(response, StreamingHttpResponse)
1264	                    data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1406:8
1405	        self.assertTrue(is_animated)
1406	        assert still_img_data is not None
1407	        still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1425:16
1424	                self.assertTrue(is_animated)
1425	                assert still_img_data
1426	                still_image = Image.open(io.BytesIO(still_img_data))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1447:8
1446	        self.assertFalse(is_animated)
1447	        assert no_still_data is None
1448	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1455:8
1454	        self.assertFalse(is_animated)
1455	        assert no_still_data is None
1456	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1544:20
1543	                    response = self.client_get(url)
1544	                    assert isinstance(response, StreamingHttpResponse)
1545	                    data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload.py:1727:20
1726	                    response = self.client_get(logo_url)
1727	                    assert isinstance(response, StreamingHttpResponse)
1728	                    data = b"".join(response.streaming_content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:52:8
51	        path_id = re.sub("/user_uploads/", "", url)
52	        assert settings.LOCAL_UPLOADS_DIR is not None
53	        assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:53:8
52	        assert settings.LOCAL_UPLOADS_DIR is not None
53	        assert settings.LOCAL_FILES_DIR is not None
54	        file_path = os.path.join(settings.LOCAL_FILES_DIR, path_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:97:8
96	
97	        assert settings.LOCAL_FILES_DIR is not None
98	        file_path = os.path.join(settings.LOCAL_FILES_DIR, path_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:105:8
104	    def test_delete_message_attachments(self) -> None:
105	        assert settings.LOCAL_UPLOADS_DIR is not None
106	        assert settings.LOCAL_FILES_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:106:8
105	        assert settings.LOCAL_UPLOADS_DIR is not None
106	        assert settings.LOCAL_FILES_DIR is not None
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:153:8
152	        resized_avatar = resize_avatar(image_data)
153	        assert isinstance(result, StreamingHttpResponse)
154	        self.assertEqual(resized_avatar, b"".join(result.streaming_content))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:173:8
172	
173	        assert settings.LOCAL_UPLOADS_DIR is not None
174	        assert settings.LOCAL_AVATARS_DIR is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:174:8
173	        assert settings.LOCAL_UPLOADS_DIR is not None
174	        assert settings.LOCAL_AVATARS_DIR is not None
175	        image_path = os.path.join(settings.LOCAL_AVATARS_DIR, file_path + ".original")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:240:8
239	
240	        assert settings.LOCAL_AVATARS_DIR is not None
241	        file_path = os.path.join(settings.LOCAL_AVATARS_DIR, emoji_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:253:8
252	
253	        assert settings.TEST_WORKER_DIR is not None
254	        tarball_path = os.path.join(settings.TEST_WORKER_DIR, "tarball.tar.gz")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_local.py:258:8
257	
258	        assert settings.LOCAL_AVATARS_DIR is not None
259	        url = upload_export_tarball(user_profile.realm, tarball_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_s3.py:201:8
200	        path = urllib.parse.urlparse(redirect_url).path
201	        assert path.startswith("/")
202	        key = path[len("/") :]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_s3.py:210:8
209	        path = urllib.parse.urlparse(redirect_url).path
210	        assert path.startswith(prefix)
211	        key = path[len(prefix) :]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_s3.py:220:8
219	        path = urllib.parse.urlparse(redirect_url).path
220	        assert path.startswith(prefix)
221	        key = path[len(prefix) :]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_upload_s3.py:240:8
239	        path = urllib.parse.urlparse(redirect_url).path
240	        assert path.startswith(prefix)
241	        key = path[len(prefix) :]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_user_groups.py:44:8
43	        user_group = UserGroup.objects.filter(realm=realm).first()
44	        assert user_group is not None
45	        empty_user_group = check_add_user_group(realm, "newgroup", [], acting_user=None)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_user_topics.py:120:8
119	
120	        assert stream.recipient is not None
121	        result = self.api_patch(user, url, data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:487:8
486	
487	        assert role == UserProfile.ROLE_GUEST
488	        return (

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:792:27
791	                with self.capture_send_event_calls(expected_num_events=11) as events:
792	                    fred = do_create_user(
793	                        email="fred@zulip.com",
794	                        password="password",
795	                        realm=realm,
796	                        full_name="Fred Flintstone",
797	                        prereg_user=prereg_user,
798	                        acting_user=None,
799	                    )
800	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:873:23
872	        do_change_user_role(admin, UserProfile.ROLE_REALM_ADMINISTRATOR, acting_user=None)
873	        valid_params = dict(
874	            email="romeo@zulip.net",
875	            password="xxxx",
876	            full_name="Romeo Montague",
877	        )
878	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:904:12
903	            "/json/users",
904	            dict(
905	                email="romeo@not-zulip.com",
906	                password="xxxx",
907	            ),
908	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:914:12
913	            "/json/users",
914	            dict(
915	                email="romeo@zulip.com",
916	                password="xxxx",
917	                full_name="Romeo Montague",
918	                short_name="DEPRECATED",
919	            ),
920	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:925:12
924	            "/json/users",
925	            dict(
926	                email="broken",
927	                password="xxxx",
928	                full_name="Romeo Montague",
929	            ),
930	        )

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'xxxx'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:936:12
935	            "/json/users",
936	            dict(
937	                email="romeo@not-zulip.com",
938	                password="xxxx",
939	                full_name="Romeo Montague",
940	            ),
941	        )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1142:8
1141	        iago = get_source_profile("iago@zulip.com", zulip_realm_id)
1142	        assert iago is not None
1143	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1147:8
1146	        iago = get_source_profile("IAGO@ZULIP.com", zulip_realm_id)
1147	        assert iago is not None
1148	        self.assertEqual(iago.email, "iago@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1152:8
1151	        cordelia = get_source_profile("cordelia@zulip.com", lear_realm_id)
1152	        assert cordelia is not None
1153	        self.assertEqual(cordelia.email, "cordelia@zulip.com")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1642:8
1641	        email = ScheduledEmail.objects.all().first()
1642	        assert email is not None and email.users is not None
1643	        self.assertEqual(email.users.count(), 2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1697:8
1696	        email = ScheduledEmail.objects.all().first()
1697	        assert email is not None
1698	        email.users.remove(*to_user_ids)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tests\test_users.py:1740:8
1739	        recipient = stream.recipient
1740	        assert recipient is not None
1741	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1938:22
1937	        # Add a service bot.
1938	        service_bot = do_create_user(
1939	            email="service-bot@zulip.com",
1940	            password="",
1941	            realm=realm,
1942	            full_name="",
1943	            bot_type=UserProfile.EMBEDDED_BOT,
1944	            acting_user=None,
1945	        )
1946	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\tests\test_users.py:1962:21
1961	        # Add a normal bot.
1962	        normal_bot = do_create_user(
1963	            email="normal-bot@zulip.com",
1964	            password="",
1965	            realm=realm,
1966	            full_name="",
1967	            bot_type=UserProfile.DEFAULT_BOT,
1968	            acting_user=None,
1969	        )
1970	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\tests\test_zephyr.py:1:0
1	import subprocess
2	from typing import TYPE_CHECKING, Any
3	from unittest.mock import patch

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:194:12
193	            handler = get_handler_by_id(self.current_handler_id)
194	            assert handler._request is not None
195	            async_request_timer_restart(handler._request)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\tornado\event_queue.py:268:45
267	        ioloop = tornado.ioloop.IOLoop.current()
268	        interval = HEARTBEAT_MIN_FREQ_SECS + random.randint(0, 10)
269	        if self.client_type_name != "API: heartbeat test":

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:460:4
459	def clear_client_event_queues_for_testing() -> None:
460	    assert settings.TEST_SUITE
461	    clients.clear()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:669:16
668	            if dont_block:
669	                assert new_queue_data is not None
670	                client = allocate_client_descriptor(new_queue_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\event_queue.py:1373:8
1372	        # requests to the right shard.
1373	        assert isinstance(users[0], int)
1374	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:58:8
57	        request = handler._request
58	        assert request is not None
59	        async_request_timer_restart(request)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:61:8
60	        log_data = RequestNotes.get_notes(request).log_data
61	        assert log_data is not None
62	        if len(contents) != 1:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:185:16
184	
185	                assert isinstance(response, HttpResponse)
186	                await self.write_django_response_as_tornado_response(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\handlers.py:270:12
269	            patch_vary_headers(response, ("Cookie",))
270	            assert isinstance(response, HttpResponse)
271	            await self.write_django_response_as_tornado_response(response)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:53:4
52	    log_data = RequestNotes.get_notes(request).log_data
53	    assert log_data is not None
54	    log_data["extra"] = f"[{queue_id}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:66:8
65	        # succeed after getting a 200 from this endpoint.
66	        assert settings.USING_RABBITMQ
67	        get_queue_client().json_publish(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:85:4
84	    RequestNotes.get_notes(request).requestor_for_logs = user_profile.format_requestor_for_logs()
85	    assert is_current_port(get_user_tornado_port(user_profile))
86	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:168:4
167	    handler_id = RequestNotes.get_notes(request).tornado_handler_id
168	    assert handler_id is not None
169	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:172:8
171	        valid_user_client = RequestNotes.get_notes(request).client
172	        assert valid_user_client is not None
173	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\tornado\views.py:208:8
207	        log_data = RequestNotes.get_notes(request).log_data
208	        assert log_data is not None
209	        log_data["extra"] = result["extra_log_data"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:185:4
184	    # devices, e.g. just creating an account on the web on their laptop.
185	    assert not (mobile_flow_otp and desktop_flow_otp)
186	    if mobile_flow_otp:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:213:8
212	
213	        assert isinstance(confirmation_obj, MultiuseInvite)
214	        multiuse_obj = confirmation_obj

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:466:8
465	    if user_profile is not None:
466	        assert isinstance(user_profile, UserProfile)
467	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:526:8
525	    else:
526	        assert isinstance(user_profile, UserProfile)
527	        result = ExternalAuthResult(user_profile=user_profile)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'zerver.views.auth.log_into_subdomain'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\auth.py:663:24
662	
663	_subdomain_token_salt = "zerver.views.auth.log_into_subdomain"
664	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:843:8
842	    except ZulipLDAPConfigurationError as e:
843	        assert len(e.args) > 1
844	        return redirect_to_misconfigured_ldap_notice(request, e.args[1])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:852:8
851	        # https://github.com/django/django/blob/2.0/django/template/response.py#L19
852	        assert template_response.context_data is not None
853	        update_login_page_context(request, template_response.context_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:855:4
854	
855	    assert isinstance(template_response, HttpResponse)
856	    return template_response

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:907:4
906	) -> str:
907	    assert user_profile.is_authenticated
908	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:917:4
916	    # Mark this request as having a logged-in user for our server logs.
917	    assert isinstance(user_profile, UserProfile)
918	    process_client(request, user_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:958:4
957	
958	    assert isinstance(user_profile, UserProfile)
959	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1003:4
1002	
1003	    assert isinstance(user_profile, UserProfile)
1004	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1112:8
1111	    except RateLimitedError as e:
1112	        assert e.secs_to_freedom is not None
1113	        return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\auth.py:1119:4
1118	        )
1119	    assert isinstance(response, HttpResponse)
1120	    return response

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\custom_profile_fields.py:167:12
166	            field_subtype = field_data["subtype"]
167	            assert isinstance(field_subtype, str)
168	            field = try_add_realm_default_custom_profile_field(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\dev_login.py:89:4
88	        return config_error(request, "dev")
89	    assert isinstance(user_profile, UserProfile)
90	    do_login(request, user_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\dev_login.py:134:4
133	        raise AuthenticationFailedError
134	    assert isinstance(user_profile, UserProfile)
135	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:31:8
30	    if request.method == "POST":
31	        assert forward_address is not None
32	        set_forward_address(forward_address)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:76:4
75	    )
76	    assert result.status_code == 302
77	    # deactivated user

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:82:4
81	    )
82	    assert result.status_code == 302
83	    change_user_is_active(user, True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:85:4
84	    # account on different realm
85	    assert other_realm is not None
86	    result = client.post(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:89:4
88	    )
89	    assert result.status_code == 302
90	    # no account anywhere

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:94:4
93	    )
94	    assert result.status_code == 302
95	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:98:4
97	    result = client.post("/accounts/home/", {"email": unregistered_email_1}, HTTP_HOST=realm.host)
98	    assert result.status_code == 302
99	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:102:4
101	    result = client.post("/accounts/find/", {"emails": registered_email}, HTTP_HOST=realm.host)
102	    assert result.status_code == 302
103	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:106:4
105	    logged_in = client.login(dev_auth_username=registered_email, realm=realm)
106	    assert logged_in
107	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:119:4
118	    )
119	    assert result.status_code == 200
120	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:128:4
127	    )
128	    assert result.status_code == 200
129	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\development\email_log.py:135:4
134	    result = client.get(url)
135	    assert result.status_code == 200
136	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:56:4
55	    # Need to add test data to POST request as it doesn't originally contain the required parameters
56	    modify_postdata(request, key=key, full_name=name, password="test", terms="true")
57	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:75:4
74	    # Need to add test data to POST request as it doesn't originally contain the required parameters
75	    modify_postdata(
76	        request,
77	        key=key,
78	        realm_name=realm_name,
79	        realm_type=realm_type,
80	        full_name=name,
81	        password="test",
82	        realm_subdomain=realm_subdomain,
83	        terms="true",
84	    )
85	

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'test'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\zerver\views\development\registration.py:103:4
102	    # Need to add test data to POST request as it doesn't originally contain the required parameters
103	    modify_postdata(
104	        request,
105	        key=key,
106	        realm_name=realm_name,
107	        realm_type=realm_type,
108	        full_name=name,
109	        password="test",
110	        realm_subdomain=realm_subdomain,
111	        terms="true",
112	        is_demo_organization="true",
113	    )
114	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\digest.py:16:4
15	    user_profile = request.user
16	    assert user_profile.is_authenticated
17	    cutoff = time.mktime((timezone_now() - timedelta(days=DIGEST_CUTOFF)).timetuple())

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:98:12
97	            # when it is not configured or in the dev environment
98	            assert self.policies_view
99	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:197:16
196	                )
197	                assert endpoint_name is not None
198	                assert endpoint_method is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\documentation.py:198:16
197	                assert endpoint_name is not None
198	                assert endpoint_method is not None
199	                article_title = get_openapi_summary(endpoint_name, endpoint_method)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\documentation.py:214:60
213	            request_notes.placeholder_open_graph_description = (
214	                f"REPLACEMENT_PAGE_DESCRIPTION_{int(2**24 * random.random())}"
215	            )

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\events_register.py:89:8
88	        spectator_requested_language = None
89	        assert isinstance(user_profile, UserProfile)
90	        realm = user_profile.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\events_register.py:126:4
125	    client = RequestNotes.get_notes(request).client
126	    assert client is not None
127	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:35:4
34	def accounts_accept_terms(request: HttpRequest) -> HttpResponse:
35	    assert request.user.is_authenticated
36	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:40:12
39	        if form.is_valid():
40	            assert settings.TERMS_OF_SERVICE_VERSION is not None
41	            do_change_tos_version(request.user, settings.TERMS_OF_SERVICE_VERSION)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:87:12
86	            narrow_stream_name = request.GET.get("stream")
87	            assert narrow_stream_name is not None
88	            (narrow_stream, ignored_sub) = access_stream_by_name(user_profile, narrow_stream_name)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\home.py:210:4
209	    log_data = RequestNotes.get_notes(request).log_data
210	    assert log_data is not None
211	    log_data["extra"] = f"[{queue_id}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:42:8
41	    if len(raw_edit_history) > 0:
42	        assert message.last_edit_time is not None
43	        assert datetime_to_timestamp(message.last_edit_time) == raw_edit_history[0]["timestamp"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:43:8
42	        assert message.last_edit_time is not None
43	        assert datetime_to_timestamp(message.last_edit_time) == raw_edit_history[0]["timestamp"]
44	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:65:12
64	            prev_rendered_content = formatted_entry["prev_rendered_content"]
65	            assert prev_rendered_content is not None
66	            rendered_content = formatted_entry["rendered_content"]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:67:12
66	            rendered_content = formatted_entry["rendered_content"]
67	            assert rendered_content is not None
68	            formatted_entry["content_html_diff"] = highlight_html_differences(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_edit.py:142:4
141	    log_data = RequestNotes.get_notes(request).log_data
142	    assert log_data is not None
143	    log_data["extra"] = f"[{number_changed}]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:122:8
121	            raise MissingAuthenticationError
122	        assert narrow is not None
123	        if not is_spectator_compatible(narrow):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:132:8
131	    else:
132	        assert isinstance(maybe_user_profile, UserProfile)
133	        user_profile = maybe_user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:134:8
133	        user_profile = maybe_user_profile
134	        assert user_profile is not None
135	        is_web_public_query = False

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:137:4
136	
137	    assert realm is not None
138	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:154:8
153	        log_data = RequestNotes.get_notes(request).log_data
154	        assert log_data is not None
155	        log_data["extra"] = "[{}]".format(",".join(verbose_operators))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_fetch.py:189:8
188	    elif include_history:
189	        assert user_profile is not None
190	        message_ids = [row[0] for row in rows]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:49:4
48	    request_notes = RequestNotes.get_notes(request)
49	    assert request_notes.log_data is not None
50	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:129:4
128	    log_data_str = f"[{count} updated]"
129	    assert request_notes.log_data is not None
130	    request_notes.log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:140:4
139	    stream, sub = access_stream_by_id(user_profile, stream_id)
140	    assert stream.recipient_id is not None
141	    count = do_mark_stream_messages_as_read(user_profile, stream.recipient_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:145:4
144	    log_data = RequestNotes.get_notes(request).log_data
145	    assert log_data is not None
146	    log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:159:4
158	    stream, sub = access_stream_by_id(user_profile, stream_id)
159	    assert stream.recipient_id is not None
160	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_flags.py:175:4
174	    log_data = RequestNotes.get_notes(request).log_data
175	    assert log_data is not None
176	    log_data["extra"] = log_data_str

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:179:4
178	    client = RequestNotes.get_notes(request).client
179	    assert client is not None
180	    can_forge_sender = user_profile.can_forge_sender

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\message_send.py:264:4
263	    client = RequestNotes.get_notes(request).client
264	    assert client is not None
265	    message.sending_client = client

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:112:8
111	    if emoji_name not in ["", None]:
112	        assert emoji_name is not None
113	        assert emoji_code is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:113:8
112	        assert emoji_name is not None
113	        assert emoji_code is not None
114	        assert emoji_type is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:114:8
113	        assert emoji_code is not None
114	        assert emoji_type is not None
115	        check_emoji_request(user_profile.realm, emoji_name, emoji_code, emoji_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:118:4
117	    client = RequestNotes.get_notes(request).client
118	    assert client is not None
119	    do_update_user_status(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\presence.py:147:8
146	        client = RequestNotes.get_notes(request).client
147	        assert client is not None
148	        update_user_presence(user_profile, client, timezone_now(), status_val, new_user_input)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\push_notifications.py:18:20
17	def validate_token(token_str: str, kind: int) -> None:
18	    if token_str == "" or len(token_str) > 4096:
19	        raise JsonableError(_("Empty or invalid length token"))

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\views\read_receipts.py:72:8
71	    user_ids = (
72	        UserMessage.objects.filter(
73	            message_id=message.id,
74	            user_profile__is_active=True,
75	            user_profile__send_read_receipts=True,
76	        )
77	        .exclude(user_profile_id=message.sender_id)
78	        .exclude(user_profile__muter__muted_user_id=user_profile.id)
79	        .exclude(user_profile__muted__user_profile_id=user_profile.id)
80	        .extra(
81	            where=[UserMessage.where_read()],
82	        )
83	        .values_list("user_profile_id", flat=True)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm.py:380:4
379	
380	    assert isinstance(obj, RealmReactivationStatus)
381	    realm = obj.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_emoji.py:42:4
41	    emoji_file = list(request.FILES.values())[0]
42	    assert isinstance(emoji_file, UploadedFile)
43	    assert emoji_file.size is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_emoji.py:43:4
42	    assert isinstance(emoji_file, UploadedFile)
43	    assert emoji_file.size is not None
44	    if (settings.MAX_EMOJI_FILE_SIZE_MIB * 1024 * 1024) < emoji_file.size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_icon.py:23:4
22	    icon_file = list(request.FILES.values())[0]
23	    assert isinstance(icon_file, UploadedFile)
24	    assert icon_file.size is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_icon.py:24:4
23	    assert isinstance(icon_file, UploadedFile)
24	    assert icon_file.size is not None
25	    if (settings.MAX_ICON_FILE_SIZE_MIB * 1024 * 1024) < icon_file.size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_logo.py:29:4
28	    logo_file = list(request.FILES.values())[0]
29	    assert isinstance(logo_file, UploadedFile)
30	    assert logo_file.size is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\realm_logo.py:30:4
29	    assert isinstance(logo_file, UploadedFile)
30	    assert logo_file.size is not None
31	    if (settings.MAX_LOGO_FILE_SIZE_MIB * 1024 * 1024) < logo_file.size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:167:4
166	    )
167	    assert isinstance(prereg_object, (PreregistrationRealm, PreregistrationUser))
168	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:173:8
172	    if realm_creation:
173	        assert isinstance(prereg_object, PreregistrationRealm)
174	        # Defensive assert to make sure no mix-up in how .status is set leading to re-use

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:176:8
175	        # of a PreregistrationRealm object.
176	        assert prereg_object.created_realm is None
177	    else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:178:8
177	    else:
178	        assert isinstance(prereg_object, PreregistrationUser)
179	        # Defensive assert to make sure no mix-up in how .status is set leading to re-use

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:181:8
180	        # of a PreregistrationUser object.
181	        assert prereg_object.created_user is None
182	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:225:8
224	    if realm_creation:
225	        assert isinstance(prereg_object, PreregistrationRealm)
226	        prereg_realm = prereg_object

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:230:8
229	    else:
230	        assert isinstance(prereg_object, PreregistrationUser)
231	        prereg_user = prereg_object

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:246:8
245	    else:
246	        assert prereg_user is not None
247	        assert prereg_user.realm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:247:8
246	        assert prereg_user is not None
247	        assert prereg_user.realm is not None
248	        if get_subdomain(request) != prereg_user.realm.string_id:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:338:12
337	        if realm_creation:
338	            assert prereg_realm is not None
339	            initial_data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:429:8
428	            )
429	        assert realm is not None
430	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:510:16
509	            else:
510	                assert isinstance(user, UserProfile)
511	                user_profile = user

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:578:8
577	
578	        assert isinstance(auth_result, UserProfile)
579	        return login_and_go_to_home(request, auth_result)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:733:16
732	            except RateLimitedError as e:
733	                assert e.secs_to_freedom is not None
734	                return TemplateResponse(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:846:8
845	        # has its realm mismatching the realm of the request.
846	        assert realm == multiuse_object.realm
847	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:863:16
862	            except RateLimitedError as e:
863	                assert e.secs_to_freedom is not None
864	                return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:915:8
914	        )
915	        assert isinstance(confirmation_obj, MultiuseInvite)
916	        multiuse_object = confirmation_obj

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\registration.py:943:20
942	                except RateLimitedError as e:
943	                    assert e.secs_to_freedom is not None
944	                    return render(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:42:4
41	    log_data = RequestNotes.get_notes(request).log_data
42	    assert log_data is not None
43	    log_data[

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:59:4
58	    log_data = RequestNotes.get_notes(request).log_data
59	    assert log_data is not None
60	    log_data["extra"] = f"[{initial_core}ms/{initial_free}ms/{network}ms]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\report.py:72:4
71	    log_data = RequestNotes.get_notes(request).log_data
72	    assert log_data is not None
73	    log_data["extra"] = f"[{initial_core}ms/{initial_free}ms]"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\scheduled_messages.py:61:4
60	    client = RequestNotes.get_notes(request).client
61	    assert client is not None
62	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\sentry.py:35:4
34	
35	    assert dsn.hostname
36	    project_id = dsn.path.strip("/")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:872:8
871	        is_web_public_query = False
872	        assert isinstance(maybe_user_profile, UserProfile)
873	        user_profile = maybe_user_profile

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:874:8
873	        user_profile = maybe_user_profile
874	        assert user_profile is not None
875	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:884:8
883	    else:
884	        assert user_profile is not None
885	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\streams.py:888:8
887	
888	        assert stream.recipient_id is not None
889	        result = get_topic_history_for_stream(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\thumbnail.py:39:8
38	    else:
39	        assert isinstance(maybe_user_profile, UserProfile)
40	        realm = maybe_user_profile.realm

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\unsubscribe.py:27:4
26	
27	    assert isinstance(user_profile, UserProfile)
28	    unsubscribe_function(user_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:96:4
95	    url = get_signed_upload_url(path_id, force_download=force_download)
96	    assert url.startswith("https://")
97	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:108:4
107	    parsed_url = urlparse(url)
108	    assert parsed_url.hostname is not None
109	    assert parsed_url.path is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:109:4
108	    assert parsed_url.hostname is not None
109	    assert parsed_url.path is not None
110	    assert parsed_url.query is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:110:4
109	    assert parsed_url.path is not None
110	    assert parsed_url.query is not None
111	    escaped_path_parts = parsed_url.hostname + quote(parsed_url.path) + "?" + parsed_url.query

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:128:4
127	) -> HttpResponseBase:
128	    assert settings.LOCAL_FILES_DIR is not None
129	    local_path = os.path.join(settings.LOCAL_FILES_DIR, path_id)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'user_uploads_'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zerver\views\upload.py:215:33
214	
215	USER_UPLOADS_ACCESS_TOKEN_SALT = "user_uploads_"
216	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:292:4
291	    user_file = list(request.FILES.values())[0]
292	    assert isinstance(user_file, UploadedFile)
293	    file_size = user_file.size

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\upload.py:294:4
293	    file_size = user_file.size
294	    assert file_size is not None
295	    if settings.MAX_FILE_UPLOAD_SIZE * 1024 * 1024 < file_size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:72:4
71	
72	    assert isinstance(email_change_object, EmailChangeStatus)
73	    new_email = email_change_object.new_email

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\views\user_settings.py:103:30
102	    ctx = {
103	        "new_email_html_tag": SafeString(
104	            f'<a href="mailto:{escape(new_email)}">{escape(new_email_address.username)}@<wbr>{escape(new_email_address.domain)}</wbr></a>'
105	        ),
106	        "old_email_html_tag": SafeString(

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\zerver\views\user_settings.py:106:30
105	        ),
106	        "old_email_html_tag": SafeString(
107	            f'<a href="mailto:{escape(old_email)}">{escape(old_email_address.username)}@<wbr>{escape(old_email_address.domain)}</wbr></a>'
108	        ),
109	    }

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:260:12
259	        except RateLimitedError as e:
260	            assert e.secs_to_freedom is not None
261	            secs_to_freedom = int(e.secs_to_freedom)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:348:4
347	    user_file = list(request.FILES.values())[0]
348	    assert isinstance(user_file, UploadedFile)
349	    assert user_file.size is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_settings.py:349:4
348	    assert isinstance(user_file, UploadedFile)
349	    assert user_file.size is not None
350	    if (settings.MAX_AVATAR_FILE_SIZE_MIB * 1024 * 1024) < user_file.size:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_topics.py:32:8
31	    else:
32	        assert stream_id is not None
33	        (stream, sub) = access_stream_by_id(user_profile, stream_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\user_topics.py:55:8
54	    else:
55	        assert stream_id is not None
56	        stream = access_stream_to_remove_visibility_policy_by_id(user_profile, stream_id, error)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:183:8
182	    if target.is_bot:
183	        assert target.bot_type is not None
184	        check_bot_creation_policy(user_profile, target.bot_type)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:251:12
250	        for entry in profile_data:
251	            assert isinstance(entry["id"], int)
252	            assert not isinstance(entry["value"], int)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:252:12
251	            assert isinstance(entry["id"], int)
252	            assert not isinstance(entry["value"], int)
253	            if entry["value"] is None or not entry["value"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:321:4
320	    # hacks to prevent us from having to jump through decode/encode hoops.
321	    assert url is not None
322	    url = append_url_query_string(url, request.META["QUERY_STRING"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:408:8
407	        check_valid_interface_type(service_interface)
408	        assert service_interface is not None
409	        do_update_outgoing_webhook_service(bot, service_interface, service_payload_url)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:418:8
417	        user_file = list(request.FILES.values())[0]
418	        assert isinstance(user_file, UploadedFile)
419	        assert user_file.size is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:419:8
418	        assert isinstance(user_file, UploadedFile)
419	        assert user_file.size is not None
420	        upload_avatar_image(user_file, user_profile, bot)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:560:8
559	        user_file = list(request.FILES.values())[0]
560	        assert isinstance(user_file, UploadedFile)
561	        assert user_file.size is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:561:8
560	        assert isinstance(user_file, UploadedFile)
561	        assert user_file.size is not None
562	        upload_avatar_image(user_file, user_profile, bot_profile)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\users.py:565:8
564	    if bot_type in (UserProfile.OUTGOING_WEBHOOK_BOT, UserProfile.EMBEDDED_BOT):
565	        assert isinstance(service_name, str)
566	        add_service(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:90:4
89	def register_zoom_user(request: HttpRequest) -> HttpResponse:
90	    assert request.user.is_authenticated
91	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:124:4
123	) -> HttpResponse:
124	    assert request.user.is_authenticated
125	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zerver\views\video_calls.py:178:24
177	    # https://docs.bigbluebutton.org/dev/api.html#usage for reference for checksum
178	    id = "zulip-" + str(random.randint(100000000000, 999999999999))
179	    password = b32encode(secrets.token_bytes(20)).decode()  # 20 bytes means 32 characters

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\video_calls.py:204:4
203	def join_bigbluebutton(request: HttpRequest, bigbluebutton: str = REQ()) -> HttpResponse:
204	    assert request.user.is_authenticated
205	

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\zerver\views\zephyr.py:5:0
4	import shlex
5	import subprocess
6	from email.headerregistry import Address

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:45:8
44	            user = kerberos_alter_egos[user]
45	        assert user == Address(addr_spec=user_profile.email).username
46	        # Limit characters in usernames to valid MIT usernames

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\views\zephyr.py:48:8
47	        # This is important for security since DNS is not secure.
48	        assert re.match(r"^[a-z0-9_.-]+$", user) is not None
49	        ccache = make_ccache(parsed_cred)

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\zerver\views\zephyr.py:74:8
73	        ]
74	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--", shlex.join(command)])
75	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\zerver\views\zephyr.py:74:8
73	        ]
74	        subprocess.check_call(["ssh", settings.PERSONAL_ZMIRROR_SERVER, "--", shlex.join(command)])
75	    except subprocess.CalledProcessError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\appfollow\view.py:23:4
22	    app_name_search = re.search(r"\A(.+)", message)
23	    assert app_name_search is not None
24	    app_name = app_name_search.group(0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:163:4
162	        )
163	    assert type != "push"
164	    return get_subject(payload)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket2\view.py:187:8
186	        event_key = validate_extract_webhook_http_header(request, "X-Event-Key", "BitBucket")
187	        assert event_key is not None
188	        action = re.match("pullrequest:(?P<action>.*)$", event_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\bitbucket3\view.py:440:8
439	        )
440	        assert eventkey is not None
441	    handler = EVENT_HANDLER_MAP.get(eventkey)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\clubhouse\view.py:415:8
414	        new_reference = get_reference_by_id(payload, new_state_id)
415	        assert new_reference is not None
416	        new_state = new_reference["name"].tame(check_string)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\clubhouse\view.py:418:8
417	        old_reference = get_reference_by_id(payload, old_state_id)
418	        assert old_reference is not None
419	        old_state = old_reference["name"].tame(check_string)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\dialogflow\view.py:40:4
39	    client = RequestNotes.get_notes(request).client
40	    assert client is not None
41	    check_send_private_message(user_profile, client, receiving_user, body)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\groove\view.py:121:4
120	    event = validate_extract_webhook_http_header(request, "X-Groove-Event", "Groove")
121	    assert event is not None
122	    handler = EVENTS_FUNCTION_MAPPER.get(event)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\pagerduty\view.py:231:4
230	    body = template.format(**format_dict)
231	    assert isinstance(format_dict["action"], str)
232	    check_send_webhook_message(request, user_profile, subject, body, format_dict["action"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\reviewboard\view.py:189:4
188	    )
189	    assert event_type is not None
190	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\slack\view.py:38:4
37	    client = RequestNotes.get_notes(request).client
38	    assert client is not None
39	    check_send_stream_message(user_profile, client, stream, subject, content)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\stripe\view.py:96:8
95	    def update_string(blacklist: Sequence[str] = []) -> str:
96	        assert "previous_attributes" in payload["data"]
97	        previous_attributes = set(payload["data"]["previous_attributes"].keys()).difference(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\taiga\view.py:325:4
324	    """Gets the template string and formats it with parsed data."""
325	    assert isinstance(data["type"], str) and isinstance(data["event"], str)
326	    template = templates[data["type"]][data["event"]]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\taiga\view.py:328:4
327	
328	    assert isinstance(data["values"], dict)
329	    content = template.format(**data["values"])

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\webhooks\teamcity\view.py:144:8
143	        client = RequestNotes.get_notes(request).client
144	        assert client is not None
145	        check_send_private_message(user_profile, client, teamcity_user, body)

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\zerver\worker\queue_processors.py:182:4
181	            os.kill(os.getpid(), signal.SIGUSR1)
182	    except Exception:
183	        pass
184	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:402:8
401	    def start(self) -> None:
402	        assert self.q is not None
403	        self.initialize_statistics()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:410:8
409	    def stop(self) -> None:  # nocoverage
410	        assert self.q is not None
411	        self.q.stop_consuming()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:422:8
421	    def start(self) -> None:  # nocoverage
422	        assert self.q is not None
423	        self.initialize_statistics()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:831:8
830	        error_types = ["browser", "server"]
831	        assert event["type"] in error_types
832	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:866:8
865	        )
866	        assert isinstance(msg, EmailMessage)  # https://github.com/python/typeshed/issues/2417
867	        if not is_missed_message_address(rcpt_to):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:926:8
925	    ) -> None:
926	        assert len(events) == 1
927	        event = events[0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:982:20
981	                    )
982	                    assert message["content"] is not None
983	                bot_handler.handle_message(

--------------------------------------------------
>> Issue: [B610:django_extra_used] Use of extra potential SQL attack vector.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b610_django_extra_used.html
   Location: .\zerver\worker\queue_processors.py:1036:20
1035	                with transaction.atomic(savepoint=False):
1036	                    UserMessage.select_for_update_query().filter(message__in=messages).extra(
1037	                        where=[UserMessage.where_unread()]
1038	                    ).update(flags=F("flags").bitor(UserMessage.flags.read))
1039	                offset += len(messages)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zerver\worker\queue_processors.py:1099:12
1098	
1099	            assert public_url is not None
1100	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\mark_all_messages_unread.py:16:8
15	    def handle(self, *args: Any, **options: Any) -> None:
16	        assert settings.DEVELOPMENT
17	        UserMessage.objects.all().update(flags=F("flags").bitand(~UserMessage.flags.read))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\mark_all_messages_unread.py:19:8
18	        _cache = cache._cache  # type: ignore[attr-defined] # not in stubs
19	        assert isinstance(_cache, bmemcached.Client)
20	        _cache.flush_all()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\populate_db.py:337:12
336	            RealmDomain.objects.create(realm=zulip_realm, domain="zulip.com")
337	            assert zulip_realm.notifications_stream is not None
338	            zulip_realm.notifications_stream.name = "Verona"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:478:24
477	            for i in range(num_boring_names, num_names):
478	                fname = random.choice(fnames) + str(i)
479	                full_name = fname

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:480:19
479	                full_name = fname
480	                if random.random() < 0.7:
481	                    if random.random() < 0.3:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:481:23
480	                if random.random() < 0.7:
481	                    if random.random() < 0.3:
482	                        full_name += " " + random.choice(non_ascii_names)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:482:43
481	                    if random.random() < 0.3:
482	                        full_name += " " + random.choice(non_ascii_names)
483	                    else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:484:43
483	                    else:
484	                        full_name += " " + random.choice(mnames)
485	                    if random.random() < 0.1:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:485:23
484	                        full_name += " " + random.choice(mnames)
485	                    if random.random() < 0.1:
486	                        full_name += f" {random.choice(raw_emojis)} "

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:486:41
485	                    if random.random() < 0.1:
486	                        full_name += f" {random.choice(raw_emojis)} "
487	                    else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:488:43
487	                    else:
488	                        full_name += " " + random.choice(lnames)
489	                email = fname.lower() + "@zulip.com"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:821:66
820	        for i in range(options["num_huddles"]):
821	            get_or_create_huddle(random.sample(user_profiles_ids, random.randint(3, 4)))
822	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:928:40
927	                for i in range(options["extra_streams"]):
928	                    extra_stream_name = random.choice(extra_stream_names) + " " + str(i)
929	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:931:23
930	                    # to imitate emoji insertions in stream names
931	                    if random.random() <= 0.15:
932	                        extra_stream_name += random.choice(raw_emojis)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:932:45
931	                    if random.random() <= 0.15:
932	                        extra_stream_name += random.choice(raw_emojis)
933	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:965:58
964	                count += 1
965	            jobs.append((count, personals_pairs, options, random.randint(0, 10**10)))
966	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1061:25
1060	        if not options["test_suite"]:
1061	            num_topics = random.randint(1, options["max_topics"])
1062	        else:

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1079:18
1078	
1079	        randkey = random.randint(1, random_max)
1080	        if (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1082:16
1081	            num_messages > 0
1082	            and random.randint(1, random_max) * 100.0 / random_max < options["stickiness"]
1083	        ):

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1096:52
1095	            message_type = Recipient.HUDDLE
1096	            message.recipient = get_recipient_by_id(random.choice(recipient_huddles))
1097	        elif (

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1102:29
1101	            message_type = Recipient.PERSONAL
1102	            personals_pair = random.choice(personals_pairs)
1103	            random.shuffle(personals_pair)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1106:52
1105	            message_type = Recipient.STREAM
1106	            message.recipient = get_recipient_by_id(random.choice(recipient_streams))
1107	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1109:24
1108	        if message_type == Recipient.HUDDLE:
1109	            sender_id = random.choice(huddle_members[message.recipient.id])
1110	            message.sender = get_user_profile_by_id(sender_id)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1119:29
1118	            # Pick a random subscriber to the stream
1119	            message.sender = random.choice(
1120	                list(Subscription.objects.filter(recipient=message.recipient))
1121	            ).user_profile
1122	            message.subject = random.choice(possible_topics[message.recipient.id])

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1122:30
1121	            ).user_profile
1122	            message.subject = random.choice(possible_topics[message.recipient.id])
1123	            saved_data["subject"] = message.subject

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1193:24
1192	            max_num_users = min(7, len(msg_user_ids))
1193	            num_users = random.randrange(1, max_num_users + 1)
1194	            user_ids = random.sample(msg_user_ids, num_users)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1198:29
1197	                # each user does between 1 and 3 emojis
1198	                num_emojis = random.choice([1, 2, 3])
1199	                emojis = random.sample(DEFAULT_EMOJIS, num_emojis)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\zilencer\management\commands\populate_db.py:1245:21
1244	
1245	    offset_seconds = random.uniform(lower_bound, upper_bound)
1246	    spoofed_date += timedelta(seconds=offset_seconds)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\queue_rate.py:63:16
62	
63	                assert worker.q is not None
64	                assert worker.q.channel is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\management\commands\queue_rate.py:64:16
63	                assert worker.q is not None
64	                assert worker.q.channel is not None
65	                worker.q.channel.basic_qos(prefetch_count=prefetch)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\models.py:151:8
150	        # inside Tornado.
151	        assert not settings.RUNNING_INSIDE_TORNADO
152	        assert settings.ZILENCER_ENABLED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\models.py:152:8
151	        assert not settings.RUNNING_INSIDE_TORNADO
152	        assert settings.ZILENCER_ENABLED
153	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\views.py:241:4
240	    # All registrations passed here should be of the same kind (apple vs android).
241	    assert len({registration.kind for registration in registrations}) == 1
242	    kind = registrations[0].kind

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zilencer\views.py:254:8
253	            )
254	        assert tokens_counter[key] == 2
255	        tokens_to_deduplicate.append(key)

--------------------------------------------------
>> Issue: [B410:blacklist] Using XMLSyntaxError to parse untrusted XML data is known to be vulnerable to XML attacks. Replace XMLSyntaxError with the equivalent defusedxml package.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b410-import-lxml
   Location: .\zproject\backends.py:51:0
50	from django_auth_ldap.backend import LDAPBackend, _LDAPUser, ldap_error
51	from lxml.etree import XMLSyntaxError
52	from onelogin.saml2.auth import OneLogin_Saml2_Auth

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\backends.py:451:19
450	
451	    if password == "":
452	        # zxcvbn throws an exception when passed the empty string, so

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\backends.py:491:23
490	            return None
491	        if password == "":
492	            # Never allow an empty password.  This is defensive code;

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:534:8
533	        # Email search needs to be configured in this case.
534	        assert settings.AUTH_LDAP_USERNAME_ATTR and settings.AUTH_LDAP_REVERSE_EMAIL_SEARCH
535	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:538:4
537	    # and thus don't make sense to have enabled together.
538	    assert not (
539	        settings.AUTH_LDAP_USER_ATTR_MAP.get("userAccountControl")
540	        and settings.AUTH_LDAP_USER_ATTR_MAP.get("deactivated")
541	    )
542	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:612:8
611	
612	        assert search is not None
613	        results = search.execute(self.connection, {"email": email})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:803:8
802	
803	        assert "deactivated" in settings.AUTH_LDAP_USER_ATTR_MAP
804	        attr_value = ldap_user.attrs[settings.AUTH_LDAP_USER_ATTR_MAP["deactivated"]][0]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:813:8
812	        attr_value_upper = attr_value.upper()
813	        assert (
814	            attr_value_upper in true_values or attr_value_upper in false_values
815	        ), f"Invalid value '{attr_value}' in the LDAP attribute mapped to deactivated"
816	        return attr_value_upper in true_values

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1279:4
1278	def external_auth_method(cls: Type[ExternalAuthMethod]) -> Type[ExternalAuthMethod]:
1279	    assert issubclass(cls, ExternalAuthMethod)
1280	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1318:12
1317	        if login_token is not None:
1318	            assert (not data_dict) and (
1319	                user_profile is None
1320	            ), "Passing in data_dict or user_profile with login_token is disallowed."
1321	            self.instantiate_with_token(login_token, delete_stored_data)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1328:12
1327	            # Ensure data inconsistent with the user_profile wasn't passed in inside the data_dict argument.
1328	            assert (
1329	                "full_name" not in data_dict
1330	                or data_dict["full_name"] == self.user_profile.full_name
1331	            )
1332	            assert (

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1332:12
1331	            )
1332	            assert (
1333	                "email" not in data_dict
1334	                or data_dict["email"].lower() == self.user_profile.delivery_email.lower()
1335	            )
1336	            # Update these data_dict fields to ensure consistency with self.user_profile. This is mostly

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1382:12
1381	        if auth_result is not None:
1382	            assert isinstance(auth_result, UserProfile)
1383	        self.user_profile = auth_result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1734:4
1733	    # being incorrectly authenticated.
1734	    assert return_data.get("valid_attestation") is True
1735	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:1760:8
1759	        # for it otherwise.
1760	        assert backend.name == "saml"
1761	        custom_profile_field_name_to_attr_name = attrs_by_backend.get(backend.name, {})

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2475:8
2474	            ]
2475	        assert isinstance(entitlements, list)
2476	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2699:8
2698	        idp_name = self.strategy.session_get("saml_idp_name")
2699	        assert isinstance(idp_name, str)
2700	        auto_signup = settings.SOCIAL_AUTH_SAML_ENABLED_IDPS[idp_name].get("auto_signup", False)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2701:8
2700	        auto_signup = settings.SOCIAL_AUTH_SAML_ENABLED_IDPS[idp_name].get("auto_signup", False)
2701	        assert isinstance(auto_signup, bool)
2702	        return auto_signup

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2718:4
2717	    # receiving a copy of the dict.
2718	    assert auth.get_settings().get_security_data()["wantMessagesSigned"] is True
2719	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2744:8
2743	        client_id = self.settings_dict.get("client_id", "")
2744	        assert isinstance(client_id, str)
2745	        secret = self.settings_dict.get("secret", "")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2746:8
2745	        secret = self.settings_dict.get("secret", "")
2746	        assert isinstance(secret, str)
2747	        return client_id, secret

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\backends.py:2776:8
2775	        result = self.settings_dict.get("auto_signup", False)
2776	        assert isinstance(result, bool)
2777	        return result

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\dev_urls.py:119:4
118	
119	    assert settings.STATIC_URL is not None
120	    urls += static(urlsplit(settings.STATIC_URL).path, view=serve_static)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:40:8
39	        html_message: Union[bytes, EmailMessage, Message, str] = "Missing HTML message"
40	        assert isinstance(email, EmailMultiAlternatives)
41	        if len(email.alternatives) > 0:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:73:12
72	        for email_message in email_messages:
73	            assert isinstance(email_message, EmailMultiAlternatives)
74	            assert isinstance(email_message.alternatives[0][0], str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:74:12
73	            assert isinstance(email_message, EmailMultiAlternatives)
74	            assert isinstance(email_message.alternatives[0][0], str)
75	            # Here, we replace the email addresses used in development

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\email_backends.py:84:12
83	            )
84	            assert isinstance(email_message.alternatives, MutableSequence)
85	            email_message.alternatives[0] = html_alternative

--------------------------------------------------
>> Issue: [B701:jinja2_autoescape_false] Using jinja2 templates with autoescape=False is dangerous and can lead to XSS. Ensure autoescape=True or use the select_autoescape function to mitigate XSS vulnerabilities.
   Severity: High   Confidence: Medium
   CWE: CWE-94 (https://cwe.mitre.org/data/definitions/94.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b701_jinja2_autoescape_false.html
   Location: .\zproject\jinja2\__init__.py:22:10
21	def environment(**options: Any) -> Environment:
22	    env = Environment(autoescape=options.pop("autoescape", True), **options)
23	    env.globals.update(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\template_loaders.py:14:12
13	        for d in dirs:
14	            assert isinstance(d, Path)
15	            if d.match("two_factor/*"):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\zproject\test_extra_settings.py:153:4
152	    LOCAL_UPLOADS_DIR = os.getenv("LOCAL_UPLOADS_DIR")
153	    assert LOCAL_UPLOADS_DIR is not None
154	    LOCAL_AVATARS_DIR = os.path.join(LOCAL_UPLOADS_DIR, "avatars")

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test-secret-key'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:159:16
158	S3_KEY = "test-key"
159	S3_SECRET_KEY = "test-secret-key"
160	S3_AUTH_UPLOADS_BUCKET = "test-authed-bucket"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:173:30
172	GOOGLE_OAUTH2_CLIENT_ID = "id"
173	GOOGLE_OAUTH2_CLIENT_SECRET = "secret"
174	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:176:28
175	SOCIAL_AUTH_GITHUB_KEY = "key"
176	SOCIAL_AUTH_GITHUB_SECRET = "secret"
177	SOCIAL_AUTH_GITLAB_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:178:28
177	SOCIAL_AUTH_GITLAB_KEY = "key"
178	SOCIAL_AUTH_GITLAB_SECRET = "secret"
179	SOCIAL_AUTH_GOOGLE_KEY = "key"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:180:28
179	SOCIAL_AUTH_GOOGLE_KEY = "key"
180	SOCIAL_AUTH_GOOGLE_SECRET = "secret"
181	SOCIAL_AUTH_SUBDOMAIN = "auth"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'client_secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:204:27
203	VIDEO_ZOOM_CLIENT_ID = "client_id"
204	VIDEO_ZOOM_CLIENT_SECRET = "client_secret"
205	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\zproject\test_extra_settings.py:206:25
205	
206	BIG_BLUE_BUTTON_SECRET = "123"
207	BIG_BLUE_BUTTON_URL = "https://bbb.example.com/bigbluebutton/"

--------------------------------------------------

Code scanned:
	Total lines of code: 206710
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 1672
		Medium: 46
		High: 10
	Total issues (by confidence):
		Undefined: 0
		Low: 9
		Medium: 177
		High: 1542
Files skipped (0):
