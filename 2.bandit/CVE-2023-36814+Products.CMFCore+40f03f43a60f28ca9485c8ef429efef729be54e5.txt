Working... ---------------------------------------- 100% 0:00:03
Run started:2024-02-10 23:31:56.961470

Test results:
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\Products\CMFCore\CookieCrumbler.py:116:8
115	            del req.other[name]
116	        except Exception:
117	            pass
118	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\Products\CMFCore\CookieCrumbler.py:120:8
119	            del req.form[name]
120	        except Exception:
121	            pass
122	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\Products\CMFCore\CookieCrumbler.py:124:8
123	            del req.cookies[name]
124	        except Exception:
125	            pass
126	        try:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\Products\CMFCore\CookieCrumbler.py:128:8
127	            del req.environ[name]
128	        except Exception:
129	            pass
130	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\Products\CMFCore\CookieCrumbler.py:233:20
232	                        base64.decodebytes(ac.encode())
233	                    except Exception:
234	                        # Not a valid auth header.
235	                        pass
236	                    else:

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\src\Products\CMFCore\FSObject.py:76:8
75	            self._file_mod_time = os.stat(filepath).st_mtime
76	        except Exception:
77	            pass
78	        self._readFile(0)

--------------------------------------------------
>> Issue: [B302:blacklist] Deserialization with the marshal module is possibly dangerous.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b302-marshal
   Location: .\src\Products\CMFCore\PortalFolder.py:253:26
252	        if encoded:
253	            filter.update(marshal.loads(base64_decode(encoded)))
254	        return filter

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\src\Products\CMFCore\RegistrationTool.py:127:24
126	        chars = 'ABCDEFGHJKLMNPRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789'
127	        return ''.join([choice(chars) for i in range(6)])
128	

--------------------------------------------------
>> Issue: [B408:blacklist] Using parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace parseString with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b408-import-xml-minidom
   Location: .\src\Products\CMFCore\browser\actions.py:16:0
15	
16	from xml.dom.minidom import parseString
17	

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\src\Products\CMFCore\browser\actions.py:48:23
47	                    continue
48	                root = parseString(body).documentElement
49	                for node in root.childNodes:

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\src\Products\CMFCore\browser\actions.py:82:15
81	        settings_node = None
82	        root = parseString(body).documentElement
83	        for node in root.childNodes:

--------------------------------------------------
>> Issue: [B408:blacklist] Using parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace parseString with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b408-import-xml-minidom
   Location: .\src\Products\CMFCore\browser\typeinfo.py:16:0
15	
16	from xml.dom.minidom import parseString
17	

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\src\Products\CMFCore\browser\typeinfo.py:55:27
54	
55	                    root = parseString(body).documentElement
56	                    meta_type = str(root.getAttribute('meta_type'))

--------------------------------------------------
>> Issue: [B318:blacklist] Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom
   Location: .\src\Products\CMFCore\browser\typeinfo.py:85:19
84	
85	            root = parseString(body).documentElement
86	            new_id = str(root.getAttribute('name'))

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'value1'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\Products\CMFCore\exportimport\tests\test_mailhost.py:65:26
64	            mh.smtp_port = '1'
65	            mh.smtp_pwd = 'value1'
66	            mh.smtp_host = 'value2'

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\Products\CMFCore\exportimport\tests\test_mailhost.py:120:50
119	        self.assertEqual(mh.smtp_queue, False)
120	        self.assertEqual(mh.smtp_queue_directory, '/tmp')
121	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\src\Products\CMFCore\exportimport\tests\test_mailhost.py:135:50
134	        self.assertEqual(mh.smtp_queue, False)
135	        self.assertEqual(mh.smtp_queue_directory, '/tmp')
136	

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\src\Products\CMFCore\tests\base\testcase.py:232:24
231	        # store the place where the skin copy will be created
232	        self.tempname = mktemp(dir=getPackageLocation(
233	                                                     'Products.CMFCore.tests'))
234	        # create the temporary folder

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass-w'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\Products\CMFCore\tests\test_CookieCrumbler.py:152:20
151	        req.cookies['__ac_name'] = 'abraham'
152	        req.cookies['__ac_password'] = 'pass-w'
153	        req.traverse('/')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass-w'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\Products\CMFCore\tests\test_CookieCrumbler.py:175:20
174	        req.cookies['__ac_name'] = 'abraham'
175	        req.cookies['__ac_password'] = 'pass-w'
176	        self.assertTrue('__ac_password' in req)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass-w'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\Products\CMFCore\tests\test_CookieCrumbler.py:199:20
198	        req.cookies['__ac_name'] = 'abraham'
199	        req.cookies['__ac_password'] = 'pass-w'
200	        req.traverse('/')

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'pass-w'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\src\Products\CMFCore\tests\test_CookieCrumbler.py:226:20
225	        req.cookies['__ac_name'] = 'isaac'
226	        req.cookies['__ac_password'] = 'pass-w'
227	        req.cookies['__ac'] = credentials

--------------------------------------------------
>> Issue: [B306:blacklist] Use of insecure and deprecated function (mktemp).
   Severity: Medium   Confidence: High
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b306-mktemp-q
   Location: .\src\Products\CMFCore\tests\test_DirectoryView.py:75:15
74	    def test_UnhandleableExpandPath(self):
75	        file = mktemp()
76	        with warnings.catch_warnings(record=True) as w:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\Products\CMFCore\tests\test_FSMetadata.py:37:8
36	        # check it has a title
37	        assert self.ob.fake_skin.test6.title == 'Test object'
38	        self._checkSettings(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\Products\CMFCore\tests\test_FSMetadata.py:50:8
49	        test_image = getattr(self.ob.fake_skin, 'test_image.gif')
50	        assert test_image.title == 'Test image'
51	        self._checkSettings(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\src\Products\CMFCore\tests\test_FSMetadata.py:60:8
59	        test_file = getattr(self.ob.fake_skin, 'test_file.swf')
60	        assert test_file.title == 'Test file'
61	        self._checkSettings(

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'newpw'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b106_hardcoded_password_funcarg.html
   Location: .\src\Products\CMFCore\tests\test_MemberDataTool.py:199:8
198	        member = self._makeOne(user, self.site.portal_memberdata)
199	        member.setSecurityProfile(password='newpw')
200	        self.assertEqual(user.__, 'newpw')

--------------------------------------------------

Code scanned:
	Total lines of code: 26213
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 18
		Medium: 9
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 8
		High: 19
Files skipped (0):
