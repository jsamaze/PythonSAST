Working... ---------------------------------------- 100% 0:00:02
Run started:2024-02-10 23:40:00.741138

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:132:28
131	                        def initthread():
132	                            import subprocess
133	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:140:35
139	                                env=env,
140	                                shell=False,
141	                                stdout=subprocess.PIPE,
142	                                stderr=subprocess.STDOUT,
143	                            )
144	                            proc.wait()
145	                            while True:
146	                                line = proc.stdout.readline()
147	                                if line == "":

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: .\demo\agent_monitor\tenant_agent_monitor.py:257:40
256	    server = tornado.httpserver.HTTPServer(app, ssl_options=context)
257	    server.bind(int(args.port), address="0.0.0.0")
258	    server.start(0)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\api_version.py:73:4
72	        return 0
73	    assert isinstance(v_obj, version.Version)
74	    return v_obj.major

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\api_version.py:82:4
81	        return 0
82	    assert isinstance(v_obj, version.Version)
83	    return v_obj.minor

--------------------------------------------------
>> Issue: [B102:exec_used] Use of exec detected.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b102_exec_used.html
   Location: .\keylime\backport_dataclasses.py:364:4
363	
364	    exec(txt, globals, locals)
365	    return locals[name]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ca_util.py:137:8
136	        pubkey = cacert.public_key()
137	        assert isinstance(pubkey, rsa.RSAPublicKey)
138	        assert cc.signature_hash_algorithm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ca_util.py:138:8
137	        assert isinstance(pubkey, rsa.RSAPublicKey)
138	        assert cc.signature_hash_algorithm is not None
139	        pubkey.verify(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ca_util.py:206:8
205	        pubkey = cacert.public_key()
206	        assert isinstance(pubkey, rsa.RSAPublicKey)
207	        assert cac.signature_hash_algorithm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ca_util.py:207:8
206	        assert isinstance(pubkey, rsa.RSAPublicKey)
207	        assert cac.signature_hash_algorithm is not None
208	        pubkey.verify(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ca_util.py:348:4
347	    priv_encoded = yaml.dump(priv, Dumper=SafeDumper)
348	    assert isinstance(global_password, str)
349	    key = crypto.kdf(global_password, salt)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ca_util.py:363:8
362	            toread = yaml.load(f, Loader=SafeLoader)
363	        assert isinstance(global_password, str)
364	        key = crypto.kdf(global_password, toread["salt"])

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\cert_utils.py:3:0
2	import os.path
3	import subprocess
4	import sys

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cert_utils.py:83:20
82	                if isinstance(signcert_pubkey, RSAPublicKey):
83	                    assert ek509.signature_hash_algorithm is not None
84	                    signcert_pubkey.verify(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cert_utils.py:91:20
90	                elif isinstance(signcert_pubkey, EllipticCurvePublicKey):
91	                    assert ek509.signature_hash_algorithm is not None
92	                    signcert_pubkey.verify(

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\cert_utils.py:130:15
129	            env=env,
130	            shell=False,
131	            cwd=cwd,
132	            stderr=subprocess.STDOUT,
133	            stdout=subprocess.PIPE,
134	            check=False,
135	        )
136	        if proc.returncode != 0:
137	            errmsg = ""
138	            if proc.stdout is not None:
139	                errmsg = proc.stdout.decode("utf-8")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:166:8
165	        ima_policy = stored_agent.ima_policy.ima_policy
166	        assert isinstance(ima_policy, str)
167	        GLOBAL_POLICY_CACHE[agent_id][checksum] = ima_policy

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:186:12
185	            update_agent = session.query(VerfierMain).get(agentAttestState.get_agent_id())
186	            assert update_agent
187	            update_agent.boottime = agentAttestState.get_boottime()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:478:16
477	                update_agent = session.query(VerfierMain).get(agent_id)
478	                assert update_agent
479	                update_agent.operational_state = states.TERMINATED

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:680:24
679	                    try:
680	                        assert runtime_policy_stored
681	                        session.add(VerfierMain(**agent_data, ima_policy=runtime_policy_stored))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:1228:12
1227	        if new_operational_state in (states.FAILED, states.INVALID_QUOTE):
1228	            assert failure, "States FAILED and INVALID QUOTE should only be reached with a failure message"
1229	            assert failure.highest_severity

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:1229:12
1228	            assert failure, "States FAILED and INVALID QUOTE should only be reached with a failure message"
1229	            assert failure.highest_severity
1230	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:1232:16
1231	            if agent.get("severity_level") is None or agent["severity_level"] < failure.highest_severity.severity:
1232	                assert failure.highest_severity_event
1233	                agent["severity_level"] = failure.highest_severity.severity

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:1395:12
1394	            ima_pcrs_dict = {}
1395	            assert isinstance(agent.ima_pcrs, list)
1396	            for pcr_num in agent.ima_pcrs:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cloud_verifier_tornado.py:1471:8
1470	        logger.info("Starting server of process %s", task_id)
1471	        assert isinstance(engine, Engine)
1472	        engine.dispose()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cmd\convert_runtime_policy.py:56:12
55	            print(f"{basename(allowlist_path)} does not contain a valid digest list!")
56	            assert False
57	    except json.decoder.JSONDecodeError as _:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cmd\convert_runtime_policy.py:212:8
211	    else:
212	        assert False  # This cannot happen
213	

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: .\keylime\cmd\create_policy.py:20:0
19	import urllib.request
20	import xml.etree.ElementTree as ET
21	from typing import Any, Dict, List, Optional, Tuple

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\keylime\cmd\create_policy.py:257:17
256	            req = urllib.request.Request(url, headers={"Range": f"bytes={range_}"})
257	            with urllib.request.urlopen(req) as resp:
258	                blob += resp.read()

--------------------------------------------------
>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.
   Severity: Medium   Confidence: High
   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b310-urllib-urlopen
   Location: .\keylime\cmd\create_policy.py:315:13
314	    try:
315	        with urllib.request.urlopen(url) as resp:
316	            with tempfile.NamedTemporaryFile(delete=False) as f:

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\keylime\cmd\create_policy.py:324:11
323	def _get_filelists_ext_xml(repo: str, repomd_xml: str) -> Optional[str]:
324	    root = ET.parse(repomd_xml).getroot()
325	    location = root.find(

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\keylime\cmd\create_policy.py:332:11
331	def _get_rpm_urls(repo: str, repomd_xml: str) -> List[str]:
332	    root = ET.parse(repomd_xml).getroot()
333	    location = root.find(

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\keylime\cmd\create_policy.py:347:11
346	
347	    root = ET.parse(gzip.open(primary_xml_tmp))
348	    os.remove(primary_xml_tmp)

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: .\keylime\cmd\create_policy.py:403:15
402	
403	        root = ET.parse(gzip.open(filelists_ext_xml_tmp))
404	        os.remove(filelists_ext_xml_tmp)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cmd\sign_runtime_policy.py:90:12
89	        if private_key:
90	            assert isinstance(private_key, ec.EllipticCurvePrivateKey)
91	            signer = ecdsa.Signer(private_key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cmd\sign_runtime_policy.py:96:12
95	        if private_key:
96	            assert isinstance(private_key, ec.EllipticCurvePrivateKey)
97	            signer = x509.Signer(private_key, certificate_path=args.certificate_output_file)

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\keylime\cmd_exec.py:2:0
1	import os
2	import subprocess
3	import sys

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\keylime\cmd_exec.py:32:9
31	def _execute(cmd: Sequence[str], env: Optional[EnvType] = None, **kwargs: Any) -> Tuple[bytes, bytes, int]:
32	    with subprocess.Popen(cmd, env=env, stdout=subprocess.PIPE, stderr=subprocess.PIPE, **kwargs) as proc:
33	        out, err = proc.communicate()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cmd_exec.py:35:8
34	        # All callers assume to receive a list of bytes back; none of them uses 'text mode'
35	        assert isinstance(out, bytes)
36	        assert isinstance(err, bytes)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\cmd_exec.py:36:8
35	        assert isinstance(out, bytes)
36	        assert isinstance(err, bytes)
37	        return out, err, proc.returncode

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\common\validators.py:54:4
53	        )
54	    except Exception:
55	        pass
56	    return valid

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\common\validators.py:66:4
65	        valid = bool(re.fullmatch(r"[\w.-]+", agent_id))
66	    except Exception:
67	        pass
68	    return valid

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:124:31
123	        OAEP(
124	            mgf=MGF1(algorithm=hashes.SHA1()),
125	            algorithm=hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:125:22
124	            mgf=MGF1(algorithm=hashes.SHA1()),
125	            algorithm=hashes.SHA1(),
126	            label=None,

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:136:31
135	        OAEP(
136	            mgf=MGF1(algorithm=hashes.SHA1()),
137	            algorithm=hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\crypto.py:137:22
136	            mgf=MGF1(algorithm=hashes.SHA1()),
137	            algorithm=hashes.SHA1(),
138	            label=None,

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\crypto.py:187:4
186	    cipher_text = encryptor.update(plaintext) + encryptor.finalize()
187	    assert isinstance(encryptor, AEADEncryptionContext)
188	    return base64.b64encode(iv + cipher_text + encryptor.tag)

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\keylime\da\record.py:6:0
5	import os
6	import pickle
7	import tempfile

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\keylime\da\record.py:109:41
108	        if self.rcd_fmt == "pickle":
109	            deserialized_record_object = pickle.loads(manipulated_record_object)
110	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\da\record.py:206:8
205	        """Accesses a persisent data store, retrieves multiple data entries, adding each entry to a provided list"""
206	        assert self.svc
207	        assert attestation_record_list

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\da\record.py:207:8
206	        assert self.svc
207	        assert attestation_record_list
208	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\da\record.py:361:16
360	                    record_object["signature"] = str.encode(record_object["signature"])
361	                except Exception:
362	                    pass
363	                fp.write(base64.decodebytes(record_object["signature"]))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\dsse\x509.py:102:12
101	            public_key = self.certificate.public_key()
102	            assert isinstance(public_key, (ec.EllipticCurvePublicKey))
103	            public_key.verify(signature, message, ec.ECDSA(hashes.SHA256()))

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\ima\file_signatures.py:76:28
75	    # The list of hash functions we need for signature verification.
76	    HashAlgo.HASH_ALGO_MD5: hashes.MD5(),
77	    HashAlgo.HASH_ALGO_SHA1: hashes.SHA1(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\ima\file_signatures.py:77:29
76	    HashAlgo.HASH_ALGO_MD5: hashes.MD5(),
77	    HashAlgo.HASH_ALGO_SHA1: hashes.SHA1(),
78	    HashAlgo.HASH_ALGO_SHA256: hashes.SHA256(),

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\ima\file_signatures.py:128:29
127	        default_be = backends.default_backend()
128	        digest = hashes.Hash(hashes.SHA1(), backend=default_be)
129	        digest.update(pubbytes)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima.py:230:4
229	    running_hash = agentAttestState.get_pcr_state(config.IMA_PCR, hash_alg)
230	    assert running_hash
231	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b403-import-pickle
   Location: .\keylime\ima\ima_dm.py:7:0
6	
7	import pickle
8	import re

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b301-pickle
   Location: .\keylime\ima\ima_dm.py:82:27
81	        if state:
82	            self.devices = pickle.loads(state)
83	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:103:16
102	            if path.name == "dm_table_load":
103	                assert isinstance(event, LoadEvent)
104	                failure.merge(self.validate_table_load(event, match_key, digest))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:106:16
105	            elif path.name == "dm_device_resume":
106	                assert isinstance(event, ResumeEvent)
107	                failure.merge(self.validate_device_resume(event, match_key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:109:16
108	            elif path.name == "dm_device_remove":
109	                assert isinstance(event, RemoveEvent)
110	                failure.merge(self.validate_device_remove(event, match_key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:112:16
111	            elif path.name == "dm_device_rename":
112	                assert isinstance(event, RenameEvent)
113	                failure.merge(self.validate_device_rename(event, match_key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:115:16
114	            elif path.name == "dm_table_clear":
115	                assert isinstance(event, ClearEvent)
116	                failure.merge(self.validate_table_clear(event, match_key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:118:16
117	            elif path.name == "dm_target_update":
118	                assert isinstance(event, UpdateEvent)
119	                failure.merge(self.validate_target_update(event, match_key))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:770:8
769	    def yes(x: List[Any]) -> str:
770	        assert x == []
771	        return "y"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:775:8
774	    def no(x: List[Any]) -> str:
775	        assert x == []
776	        return "n"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\ima\ima_dm.py:937:4
936	
937	    assert isinstance(out, (LoadEvent, ResumeEvent, RemoveEvent, ClearEvent, RenameEvent, UpdateEvent))
938	    return out

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\ip_util.py:13:8
12	                return "[" + ipaddr + "]"
13	        except Exception:
14	            pass
15	    return ipaddr

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\keylime\mba\elchecking\__main__.py:33:10
32	_, log_data = tpm2_tools_elparser.parse_binary_bootlog(log_bin)
33	with open("/tmp/parsed.json", "wt", encoding="utf-8") as log_data_file:
34	    log_data_file.write(json.dumps(log_data, indent=True))

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\keylime\mba\elparsing\tpm2_tools_elparser.py:211:12
210	                log["boot_aggregates"][hashalg].append(h.hexdigest())
211	            except Exception:
212	                pass
213	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\mba\elparsing\tpm_bootlog_enrich.py:64:4
63	        raise Exception(f"getGUID: efi_guid_to_str({str(b)}) returned {ret}")
64	    assert isinstance(s.value, bytes)
65	    return s.value.decode("utf-8")  # pylint: disable=E1101

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\registrar_common.py:305:16
304	                pubkey = cert.public_key()
305	                assert isinstance(pubkey, (rsa.RSAPublicKey, ec.EllipticCurvePublicKey))
306	                ek_tpm = base64.b64encode(tpm2_objects.ek_low_tpm2b_public_from_pubkey(pubkey)).decode()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\registrar_common.py:346:16
345	                # keep track of how many ek-ekcerts have registered on this uuid
346	                assert isinstance(agent.regcount, int)
347	                regcount = agent.regcount

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\registrar_common.py:437:12
436	
437	            assert agent
438	            assert isinstance(agent.key, str)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\registrar_common.py:438:12
437	            assert agent
438	            assert isinstance(agent.key, str)
439	            ex_mac = crypto.do_hmac(agent.key.encode(), agent_id)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\revocation_notifier.py:28:4
27	def start_broker() -> None:
28	    assert "zeromq" in get_notifiers()
29	    try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\revocation_notifier.py:83:4
82	def notify(tosend: Dict[str, Any]) -> None:
83	    assert "zeromq" in get_notifiers()
84	    try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\signing.py:70:20
69	                    logger.debug("Importing GPG key")
70	                    assert callable(ctx.key_import)
71	                    result = ctx.key_import(key)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\signing.py:108:8
107	        ec_pubkey = load_pem_public_key(key)
108	        assert isinstance(ec_pubkey, ec.EllipticCurvePublicKey)
109	        verifiers = [("user_provided_key", dsse_ecdsa.Verifier(ec_pubkey))]

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tenant.py:575:8
574	        logger.debug("b64_v: %s", b64_v)
575	        assert self.registrar_data
576	        data = {

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tenant.py:920:8
919	
920	        assert isinstance(response["results"], dict)
921	        response["results"][self.agent_uuid] = agent_info

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tenant.py:946:8
945	        )
946	        assert isinstance(response, dict)
947	        assert isinstance(response["results"], dict)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tenant.py:947:8
946	        assert isinstance(response, dict)
947	        assert isinstance(response["results"], dict)
948	        logger.info("Agent list from %s retrieved: \n%s", self.registrar_fid_str, json.dumps(response["results"]))

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\ec_crypto_helper.py:22:8
21	        lib = self.binding.lib
22	        assert lib
23	

--------------------------------------------------
>> Issue: [B303:blacklist] Use of insecure MD2, MD4, MD5, or SHA1 hash function.
   Severity: Medium   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b303-md5
   Location: .\keylime\tpm\tpm2_objects.py:76:18
75	HASH_FUNCS: Dict[int, hashes.HashAlgorithm] = {
76	    TPM_ALG_SHA1: hashes.SHA1(),
77	    TPM_ALG_SHA256: hashes.SHA256(),

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\keylime\tpm\tpm2_objects.py:389:15
388	    if nameAlg == TPM_ALG_SHA1:
389	        return hashlib.sha1()
390	    if nameAlg == TPM_ALG_SHA256:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:109:8
108	        test_rsa_pubkey = test_rsa_cert.public_key()
109	        assert isinstance(test_rsa_pubkey, rsa.RSAPublicKey)
110	        new_rsa_obj = ek_low_tpm2b_public_from_pubkey(test_rsa_pubkey)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:139:8
138	        test_ec_pubkey = test_ec_cert.public_key()
139	        assert isinstance(test_ec_pubkey, ec.EllipticCurvePublicKey)
140	        new_ec_obj = ek_low_tpm2b_public_from_pubkey(test_ec_pubkey)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:181:8
180	        new_rsa_pubkey = pubkey_from_tpm2b_public(correct_rsa_obj)
181	        assert isinstance(new_rsa_pubkey, rsa.RSAPublicKey)
182	        correct_rsa_pubkey = test_rsa_cert.public_key()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:183:8
182	        correct_rsa_pubkey = test_rsa_cert.public_key()
183	        assert isinstance(correct_rsa_pubkey, rsa.RSAPublicKey)
184	        new_rsa_pubkey_n = new_rsa_pubkey.public_numbers()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:209:8
208	        )
209	        assert isinstance(new_rsa_pubkey, rsa.RSAPublicKey)
210	        new_rsa_pubkey_n = new_rsa_pubkey.public_numbers()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:254:8
253	        new_ec_pubkey, name_alg = pubkey_parms_from_tpm2b_public(correct_ec_obj)
254	        assert isinstance(new_ec_pubkey, ec.EllipticCurvePublicKey)
255	        self.assertEqual(name_alg, TPM_ALG_SHA256)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:258:8
257	        correct_ec_pubkey = test_ec_cert.public_key()
258	        assert isinstance(correct_ec_pubkey, ec.EllipticCurvePublicKey)
259	        new_ec_pubkey_n = new_ec_pubkey.public_numbers()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm2_objects_test.py:273:8
272	        )
273	        assert isinstance(new_ec_pubkey, ec.EllipticCurvePublicKey)
274	        new_ec_pubkey_n = new_ec_pubkey.public_numbers()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm_util.py:371:4
370	    """
371	    assert len(seed) > 0
372	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: ''
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\keylime\tpm\tpm_util.py:476:15
475	    chars = string.ascii_uppercase + string.digits + string.ascii_lowercase
476	    password = ""
477	    for i in range(length):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\keylime\tpm\tpm_util_test.py:118:8
117	    def create_fixed_ec_key(curve: EllipticCurve) -> EllipticCurvePrivateKey:
118	        assert isinstance(curve, SECP256R1)
119	        priv = int("75548318724506252006992803713632448754009807765151974952668642988315053146586")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ca_impl_openssl.py:32:8
31	        pubkey = ca_cert.public_key()
32	        assert isinstance(pubkey, RSAPublicKey)
33	        assert cert.signature_hash_algorithm is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ca_impl_openssl.py:33:8
32	        assert isinstance(pubkey, RSAPublicKey)
33	        assert cert.signature_hash_algorithm is not None
34	        try:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ca_util.py:37:8
36	        working_dir = tempfile.mkdtemp()
37	        assert working_dir
38	        try:

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test\test_fs_util.py:18:23
17	
18	        fs_util.ch_dir("/tmp/dir")
19	        makedirs_mock.assert_not_called()

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b108_hardcoded_tmp_directory.html
   Location: .\test\test_fs_util.py:32:23
31	
32	        fs_util.ch_dir("/tmp/dir")
33	        makedirs_mock.assert_called_once()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ima_verification.py:131:8
130	        pubkey, keyidv2 = file_signatures.get_pubkey_from_file(rsakeyfile)
131	        assert pubkey is not None
132	        tenant_keyring.add_pubkey(pubkey, keyidv2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ima_verification.py:141:8
140	        pubkey, keyidv2 = file_signatures.get_pubkey_from_file(eckeyfile)
141	        assert pubkey is not None
142	        tenant_keyring.add_pubkey(pubkey, keyidv2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ima_verification.py:166:8
165	        running_hash = agentAttestState.get_pcr_state(10)
166	        assert running_hash is not None
167	        for line in lines:

--------------------------------------------------
>> Issue: [B324:hashlib] Use of weak SHA1 hash for security. Consider usedforsecurity=False
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b324_hashlib.html
   Location: .\test\test_ima_verification.py:170:27
169	            template_hash = bytes.fromhex(parts[1])
170	            running_hash = hashlib.sha1(running_hash + template_hash).digest()
171	            pcrval = codecs.encode(running_hash, "hex").decode("utf-8")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ima_verification.py:195:8
194	        pubkey, keyidv2 = file_signatures.get_pubkey_from_file(rsakeyfile)
195	        assert pubkey is not None
196	        tenant_keyring.add_pubkey(pubkey, keyidv2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_ima_verification.py:200:8
199	        pubkey, keyidv2 = file_signatures.get_pubkey_from_file(eckeyfile)
200	        assert pubkey is not None
201	        tenant_keyring.add_pubkey(pubkey, keyidv2)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_registrar_db.py:89:8
88	        agent = self.session.query(RegistrarMain).filter_by(agent_id=agent_id).first()
89	        assert agent
90	        self.assertEqual(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:13:11
12	def rand_base():
13	    return random.uniform(-99, 99)
14	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:17:11
16	def rand_base_proper():
17	    return random.uniform(1, 99)
18	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:21:11
20	def rand_ntries():
21	    return random.randint(1, 99)
22	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:25:11
24	def rand_exp():
25	    return random.choice([True, False])
26	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\test\test_retry_algo.py:38:13
37	        b0 = rand_base_proper()
38	        b1 = random.random()
39	        n = rand_ntries()

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\test\test_signing.py:48:8
47	            self.fail("Signing passed with invalid signature!")
48	        except Exception:
49	            pass

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_validators.py:16:8
15	        value = validators.valid_regex(r"a.*")
16	        assert value[0] is not None
17	        self.assertEqual(value[0].pattern, r"a.*")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_validators.py:36:8
35	        value = validators.valid_exclude_list([r"a.*"])
36	        assert value[0] is not None
37	        self.assertEqual(value[0].pattern, r"(a.*)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_validators.py:43:8
42	        value = validators.valid_exclude_list([r"a.*", r"b.*"])
43	        assert value[0] is not None
44	        self.assertEqual(value[0].pattern, r"(a.*)|(b.*)")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_verifier_db.py:78:8
77	        )
78	        assert agent
79	        self.assertEqual(agent.v, "cf0B779EA1dkHVWfTxQuSLHNFeutYeSmVWe7JOFWzXg=")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_verifier_db.py:112:8
111	        agent = self.session.query(VerfierMain).filter_by(agent_id=agent_id).first()
112	        assert agent
113	        self.assertEqual(agent.operational_state, 10)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_verifier_db.py:120:8
119	        agent = self.session.query(VerfierMain).filter_by(agent_id=agent_id).first()
120	        assert agent
121	        self.assertEqual(agent.verifier_ip, "127.0.0.2")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_verifier_db.py:129:8
128	        agent = self.session.query(VerfierMain).filter_by(agent_id=agent_id).first()
129	        assert agent is None
130	        self.assertIsNone(agent)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\test\test_verifier_db.py:140:8
139	        agent = self.session.query(VerfierMain).filter_by(agent_id=agent_id).first()
140	        assert agent
141	        agent.ima_policy_id = None  # type: ignore

--------------------------------------------------

Code scanned:
	Total lines of code: 18066
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 101
		Medium: 21
		High: 2
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 5
		High: 119
Files skipped (1):
	.\test\data\template-invalid-adjust\2.0\adjust.py (syntax error while parsing AST from file)
