Working... ---------------------------------------- 100% 0:00:00
Run started:2024-02-10 23:40:10.840022

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\matrix_is_test\launcher.py:19:0
18	import time
19	from subprocess import Popen
20	

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\matrix_is_test\launcher.py:95:23
94	
95	        self.process = Popen(
96	            args=[pybin, "-m", "sydent.sydent"],
97	            cwd=self.tmpdir,
98	            env=newEnv,
99	            stderr=stderr_fp,
100	        )
101	        # XXX: wait for startup in a sensible way

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\hashing_metadata.py:118:14
117	        # Medium/address combos are marked as UNIQUE in the database
118	        sql = "SELECT COUNT(*) FROM %s" % table
119	        res = cur.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\hashing_metadata.py:128:18
127	        while count < row_count:
128	            sql = "SELECT medium, address FROM %s ORDER BY id LIMIT %s OFFSET %s" % (
129	                table,
130	                batch_size,
131	                count,
132	            )
133	            res = cur.execute(sql)

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\hashing_metadata.py:151:20
150	                sql = (
151	                    "UPDATE %s SET lookup_hash = ? "
152	                    "WHERE medium = ? AND address = ?" % table
153	                )

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b608_hardcoded_sql_expressions.html
   Location: .\sydent\db\valsession.py:188:12
187	        cur.execute(
188	            "select id, medium, address, clientSecret, validated, mtime from "
189	            + "threepid_validation_sessions where id = ?",
190	            (sid,),

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sydent\http\httpclient.py:144:8
143	            json_body = json_decoder.decode(body.decode("UTF-8"))
144	        except Exception:
145	            # We might get an exception here because the body exceeds the max_size, or it
146	            # isn't valid JSON. In both cases, we don't care about it.
147	            pass
148	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\http\httpcommon.py:208:12
207	            )
208	            assert self.transport is not None
209	            self.transport.abortConnection()

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\http\matrixfederationagent.py:175:12
174	            headers = headers.copy()  # type: ignore[no-untyped-call]
175	            assert headers is not None
176	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\http\matrixfederationagent.py:361:28
360	            cache_period = WELL_KNOWN_INVALID_CACHE_PERIOD
361	            cache_period += random.uniform(0, WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER)
362	            return (None, cache_period)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\http\matrixfederationagent.py:374:28
373	            # after startup
374	            cache_period += random.uniform(0, WELL_KNOWN_DEFAULT_CACHE_PERIOD_JITTER)
375	        else:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\http\servlets\__init__.py:95:4
94	    """
95	    assert request.path is not None
96	    v1_path = request.path.startswith(b"/_matrix/identity/api/v1")

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\sydent\http\servlets\emailservlet.py:139:8
138	            resp = self.do_validate_request(request)
139	        except Exception:
140	            pass
141	        if resp and "success" in resp and resp["success"]:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\http\servlets\replication.py:132:20
131	                    pepper = self.hashing_store.get_lookup_pepper()
132	                    assert pepper is not None
133	                    str_to_hash = " ".join(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\http\srvresolver.py:68:20
67	    total_weight = sum(s.weight for s in eligible_servers)
68	    target_weight = random.randint(0, total_weight)
69	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\sydent.py:176:12
175	        if self.config.general.prometheus_enabled:
176	            assert self.config.general.prometheus_addr is not None
177	            assert self.config.general.prometheus_port is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\sydent.py:177:12
176	            assert self.config.general.prometheus_addr is not None
177	            assert self.config.general.prometheus_port is not None
178	            prometheus_client.start_http_server(

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\sydent\threepid\bind.py:74:8
73	        lookup_pepper = self.hashing_store.get_lookup_pepper()
74	        assert lookup_pepper is not None
75	        str_to_hash = " ".join(

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b311-random
   Location: .\sydent\util\emailutils.py:59:25
58	
59	    midRandom = "".join([random.choice(string.ascii_letters) for _ in range(16)])
60	    messageid = "<%d%s@%s>" % (time_msec(), midRandom, myHostname)

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testingtoken'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\tests\test_auth.py:27:26
26	        self.sydent = make_sydent()
27	        self.test_token = "testingtoken"
28	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_replication.py:158:12
157	            # Check the method and the URI.
158	            assert method == b"POST"
159	            assert uri == b"https://fake.server:1234/_matrix/identity/replicate/v1/push"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\test_replication.py:159:12
158	            assert method == b"POST"
159	            assert uri == b"https://fake.server:1234/_matrix/identity/replicate/v1/push"
160	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b101_assert_used.html
   Location: .\tests\utils.py:137:8
136	    def write(self, content):
137	        assert isinstance(content, bytes), "Should be bytes! " + repr(content)
138	

--------------------------------------------------

Code scanned:
	Total lines of code: 8650
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 19
		Medium: 4
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 3
		Medium: 2
		High: 18
Files skipped (0):
