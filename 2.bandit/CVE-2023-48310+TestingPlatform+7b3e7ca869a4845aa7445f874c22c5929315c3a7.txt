Working... ---------------------------------------- 100% 0:00:00
Run started:2024-02-10 23:58:51.033314

Test results:
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\automation\tasks.py:2:0
1	import socket
2	import subprocess
3	

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\automation\tasks.py:28:15
27	def ping(host):
28	    response = subprocess.Popen(["ping", host, "-c", "2", "-W", "4"])
29	    response.wait()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\automation\tasks.py:28:15
27	def ping(host):
28	    response = subprocess.Popen(["ping", host, "-c", "2", "-W", "4"])
29	    response.wait()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers.py:33:15
32	    endpoint = settings.IOT_API_URL + "authorize"
33	    id_token = requests.post(endpoint, headers=headers, data=payload).json()["id_token"]
34	    tenant_id = jwt.decode(

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers.py:49:15
48	    endpoint = settings.IOT_API_URL + "token"
49	    response = requests.post(endpoint, headers=headers, data=payload).json()
50	    return response

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers.py:69:15
68	    )
69	    response = requests.post(endpoint, headers=headers, data=payload)
70	    return response

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers.py:264:10
263	    endpoint = settings.IOT_API_URL + f"reports/{report_uuid}/pdf"
264	    req = requests.get(url=endpoint, headers=headers)
265	    return req

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers_old.py:33:15
32	    endpoint = settings.IOT_API_URL + "authorize"
33	    id_token = requests.post(endpoint, headers=headers, data=payload).json()["id_token"]
34	    tenant_id = jwt.decode(

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers_old.py:49:15
48	    endpoint = settings.IOT_API_URL + "token"
49	    response = requests.post(endpoint, headers=headers, data=payload).json()
50	    return response

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers_old.py:69:15
68	    )
69	    response = requests.post(endpoint, headers=headers, data=payload)
70	    return response

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\iot_inspector\helpers_old.py:264:10
263	    endpoint = settings.IOT_API_URL + f"reports/{report_uuid}/pdf"
264	    req = requests.get(url=endpoint, headers=headers)
265	    return req

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\iot_inspector\views.py:29:4
28	        pass
29	    except Exception:
30	        pass
31	    return render(request, "iot_index.html")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\testing\helpers.py:6:0
5	import socket
6	import subprocess
7	import time

--------------------------------------------------
>> Issue: [B413:blacklist] The pyCrypto library and its module RSA are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.
   Severity: High   Confidence: High
   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b413-import-pycrypto
   Location: .\testing\helpers.py:18:0
17	import requests
18	from Crypto.PublicKey import RSA
19	from django.template.loader import render_to_string

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:73:11
72	    logger.info(f"http scan: requesting scan at {http_url}")
73	    data = requests.post(http_url)
74	    json_object = data.json()

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:83:12
82	        scan_history = json.loads(
83	            requests.get(
84	                "https://http-observatory.security.mozilla.org/api/v1/getHostHistory?host="
85	                + target
86	            ).text
87	        )

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:95:16
94	            result_obj = json.loads(
95	                requests.get(
96	                    "https://http-observatory.security.mozilla.org/api/v1/getScanResults?scan="
97	                    + str(scan_history[-1]["scan_id"])
98	                ).text
99	            )

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:110:23
109	        while json_object["state"] not in ("ABORTED", "FAILED") and counter < 5:
110	            get_scan = requests.get(
111	                "https://http-observatory.security.mozilla.org/api/v1/analyze?host="
112	                + target
113	            ).text
114	            check_object = json.loads(get_scan)

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:127:20
126	                result_obj = json.loads(
127	                    requests.get(
128	                        "https://http-observatory.security.mozilla.org/api/v1/getScanResults?scan="
129	                        + str(scan_id)
130	                    ).text
131	                )

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:181:33
180	    try:
181	        do_tls_scan = json.loads(requests.post(url).text)
182	        tls_scan_id = do_tls_scan["scan_id"]

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:191:8
190	    fetch_tls = json.loads(
191	        requests.get(
192	            "https://tls-observatory.services.mozilla.com/api/v1/results?id="
193	            + str(tls_scan_id)
194	        ).text
195	    )

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:201:12
200	        fetch_tls = json.loads(
201	            requests.get(
202	                "https://tls-observatory.services.mozilla.com/api/v1/results?id="
203	                + str(tls_scan_id)
204	            ).text
205	        )

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\testing\helpers.py:248:8
247	    (stdout, stderr) = (
248	        subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)
249	    ).communicate()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\testing\helpers.py:458:15
457	            command = ["ping", "-c", "1", ip4]
458	            if subprocess.call(command) == 0:
459	                response = True

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\testing\helpers.py:476:15
475	            command = ["ping", "-c", "1", ip6]
476	            if subprocess.call(command) == 0:
477	                response = True

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:568:31
567	                    )
568	                    response = requests.get(query_url, headers=header)
569	                    if response:

--------------------------------------------------
>> Issue: [B113:request_without_timeout] Requests call without timeout
   Severity: Medium   Confidence: Low
   CWE: CWE-400 (https://cwe.mitre.org/data/definitions/400.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b113_request_without_timeout.html
   Location: .\testing\helpers.py:643:20
642	                cipher_info = json.loads(
643	                    requests.get(
644	                        f"https://ciphersuite.info/api/cs/{ciphersuite['name']}"
645	                    ).text
646	                )[ciphersuite["name"]]

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\testing\helpers.py:647:12
646	                )[ciphersuite["name"]]
647	            except Exception:
648	                continue
649	            for key in ["gnutls_name", "openssl_name", "hex_byte_1", "hex_byte_2"]:

--------------------------------------------------
>> Issue: [B112:try_except_continue] Try, Except, Continue detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b112_try_except_continue.html
   Location: .\testing\helpers.py:685:8
684	            return {"dkim": key.can_encrypt()}
685	        except Exception:
686	            continue
687	    return {"dkim": False}

--------------------------------------------------
>> Issue: [B703:django_mark_safe] Potential XSS on mark_safe function.
   Severity: Medium   Confidence: High
   CWE: CWE-80 (https://cwe.mitre.org/data/definitions/80.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b703_django_mark_safe.html
   Location: .\testing\templatetags\tags.py:50:11
49	        result = "No IP for ASN"
50	    return mark_safe(result)
51	

--------------------------------------------------
>> Issue: [B308:blacklist] Use of mark_safe() may expose cross-site scripting vulnerabilities and should be reviewed.
   Severity: Medium   Confidence: High
   CWE: CWE-79 (https://cwe.mitre.org/data/definitions/79.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_calls.html#b308-mark-safe
   Location: .\testing\templatetags\tags.py:50:11
49	        result = "No IP for ASN"
50	    return mark_safe(result)
51	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b110_try_except_pass.html
   Location: .\testing\views.py:97:8
96	            context["tls_lowest_sec_level"] = tls_results["lowest_sec_level"]
97	        except Exception:
98	            pass
99	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'testing_platform_1key!'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\testing_platform\settings.py:227:22
226	ONEKEY_API_EMAIL = "romain.kieffer@nc3.lu"
227	ONEKEY_API_PASSWORD = "testing_platform_1key!"
228	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'secret'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b105_hardcoded_password_string.html
   Location: .\testing_platform\settings.py:276:31
275	
276	if not DEBUG and SECRET_KEY == "secret":
277	    print("FATAL: the secret key in the config has not yet been configured. Quitting.")

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: .\testing_platform\tools.py:4:0
3	import socket
4	import subprocess
5	import sys

--------------------------------------------------
>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b607_start_process_with_partial_path.html
   Location: .\testing_platform\tools.py:38:11
37	        os.environ.get("PKGVER")
38	        or subprocess.run(
39	            ["git", "-C", BASE_DIR, "describe", "--tags"], stdout=subprocess.PIPE
40	        )
41	        .stdout.decode()

--------------------------------------------------
>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.7.7/plugins/b603_subprocess_without_shell_equals_true.html
   Location: .\testing_platform\tools.py:38:11
37	        os.environ.get("PKGVER")
38	        or subprocess.run(
39	            ["git", "-C", BASE_DIR, "describe", "--tags"], stdout=subprocess.PIPE
40	        )
41	        .stdout.decode()

--------------------------------------------------

Code scanned:
	Total lines of code: 5549
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 16
		Medium: 20
		High: 1
	Total issues (by confidence):
		Undefined: 0
		Low: 18
		Medium: 2
		High: 17
Files skipped (0):
