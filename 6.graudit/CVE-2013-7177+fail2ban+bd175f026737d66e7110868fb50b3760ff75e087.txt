===========================================================
                                      .___ __  __   
          _________________  __ __  __| _/|__|/  |_ 
         / ___\_` __ \__  \ |  |  \/ __ | | \\_  __\
        / /_/  >  | \// __ \|  |  / /_/ | |  ||  |  
        \___  /|__|  (____  /____/\____ | |__||__|  
       /_____/            \/           \/           
              grep rough audit - static analysis tool
                  v3.5 written by @Wireghoul
=================================[justanotherhacker.com]===
[35m[K/tmp/fail2ban/server/filter.py[m[K[36m[K-[m[K[32m[K705[m[K[36m[K-[m[K	#@staticmethod
[35m[K/tmp/fail2ban/server/filter.py[m[K[36m[K:[m[K[32m[K706[m[K[36m[K:[m[K	def bin2[01;31m[Kaddr([m[Kaddr):
[35m[K/tmp/fail2ban/server/filter.py[m[K[36m[K-[m[K[32m[K707[m[K[36m[K-[m[K		""" Convert a numeric IPv4 address into string n.n.n.n form.
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/server/asyncserver.py[m[K[36m[K-[m[K[32m[K129[m[K[36m[K-[m[K		self.create_socket(socket.AF_UNIX, socket.SOCK_STREAM)
[35m[K/tmp/fail2ban/server/asyncserver.py[m[K[36m[K:[m[K[32m[K130[m[K[36m[K:[m[K		self.set_reuse_[01;31m[Kaddr([m[K)
[35m[K/tmp/fail2ban/server/asyncserver.py[m[K[36m[K-[m[K[32m[K131[m[K[36m[K-[m[K		try:
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/config/action.d/dshield.conf[m[K[36m[K-[m[K[32m[K67[m[K[36m[K-[m[Kactionban = TZONE=`date +%%z | sed 's/\([+-]..\)\(..\)/\1:\2/'`
[35m[K/tmp/fail2ban/config/action.d/dshield.conf[m[K[36m[K:[m[K[32m[K68[m[K[36m[K:[m[K            DATETIME="[01;31m[K`perl -e '@t=localtime(<time>);printf "%%4d-%%02d-%%02d %%02d:%%02d:%%02d",1900+$t[5],$t[4]+1,$t[3],$t[2],$t[1],$t[0]'`[m[K $TZONE"
[35m[K/tmp/fail2ban/config/action.d/dshield.conf[m[K[36m[K:[m[K[32m[K69[m[K[36m[K:[m[K	    PROTOCOL=[01;31m[K`awk '{IGNORECASE=1;if($1=="<protocol>"){print $2;exit}}' /etc/protocols`[m[K
[35m[K/tmp/fail2ban/config/action.d/dshield.conf[m[K[36m[K-[m[K[32m[K70[m[K[36m[K-[m[K	    if [ -z "$PROTOCOL" ]; then PROTOCOL=<protocol>; fi
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K-[m[K[32m[K60[m[K[36m[K-[m[K#
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K:[m[K[32m[K61[m[K[36m[K:[m[Kactionban = MNWLOGIN=[01;31m[K`perl -e '$s=shift;$s=~s/([\W])/"%%".uc(sprintf("%%2.2x",ord($1)))/eg;print $s' '<mnwlogin>'`[m[K
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K:[m[K[32m[K62[m[K[36m[K:[m[K            MNWPASS=[01;31m[K`perl -e '$s=shift;$s=~s/([\W])/"%%".uc(sprintf("%%2.2x",ord($1)))/eg;print $s' '<mnwpass>'`[m[K
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K:[m[K[32m[K63[m[K[36m[K:[m[K	    PROTOCOL=[01;31m[K`awk '{IGNORECASE=1;if($1=="<protocol>"){print $2;exit}}' /etc/protocols`[m[K
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K-[m[K[32m[K64[m[K[36m[K-[m[K	    if [ -z "$PROTOCOL" ]; then PROTOCOL=<protocol>; fi
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K:[m[K[32m[K65[m[K[36m[K:[m[K	    DATETIME=[01;31m[K`perl -e '@t=gmtime(<time>);printf "%%4d-%%02d-%%02d+%%02d:%%02d:%%02d",1900+$t[5],$t[4]+1,$t[3],$t[2],$t[1],$t[0]'`[m[K
[35m[K/tmp/fail2ban/config/action.d/mynetwatchman.conf[m[K[36m[K-[m[K[32m[K66[m[K[36m[K-[m[K            <getcmd> "<mnwurl>?AT=2&AV=0&AgentEmail=$MNWLOGIN&AgentPassword=$MNWPASS&AttackerIP=<ip>&SrcPort=<srcport>&ProtocolID=$PROTOCOL&DestPort=<port>&AttackCount=<failures>&VictimIP=<myip>&AttackDateTime=$DATETIME" 2>&1 >> <tmpfile>.out && grep -q 'Attack Report Insert Successful' <tmpfile>.out && rm -f <tmpfile>.out
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/config/action.d/complain.conf[m[K[36m[K-[m[K[32m[K57[m[K[36m[K-[m[K#
[35m[K/tmp/fail2ban/config/action.d/complain.conf[m[K[36m[K:[m[K[32m[K58[m[K[36m[K:[m[Kactionban = ADDRESSES=[01;31m[K`whois <ip> | perl -e 'while (<STDIN>) { next if /^changed|@(ripe|apnic)\.net/io; $m += (/abuse|trouble:|report|spam|security/io?3:0); if (/([a-z0-9_\-\.+]+@[a-z0-9\-]+(\.[[a-z0-9\-]+)+)/io) { while (s/([a-z0-9_\-\.+]+@[a-z0-9\-]+(\.[[a-z0-9\-]+)+)//io) { if ($m) { $a{lc($1)}=$m } else { $b{lc($1)}=$m } } $m=0 } else { $m && --$m } } if (%%a) {print join(",",keys(%%a))} else {print join(",",keys(%%b))}'`[m[K
[35m[K/tmp/fail2ban/config/action.d/complain.conf[m[K[36m[K-[m[K[32m[K59[m[K[36m[K-[m[K	    IP=<ip>
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/config/action.d/ipfw.conf[m[K[36m[K-[m[K[32m[K45[m[K[36m[K-[m[K#
[35m[K/tmp/fail2ban/config/action.d/ipfw.conf[m[K[36m[K:[m[K[32m[K46[m[K[36m[K:[m[Kactionunban = ipfw delete [01;31m[K`ipfw list | grep -i <ip> | awk '{print $1;}'`[m[K
[35m[K/tmp/fail2ban/config/action.d/ipfw.conf[m[K[36m[K-[m[K[32m[K47[m[K[36m[K-[m[K
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/kill-server[m[K[36m[K-[m[K[32m[K1[m[K[36m[K-[m[K#!/bin/bash
[35m[K/tmp/fail2ban/kill-server[m[K[36m[K:[m[K[32m[K2[m[K[36m[K:[m[Kkill [01;31m[K`ps ax|grep fail2ban|grep -v grep|awk '{print $1}'`[m[K
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K-[m[K[32m[K171[m[K[36m[K-[m[K### Test the connection to the fail2ban server
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K:[m[K[32m[K172[m[K[36m[K:[m[Kmy @command_output = [01;31m[K`$fail2ban_cmd ping`[m[K;
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K-[m[K[32m[K173[m[K[36m[K-[m[Kmy $return_code = $?;
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K-[m[K[32m[K309[m[K[36m[K-[m[K
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K:[m[K[32m[K310[m[K[36m[K:[m[K    my @command_output = [01;31m[K`$fail2ban_client_path status`[m[K;
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K-[m[K[32m[K311[m[K[36m[K-[m[K    my $return_code = $?;
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K-[m[K[32m[K331[m[K[36m[K-[m[K
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K:[m[K[32m[K332[m[K[36m[K:[m[K    my @command_output = [01;31m[K`$fail2ban_client_path status $jail_name`[m[K;
[35m[K/tmp/fail2ban/files/nagios/check_fail2ban[m[K[36m[K-[m[K[32m[K333[m[K[36m[K-[m[K    my $return_code = $?;
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/files/redhat-initd[m[K[36m[K-[m[K[32m[K22[m[K[36m[K-[m[Kgetpid() {
[35m[K/tmp/fail2ban/files/redhat-initd[m[K[36m[K:[m[K[32m[K23[m[K[36m[K:[m[K    pid=[01;31m[K`ps -eo pid,comm | grep fail2ban- | awk '{ print $1 }'`[m[K
[35m[K/tmp/fail2ban/files/redhat-initd[m[K[36m[K-[m[K[32m[K24[m[K[36m[K-[m[K}
[36m[K##############################################[m[K
[35m[K/tmp/fail2ban/files/cacti/fail2ban_stats.sh[m[K[36m[K-[m[K[32m[K33[m[K[36m[K-[m[Kif [ -z $JAIL ]; then
[35m[K/tmp/fail2ban/files/cacti/fail2ban_stats.sh[m[K[36m[K:[m[K[32m[K34[m[K[36m[K:[m[K	echo "Usage:" [01;31m[K`basename $0`[m[K "<jail>"
[35m[K/tmp/fail2ban/files/cacti/fail2ban_stats.sh[m[K[36m[K-[m[K[32m[K35[m[K[36m[K-[m[K	exit
