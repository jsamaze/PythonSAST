                    
                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10 Code Findings â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             
  [36m[22m[24m  bin/lshell[0m
    â¯â± [1mpython.lang.security.audit.eval-detected.eval-detected[0m
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
          Details: https://sg.run/ZvrD                                                                     
                                                                                                           
           34â”† args = sys.argv[1:] + eval(os.environ['LSHELL_ARGS'])
                                        
  [36m[22m[24m  lshell/checkconfig.py[0m
    â¯â± [1mpython.lang.security.audit.eval-detected.eval-detected[0m
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
          Details: https://sg.run/ZvrD                                                                     
                                                                                                           
          171â”† logname = eval(self.conf['syslogname'])
            â‹®â”†----------------------------------------
          220â”† logfilename = eval(self.conf['logfilename'])
            â‹®â”†----------------------------------------
          338â”† for path in eval(stuff):
            â‹®â”†----------------------------------------
          344â”† elif stuff and type(eval(stuff)) is list:
            â‹®â”†----------------------------------------
          413â”† evaluated = eval(value)
            â‹®â”†----------------------------------------
          521â”† self.conf['path'] = eval(self.conf_raw['path'])
            â‹®â”†----------------------------------------
          564â”† self.conf['history_file'] = eval(
          565â”†     self.conf_raw['history_file'].replace(
          566â”†         "%u", self.conf['username']))
                                
  [36m[22m[24m  lshell/sec.py[0m
   â¯â¯â± [1mpython.lang.security.audit.subprocess-shell-true.subprocess-shell-true[0m
          Found 'subprocess' function 'Popen' with 'shell=True'. This is dangerous because this call will   
          spawn the command using a shell process. Doing so propagates current shell settings and variables,
          which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.  
          Details: https://sg.run/J92w                                                                      
                                                                                                            
           [32mâ–¶â–¶â”† Autofix â–¶ [0msubprocess.Popen("`which echo` %s" %                                    
              item,shell=False,stdin=subprocess.PIPE,stdout=subprocess.PIPE,stderr=subprocess.PIP
              E)                                                                                 
           93â”† p = subprocess.Popen("`which echo` %s" % item,
           94â”†                      shell=True,
           95â”†                      stdin=subprocess.PIPE,
           96â”†                      stdout=subprocess.PIPE,
           97â”†                      stderr=subprocess.PIPE)
                                  
  [36m[22m[24m  lshell/utils.py[0m
   â¯â¯â± [1mpython.lang.security.audit.subprocess-shell-true.subprocess-shell-true[0m
          Found 'subprocess' function 'Popen' with 'shell=True'. This is dangerous because this call will   
          spawn the command using a shell process. Doing so propagates current shell settings and variables,
          which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.  
          Details: https://sg.run/J92w                                                                      
                                                                                                            
           [32mâ–¶â–¶â”† Autofix â–¶ [0msubprocess.Popen([cmd], shell=False)
           92â”† proc = subprocess.Popen([cmd], shell=True)
